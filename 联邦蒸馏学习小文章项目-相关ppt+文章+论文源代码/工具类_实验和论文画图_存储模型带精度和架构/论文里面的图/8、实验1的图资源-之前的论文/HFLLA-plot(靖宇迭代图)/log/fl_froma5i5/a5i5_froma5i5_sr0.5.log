#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-a5i5_froma5i5_sr0.5/client_asml1_0', 'models/model-a5i5_froma5i5_sr0.5/client_asml1_1', 'models/model-a5i5_froma5i5_sr0.5/client_asml1_2', 'models/model-a5i5_froma5i5_sr0.5/client_asml1_3', 'models/model-a5i5_froma5i5_sr0.5/client_asml1_4', 'models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0', 'models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1', 'models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2', 'models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3', 'models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [2 4 6 7 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38505 | Reg=0.00357 | acc=0.4219 | L2-Norm=18.886 | L2-Norm(final)=2.026 | 2681.5 samples/s | 41.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28168 | Reg=0.00340 | acc=0.7969 | L2-Norm=18.428 | L2-Norm(final)=2.022 | 4685.5 samples/s | 73.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24500 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.225 | L2-Norm(final)=2.028 | 4578.3 samples/s | 71.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22487 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.091 | L2-Norm(final)=2.032 | 4552.6 samples/s | 71.1 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20462 | Reg=0.00324 | acc=0.8438 | L2-Norm=17.993 | L2-Norm(final)=2.036 | 6114.9 samples/s | 95.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18591 | Reg=0.00321 | acc=0.8750 | L2-Norm=17.921 | L2-Norm(final)=2.042 | 1777.6 samples/s | 27.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17390 | Reg=0.00319 | acc=0.9062 | L2-Norm=17.866 | L2-Norm(final)=2.048 | 4539.8 samples/s | 70.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16353 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.822 | L2-Norm(final)=2.054 | 4601.1 samples/s | 71.9 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15460 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.786 | L2-Norm(final)=2.060 | 5572.4 samples/s | 87.1 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14526 | Reg=0.00316 | acc=0.9531 | L2-Norm=17.760 | L2-Norm(final)=2.066 | 1816.2 samples/s | 28.4 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13774 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.742 | L2-Norm(final)=2.073 | 4481.5 samples/s | 70.0 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13091 | Reg=0.00314 | acc=0.9375 | L2-Norm=17.729 | L2-Norm(final)=2.080 | 4427.2 samples/s | 69.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12550 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.717 | L2-Norm(final)=2.086 | 5208.7 samples/s | 81.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.12006 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.707 | L2-Norm(final)=2.092 | 1816.2 samples/s | 28.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11402 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.699 | L2-Norm(final)=2.098 | 4569.9 samples/s | 71.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10978 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.692 | L2-Norm(final)=2.104 | 4497.3 samples/s | 70.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10550 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.688 | L2-Norm(final)=2.109 | 4777.3 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35639 | Reg=0.00357 | acc=0.5781 | L2-Norm=18.886 | L2-Norm(final)=2.026 | 4087.0 samples/s | 63.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28962 | Reg=0.00341 | acc=0.8281 | L2-Norm=18.454 | L2-Norm(final)=2.019 | 3875.7 samples/s | 60.6 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24495 | Reg=0.00334 | acc=0.8281 | L2-Norm=18.278 | L2-Norm(final)=2.028 | 4530.2 samples/s | 70.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21792 | Reg=0.00330 | acc=0.8906 | L2-Norm=18.172 | L2-Norm(final)=2.035 | 4476.2 samples/s | 69.9 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19918 | Reg=0.00328 | acc=0.8906 | L2-Norm=18.098 | L2-Norm(final)=2.041 | 6128.7 samples/s | 95.8 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18009 | Reg=0.00326 | acc=0.9219 | L2-Norm=18.043 | L2-Norm(final)=2.048 | 1708.8 samples/s | 26.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16751 | Reg=0.00324 | acc=0.9375 | L2-Norm=18.006 | L2-Norm(final)=2.057 | 4465.2 samples/s | 69.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16053 | Reg=0.00323 | acc=0.9062 | L2-Norm=17.977 | L2-Norm(final)=2.063 | 4523.4 samples/s | 70.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15113 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.958 | L2-Norm(final)=2.070 | 5807.9 samples/s | 90.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14068 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.945 | L2-Norm(final)=2.078 | 1757.2 samples/s | 27.5 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.13303 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.937 | L2-Norm(final)=2.086 | 4502.5 samples/s | 70.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12616 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.931 | L2-Norm(final)=2.094 | 4550.1 samples/s | 71.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12072 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.927 | L2-Norm(final)=2.102 | 5585.4 samples/s | 87.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11443 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.925 | L2-Norm(final)=2.109 | 1797.7 samples/s | 28.1 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10898 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.924 | L2-Norm(final)=2.117 | 4569.5 samples/s | 71.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10429 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.923 | L2-Norm(final)=2.124 | 4471.7 samples/s | 69.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09992 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=2.131 | 5288.6 samples/s | 82.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34573 | Reg=0.00357 | acc=0.4688 | L2-Norm=18.886 | L2-Norm(final)=2.026 | 3615.0 samples/s | 56.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14397 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.533 | L2-Norm(final)=2.031 | 4095.4 samples/s | 64.0 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08769 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.397 | L2-Norm(final)=2.046 | 5888.4 samples/s | 92.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06181 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.306 | L2-Norm(final)=2.059 | 1680.2 samples/s | 26.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04693 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.224 | L2-Norm(final)=2.070 | 5356.8 samples/s | 83.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03794 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=2.078 | 1715.7 samples/s | 26.8 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03168 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=2.085 | 5079.3 samples/s | 79.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02717 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.091 | 1789.0 samples/s | 28.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02379 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=2.095 | 4705.3 samples/s | 73.5 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02115 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.846 | L2-Norm(final)=2.099 | 1805.8 samples/s | 28.2 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01904 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=2.102 | 4468.4 samples/s | 69.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01731 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.702 | L2-Norm(final)=2.105 | 1876.8 samples/s | 29.3 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01587 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=2.108 | 4251.2 samples/s | 66.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01465 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.564 | L2-Norm(final)=2.111 | 1877.7 samples/s | 29.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01361 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=2.114 | 4362.6 samples/s | 68.2 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01270 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.431 | L2-Norm(final)=2.117 | 1859.7 samples/s | 29.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01191 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.366 | L2-Norm(final)=2.120 | 4165.1 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31757 | Reg=0.00357 | acc=0.6406 | L2-Norm=18.886 | L2-Norm(final)=2.028 | 3782.8 samples/s | 59.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.16438 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.525 | L2-Norm(final)=2.033 | 3865.9 samples/s | 60.4 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.09598 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.399 | L2-Norm(final)=2.057 | 5847.3 samples/s | 91.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06492 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=2.073 | 1662.2 samples/s | 26.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04914 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=2.084 | 5518.6 samples/s | 86.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03965 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.093 | 1711.3 samples/s | 26.7 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03307 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.100 | 5179.1 samples/s | 80.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02836 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=2.106 | 1736.1 samples/s | 27.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02483 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=2.110 | 4883.1 samples/s | 76.3 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02207 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=2.114 | 1789.5 samples/s | 28.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01987 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=2.118 | 4483.4 samples/s | 70.1 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01807 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.686 | L2-Norm(final)=2.121 | 1807.4 samples/s | 28.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01657 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.618 | L2-Norm(final)=2.124 | 4299.2 samples/s | 67.2 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01529 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=2.126 | 1843.9 samples/s | 28.8 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01420 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.488 | L2-Norm(final)=2.129 | 4258.8 samples/s | 66.5 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01326 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.425 | L2-Norm(final)=2.132 | 1845.2 samples/s | 28.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01243 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.362 | L2-Norm(final)=2.134 | 4388.8 samples/s | 68.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33450 | Reg=0.00357 | acc=0.5625 | L2-Norm=18.886 | L2-Norm(final)=2.026 | 3724.7 samples/s | 58.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.17534 | Reg=0.00346 | acc=0.9375 | L2-Norm=18.591 | L2-Norm(final)=2.027 | 3815.2 samples/s | 59.6 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.10357 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.500 | L2-Norm(final)=2.050 | 5908.5 samples/s | 92.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07038 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.070 | 1691.7 samples/s | 26.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05374 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=2.084 | 5491.4 samples/s | 85.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04501 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=2.093 | 1734.3 samples/s | 27.1 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03767 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.233 | L2-Norm(final)=2.101 | 5022.9 samples/s | 78.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03231 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.108 | 1751.7 samples/s | 27.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02829 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=2.113 | 4872.3 samples/s | 76.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02515 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.055 | L2-Norm(final)=2.118 | 1805.7 samples/s | 28.2 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02264 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.122 | 4554.9 samples/s | 71.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02059 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=2.125 | 1815.8 samples/s | 28.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01887 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=2.128 | 4361.3 samples/s | 68.1 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01742 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.817 | L2-Norm(final)=2.130 | 1829.4 samples/s | 28.6 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01618 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=2.133 | 4300.6 samples/s | 67.2 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01510 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.702 | L2-Norm(final)=2.135 | 1783.5 samples/s | 27.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01416 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.646 | L2-Norm(final)=2.137 | 4309.0 samples/s | 67.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36185 | acc=0.5004 | tpr=0.4087 | fpr=0.3005 | 3918.0 samples/s | 15.3 steps/s
Avg test loss: 0.36074, Avg test acc: 0.50593, Avg tpr: 0.41668, Avg fpr: 0.29778, total FA: 2323

Testing server on iccad2012
[Step=  50] | Loss=0.24840 | acc=0.8545 | tpr=0.8274 | fpr=0.1450 | 3888.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.24806 | acc=0.8536 | tpr=0.8571 | fpr=0.1465 | 7301.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.24841 | acc=0.8518 | tpr=0.8487 | fpr=0.1482 | 7839.3 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.24876 | acc=0.8520 | tpr=0.8426 | fpr=0.1479 | 7962.5 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.24854 | acc=0.8515 | tpr=0.8428 | fpr=0.1484 | 7484.7 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.24841 | acc=0.8521 | tpr=0.8429 | fpr=0.1478 | 7650.4 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.24861 | acc=0.8518 | tpr=0.8466 | fpr=0.1481 | 7871.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.24886 | acc=0.8517 | tpr=0.8435 | fpr=0.1481 | 7822.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.24891 | acc=0.8516 | tpr=0.8418 | fpr=0.1482 | 7703.0 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.24879 | acc=0.8519 | tpr=0.8423 | fpr=0.1479 | 7880.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.24861 | acc=0.8522 | tpr=0.8432 | fpr=0.1476 | 14631.8 samples/s | 57.2 steps/s
Avg test loss: 0.24859, Avg test acc: 0.85226, Avg tpr: 0.84350, Avg fpr: 0.14759, total FA: 20492

server round 1/50

clients selected: [0 3 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36243 | Reg=0.00295 | acc=0.5156 | L2-Norm=17.177 | L2-Norm(final)=2.091 | 3760.7 samples/s | 58.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.23500 | Reg=0.00292 | acc=0.8125 | L2-Norm=17.088 | L2-Norm(final)=2.085 | 4414.3 samples/s | 69.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.20196 | Reg=0.00291 | acc=0.8594 | L2-Norm=17.071 | L2-Norm(final)=2.094 | 4518.0 samples/s | 70.6 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.18160 | Reg=0.00291 | acc=0.8125 | L2-Norm=17.064 | L2-Norm(final)=2.103 | 4483.1 samples/s | 70.0 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.16568 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.059 | L2-Norm(final)=2.110 | 6043.5 samples/s | 94.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.15481 | Reg=0.00291 | acc=0.9219 | L2-Norm=17.059 | L2-Norm(final)=2.117 | 1730.0 samples/s | 27.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.14251 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.063 | L2-Norm(final)=2.124 | 4458.7 samples/s | 69.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.13463 | Reg=0.00291 | acc=0.9219 | L2-Norm=17.067 | L2-Norm(final)=2.132 | 4518.6 samples/s | 70.6 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.12861 | Reg=0.00291 | acc=0.9531 | L2-Norm=17.072 | L2-Norm(final)=2.138 | 5561.9 samples/s | 86.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.12114 | Reg=0.00292 | acc=0.9375 | L2-Norm=17.079 | L2-Norm(final)=2.145 | 1774.6 samples/s | 27.7 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.11447 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.088 | L2-Norm(final)=2.153 | 4469.7 samples/s | 69.8 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10992 | Reg=0.00292 | acc=0.9375 | L2-Norm=17.098 | L2-Norm(final)=2.160 | 4531.0 samples/s | 70.8 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10482 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.108 | L2-Norm(final)=2.167 | 5114.0 samples/s | 79.9 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09994 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.118 | L2-Norm(final)=2.173 | 1828.7 samples/s | 28.6 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09526 | Reg=0.00293 | acc=0.9531 | L2-Norm=17.126 | L2-Norm(final)=2.180 | 4471.6 samples/s | 69.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.09147 | Reg=0.00294 | acc=0.9531 | L2-Norm=17.134 | L2-Norm(final)=2.187 | 4420.4 samples/s | 69.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.08837 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.144 | L2-Norm(final)=2.193 | 4912.4 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34923 | Reg=0.00295 | acc=0.5625 | L2-Norm=17.177 | L2-Norm(final)=2.092 | 3515.4 samples/s | 54.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.25096 | Reg=0.00292 | acc=0.8594 | L2-Norm=17.088 | L2-Norm(final)=2.087 | 4420.0 samples/s | 69.1 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.21263 | Reg=0.00292 | acc=0.8438 | L2-Norm=17.086 | L2-Norm(final)=2.095 | 4557.0 samples/s | 71.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.19209 | Reg=0.00292 | acc=0.8906 | L2-Norm=17.092 | L2-Norm(final)=2.104 | 4556.2 samples/s | 71.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.17496 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=2.110 | 6082.5 samples/s | 95.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.15871 | Reg=0.00293 | acc=0.8750 | L2-Norm=17.113 | L2-Norm(final)=2.118 | 1728.2 samples/s | 27.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.14602 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.125 | L2-Norm(final)=2.126 | 4485.9 samples/s | 70.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.13652 | Reg=0.00294 | acc=0.8594 | L2-Norm=17.140 | L2-Norm(final)=2.136 | 4398.4 samples/s | 68.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.12931 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.153 | L2-Norm(final)=2.143 | 5586.0 samples/s | 87.3 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.12050 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.167 | L2-Norm(final)=2.152 | 1783.0 samples/s | 27.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.11307 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.181 | L2-Norm(final)=2.161 | 4543.2 samples/s | 71.0 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10769 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.194 | L2-Norm(final)=2.170 | 4502.5 samples/s | 70.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10338 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.207 | L2-Norm(final)=2.177 | 5275.1 samples/s | 82.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09806 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.221 | L2-Norm(final)=2.185 | 1832.1 samples/s | 28.6 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09323 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.236 | L2-Norm(final)=2.193 | 4260.4 samples/s | 66.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.08997 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.250 | L2-Norm(final)=2.201 | 4399.0 samples/s | 68.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.08704 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.263 | L2-Norm(final)=2.208 | 4818.3 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.38293 | Reg=0.00295 | acc=0.4375 | L2-Norm=17.177 | L2-Norm(final)=2.090 | 3535.2 samples/s | 55.2 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.24639 | Reg=0.00298 | acc=0.7812 | L2-Norm=17.253 | L2-Norm(final)=2.070 | 4040.5 samples/s | 63.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.20151 | Reg=0.00298 | acc=0.7969 | L2-Norm=17.270 | L2-Norm(final)=2.081 | 4515.6 samples/s | 70.6 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.18303 | Reg=0.00298 | acc=0.8906 | L2-Norm=17.276 | L2-Norm(final)=2.093 | 4488.6 samples/s | 70.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.16786 | Reg=0.00299 | acc=0.9375 | L2-Norm=17.281 | L2-Norm(final)=2.102 | 6095.0 samples/s | 95.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.15193 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.290 | L2-Norm(final)=2.113 | 1740.8 samples/s | 27.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.13976 | Reg=0.00299 | acc=0.8906 | L2-Norm=17.301 | L2-Norm(final)=2.123 | 4403.5 samples/s | 68.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12935 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.313 | L2-Norm(final)=2.134 | 4396.3 samples/s | 68.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.12255 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.325 | L2-Norm(final)=2.144 | 5780.0 samples/s | 90.3 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11423 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=2.153 | 1746.2 samples/s | 27.3 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.10761 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.352 | L2-Norm(final)=2.162 | 4477.0 samples/s | 70.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10235 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.364 | L2-Norm(final)=2.170 | 4494.4 samples/s | 70.2 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.09894 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.377 | L2-Norm(final)=2.177 | 5513.9 samples/s | 86.2 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09511 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.391 | L2-Norm(final)=2.183 | 1753.8 samples/s | 27.4 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.09092 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.404 | L2-Norm(final)=2.189 | 4462.9 samples/s | 69.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.08751 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=2.195 | 4532.9 samples/s | 70.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08407 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=2.201 | 5278.0 samples/s | 82.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.21784 | Reg=0.00295 | acc=0.8906 | L2-Norm=17.177 | L2-Norm(final)=2.091 | 3792.4 samples/s | 59.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06552 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.445 | L2-Norm(final)=2.093 | 3715.8 samples/s | 58.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03711 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.484 | L2-Norm(final)=2.102 | 5879.2 samples/s | 91.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02652 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=2.107 | 1686.8 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02003 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=2.112 | 5518.8 samples/s | 86.2 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01603 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.385 | L2-Norm(final)=2.116 | 1727.8 samples/s | 27.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01337 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.336 | L2-Norm(final)=2.119 | 5166.9 samples/s | 80.7 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01146 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.284 | L2-Norm(final)=2.121 | 1760.1 samples/s | 27.5 steps/s
[Step=1200 Epoch=11.5] | Loss=0.01003 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.232 | L2-Norm(final)=2.123 | 4903.2 samples/s | 76.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00892 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.180 | L2-Norm(final)=2.124 | 1756.3 samples/s | 27.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00803 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.128 | L2-Norm(final)=2.125 | 4566.4 samples/s | 71.3 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00730 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=2.126 | 1817.5 samples/s | 28.4 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00669 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.025 | L2-Norm(final)=2.127 | 4392.0 samples/s | 68.6 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00618 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=2.128 | 1885.1 samples/s | 29.5 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00574 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.925 | L2-Norm(final)=2.129 | 4268.5 samples/s | 66.7 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00536 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=2.130 | 1882.9 samples/s | 29.4 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00502 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=2.131 | 4396.2 samples/s | 68.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.25307 | Reg=0.00295 | acc=0.7812 | L2-Norm=17.177 | L2-Norm(final)=2.094 | 3583.3 samples/s | 56.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.08600 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.121 | L2-Norm(final)=2.108 | 4024.9 samples/s | 62.9 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.05061 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.089 | L2-Norm(final)=2.120 | 5748.0 samples/s | 89.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.03832 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.059 | L2-Norm(final)=2.131 | 1708.2 samples/s | 26.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.02947 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=2.141 | 5302.4 samples/s | 82.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.02395 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=2.149 | 1744.6 samples/s | 27.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.02001 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=2.155 | 4835.4 samples/s | 75.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01719 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=2.161 | 1811.4 samples/s | 28.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01505 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.893 | L2-Norm(final)=2.165 | 4482.1 samples/s | 70.0 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.01339 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=2.169 | 1790.8 samples/s | 28.0 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01206 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=2.173 | 4319.0 samples/s | 67.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01097 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.769 | L2-Norm(final)=2.176 | 1888.4 samples/s | 29.5 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01006 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=2.179 | 4411.5 samples/s | 68.9 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.00928 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.685 | L2-Norm(final)=2.181 | 1895.7 samples/s | 29.6 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00862 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.644 | L2-Norm(final)=2.184 | 4353.6 samples/s | 68.0 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00805 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.602 | L2-Norm(final)=2.186 | 1983.8 samples/s | 31.0 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.00755 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.561 | L2-Norm(final)=2.188 | 3882.9 samples/s | 60.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29709 | acc=0.6808 | tpr=0.6230 | fpr=0.1938 | 3935.6 samples/s | 15.4 steps/s
Avg test loss: 0.29728, Avg test acc: 0.68187, Avg tpr: 0.62534, Avg fpr: 0.19382, total FA: 1512

Testing server on iccad2012
[Step=  50] | Loss=0.24166 | acc=0.8029 | tpr=0.8938 | fpr=0.1987 | 4078.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.24165 | acc=0.8018 | tpr=0.9254 | fpr=0.2005 | 7609.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.24235 | acc=0.7995 | tpr=0.9294 | fpr=0.2029 | 8007.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.24274 | acc=0.8001 | tpr=0.9311 | fpr=0.2022 | 7663.9 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.24289 | acc=0.7999 | tpr=0.9354 | fpr=0.2026 | 7800.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.24251 | acc=0.7999 | tpr=0.9324 | fpr=0.2026 | 7737.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.24281 | acc=0.7992 | tpr=0.9336 | fpr=0.2032 | 7836.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.24314 | acc=0.7995 | tpr=0.9294 | fpr=0.2029 | 7885.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.24328 | acc=0.7991 | tpr=0.9299 | fpr=0.2033 | 8013.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.24312 | acc=0.7995 | tpr=0.9295 | fpr=0.2029 | 7437.6 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.24274 | acc=0.7998 | tpr=0.9284 | fpr=0.2025 | 13974.7 samples/s | 54.6 steps/s
Avg test loss: 0.24275, Avg test acc: 0.79988, Avg tpr: 0.92868, Avg fpr: 0.20247, total FA: 28112

server round 2/50

clients selected: [0 1 2 3 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.30747 | Reg=0.00267 | acc=0.6562 | L2-Norm=16.343 | L2-Norm(final)=2.161 | 3618.2 samples/s | 56.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.15934 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.472 | L2-Norm(final)=2.158 | 4121.8 samples/s | 64.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14749 | Reg=0.00273 | acc=0.9375 | L2-Norm=16.517 | L2-Norm(final)=2.162 | 4440.3 samples/s | 69.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13391 | Reg=0.00274 | acc=0.8438 | L2-Norm=16.546 | L2-Norm(final)=2.169 | 4461.8 samples/s | 69.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12369 | Reg=0.00274 | acc=0.8906 | L2-Norm=16.565 | L2-Norm(final)=2.175 | 6021.9 samples/s | 94.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11087 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.584 | L2-Norm(final)=2.184 | 1733.7 samples/s | 27.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10272 | Reg=0.00276 | acc=0.9531 | L2-Norm=16.603 | L2-Norm(final)=2.193 | 4378.0 samples/s | 68.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09665 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.620 | L2-Norm(final)=2.201 | 4498.1 samples/s | 70.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09117 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.637 | L2-Norm(final)=2.208 | 5593.8 samples/s | 87.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08517 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.654 | L2-Norm(final)=2.216 | 1793.0 samples/s | 28.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08063 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.670 | L2-Norm(final)=2.224 | 4550.6 samples/s | 71.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07777 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.684 | L2-Norm(final)=2.230 | 4606.1 samples/s | 72.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07513 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.697 | L2-Norm(final)=2.236 | 5255.6 samples/s | 82.1 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07181 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.711 | L2-Norm(final)=2.241 | 1825.5 samples/s | 28.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06892 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.724 | L2-Norm(final)=2.246 | 4538.3 samples/s | 70.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06686 | Reg=0.00280 | acc=0.9375 | L2-Norm=16.738 | L2-Norm(final)=2.251 | 4533.5 samples/s | 70.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06490 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=2.255 | 4812.9 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.26370 | Reg=0.00267 | acc=0.7812 | L2-Norm=16.343 | L2-Norm(final)=2.163 | 3910.2 samples/s | 61.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.17834 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.350 | L2-Norm(final)=2.162 | 4027.4 samples/s | 62.9 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.15297 | Reg=0.00268 | acc=0.9062 | L2-Norm=16.379 | L2-Norm(final)=2.172 | 4508.3 samples/s | 70.4 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.13891 | Reg=0.00269 | acc=0.8594 | L2-Norm=16.396 | L2-Norm(final)=2.179 | 4536.1 samples/s | 70.9 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.12991 | Reg=0.00269 | acc=0.9062 | L2-Norm=16.414 | L2-Norm(final)=2.184 | 6001.6 samples/s | 93.8 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.11672 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.432 | L2-Norm(final)=2.193 | 1708.6 samples/s | 26.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.10870 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.453 | L2-Norm(final)=2.203 | 4507.8 samples/s | 70.4 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.10196 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.473 | L2-Norm(final)=2.212 | 4569.4 samples/s | 71.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.09844 | Reg=0.00272 | acc=0.8906 | L2-Norm=16.491 | L2-Norm(final)=2.218 | 5725.8 samples/s | 89.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.09246 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.507 | L2-Norm(final)=2.224 | 1773.5 samples/s | 27.7 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.08728 | Reg=0.00273 | acc=0.9531 | L2-Norm=16.524 | L2-Norm(final)=2.232 | 4526.9 samples/s | 70.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.08269 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.541 | L2-Norm(final)=2.239 | 4473.0 samples/s | 69.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.07907 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.556 | L2-Norm(final)=2.246 | 5390.8 samples/s | 84.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.07560 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=2.252 | 1772.1 samples/s | 27.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.07246 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.584 | L2-Norm(final)=2.258 | 4459.1 samples/s | 69.7 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.06989 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=2.264 | 4446.4 samples/s | 69.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.06768 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.607 | L2-Norm(final)=2.269 | 5069.2 samples/s | 79.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.27138 | Reg=0.00267 | acc=0.7031 | L2-Norm=16.343 | L2-Norm(final)=2.161 | 3568.5 samples/s | 55.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17066 | Reg=0.00274 | acc=0.8906 | L2-Norm=16.540 | L2-Norm(final)=2.162 | 4430.1 samples/s | 69.2 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14145 | Reg=0.00276 | acc=0.8438 | L2-Norm=16.620 | L2-Norm(final)=2.166 | 4542.6 samples/s | 71.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13454 | Reg=0.00277 | acc=0.9219 | L2-Norm=16.648 | L2-Norm(final)=2.169 | 4459.6 samples/s | 69.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12754 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.670 | L2-Norm(final)=2.170 | 6036.0 samples/s | 94.3 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11532 | Reg=0.00279 | acc=0.8906 | L2-Norm=16.694 | L2-Norm(final)=2.175 | 1714.6 samples/s | 26.8 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10597 | Reg=0.00279 | acc=0.9219 | L2-Norm=16.714 | L2-Norm(final)=2.182 | 4464.2 samples/s | 69.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10042 | Reg=0.00280 | acc=0.9219 | L2-Norm=16.732 | L2-Norm(final)=2.188 | 4443.2 samples/s | 69.4 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.09652 | Reg=0.00281 | acc=0.8906 | L2-Norm=16.750 | L2-Norm(final)=2.194 | 5432.4 samples/s | 84.9 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09157 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.767 | L2-Norm(final)=2.199 | 1770.5 samples/s | 27.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08658 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.784 | L2-Norm(final)=2.205 | 4493.6 samples/s | 70.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08243 | Reg=0.00282 | acc=0.9688 | L2-Norm=16.801 | L2-Norm(final)=2.210 | 4430.7 samples/s | 69.2 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07897 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.816 | L2-Norm(final)=2.216 | 5118.1 samples/s | 80.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07573 | Reg=0.00283 | acc=0.9531 | L2-Norm=16.831 | L2-Norm(final)=2.222 | 1811.9 samples/s | 28.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07311 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.846 | L2-Norm(final)=2.227 | 4429.7 samples/s | 69.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07077 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.860 | L2-Norm(final)=2.231 | 4493.3 samples/s | 70.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06850 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.875 | L2-Norm(final)=2.235 | 4896.4 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.26018 | Reg=0.00267 | acc=0.7188 | L2-Norm=16.343 | L2-Norm(final)=2.162 | 3544.8 samples/s | 55.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17560 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.451 | L2-Norm(final)=2.161 | 4189.2 samples/s | 65.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14904 | Reg=0.00273 | acc=0.9062 | L2-Norm=16.510 | L2-Norm(final)=2.171 | 4579.7 samples/s | 71.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13181 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.543 | L2-Norm(final)=2.183 | 4525.6 samples/s | 70.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12260 | Reg=0.00275 | acc=0.9219 | L2-Norm=16.568 | L2-Norm(final)=2.193 | 6108.2 samples/s | 95.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11152 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.590 | L2-Norm(final)=2.202 | 1706.9 samples/s | 26.7 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10280 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.614 | L2-Norm(final)=2.213 | 4307.1 samples/s | 67.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09683 | Reg=0.00277 | acc=0.9375 | L2-Norm=16.634 | L2-Norm(final)=2.222 | 4404.9 samples/s | 68.8 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09070 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.652 | L2-Norm(final)=2.231 | 5488.9 samples/s | 85.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08590 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.670 | L2-Norm(final)=2.240 | 1737.3 samples/s | 27.1 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08065 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.688 | L2-Norm(final)=2.249 | 4529.9 samples/s | 70.8 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07630 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.705 | L2-Norm(final)=2.257 | 4414.5 samples/s | 69.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07294 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=2.266 | 5114.9 samples/s | 79.9 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07059 | Reg=0.00280 | acc=0.9219 | L2-Norm=16.734 | L2-Norm(final)=2.273 | 1815.2 samples/s | 28.4 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06865 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.751 | L2-Norm(final)=2.279 | 4419.3 samples/s | 69.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06623 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.769 | L2-Norm(final)=2.285 | 4528.3 samples/s | 70.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06408 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.784 | L2-Norm(final)=2.291 | 4795.3 samples/s | 74.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.18714 | Reg=0.00267 | acc=0.8438 | L2-Norm=16.343 | L2-Norm(final)=2.161 | 3867.3 samples/s | 60.4 steps/s
[Step=1650 Epoch=15.8] | Loss=0.06687 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.756 | L2-Norm(final)=2.141 | 3721.4 samples/s | 58.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.03778 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.872 | L2-Norm(final)=2.147 | 5943.3 samples/s | 92.9 steps/s
[Step=1750 Epoch=16.7] | Loss=0.02579 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.886 | L2-Norm(final)=2.153 | 1663.4 samples/s | 26.0 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01955 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.870 | L2-Norm(final)=2.157 | 5441.5 samples/s | 85.0 steps/s
[Step=1850 Epoch=17.7] | Loss=0.01570 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=2.160 | 1702.3 samples/s | 26.6 steps/s
[Step=1900 Epoch=18.1] | Loss=0.01309 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.808 | L2-Norm(final)=2.163 | 5191.9 samples/s | 81.1 steps/s
[Step=1950 Epoch=18.6] | Loss=0.01123 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.770 | L2-Norm(final)=2.166 | 1729.6 samples/s | 27.0 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00983 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.731 | L2-Norm(final)=2.168 | 4908.4 samples/s | 76.7 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00874 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=2.169 | 1755.8 samples/s | 27.4 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00787 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=2.171 | 4447.0 samples/s | 69.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00715 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=2.172 | 1811.1 samples/s | 28.3 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00656 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.566 | L2-Norm(final)=2.173 | 4397.5 samples/s | 68.7 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00605 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.525 | L2-Norm(final)=2.174 | 1785.5 samples/s | 27.9 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00562 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.484 | L2-Norm(final)=2.175 | 4288.7 samples/s | 67.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00525 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=2.176 | 1846.7 samples/s | 28.9 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00492 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=2.177 | 4393.5 samples/s | 68.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21524 | acc=0.7973 | tpr=0.7661 | fpr=0.1350 | 3857.5 samples/s | 15.1 steps/s
Avg test loss: 0.21638, Avg test acc: 0.79478, Avg tpr: 0.76505, Avg fpr: 0.13985, total FA: 1091

Testing server on iccad2012
[Step=  50] | Loss=0.34427 | acc=0.6623 | tpr=0.9292 | fpr=0.3425 | 3837.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.34471 | acc=0.6614 | tpr=0.9339 | fpr=0.3437 | 7670.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.34430 | acc=0.6594 | tpr=0.9352 | fpr=0.3456 | 7512.9 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.34413 | acc=0.6597 | tpr=0.9344 | fpr=0.3453 | 7995.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.34463 | acc=0.6609 | tpr=0.9389 | fpr=0.3442 | 7627.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.34417 | acc=0.6608 | tpr=0.9404 | fpr=0.3443 | 7917.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.34455 | acc=0.6605 | tpr=0.9424 | fpr=0.3446 | 7865.2 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.34499 | acc=0.6600 | tpr=0.9404 | fpr=0.3451 | 7983.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.34530 | acc=0.6596 | tpr=0.9406 | fpr=0.3455 | 7127.3 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.34526 | acc=0.6596 | tpr=0.9405 | fpr=0.3455 | 7637.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.34467 | acc=0.6600 | tpr=0.9407 | fpr=0.3451 | 13884.7 samples/s | 54.2 steps/s
Avg test loss: 0.34483, Avg test acc: 0.65988, Avg tpr: 0.94097, Avg fpr: 0.34523, total FA: 47935

server round 3/50

clients selected: [0 4 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.19893 | Reg=0.00256 | acc=0.8125 | L2-Norm=16.009 | L2-Norm(final)=2.217 | 3808.9 samples/s | 59.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.13865 | Reg=0.00260 | acc=0.9219 | L2-Norm=16.128 | L2-Norm(final)=2.215 | 4087.3 samples/s | 63.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11305 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.184 | L2-Norm(final)=2.225 | 4540.9 samples/s | 71.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10493 | Reg=0.00263 | acc=0.9062 | L2-Norm=16.218 | L2-Norm(final)=2.236 | 4471.2 samples/s | 69.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09728 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.239 | L2-Norm(final)=2.245 | 6077.1 samples/s | 95.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08629 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.259 | L2-Norm(final)=2.253 | 1730.7 samples/s | 27.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08057 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=2.262 | 4538.6 samples/s | 70.9 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07622 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=2.269 | 4492.0 samples/s | 70.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07326 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.310 | L2-Norm(final)=2.276 | 5508.7 samples/s | 86.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06863 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.329 | L2-Norm(final)=2.283 | 1775.8 samples/s | 27.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06472 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.346 | L2-Norm(final)=2.291 | 4498.7 samples/s | 70.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06182 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.363 | L2-Norm(final)=2.298 | 4526.5 samples/s | 70.7 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05993 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.379 | L2-Norm(final)=2.304 | 5202.9 samples/s | 81.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05769 | Reg=0.00269 | acc=0.9531 | L2-Norm=16.395 | L2-Norm(final)=2.310 | 1788.5 samples/s | 27.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05543 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.410 | L2-Norm(final)=2.315 | 4414.4 samples/s | 69.0 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05384 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.425 | L2-Norm(final)=2.320 | 4520.4 samples/s | 70.6 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05239 | Reg=0.00270 | acc=0.9531 | L2-Norm=16.440 | L2-Norm(final)=2.324 | 4888.7 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.19141 | Reg=0.00256 | acc=0.7969 | L2-Norm=16.009 | L2-Norm(final)=2.217 | 3554.1 samples/s | 55.5 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.11684 | Reg=0.00262 | acc=0.9062 | L2-Norm=16.181 | L2-Norm(final)=2.226 | 4321.5 samples/s | 67.5 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10649 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.249 | L2-Norm(final)=2.234 | 4568.9 samples/s | 71.4 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.09981 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.287 | L2-Norm(final)=2.241 | 4517.1 samples/s | 70.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09420 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.316 | L2-Norm(final)=2.246 | 6186.5 samples/s | 96.7 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.08553 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.342 | L2-Norm(final)=2.251 | 1753.6 samples/s | 27.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07920 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.366 | L2-Norm(final)=2.258 | 4431.2 samples/s | 69.2 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.07521 | Reg=0.00269 | acc=0.9062 | L2-Norm=16.388 | L2-Norm(final)=2.265 | 4411.9 samples/s | 68.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07145 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.410 | L2-Norm(final)=2.270 | 5826.5 samples/s | 91.0 steps/s
[Step=2050 Epoch=10.1] | Loss=0.06778 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.430 | L2-Norm(final)=2.275 | 1744.1 samples/s | 27.3 steps/s
[Step=2100 Epoch=10.3] | Loss=0.06520 | Reg=0.00271 | acc=0.9062 | L2-Norm=16.451 | L2-Norm(final)=2.280 | 4500.4 samples/s | 70.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06220 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.473 | L2-Norm(final)=2.286 | 4540.3 samples/s | 70.9 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05972 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.493 | L2-Norm(final)=2.291 | 5565.1 samples/s | 87.0 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05711 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.512 | L2-Norm(final)=2.295 | 1747.5 samples/s | 27.3 steps/s
[Step=2300 Epoch=11.3] | Loss=0.05463 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.529 | L2-Norm(final)=2.300 | 4528.7 samples/s | 70.8 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05345 | Reg=0.00274 | acc=0.9062 | L2-Norm=16.545 | L2-Norm(final)=2.305 | 4402.2 samples/s | 68.8 steps/s
[Step=2400 Epoch=11.8] | Loss=0.05202 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.560 | L2-Norm(final)=2.308 | 5235.1 samples/s | 81.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.13235 | Reg=0.00256 | acc=0.8906 | L2-Norm=16.009 | L2-Norm(final)=2.216 | 3618.8 samples/s | 56.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.05052 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.362 | L2-Norm(final)=2.196 | 4106.9 samples/s | 64.2 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02802 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.467 | L2-Norm(final)=2.200 | 5845.0 samples/s | 91.3 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01892 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=2.207 | 1657.0 samples/s | 25.9 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01421 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=2.213 | 5387.6 samples/s | 84.2 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01138 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=2.216 | 1735.1 samples/s | 27.1 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00949 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.427 | L2-Norm(final)=2.219 | 5054.0 samples/s | 79.0 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00813 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.392 | L2-Norm(final)=2.221 | 1790.2 samples/s | 28.0 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00712 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=2.223 | 4653.9 samples/s | 72.7 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00633 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=2.225 | 1806.5 samples/s | 28.2 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00570 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.278 | L2-Norm(final)=2.228 | 4405.4 samples/s | 68.8 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00518 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.238 | L2-Norm(final)=2.230 | 1849.8 samples/s | 28.9 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00475 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.198 | L2-Norm(final)=2.232 | 4307.3 samples/s | 67.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00439 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=2.235 | 1896.1 samples/s | 29.6 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00407 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.119 | L2-Norm(final)=2.238 | 4289.9 samples/s | 67.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00380 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=2.241 | 1887.9 samples/s | 29.5 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00357 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.039 | L2-Norm(final)=2.244 | 4340.9 samples/s | 67.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.20034 | Reg=0.00256 | acc=0.8438 | L2-Norm=16.009 | L2-Norm(final)=2.215 | 3677.1 samples/s | 57.5 steps/s
[Step=2450 Epoch=23.4] | Loss=0.05636 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=2.191 | 4002.0 samples/s | 62.5 steps/s
[Step=2500 Epoch=23.9] | Loss=0.03392 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=2.187 | 5793.1 samples/s | 90.5 steps/s
[Step=2550 Epoch=24.4] | Loss=0.02314 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.638 | L2-Norm(final)=2.191 | 1671.8 samples/s | 26.1 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01753 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.643 | L2-Norm(final)=2.195 | 5438.7 samples/s | 85.0 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01404 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=2.199 | 1703.3 samples/s | 26.6 steps/s
[Step=2700 Epoch=25.8] | Loss=0.01171 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=2.202 | 5134.0 samples/s | 80.2 steps/s
[Step=2750 Epoch=26.3] | Loss=0.01004 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.579 | L2-Norm(final)=2.204 | 1732.8 samples/s | 27.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00879 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.546 | L2-Norm(final)=2.206 | 4833.1 samples/s | 75.5 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00781 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.511 | L2-Norm(final)=2.208 | 1799.1 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00703 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=2.210 | 4581.1 samples/s | 71.6 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00639 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=2.211 | 1813.3 samples/s | 28.3 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00586 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.400 | L2-Norm(final)=2.212 | 4378.9 samples/s | 68.4 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00541 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=2.213 | 1823.6 samples/s | 28.5 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00503 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=2.215 | 4259.8 samples/s | 66.6 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00469 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.285 | L2-Norm(final)=2.216 | 1868.6 samples/s | 29.2 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00440 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=2.217 | 4383.6 samples/s | 68.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.21854 | Reg=0.00256 | acc=0.7656 | L2-Norm=16.009 | L2-Norm(final)=2.216 | 3533.6 samples/s | 55.2 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.05181 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=2.193 | 4061.1 samples/s | 63.5 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03102 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=2.197 | 5873.4 samples/s | 91.8 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02122 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=2.202 | 1665.0 samples/s | 26.0 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01596 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=2.206 | 5480.5 samples/s | 85.6 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01278 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.428 | L2-Norm(final)=2.209 | 1714.0 samples/s | 26.8 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01066 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=2.213 | 5186.0 samples/s | 81.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00914 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=2.217 | 1757.0 samples/s | 27.5 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00800 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=2.221 | 4781.0 samples/s | 74.7 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00711 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=2.226 | 1788.7 samples/s | 27.9 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00640 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.294 | L2-Norm(final)=2.231 | 4562.8 samples/s | 71.3 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00582 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.262 | L2-Norm(final)=2.235 | 1824.1 samples/s | 28.5 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00534 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.230 | L2-Norm(final)=2.240 | 4403.5 samples/s | 68.8 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00493 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.197 | L2-Norm(final)=2.245 | 1869.4 samples/s | 29.2 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00458 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.164 | L2-Norm(final)=2.249 | 4401.6 samples/s | 68.8 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00427 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.130 | L2-Norm(final)=2.254 | 1852.5 samples/s | 28.9 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00401 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=2.259 | 4380.2 samples/s | 68.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24767 | acc=0.7572 | tpr=0.6956 | fpr=0.1090 | 3879.1 samples/s | 15.2 steps/s
Avg test loss: 0.24792, Avg test acc: 0.75823, Avg tpr: 0.69773, Avg fpr: 0.10870, total FA: 848

Testing server on iccad2012
[Step=  50] | Loss=0.22925 | acc=0.8095 | tpr=0.9336 | fpr=0.1927 | 3982.6 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.23085 | acc=0.8090 | tpr=0.9531 | fpr=0.1937 | 7915.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.23110 | acc=0.8089 | tpr=0.9597 | fpr=0.1938 | 8142.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.23127 | acc=0.8095 | tpr=0.9596 | fpr=0.1933 | 7681.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.23144 | acc=0.8092 | tpr=0.9590 | fpr=0.1935 | 7676.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.23157 | acc=0.8094 | tpr=0.9615 | fpr=0.1934 | 7906.9 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.23202 | acc=0.8091 | tpr=0.9612 | fpr=0.1936 | 7682.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.23230 | acc=0.8092 | tpr=0.9584 | fpr=0.1935 | 7979.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.23287 | acc=0.8087 | tpr=0.9586 | fpr=0.1941 | 7617.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.23270 | acc=0.8087 | tpr=0.9568 | fpr=0.1940 | 7437.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.23219 | acc=0.8094 | tpr=0.9570 | fpr=0.1933 | 13797.5 samples/s | 53.9 steps/s
Avg test loss: 0.23227, Avg test acc: 0.80937, Avg tpr: 0.95721, Avg fpr: 0.19332, total FA: 26842

server round 4/50

clients selected: [1 2 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.20710 | Reg=0.00249 | acc=0.7812 | L2-Norm=15.768 | L2-Norm(final)=2.258 | 3748.1 samples/s | 58.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12039 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.873 | L2-Norm(final)=2.264 | 4170.8 samples/s | 65.2 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.10235 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.932 | L2-Norm(final)=2.269 | 4483.9 samples/s | 70.1 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.09440 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.963 | L2-Norm(final)=2.274 | 4497.1 samples/s | 70.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08902 | Reg=0.00256 | acc=0.9531 | L2-Norm=15.984 | L2-Norm(final)=2.277 | 6053.3 samples/s | 94.6 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.07951 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.005 | L2-Norm(final)=2.283 | 1710.6 samples/s | 26.7 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.07430 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.027 | L2-Norm(final)=2.290 | 4534.7 samples/s | 70.9 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07030 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.046 | L2-Norm(final)=2.297 | 4565.3 samples/s | 71.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06716 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.064 | L2-Norm(final)=2.303 | 5674.3 samples/s | 88.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.06279 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.083 | L2-Norm(final)=2.309 | 1735.2 samples/s | 27.1 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.05942 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.100 | L2-Norm(final)=2.315 | 4454.6 samples/s | 69.6 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05709 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.116 | L2-Norm(final)=2.321 | 4551.3 samples/s | 71.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05531 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.131 | L2-Norm(final)=2.327 | 5368.5 samples/s | 83.9 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05305 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.146 | L2-Norm(final)=2.332 | 1769.9 samples/s | 27.7 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05106 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.161 | L2-Norm(final)=2.338 | 4494.9 samples/s | 70.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04985 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.176 | L2-Norm(final)=2.343 | 4417.5 samples/s | 69.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04877 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.192 | L2-Norm(final)=2.347 | 5121.1 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.14144 | Reg=0.00249 | acc=0.8906 | L2-Norm=15.768 | L2-Norm(final)=2.259 | 3833.8 samples/s | 59.9 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.12120 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.879 | L2-Norm(final)=2.258 | 4133.6 samples/s | 64.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10431 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.936 | L2-Norm(final)=2.262 | 4504.2 samples/s | 70.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09544 | Reg=0.00255 | acc=0.8906 | L2-Norm=15.969 | L2-Norm(final)=2.268 | 4551.0 samples/s | 71.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09217 | Reg=0.00256 | acc=0.9062 | L2-Norm=16.000 | L2-Norm(final)=2.271 | 6055.5 samples/s | 94.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08346 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.035 | L2-Norm(final)=2.276 | 1713.7 samples/s | 26.8 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07865 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.068 | L2-Norm(final)=2.282 | 4481.3 samples/s | 70.0 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07468 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.097 | L2-Norm(final)=2.287 | 4484.4 samples/s | 70.1 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07048 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.123 | L2-Norm(final)=2.292 | 5562.0 samples/s | 86.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06651 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.147 | L2-Norm(final)=2.297 | 1776.6 samples/s | 27.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06273 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=2.304 | 4544.9 samples/s | 71.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05975 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.195 | L2-Norm(final)=2.310 | 4471.8 samples/s | 69.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05777 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.215 | L2-Norm(final)=2.316 | 5199.8 samples/s | 81.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05535 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.233 | L2-Norm(final)=2.321 | 1828.4 samples/s | 28.6 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05333 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.250 | L2-Norm(final)=2.326 | 4596.9 samples/s | 71.8 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05142 | Reg=0.00265 | acc=0.9062 | L2-Norm=16.268 | L2-Norm(final)=2.331 | 4565.4 samples/s | 71.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05007 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.285 | L2-Norm(final)=2.336 | 4862.0 samples/s | 76.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.06904 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.768 | L2-Norm(final)=2.259 | 3543.4 samples/s | 55.4 steps/s
[Step=3250 Epoch=31.0] | Loss=0.03364 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.064 | L2-Norm(final)=2.251 | 4154.3 samples/s | 64.9 steps/s
[Step=3300 Epoch=31.5] | Loss=0.02257 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.195 | L2-Norm(final)=2.248 | 5884.8 samples/s | 92.0 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01517 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=2.250 | 1656.3 samples/s | 25.9 steps/s
[Step=3400 Epoch=32.5] | Loss=0.01141 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.230 | L2-Norm(final)=2.254 | 5448.7 samples/s | 85.1 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00914 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=2.256 | 1714.0 samples/s | 26.8 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00762 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.184 | L2-Norm(final)=2.258 | 5085.9 samples/s | 79.5 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00653 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.152 | L2-Norm(final)=2.260 | 1727.8 samples/s | 27.0 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00572 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=2.262 | 4755.1 samples/s | 74.3 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00508 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=2.263 | 1789.3 samples/s | 28.0 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00458 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.046 | L2-Norm(final)=2.264 | 4513.5 samples/s | 70.5 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00416 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.009 | L2-Norm(final)=2.265 | 1833.0 samples/s | 28.6 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00382 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.971 | L2-Norm(final)=2.266 | 4378.5 samples/s | 68.4 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00352 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.934 | L2-Norm(final)=2.267 | 1847.5 samples/s | 28.9 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00327 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.896 | L2-Norm(final)=2.267 | 4322.8 samples/s | 67.5 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00306 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.858 | L2-Norm(final)=2.268 | 1843.1 samples/s | 28.8 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00287 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.820 | L2-Norm(final)=2.269 | 4377.5 samples/s | 68.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.16887 | Reg=0.00249 | acc=0.8906 | L2-Norm=15.768 | L2-Norm(final)=2.257 | 3559.8 samples/s | 55.6 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.04468 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.004 | L2-Norm(final)=2.248 | 4114.6 samples/s | 64.3 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02512 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.071 | L2-Norm(final)=2.254 | 5819.0 samples/s | 90.9 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01728 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.083 | L2-Norm(final)=2.262 | 1710.4 samples/s | 26.7 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01319 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.078 | L2-Norm(final)=2.269 | 5314.8 samples/s | 83.0 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01062 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.062 | L2-Norm(final)=2.275 | 1743.1 samples/s | 27.2 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00886 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.039 | L2-Norm(final)=2.279 | 4903.0 samples/s | 76.6 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00760 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.011 | L2-Norm(final)=2.283 | 1788.3 samples/s | 27.9 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00665 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.981 | L2-Norm(final)=2.285 | 4535.1 samples/s | 70.9 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00592 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.949 | L2-Norm(final)=2.288 | 1837.4 samples/s | 28.7 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00533 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.916 | L2-Norm(final)=2.290 | 4334.6 samples/s | 67.7 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00484 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.882 | L2-Norm(final)=2.292 | 1889.9 samples/s | 29.5 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00444 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.849 | L2-Norm(final)=2.293 | 4339.8 samples/s | 67.8 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00410 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.815 | L2-Norm(final)=2.295 | 1871.7 samples/s | 29.2 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00381 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.781 | L2-Norm(final)=2.296 | 4341.1 samples/s | 67.8 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00356 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=2.297 | 1984.9 samples/s | 31.0 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00333 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.713 | L2-Norm(final)=2.298 | 3876.9 samples/s | 60.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step1600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.11442 | Reg=0.00249 | acc=0.8906 | L2-Norm=15.768 | L2-Norm(final)=2.259 | 3561.2 samples/s | 55.6 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03706 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.981 | L2-Norm(final)=2.240 | 4048.7 samples/s | 63.3 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02234 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.069 | L2-Norm(final)=2.242 | 5882.7 samples/s | 91.9 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01512 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.091 | L2-Norm(final)=2.245 | 1670.4 samples/s | 26.1 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01137 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.084 | L2-Norm(final)=2.249 | 5502.6 samples/s | 86.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00911 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.064 | L2-Norm(final)=2.252 | 1707.9 samples/s | 26.7 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00760 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.038 | L2-Norm(final)=2.254 | 4996.5 samples/s | 78.1 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00651 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=2.256 | 1736.0 samples/s | 27.1 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00570 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.975 | L2-Norm(final)=2.258 | 4806.4 samples/s | 75.1 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00507 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.941 | L2-Norm(final)=2.259 | 1776.6 samples/s | 27.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00457 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.907 | L2-Norm(final)=2.261 | 4659.8 samples/s | 72.8 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00415 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.872 | L2-Norm(final)=2.262 | 1816.8 samples/s | 28.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00381 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.836 | L2-Norm(final)=2.263 | 4433.5 samples/s | 69.3 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00352 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.800 | L2-Norm(final)=2.264 | 1861.5 samples/s | 29.1 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00327 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.765 | L2-Norm(final)=2.264 | 4207.9 samples/s | 65.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00305 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.729 | L2-Norm(final)=2.265 | 1860.4 samples/s | 29.1 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00286 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.693 | L2-Norm(final)=2.266 | 4318.2 samples/s | 67.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25773 | acc=0.7561 | tpr=0.6767 | fpr=0.0716 | 4039.4 samples/s | 15.8 steps/s
Avg test loss: 0.25834, Avg test acc: 0.75727, Avg tpr: 0.68001, Avg fpr: 0.07281, total FA: 568

Testing server on iccad2012
[Step=  50] | Loss=0.21257 | acc=0.8341 | tpr=0.9336 | fpr=0.1677 | 3987.0 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.21388 | acc=0.8331 | tpr=0.9488 | fpr=0.1691 | 7623.6 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.21404 | acc=0.8345 | tpr=0.9582 | fpr=0.1678 | 7850.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.21443 | acc=0.8349 | tpr=0.9607 | fpr=0.1674 | 7577.8 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.21464 | acc=0.8347 | tpr=0.9598 | fpr=0.1676 | 7716.7 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.21488 | acc=0.8350 | tpr=0.9615 | fpr=0.1673 | 7732.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.21524 | acc=0.8349 | tpr=0.9606 | fpr=0.1674 | 7661.2 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.21538 | acc=0.8349 | tpr=0.9573 | fpr=0.1674 | 7735.0 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.21593 | acc=0.8341 | tpr=0.9567 | fpr=0.1682 | 7751.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.21577 | acc=0.8341 | tpr=0.9546 | fpr=0.1681 | 7815.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.21535 | acc=0.8345 | tpr=0.9550 | fpr=0.1677 | 13785.7 samples/s | 53.9 steps/s
Avg test loss: 0.21547, Avg test acc: 0.83451, Avg tpr: 0.95523, Avg fpr: 0.16769, total FA: 23283

server round 5/50

clients selected: [2 4 5 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.20584 | Reg=0.00242 | acc=0.8594 | L2-Norm=15.548 | L2-Norm(final)=2.295 | 3509.6 samples/s | 54.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.10001 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.674 | L2-Norm(final)=2.295 | 4458.8 samples/s | 69.7 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08821 | Reg=0.00247 | acc=0.9062 | L2-Norm=15.729 | L2-Norm(final)=2.300 | 4465.4 samples/s | 69.8 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08325 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.761 | L2-Norm(final)=2.303 | 4510.2 samples/s | 70.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07880 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.786 | L2-Norm(final)=2.306 | 5991.9 samples/s | 93.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07071 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.809 | L2-Norm(final)=2.311 | 1714.8 samples/s | 26.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06607 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.830 | L2-Norm(final)=2.317 | 4481.9 samples/s | 70.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06282 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.851 | L2-Norm(final)=2.323 | 4434.0 samples/s | 69.3 steps/s
[Step=2800 Epoch=13.6] | Loss=0.06013 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.871 | L2-Norm(final)=2.327 | 5566.1 samples/s | 87.0 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05771 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.892 | L2-Norm(final)=2.332 | 1757.6 samples/s | 27.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05517 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.911 | L2-Norm(final)=2.337 | 4477.4 samples/s | 70.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05323 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.929 | L2-Norm(final)=2.341 | 4503.4 samples/s | 70.4 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05136 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.947 | L2-Norm(final)=2.345 | 5207.5 samples/s | 81.4 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04940 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.965 | L2-Norm(final)=2.349 | 1816.6 samples/s | 28.4 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04763 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.982 | L2-Norm(final)=2.353 | 4475.7 samples/s | 69.9 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04586 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.998 | L2-Norm(final)=2.357 | 4357.2 samples/s | 68.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04496 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.012 | L2-Norm(final)=2.361 | 4908.9 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.18297 | Reg=0.00242 | acc=0.8438 | L2-Norm=15.548 | L2-Norm(final)=2.295 | 3603.6 samples/s | 56.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09580 | Reg=0.00245 | acc=0.8750 | L2-Norm=15.649 | L2-Norm(final)=2.295 | 4292.2 samples/s | 67.1 steps/s
[Step=2500 Epoch=12.3] | Loss=0.08143 | Reg=0.00247 | acc=0.9219 | L2-Norm=15.706 | L2-Norm(final)=2.300 | 4399.9 samples/s | 68.7 steps/s
[Step=2550 Epoch=12.5] | Loss=0.07998 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.744 | L2-Norm(final)=2.305 | 4483.9 samples/s | 70.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07536 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.775 | L2-Norm(final)=2.306 | 6091.9 samples/s | 95.2 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06641 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.802 | L2-Norm(final)=2.311 | 1718.6 samples/s | 26.9 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06172 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.827 | L2-Norm(final)=2.316 | 4469.2 samples/s | 69.8 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05890 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.851 | L2-Norm(final)=2.322 | 4480.5 samples/s | 70.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05680 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.874 | L2-Norm(final)=2.326 | 5892.7 samples/s | 92.1 steps/s
[Step=2850 Epoch=14.0] | Loss=0.05300 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.897 | L2-Norm(final)=2.331 | 1725.9 samples/s | 27.0 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05070 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.920 | L2-Norm(final)=2.336 | 4481.8 samples/s | 70.0 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04864 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.941 | L2-Norm(final)=2.340 | 4502.4 samples/s | 70.3 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04706 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.960 | L2-Norm(final)=2.344 | 5354.7 samples/s | 83.7 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04552 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.978 | L2-Norm(final)=2.348 | 1766.5 samples/s | 27.6 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04358 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.996 | L2-Norm(final)=2.351 | 4532.1 samples/s | 70.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04223 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.012 | L2-Norm(final)=2.355 | 4536.5 samples/s | 70.9 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04127 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.029 | L2-Norm(final)=2.358 | 5274.9 samples/s | 82.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.12694 | Reg=0.00242 | acc=0.9062 | L2-Norm=15.548 | L2-Norm(final)=2.295 | 3518.1 samples/s | 55.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.03198 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=2.300 | 4088.7 samples/s | 63.9 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.01912 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.542 | L2-Norm(final)=2.312 | 5705.7 samples/s | 89.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.01288 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=2.322 | 1668.8 samples/s | 26.1 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.00983 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.517 | L2-Norm(final)=2.330 | 5353.0 samples/s | 83.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.00796 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.495 | L2-Norm(final)=2.338 | 1713.9 samples/s | 26.8 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.00664 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.468 | L2-Norm(final)=2.344 | 4953.7 samples/s | 77.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.00570 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.437 | L2-Norm(final)=2.349 | 1759.2 samples/s | 27.5 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.00499 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.403 | L2-Norm(final)=2.353 | 4619.9 samples/s | 72.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.00444 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=2.357 | 1824.9 samples/s | 28.5 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.00400 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.329 | L2-Norm(final)=2.362 | 4436.8 samples/s | 69.3 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00363 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.290 | L2-Norm(final)=2.365 | 1857.2 samples/s | 29.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00333 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.250 | L2-Norm(final)=2.369 | 4364.3 samples/s | 68.2 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00308 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.209 | L2-Norm(final)=2.373 | 1864.8 samples/s | 29.1 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00286 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.167 | L2-Norm(final)=2.377 | 4414.7 samples/s | 69.0 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00267 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=2.380 | 1868.6 samples/s | 29.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00250 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=2.384 | 4286.3 samples/s | 67.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.07711 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.548 | L2-Norm(final)=2.296 | 3569.8 samples/s | 55.8 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03130 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=2.287 | 4074.2 samples/s | 63.7 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01855 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.912 | L2-Norm(final)=2.282 | 5834.2 samples/s | 91.2 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01373 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.955 | L2-Norm(final)=2.285 | 1664.0 samples/s | 26.0 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01039 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=2.288 | 5336.8 samples/s | 83.4 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00832 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=2.292 | 1716.7 samples/s | 26.8 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00693 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.947 | L2-Norm(final)=2.294 | 5012.0 samples/s | 78.3 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00595 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.923 | L2-Norm(final)=2.296 | 1749.1 samples/s | 27.3 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00520 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.895 | L2-Norm(final)=2.297 | 4631.5 samples/s | 72.4 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00463 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.865 | L2-Norm(final)=2.298 | 1826.4 samples/s | 28.5 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00417 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.833 | L2-Norm(final)=2.300 | 4369.8 samples/s | 68.3 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00379 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.801 | L2-Norm(final)=2.301 | 1846.7 samples/s | 28.9 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00347 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.767 | L2-Norm(final)=2.302 | 4396.4 samples/s | 68.7 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00321 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.733 | L2-Norm(final)=2.303 | 1856.6 samples/s | 29.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00298 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.699 | L2-Norm(final)=2.304 | 4379.5 samples/s | 68.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00278 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.665 | L2-Norm(final)=2.305 | 1868.7 samples/s | 29.2 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00261 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.631 | L2-Norm(final)=2.306 | 4308.4 samples/s | 67.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.07855 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.548 | L2-Norm(final)=2.295 | 3403.3 samples/s | 53.2 steps/s
[Step=4050 Epoch=38.7] | Loss=0.02341 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.818 | L2-Norm(final)=2.297 | 4204.5 samples/s | 65.7 steps/s
[Step=4100 Epoch=39.2] | Loss=0.01566 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.916 | L2-Norm(final)=2.290 | 5840.9 samples/s | 91.3 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01110 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.945 | L2-Norm(final)=2.288 | 1660.3 samples/s | 25.9 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00889 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.948 | L2-Norm(final)=2.289 | 5467.5 samples/s | 85.4 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00717 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=2.291 | 1698.0 samples/s | 26.5 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00598 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.928 | L2-Norm(final)=2.292 | 5192.1 samples/s | 81.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00513 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.904 | L2-Norm(final)=2.294 | 1728.1 samples/s | 27.0 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00449 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=2.295 | 4762.1 samples/s | 74.4 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00399 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.846 | L2-Norm(final)=2.297 | 1764.1 samples/s | 27.6 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00360 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.814 | L2-Norm(final)=2.299 | 4538.8 samples/s | 70.9 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00327 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.781 | L2-Norm(final)=2.300 | 1811.9 samples/s | 28.3 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00300 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=2.302 | 4442.9 samples/s | 69.4 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00277 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.712 | L2-Norm(final)=2.304 | 1857.9 samples/s | 29.0 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00257 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.678 | L2-Norm(final)=2.305 | 4396.9 samples/s | 68.7 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00240 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.642 | L2-Norm(final)=2.307 | 1824.7 samples/s | 28.5 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00225 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.607 | L2-Norm(final)=2.309 | 4355.6 samples/s | 68.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46084 | acc=0.6488 | tpr=0.5016 | fpr=0.0317 | 3927.8 samples/s | 15.3 steps/s
Avg test loss: 0.45958, Avg test acc: 0.65258, Avg tpr: 0.50941, Avg fpr: 0.03256, total FA: 254

Testing server on iccad2012
[Step=  50] | Loss=0.14216 | acc=0.9040 | tpr=0.9469 | fpr=0.0968 | 3942.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.14361 | acc=0.9050 | tpr=0.9574 | fpr=0.0960 | 7697.9 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.14480 | acc=0.9052 | tpr=0.9654 | fpr=0.0959 | 7842.0 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.14595 | acc=0.9055 | tpr=0.9672 | fpr=0.0956 | 7654.8 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.14552 | acc=0.9060 | tpr=0.9651 | fpr=0.0951 | 7772.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.14629 | acc=0.9056 | tpr=0.9636 | fpr=0.0955 | 7710.3 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.14660 | acc=0.9058 | tpr=0.9631 | fpr=0.0952 | 7799.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.14677 | acc=0.9058 | tpr=0.9590 | fpr=0.0952 | 7740.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.14761 | acc=0.9053 | tpr=0.9581 | fpr=0.0957 | 7665.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.14748 | acc=0.9053 | tpr=0.9564 | fpr=0.0956 | 7625.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.14735 | acc=0.9055 | tpr=0.9570 | fpr=0.0954 | 13759.9 samples/s | 53.7 steps/s
Avg test loss: 0.14742, Avg test acc: 0.90546, Avg tpr: 0.95721, Avg fpr: 0.09549, total FA: 13258

server round 6/50

clients selected: [1 3 4 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.32687 | Reg=0.00231 | acc=0.7656 | L2-Norm=15.209 | L2-Norm(final)=2.356 | 3557.8 samples/s | 55.6 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.09980 | Reg=0.00235 | acc=0.8438 | L2-Norm=15.314 | L2-Norm(final)=2.328 | 4410.3 samples/s | 68.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08923 | Reg=0.00236 | acc=0.8906 | L2-Norm=15.361 | L2-Norm(final)=2.326 | 4432.4 samples/s | 69.3 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08361 | Reg=0.00237 | acc=0.8594 | L2-Norm=15.397 | L2-Norm(final)=2.325 | 4533.3 samples/s | 70.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07607 | Reg=0.00238 | acc=0.9062 | L2-Norm=15.427 | L2-Norm(final)=2.327 | 6093.3 samples/s | 95.2 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06868 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.458 | L2-Norm(final)=2.331 | 1729.2 samples/s | 27.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06334 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.487 | L2-Norm(final)=2.336 | 4571.6 samples/s | 71.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05959 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.511 | L2-Norm(final)=2.339 | 4493.3 samples/s | 70.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05668 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.534 | L2-Norm(final)=2.344 | 5624.8 samples/s | 87.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05396 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.556 | L2-Norm(final)=2.348 | 1752.8 samples/s | 27.4 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05087 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.578 | L2-Norm(final)=2.352 | 4398.9 samples/s | 68.7 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04827 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.597 | L2-Norm(final)=2.356 | 4400.6 samples/s | 68.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04691 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.614 | L2-Norm(final)=2.360 | 5314.1 samples/s | 83.0 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04508 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.630 | L2-Norm(final)=2.363 | 1780.4 samples/s | 27.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04323 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.646 | L2-Norm(final)=2.366 | 4446.2 samples/s | 69.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04194 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.660 | L2-Norm(final)=2.369 | 4351.3 samples/s | 68.0 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04075 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.673 | L2-Norm(final)=2.371 | 5077.1 samples/s | 79.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.31327 | Reg=0.00231 | acc=0.6719 | L2-Norm=15.209 | L2-Norm(final)=2.356 | 3617.4 samples/s | 56.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.09842 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.338 | L2-Norm(final)=2.344 | 4486.5 samples/s | 70.1 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08766 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.399 | L2-Norm(final)=2.344 | 4447.0 samples/s | 69.5 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07775 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.438 | L2-Norm(final)=2.346 | 4454.4 samples/s | 69.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07214 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.467 | L2-Norm(final)=2.348 | 6087.0 samples/s | 95.1 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06815 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.500 | L2-Norm(final)=2.351 | 1726.6 samples/s | 27.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06185 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=2.356 | 4511.7 samples/s | 70.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06034 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.565 | L2-Norm(final)=2.361 | 4376.1 samples/s | 68.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05721 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.592 | L2-Norm(final)=2.363 | 5565.6 samples/s | 87.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05349 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.616 | L2-Norm(final)=2.367 | 1762.0 samples/s | 27.5 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05037 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=2.372 | 4497.6 samples/s | 70.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04832 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.659 | L2-Norm(final)=2.376 | 4470.3 samples/s | 69.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04618 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.679 | L2-Norm(final)=2.380 | 4981.5 samples/s | 77.8 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04397 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.697 | L2-Norm(final)=2.384 | 1816.4 samples/s | 28.4 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04216 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.713 | L2-Norm(final)=2.388 | 4419.4 samples/s | 69.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04070 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.727 | L2-Norm(final)=2.392 | 4387.6 samples/s | 68.6 steps/s
[Step=2400 Epoch=11.7] | Loss=0.03932 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.740 | L2-Norm(final)=2.395 | 4813.9 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.29322 | Reg=0.00231 | acc=0.7500 | L2-Norm=15.209 | L2-Norm(final)=2.355 | 3776.5 samples/s | 59.0 steps/s
[Step=3250 Epoch=15.9] | Loss=0.10040 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.352 | L2-Norm(final)=2.333 | 4117.1 samples/s | 64.3 steps/s
[Step=3300 Epoch=16.2] | Loss=0.08030 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.412 | L2-Norm(final)=2.334 | 4447.2 samples/s | 69.5 steps/s
[Step=3350 Epoch=16.4] | Loss=0.07609 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.441 | L2-Norm(final)=2.334 | 4455.0 samples/s | 69.6 steps/s
[Step=3400 Epoch=16.7] | Loss=0.07145 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.468 | L2-Norm(final)=2.333 | 6073.8 samples/s | 94.9 steps/s
[Step=3450 Epoch=16.9] | Loss=0.06410 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.494 | L2-Norm(final)=2.335 | 1708.8 samples/s | 26.7 steps/s
[Step=3500 Epoch=17.2] | Loss=0.05879 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.517 | L2-Norm(final)=2.339 | 4560.8 samples/s | 71.3 steps/s
[Step=3550 Epoch=17.4] | Loss=0.05507 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.537 | L2-Norm(final)=2.343 | 4499.5 samples/s | 70.3 steps/s
[Step=3600 Epoch=17.7] | Loss=0.05313 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.556 | L2-Norm(final)=2.347 | 5843.1 samples/s | 91.3 steps/s
[Step=3650 Epoch=17.9] | Loss=0.05001 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.577 | L2-Norm(final)=2.351 | 1752.5 samples/s | 27.4 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04751 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.599 | L2-Norm(final)=2.355 | 4331.7 samples/s | 67.7 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04640 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.618 | L2-Norm(final)=2.359 | 4452.8 samples/s | 69.6 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04469 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.637 | L2-Norm(final)=2.362 | 5524.6 samples/s | 86.3 steps/s
[Step=3850 Epoch=18.9] | Loss=0.04288 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.656 | L2-Norm(final)=2.365 | 1778.9 samples/s | 27.8 steps/s
[Step=3900 Epoch=19.1] | Loss=0.04143 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.674 | L2-Norm(final)=2.369 | 4524.2 samples/s | 70.7 steps/s
[Step=3950 Epoch=19.4] | Loss=0.04014 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.691 | L2-Norm(final)=2.372 | 4547.9 samples/s | 71.1 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03924 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.706 | L2-Norm(final)=2.375 | 5310.1 samples/s | 83.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.08678 | Reg=0.00231 | acc=0.9062 | L2-Norm=15.209 | L2-Norm(final)=2.356 | 3746.8 samples/s | 58.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.03412 | Reg=0.00239 | acc=0.9219 | L2-Norm=15.465 | L2-Norm(final)=2.334 | 4021.1 samples/s | 62.8 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02433 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.623 | L2-Norm(final)=2.301 | 5733.5 samples/s | 89.6 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01686 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.689 | L2-Norm(final)=2.287 | 1674.8 samples/s | 26.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01280 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.704 | L2-Norm(final)=2.282 | 5405.0 samples/s | 84.5 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01025 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.695 | L2-Norm(final)=2.279 | 1712.7 samples/s | 26.8 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00855 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.674 | L2-Norm(final)=2.278 | 4882.8 samples/s | 76.3 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00733 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.647 | L2-Norm(final)=2.278 | 1747.7 samples/s | 27.3 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00642 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=2.277 | 4675.5 samples/s | 73.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00570 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=2.277 | 1801.8 samples/s | 28.2 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00513 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.547 | L2-Norm(final)=2.278 | 4392.3 samples/s | 68.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00467 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.511 | L2-Norm(final)=2.278 | 1836.7 samples/s | 28.7 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00428 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.475 | L2-Norm(final)=2.278 | 4374.9 samples/s | 68.4 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00395 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=2.278 | 1834.3 samples/s | 28.7 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00367 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=2.279 | 4416.6 samples/s | 69.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00343 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.363 | L2-Norm(final)=2.279 | 1880.3 samples/s | 29.4 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00321 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.326 | L2-Norm(final)=2.279 | 4311.3 samples/s | 67.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.07611 | Reg=0.00231 | acc=0.9219 | L2-Norm=15.209 | L2-Norm(final)=2.355 | 3735.6 samples/s | 58.4 steps/s
[Step=4850 Epoch=46.3] | Loss=0.01510 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.360 | L2-Norm(final)=2.347 | 3888.3 samples/s | 60.8 steps/s
[Step=4900 Epoch=46.8] | Loss=0.01373 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.441 | L2-Norm(final)=2.343 | 5834.4 samples/s | 91.2 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00965 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=2.337 | 1659.6 samples/s | 25.9 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00731 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.499 | L2-Norm(final)=2.335 | 5532.6 samples/s | 86.4 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00586 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=2.335 | 1697.4 samples/s | 26.5 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00489 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.472 | L2-Norm(final)=2.335 | 5032.4 samples/s | 78.6 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00419 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.447 | L2-Norm(final)=2.336 | 1726.9 samples/s | 27.0 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00367 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=2.336 | 4736.5 samples/s | 74.0 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00327 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.388 | L2-Norm(final)=2.337 | 1781.1 samples/s | 27.8 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00294 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.356 | L2-Norm(final)=2.337 | 4533.3 samples/s | 70.8 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00267 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.323 | L2-Norm(final)=2.338 | 1794.3 samples/s | 28.0 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00245 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=2.338 | 4418.8 samples/s | 69.0 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00226 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.256 | L2-Norm(final)=2.339 | 1834.4 samples/s | 28.7 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00210 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.221 | L2-Norm(final)=2.339 | 4380.1 samples/s | 68.4 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00196 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=2.340 | 1856.2 samples/s | 29.0 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00184 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.153 | L2-Norm(final)=2.340 | 4269.4 samples/s | 66.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40700 | acc=0.6782 | tpr=0.5460 | fpr=0.0347 | 3963.5 samples/s | 15.5 steps/s
Avg test loss: 0.40608, Avg test acc: 0.68070, Avg tpr: 0.55179, Avg fpr: 0.03576, total FA: 279

Testing server on iccad2012
[Step=  50] | Loss=0.17762 | acc=0.8871 | tpr=0.9558 | fpr=0.1141 | 3967.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.17812 | acc=0.8892 | tpr=0.9659 | fpr=0.1122 | 7643.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.17937 | acc=0.8893 | tpr=0.9741 | fpr=0.1123 | 7502.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.18045 | acc=0.8894 | tpr=0.9749 | fpr=0.1122 | 4697.7 samples/s | 18.4 steps/s
[Step= 250] | Loss=0.17989 | acc=0.8899 | tpr=0.9755 | fpr=0.1116 | 7787.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.18122 | acc=0.8896 | tpr=0.9738 | fpr=0.1119 | 8236.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.18166 | acc=0.8894 | tpr=0.9718 | fpr=0.1121 | 7318.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.18186 | acc=0.8895 | tpr=0.9683 | fpr=0.1120 | 7701.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.18281 | acc=0.8890 | tpr=0.9664 | fpr=0.1124 | 7920.4 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.18255 | acc=0.8891 | tpr=0.9661 | fpr=0.1123 | 7484.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.18232 | acc=0.8893 | tpr=0.9666 | fpr=0.1121 | 14233.3 samples/s | 55.6 steps/s
Avg test loss: 0.18236, Avg test acc: 0.88929, Avg tpr: 0.96672, Avg fpr: 0.11212, total FA: 15568

server round 7/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.17699 | Reg=0.00224 | acc=0.8125 | L2-Norm=14.978 | L2-Norm(final)=2.353 | 3752.0 samples/s | 58.6 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08998 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.077 | L2-Norm(final)=2.341 | 4186.0 samples/s | 65.4 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08032 | Reg=0.00229 | acc=0.8750 | L2-Norm=15.117 | L2-Norm(final)=2.338 | 4523.8 samples/s | 70.7 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07630 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.144 | L2-Norm(final)=2.337 | 4509.2 samples/s | 70.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07164 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.173 | L2-Norm(final)=2.337 | 6062.3 samples/s | 94.7 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06473 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.206 | L2-Norm(final)=2.340 | 1746.3 samples/s | 27.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06101 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.235 | L2-Norm(final)=2.343 | 4523.0 samples/s | 70.7 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05837 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.261 | L2-Norm(final)=2.345 | 4509.6 samples/s | 70.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05576 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.286 | L2-Norm(final)=2.347 | 5651.2 samples/s | 88.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05282 | Reg=0.00234 | acc=0.9375 | L2-Norm=15.309 | L2-Norm(final)=2.349 | 1783.2 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05036 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.333 | L2-Norm(final)=2.352 | 4434.4 samples/s | 69.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04803 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.355 | L2-Norm(final)=2.356 | 4445.3 samples/s | 69.5 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04608 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.375 | L2-Norm(final)=2.359 | 5196.8 samples/s | 81.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04431 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.393 | L2-Norm(final)=2.362 | 1814.9 samples/s | 28.4 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04236 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.410 | L2-Norm(final)=2.365 | 4466.6 samples/s | 69.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04102 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.427 | L2-Norm(final)=2.368 | 4553.4 samples/s | 71.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04018 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.443 | L2-Norm(final)=2.371 | 4787.5 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.37384 | Reg=0.00224 | acc=0.6719 | L2-Norm=14.978 | L2-Norm(final)=2.352 | 3776.2 samples/s | 59.0 steps/s
[Step=2450 Epoch=12.0] | Loss=0.10585 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.109 | L2-Norm(final)=2.335 | 4028.6 samples/s | 62.9 steps/s
[Step=2500 Epoch=12.2] | Loss=0.09083 | Reg=0.00231 | acc=0.9219 | L2-Norm=15.189 | L2-Norm(final)=2.335 | 4488.0 samples/s | 70.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08377 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.230 | L2-Norm(final)=2.332 | 4447.4 samples/s | 69.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07917 | Reg=0.00233 | acc=0.9375 | L2-Norm=15.266 | L2-Norm(final)=2.333 | 6076.8 samples/s | 94.9 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06917 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.303 | L2-Norm(final)=2.336 | 1720.8 samples/s | 26.9 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06328 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.336 | L2-Norm(final)=2.343 | 4521.5 samples/s | 70.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05990 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.363 | L2-Norm(final)=2.348 | 4316.0 samples/s | 67.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05677 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.389 | L2-Norm(final)=2.353 | 5744.0 samples/s | 89.8 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05386 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.413 | L2-Norm(final)=2.358 | 1748.2 samples/s | 27.3 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05077 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.436 | L2-Norm(final)=2.363 | 4467.3 samples/s | 69.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04879 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.456 | L2-Norm(final)=2.367 | 4528.0 samples/s | 70.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04720 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.476 | L2-Norm(final)=2.371 | 5359.7 samples/s | 83.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04492 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.495 | L2-Norm(final)=2.375 | 1784.8 samples/s | 27.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04344 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.513 | L2-Norm(final)=2.380 | 4447.2 samples/s | 69.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04247 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.531 | L2-Norm(final)=2.383 | 4464.9 samples/s | 69.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04120 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.549 | L2-Norm(final)=2.387 | 5050.8 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.22808 | Reg=0.00224 | acc=0.7656 | L2-Norm=14.978 | L2-Norm(final)=2.353 | 3902.7 samples/s | 61.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.10299 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.104 | L2-Norm(final)=2.334 | 4047.4 samples/s | 63.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.08557 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.176 | L2-Norm(final)=2.334 | 4483.5 samples/s | 70.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07879 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.216 | L2-Norm(final)=2.332 | 4450.6 samples/s | 69.5 steps/s
[Step=3400 Epoch=16.6] | Loss=0.07362 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.244 | L2-Norm(final)=2.330 | 5964.1 samples/s | 93.2 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06614 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.274 | L2-Norm(final)=2.332 | 1710.8 samples/s | 26.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06190 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.303 | L2-Norm(final)=2.335 | 4451.4 samples/s | 69.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05964 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.331 | L2-Norm(final)=2.339 | 4414.5 samples/s | 69.0 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05610 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.359 | L2-Norm(final)=2.342 | 5527.7 samples/s | 86.4 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05269 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.385 | L2-Norm(final)=2.346 | 1180.3 samples/s | 18.4 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05007 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.411 | L2-Norm(final)=2.351 | 4104.6 samples/s | 64.1 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04896 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.436 | L2-Norm(final)=2.355 | 4481.8 samples/s | 70.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04673 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.461 | L2-Norm(final)=2.359 | 5046.3 samples/s | 78.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04531 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.484 | L2-Norm(final)=2.363 | 1797.8 samples/s | 28.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04357 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.506 | L2-Norm(final)=2.366 | 4457.2 samples/s | 69.6 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04210 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.526 | L2-Norm(final)=2.370 | 4413.3 samples/s | 69.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04071 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.546 | L2-Norm(final)=2.374 | 4805.0 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.01544 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.978 | L2-Norm(final)=2.354 | 3579.7 samples/s | 55.9 steps/s
[Step=1650 Epoch=15.6] | Loss=0.02600 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.197 | L2-Norm(final)=2.325 | 4216.6 samples/s | 65.9 steps/s
[Step=1700 Epoch=16.1] | Loss=0.01605 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.314 | L2-Norm(final)=2.302 | 5732.6 samples/s | 89.6 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01110 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.346 | L2-Norm(final)=2.300 | 1684.7 samples/s | 26.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00836 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=2.301 | 5371.0 samples/s | 83.9 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00671 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.326 | L2-Norm(final)=2.303 | 1736.2 samples/s | 27.1 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00559 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=2.305 | 4853.8 samples/s | 75.8 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00479 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.269 | L2-Norm(final)=2.307 | 1741.7 samples/s | 27.2 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00420 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.236 | L2-Norm(final)=2.308 | 4547.5 samples/s | 71.1 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00373 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=2.310 | 1784.6 samples/s | 27.9 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00336 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.166 | L2-Norm(final)=2.311 | 4261.2 samples/s | 66.6 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00305 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=2.313 | 1854.7 samples/s | 29.0 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00280 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=2.314 | 4247.8 samples/s | 66.4 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00259 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=2.316 | 1869.6 samples/s | 29.2 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00240 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.023 | L2-Norm(final)=2.317 | 4279.8 samples/s | 66.9 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00224 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=2.318 | 1870.2 samples/s | 29.2 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00210 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.952 | L2-Norm(final)=2.319 | 4176.2 samples/s | 65.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.02524 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.978 | L2-Norm(final)=2.354 | 3843.1 samples/s | 60.0 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02734 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=2.332 | 3628.4 samples/s | 56.7 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01544 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=2.325 | 5771.9 samples/s | 90.2 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01122 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.343 | L2-Norm(final)=2.324 | 1671.2 samples/s | 26.1 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00860 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.360 | L2-Norm(final)=2.323 | 5488.0 samples/s | 85.8 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00689 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.360 | L2-Norm(final)=2.325 | 1685.8 samples/s | 26.3 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00574 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.349 | L2-Norm(final)=2.326 | 5104.6 samples/s | 79.8 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00493 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.333 | L2-Norm(final)=2.327 | 1718.3 samples/s | 26.8 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00431 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.312 | L2-Norm(final)=2.328 | 4859.7 samples/s | 75.9 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00384 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=2.329 | 1797.3 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00345 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=2.330 | 4621.3 samples/s | 72.2 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00314 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.239 | L2-Norm(final)=2.331 | 1809.8 samples/s | 28.3 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00288 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.212 | L2-Norm(final)=2.331 | 4361.2 samples/s | 68.1 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00266 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.185 | L2-Norm(final)=2.332 | 1827.7 samples/s | 28.6 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00247 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=2.333 | 4246.5 samples/s | 66.4 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00230 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.128 | L2-Norm(final)=2.333 | 1867.9 samples/s | 29.2 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00216 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.100 | L2-Norm(final)=2.334 | 4381.3 samples/s | 68.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35453 | acc=0.7255 | tpr=0.6130 | fpr=0.0300 | 3965.7 samples/s | 15.5 steps/s
Avg test loss: 0.35438, Avg test acc: 0.72694, Avg tpr: 0.61730, Avg fpr: 0.03192, total FA: 249

Testing server on iccad2012
[Step=  50] | Loss=0.20628 | acc=0.8781 | tpr=0.9646 | fpr=0.1234 | 3933.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.20860 | acc=0.8770 | tpr=0.9744 | fpr=0.1249 | 7238.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.21056 | acc=0.8771 | tpr=0.9798 | fpr=0.1248 | 7823.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.21212 | acc=0.8766 | tpr=0.9792 | fpr=0.1253 | 7659.5 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.21186 | acc=0.8770 | tpr=0.9773 | fpr=0.1248 | 7540.4 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.21377 | acc=0.8762 | tpr=0.9782 | fpr=0.1256 | 7478.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.21431 | acc=0.8758 | tpr=0.9762 | fpr=0.1260 | 7836.8 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.21479 | acc=0.8756 | tpr=0.9732 | fpr=0.1262 | 7673.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.21592 | acc=0.8755 | tpr=0.9722 | fpr=0.1263 | 7576.8 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.21561 | acc=0.8753 | tpr=0.9714 | fpr=0.1264 | 7274.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.21524 | acc=0.8757 | tpr=0.9721 | fpr=0.1261 | 14084.6 samples/s | 55.0 steps/s
Avg test loss: 0.21528, Avg test acc: 0.87570, Avg tpr: 0.97227, Avg fpr: 0.12605, total FA: 17502

server round 8/50

clients selected: [0 2 3 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.21584 | Reg=0.00219 | acc=0.7969 | L2-Norm=14.782 | L2-Norm(final)=2.370 | 3763.2 samples/s | 58.8 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09455 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.893 | L2-Norm(final)=2.353 | 4260.0 samples/s | 66.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07637 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.957 | L2-Norm(final)=2.356 | 4476.8 samples/s | 69.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07134 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.995 | L2-Norm(final)=2.354 | 4417.5 samples/s | 69.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06568 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.028 | L2-Norm(final)=2.356 | 5884.9 samples/s | 92.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06176 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.061 | L2-Norm(final)=2.359 | 1733.1 samples/s | 27.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05776 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.094 | L2-Norm(final)=2.362 | 4434.1 samples/s | 69.3 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05410 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.124 | L2-Norm(final)=2.366 | 4424.5 samples/s | 69.1 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05244 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.151 | L2-Norm(final)=2.369 | 5476.6 samples/s | 85.6 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04882 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.176 | L2-Norm(final)=2.372 | 1767.6 samples/s | 27.6 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04640 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.198 | L2-Norm(final)=2.376 | 4372.1 samples/s | 68.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04442 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=2.380 | 4437.4 samples/s | 69.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04229 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.238 | L2-Norm(final)=2.384 | 5185.2 samples/s | 81.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04120 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.258 | L2-Norm(final)=2.387 | 1814.0 samples/s | 28.3 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03955 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.279 | L2-Norm(final)=2.392 | 4375.5 samples/s | 68.4 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03845 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.298 | L2-Norm(final)=2.395 | 4465.7 samples/s | 69.8 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03742 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.317 | L2-Norm(final)=2.398 | 4887.9 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.24232 | Reg=0.00219 | acc=0.8125 | L2-Norm=14.782 | L2-Norm(final)=2.369 | 3567.6 samples/s | 55.7 steps/s
[Step=4050 Epoch=19.7] | Loss=0.08362 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.899 | L2-Norm(final)=2.356 | 4189.4 samples/s | 65.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07566 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.968 | L2-Norm(final)=2.358 | 4496.3 samples/s | 70.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06962 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.019 | L2-Norm(final)=2.359 | 4258.4 samples/s | 66.5 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06507 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.055 | L2-Norm(final)=2.359 | 5939.7 samples/s | 92.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05943 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.090 | L2-Norm(final)=2.363 | 1732.8 samples/s | 27.1 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05456 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.124 | L2-Norm(final)=2.368 | 4445.7 samples/s | 69.5 steps/s
[Step=4350 Epoch=21.2] | Loss=0.05211 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.158 | L2-Norm(final)=2.373 | 4453.5 samples/s | 69.6 steps/s
[Step=4400 Epoch=21.4] | Loss=0.04963 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.191 | L2-Norm(final)=2.378 | 5525.3 samples/s | 86.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04747 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.221 | L2-Norm(final)=2.382 | 1751.7 samples/s | 27.4 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04480 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.250 | L2-Norm(final)=2.387 | 4454.5 samples/s | 69.6 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04330 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.276 | L2-Norm(final)=2.391 | 4543.0 samples/s | 71.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04219 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.302 | L2-Norm(final)=2.394 | 5116.8 samples/s | 79.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04069 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.328 | L2-Norm(final)=2.398 | 1837.6 samples/s | 28.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03945 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.352 | L2-Norm(final)=2.401 | 4391.9 samples/s | 68.6 steps/s
[Step=4750 Epoch=23.1] | Loss=0.03831 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.374 | L2-Norm(final)=2.404 | 4469.0 samples/s | 69.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03698 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.396 | L2-Norm(final)=2.407 | 4883.9 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.31494 | Reg=0.00219 | acc=0.8125 | L2-Norm=14.782 | L2-Norm(final)=2.369 | 3741.0 samples/s | 58.5 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08242 | Reg=0.00222 | acc=0.9375 | L2-Norm=14.900 | L2-Norm(final)=2.365 | 4110.2 samples/s | 64.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07644 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.953 | L2-Norm(final)=2.361 | 4413.2 samples/s | 69.0 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06857 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.991 | L2-Norm(final)=2.362 | 4433.4 samples/s | 69.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06381 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.021 | L2-Norm(final)=2.362 | 5971.6 samples/s | 93.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.05763 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.052 | L2-Norm(final)=2.366 | 1717.4 samples/s | 26.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05373 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.079 | L2-Norm(final)=2.370 | 4497.7 samples/s | 70.3 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05219 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.103 | L2-Norm(final)=2.372 | 4488.8 samples/s | 70.1 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04978 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.128 | L2-Norm(final)=2.375 | 5545.9 samples/s | 86.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04717 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.153 | L2-Norm(final)=2.378 | 1783.0 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04417 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.176 | L2-Norm(final)=2.382 | 4493.0 samples/s | 70.2 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04238 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=2.386 | 4452.3 samples/s | 69.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04076 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.216 | L2-Norm(final)=2.390 | 5277.0 samples/s | 82.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03868 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.236 | L2-Norm(final)=2.394 | 1772.6 samples/s | 27.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03726 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.254 | L2-Norm(final)=2.398 | 4356.0 samples/s | 68.1 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03623 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=2.401 | 4468.9 samples/s | 69.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03482 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.291 | L2-Norm(final)=2.405 | 4881.8 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.02255 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.782 | L2-Norm(final)=2.370 | 3559.0 samples/s | 55.6 steps/s
[Step=2450 Epoch=23.3] | Loss=0.01933 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.974 | L2-Norm(final)=2.360 | 4094.7 samples/s | 64.0 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01812 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=2.333 | 5853.7 samples/s | 91.5 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01318 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=2.322 | 1674.6 samples/s | 26.2 steps/s
[Step=2600 Epoch=24.7] | Loss=0.01005 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.282 | L2-Norm(final)=2.318 | 5357.8 samples/s | 83.7 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00805 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=2.317 | 1718.6 samples/s | 26.9 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00672 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=2.317 | 4878.4 samples/s | 76.2 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00576 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.296 | L2-Norm(final)=2.317 | 1749.7 samples/s | 27.3 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00504 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.283 | L2-Norm(final)=2.318 | 4650.2 samples/s | 72.7 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00448 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.267 | L2-Norm(final)=2.318 | 1795.7 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00404 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=2.318 | 4381.1 samples/s | 68.5 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00367 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.229 | L2-Norm(final)=2.319 | 1857.2 samples/s | 29.0 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00336 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.207 | L2-Norm(final)=2.319 | 4346.0 samples/s | 67.9 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00311 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.185 | L2-Norm(final)=2.320 | 1879.6 samples/s | 29.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00288 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.162 | L2-Norm(final)=2.321 | 4258.6 samples/s | 66.5 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00269 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=2.322 | 1863.6 samples/s | 29.1 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00253 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.113 | L2-Norm(final)=2.323 | 4331.9 samples/s | 67.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.04670 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.782 | L2-Norm(final)=2.370 | 3660.5 samples/s | 57.2 steps/s
[Step=1650 Epoch=15.5] | Loss=0.02408 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.996 | L2-Norm(final)=2.345 | 3996.2 samples/s | 62.4 steps/s
[Step=1700 Epoch=16.0] | Loss=0.01597 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.084 | L2-Norm(final)=2.331 | 5676.4 samples/s | 88.7 steps/s
[Step=1750 Epoch=16.5] | Loss=0.01080 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=2.330 | 1688.0 samples/s | 26.4 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00823 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.116 | L2-Norm(final)=2.332 | 5093.4 samples/s | 79.6 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00660 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.110 | L2-Norm(final)=2.335 | 1736.8 samples/s | 27.1 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00551 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.096 | L2-Norm(final)=2.337 | 4870.0 samples/s | 76.1 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00472 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.079 | L2-Norm(final)=2.338 | 1776.3 samples/s | 27.8 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00414 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.060 | L2-Norm(final)=2.340 | 4490.2 samples/s | 70.2 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00368 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.038 | L2-Norm(final)=2.341 | 1808.3 samples/s | 28.3 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00331 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.016 | L2-Norm(final)=2.342 | 4252.1 samples/s | 66.4 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00301 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.993 | L2-Norm(final)=2.344 | 1848.6 samples/s | 28.9 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00276 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=2.345 | 4186.6 samples/s | 65.4 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00255 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.946 | L2-Norm(final)=2.346 | 1854.3 samples/s | 29.0 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00237 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=2.346 | 4113.1 samples/s | 64.3 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00221 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.897 | L2-Norm(final)=2.347 | 2016.0 samples/s | 31.5 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00207 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.872 | L2-Norm(final)=2.348 | 3570.8 samples/s | 55.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46217 | acc=0.6701 | tpr=0.5268 | fpr=0.0188 | 3939.5 samples/s | 15.4 steps/s
Avg test loss: 0.45961, Avg test acc: 0.67237, Avg tpr: 0.53214, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.17041 | acc=0.9037 | tpr=0.9558 | fpr=0.0973 | 3947.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.17210 | acc=0.9037 | tpr=0.9680 | fpr=0.0975 | 7684.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.17461 | acc=0.9038 | tpr=0.9741 | fpr=0.0975 | 7482.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.17646 | acc=0.9039 | tpr=0.9738 | fpr=0.0973 | 7282.0 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.17684 | acc=0.9041 | tpr=0.9729 | fpr=0.0971 | 7561.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.17883 | acc=0.9033 | tpr=0.9745 | fpr=0.0980 | 7497.6 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.17926 | acc=0.9034 | tpr=0.9737 | fpr=0.0979 | 7838.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.17965 | acc=0.9030 | tpr=0.9710 | fpr=0.0983 | 7695.1 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.18077 | acc=0.9029 | tpr=0.9688 | fpr=0.0983 | 7494.9 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.18049 | acc=0.9026 | tpr=0.9674 | fpr=0.0986 | 7557.2 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.18014 | acc=0.9028 | tpr=0.9662 | fpr=0.0984 | 13027.5 samples/s | 50.9 steps/s
Avg test loss: 0.18012, Avg test acc: 0.90282, Avg tpr: 0.96632, Avg fpr: 0.09834, total FA: 13654

server round 9/50

clients selected: [0 3 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.35715 | Reg=0.00215 | acc=0.7344 | L2-Norm=14.653 | L2-Norm(final)=2.385 | 3635.2 samples/s | 56.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.08742 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.758 | L2-Norm(final)=2.362 | 4384.6 samples/s | 68.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07394 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.814 | L2-Norm(final)=2.358 | 4448.9 samples/s | 69.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06705 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.854 | L2-Norm(final)=2.360 | 4487.7 samples/s | 70.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06426 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.891 | L2-Norm(final)=2.359 | 5993.4 samples/s | 93.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05719 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.925 | L2-Norm(final)=2.361 | 1739.9 samples/s | 27.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05223 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.954 | L2-Norm(final)=2.366 | 4515.5 samples/s | 70.6 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04914 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.981 | L2-Norm(final)=2.370 | 4543.9 samples/s | 71.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04702 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.005 | L2-Norm(final)=2.374 | 5499.1 samples/s | 85.9 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04821 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.031 | L2-Norm(final)=2.376 | 1768.2 samples/s | 27.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04670 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.061 | L2-Norm(final)=2.376 | 4520.5 samples/s | 70.6 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04502 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.089 | L2-Norm(final)=2.377 | 4477.5 samples/s | 70.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04340 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.115 | L2-Norm(final)=2.379 | 5203.7 samples/s | 81.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04133 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.139 | L2-Norm(final)=2.381 | 1814.1 samples/s | 28.3 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03960 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.162 | L2-Norm(final)=2.384 | 4481.3 samples/s | 70.0 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03840 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.182 | L2-Norm(final)=2.386 | 4466.3 samples/s | 69.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03749 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.201 | L2-Norm(final)=2.388 | 4682.9 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.37058 | Reg=0.00215 | acc=0.7500 | L2-Norm=14.653 | L2-Norm(final)=2.385 | 3802.6 samples/s | 59.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08049 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.767 | L2-Norm(final)=2.367 | 4068.9 samples/s | 63.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07251 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.825 | L2-Norm(final)=2.365 | 4485.1 samples/s | 70.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06468 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.877 | L2-Norm(final)=2.370 | 4516.7 samples/s | 70.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06257 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.923 | L2-Norm(final)=2.373 | 6012.2 samples/s | 93.9 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05630 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=2.376 | 1738.3 samples/s | 27.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05191 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.001 | L2-Norm(final)=2.381 | 4501.6 samples/s | 70.3 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04858 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.034 | L2-Norm(final)=2.384 | 4560.3 samples/s | 71.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04765 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.062 | L2-Norm(final)=2.386 | 5552.9 samples/s | 86.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04483 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.091 | L2-Norm(final)=2.389 | 1769.5 samples/s | 27.6 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04243 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.118 | L2-Norm(final)=2.392 | 4432.0 samples/s | 69.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04119 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.143 | L2-Norm(final)=2.395 | 4481.4 samples/s | 70.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03956 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.168 | L2-Norm(final)=2.398 | 5113.1 samples/s | 79.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03800 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.191 | L2-Norm(final)=2.400 | 1799.6 samples/s | 28.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03652 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.214 | L2-Norm(final)=2.403 | 4464.7 samples/s | 69.8 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03549 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.234 | L2-Norm(final)=2.406 | 4423.3 samples/s | 69.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03457 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.254 | L2-Norm(final)=2.408 | 4916.5 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.19421 | Reg=0.00215 | acc=0.7812 | L2-Norm=14.653 | L2-Norm(final)=2.386 | 3910.1 samples/s | 61.1 steps/s
[Step=4050 Epoch=19.9] | Loss=0.08733 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.789 | L2-Norm(final)=2.366 | 3886.5 samples/s | 60.7 steps/s
[Step=4100 Epoch=20.1] | Loss=0.07507 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.859 | L2-Norm(final)=2.363 | 4461.4 samples/s | 69.7 steps/s
[Step=4150 Epoch=20.4] | Loss=0.06364 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.910 | L2-Norm(final)=2.369 | 4411.1 samples/s | 68.9 steps/s
[Step=4200 Epoch=20.6] | Loss=0.05905 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.949 | L2-Norm(final)=2.374 | 6101.6 samples/s | 95.3 steps/s
[Step=4250 Epoch=20.8] | Loss=0.05242 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.983 | L2-Norm(final)=2.378 | 1680.1 samples/s | 26.3 steps/s
[Step=4300 Epoch=21.1] | Loss=0.04862 | Reg=0.00225 | acc=0.9531 | L2-Norm=15.012 | L2-Norm(final)=2.382 | 4443.8 samples/s | 69.4 steps/s
[Step=4350 Epoch=21.3] | Loss=0.04610 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=2.387 | 4447.1 samples/s | 69.5 steps/s
[Step=4400 Epoch=21.6] | Loss=0.04489 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.064 | L2-Norm(final)=2.390 | 5789.5 samples/s | 90.5 steps/s
[Step=4450 Epoch=21.8] | Loss=0.04168 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.089 | L2-Norm(final)=2.393 | 1746.9 samples/s | 27.3 steps/s
[Step=4500 Epoch=22.1] | Loss=0.03967 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.112 | L2-Norm(final)=2.397 | 4490.3 samples/s | 70.2 steps/s
[Step=4550 Epoch=22.3] | Loss=0.03914 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.134 | L2-Norm(final)=2.400 | 4522.8 samples/s | 70.7 steps/s
[Step=4600 Epoch=22.6] | Loss=0.03783 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.155 | L2-Norm(final)=2.402 | 5532.2 samples/s | 86.4 steps/s
[Step=4650 Epoch=22.8] | Loss=0.03631 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.176 | L2-Norm(final)=2.405 | 1720.9 samples/s | 26.9 steps/s
[Step=4700 Epoch=23.0] | Loss=0.03546 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.197 | L2-Norm(final)=2.408 | 4482.4 samples/s | 70.0 steps/s
[Step=4750 Epoch=23.3] | Loss=0.03431 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.216 | L2-Norm(final)=2.410 | 4497.3 samples/s | 70.3 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03337 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=2.412 | 5338.5 samples/s | 83.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.06427 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.653 | L2-Norm(final)=2.385 | 4104.1 samples/s | 64.1 steps/s
[Step=2450 Epoch=23.2] | Loss=0.01680 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.865 | L2-Norm(final)=2.367 | 3608.2 samples/s | 56.4 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01131 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=2.361 | 5809.6 samples/s | 90.8 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00877 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=2.357 | 1645.8 samples/s | 25.7 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00663 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.996 | L2-Norm(final)=2.356 | 5324.9 samples/s | 83.2 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00531 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.985 | L2-Norm(final)=2.356 | 1704.5 samples/s | 26.6 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00443 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=2.357 | 4838.7 samples/s | 75.6 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00380 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.940 | L2-Norm(final)=2.358 | 1767.0 samples/s | 27.6 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00333 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.912 | L2-Norm(final)=2.359 | 4681.7 samples/s | 73.2 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00296 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.883 | L2-Norm(final)=2.360 | 1812.5 samples/s | 28.3 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00266 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=2.361 | 4435.1 samples/s | 69.3 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00242 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.822 | L2-Norm(final)=2.362 | 1841.0 samples/s | 28.8 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00222 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.791 | L2-Norm(final)=2.363 | 4337.0 samples/s | 67.8 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00205 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=2.364 | 1847.0 samples/s | 28.9 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00190 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=2.364 | 4237.9 samples/s | 66.2 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00178 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=2.365 | 1879.8 samples/s | 29.4 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00167 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.664 | L2-Norm(final)=2.366 | 4277.0 samples/s | 66.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step3200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.5] | Loss=0.02701 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.653 | L2-Norm(final)=2.386 | 3900.3 samples/s | 60.9 steps/s
[Step=5650 Epoch=54.0] | Loss=0.02614 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=2.355 | 3551.9 samples/s | 55.5 steps/s
[Step=5700 Epoch=54.4] | Loss=0.01597 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.005 | L2-Norm(final)=2.334 | 5844.4 samples/s | 91.3 steps/s
[Step=5750 Epoch=54.9] | Loss=0.01081 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.061 | L2-Norm(final)=2.330 | 1674.1 samples/s | 26.2 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00812 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.079 | L2-Norm(final)=2.331 | 5397.2 samples/s | 84.3 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00650 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.076 | L2-Norm(final)=2.332 | 1690.0 samples/s | 26.4 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00542 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=2.333 | 4968.2 samples/s | 77.6 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00465 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=2.334 | 1757.8 samples/s | 27.5 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00407 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.025 | L2-Norm(final)=2.335 | 4728.9 samples/s | 73.9 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00362 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=2.336 | 1767.5 samples/s | 27.6 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00326 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.977 | L2-Norm(final)=2.337 | 4583.1 samples/s | 71.6 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00296 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=2.338 | 1798.9 samples/s | 28.1 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00272 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=2.339 | 4355.4 samples/s | 68.1 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00251 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=2.340 | 1839.5 samples/s | 28.7 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00233 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=2.342 | 4318.2 samples/s | 67.5 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00218 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.843 | L2-Norm(final)=2.343 | 1855.9 samples/s | 29.0 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00204 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.815 | L2-Norm(final)=2.345 | 4368.0 samples/s | 68.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39282 | acc=0.7025 | tpr=0.5762 | fpr=0.0233 | 3970.8 samples/s | 15.5 steps/s
Avg test loss: 0.38989, Avg test acc: 0.70430, Avg tpr: 0.58075, Avg fpr: 0.02397, total FA: 187

Testing server on iccad2012
[Step=  50] | Loss=0.17991 | acc=0.9011 | tpr=0.9646 | fpr=0.1000 | 3933.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.18166 | acc=0.9010 | tpr=0.9787 | fpr=0.1005 | 7655.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.18480 | acc=0.9002 | tpr=0.9813 | fpr=0.1013 | 7880.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.18658 | acc=0.9000 | tpr=0.9814 | fpr=0.1014 | 7551.0 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.18691 | acc=0.8997 | tpr=0.9799 | fpr=0.1017 | 7564.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.18860 | acc=0.8991 | tpr=0.9804 | fpr=0.1024 | 7594.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.18895 | acc=0.8991 | tpr=0.9800 | fpr=0.1023 | 7959.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.18945 | acc=0.8987 | tpr=0.9765 | fpr=0.1027 | 7934.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.19066 | acc=0.8984 | tpr=0.9747 | fpr=0.1030 | 7431.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.19040 | acc=0.8983 | tpr=0.9749 | fpr=0.1031 | 7837.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.18980 | acc=0.8984 | tpr=0.9745 | fpr=0.1030 | 14857.3 samples/s | 58.0 steps/s
Avg test loss: 0.18980, Avg test acc: 0.89845, Avg tpr: 0.97464, Avg fpr: 0.10294, total FA: 14293

server round 10/50

clients selected: [2 4 5 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.20849 | Reg=0.00212 | acc=0.8281 | L2-Norm=14.544 | L2-Norm(final)=2.387 | 3585.4 samples/s | 56.0 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07306 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.588 | L2-Norm(final)=2.386 | 4500.1 samples/s | 70.3 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06176 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.613 | L2-Norm(final)=2.390 | 4472.4 samples/s | 69.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05505 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.630 | L2-Norm(final)=2.393 | 4437.9 samples/s | 69.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04976 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.645 | L2-Norm(final)=2.397 | 5939.0 samples/s | 92.8 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04385 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=2.403 | 1748.2 samples/s | 27.3 steps/s
[Step=5100 Epoch=24.8] | Loss=0.03911 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.673 | L2-Norm(final)=2.410 | 4428.4 samples/s | 69.2 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03643 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.685 | L2-Norm(final)=2.417 | 4439.0 samples/s | 69.4 steps/s
[Step=5200 Epoch=25.3] | Loss=0.03434 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.697 | L2-Norm(final)=2.423 | 5516.2 samples/s | 86.2 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03184 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.709 | L2-Norm(final)=2.430 | 1754.5 samples/s | 27.4 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03001 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.719 | L2-Norm(final)=2.436 | 4331.6 samples/s | 67.7 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02851 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.729 | L2-Norm(final)=2.442 | 4403.4 samples/s | 68.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02765 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.738 | L2-Norm(final)=2.447 | 5195.9 samples/s | 81.2 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02614 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.746 | L2-Norm(final)=2.452 | 1811.9 samples/s | 28.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02511 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=2.458 | 4579.0 samples/s | 71.5 steps/s
[Step=5550 Epoch=27.0] | Loss=0.02386 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=2.463 | 4556.0 samples/s | 71.2 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02317 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.769 | L2-Norm(final)=2.468 | 4859.1 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.5] | Loss=0.34088 | Reg=0.00212 | acc=0.6719 | L2-Norm=14.544 | L2-Norm(final)=2.387 | 3655.6 samples/s | 57.1 steps/s
[Step=4850 Epoch=23.8] | Loss=0.07850 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.578 | L2-Norm(final)=2.378 | 4406.0 samples/s | 68.8 steps/s
[Step=4900 Epoch=24.0] | Loss=0.05970 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.603 | L2-Norm(final)=2.384 | 4566.9 samples/s | 71.4 steps/s
[Step=4950 Epoch=24.3] | Loss=0.05336 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.618 | L2-Norm(final)=2.388 | 4462.3 samples/s | 69.7 steps/s
[Step=5000 Epoch=24.5] | Loss=0.04877 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.631 | L2-Norm(final)=2.391 | 6099.9 samples/s | 95.3 steps/s
[Step=5050 Epoch=24.8] | Loss=0.04219 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.644 | L2-Norm(final)=2.396 | 1729.8 samples/s | 27.0 steps/s
[Step=5100 Epoch=25.0] | Loss=0.03790 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.657 | L2-Norm(final)=2.403 | 4519.4 samples/s | 70.6 steps/s
[Step=5150 Epoch=25.3] | Loss=0.03566 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.668 | L2-Norm(final)=2.410 | 4452.8 samples/s | 69.6 steps/s
[Step=5200 Epoch=25.5] | Loss=0.03316 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.680 | L2-Norm(final)=2.416 | 5859.6 samples/s | 91.6 steps/s
[Step=5250 Epoch=25.7] | Loss=0.03053 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=2.422 | 1753.2 samples/s | 27.4 steps/s
[Step=5300 Epoch=26.0] | Loss=0.02884 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.702 | L2-Norm(final)=2.429 | 4477.3 samples/s | 70.0 steps/s
[Step=5350 Epoch=26.2] | Loss=0.02710 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.711 | L2-Norm(final)=2.435 | 4490.3 samples/s | 70.2 steps/s
[Step=5400 Epoch=26.5] | Loss=0.02607 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.720 | L2-Norm(final)=2.440 | 5545.5 samples/s | 86.6 steps/s
[Step=5450 Epoch=26.7] | Loss=0.02491 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.728 | L2-Norm(final)=2.445 | 1743.7 samples/s | 27.2 steps/s
[Step=5500 Epoch=27.0] | Loss=0.02370 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.736 | L2-Norm(final)=2.451 | 4531.7 samples/s | 70.8 steps/s
[Step=5550 Epoch=27.2] | Loss=0.02278 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=2.456 | 4599.2 samples/s | 71.9 steps/s
[Step=5600 Epoch=27.5] | Loss=0.02210 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.751 | L2-Norm(final)=2.460 | 5249.3 samples/s | 82.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.3] | Loss=0.05301 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.544 | L2-Norm(final)=2.387 | 3617.6 samples/s | 56.5 steps/s
[Step=3250 Epoch=30.8] | Loss=0.00786 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=2.403 | 3947.7 samples/s | 61.7 steps/s
[Step=3300 Epoch=31.3] | Loss=0.00510 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.624 | L2-Norm(final)=2.414 | 5855.3 samples/s | 91.5 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00372 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.628 | L2-Norm(final)=2.422 | 1652.7 samples/s | 25.8 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00283 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=2.427 | 5439.0 samples/s | 85.0 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00227 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=2.431 | 1718.5 samples/s | 26.9 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00189 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.597 | L2-Norm(final)=2.435 | 5061.4 samples/s | 79.1 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00163 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.581 | L2-Norm(final)=2.437 | 1772.3 samples/s | 27.7 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00142 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.439 | 4597.9 samples/s | 71.8 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00127 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=2.440 | 1813.4 samples/s | 28.3 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00114 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=2.442 | 4319.9 samples/s | 67.5 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00104 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=2.443 | 1850.6 samples/s | 28.9 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00095 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=2.444 | 4244.2 samples/s | 66.3 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00088 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=2.445 | 1875.2 samples/s | 29.3 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00082 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=2.446 | 4360.6 samples/s | 68.1 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00076 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=2.447 | 1895.9 samples/s | 29.6 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00072 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.401 | L2-Norm(final)=2.448 | 4216.1 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=22.6] | Loss=0.01618 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.544 | L2-Norm(final)=2.388 | 3714.4 samples/s | 58.0 steps/s
[Step=2450 Epoch=23.1] | Loss=0.01177 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=2.390 | 3829.0 samples/s | 59.8 steps/s
[Step=2500 Epoch=23.6] | Loss=0.00715 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=2.394 | 5836.2 samples/s | 91.2 steps/s
[Step=2550 Epoch=24.0] | Loss=0.00483 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.637 | L2-Norm(final)=2.399 | 1706.1 samples/s | 26.7 steps/s
[Step=2600 Epoch=24.5] | Loss=0.00365 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.634 | L2-Norm(final)=2.402 | 5272.1 samples/s | 82.4 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00293 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=2.405 | 1735.2 samples/s | 27.1 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00244 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=2.407 | 4784.3 samples/s | 74.8 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00210 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=2.409 | 1824.8 samples/s | 28.5 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00184 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.596 | L2-Norm(final)=2.411 | 4408.6 samples/s | 68.9 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00164 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=2.412 | 1828.5 samples/s | 28.6 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00148 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=2.413 | 4328.3 samples/s | 67.6 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00134 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.558 | L2-Norm(final)=2.415 | 1874.0 samples/s | 29.3 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00123 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=2.416 | 4324.1 samples/s | 67.6 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00114 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=2.417 | 1854.6 samples/s | 29.0 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00106 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=2.418 | 4247.5 samples/s | 66.4 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00099 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.418 | 1949.3 samples/s | 30.5 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00093 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.488 | L2-Norm(final)=2.419 | 3811.6 samples/s | 59.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.5] | Loss=0.01931 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=2.388 | 3760.6 samples/s | 58.8 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01170 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=2.393 | 3822.3 samples/s | 59.7 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00608 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=2.398 | 5818.3 samples/s | 90.9 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00445 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=2.403 | 1665.6 samples/s | 26.0 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00337 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=2.406 | 5436.4 samples/s | 84.9 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00270 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=2.409 | 1745.6 samples/s | 27.3 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00226 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.605 | L2-Norm(final)=2.411 | 5108.0 samples/s | 79.8 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00194 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=2.413 | 1760.6 samples/s | 27.5 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00170 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=2.414 | 4921.4 samples/s | 76.9 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00151 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.569 | L2-Norm(final)=2.415 | 1784.5 samples/s | 27.9 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00136 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=2.416 | 4564.7 samples/s | 71.3 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00124 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=2.417 | 1808.3 samples/s | 28.3 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00114 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.529 | L2-Norm(final)=2.418 | 4334.8 samples/s | 67.7 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00105 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=2.419 | 1837.6 samples/s | 28.7 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00098 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.500 | L2-Norm(final)=2.420 | 4294.8 samples/s | 67.1 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00091 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.485 | L2-Norm(final)=2.421 | 1842.5 samples/s | 28.8 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00085 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=2.421 | 4271.3 samples/s | 66.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37035 | acc=0.7448 | tpr=0.6359 | fpr=0.0186 | 3960.4 samples/s | 15.5 steps/s
Avg test loss: 0.36873, Avg test acc: 0.74513, Avg tpr: 0.63834, Avg fpr: 0.02000, total FA: 156

Testing server on iccad2012
[Step=  50] | Loss=0.22132 | acc=0.8881 | tpr=0.9735 | fpr=0.1134 | 4024.3 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.22341 | acc=0.8853 | tpr=0.9808 | fpr=0.1165 | 7465.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.22669 | acc=0.8852 | tpr=0.9827 | fpr=0.1166 | 8065.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.22814 | acc=0.8853 | tpr=0.9825 | fpr=0.1165 | 7526.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.22843 | acc=0.8852 | tpr=0.9799 | fpr=0.1165 | 7730.3 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.23049 | acc=0.8846 | tpr=0.9804 | fpr=0.1172 | 7767.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.23062 | acc=0.8846 | tpr=0.9800 | fpr=0.1171 | 7874.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.23083 | acc=0.8846 | tpr=0.9781 | fpr=0.1171 | 7763.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.23233 | acc=0.8843 | tpr=0.9752 | fpr=0.1173 | 7841.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.23223 | acc=0.8843 | tpr=0.9749 | fpr=0.1174 | 7709.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.23146 | acc=0.8847 | tpr=0.9737 | fpr=0.1170 | 14713.9 samples/s | 57.5 steps/s
Avg test loss: 0.23146, Avg test acc: 0.88471, Avg tpr: 0.97385, Avg fpr: 0.11691, total FA: 16233

server round 11/50

clients selected: [0 5 6 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.27235 | Reg=0.00210 | acc=0.8125 | L2-Norm=14.496 | L2-Norm(final)=2.432 | 3756.4 samples/s | 58.7 steps/s
[Step=4850 Epoch=23.6] | Loss=0.05971 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.534 | L2-Norm(final)=2.423 | 4186.1 samples/s | 65.4 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05212 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.549 | L2-Norm(final)=2.423 | 4506.5 samples/s | 70.4 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04693 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.560 | L2-Norm(final)=2.425 | 4474.9 samples/s | 69.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04396 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.568 | L2-Norm(final)=2.427 | 6059.0 samples/s | 94.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03918 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=2.430 | 1737.6 samples/s | 27.1 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03557 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.588 | L2-Norm(final)=2.436 | 4483.2 samples/s | 70.0 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03259 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.597 | L2-Norm(final)=2.441 | 4473.3 samples/s | 69.9 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03057 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.606 | L2-Norm(final)=2.446 | 5534.8 samples/s | 86.5 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02857 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=2.451 | 1769.8 samples/s | 27.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02691 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.623 | L2-Norm(final)=2.456 | 4410.5 samples/s | 68.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02576 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=2.461 | 4523.1 samples/s | 70.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02468 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.636 | L2-Norm(final)=2.466 | 5234.0 samples/s | 81.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02373 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.642 | L2-Norm(final)=2.470 | 1799.3 samples/s | 28.1 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02268 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.648 | L2-Norm(final)=2.474 | 4581.8 samples/s | 71.6 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02180 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.653 | L2-Norm(final)=2.478 | 4562.7 samples/s | 71.3 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02112 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.658 | L2-Norm(final)=2.482 | 4946.6 samples/s | 77.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=37.9] | Loss=0.03508 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.496 | L2-Norm(final)=2.432 | 3414.9 samples/s | 53.4 steps/s
[Step=4050 Epoch=38.4] | Loss=0.00700 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.565 | L2-Norm(final)=2.439 | 4339.5 samples/s | 67.8 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00425 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=2.447 | 5837.1 samples/s | 91.2 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00289 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.451 | 1694.0 samples/s | 26.5 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00218 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=2.455 | 5286.2 samples/s | 82.6 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00175 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=2.457 | 1708.8 samples/s | 26.7 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00146 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=2.459 | 4904.0 samples/s | 76.6 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00126 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=2.461 | 1768.9 samples/s | 27.6 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00110 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=2.462 | 4698.4 samples/s | 73.4 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00098 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=2.464 | 1807.5 samples/s | 28.2 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00088 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=2.465 | 4419.0 samples/s | 69.0 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00080 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=2.466 | 1843.7 samples/s | 28.8 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00074 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=2.467 | 4290.1 samples/s | 67.0 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00068 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.362 | L2-Norm(final)=2.468 | 1876.4 samples/s | 29.3 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00063 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.338 | L2-Norm(final)=2.468 | 4372.3 samples/s | 68.3 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00059 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=2.469 | 1895.9 samples/s | 29.6 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00055 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=2.470 | 4232.9 samples/s | 66.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step4800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.4] | Loss=0.07812 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.496 | L2-Norm(final)=2.432 | 3882.0 samples/s | 60.7 steps/s
[Step=3250 Epoch=30.9] | Loss=0.01177 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.564 | L2-Norm(final)=2.428 | 3647.1 samples/s | 57.0 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00723 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=2.432 | 5872.9 samples/s | 91.8 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00485 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=2.436 | 1674.9 samples/s | 26.2 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00365 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.596 | L2-Norm(final)=2.439 | 5266.9 samples/s | 82.3 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00293 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=2.441 | 1730.5 samples/s | 27.0 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00244 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.581 | L2-Norm(final)=2.443 | 5008.7 samples/s | 78.3 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00210 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.570 | L2-Norm(final)=2.444 | 1750.1 samples/s | 27.3 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00184 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=2.445 | 4699.3 samples/s | 73.4 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00164 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=2.446 | 1797.2 samples/s | 28.1 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00148 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=2.447 | 4307.2 samples/s | 67.3 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00134 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=2.448 | 1813.2 samples/s | 28.3 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00123 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=2.449 | 4390.9 samples/s | 68.6 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00114 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.494 | L2-Norm(final)=2.449 | 1861.8 samples/s | 29.1 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00106 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=2.450 | 4367.4 samples/s | 68.2 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00099 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.466 | L2-Norm(final)=2.451 | 1878.2 samples/s | 29.3 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00093 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=2.451 | 4247.1 samples/s | 66.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=61.1] | Loss=0.01369 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=2.433 | 3539.9 samples/s | 55.3 steps/s
[Step=6450 Epoch=61.6] | Loss=0.01206 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=2.426 | 4046.4 samples/s | 63.2 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00646 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.611 | L2-Norm(final)=2.428 | 5924.8 samples/s | 92.6 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00435 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=2.431 | 1664.0 samples/s | 26.0 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00327 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=2.434 | 5509.3 samples/s | 86.1 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00262 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.602 | L2-Norm(final)=2.436 | 1704.4 samples/s | 26.6 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00219 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=2.437 | 5207.4 samples/s | 81.4 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00188 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=2.438 | 1674.7 samples/s | 26.2 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00165 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.440 | 4611.5 samples/s | 72.1 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00147 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.548 | L2-Norm(final)=2.441 | 1729.8 samples/s | 27.0 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00132 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=2.442 | 4621.9 samples/s | 72.2 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00120 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=2.443 | 1824.7 samples/s | 28.5 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00110 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.501 | L2-Norm(final)=2.443 | 4349.3 samples/s | 68.0 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00102 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=2.444 | 1864.9 samples/s | 29.1 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00095 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=2.445 | 4424.6 samples/s | 69.1 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00088 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=2.446 | 1863.9 samples/s | 29.1 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00083 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=2.447 | 4331.8 samples/s | 67.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.2] | Loss=0.14175 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.496 | L2-Norm(final)=2.431 | 3645.0 samples/s | 57.0 steps/s
[Step=3250 Epoch=30.6] | Loss=0.01305 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=2.426 | 4058.3 samples/s | 63.4 steps/s
[Step=3300 Epoch=31.1] | Loss=0.01041 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.630 | L2-Norm(final)=2.425 | 5703.7 samples/s | 89.1 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00705 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.649 | L2-Norm(final)=2.425 | 1703.3 samples/s | 26.6 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00536 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.653 | L2-Norm(final)=2.427 | 5193.5 samples/s | 81.1 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00429 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=2.429 | 1740.9 samples/s | 27.2 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00358 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.643 | L2-Norm(final)=2.430 | 4761.0 samples/s | 74.4 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00307 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.634 | L2-Norm(final)=2.432 | 1772.0 samples/s | 27.7 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00269 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=2.433 | 4340.9 samples/s | 67.8 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00240 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=2.434 | 1835.3 samples/s | 28.7 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00216 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.597 | L2-Norm(final)=2.435 | 4283.4 samples/s | 66.9 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00196 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.436 | 1850.0 samples/s | 28.9 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00180 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.569 | L2-Norm(final)=2.437 | 4288.9 samples/s | 67.0 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00166 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=2.438 | 1901.5 samples/s | 29.7 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00155 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=2.438 | 4284.8 samples/s | 66.9 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00144 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=2.439 | 1939.3 samples/s | 30.3 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00135 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.510 | L2-Norm(final)=2.440 | 4056.7 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30765 | acc=0.7963 | tpr=0.7097 | fpr=0.0159 | 3930.8 samples/s | 15.4 steps/s
Avg test loss: 0.30756, Avg test acc: 0.79758, Avg tpr: 0.71329, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.25536 | acc=0.8759 | tpr=0.9690 | fpr=0.1257 | 3834.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.25968 | acc=0.8723 | tpr=0.9765 | fpr=0.1296 | 7534.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.26214 | acc=0.8728 | tpr=0.9798 | fpr=0.1292 | 8229.3 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.26382 | acc=0.8730 | tpr=0.9792 | fpr=0.1289 | 7177.0 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.26496 | acc=0.8729 | tpr=0.9764 | fpr=0.1290 | 7861.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.26717 | acc=0.8727 | tpr=0.9775 | fpr=0.1292 | 7708.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.26753 | acc=0.8724 | tpr=0.9768 | fpr=0.1295 | 7712.1 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.26780 | acc=0.8723 | tpr=0.9759 | fpr=0.1295 | 8052.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.26950 | acc=0.8721 | tpr=0.9747 | fpr=0.1298 | 7596.6 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.26924 | acc=0.8720 | tpr=0.9740 | fpr=0.1299 | 7143.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.26856 | acc=0.8722 | tpr=0.9733 | fpr=0.1296 | 14263.7 samples/s | 55.7 steps/s
Avg test loss: 0.26848, Avg test acc: 0.87229, Avg tpr: 0.97345, Avg fpr: 0.12955, total FA: 17988

server round 12/50

clients selected: [0 3 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.19819 | Reg=0.00208 | acc=0.8906 | L2-Norm=14.438 | L2-Norm(final)=2.474 | 3851.9 samples/s | 60.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05412 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.472 | L2-Norm(final)=2.464 | 4301.4 samples/s | 67.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04700 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.490 | L2-Norm(final)=2.463 | 4560.7 samples/s | 71.3 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04385 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.506 | L2-Norm(final)=2.465 | 4510.5 samples/s | 70.5 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04159 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=2.466 | 6040.2 samples/s | 94.4 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03682 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=2.469 | 1730.9 samples/s | 27.0 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03277 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=2.475 | 4533.7 samples/s | 70.8 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03076 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=2.481 | 4405.0 samples/s | 68.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02935 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.568 | L2-Norm(final)=2.487 | 5556.8 samples/s | 86.8 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02934 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.579 | L2-Norm(final)=2.491 | 1775.5 samples/s | 27.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02878 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=2.493 | 4418.4 samples/s | 69.0 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02758 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=2.496 | 4511.6 samples/s | 70.5 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02625 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.615 | L2-Norm(final)=2.500 | 5198.7 samples/s | 81.2 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02538 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=2.505 | 1823.6 samples/s | 28.5 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02508 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=2.508 | 4378.6 samples/s | 68.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02443 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.651 | L2-Norm(final)=2.512 | 4438.2 samples/s | 69.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02366 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=2.516 | 4944.2 samples/s | 77.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.16901 | Reg=0.00208 | acc=0.8906 | L2-Norm=14.438 | L2-Norm(final)=2.475 | 3748.4 samples/s | 58.6 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06355 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.485 | L2-Norm(final)=2.458 | 4052.7 samples/s | 63.3 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05011 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.515 | L2-Norm(final)=2.461 | 4475.8 samples/s | 69.9 steps/s
[Step=4150 Epoch=20.2] | Loss=0.04343 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.537 | L2-Norm(final)=2.467 | 4537.1 samples/s | 70.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.03930 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.550 | L2-Norm(final)=2.470 | 6044.7 samples/s | 94.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03446 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.474 | 1723.4 samples/s | 26.9 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03090 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.573 | L2-Norm(final)=2.478 | 4524.3 samples/s | 70.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.02902 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.483 | 4402.8 samples/s | 68.8 steps/s
[Step=4400 Epoch=21.5] | Loss=0.02730 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.591 | L2-Norm(final)=2.488 | 5643.7 samples/s | 88.2 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02529 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.600 | L2-Norm(final)=2.492 | 1763.2 samples/s | 27.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02382 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=2.497 | 4495.2 samples/s | 70.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02265 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=2.501 | 4336.0 samples/s | 67.8 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02184 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.621 | L2-Norm(final)=2.506 | 5290.9 samples/s | 82.7 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02102 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=2.510 | 1829.9 samples/s | 28.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.01999 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=2.514 | 4521.9 samples/s | 70.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.01922 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.638 | L2-Norm(final)=2.518 | 4498.6 samples/s | 70.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.01853 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.643 | L2-Norm(final)=2.522 | 4935.5 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step4800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.5] | Loss=0.20674 | Reg=0.00208 | acc=0.8438 | L2-Norm=14.438 | L2-Norm(final)=2.474 | 3790.3 samples/s | 59.2 steps/s
[Step=5650 Epoch=27.7] | Loss=0.05928 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.469 | L2-Norm(final)=2.461 | 4223.0 samples/s | 66.0 steps/s
[Step=5700 Epoch=28.0] | Loss=0.04527 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.487 | L2-Norm(final)=2.461 | 4525.3 samples/s | 70.7 steps/s
[Step=5750 Epoch=28.2] | Loss=0.04122 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.499 | L2-Norm(final)=2.462 | 4391.2 samples/s | 68.6 steps/s
[Step=5800 Epoch=28.4] | Loss=0.03812 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.512 | L2-Norm(final)=2.464 | 6079.5 samples/s | 95.0 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03418 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.524 | L2-Norm(final)=2.468 | 1707.3 samples/s | 26.7 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03110 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.536 | L2-Norm(final)=2.473 | 4490.8 samples/s | 70.2 steps/s
[Step=5950 Epoch=29.2] | Loss=0.02901 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.547 | L2-Norm(final)=2.478 | 4529.8 samples/s | 70.8 steps/s
[Step=6000 Epoch=29.4] | Loss=0.02732 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.557 | L2-Norm(final)=2.483 | 5732.1 samples/s | 89.6 steps/s
[Step=6050 Epoch=29.7] | Loss=0.02551 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=2.488 | 1737.2 samples/s | 27.1 steps/s
[Step=6100 Epoch=29.9] | Loss=0.02378 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=2.493 | 4382.1 samples/s | 68.5 steps/s
[Step=6150 Epoch=30.2] | Loss=0.02280 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.585 | L2-Norm(final)=2.498 | 4452.5 samples/s | 69.6 steps/s
[Step=6200 Epoch=30.4] | Loss=0.02218 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.593 | L2-Norm(final)=2.502 | 5492.7 samples/s | 85.8 steps/s
[Step=6250 Epoch=30.6] | Loss=0.02130 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=2.506 | 1773.2 samples/s | 27.7 steps/s
[Step=6300 Epoch=30.9] | Loss=0.02043 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=2.511 | 4397.7 samples/s | 68.7 steps/s
[Step=6350 Epoch=31.1] | Loss=0.01986 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.617 | L2-Norm(final)=2.515 | 4524.3 samples/s | 70.7 steps/s
[Step=6400 Epoch=31.4] | Loss=0.01930 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.625 | L2-Norm(final)=2.519 | 5173.3 samples/s | 80.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.5] | Loss=0.10419 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.438 | L2-Norm(final)=2.473 | 3645.8 samples/s | 57.0 steps/s
[Step=4850 Epoch=46.0] | Loss=0.01167 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.542 | L2-Norm(final)=2.460 | 3991.2 samples/s | 62.4 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00656 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.570 | L2-Norm(final)=2.465 | 5688.3 samples/s | 88.9 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00444 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=2.472 | 1694.8 samples/s | 26.5 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00349 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=2.477 | 5374.2 samples/s | 84.0 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00282 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=2.482 | 1711.1 samples/s | 26.7 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00235 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=2.485 | 5056.4 samples/s | 79.0 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00202 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=2.488 | 1770.4 samples/s | 27.7 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00177 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.491 | 4515.1 samples/s | 70.5 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00157 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=2.492 | 1807.5 samples/s | 28.2 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00141 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=2.494 | 4329.8 samples/s | 67.7 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00129 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.437 | L2-Norm(final)=2.495 | 1860.9 samples/s | 29.1 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00118 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=2.497 | 4302.3 samples/s | 67.2 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00109 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=2.498 | 1852.5 samples/s | 28.9 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00101 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.369 | L2-Norm(final)=2.499 | 4235.0 samples/s | 66.2 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00094 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.346 | L2-Norm(final)=2.500 | 1863.7 samples/s | 29.1 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00089 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=2.501 | 4235.8 samples/s | 66.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.8] | Loss=0.02007 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.438 | L2-Norm(final)=2.475 | 3679.7 samples/s | 57.5 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00554 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=2.479 | 3972.2 samples/s | 62.1 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00332 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=2.486 | 5908.8 samples/s | 92.3 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00223 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=2.492 | 1679.1 samples/s | 26.2 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00168 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=2.495 | 5384.3 samples/s | 84.1 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00134 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=2.498 | 1678.9 samples/s | 26.2 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00112 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.513 | L2-Norm(final)=2.499 | 5109.0 samples/s | 79.8 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00096 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=2.501 | 1767.3 samples/s | 27.6 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00084 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.479 | L2-Norm(final)=2.502 | 4792.3 samples/s | 74.9 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00075 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.461 | L2-Norm(final)=2.503 | 1766.9 samples/s | 27.6 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00068 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=2.504 | 4565.1 samples/s | 71.3 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00062 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.423 | L2-Norm(final)=2.505 | 1773.7 samples/s | 27.7 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00057 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.404 | L2-Norm(final)=2.506 | 4186.7 samples/s | 65.4 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00052 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=2.506 | 1835.5 samples/s | 28.7 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00049 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=2.507 | 4187.0 samples/s | 65.4 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00045 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=2.508 | 1838.3 samples/s | 28.7 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00043 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=2.508 | 4284.9 samples/s | 67.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34160 | acc=0.7784 | tpr=0.6839 | fpr=0.0164 | 3898.3 samples/s | 15.2 steps/s
Avg test loss: 0.34090, Avg test acc: 0.78087, Avg tpr: 0.68928, Avg fpr: 0.01769, total FA: 138

Testing server on iccad2012
[Step=  50] | Loss=0.25053 | acc=0.8853 | tpr=0.9735 | fpr=0.1163 | 3838.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.25433 | acc=0.8820 | tpr=0.9765 | fpr=0.1198 | 7227.4 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.25821 | acc=0.8821 | tpr=0.9813 | fpr=0.1197 | 7683.3 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.26034 | acc=0.8820 | tpr=0.9803 | fpr=0.1198 | 7441.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.26100 | acc=0.8821 | tpr=0.9790 | fpr=0.1197 | 7352.1 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.26340 | acc=0.8819 | tpr=0.9796 | fpr=0.1199 | 7819.0 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.26366 | acc=0.8817 | tpr=0.9787 | fpr=0.1201 | 7317.9 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.26402 | acc=0.8814 | tpr=0.9776 | fpr=0.1203 | 7442.9 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.26595 | acc=0.8812 | tpr=0.9757 | fpr=0.1205 | 7674.3 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.26573 | acc=0.8810 | tpr=0.9749 | fpr=0.1207 | 7519.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.26503 | acc=0.8812 | tpr=0.9741 | fpr=0.1204 | 14282.1 samples/s | 55.8 steps/s
Avg test loss: 0.26491, Avg test acc: 0.88130, Avg tpr: 0.97425, Avg fpr: 0.12039, total FA: 16716

server round 13/50

clients selected: [3 5 7 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.16516 | Reg=0.00206 | acc=0.8594 | L2-Norm=14.351 | L2-Norm(final)=2.506 | 3629.7 samples/s | 56.7 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06528 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.394 | L2-Norm(final)=2.487 | 4311.6 samples/s | 67.4 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05235 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.420 | L2-Norm(final)=2.485 | 4467.2 samples/s | 69.8 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04577 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.438 | L2-Norm(final)=2.486 | 4476.8 samples/s | 69.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04100 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=2.489 | 6003.4 samples/s | 93.8 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03540 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=2.495 | 1706.4 samples/s | 26.7 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03284 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.483 | L2-Norm(final)=2.501 | 4437.3 samples/s | 69.3 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03039 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=2.505 | 4438.9 samples/s | 69.4 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02871 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=2.510 | 5348.1 samples/s | 83.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02678 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.516 | L2-Norm(final)=2.515 | 1756.8 samples/s | 27.4 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02496 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=2.521 | 4459.6 samples/s | 69.7 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02344 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.535 | L2-Norm(final)=2.527 | 4473.1 samples/s | 69.9 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02280 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=2.532 | 5128.1 samples/s | 80.1 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02182 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.552 | L2-Norm(final)=2.537 | 1805.5 samples/s | 28.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02108 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.560 | L2-Norm(final)=2.542 | 4473.4 samples/s | 69.9 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02036 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.567 | L2-Norm(final)=2.546 | 4400.6 samples/s | 68.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01953 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.573 | L2-Norm(final)=2.550 | 4821.3 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.1] | Loss=0.04222 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.351 | L2-Norm(final)=2.506 | 3858.1 samples/s | 60.3 steps/s
[Step=5650 Epoch=53.5] | Loss=0.01438 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.446 | L2-Norm(final)=2.493 | 3752.5 samples/s | 58.6 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00863 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=2.481 | 5843.9 samples/s | 91.3 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00620 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=2.484 | 1639.4 samples/s | 25.6 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00467 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=2.488 | 5230.5 samples/s | 81.7 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00374 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=2.491 | 1689.9 samples/s | 26.4 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00313 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.494 | 4911.8 samples/s | 76.7 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00268 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=2.496 | 1756.4 samples/s | 27.4 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00235 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=2.498 | 4722.3 samples/s | 73.8 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00209 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=2.500 | 1796.3 samples/s | 28.1 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00188 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=2.501 | 4450.8 samples/s | 69.5 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00171 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.412 | L2-Norm(final)=2.503 | 1866.1 samples/s | 29.2 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00157 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=2.504 | 4309.2 samples/s | 67.3 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00145 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.372 | L2-Norm(final)=2.505 | 1850.9 samples/s | 28.9 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00135 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=2.507 | 4311.8 samples/s | 67.4 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00126 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=2.508 | 1884.0 samples/s | 29.4 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00118 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=2.509 | 4337.2 samples/s | 67.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.03317 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.351 | L2-Norm(final)=2.507 | 3636.1 samples/s | 56.8 steps/s
[Step=8050 Epoch=76.9] | Loss=0.00673 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=2.512 | 3863.9 samples/s | 60.4 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00498 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=2.517 | 5753.9 samples/s | 89.9 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00391 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.509 | L2-Norm(final)=2.518 | 1669.6 samples/s | 26.1 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00297 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=2.520 | 5291.2 samples/s | 82.7 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00238 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=2.521 | 1674.4 samples/s | 26.2 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00199 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=2.523 | 4949.8 samples/s | 77.3 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00170 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.524 | 1745.8 samples/s | 27.3 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00149 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=2.525 | 4723.7 samples/s | 73.8 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00133 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=2.526 | 1790.7 samples/s | 28.0 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00120 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=2.526 | 4581.2 samples/s | 71.6 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00109 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=2.527 | 1789.4 samples/s | 28.0 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00100 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=2.527 | 4339.0 samples/s | 67.8 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00092 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=2.528 | 1792.2 samples/s | 28.0 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00086 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=2.529 | 4217.2 samples/s | 65.9 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00080 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=2.529 | 1856.3 samples/s | 29.0 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00075 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=2.529 | 4242.1 samples/s | 66.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=37.7] | Loss=0.04540 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.351 | L2-Norm(final)=2.507 | 3574.3 samples/s | 55.8 steps/s
[Step=4050 Epoch=38.2] | Loss=0.01457 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=2.496 | 4014.3 samples/s | 62.7 steps/s
[Step=4100 Epoch=38.6] | Loss=0.00979 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=2.494 | 5628.3 samples/s | 87.9 steps/s
[Step=4150 Epoch=39.1] | Loss=0.00670 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=2.494 | 1663.6 samples/s | 26.0 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00506 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.520 | L2-Norm(final)=2.496 | 5188.2 samples/s | 81.1 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00406 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=2.497 | 1715.6 samples/s | 26.8 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00339 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.510 | L2-Norm(final)=2.499 | 4607.3 samples/s | 72.0 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00291 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.501 | L2-Norm(final)=2.500 | 1763.2 samples/s | 27.6 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00255 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.489 | L2-Norm(final)=2.501 | 4449.1 samples/s | 69.5 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00226 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=2.502 | 1864.6 samples/s | 29.1 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00204 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=2.503 | 4048.0 samples/s | 63.2 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00186 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.450 | L2-Norm(final)=2.503 | 1852.6 samples/s | 28.9 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00170 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=2.504 | 4365.0 samples/s | 68.2 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00157 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=2.505 | 1853.4 samples/s | 29.0 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00146 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=2.505 | 4179.2 samples/s | 65.3 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00136 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=2.506 | 1962.0 samples/s | 30.7 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00128 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=2.506 | 3718.9 samples/s | 58.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.03545 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.351 | L2-Norm(final)=2.507 | 3677.5 samples/s | 57.5 steps/s
[Step=4050 Epoch=38.6] | Loss=0.01641 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=2.506 | 3841.5 samples/s | 60.0 steps/s
[Step=4100 Epoch=39.1] | Loss=0.01166 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.520 | L2-Norm(final)=2.491 | 5811.3 samples/s | 90.8 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00787 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.546 | L2-Norm(final)=2.485 | 1634.0 samples/s | 25.5 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00609 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=2.483 | 5420.2 samples/s | 84.7 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00488 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=2.483 | 1698.9 samples/s | 26.5 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00407 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=2.483 | 5061.3 samples/s | 79.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00350 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=2.483 | 1743.0 samples/s | 27.2 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00306 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.536 | L2-Norm(final)=2.484 | 4891.8 samples/s | 76.4 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00272 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=2.484 | 1809.2 samples/s | 28.3 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00245 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=2.485 | 4575.1 samples/s | 71.5 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00223 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=2.485 | 1821.2 samples/s | 28.5 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00205 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.493 | L2-Norm(final)=2.485 | 4427.2 samples/s | 69.2 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00189 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=2.486 | 1814.1 samples/s | 28.3 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00176 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=2.486 | 4232.6 samples/s | 66.1 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00164 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.456 | L2-Norm(final)=2.487 | 1827.0 samples/s | 28.5 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00154 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=2.487 | 4421.9 samples/s | 69.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35419 | acc=0.7776 | tpr=0.6837 | fpr=0.0186 | 3915.9 samples/s | 15.3 steps/s
Avg test loss: 0.35307, Avg test acc: 0.77967, Avg tpr: 0.68806, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.25410 | acc=0.8873 | tpr=0.9823 | fpr=0.1144 | 3927.7 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.25605 | acc=0.8845 | tpr=0.9829 | fpr=0.1173 | 7828.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.26027 | acc=0.8851 | tpr=0.9856 | fpr=0.1167 | 7683.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.26310 | acc=0.8844 | tpr=0.9847 | fpr=0.1175 | 7839.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.26406 | acc=0.8840 | tpr=0.9834 | fpr=0.1178 | 7619.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.26665 | acc=0.8835 | tpr=0.9833 | fpr=0.1183 | 7632.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.26692 | acc=0.8834 | tpr=0.9818 | fpr=0.1184 | 7840.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.26738 | acc=0.8833 | tpr=0.9798 | fpr=0.1185 | 7297.3 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.26906 | acc=0.8830 | tpr=0.9781 | fpr=0.1187 | 7455.9 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.26908 | acc=0.8829 | tpr=0.9762 | fpr=0.1188 | 7592.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.26812 | acc=0.8832 | tpr=0.9757 | fpr=0.1185 | 14396.4 samples/s | 56.2 steps/s
Avg test loss: 0.26806, Avg test acc: 0.88320, Avg tpr: 0.97583, Avg fpr: 0.11848, total FA: 16451

server round 14/50

clients selected: [0 1 4 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.22717 | Reg=0.00205 | acc=0.8438 | L2-Norm=14.316 | L2-Norm(final)=2.525 | 3696.8 samples/s | 57.8 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05861 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.358 | L2-Norm(final)=2.506 | 4317.5 samples/s | 67.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05149 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.378 | L2-Norm(final)=2.502 | 4563.0 samples/s | 71.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04603 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.391 | L2-Norm(final)=2.501 | 4472.8 samples/s | 69.9 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04138 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.403 | L2-Norm(final)=2.503 | 5748.8 samples/s | 89.8 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03556 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=2.509 | 1738.8 samples/s | 27.2 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03181 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.427 | L2-Norm(final)=2.516 | 4439.7 samples/s | 69.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02988 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=2.521 | 4424.9 samples/s | 69.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02826 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=2.526 | 5543.3 samples/s | 86.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02687 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=2.531 | 1746.1 samples/s | 27.3 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02542 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=2.536 | 4493.4 samples/s | 70.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02428 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=2.541 | 4495.0 samples/s | 70.2 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02326 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.482 | L2-Norm(final)=2.546 | 5239.7 samples/s | 81.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02214 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=2.550 | 1795.8 samples/s | 28.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02125 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.497 | L2-Norm(final)=2.555 | 4377.1 samples/s | 68.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02082 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.559 | 4530.0 samples/s | 70.8 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02022 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.509 | L2-Norm(final)=2.562 | 4895.3 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.34318 | Reg=0.00205 | acc=0.7969 | L2-Norm=14.316 | L2-Norm(final)=2.525 | 3635.0 samples/s | 56.8 steps/s
[Step=3250 Epoch=15.9] | Loss=0.05635 | Reg=0.00206 | acc=0.9219 | L2-Norm=14.359 | L2-Norm(final)=2.515 | 4239.2 samples/s | 66.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04730 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.381 | L2-Norm(final)=2.513 | 4370.0 samples/s | 68.3 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04037 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.396 | L2-Norm(final)=2.516 | 4438.4 samples/s | 69.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.03745 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.408 | L2-Norm(final)=2.519 | 6001.6 samples/s | 93.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.03360 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.418 | L2-Norm(final)=2.521 | 1726.2 samples/s | 27.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03042 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=2.524 | 4532.4 samples/s | 70.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.02848 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.436 | L2-Norm(final)=2.527 | 4365.6 samples/s | 68.2 steps/s
[Step=3600 Epoch=17.6] | Loss=0.02711 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.443 | L2-Norm(final)=2.530 | 5590.3 samples/s | 87.3 steps/s
[Step=3650 Epoch=17.8] | Loss=0.02530 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.450 | L2-Norm(final)=2.533 | 1741.1 samples/s | 27.2 steps/s
[Step=3700 Epoch=18.1] | Loss=0.02370 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=2.536 | 4533.8 samples/s | 70.8 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02262 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=2.540 | 4578.1 samples/s | 71.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02169 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=2.543 | 5383.2 samples/s | 84.1 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02067 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.475 | L2-Norm(final)=2.547 | 1797.8 samples/s | 28.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.01973 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=2.550 | 4221.9 samples/s | 66.0 steps/s
[Step=3950 Epoch=19.3] | Loss=0.01900 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=2.553 | 4385.3 samples/s | 68.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.01859 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.488 | L2-Norm(final)=2.555 | 5022.3 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.4] | Loss=0.14681 | Reg=0.00205 | acc=0.8594 | L2-Norm=14.316 | L2-Norm(final)=2.526 | 3673.3 samples/s | 57.4 steps/s
[Step=6450 Epoch=31.6] | Loss=0.05622 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.355 | L2-Norm(final)=2.508 | 4113.8 samples/s | 64.3 steps/s
[Step=6500 Epoch=31.9] | Loss=0.04729 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.375 | L2-Norm(final)=2.504 | 4469.2 samples/s | 69.8 steps/s
[Step=6550 Epoch=32.1] | Loss=0.04242 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.392 | L2-Norm(final)=2.504 | 4456.1 samples/s | 69.6 steps/s
[Step=6600 Epoch=32.4] | Loss=0.03897 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.410 | L2-Norm(final)=2.508 | 6040.6 samples/s | 94.4 steps/s
[Step=6650 Epoch=32.6] | Loss=0.03396 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=2.513 | 1702.4 samples/s | 26.6 steps/s
[Step=6700 Epoch=32.9] | Loss=0.03088 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.439 | L2-Norm(final)=2.520 | 4438.5 samples/s | 69.4 steps/s
[Step=6750 Epoch=33.1] | Loss=0.02902 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.451 | L2-Norm(final)=2.525 | 4443.6 samples/s | 69.4 steps/s
[Step=6800 Epoch=33.3] | Loss=0.02750 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.462 | L2-Norm(final)=2.529 | 5898.7 samples/s | 92.2 steps/s
[Step=6850 Epoch=33.6] | Loss=0.02592 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.472 | L2-Norm(final)=2.533 | 1722.9 samples/s | 26.9 steps/s
[Step=6900 Epoch=33.8] | Loss=0.02436 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=2.537 | 4377.3 samples/s | 68.4 steps/s
[Step=6950 Epoch=34.1] | Loss=0.02338 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=2.541 | 4334.9 samples/s | 67.7 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02228 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.498 | L2-Norm(final)=2.545 | 5426.0 samples/s | 84.8 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02135 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=2.549 | 1774.1 samples/s | 27.7 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02036 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.513 | L2-Norm(final)=2.553 | 4354.6 samples/s | 68.0 steps/s
[Step=7150 Epoch=35.1] | Loss=0.01966 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.520 | L2-Norm(final)=2.557 | 4486.6 samples/s | 70.1 steps/s
[Step=7200 Epoch=35.3] | Loss=0.01895 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=2.561 | 5277.1 samples/s | 82.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.03130 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.316 | L2-Norm(final)=2.526 | 3984.1 samples/s | 62.3 steps/s
[Step=4050 Epoch=38.5] | Loss=0.02083 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.411 | L2-Norm(final)=2.494 | 3694.9 samples/s | 57.7 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01167 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=2.492 | 5951.4 samples/s | 93.0 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00798 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.488 | L2-Norm(final)=2.495 | 1682.2 samples/s | 26.3 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00601 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.493 | L2-Norm(final)=2.498 | 5447.6 samples/s | 85.1 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00481 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=2.500 | 1730.9 samples/s | 27.0 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00401 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.485 | L2-Norm(final)=2.501 | 4840.6 samples/s | 75.6 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00344 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=2.503 | 1754.8 samples/s | 27.4 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00302 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=2.504 | 4674.2 samples/s | 73.0 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00268 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=2.505 | 1824.6 samples/s | 28.5 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00242 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=2.506 | 4411.8 samples/s | 68.9 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00220 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=2.507 | 1836.0 samples/s | 28.7 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00202 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=2.508 | 4341.8 samples/s | 67.8 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00186 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=2.509 | 1850.9 samples/s | 28.9 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00173 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=2.509 | 4085.2 samples/s | 63.8 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00162 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=2.510 | 1883.4 samples/s | 29.4 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00151 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.371 | L2-Norm(final)=2.511 | 4215.7 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=84.0] | Loss=0.03001 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.316 | L2-Norm(final)=2.526 | 3697.0 samples/s | 57.8 steps/s
[Step=8850 Epoch=84.5] | Loss=0.01525 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=2.502 | 3899.5 samples/s | 60.9 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00806 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=2.508 | 5834.3 samples/s | 91.2 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00540 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.513 | L2-Norm(final)=2.513 | 1679.5 samples/s | 26.2 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00405 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=2.516 | 5571.2 samples/s | 87.1 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00327 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=2.519 | 1694.9 samples/s | 26.5 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00273 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=2.521 | 4979.1 samples/s | 77.8 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00234 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=2.523 | 1738.7 samples/s | 27.2 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00205 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.448 | L2-Norm(final)=2.524 | 4856.6 samples/s | 75.9 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00183 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.431 | L2-Norm(final)=2.526 | 1769.3 samples/s | 27.6 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00164 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=2.527 | 4458.1 samples/s | 69.7 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00150 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=2.528 | 1770.9 samples/s | 27.7 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00137 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=2.529 | 4329.3 samples/s | 67.6 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00127 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=2.530 | 1828.4 samples/s | 28.6 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00118 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.339 | L2-Norm(final)=2.531 | 4122.0 samples/s | 64.4 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00110 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.320 | L2-Norm(final)=2.532 | 1811.8 samples/s | 28.3 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00103 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=2.532 | 4281.9 samples/s | 66.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36163 | acc=0.7720 | tpr=0.6759 | fpr=0.0193 | 3872.9 samples/s | 15.1 steps/s
Avg test loss: 0.36049, Avg test acc: 0.77386, Avg tpr: 0.68025, Avg fpr: 0.02025, total FA: 158

Testing server on iccad2012
[Step=  50] | Loss=0.25649 | acc=0.8880 | tpr=0.9779 | fpr=0.1136 | 3817.6 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.25809 | acc=0.8868 | tpr=0.9808 | fpr=0.1150 | 7379.2 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.26282 | acc=0.8867 | tpr=0.9841 | fpr=0.1151 | 7655.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.26570 | acc=0.8862 | tpr=0.9836 | fpr=0.1155 | 7392.2 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.26660 | acc=0.8862 | tpr=0.9834 | fpr=0.1156 | 7500.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.26903 | acc=0.8857 | tpr=0.9833 | fpr=0.1161 | 7567.9 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.26937 | acc=0.8859 | tpr=0.9825 | fpr=0.1159 | 7685.3 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.27005 | acc=0.8856 | tpr=0.9809 | fpr=0.1161 | 7573.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.27200 | acc=0.8853 | tpr=0.9800 | fpr=0.1164 | 7638.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.27197 | acc=0.8851 | tpr=0.9793 | fpr=0.1166 | 7929.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.27095 | acc=0.8853 | tpr=0.9789 | fpr=0.1164 | 14097.7 samples/s | 55.1 steps/s
Avg test loss: 0.27084, Avg test acc: 0.88537, Avg tpr: 0.97900, Avg fpr: 0.11633, total FA: 16152

server round 15/50

clients selected: [1 2 3 4 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.44764 | Reg=0.00201 | acc=0.7500 | L2-Norm=14.184 | L2-Norm(final)=2.555 | 3786.3 samples/s | 59.2 steps/s
[Step=4050 Epoch=19.8] | Loss=0.05869 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.211 | L2-Norm(final)=2.537 | 3952.6 samples/s | 61.8 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05197 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.235 | L2-Norm(final)=2.537 | 4411.1 samples/s | 68.9 steps/s
[Step=4150 Epoch=20.3] | Loss=0.04474 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.254 | L2-Norm(final)=2.537 | 4495.2 samples/s | 70.2 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04068 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.269 | L2-Norm(final)=2.539 | 6000.2 samples/s | 93.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03579 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.283 | L2-Norm(final)=2.542 | 1729.4 samples/s | 27.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03252 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=2.546 | 4541.5 samples/s | 71.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.02979 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=2.550 | 4488.6 samples/s | 70.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.02764 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.316 | L2-Norm(final)=2.554 | 5726.3 samples/s | 89.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02563 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.325 | L2-Norm(final)=2.558 | 1791.7 samples/s | 28.0 steps/s
[Step=4500 Epoch=22.0] | Loss=0.02416 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.333 | L2-Norm(final)=2.562 | 4543.9 samples/s | 71.0 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02298 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.340 | L2-Norm(final)=2.565 | 4483.9 samples/s | 70.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02204 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.346 | L2-Norm(final)=2.569 | 5336.8 samples/s | 83.4 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02113 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=2.572 | 1767.4 samples/s | 27.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02027 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.357 | L2-Norm(final)=2.575 | 4298.3 samples/s | 67.2 steps/s
[Step=4750 Epoch=23.2] | Loss=0.01948 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=2.578 | 4407.7 samples/s | 68.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.01882 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.367 | L2-Norm(final)=2.581 | 5029.8 samples/s | 78.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.40078 | Reg=0.00201 | acc=0.7656 | L2-Norm=14.184 | L2-Norm(final)=2.555 | 3631.9 samples/s | 56.7 steps/s
[Step=5650 Epoch=27.5] | Loss=0.06519 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.224 | L2-Norm(final)=2.534 | 4256.4 samples/s | 66.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05464 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.245 | L2-Norm(final)=2.534 | 4363.3 samples/s | 68.2 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04774 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.262 | L2-Norm(final)=2.535 | 4454.0 samples/s | 69.6 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04438 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.279 | L2-Norm(final)=2.537 | 5742.2 samples/s | 89.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03923 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.293 | L2-Norm(final)=2.540 | 1745.6 samples/s | 27.3 steps/s
[Step=5900 Epoch=28.7] | Loss=0.03562 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.307 | L2-Norm(final)=2.544 | 4452.3 samples/s | 69.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03249 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.320 | L2-Norm(final)=2.549 | 4517.7 samples/s | 70.6 steps/s
[Step=6000 Epoch=29.2] | Loss=0.03047 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=2.554 | 5520.7 samples/s | 86.3 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02850 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=2.559 | 1783.5 samples/s | 27.9 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02701 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=2.564 | 4535.1 samples/s | 70.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02553 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=2.570 | 4479.8 samples/s | 70.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02452 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.373 | L2-Norm(final)=2.574 | 5132.6 samples/s | 80.2 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02375 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=2.578 | 1812.4 samples/s | 28.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02270 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.389 | L2-Norm(final)=2.582 | 4397.8 samples/s | 68.7 steps/s
[Step=6350 Epoch=30.9] | Loss=0.02188 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=2.585 | 4514.3 samples/s | 70.5 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02113 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.404 | L2-Norm(final)=2.589 | 4854.4 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.12356 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.184 | L2-Norm(final)=2.557 | 3564.5 samples/s | 55.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06604 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.237 | L2-Norm(final)=2.532 | 4135.0 samples/s | 64.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05079 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.268 | L2-Norm(final)=2.533 | 4518.4 samples/s | 70.6 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04388 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.290 | L2-Norm(final)=2.537 | 4384.0 samples/s | 68.5 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03970 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.308 | L2-Norm(final)=2.542 | 5808.7 samples/s | 90.8 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03527 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.326 | L2-Norm(final)=2.546 | 1753.8 samples/s | 27.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03259 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.342 | L2-Norm(final)=2.552 | 4515.5 samples/s | 70.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03009 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.358 | L2-Norm(final)=2.558 | 4492.3 samples/s | 70.2 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02792 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=2.565 | 5668.5 samples/s | 88.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02580 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=2.571 | 1740.6 samples/s | 27.2 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02425 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=2.578 | 4456.7 samples/s | 69.6 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02340 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.407 | L2-Norm(final)=2.582 | 4454.7 samples/s | 69.6 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02221 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=2.587 | 5229.1 samples/s | 81.7 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02124 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.424 | L2-Norm(final)=2.592 | 1832.1 samples/s | 28.6 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02043 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.432 | L2-Norm(final)=2.596 | 4408.5 samples/s | 68.9 steps/s
[Step=6350 Epoch=31.0] | Loss=0.01989 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.439 | L2-Norm(final)=2.600 | 4542.4 samples/s | 71.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01917 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=2.604 | 4956.2 samples/s | 77.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step6400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.3] | Loss=0.35186 | Reg=0.00201 | acc=0.7812 | L2-Norm=14.184 | L2-Norm(final)=2.555 | 3998.0 samples/s | 62.5 steps/s
[Step=7250 Epoch=35.6] | Loss=0.06056 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.231 | L2-Norm(final)=2.535 | 3967.8 samples/s | 62.0 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04953 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.257 | L2-Norm(final)=2.530 | 4523.1 samples/s | 70.7 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04369 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.275 | L2-Norm(final)=2.529 | 4497.8 samples/s | 70.3 steps/s
[Step=7400 Epoch=36.3] | Loss=0.04041 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.295 | L2-Norm(final)=2.533 | 6085.7 samples/s | 95.1 steps/s
[Step=7450 Epoch=36.5] | Loss=0.03537 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.314 | L2-Norm(final)=2.538 | 1721.7 samples/s | 26.9 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03272 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.329 | L2-Norm(final)=2.544 | 4531.3 samples/s | 70.8 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03058 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.343 | L2-Norm(final)=2.549 | 4463.0 samples/s | 69.7 steps/s
[Step=7600 Epoch=37.3] | Loss=0.02857 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.356 | L2-Norm(final)=2.554 | 5818.1 samples/s | 90.9 steps/s
[Step=7650 Epoch=37.5] | Loss=0.02619 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.368 | L2-Norm(final)=2.560 | 1737.5 samples/s | 27.1 steps/s
[Step=7700 Epoch=37.8] | Loss=0.02451 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=2.566 | 4533.1 samples/s | 70.8 steps/s
[Step=7750 Epoch=38.0] | Loss=0.02305 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.390 | L2-Norm(final)=2.572 | 4408.2 samples/s | 68.9 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02224 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=2.577 | 5536.6 samples/s | 86.5 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02156 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.407 | L2-Norm(final)=2.582 | 1745.9 samples/s | 27.3 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02059 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.415 | L2-Norm(final)=2.586 | 4317.8 samples/s | 67.5 steps/s
[Step=7950 Epoch=39.0] | Loss=0.01989 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.422 | L2-Norm(final)=2.590 | 4447.8 samples/s | 69.5 steps/s
[Step=8000 Epoch=39.2] | Loss=0.01937 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=2.594 | 5250.5 samples/s | 82.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.2] | Loss=0.09904 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.184 | L2-Norm(final)=2.555 | 4086.1 samples/s | 63.8 steps/s
[Step=4850 Epoch=45.7] | Loss=0.01323 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.281 | L2-Norm(final)=2.537 | 3655.1 samples/s | 57.1 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00857 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=2.540 | 5619.3 samples/s | 87.8 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00589 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=2.544 | 1697.4 samples/s | 26.5 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00445 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=2.548 | 5194.1 samples/s | 81.2 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00357 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=2.551 | 1750.7 samples/s | 27.4 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00298 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=2.554 | 4738.6 samples/s | 74.0 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00256 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=2.556 | 1769.3 samples/s | 27.6 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00224 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.315 | L2-Norm(final)=2.558 | 4409.6 samples/s | 68.9 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00199 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=2.560 | 1849.4 samples/s | 28.9 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00180 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=2.561 | 4331.5 samples/s | 67.7 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00163 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=2.563 | 1865.9 samples/s | 29.2 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00150 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=2.564 | 4385.4 samples/s | 68.5 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00139 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.565 | 1874.4 samples/s | 29.3 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00129 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=2.566 | 4298.0 samples/s | 67.2 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00120 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.567 | 1997.0 samples/s | 31.2 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00113 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.205 | L2-Norm(final)=2.568 | 3770.2 samples/s | 58.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36526 | acc=0.7664 | tpr=0.6659 | fpr=0.0154 | 3988.0 samples/s | 15.6 steps/s
Avg test loss: 0.36383, Avg test acc: 0.76761, Avg tpr: 0.66976, Avg fpr: 0.01718, total FA: 134

Testing server on iccad2012
[Step=  50] | Loss=0.24428 | acc=0.8921 | tpr=0.9823 | fpr=0.1095 | 3843.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.24579 | acc=0.8904 | tpr=0.9829 | fpr=0.1114 | 7836.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.25072 | acc=0.8903 | tpr=0.9841 | fpr=0.1114 | 7547.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.25336 | acc=0.8900 | tpr=0.9825 | fpr=0.1117 | 7834.9 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.25420 | acc=0.8900 | tpr=0.9825 | fpr=0.1116 | 7736.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.25626 | acc=0.8898 | tpr=0.9825 | fpr=0.1119 | 7859.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.25680 | acc=0.8901 | tpr=0.9818 | fpr=0.1116 | 7843.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.25750 | acc=0.8899 | tpr=0.9792 | fpr=0.1117 | 7497.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.25951 | acc=0.8898 | tpr=0.9786 | fpr=0.1118 | 7658.1 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.25953 | acc=0.8897 | tpr=0.9789 | fpr=0.1119 | 7738.4 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.25851 | acc=0.8899 | tpr=0.9785 | fpr=0.1117 | 14386.6 samples/s | 56.2 steps/s
Avg test loss: 0.25832, Avg test acc: 0.89001, Avg tpr: 0.97861, Avg fpr: 0.11160, total FA: 15496

server round 16/50

clients selected: [1 3 5 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.28817 | Reg=0.00199 | acc=0.7812 | L2-Norm=14.104 | L2-Norm(final)=2.584 | 3452.4 samples/s | 53.9 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06627 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=2.561 | 4283.1 samples/s | 66.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05102 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.166 | L2-Norm(final)=2.562 | 4591.3 samples/s | 71.7 steps/s
[Step=4950 Epoch=24.2] | Loss=0.04451 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=2.564 | 4319.4 samples/s | 67.5 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04017 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.203 | L2-Norm(final)=2.567 | 5771.9 samples/s | 90.2 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03653 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.218 | L2-Norm(final)=2.569 | 1719.5 samples/s | 26.9 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03269 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.232 | L2-Norm(final)=2.573 | 4379.4 samples/s | 68.4 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03049 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=2.577 | 4419.2 samples/s | 69.0 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02860 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.256 | L2-Norm(final)=2.581 | 5539.7 samples/s | 86.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02686 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.267 | L2-Norm(final)=2.585 | 1743.1 samples/s | 27.2 steps/s
[Step=5300 Epoch=25.9] | Loss=0.02532 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=2.588 | 4456.9 samples/s | 69.6 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02374 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.285 | L2-Norm(final)=2.592 | 4477.3 samples/s | 70.0 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02276 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.293 | L2-Norm(final)=2.595 | 5295.2 samples/s | 82.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02171 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.300 | L2-Norm(final)=2.599 | 1757.3 samples/s | 27.5 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02075 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=2.602 | 4305.5 samples/s | 67.3 steps/s
[Step=5550 Epoch=27.1] | Loss=0.01984 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=2.606 | 4325.0 samples/s | 67.6 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01912 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=2.610 | 4939.2 samples/s | 77.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.21950 | Reg=0.00199 | acc=0.8281 | L2-Norm=14.104 | L2-Norm(final)=2.584 | 3836.3 samples/s | 59.9 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06331 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.177 | L2-Norm(final)=2.557 | 4083.3 samples/s | 63.8 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05161 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.560 | 4489.6 samples/s | 70.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04494 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.238 | L2-Norm(final)=2.563 | 4471.2 samples/s | 69.9 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04049 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=2.565 | 5924.3 samples/s | 92.6 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03503 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=2.570 | 1730.6 samples/s | 27.0 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03163 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.281 | L2-Norm(final)=2.576 | 4396.8 samples/s | 68.7 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02900 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.292 | L2-Norm(final)=2.582 | 4410.5 samples/s | 68.9 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02746 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.303 | L2-Norm(final)=2.587 | 5348.4 samples/s | 83.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02618 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=2.592 | 1759.8 samples/s | 27.5 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02538 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.323 | L2-Norm(final)=2.596 | 4417.6 samples/s | 69.0 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02432 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.332 | L2-Norm(final)=2.599 | 4476.8 samples/s | 69.9 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02330 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.341 | L2-Norm(final)=2.603 | 5239.8 samples/s | 81.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02224 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.350 | L2-Norm(final)=2.607 | 1804.7 samples/s | 28.2 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02133 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=2.611 | 4512.5 samples/s | 70.5 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02076 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=2.615 | 4383.3 samples/s | 68.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02005 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.372 | L2-Norm(final)=2.618 | 4889.6 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.7] | Loss=0.02741 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=2.585 | 3494.6 samples/s | 54.6 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00799 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.586 | 4192.8 samples/s | 65.5 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00480 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.251 | L2-Norm(final)=2.589 | 5766.9 samples/s | 90.1 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00327 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.258 | L2-Norm(final)=2.593 | 1693.0 samples/s | 26.5 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00246 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.251 | L2-Norm(final)=2.597 | 5287.9 samples/s | 82.6 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00197 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=2.599 | 1718.4 samples/s | 26.8 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00164 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=2.601 | 4977.7 samples/s | 77.8 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00141 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.205 | L2-Norm(final)=2.603 | 1736.7 samples/s | 27.1 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00124 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.187 | L2-Norm(final)=2.604 | 4718.4 samples/s | 73.7 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00110 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=2.605 | 1813.8 samples/s | 28.3 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00099 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.150 | L2-Norm(final)=2.607 | 4378.1 samples/s | 68.4 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00090 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=2.608 | 1855.4 samples/s | 29.0 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00083 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.111 | L2-Norm(final)=2.610 | 4337.1 samples/s | 67.8 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00076 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=2.611 | 1853.1 samples/s | 29.0 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00071 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=2.612 | 4238.3 samples/s | 66.2 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00066 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.614 | 1856.7 samples/s | 29.0 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00062 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=2.615 | 4252.1 samples/s | 66.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.7] | Loss=0.01419 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=2.585 | 3542.4 samples/s | 55.4 steps/s
[Step=4850 Epoch=46.1] | Loss=0.01003 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=2.576 | 4149.5 samples/s | 64.8 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00648 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.580 | 5814.2 samples/s | 90.8 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00475 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=2.583 | 1684.6 samples/s | 26.3 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00358 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=2.585 | 5412.0 samples/s | 84.6 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00287 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=2.588 | 1740.3 samples/s | 27.2 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00240 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=2.590 | 4871.4 samples/s | 76.1 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00206 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=2.591 | 1764.0 samples/s | 27.6 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00180 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.218 | L2-Norm(final)=2.593 | 4637.0 samples/s | 72.5 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00160 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=2.594 | 1809.7 samples/s | 28.3 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00144 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=2.595 | 4388.5 samples/s | 68.6 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00131 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=2.596 | 1849.4 samples/s | 28.9 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00121 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=2.597 | 4365.3 samples/s | 68.2 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00111 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=2.598 | 1825.7 samples/s | 28.5 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00103 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.146 | L2-Norm(final)=2.598 | 4303.6 samples/s | 67.2 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00097 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=2.599 | 1905.0 samples/s | 29.8 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00091 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.600 | 4200.1 samples/s | 65.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=52.8] | Loss=0.02763 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.104 | L2-Norm(final)=2.585 | 3762.8 samples/s | 58.8 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00961 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=2.577 | 4081.7 samples/s | 63.8 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00572 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.210 | L2-Norm(final)=2.584 | 5747.2 samples/s | 89.8 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00393 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=2.591 | 1705.7 samples/s | 26.7 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00296 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=2.596 | 5292.9 samples/s | 82.7 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00238 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.225 | L2-Norm(final)=2.600 | 1731.2 samples/s | 27.1 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00199 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.603 | 4834.9 samples/s | 75.5 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00171 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=2.605 | 1802.3 samples/s | 28.2 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00149 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.607 | 4493.5 samples/s | 70.2 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00133 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=2.609 | 1846.2 samples/s | 28.8 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00120 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=2.610 | 4254.8 samples/s | 66.5 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00109 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=2.611 | 1874.9 samples/s | 29.3 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00100 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=2.612 | 4333.8 samples/s | 67.7 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00092 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=2.613 | 1872.5 samples/s | 29.3 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00086 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=2.614 | 4277.3 samples/s | 66.8 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00080 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=2.615 | 2020.2 samples/s | 31.6 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00075 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=2.616 | 3912.3 samples/s | 61.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38232 | acc=0.7626 | tpr=0.6607 | fpr=0.0161 | 4024.7 samples/s | 15.7 steps/s
Avg test loss: 0.38079, Avg test acc: 0.76436, Avg tpr: 0.66474, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.22769 | acc=0.8979 | tpr=0.9779 | fpr=0.1035 | 4150.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.22910 | acc=0.8983 | tpr=0.9808 | fpr=0.1033 | 7352.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.23378 | acc=0.8974 | tpr=0.9827 | fpr=0.1042 | 7644.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.23643 | acc=0.8971 | tpr=0.9814 | fpr=0.1044 | 7776.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.23717 | acc=0.8973 | tpr=0.9817 | fpr=0.1043 | 7940.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.23932 | acc=0.8971 | tpr=0.9818 | fpr=0.1045 | 7854.9 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.23987 | acc=0.8968 | tpr=0.9812 | fpr=0.1047 | 7612.2 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.24037 | acc=0.8966 | tpr=0.9787 | fpr=0.1049 | 7562.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.24237 | acc=0.8962 | tpr=0.9786 | fpr=0.1053 | 5300.1 samples/s | 20.7 steps/s
[Step= 500] | Loss=0.24239 | acc=0.8961 | tpr=0.9780 | fpr=0.1054 | 7650.3 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.24165 | acc=0.8963 | tpr=0.9773 | fpr=0.1052 | 14500.3 samples/s | 56.6 steps/s
Avg test loss: 0.24149, Avg test acc: 0.89633, Avg tpr: 0.97742, Avg fpr: 0.10514, total FA: 14599

server round 17/50

clients selected: [0 1 5 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.19153 | Reg=0.00197 | acc=0.8438 | L2-Norm=14.034 | L2-Norm(final)=2.613 | 3616.3 samples/s | 56.5 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04600 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.085 | L2-Norm(final)=2.604 | 4399.9 samples/s | 68.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04183 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.104 | L2-Norm(final)=2.600 | 4551.5 samples/s | 71.1 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03923 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.120 | L2-Norm(final)=2.599 | 4591.2 samples/s | 71.7 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03538 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.136 | L2-Norm(final)=2.601 | 6069.4 samples/s | 94.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03142 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.606 | 1743.5 samples/s | 27.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02873 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=2.611 | 4409.6 samples/s | 68.9 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02657 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=2.616 | 4466.6 samples/s | 69.8 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02552 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.621 | 5580.5 samples/s | 87.2 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02413 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.204 | L2-Norm(final)=2.625 | 1779.0 samples/s | 27.8 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02241 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.214 | L2-Norm(final)=2.630 | 4515.7 samples/s | 70.6 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02153 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=2.634 | 4461.8 samples/s | 69.7 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02054 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=2.638 | 5128.1 samples/s | 80.1 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01997 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=2.641 | 1735.5 samples/s | 27.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01931 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=2.644 | 4139.8 samples/s | 64.7 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01864 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.647 | 4295.7 samples/s | 67.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01779 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=2.651 | 4773.4 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.29307 | Reg=0.00197 | acc=0.7500 | L2-Norm=14.034 | L2-Norm(final)=2.612 | 3710.2 samples/s | 58.0 steps/s
[Step=5650 Epoch=27.6] | Loss=0.07998 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.101 | L2-Norm(final)=2.573 | 4198.3 samples/s | 65.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05964 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.140 | L2-Norm(final)=2.571 | 4126.5 samples/s | 64.5 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04915 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=2.575 | 4147.7 samples/s | 64.8 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04403 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.185 | L2-Norm(final)=2.579 | 5622.9 samples/s | 87.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03954 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=2.584 | 1695.7 samples/s | 26.5 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03500 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.216 | L2-Norm(final)=2.588 | 4452.6 samples/s | 69.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03179 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=2.594 | 4441.8 samples/s | 69.4 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02992 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.240 | L2-Norm(final)=2.598 | 5598.2 samples/s | 87.5 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02813 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.602 | 1672.7 samples/s | 26.1 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02625 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=2.606 | 4088.5 samples/s | 63.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02497 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=2.610 | 4468.0 samples/s | 69.8 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02374 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.273 | L2-Norm(final)=2.614 | 5285.3 samples/s | 82.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02234 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.280 | L2-Norm(final)=2.618 | 1809.0 samples/s | 28.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02128 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=2.622 | 4390.2 samples/s | 68.6 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02052 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=2.626 | 4326.1 samples/s | 67.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01997 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.296 | L2-Norm(final)=2.629 | 4927.7 samples/s | 77.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.2] | Loss=0.06484 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.034 | L2-Norm(final)=2.612 | 3621.5 samples/s | 56.6 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00729 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.125 | L2-Norm(final)=2.617 | 4006.7 samples/s | 62.6 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00622 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=2.613 | 5885.5 samples/s | 92.0 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00517 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=2.605 | 1650.1 samples/s | 25.8 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00420 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=2.598 | 5424.3 samples/s | 84.8 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00337 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=2.595 | 1727.0 samples/s | 27.0 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00281 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=2.593 | 5065.5 samples/s | 79.1 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00241 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=2.592 | 1782.3 samples/s | 27.8 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00211 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.591 | 4719.5 samples/s | 73.7 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00188 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.225 | L2-Norm(final)=2.591 | 1812.5 samples/s | 28.3 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00169 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=2.591 | 4404.5 samples/s | 68.8 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00154 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=2.591 | 1887.2 samples/s | 29.5 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00141 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.182 | L2-Norm(final)=2.591 | 4262.6 samples/s | 66.6 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00130 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=2.592 | 1840.4 samples/s | 28.8 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00121 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=2.592 | 4301.2 samples/s | 67.2 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00113 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=2.592 | 1832.0 samples/s | 28.6 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00106 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.593 | 4112.6 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.3] | Loss=0.09324 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.034 | L2-Norm(final)=2.611 | 3772.1 samples/s | 58.9 steps/s
[Step=6450 Epoch=60.8] | Loss=0.01064 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=2.591 | 3529.5 samples/s | 55.1 steps/s
[Step=6500 Epoch=61.2] | Loss=0.00730 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.598 | 5816.1 samples/s | 90.9 steps/s
[Step=6550 Epoch=61.7] | Loss=0.00495 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.607 | 1681.5 samples/s | 26.3 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00375 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=2.613 | 5258.6 samples/s | 82.2 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00300 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=2.617 | 1703.6 samples/s | 26.6 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00251 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.621 | 4271.0 samples/s | 66.7 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00215 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=2.623 | 1735.8 samples/s | 27.1 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00188 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=2.625 | 4336.7 samples/s | 67.8 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00167 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.182 | L2-Norm(final)=2.627 | 1783.5 samples/s | 27.9 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00151 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=2.628 | 4118.4 samples/s | 64.4 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00137 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.630 | 1774.2 samples/s | 27.7 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00126 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=2.631 | 4244.7 samples/s | 66.3 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00116 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=2.632 | 1813.6 samples/s | 28.3 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00108 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=2.633 | 4352.4 samples/s | 68.0 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00101 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=2.634 | 1894.2 samples/s | 29.6 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00095 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.635 | 3565.5 samples/s | 55.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.05741 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.034 | L2-Norm(final)=2.612 | 3667.7 samples/s | 57.3 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00499 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=2.619 | 4092.3 samples/s | 63.9 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00293 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.627 | 5887.9 samples/s | 92.0 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00206 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=2.631 | 1665.9 samples/s | 26.0 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00155 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=2.635 | 5394.8 samples/s | 84.3 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00124 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=2.637 | 1169.4 samples/s | 18.3 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00104 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.639 | 4666.7 samples/s | 72.9 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00089 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.097 | L2-Norm(final)=2.640 | 1746.2 samples/s | 27.3 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00078 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.086 | L2-Norm(final)=2.641 | 4913.3 samples/s | 76.8 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00070 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=2.642 | 1807.9 samples/s | 28.2 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00063 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=2.643 | 4682.0 samples/s | 73.2 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00057 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=2.644 | 1824.3 samples/s | 28.5 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00052 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=2.645 | 4173.5 samples/s | 65.2 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00048 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.021 | L2-Norm(final)=2.645 | 1850.7 samples/s | 28.9 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00045 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=2.646 | 4131.9 samples/s | 64.6 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00042 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.994 | L2-Norm(final)=2.647 | 1904.8 samples/s | 29.8 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00039 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.647 | 4341.3 samples/s | 67.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37933 | acc=0.7650 | tpr=0.6628 | fpr=0.0131 | 4028.2 samples/s | 15.7 steps/s
Avg test loss: 0.37719, Avg test acc: 0.76829, Avg tpr: 0.66923, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.23453 | acc=0.8963 | tpr=0.9779 | fpr=0.1051 | 3955.2 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.23640 | acc=0.8970 | tpr=0.9808 | fpr=0.1046 | 7859.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.24137 | acc=0.8961 | tpr=0.9813 | fpr=0.1054 | 7620.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.24402 | acc=0.8953 | tpr=0.9814 | fpr=0.1063 | 8108.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.24456 | acc=0.8952 | tpr=0.9808 | fpr=0.1063 | 7987.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.24695 | acc=0.8948 | tpr=0.9811 | fpr=0.1068 | 7655.8 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.24767 | acc=0.8949 | tpr=0.9806 | fpr=0.1066 | 7779.4 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.24836 | acc=0.8944 | tpr=0.9781 | fpr=0.1071 | 7687.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.25068 | acc=0.8939 | tpr=0.9771 | fpr=0.1076 | 7563.8 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.25078 | acc=0.8939 | tpr=0.9771 | fpr=0.1076 | 7685.6 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.24986 | acc=0.8941 | tpr=0.9769 | fpr=0.1074 | 13793.5 samples/s | 53.9 steps/s
Avg test loss: 0.24968, Avg test acc: 0.89414, Avg tpr: 0.97702, Avg fpr: 0.10736, total FA: 14907

server round 18/50

clients selected: [0 3 4 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.18053 | Reg=0.00195 | acc=0.8906 | L2-Norm=13.973 | L2-Norm(final)=2.638 | 3673.1 samples/s | 57.4 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05112 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.027 | L2-Norm(final)=2.627 | 4336.1 samples/s | 67.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04286 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.050 | L2-Norm(final)=2.623 | 4463.9 samples/s | 69.7 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03808 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.068 | L2-Norm(final)=2.623 | 4460.6 samples/s | 69.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03559 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.084 | L2-Norm(final)=2.625 | 5937.5 samples/s | 92.8 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03129 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.100 | L2-Norm(final)=2.630 | 1716.7 samples/s | 26.8 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02832 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=2.636 | 4354.8 samples/s | 68.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02718 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=2.641 | 4370.7 samples/s | 68.3 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02549 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.142 | L2-Norm(final)=2.646 | 5683.5 samples/s | 88.8 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02395 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.153 | L2-Norm(final)=2.651 | 1783.5 samples/s | 27.9 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02222 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.164 | L2-Norm(final)=2.657 | 4413.9 samples/s | 69.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02138 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.174 | L2-Norm(final)=2.662 | 4469.8 samples/s | 69.8 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02061 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.182 | L2-Norm(final)=2.666 | 5250.3 samples/s | 82.0 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01999 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.190 | L2-Norm(final)=2.670 | 1766.9 samples/s | 27.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01935 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.196 | L2-Norm(final)=2.672 | 4441.2 samples/s | 69.4 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01865 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.203 | L2-Norm(final)=2.675 | 4323.7 samples/s | 67.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01809 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.209 | L2-Norm(final)=2.679 | 4821.0 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.34558 | Reg=0.00195 | acc=0.8125 | L2-Norm=13.973 | L2-Norm(final)=2.637 | 3622.8 samples/s | 56.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05538 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.027 | L2-Norm(final)=2.611 | 4307.3 samples/s | 67.3 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04580 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.056 | L2-Norm(final)=2.610 | 4502.6 samples/s | 70.4 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04085 | Reg=0.00198 | acc=0.9375 | L2-Norm=14.073 | L2-Norm(final)=2.611 | 4376.6 samples/s | 68.4 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03769 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.612 | 6012.4 samples/s | 93.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03286 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.100 | L2-Norm(final)=2.615 | 1747.6 samples/s | 27.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02898 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=2.621 | 4455.9 samples/s | 69.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02643 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.628 | 4312.1 samples/s | 67.4 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02519 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=2.634 | 5304.5 samples/s | 82.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02348 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.146 | L2-Norm(final)=2.638 | 1722.8 samples/s | 26.9 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02212 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=2.643 | 4490.5 samples/s | 70.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02107 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=2.647 | 4340.0 samples/s | 67.8 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02013 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=2.652 | 5155.0 samples/s | 80.5 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01919 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.178 | L2-Norm(final)=2.656 | 1768.7 samples/s | 27.6 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01841 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=2.661 | 4391.6 samples/s | 68.6 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01786 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.665 | 4234.0 samples/s | 66.2 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01731 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.198 | L2-Norm(final)=2.669 | 4835.4 samples/s | 75.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.42131 | Reg=0.00195 | acc=0.7344 | L2-Norm=13.973 | L2-Norm(final)=2.637 | 3615.3 samples/s | 56.5 steps/s
[Step=8050 Epoch=39.5] | Loss=0.06006 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.044 | L2-Norm(final)=2.611 | 4226.1 samples/s | 66.0 steps/s
[Step=8100 Epoch=39.7] | Loss=0.04742 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=2.611 | 4169.8 samples/s | 65.2 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03997 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.099 | L2-Norm(final)=2.614 | 4452.8 samples/s | 69.6 steps/s
[Step=8200 Epoch=40.2] | Loss=0.03777 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.115 | L2-Norm(final)=2.616 | 6222.9 samples/s | 97.2 steps/s
[Step=8250 Epoch=40.5] | Loss=0.03327 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=2.620 | 1680.2 samples/s | 26.3 steps/s
[Step=8300 Epoch=40.7] | Loss=0.03018 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=2.625 | 4525.8 samples/s | 70.7 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02853 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.162 | L2-Norm(final)=2.630 | 4434.6 samples/s | 69.3 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02675 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=2.634 | 5887.6 samples/s | 92.0 steps/s
[Step=8450 Epoch=41.4] | Loss=0.02486 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.187 | L2-Norm(final)=2.639 | 1737.4 samples/s | 27.1 steps/s
[Step=8500 Epoch=41.7] | Loss=0.02336 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.198 | L2-Norm(final)=2.643 | 4487.2 samples/s | 70.1 steps/s
[Step=8550 Epoch=41.9] | Loss=0.02244 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.207 | L2-Norm(final)=2.647 | 4553.8 samples/s | 71.2 steps/s
[Step=8600 Epoch=42.2] | Loss=0.02152 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.650 | 5521.5 samples/s | 86.3 steps/s
[Step=8650 Epoch=42.4] | Loss=0.02044 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=2.654 | 1732.8 samples/s | 27.1 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01945 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=2.658 | 4480.0 samples/s | 70.0 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01880 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.238 | L2-Norm(final)=2.662 | 4428.7 samples/s | 69.2 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01820 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=2.665 | 5212.8 samples/s | 81.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=67.9] | Loss=0.00854 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.973 | L2-Norm(final)=2.639 | 3759.6 samples/s | 58.7 steps/s
[Step=7250 Epoch=68.3] | Loss=0.01323 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=2.612 | 3879.6 samples/s | 60.6 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00701 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=2.618 | 5530.7 samples/s | 86.4 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00473 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.156 | L2-Norm(final)=2.625 | 1654.3 samples/s | 25.8 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00356 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.156 | L2-Norm(final)=2.630 | 5189.0 samples/s | 81.1 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00285 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.149 | L2-Norm(final)=2.634 | 1714.2 samples/s | 26.8 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00238 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=2.637 | 4847.8 samples/s | 75.7 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00204 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.639 | 1759.3 samples/s | 27.5 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00179 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=2.642 | 4451.8 samples/s | 69.6 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00159 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=2.643 | 1837.7 samples/s | 28.7 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00143 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=2.645 | 4326.7 samples/s | 67.6 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00130 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.646 | 1847.5 samples/s | 28.9 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00120 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.648 | 4309.9 samples/s | 67.3 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00110 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=2.649 | 1865.8 samples/s | 29.2 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00103 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=2.650 | 4334.8 samples/s | 67.7 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00096 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=2.651 | 1944.1 samples/s | 30.4 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00090 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=2.652 | 3954.2 samples/s | 61.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.4] | Loss=0.14915 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.973 | L2-Norm(final)=2.637 | 3638.6 samples/s | 56.9 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00604 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=2.635 | 3935.3 samples/s | 61.5 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00322 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=2.643 | 5939.7 samples/s | 92.8 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00218 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=2.648 | 1662.5 samples/s | 26.0 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00164 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=2.651 | 5498.7 samples/s | 85.9 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00131 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=2.654 | 1702.9 samples/s | 26.6 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00110 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=2.656 | 4898.2 samples/s | 76.5 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00094 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=2.657 | 1722.5 samples/s | 26.9 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00083 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=2.658 | 4757.3 samples/s | 74.3 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00073 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=2.659 | 1649.4 samples/s | 25.8 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00066 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=2.660 | 4483.9 samples/s | 70.1 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00060 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=2.661 | 1803.1 samples/s | 28.2 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00055 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=2.662 | 4429.5 samples/s | 69.2 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00051 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=2.663 | 1879.1 samples/s | 29.4 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00047 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=2.664 | 4303.8 samples/s | 67.2 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00044 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=2.664 | 1890.8 samples/s | 29.5 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00042 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=2.665 | 4436.9 samples/s | 69.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37430 | acc=0.7682 | tpr=0.6677 | fpr=0.0136 | 3819.3 samples/s | 14.9 steps/s
Avg test loss: 0.37213, Avg test acc: 0.77206, Avg tpr: 0.67465, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.24028 | acc=0.8956 | tpr=0.9823 | fpr=0.1059 | 4014.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.24135 | acc=0.8954 | tpr=0.9829 | fpr=0.1063 | 8137.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.24671 | acc=0.8951 | tpr=0.9841 | fpr=0.1065 | 8010.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.24912 | acc=0.8947 | tpr=0.9836 | fpr=0.1069 | 8132.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.24964 | acc=0.8944 | tpr=0.9825 | fpr=0.1072 | 7994.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.25216 | acc=0.8941 | tpr=0.9825 | fpr=0.1076 | 7906.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.25283 | acc=0.8942 | tpr=0.9818 | fpr=0.1074 | 7958.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.25345 | acc=0.8936 | tpr=0.9787 | fpr=0.1079 | 8670.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.25578 | acc=0.8931 | tpr=0.9771 | fpr=0.1084 | 7452.9 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.25575 | acc=0.8930 | tpr=0.9771 | fpr=0.1085 | 7864.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.25483 | acc=0.8935 | tpr=0.9765 | fpr=0.1081 | 14207.5 samples/s | 55.5 steps/s
Avg test loss: 0.25463, Avg test acc: 0.89350, Avg tpr: 0.97662, Avg fpr: 0.10801, total FA: 14997

server round 19/50

clients selected: [0 2 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.06914 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.906 | L2-Norm(final)=2.657 | 3629.3 samples/s | 56.7 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04805 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.957 | L2-Norm(final)=2.638 | 4386.9 samples/s | 68.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03824 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.635 | 4064.4 samples/s | 63.5 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03626 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.636 | 4017.9 samples/s | 62.8 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03497 | Reg=0.00196 | acc=0.9531 | L2-Norm=14.013 | L2-Norm(final)=2.635 | 5690.2 samples/s | 88.9 steps/s
[Step=9050 Epoch=44.1] | Loss=0.03101 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.027 | L2-Norm(final)=2.638 | 1777.2 samples/s | 27.8 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02766 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.041 | L2-Norm(final)=2.643 | 4632.3 samples/s | 72.4 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02592 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.054 | L2-Norm(final)=2.648 | 4654.4 samples/s | 72.7 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02457 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.067 | L2-Norm(final)=2.654 | 5770.5 samples/s | 90.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02299 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.078 | L2-Norm(final)=2.659 | 1825.6 samples/s | 28.5 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02186 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=2.665 | 4654.6 samples/s | 72.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02101 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=2.669 | 4628.0 samples/s | 72.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02038 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.107 | L2-Norm(final)=2.674 | 5406.0 samples/s | 84.5 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01962 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=2.677 | 1841.7 samples/s | 28.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01870 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=2.682 | 4635.4 samples/s | 72.4 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01798 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=2.687 | 4522.4 samples/s | 70.7 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01762 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=2.691 | 5005.6 samples/s | 78.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.28389 | Reg=0.00193 | acc=0.8281 | L2-Norm=13.906 | L2-Norm(final)=2.656 | 3817.2 samples/s | 59.6 steps/s
[Step=6450 Epoch=31.4] | Loss=0.05896 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.958 | L2-Norm(final)=2.636 | 4230.3 samples/s | 66.1 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04716 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.985 | L2-Norm(final)=2.635 | 4664.7 samples/s | 72.9 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04120 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.005 | L2-Norm(final)=2.638 | 4651.0 samples/s | 72.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03741 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=2.643 | 6238.9 samples/s | 97.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03435 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.040 | L2-Norm(final)=2.648 | 1788.1 samples/s | 27.9 steps/s
[Step=6700 Epoch=32.6] | Loss=0.03112 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=2.653 | 4675.4 samples/s | 73.1 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02887 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=2.658 | 4467.8 samples/s | 69.8 steps/s
[Step=6800 Epoch=33.1] | Loss=0.02690 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=2.663 | 5559.8 samples/s | 86.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02508 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.093 | L2-Norm(final)=2.667 | 1758.6 samples/s | 27.5 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02399 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=2.672 | 4674.6 samples/s | 73.0 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02298 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.112 | L2-Norm(final)=2.676 | 4639.1 samples/s | 72.5 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02182 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.121 | L2-Norm(final)=2.680 | 5400.2 samples/s | 84.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02126 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=2.683 | 1880.7 samples/s | 29.4 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02082 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=2.687 | 4653.4 samples/s | 72.7 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02004 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=2.690 | 4610.0 samples/s | 72.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01924 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.156 | L2-Norm(final)=2.694 | 5052.1 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=43.2] | Loss=0.22599 | Reg=0.00193 | acc=0.8281 | L2-Norm=13.906 | L2-Norm(final)=2.656 | 3646.6 samples/s | 57.0 steps/s
[Step=8850 Epoch=43.4] | Loss=0.05393 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.966 | L2-Norm(final)=2.635 | 4491.5 samples/s | 70.2 steps/s
[Step=8900 Epoch=43.6] | Loss=0.04312 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.993 | L2-Norm(final)=2.627 | 4654.0 samples/s | 72.7 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03759 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.013 | L2-Norm(final)=2.627 | 4656.7 samples/s | 72.8 steps/s
[Step=9000 Epoch=44.1] | Loss=0.03489 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.030 | L2-Norm(final)=2.628 | 6315.1 samples/s | 98.7 steps/s
[Step=9050 Epoch=44.4] | Loss=0.03104 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=2.632 | 1782.7 samples/s | 27.9 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02728 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=2.638 | 4655.3 samples/s | 72.7 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02533 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.077 | L2-Norm(final)=2.645 | 4678.9 samples/s | 73.1 steps/s
[Step=9200 Epoch=45.1] | Loss=0.02486 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.090 | L2-Norm(final)=2.650 | 6012.9 samples/s | 94.0 steps/s
[Step=9250 Epoch=45.4] | Loss=0.02361 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=2.653 | 1793.7 samples/s | 28.0 steps/s
[Step=9300 Epoch=45.6] | Loss=0.02213 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=2.658 | 4691.4 samples/s | 73.3 steps/s
[Step=9350 Epoch=45.9] | Loss=0.02160 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=2.661 | 4727.8 samples/s | 73.9 steps/s
[Step=9400 Epoch=46.1] | Loss=0.02094 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.134 | L2-Norm(final)=2.665 | 5657.4 samples/s | 88.4 steps/s
[Step=9450 Epoch=46.3] | Loss=0.02003 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=2.669 | 1841.9 samples/s | 28.8 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01910 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.673 | 4572.5 samples/s | 71.4 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01833 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=2.676 | 4628.3 samples/s | 72.3 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01777 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.167 | L2-Norm(final)=2.680 | 5482.2 samples/s | 85.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.07022 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=2.655 | 3798.4 samples/s | 59.3 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00888 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=2.637 | 4108.0 samples/s | 64.2 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00465 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=2.641 | 5948.3 samples/s | 92.9 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00311 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=2.647 | 1744.2 samples/s | 27.3 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00235 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=2.651 | 5502.0 samples/s | 86.0 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00188 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=2.654 | 1786.5 samples/s | 27.9 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00157 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=2.656 | 5091.8 samples/s | 79.6 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00135 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=2.658 | 1822.5 samples/s | 28.5 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00118 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=2.660 | 4835.0 samples/s | 75.5 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00105 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=2.661 | 1864.0 samples/s | 29.1 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00095 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=2.663 | 4524.7 samples/s | 70.7 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00086 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=2.664 | 1918.1 samples/s | 30.0 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00079 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=2.665 | 4377.2 samples/s | 68.4 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00073 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=2.666 | 1925.0 samples/s | 30.1 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00068 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=2.667 | 4472.9 samples/s | 69.9 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00063 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=2.668 | 1917.2 samples/s | 30.0 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00060 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=2.669 | 4394.8 samples/s | 68.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.7] | Loss=0.06156 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=2.656 | 3595.0 samples/s | 56.2 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00655 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=2.653 | 4404.0 samples/s | 68.8 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00348 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.660 | 5913.4 samples/s | 92.4 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00233 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.999 | L2-Norm(final)=2.665 | 1718.9 samples/s | 26.9 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00176 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=2.668 | 5614.0 samples/s | 87.7 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00141 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=2.671 | 1768.2 samples/s | 27.6 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00118 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=2.673 | 5315.3 samples/s | 83.1 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00101 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.950 | L2-Norm(final)=2.674 | 1798.8 samples/s | 28.1 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00088 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=2.675 | 4948.3 samples/s | 77.3 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00079 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=2.677 | 1834.5 samples/s | 28.7 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00071 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=2.678 | 4843.8 samples/s | 75.7 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00065 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=2.679 | 1882.6 samples/s | 29.4 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00059 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=2.679 | 4510.8 samples/s | 70.5 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00055 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.680 | 1897.6 samples/s | 29.6 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00051 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.833 | L2-Norm(final)=2.681 | 4479.7 samples/s | 70.0 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00047 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=2.682 | 1917.9 samples/s | 30.0 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00045 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=2.683 | 4488.5 samples/s | 70.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32463 | acc=0.7960 | tpr=0.7084 | fpr=0.0136 | 4168.6 samples/s | 16.3 steps/s
Avg test loss: 0.32292, Avg test acc: 0.79950, Avg tpr: 0.71522, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.25765 | acc=0.8887 | tpr=0.9823 | fpr=0.1130 | 4142.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.25744 | acc=0.8890 | tpr=0.9851 | fpr=0.1128 | 8123.1 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.26268 | acc=0.8895 | tpr=0.9856 | fpr=0.1123 | 8308.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.26517 | acc=0.8889 | tpr=0.9847 | fpr=0.1129 | 7305.3 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.26548 | acc=0.8886 | tpr=0.9834 | fpr=0.1131 | 7445.8 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.26787 | acc=0.8884 | tpr=0.9833 | fpr=0.1133 | 8002.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.26853 | acc=0.8888 | tpr=0.9818 | fpr=0.1129 | 8966.8 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.26895 | acc=0.8885 | tpr=0.9792 | fpr=0.1131 | 7669.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.27121 | acc=0.8882 | tpr=0.9776 | fpr=0.1135 | 8245.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.27114 | acc=0.8881 | tpr=0.9780 | fpr=0.1135 | 7803.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.27012 | acc=0.8884 | tpr=0.9777 | fpr=0.1132 | 14564.7 samples/s | 56.9 steps/s
Avg test loss: 0.26992, Avg test acc: 0.88841, Avg tpr: 0.97781, Avg fpr: 0.11321, total FA: 15719

server round 20/50

clients selected: [0 1 3 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.25845 | Reg=0.00191 | acc=0.8125 | L2-Norm=13.810 | L2-Norm(final)=2.694 | 3870.8 samples/s | 60.5 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05159 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.829 | L2-Norm(final)=2.680 | 4252.9 samples/s | 66.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03785 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.841 | L2-Norm(final)=2.681 | 4646.9 samples/s | 72.6 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03218 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.685 | 4619.7 samples/s | 72.2 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02919 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=2.688 | 6194.3 samples/s | 96.8 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02544 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.864 | L2-Norm(final)=2.692 | 1774.0 samples/s | 27.7 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02328 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=2.696 | 4587.0 samples/s | 71.7 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02096 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.876 | L2-Norm(final)=2.701 | 4622.6 samples/s | 72.2 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01961 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=2.706 | 5642.5 samples/s | 88.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01828 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.887 | L2-Norm(final)=2.711 | 1818.2 samples/s | 28.4 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01726 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.892 | L2-Norm(final)=2.715 | 4606.3 samples/s | 72.0 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01628 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=2.720 | 4637.3 samples/s | 72.5 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01545 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=2.724 | 5402.7 samples/s | 84.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01459 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.729 | 1856.7 samples/s | 29.0 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01399 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=2.733 | 4620.0 samples/s | 72.2 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01350 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.912 | L2-Norm(final)=2.738 | 4624.2 samples/s | 72.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01305 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=2.742 | 5049.0 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.2] | Loss=0.14152 | Reg=0.00191 | acc=0.9219 | L2-Norm=13.810 | L2-Norm(final)=2.694 | 3621.0 samples/s | 56.6 steps/s
[Step=6450 Epoch=31.5] | Loss=0.04631 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=2.686 | 4257.9 samples/s | 66.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.03549 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.840 | L2-Norm(final)=2.686 | 4615.8 samples/s | 72.1 steps/s
[Step=6550 Epoch=32.0] | Loss=0.03089 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.847 | L2-Norm(final)=2.687 | 4655.5 samples/s | 72.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.02860 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.854 | L2-Norm(final)=2.690 | 6093.5 samples/s | 95.2 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02465 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=2.693 | 1773.3 samples/s | 27.7 steps/s
[Step=6700 Epoch=32.7] | Loss=0.02219 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.866 | L2-Norm(final)=2.697 | 4531.8 samples/s | 70.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02041 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.872 | L2-Norm(final)=2.701 | 4510.2 samples/s | 70.5 steps/s
[Step=6800 Epoch=33.2] | Loss=0.01896 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=2.706 | 5714.0 samples/s | 89.3 steps/s
[Step=6850 Epoch=33.4] | Loss=0.01789 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=2.710 | 1675.5 samples/s | 26.2 steps/s
[Step=6900 Epoch=33.7] | Loss=0.01674 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=2.713 | 4242.3 samples/s | 66.3 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01587 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.890 | L2-Norm(final)=2.717 | 4463.6 samples/s | 69.7 steps/s
[Step=7000 Epoch=34.2] | Loss=0.01521 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=2.720 | 5402.7 samples/s | 84.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01446 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=2.724 | 1811.3 samples/s | 28.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01387 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=2.727 | 4606.4 samples/s | 72.0 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01322 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.730 | 4512.9 samples/s | 70.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01290 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=2.733 | 5170.3 samples/s | 80.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.20162 | Reg=0.00191 | acc=0.8906 | L2-Norm=13.810 | L2-Norm(final)=2.694 | 3608.0 samples/s | 56.4 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05026 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=2.681 | 4484.5 samples/s | 70.1 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03866 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.682 | 4572.8 samples/s | 71.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03301 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=2.686 | 4526.7 samples/s | 70.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02849 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=2.690 | 5711.4 samples/s | 89.2 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02463 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.876 | L2-Norm(final)=2.696 | 1725.3 samples/s | 27.0 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02163 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=2.702 | 4579.3 samples/s | 71.6 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=2.707 | 4452.1 samples/s | 69.6 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01881 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=2.712 | 5675.6 samples/s | 88.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01742 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=2.717 | 1805.7 samples/s | 28.2 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01631 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.722 | 4501.9 samples/s | 70.3 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01565 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=2.726 | 4555.3 samples/s | 71.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01496 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=2.730 | 5331.8 samples/s | 83.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01424 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=2.734 | 1782.3 samples/s | 27.8 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01364 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.920 | L2-Norm(final)=2.738 | 4598.9 samples/s | 71.9 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01306 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=2.742 | 4585.6 samples/s | 71.7 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01278 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.927 | L2-Norm(final)=2.746 | 5031.1 samples/s | 78.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=47.1] | Loss=0.29740 | Reg=0.00191 | acc=0.8438 | L2-Norm=13.810 | L2-Norm(final)=2.694 | 3503.9 samples/s | 54.7 steps/s
[Step=9650 Epoch=47.3] | Loss=0.05045 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.829 | L2-Norm(final)=2.678 | 4730.3 samples/s | 73.9 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03899 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.842 | L2-Norm(final)=2.680 | 4585.9 samples/s | 71.7 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03474 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.849 | L2-Norm(final)=2.681 | 4573.4 samples/s | 71.5 steps/s
[Step=9800 Epoch=48.1] | Loss=0.03024 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=2.683 | 6136.4 samples/s | 95.9 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02606 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=2.687 | 1729.7 samples/s | 27.0 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02317 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.868 | L2-Norm(final)=2.692 | 4293.6 samples/s | 67.1 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02084 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=2.697 | 4410.9 samples/s | 68.9 steps/s
[Step=10000 Epoch=49.0] | Loss=0.01931 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.881 | L2-Norm(final)=2.703 | 5791.9 samples/s | 90.5 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01807 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=2.708 | 1745.5 samples/s | 27.3 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01695 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.892 | L2-Norm(final)=2.713 | 4482.4 samples/s | 70.0 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01627 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.896 | L2-Norm(final)=2.718 | 4505.3 samples/s | 70.4 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01532 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=2.722 | 5556.1 samples/s | 86.8 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01444 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=2.727 | 1786.5 samples/s | 27.9 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01372 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=2.731 | 4527.3 samples/s | 70.7 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01317 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=2.736 | 4435.1 samples/s | 69.3 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01275 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=2.740 | 5231.9 samples/s | 81.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=99.3] | Loss=0.01146 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.810 | L2-Norm(final)=2.695 | 3504.2 samples/s | 54.8 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00437 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.846 | L2-Norm(final)=2.700 | 4118.7 samples/s | 64.4 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00235 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=2.706 | 5898.1 samples/s | 92.2 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00162 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=2.711 | 1698.2 samples/s | 26.5 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00122 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=2.714 | 5511.5 samples/s | 86.1 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00098 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.716 | 1726.9 samples/s | 27.0 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00082 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=2.718 | 5172.4 samples/s | 80.8 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00071 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=2.719 | 1725.0 samples/s | 27.0 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00062 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.720 | 4758.1 samples/s | 74.3 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00055 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.819 | L2-Norm(final)=2.721 | 1795.6 samples/s | 28.1 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00050 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=2.722 | 4709.3 samples/s | 73.6 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00046 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=2.723 | 1837.1 samples/s | 28.7 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00042 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=2.724 | 4410.4 samples/s | 68.9 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00039 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=2.725 | 1862.2 samples/s | 29.1 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00036 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=2.726 | 4297.3 samples/s | 67.1 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00034 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=2.726 | 1832.8 samples/s | 28.6 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00032 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.727 | 4375.0 samples/s | 68.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37478 | acc=0.7828 | tpr=0.6898 | fpr=0.0151 | 4080.2 samples/s | 15.9 steps/s
Avg test loss: 0.37292, Avg test acc: 0.78612, Avg tpr: 0.69622, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.25725 | acc=0.9004 | tpr=0.9823 | fpr=0.1011 | 3958.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.25809 | acc=0.9007 | tpr=0.9829 | fpr=0.1008 | 7864.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.26423 | acc=0.9004 | tpr=0.9827 | fpr=0.1012 | 8002.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.26708 | acc=0.8998 | tpr=0.9825 | fpr=0.1017 | 8135.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.26732 | acc=0.8993 | tpr=0.9817 | fpr=0.1022 | 7986.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.27000 | acc=0.8991 | tpr=0.9818 | fpr=0.1024 | 7585.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.27084 | acc=0.8993 | tpr=0.9812 | fpr=0.1022 | 7927.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.27141 | acc=0.8988 | tpr=0.9781 | fpr=0.1026 | 7513.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.27406 | acc=0.8983 | tpr=0.9766 | fpr=0.1031 | 7640.2 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.27410 | acc=0.8981 | tpr=0.9771 | fpr=0.1034 | 7545.6 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.27303 | acc=0.8984 | tpr=0.9769 | fpr=0.1030 | 14205.1 samples/s | 55.5 steps/s
Avg test loss: 0.27278, Avg test acc: 0.89842, Avg tpr: 0.97702, Avg fpr: 0.10300, total FA: 14302

server round 21/50

clients selected: [0 5 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.41638 | Reg=0.00189 | acc=0.7344 | L2-Norm=13.736 | L2-Norm(final)=2.728 | 3602.9 samples/s | 56.3 steps/s
[Step=10450 Epoch=51.0] | Loss=0.05960 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.764 | L2-Norm(final)=2.703 | 4040.6 samples/s | 63.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.04574 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=2.700 | 4454.7 samples/s | 69.6 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03824 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.701 | 4458.0 samples/s | 69.7 steps/s
[Step=10600 Epoch=51.7] | Loss=0.03286 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.794 | L2-Norm(final)=2.704 | 6040.9 samples/s | 94.4 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02909 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=2.708 | 1733.9 samples/s | 27.1 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02600 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.808 | L2-Norm(final)=2.712 | 4464.4 samples/s | 69.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02341 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.815 | L2-Norm(final)=2.717 | 4479.6 samples/s | 70.0 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02176 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=2.722 | 5674.1 samples/s | 88.7 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02018 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=2.726 | 1783.6 samples/s | 27.9 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01895 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=2.731 | 4281.0 samples/s | 66.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01788 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.835 | L2-Norm(final)=2.735 | 4252.3 samples/s | 66.4 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01697 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.739 | 5171.3 samples/s | 80.8 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01614 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=2.743 | 1807.8 samples/s | 28.2 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01539 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.847 | L2-Norm(final)=2.747 | 4372.0 samples/s | 68.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01489 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=2.751 | 4485.0 samples/s | 70.1 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01445 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=2.754 | 4905.2 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.4] | Loss=0.04972 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.736 | L2-Norm(final)=2.729 | 3547.9 samples/s | 55.4 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00791 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=2.718 | 3972.5 samples/s | 62.1 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00416 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=2.724 | 5803.0 samples/s | 90.7 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00280 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=2.729 | 1629.3 samples/s | 25.5 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00212 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=2.733 | 5249.1 samples/s | 82.0 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00171 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=2.736 | 1737.1 samples/s | 27.1 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00143 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.739 | 4887.6 samples/s | 76.4 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00123 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.741 | 1778.9 samples/s | 27.8 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00108 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=2.744 | 4656.8 samples/s | 72.8 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00096 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.746 | 1822.2 samples/s | 28.5 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00087 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=2.748 | 4209.3 samples/s | 65.8 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00079 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.750 | 1843.6 samples/s | 28.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00073 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=2.752 | 4332.2 samples/s | 67.7 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00067 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=2.754 | 1845.4 samples/s | 28.8 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00063 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.755 | 4348.3 samples/s | 67.9 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00059 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.757 | 1891.1 samples/s | 29.5 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00055 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.759 | 4259.9 samples/s | 66.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=107.0] | Loss=0.01048 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.730 | 3558.4 samples/s | 55.6 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00181 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=2.743 | 4076.9 samples/s | 63.7 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00103 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=2.750 | 5508.7 samples/s | 86.1 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00072 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=2.755 | 1670.4 samples/s | 26.1 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00054 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=2.758 | 5464.7 samples/s | 85.4 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00044 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.760 | 1671.8 samples/s | 26.1 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00036 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.761 | 5110.8 samples/s | 79.9 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00031 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=2.763 | 1697.3 samples/s | 26.5 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00028 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=2.764 | 4865.8 samples/s | 76.0 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00025 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.765 | 1764.0 samples/s | 27.6 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00022 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=2.765 | 4513.2 samples/s | 70.5 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00020 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=2.766 | 1806.9 samples/s | 28.2 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00019 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.767 | 4356.6 samples/s | 68.1 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00017 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.767 | 1845.1 samples/s | 28.8 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00016 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.768 | 4262.8 samples/s | 66.6 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00015 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=2.769 | 1878.0 samples/s | 29.3 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00014 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=2.769 | 4137.2 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=75.4] | Loss=0.00490 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.729 | 3565.7 samples/s | 55.7 steps/s
[Step=8050 Epoch=75.9] | Loss=0.00369 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=2.734 | 3838.5 samples/s | 60.0 steps/s
[Step=8100 Epoch=76.3] | Loss=0.00220 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=2.741 | 5675.7 samples/s | 88.7 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00153 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=2.745 | 1688.6 samples/s | 26.4 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00116 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=2.749 | 5216.3 samples/s | 81.5 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00094 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=2.751 | 1722.7 samples/s | 26.9 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00078 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=2.754 | 4782.8 samples/s | 74.7 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00067 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=2.755 | 1788.6 samples/s | 27.9 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00059 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=2.757 | 4277.8 samples/s | 66.8 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00053 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.756 | L2-Norm(final)=2.758 | 1798.9 samples/s | 28.1 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00048 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=2.759 | 4250.7 samples/s | 66.4 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00044 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=2.761 | 1870.2 samples/s | 29.2 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00040 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.762 | 4248.9 samples/s | 66.4 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00037 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.763 | 1883.8 samples/s | 29.4 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00035 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.764 | 4259.6 samples/s | 66.6 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00032 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.764 | 1941.3 samples/s | 30.3 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00030 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=2.765 | 3714.8 samples/s | 58.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=61.0] | Loss=0.00730 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.729 | 3643.3 samples/s | 56.9 steps/s
[Step=6450 Epoch=61.5] | Loss=0.00439 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=2.732 | 3956.5 samples/s | 61.8 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00230 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=2.737 | 5909.7 samples/s | 92.3 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00155 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=2.741 | 1684.8 samples/s | 26.3 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00118 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=2.743 | 5437.1 samples/s | 85.0 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00095 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.745 | 1692.3 samples/s | 26.4 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00079 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=2.746 | 5098.3 samples/s | 79.7 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00068 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=2.748 | 1737.3 samples/s | 27.1 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00060 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=2.749 | 4870.6 samples/s | 76.1 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00054 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.750 | 1756.6 samples/s | 27.4 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00049 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=2.751 | 4550.5 samples/s | 71.1 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00044 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.752 | 1788.4 samples/s | 27.9 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00041 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.753 | 4317.5 samples/s | 67.5 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00038 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=2.754 | 1827.7 samples/s | 28.6 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00035 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=2.755 | 4156.5 samples/s | 64.9 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00033 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=2.755 | 1838.2 samples/s | 28.7 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00031 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=2.756 | 4297.2 samples/s | 67.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28540 | acc=0.8314 | tpr=0.7598 | fpr=0.0131 | 3890.5 samples/s | 15.2 steps/s
Avg test loss: 0.28464, Avg test acc: 0.83496, Avg tpr: 0.76651, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.31618 | acc=0.8730 | tpr=0.9823 | fpr=0.1290 | 3838.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.31668 | acc=0.8727 | tpr=0.9851 | fpr=0.1294 | 7860.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.32141 | acc=0.8732 | tpr=0.9856 | fpr=0.1289 | 7536.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.32403 | acc=0.8725 | tpr=0.9836 | fpr=0.1295 | 7507.4 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.32451 | acc=0.8718 | tpr=0.9825 | fpr=0.1303 | 7901.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.32728 | acc=0.8715 | tpr=0.9825 | fpr=0.1305 | 7463.6 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.32802 | acc=0.8717 | tpr=0.9818 | fpr=0.1303 | 7810.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.32859 | acc=0.8714 | tpr=0.9798 | fpr=0.1306 | 7473.3 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.33138 | acc=0.8709 | tpr=0.9786 | fpr=0.1310 | 7754.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.33153 | acc=0.8706 | tpr=0.9789 | fpr=0.1313 | 7492.4 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.33039 | acc=0.8710 | tpr=0.9781 | fpr=0.1310 | 13979.1 samples/s | 54.6 steps/s
Avg test loss: 0.33016, Avg test acc: 0.87101, Avg tpr: 0.97821, Avg fpr: 0.13094, total FA: 18181

server round 22/50

clients selected: [0 1 3 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.17143 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.724 | L2-Norm(final)=2.764 | 3572.6 samples/s | 55.8 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04509 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=2.746 | 3961.7 samples/s | 61.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03326 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.757 | L2-Norm(final)=2.745 | 4271.3 samples/s | 66.7 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03089 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=2.744 | 4390.0 samples/s | 68.6 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02765 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=2.745 | 6067.6 samples/s | 94.8 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02496 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.774 | L2-Norm(final)=2.747 | 1713.0 samples/s | 26.8 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02254 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=2.751 | 4461.2 samples/s | 69.7 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02055 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.756 | 4446.7 samples/s | 69.5 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01957 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=2.760 | 5571.2 samples/s | 87.0 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01822 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=2.764 | 1679.9 samples/s | 26.2 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01703 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.802 | L2-Norm(final)=2.768 | 4385.9 samples/s | 68.5 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01633 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=2.772 | 4366.9 samples/s | 68.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01550 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=2.775 | 5177.0 samples/s | 80.9 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01480 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=2.779 | 1811.0 samples/s | 28.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01417 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.819 | L2-Norm(final)=2.783 | 4405.1 samples/s | 68.8 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01355 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.822 | L2-Norm(final)=2.786 | 4452.1 samples/s | 69.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01315 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=2.790 | 4860.8 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.16372 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.724 | L2-Norm(final)=2.764 | 3671.1 samples/s | 57.4 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04324 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.743 | L2-Norm(final)=2.744 | 4011.2 samples/s | 62.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03556 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.752 | L2-Norm(final)=2.741 | 4266.2 samples/s | 66.7 steps/s
[Step=7350 Epoch=35.9] | Loss=0.03090 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.740 | 4471.9 samples/s | 69.9 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02797 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.764 | L2-Norm(final)=2.741 | 6002.3 samples/s | 93.8 steps/s
[Step=7450 Epoch=36.4] | Loss=0.02411 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.770 | L2-Norm(final)=2.745 | 1740.0 samples/s | 27.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02142 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.777 | L2-Norm(final)=2.749 | 4376.6 samples/s | 68.4 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01961 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=2.754 | 4256.2 samples/s | 66.5 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01818 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.788 | L2-Norm(final)=2.758 | 5461.8 samples/s | 85.3 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01684 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=2.762 | 1688.2 samples/s | 26.4 steps/s
[Step=7700 Epoch=37.6] | Loss=0.01575 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.797 | L2-Norm(final)=2.766 | 4484.5 samples/s | 70.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01487 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=2.770 | 4250.5 samples/s | 66.4 steps/s
[Step=7800 Epoch=38.1] | Loss=0.01429 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.805 | L2-Norm(final)=2.774 | 5330.7 samples/s | 83.3 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01368 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=2.778 | 1753.7 samples/s | 27.4 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01323 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.812 | L2-Norm(final)=2.781 | 4474.8 samples/s | 69.9 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01268 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=2.784 | 4485.3 samples/s | 70.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01225 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.818 | L2-Norm(final)=2.787 | 5029.8 samples/s | 78.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.15197 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.724 | L2-Norm(final)=2.764 | 3606.0 samples/s | 56.3 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04017 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.761 | L2-Norm(final)=2.755 | 4318.2 samples/s | 67.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03217 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=2.753 | 4344.8 samples/s | 67.9 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02785 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=2.754 | 4491.1 samples/s | 70.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02568 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=2.757 | 5821.2 samples/s | 91.0 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02238 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.794 | L2-Norm(final)=2.760 | 1668.1 samples/s | 26.1 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01995 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=2.765 | 4536.7 samples/s | 70.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01830 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.806 | L2-Norm(final)=2.770 | 4449.0 samples/s | 69.5 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01728 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=2.774 | 5581.4 samples/s | 87.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01620 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=2.779 | 1777.8 samples/s | 27.8 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01547 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.822 | L2-Norm(final)=2.783 | 4373.2 samples/s | 68.3 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01487 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.826 | L2-Norm(final)=2.787 | 4470.6 samples/s | 69.9 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01398 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=2.791 | 5012.2 samples/s | 78.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01319 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.834 | L2-Norm(final)=2.795 | 1766.6 samples/s | 27.6 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01257 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.838 | L2-Norm(final)=2.799 | 4389.8 samples/s | 68.6 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01211 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.841 | L2-Norm(final)=2.803 | 4472.4 samples/s | 69.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01181 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.844 | L2-Norm(final)=2.806 | 4807.2 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=51.0] | Loss=0.20384 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.724 | L2-Norm(final)=2.764 | 3813.8 samples/s | 59.6 steps/s
[Step=10450 Epoch=51.2] | Loss=0.04054 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=2.750 | 4081.7 samples/s | 63.8 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03034 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.749 | 4545.7 samples/s | 71.0 steps/s
[Step=10550 Epoch=51.7] | Loss=0.02722 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.768 | L2-Norm(final)=2.752 | 4481.0 samples/s | 70.0 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02485 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.775 | L2-Norm(final)=2.755 | 6106.1 samples/s | 95.4 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02221 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=2.759 | 1722.2 samples/s | 26.9 steps/s
[Step=10700 Epoch=52.5] | Loss=0.01979 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=2.763 | 4378.8 samples/s | 68.4 steps/s
[Step=10750 Epoch=52.7] | Loss=0.01826 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=2.768 | 4421.9 samples/s | 69.1 steps/s
[Step=10800 Epoch=53.0] | Loss=0.01710 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=2.773 | 5464.2 samples/s | 85.4 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01588 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=2.778 | 1735.5 samples/s | 27.1 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01506 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.814 | L2-Norm(final)=2.782 | 4499.9 samples/s | 70.3 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01415 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.819 | L2-Norm(final)=2.786 | 4435.7 samples/s | 69.3 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01349 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.823 | L2-Norm(final)=2.790 | 5599.1 samples/s | 87.5 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01280 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.794 | 1775.9 samples/s | 27.7 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01222 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=2.798 | 4498.0 samples/s | 70.3 steps/s
[Step=11150 Epoch=54.7] | Loss=0.01192 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.834 | L2-Norm(final)=2.802 | 4436.8 samples/s | 69.3 steps/s
[Step=11200 Epoch=54.9] | Loss=0.01145 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=2.805 | 5167.4 samples/s | 80.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=114.6] | Loss=0.04365 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.724 | L2-Norm(final)=2.764 | 3873.8 samples/s | 60.5 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00358 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=2.767 | 3882.7 samples/s | 60.7 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00191 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=2.770 | 5869.6 samples/s | 91.7 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00128 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=2.773 | 1657.7 samples/s | 25.9 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00097 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.775 | 5464.6 samples/s | 85.4 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00078 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=2.777 | 1689.3 samples/s | 26.4 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00065 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.778 | 5149.2 samples/s | 80.5 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00056 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.779 | 1725.6 samples/s | 27.0 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00049 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.780 | 4726.3 samples/s | 73.8 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00044 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.781 | 1721.8 samples/s | 26.9 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00039 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.782 | 4572.3 samples/s | 71.4 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00036 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.783 | 1824.8 samples/s | 28.5 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00033 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=2.783 | 4351.0 samples/s | 68.0 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00031 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.702 | L2-Norm(final)=2.784 | 1830.3 samples/s | 28.6 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00028 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=2.785 | 4347.8 samples/s | 67.9 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00027 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.785 | 1837.6 samples/s | 28.7 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00025 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.786 | 4193.4 samples/s | 65.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32902 | acc=0.8118 | tpr=0.7299 | fpr=0.0104 | 3984.1 samples/s | 15.6 steps/s
Avg test loss: 0.32862, Avg test acc: 0.81461, Avg tpr: 0.73585, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.29217 | acc=0.8840 | tpr=0.9823 | fpr=0.1178 | 3863.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.29225 | acc=0.8847 | tpr=0.9829 | fpr=0.1171 | 7484.7 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.29738 | acc=0.8846 | tpr=0.9841 | fpr=0.1173 | 7551.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.29993 | acc=0.8843 | tpr=0.9825 | fpr=0.1175 | 7528.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.30025 | acc=0.8836 | tpr=0.9817 | fpr=0.1182 | 7332.8 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.30298 | acc=0.8838 | tpr=0.9818 | fpr=0.1180 | 7634.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.30378 | acc=0.8842 | tpr=0.9812 | fpr=0.1175 | 7280.1 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.30420 | acc=0.8839 | tpr=0.9781 | fpr=0.1179 | 7825.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.30696 | acc=0.8834 | tpr=0.9771 | fpr=0.1183 | 7327.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.30711 | acc=0.8832 | tpr=0.9775 | fpr=0.1185 | 7555.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.30591 | acc=0.8836 | tpr=0.9769 | fpr=0.1181 | 13521.9 samples/s | 52.8 steps/s
Avg test loss: 0.30566, Avg test acc: 0.88360, Avg tpr: 0.97702, Avg fpr: 0.11810, total FA: 16398

server round 23/50

clients selected: [3 4 5 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.14966 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.700 | L2-Norm(final)=2.786 | 3744.6 samples/s | 58.5 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04858 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=2.766 | 4055.7 samples/s | 63.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03757 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.742 | L2-Norm(final)=2.765 | 4375.1 samples/s | 68.4 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03237 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=2.766 | 4413.1 samples/s | 69.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02837 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.759 | L2-Norm(final)=2.769 | 5948.5 samples/s | 92.9 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02448 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.766 | L2-Norm(final)=2.774 | 1709.7 samples/s | 26.7 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02190 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=2.779 | 4463.5 samples/s | 69.7 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02013 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=2.784 | 4470.0 samples/s | 69.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01868 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.790 | 5632.9 samples/s | 88.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01821 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=2.794 | 1764.8 samples/s | 27.6 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01714 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.799 | L2-Norm(final)=2.798 | 4345.0 samples/s | 67.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01659 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.805 | L2-Norm(final)=2.802 | 4429.2 samples/s | 69.2 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01589 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=2.806 | 4987.4 samples/s | 77.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01534 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=2.809 | 1779.8 samples/s | 27.8 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01459 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.819 | L2-Norm(final)=2.813 | 4490.8 samples/s | 70.2 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01402 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.823 | L2-Norm(final)=2.816 | 4398.5 samples/s | 68.7 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01342 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.820 | 4818.3 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.9] | Loss=0.15176 | Reg=0.00188 | acc=0.9219 | L2-Norm=13.700 | L2-Norm(final)=2.787 | 3594.7 samples/s | 56.2 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03859 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.720 | L2-Norm(final)=2.777 | 4301.6 samples/s | 67.2 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02967 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.732 | L2-Norm(final)=2.776 | 4450.8 samples/s | 69.5 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02615 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.779 | 4485.1 samples/s | 70.1 steps/s
[Step=11400 Epoch=55.9] | Loss=0.02478 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.751 | L2-Norm(final)=2.781 | 5956.1 samples/s | 93.1 steps/s
[Step=11450 Epoch=56.1] | Loss=0.02232 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.783 | 1682.8 samples/s | 26.3 steps/s
[Step=11500 Epoch=56.4] | Loss=0.02021 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=2.787 | 4396.5 samples/s | 68.7 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01871 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.791 | 4514.2 samples/s | 70.5 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01741 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.794 | 5744.9 samples/s | 89.8 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01631 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=2.798 | 1737.1 samples/s | 27.1 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01534 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.802 | 4472.8 samples/s | 69.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01459 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=2.806 | 4525.9 samples/s | 70.7 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01395 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.794 | L2-Norm(final)=2.810 | 5494.4 samples/s | 85.8 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01330 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=2.814 | 1728.3 samples/s | 27.0 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01269 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.802 | L2-Norm(final)=2.817 | 4263.9 samples/s | 66.6 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01215 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.806 | L2-Norm(final)=2.821 | 4418.0 samples/s | 69.0 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01172 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.809 | L2-Norm(final)=2.825 | 5305.5 samples/s | 82.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.0] | Loss=0.09487 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.700 | L2-Norm(final)=2.786 | 3467.5 samples/s | 54.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00446 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.785 | 4067.7 samples/s | 63.6 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00247 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.791 | 5697.1 samples/s | 89.0 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00166 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=2.795 | 1644.8 samples/s | 25.7 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00125 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.797 | 5354.3 samples/s | 83.7 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00100 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.799 | 1689.0 samples/s | 26.4 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00084 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=2.800 | 4776.8 samples/s | 74.6 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00072 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=2.802 | 1745.0 samples/s | 27.3 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00063 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.803 | 4622.7 samples/s | 72.2 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00056 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=2.804 | 1807.8 samples/s | 28.2 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00051 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=2.804 | 4430.8 samples/s | 69.2 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00046 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.805 | 1830.5 samples/s | 28.6 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00043 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=2.806 | 4319.5 samples/s | 67.5 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00039 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=2.807 | 1802.8 samples/s | 28.2 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00037 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=2.807 | 4362.4 samples/s | 68.2 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00034 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=2.808 | 1880.9 samples/s | 29.4 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00032 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=2.808 | 4141.8 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=82.9] | Loss=0.03843 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.700 | L2-Norm(final)=2.787 | 3759.1 samples/s | 58.7 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00410 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.791 | 3887.5 samples/s | 60.7 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00280 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=2.795 | 5758.3 samples/s | 90.0 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00205 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=2.800 | 1663.3 samples/s | 26.0 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00155 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=2.803 | 5204.8 samples/s | 81.3 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00124 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=2.805 | 1715.6 samples/s | 26.8 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00104 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.807 | 4784.8 samples/s | 74.8 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00089 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.756 | L2-Norm(final)=2.808 | 1774.2 samples/s | 27.7 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00078 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=2.809 | 4455.4 samples/s | 69.6 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00070 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.810 | 1802.9 samples/s | 28.2 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00063 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.811 | 4279.6 samples/s | 66.9 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00057 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=2.812 | 1826.0 samples/s | 28.5 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00053 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=2.813 | 4187.7 samples/s | 65.4 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00049 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.814 | 1859.7 samples/s | 29.1 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00045 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.814 | 4177.0 samples/s | 65.3 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00042 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.695 | L2-Norm(final)=2.815 | 2054.1 samples/s | 32.1 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00040 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.816 | 3485.4 samples/s | 54.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=68.6] | Loss=0.03569 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=2.787 | 3500.3 samples/s | 54.7 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00405 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.790 | 4107.9 samples/s | 64.2 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00217 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=2.793 | 5486.8 samples/s | 85.7 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00147 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=2.796 | 1632.8 samples/s | 25.5 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00111 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.798 | 5478.4 samples/s | 85.6 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00089 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=2.800 | 1704.1 samples/s | 26.6 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00074 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.801 | 4969.7 samples/s | 77.7 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00064 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=2.802 | 1751.0 samples/s | 27.4 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00056 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.803 | 4841.5 samples/s | 75.6 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00050 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.695 | L2-Norm(final)=2.804 | 1760.7 samples/s | 27.5 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00045 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=2.805 | 4470.9 samples/s | 69.9 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00041 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=2.806 | 1805.1 samples/s | 28.2 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00038 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.806 | 4365.5 samples/s | 68.2 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00035 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=2.807 | 1849.1 samples/s | 28.9 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00033 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=2.808 | 4330.3 samples/s | 67.7 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00030 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.808 | 1844.7 samples/s | 28.8 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00029 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=2.809 | 4172.6 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33780 | acc=0.8087 | tpr=0.7264 | fpr=0.0124 | 3851.7 samples/s | 15.0 steps/s
Avg test loss: 0.33718, Avg test acc: 0.81172, Avg tpr: 0.73218, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.28862 | acc=0.8867 | tpr=0.9823 | fpr=0.1150 | 3958.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.28827 | acc=0.8888 | tpr=0.9829 | fpr=0.1130 | 7487.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.29339 | acc=0.8890 | tpr=0.9841 | fpr=0.1127 | 7507.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.29561 | acc=0.8883 | tpr=0.9825 | fpr=0.1134 | 7505.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.29603 | acc=0.8878 | tpr=0.9799 | fpr=0.1138 | 8009.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.29868 | acc=0.8880 | tpr=0.9804 | fpr=0.1137 | 7651.1 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.29949 | acc=0.8884 | tpr=0.9793 | fpr=0.1133 | 7468.1 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.29983 | acc=0.8880 | tpr=0.9770 | fpr=0.1136 | 7414.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.30252 | acc=0.8876 | tpr=0.9766 | fpr=0.1140 | 7752.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.30265 | acc=0.8873 | tpr=0.9771 | fpr=0.1143 | 7617.8 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.30151 | acc=0.8876 | tpr=0.9765 | fpr=0.1140 | 14147.3 samples/s | 55.3 steps/s
Avg test loss: 0.30122, Avg test acc: 0.88762, Avg tpr: 0.97662, Avg fpr: 0.11400, total FA: 15828

server round 24/50

clients selected: [1 3 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.34232 | Reg=0.00187 | acc=0.8594 | L2-Norm=13.677 | L2-Norm(final)=2.803 | 3702.3 samples/s | 57.8 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04431 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.786 | 4184.7 samples/s | 65.4 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03759 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.720 | L2-Norm(final)=2.783 | 4447.9 samples/s | 69.5 steps/s
[Step=8150 Epoch=39.8] | Loss=0.03213 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.727 | L2-Norm(final)=2.782 | 4337.2 samples/s | 67.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02856 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.783 | 5981.4 samples/s | 93.5 steps/s
[Step=8250 Epoch=40.3] | Loss=0.02420 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.786 | 1698.6 samples/s | 26.5 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02188 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.747 | L2-Norm(final)=2.790 | 4499.8 samples/s | 70.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01991 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.753 | L2-Norm(final)=2.794 | 4470.9 samples/s | 69.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01837 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.798 | 5655.2 samples/s | 88.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01687 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=2.803 | 1739.2 samples/s | 27.2 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01581 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.768 | L2-Norm(final)=2.807 | 4443.7 samples/s | 69.4 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01521 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=2.811 | 4521.8 samples/s | 70.7 steps/s
[Step=8600 Epoch=42.0] | Loss=0.01468 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=2.814 | 5285.3 samples/s | 82.6 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01405 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=2.817 | 1799.6 samples/s | 28.1 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01337 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.782 | L2-Norm(final)=2.820 | 4312.3 samples/s | 67.4 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01284 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.785 | L2-Norm(final)=2.823 | 4446.6 samples/s | 69.5 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01242 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.787 | L2-Norm(final)=2.826 | 5048.8 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.34144 | Reg=0.00187 | acc=0.7812 | L2-Norm=13.677 | L2-Norm(final)=2.803 | 4198.4 samples/s | 65.6 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04926 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.701 | L2-Norm(final)=2.784 | 3917.0 samples/s | 61.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03853 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.711 | L2-Norm(final)=2.780 | 4511.3 samples/s | 70.5 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03294 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.779 | 4518.0 samples/s | 70.6 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02868 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.781 | 5990.8 samples/s | 93.6 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02459 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.733 | L2-Norm(final)=2.784 | 1661.2 samples/s | 26.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02198 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=2.788 | 4434.5 samples/s | 69.3 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01998 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.746 | L2-Norm(final)=2.793 | 4408.2 samples/s | 68.9 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01826 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.752 | L2-Norm(final)=2.797 | 5220.6 samples/s | 81.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01705 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.757 | L2-Norm(final)=2.802 | 1739.4 samples/s | 27.2 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01595 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.807 | 4457.6 samples/s | 69.7 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01517 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=2.812 | 4464.1 samples/s | 69.8 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01451 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.816 | 5063.5 samples/s | 79.1 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01387 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=2.820 | 1807.0 samples/s | 28.2 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01339 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=2.823 | 4334.7 samples/s | 67.7 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01285 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=2.827 | 4451.0 samples/s | 69.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01237 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.784 | L2-Norm(final)=2.830 | 4785.2 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.6] | Loss=0.04571 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.677 | L2-Norm(final)=2.804 | 3559.4 samples/s | 55.6 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00903 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=2.788 | 4060.2 samples/s | 63.4 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00466 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=2.788 | 5696.3 samples/s | 89.0 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00312 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=2.790 | 1655.3 samples/s | 25.9 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00236 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.792 | 5272.0 samples/s | 82.4 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00189 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.793 | 1711.7 samples/s | 26.7 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00158 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.795 | 4751.3 samples/s | 74.2 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00136 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=2.796 | 1760.7 samples/s | 27.5 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00119 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.797 | 4513.2 samples/s | 70.5 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00106 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.799 | 1779.3 samples/s | 27.8 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00096 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.800 | 4395.3 samples/s | 68.7 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00087 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=2.801 | 1849.2 samples/s | 28.9 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00080 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.802 | 4306.1 samples/s | 67.3 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00074 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.804 | 1823.8 samples/s | 28.5 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00069 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=2.805 | 4350.2 samples/s | 68.0 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00064 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=2.806 | 1834.9 samples/s | 28.7 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00060 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=2.808 | 4297.7 samples/s | 67.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step11200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=53.3] | Loss=0.09600 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.677 | L2-Norm(final)=2.803 | 3780.5 samples/s | 59.1 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00495 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=2.801 | 3918.5 samples/s | 61.2 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00278 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.804 | 5745.8 samples/s | 89.8 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00189 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=2.806 | 1657.1 samples/s | 25.9 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00143 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.807 | 5288.7 samples/s | 82.6 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00115 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.808 | 1717.0 samples/s | 26.8 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00096 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.809 | 4837.8 samples/s | 75.6 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00083 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.810 | 1725.9 samples/s | 27.0 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00072 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=2.811 | 4644.9 samples/s | 72.6 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00065 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.812 | 1797.5 samples/s | 28.1 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00058 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.812 | 4430.4 samples/s | 69.2 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00053 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=2.813 | 1792.9 samples/s | 28.0 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00049 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=2.813 | 4307.0 samples/s | 67.3 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00045 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.814 | 1821.8 samples/s | 28.5 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00042 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.814 | 4235.7 samples/s | 66.2 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00039 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.815 | 1861.4 samples/s | 29.1 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00037 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=2.815 | 4333.4 samples/s | 67.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=122.2] | Loss=0.11317 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.677 | L2-Norm(final)=2.803 | 3717.2 samples/s | 58.1 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00722 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.796 | 3922.0 samples/s | 61.3 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00387 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.799 | 5875.4 samples/s | 91.8 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00259 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=2.802 | 1664.0 samples/s | 26.0 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00195 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.804 | 5159.7 samples/s | 80.6 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00156 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=2.805 | 1714.8 samples/s | 26.8 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00130 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=2.806 | 5143.1 samples/s | 80.4 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00112 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.807 | 1749.6 samples/s | 27.3 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00098 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.808 | 4796.5 samples/s | 74.9 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00087 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.808 | 1734.5 samples/s | 27.1 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00079 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.809 | 4384.6 samples/s | 68.5 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00071 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=2.809 | 1802.0 samples/s | 28.2 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00066 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=2.810 | 4162.1 samples/s | 65.0 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00061 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.810 | 1847.1 samples/s | 28.9 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00056 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=2.811 | 4286.4 samples/s | 67.0 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00053 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.811 | 1860.7 samples/s | 29.1 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00049 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=2.812 | 4272.9 samples/s | 66.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31748 | acc=0.8200 | tpr=0.7424 | fpr=0.0114 | 3941.3 samples/s | 15.4 steps/s
Avg test loss: 0.31704, Avg test acc: 0.82362, Avg tpr: 0.74891, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.30091 | acc=0.8838 | tpr=0.9779 | fpr=0.1179 | 3977.0 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.30002 | acc=0.8848 | tpr=0.9829 | fpr=0.1170 | 7745.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.30539 | acc=0.8849 | tpr=0.9827 | fpr=0.1169 | 7659.5 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.30753 | acc=0.8842 | tpr=0.9814 | fpr=0.1175 | 8150.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.30796 | acc=0.8835 | tpr=0.9799 | fpr=0.1183 | 7108.6 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.31067 | acc=0.8837 | tpr=0.9796 | fpr=0.1181 | 7522.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.31133 | acc=0.8841 | tpr=0.9787 | fpr=0.1176 | 7610.1 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.31176 | acc=0.8837 | tpr=0.9759 | fpr=0.1180 | 7679.6 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.31433 | acc=0.8832 | tpr=0.9757 | fpr=0.1185 | 7708.1 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.31444 | acc=0.8830 | tpr=0.9767 | fpr=0.1186 | 7257.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.31319 | acc=0.8832 | tpr=0.9757 | fpr=0.1185 | 13460.1 samples/s | 52.6 steps/s
Avg test loss: 0.31286, Avg test acc: 0.88326, Avg tpr: 0.97583, Avg fpr: 0.11842, total FA: 16443

server round 25/50

clients selected: [0 1 2 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.10193 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.654 | L2-Norm(final)=2.832 | 3582.6 samples/s | 56.0 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03823 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=2.819 | 4167.5 samples/s | 65.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03078 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.815 | 4451.0 samples/s | 69.5 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02669 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=2.815 | 4331.1 samples/s | 67.7 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02534 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.697 | L2-Norm(final)=2.816 | 5771.8 samples/s | 90.2 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02213 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.702 | L2-Norm(final)=2.816 | 1725.1 samples/s | 27.0 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01960 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=2.819 | 4343.9 samples/s | 67.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01805 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=2.823 | 4253.3 samples/s | 66.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01706 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.828 | 5392.6 samples/s | 84.3 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01605 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.831 | 1713.7 samples/s | 26.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01508 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.727 | L2-Norm(final)=2.834 | 4449.3 samples/s | 69.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01432 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.731 | L2-Norm(final)=2.838 | 4509.7 samples/s | 70.5 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01349 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.842 | 5232.8 samples/s | 81.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01311 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.739 | L2-Norm(final)=2.845 | 1797.3 samples/s | 28.1 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01263 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.742 | L2-Norm(final)=2.849 | 4421.9 samples/s | 69.1 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01219 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=2.852 | 4461.8 samples/s | 69.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01186 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.855 | 4789.5 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.13815 | Reg=0.00186 | acc=0.8594 | L2-Norm=13.654 | L2-Norm(final)=2.832 | 3945.4 samples/s | 61.6 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04411 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.678 | L2-Norm(final)=2.817 | 3949.4 samples/s | 61.7 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03328 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.689 | L2-Norm(final)=2.814 | 4437.2 samples/s | 69.3 steps/s
[Step=8950 Epoch=43.7] | Loss=0.02815 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=2.814 | 4486.8 samples/s | 70.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02592 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.704 | L2-Norm(final)=2.816 | 5876.9 samples/s | 91.8 steps/s
[Step=9050 Epoch=44.2] | Loss=0.02263 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=2.819 | 1716.7 samples/s | 26.8 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02072 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.716 | L2-Norm(final)=2.822 | 4255.5 samples/s | 66.5 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01897 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.826 | 4159.5 samples/s | 65.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01751 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.726 | L2-Norm(final)=2.829 | 5512.6 samples/s | 86.1 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01634 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=2.833 | 1664.6 samples/s | 26.0 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01532 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.836 | 4497.7 samples/s | 70.3 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01440 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.738 | L2-Norm(final)=2.840 | 4468.2 samples/s | 69.8 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01394 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.843 | 5330.5 samples/s | 83.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01340 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.846 | 1795.5 samples/s | 28.1 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01293 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=2.849 | 4414.3 samples/s | 69.0 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01236 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.851 | 4457.4 samples/s | 69.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01187 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=2.854 | 4902.4 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.18948 | Reg=0.00186 | acc=0.8594 | L2-Norm=13.654 | L2-Norm(final)=2.832 | 3728.7 samples/s | 58.3 steps/s
[Step=7250 Epoch=35.3] | Loss=0.04564 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.685 | L2-Norm(final)=2.819 | 4105.9 samples/s | 64.2 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03258 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=2.818 | 4290.7 samples/s | 67.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.02908 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=2.819 | 4448.1 samples/s | 69.5 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02518 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.821 | 6071.2 samples/s | 94.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02184 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.824 | 1732.8 samples/s | 27.1 steps/s
[Step=7500 Epoch=36.5] | Loss=0.01953 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.828 | 4451.9 samples/s | 69.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01799 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.832 | 4474.3 samples/s | 69.9 steps/s
[Step=7600 Epoch=37.0] | Loss=0.01663 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=2.836 | 5481.1 samples/s | 85.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01559 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.840 | 1748.7 samples/s | 27.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01473 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=2.843 | 4490.3 samples/s | 70.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01418 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=2.846 | 4472.0 samples/s | 69.9 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01354 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=2.849 | 4986.6 samples/s | 77.9 steps/s
[Step=7850 Epoch=38.2] | Loss=0.01277 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=2.853 | 1768.4 samples/s | 27.6 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01221 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=2.856 | 4508.9 samples/s | 70.5 steps/s
[Step=7950 Epoch=38.7] | Loss=0.01181 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=2.859 | 4408.2 samples/s | 68.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01140 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=2.862 | 4799.5 samples/s | 75.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=60.9] | Loss=0.01017 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.654 | L2-Norm(final)=2.832 | 3536.3 samples/s | 55.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.00713 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.827 | 3974.9 samples/s | 62.1 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00413 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.829 | 5566.1 samples/s | 87.0 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00278 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=2.831 | 1679.6 samples/s | 26.2 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00209 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=2.833 | 5305.0 samples/s | 82.9 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00168 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.834 | 1702.3 samples/s | 26.6 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00140 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.835 | 4844.8 samples/s | 75.7 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00121 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.836 | 1745.4 samples/s | 27.3 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00106 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=2.837 | 4670.7 samples/s | 73.0 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00094 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.838 | 1792.1 samples/s | 28.0 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00085 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.838 | 4385.2 samples/s | 68.5 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00078 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=2.839 | 1842.5 samples/s | 28.8 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00071 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=2.840 | 4314.9 samples/s | 67.4 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00066 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.840 | 1874.4 samples/s | 29.3 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00061 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.841 | 4199.9 samples/s | 65.6 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00057 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.842 | 1876.3 samples/s | 29.3 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00054 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=2.842 | 4227.2 samples/s | 66.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=90.5] | Loss=0.01005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.832 | 3705.7 samples/s | 57.9 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00455 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=2.834 | 3626.3 samples/s | 56.7 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00247 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=2.840 | 5637.8 samples/s | 88.1 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00168 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=2.845 | 1698.0 samples/s | 26.5 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00126 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.847 | 5183.2 samples/s | 81.0 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00102 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=2.849 | 1735.3 samples/s | 27.1 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00085 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.851 | 4823.1 samples/s | 75.4 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00073 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=2.853 | 1761.0 samples/s | 27.5 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00064 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=2.854 | 4423.5 samples/s | 69.1 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00057 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.855 | 1829.2 samples/s | 28.6 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00052 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.856 | 4315.2 samples/s | 67.4 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00047 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.857 | 1850.9 samples/s | 28.9 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00043 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=2.858 | 4337.1 samples/s | 67.8 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00040 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.859 | 1869.2 samples/s | 29.2 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00037 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.859 | 4217.1 samples/s | 65.9 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00035 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=2.860 | 1890.4 samples/s | 29.5 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00033 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.861 | 4098.4 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32816 | acc=0.8148 | tpr=0.7352 | fpr=0.0124 | 3936.6 samples/s | 15.4 steps/s
Avg test loss: 0.32765, Avg test acc: 0.81841, Avg tpr: 0.74145, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.28962 | acc=0.8903 | tpr=0.9823 | fpr=0.1113 | 3897.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.28893 | acc=0.8920 | tpr=0.9851 | fpr=0.1098 | 7716.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.29517 | acc=0.8915 | tpr=0.9841 | fpr=0.1102 | 7221.5 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.29749 | acc=0.8910 | tpr=0.9825 | fpr=0.1106 | 7437.9 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.29774 | acc=0.8904 | tpr=0.9808 | fpr=0.1112 | 7477.8 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.30057 | acc=0.8905 | tpr=0.9811 | fpr=0.1112 | 7357.7 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.30133 | acc=0.8906 | tpr=0.9800 | fpr=0.1110 | 7439.4 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.30179 | acc=0.8903 | tpr=0.9776 | fpr=0.1113 | 7735.6 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.30439 | acc=0.8899 | tpr=0.9771 | fpr=0.1117 | 7449.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.30450 | acc=0.8897 | tpr=0.9775 | fpr=0.1119 | 7604.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.30331 | acc=0.8900 | tpr=0.9765 | fpr=0.1116 | 13681.1 samples/s | 53.4 steps/s
Avg test loss: 0.30298, Avg test acc: 0.89000, Avg tpr: 0.97662, Avg fpr: 0.11158, total FA: 15492

server round 26/50

clients selected: [0 1 3 4 5]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.4] | Loss=0.16614 | Reg=0.00185 | acc=0.8594 | L2-Norm=13.598 | L2-Norm(final)=2.864 | 3429.1 samples/s | 53.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04607 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=2.848 | 4365.0 samples/s | 68.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03307 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.650 | L2-Norm(final)=2.846 | 4466.4 samples/s | 69.8 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02883 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.659 | L2-Norm(final)=2.847 | 4422.9 samples/s | 69.1 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02605 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.667 | L2-Norm(final)=2.849 | 5973.3 samples/s | 93.3 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02283 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.851 | 1704.7 samples/s | 26.6 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02055 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=2.854 | 4433.0 samples/s | 69.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01877 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.858 | 4427.4 samples/s | 69.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01756 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=2.862 | 5605.0 samples/s | 87.6 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01649 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=2.865 | 1764.5 samples/s | 27.6 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01560 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.869 | 4255.3 samples/s | 66.5 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01470 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.702 | L2-Norm(final)=2.872 | 4442.3 samples/s | 69.4 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01400 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.876 | 5227.4 samples/s | 81.7 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01338 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.709 | L2-Norm(final)=2.879 | 1780.4 samples/s | 27.8 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01286 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.882 | 4318.7 samples/s | 67.5 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01223 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=2.885 | 4373.2 samples/s | 68.3 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01182 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.718 | L2-Norm(final)=2.889 | 4773.2 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.23168 | Reg=0.00185 | acc=0.8281 | L2-Norm=13.598 | L2-Norm(final)=2.864 | 3824.2 samples/s | 59.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04267 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.624 | L2-Norm(final)=2.847 | 4036.3 samples/s | 63.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03167 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=2.845 | 4373.2 samples/s | 68.3 steps/s
[Step=9750 Epoch=47.6] | Loss=0.02712 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=2.846 | 4374.5 samples/s | 68.4 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02480 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.646 | L2-Norm(final)=2.848 | 5855.2 samples/s | 91.5 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02196 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=2.851 | 1690.6 samples/s | 26.4 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01945 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=2.854 | 4409.2 samples/s | 68.9 steps/s
[Step=9950 Epoch=48.6] | Loss=0.01765 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=2.858 | 4347.8 samples/s | 67.9 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01649 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.667 | L2-Norm(final)=2.862 | 5492.0 samples/s | 85.8 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01529 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=2.866 | 1732.0 samples/s | 27.1 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01459 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=2.870 | 4459.3 samples/s | 69.7 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01387 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=2.873 | 4488.6 samples/s | 70.1 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01313 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.682 | L2-Norm(final)=2.876 | 5329.4 samples/s | 83.3 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01245 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=2.880 | 1740.0 samples/s | 27.2 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01184 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=2.884 | 4442.0 samples/s | 69.4 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01137 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=2.887 | 4500.3 samples/s | 70.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01104 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=2.890 | 5063.4 samples/s | 79.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.25167 | Reg=0.00185 | acc=0.8125 | L2-Norm=13.598 | L2-Norm(final)=2.864 | 3414.6 samples/s | 53.4 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04381 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=2.848 | 4191.9 samples/s | 65.5 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03329 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.645 | L2-Norm(final)=2.844 | 4425.9 samples/s | 69.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02902 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=2.842 | 4367.3 samples/s | 68.2 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02583 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.658 | L2-Norm(final)=2.843 | 5938.9 samples/s | 92.8 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02231 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.845 | 1686.2 samples/s | 26.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02011 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=2.849 | 4219.1 samples/s | 65.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01829 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.853 | 4489.7 samples/s | 70.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01710 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.857 | 5384.8 samples/s | 84.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01585 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.861 | 1733.5 samples/s | 27.1 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01469 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=2.865 | 4489.9 samples/s | 70.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01401 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=2.869 | 4471.1 samples/s | 69.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01346 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=2.872 | 5213.0 samples/s | 81.5 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01286 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=2.875 | 1795.9 samples/s | 28.1 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01239 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.879 | 4487.5 samples/s | 70.1 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01181 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.882 | 4348.4 samples/s | 67.9 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01149 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.709 | L2-Norm(final)=2.885 | 4778.1 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.9] | Loss=0.28399 | Reg=0.00185 | acc=0.8281 | L2-Norm=13.598 | L2-Norm(final)=2.863 | 3827.6 samples/s | 59.8 steps/s
[Step=12050 Epoch=59.1] | Loss=0.04010 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.629 | L2-Norm(final)=2.848 | 3926.9 samples/s | 61.4 steps/s
[Step=12100 Epoch=59.3] | Loss=0.03100 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.639 | L2-Norm(final)=2.845 | 4403.6 samples/s | 68.8 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02685 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.645 | L2-Norm(final)=2.844 | 4299.3 samples/s | 67.2 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02414 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=2.845 | 6041.9 samples/s | 94.4 steps/s
[Step=12250 Epoch=60.1] | Loss=0.02097 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=2.848 | 1702.2 samples/s | 26.6 steps/s
[Step=12300 Epoch=60.3] | Loss=0.01864 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.662 | L2-Norm(final)=2.852 | 4447.9 samples/s | 69.5 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01733 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.856 | 4421.5 samples/s | 69.1 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01618 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.672 | L2-Norm(final)=2.860 | 5621.1 samples/s | 87.8 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01521 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=2.864 | 1707.6 samples/s | 26.7 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01430 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.868 | 4513.9 samples/s | 70.5 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01358 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.871 | 4547.4 samples/s | 71.1 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01298 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=2.875 | 5485.0 samples/s | 85.7 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01235 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=2.879 | 1753.5 samples/s | 27.4 steps/s
[Step=12700 Epoch=62.3] | Loss=0.01177 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=2.882 | 4481.2 samples/s | 70.0 steps/s
[Step=12750 Epoch=62.5] | Loss=0.01129 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.886 | 4485.5 samples/s | 70.1 steps/s
[Step=12800 Epoch=62.8] | Loss=0.01094 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=2.889 | 5243.1 samples/s | 81.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.1] | Loss=0.04859 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.598 | L2-Norm(final)=2.864 | 3551.3 samples/s | 55.5 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00514 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=2.868 | 3889.0 samples/s | 60.8 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00268 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=2.871 | 5687.6 samples/s | 88.9 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00181 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.874 | 1675.8 samples/s | 26.2 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00136 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.876 | 5354.7 samples/s | 83.7 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00109 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.877 | 1722.0 samples/s | 26.9 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00091 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=2.878 | 4834.4 samples/s | 75.5 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00079 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.879 | 1775.5 samples/s | 27.7 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00069 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.880 | 4533.4 samples/s | 70.8 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00062 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.881 | 1786.6 samples/s | 27.9 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00056 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=2.882 | 4393.9 samples/s | 68.7 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00051 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=2.882 | 1845.7 samples/s | 28.8 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00046 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.883 | 4000.2 samples/s | 62.5 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00043 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.884 | 1850.4 samples/s | 28.9 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00040 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=2.885 | 4230.5 samples/s | 66.1 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00037 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.885 | 1846.0 samples/s | 28.8 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00035 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=2.886 | 4214.6 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31384 | acc=0.8232 | tpr=0.7474 | fpr=0.0121 | 4011.7 samples/s | 15.7 steps/s
Avg test loss: 0.31308, Avg test acc: 0.82679, Avg tpr: 0.75374, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.30894 | acc=0.8863 | tpr=0.9823 | fpr=0.1154 | 3924.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.30815 | acc=0.8874 | tpr=0.9851 | fpr=0.1144 | 7674.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.31449 | acc=0.8876 | tpr=0.9841 | fpr=0.1142 | 7312.9 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.31686 | acc=0.8868 | tpr=0.9836 | fpr=0.1149 | 7209.4 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.31724 | acc=0.8859 | tpr=0.9825 | fpr=0.1159 | 7683.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.32023 | acc=0.8858 | tpr=0.9825 | fpr=0.1159 | 7754.0 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.32098 | acc=0.8860 | tpr=0.9812 | fpr=0.1158 | 7185.2 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.32148 | acc=0.8858 | tpr=0.9787 | fpr=0.1158 | 7859.3 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.32417 | acc=0.8855 | tpr=0.9781 | fpr=0.1162 | 7214.3 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.32410 | acc=0.8855 | tpr=0.9789 | fpr=0.1162 | 7500.1 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.32281 | acc=0.8856 | tpr=0.9785 | fpr=0.1161 | 13312.9 samples/s | 52.0 steps/s
Avg test loss: 0.32248, Avg test acc: 0.88564, Avg tpr: 0.97861, Avg fpr: 0.11605, total FA: 16113

server round 27/50

clients selected: [0 3 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=66.3] | Loss=0.22753 | Reg=0.00184 | acc=0.8594 | L2-Norm=13.564 | L2-Norm(final)=2.890 | 3480.2 samples/s | 54.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04837 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.592 | L2-Norm(final)=2.869 | 4201.5 samples/s | 65.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03643 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=2.863 | 4412.2 samples/s | 68.9 steps/s
[Step=13750 Epoch=67.0] | Loss=0.03041 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=2.863 | 4465.4 samples/s | 69.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02792 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.864 | 5976.7 samples/s | 93.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02441 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=2.865 | 1703.7 samples/s | 26.6 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02175 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=2.868 | 4376.2 samples/s | 68.4 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01993 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.871 | 4263.6 samples/s | 66.6 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01847 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=2.875 | 5529.5 samples/s | 86.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01726 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=2.879 | 1745.5 samples/s | 27.3 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01625 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=2.882 | 4476.6 samples/s | 69.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01525 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=2.886 | 4323.0 samples/s | 67.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01480 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=2.889 | 5166.0 samples/s | 80.7 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01416 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.663 | L2-Norm(final)=2.892 | 1793.0 samples/s | 28.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01362 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.894 | 4387.3 samples/s | 68.6 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01306 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.669 | L2-Norm(final)=2.897 | 4446.1 samples/s | 69.5 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01249 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=2.900 | 4660.6 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.25942 | Reg=0.00184 | acc=0.8750 | L2-Norm=13.564 | L2-Norm(final)=2.890 | 3625.7 samples/s | 56.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04114 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.589 | L2-Norm(final)=2.875 | 4121.7 samples/s | 64.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03257 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=2.869 | 4474.6 samples/s | 69.9 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02804 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.606 | L2-Norm(final)=2.868 | 4516.2 samples/s | 70.6 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02483 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=2.870 | 5864.6 samples/s | 91.6 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02122 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.873 | 1711.4 samples/s | 26.7 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01903 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.623 | L2-Norm(final)=2.876 | 4505.4 samples/s | 70.4 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01726 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=2.880 | 4487.1 samples/s | 70.1 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01632 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.633 | L2-Norm(final)=2.885 | 5614.2 samples/s | 87.7 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01498 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.889 | 1716.5 samples/s | 26.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01404 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.643 | L2-Norm(final)=2.894 | 4510.2 samples/s | 70.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01338 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.898 | 4521.2 samples/s | 70.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01294 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.902 | 5060.4 samples/s | 79.1 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01238 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=2.906 | 1777.2 samples/s | 27.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01192 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.658 | L2-Norm(final)=2.910 | 4461.9 samples/s | 69.7 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01133 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.914 | 4477.1 samples/s | 70.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01103 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=2.917 | 4898.1 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.8] | Loss=0.22112 | Reg=0.00184 | acc=0.8750 | L2-Norm=13.564 | L2-Norm(final)=2.890 | 3883.9 samples/s | 60.7 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03622 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.596 | L2-Norm(final)=2.879 | 4065.0 samples/s | 63.5 steps/s
[Step=12900 Epoch=63.3] | Loss=0.03263 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=2.875 | 4498.7 samples/s | 70.3 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02790 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=2.873 | 4424.9 samples/s | 69.1 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02439 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.621 | L2-Norm(final)=2.876 | 6076.0 samples/s | 94.9 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02120 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=2.879 | 1677.6 samples/s | 26.2 steps/s
[Step=13100 Epoch=64.2] | Loss=0.01926 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.634 | L2-Norm(final)=2.884 | 4454.2 samples/s | 69.6 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01771 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.640 | L2-Norm(final)=2.888 | 4392.6 samples/s | 68.6 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01653 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=2.892 | 5765.5 samples/s | 90.1 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01553 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.651 | L2-Norm(final)=2.896 | 1730.6 samples/s | 27.0 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01472 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=2.899 | 4354.4 samples/s | 68.0 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01393 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.903 | 4489.3 samples/s | 70.1 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01317 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=2.907 | 5512.9 samples/s | 86.1 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01247 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.669 | L2-Norm(final)=2.910 | 1760.8 samples/s | 27.5 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01198 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.913 | 4582.6 samples/s | 71.6 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01159 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.676 | L2-Norm(final)=2.917 | 4406.7 samples/s | 68.9 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01107 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.920 | 5261.5 samples/s | 82.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=113.7] | Loss=0.11209 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.564 | L2-Norm(final)=2.890 | 3671.0 samples/s | 57.4 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00544 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.888 | 3874.8 samples/s | 60.5 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00292 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=2.892 | 5746.5 samples/s | 89.8 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00196 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.896 | 1673.4 samples/s | 26.1 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00148 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=2.898 | 5294.1 samples/s | 82.7 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00118 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.899 | 1684.2 samples/s | 26.3 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00099 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=2.900 | 4900.0 samples/s | 76.6 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00085 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=2.901 | 1746.2 samples/s | 27.3 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00075 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=2.902 | 4309.6 samples/s | 67.3 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00066 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.903 | 1786.9 samples/s | 27.9 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00060 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=2.904 | 4373.9 samples/s | 68.3 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00055 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=2.905 | 1839.8 samples/s | 28.7 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=2.905 | 4190.1 samples/s | 65.5 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00046 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=2.906 | 1850.5 samples/s | 28.9 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00043 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=2.907 | 4279.3 samples/s | 66.9 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00040 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=2.907 | 1835.9 samples/s | 28.7 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00038 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.908 | 4257.2 samples/s | 66.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step12800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=129.9] | Loss=0.07399 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=2.890 | 3772.7 samples/s | 58.9 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00338 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=2.895 | 3810.1 samples/s | 59.5 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00192 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.900 | 5807.0 samples/s | 90.7 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00130 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.903 | 1647.1 samples/s | 25.7 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00098 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=2.904 | 5422.4 samples/s | 84.7 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00079 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=2.906 | 1682.9 samples/s | 26.3 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00066 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=2.907 | 4864.7 samples/s | 76.0 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00056 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=2.908 | 1735.2 samples/s | 27.1 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00049 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=2.908 | 4856.9 samples/s | 75.9 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00044 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=2.909 | 1786.9 samples/s | 27.9 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00040 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=2.910 | 4435.4 samples/s | 69.3 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00036 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=2.910 | 1814.3 samples/s | 28.3 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00033 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.541 | L2-Norm(final)=2.911 | 4384.6 samples/s | 68.5 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00031 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.911 | 1830.0 samples/s | 28.6 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00029 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=2.912 | 4391.3 samples/s | 68.6 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00027 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.912 | 1870.2 samples/s | 29.2 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00025 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=2.912 | 4170.7 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28945 | acc=0.8367 | tpr=0.7678 | fpr=0.0136 | 3881.5 samples/s | 15.2 steps/s
Avg test loss: 0.28927, Avg test acc: 0.83977, Avg tpr: 0.77315, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.33471 | acc=0.8777 | tpr=0.9823 | fpr=0.1242 | 3943.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.33437 | acc=0.8780 | tpr=0.9851 | fpr=0.1240 | 7934.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.34035 | acc=0.8783 | tpr=0.9856 | fpr=0.1236 | 7524.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.34270 | acc=0.8777 | tpr=0.9847 | fpr=0.1242 | 7635.6 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.34346 | acc=0.8766 | tpr=0.9834 | fpr=0.1254 | 7517.8 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.34650 | acc=0.8771 | tpr=0.9833 | fpr=0.1248 | 8037.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.34718 | acc=0.8773 | tpr=0.9825 | fpr=0.1246 | 7430.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.34771 | acc=0.8772 | tpr=0.9803 | fpr=0.1246 | 7305.7 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.35050 | acc=0.8769 | tpr=0.9796 | fpr=0.1250 | 7685.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.35068 | acc=0.8768 | tpr=0.9806 | fpr=0.1251 | 7557.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.34941 | acc=0.8770 | tpr=0.9797 | fpr=0.1248 | 14028.3 samples/s | 54.8 steps/s
Avg test loss: 0.34909, Avg test acc: 0.87705, Avg tpr: 0.97979, Avg fpr: 0.12482, total FA: 17331

server round 28/50

clients selected: [0 1 2 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=70.2] | Loss=0.28681 | Reg=0.00183 | acc=0.8281 | L2-Norm=13.535 | L2-Norm(final)=2.910 | 4019.1 samples/s | 62.8 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04083 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.569 | L2-Norm(final)=2.891 | 4101.9 samples/s | 64.1 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03117 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.584 | L2-Norm(final)=2.888 | 4457.8 samples/s | 69.7 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02835 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.592 | L2-Norm(final)=2.887 | 4480.4 samples/s | 70.0 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02579 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=2.888 | 5965.0 samples/s | 93.2 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02231 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=2.890 | 1692.9 samples/s | 26.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01985 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.893 | 4453.4 samples/s | 69.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01802 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=2.896 | 4466.7 samples/s | 69.8 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01707 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.900 | 5572.5 samples/s | 87.1 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01612 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.903 | 1755.4 samples/s | 27.4 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01495 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=2.906 | 4484.7 samples/s | 70.1 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01452 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=2.909 | 4481.1 samples/s | 70.0 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01397 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=2.912 | 5214.9 samples/s | 81.5 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01324 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.638 | L2-Norm(final)=2.914 | 1756.3 samples/s | 27.4 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01249 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.917 | 4507.6 samples/s | 70.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01210 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.644 | L2-Norm(final)=2.920 | 4313.8 samples/s | 67.4 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01172 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.923 | 4832.7 samples/s | 75.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.8] | Loss=0.17164 | Reg=0.00183 | acc=0.8906 | L2-Norm=13.535 | L2-Norm(final)=2.910 | 3706.6 samples/s | 57.9 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04156 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.563 | L2-Norm(final)=2.895 | 4225.4 samples/s | 66.0 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03299 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.572 | L2-Norm(final)=2.890 | 4358.8 samples/s | 68.1 steps/s
[Step=10550 Epoch=51.5] | Loss=0.02847 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.577 | L2-Norm(final)=2.888 | 4408.7 samples/s | 68.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02521 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=2.888 | 5979.5 samples/s | 93.4 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02202 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.587 | L2-Norm(final)=2.890 | 1711.9 samples/s | 26.7 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01967 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.592 | L2-Norm(final)=2.893 | 4462.6 samples/s | 69.7 steps/s
[Step=10750 Epoch=52.5] | Loss=0.01837 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.896 | 4352.4 samples/s | 68.0 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01707 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.899 | 5629.9 samples/s | 88.0 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01604 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=2.901 | 1721.0 samples/s | 26.9 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01516 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=2.904 | 4382.0 samples/s | 68.5 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01447 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.611 | L2-Norm(final)=2.907 | 4393.1 samples/s | 68.6 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01373 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.910 | 5186.1 samples/s | 81.0 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01319 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=2.912 | 1755.0 samples/s | 27.4 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01245 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.619 | L2-Norm(final)=2.915 | 4436.9 samples/s | 69.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01207 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.918 | 4394.0 samples/s | 68.7 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01180 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.920 | 5000.9 samples/s | 78.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.11073 | Reg=0.00183 | acc=0.9062 | L2-Norm=13.535 | L2-Norm(final)=2.910 | 3743.0 samples/s | 58.5 steps/s
[Step=8050 Epoch=39.2] | Loss=0.04237 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.557 | L2-Norm(final)=2.894 | 4030.8 samples/s | 63.0 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03130 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.570 | L2-Norm(final)=2.892 | 4405.2 samples/s | 68.8 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02701 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.579 | L2-Norm(final)=2.894 | 4542.8 samples/s | 71.0 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02426 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=2.897 | 5898.0 samples/s | 92.2 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02079 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=2.901 | 1697.0 samples/s | 26.5 steps/s
[Step=8300 Epoch=40.4] | Loss=0.01887 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.905 | 4447.7 samples/s | 69.5 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01723 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.606 | L2-Norm(final)=2.909 | 4423.3 samples/s | 69.1 steps/s
[Step=8400 Epoch=40.9] | Loss=0.01611 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=2.913 | 5295.2 samples/s | 82.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01491 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=2.916 | 1727.6 samples/s | 27.0 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01423 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.920 | 4434.4 samples/s | 69.3 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01352 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.626 | L2-Norm(final)=2.924 | 4452.9 samples/s | 69.6 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01283 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=2.927 | 5063.0 samples/s | 79.1 steps/s
[Step=8650 Epoch=42.1] | Loss=0.01218 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=2.931 | 1773.9 samples/s | 27.7 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01174 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.934 | 4438.7 samples/s | 69.4 steps/s
[Step=8750 Epoch=42.6] | Loss=0.01149 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=2.937 | 4477.9 samples/s | 70.0 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01123 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=2.940 | 4883.7 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=137.5] | Loss=0.00673 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=2.911 | 3684.2 samples/s | 57.6 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00279 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.919 | 3916.3 samples/s | 61.2 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00148 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.925 | 5793.6 samples/s | 90.5 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00099 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=2.928 | 1677.7 samples/s | 26.2 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00075 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=2.929 | 5388.1 samples/s | 84.2 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00060 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.583 | L2-Norm(final)=2.931 | 1634.2 samples/s | 25.5 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.932 | 4893.5 samples/s | 76.5 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00043 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=2.932 | 1733.8 samples/s | 27.1 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00038 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=2.933 | 4773.8 samples/s | 74.6 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00034 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=2.934 | 1753.0 samples/s | 27.4 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00030 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.541 | L2-Norm(final)=2.934 | 4560.3 samples/s | 71.3 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00028 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.935 | 1815.2 samples/s | 28.4 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00025 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=2.936 | 4382.8 samples/s | 68.5 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00023 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=2.936 | 1823.9 samples/s | 28.5 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00022 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.937 | 4259.9 samples/s | 66.6 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00020 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.937 | 1846.2 samples/s | 28.8 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00019 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=2.937 | 4278.9 samples/s | 66.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.0] | Loss=0.12053 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.535 | L2-Norm(final)=2.909 | 3818.0 samples/s | 59.7 steps/s
[Step=10450 Epoch=98.5] | Loss=0.00845 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=2.902 | 3853.0 samples/s | 60.2 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00524 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.902 | 5744.9 samples/s | 89.8 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00374 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=2.903 | 1672.4 samples/s | 26.1 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00281 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=2.905 | 5200.1 samples/s | 81.3 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00225 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=2.906 | 1720.8 samples/s | 26.9 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00188 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=2.907 | 4894.0 samples/s | 76.5 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00161 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=2.907 | 1792.0 samples/s | 28.0 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00141 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.908 | 4339.4 samples/s | 67.8 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00126 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.909 | 1830.7 samples/s | 28.6 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00113 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.909 | 4256.9 samples/s | 66.5 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00103 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=2.910 | 1821.8 samples/s | 28.5 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00095 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=2.911 | 4356.4 samples/s | 68.1 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00087 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.911 | 1888.2 samples/s | 29.5 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00081 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=2.912 | 4292.9 samples/s | 67.1 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00076 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.912 | 1968.1 samples/s | 30.8 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00071 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=2.913 | 3812.5 samples/s | 59.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26458 | acc=0.8458 | tpr=0.7815 | fpr=0.0146 | 3846.0 samples/s | 15.0 steps/s
Avg test loss: 0.26484, Avg test acc: 0.84786, Avg tpr: 0.78580, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.34090 | acc=0.8758 | tpr=0.9823 | fpr=0.1261 | 3765.0 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.34094 | acc=0.8757 | tpr=0.9851 | fpr=0.1263 | 5017.2 samples/s | 19.6 steps/s
[Step= 150] | Loss=0.34699 | acc=0.8761 | tpr=0.9856 | fpr=0.1259 | 6574.9 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.34974 | acc=0.8755 | tpr=0.9836 | fpr=0.1265 | 7721.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.35048 | acc=0.8744 | tpr=0.9825 | fpr=0.1276 | 7359.0 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.35342 | acc=0.8748 | tpr=0.9825 | fpr=0.1271 | 7382.5 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.35417 | acc=0.8749 | tpr=0.9818 | fpr=0.1270 | 7588.4 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.35474 | acc=0.8749 | tpr=0.9798 | fpr=0.1270 | 7354.3 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.35763 | acc=0.8746 | tpr=0.9796 | fpr=0.1273 | 7530.8 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.35774 | acc=0.8744 | tpr=0.9806 | fpr=0.1276 | 7508.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.35650 | acc=0.8747 | tpr=0.9797 | fpr=0.1272 | 13653.8 samples/s | 53.3 steps/s
Avg test loss: 0.35615, Avg test acc: 0.87473, Avg tpr: 0.97979, Avg fpr: 0.12718, total FA: 17659

server round 29/50

clients selected: [0 1 2 3 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=15201 Epoch=74.1] | Loss=0.18206 | Reg=0.00182 | acc=0.8281 | L2-Norm=13.505 | L2-Norm(final)=2.928 | 3731.7 samples/s | 58.3 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03353 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=2.919 | 4055.6 samples/s | 63.4 steps/s
[Step=15300 Epoch=74.6] | Loss=0.03017 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=2.917 | 4481.7 samples/s | 70.0 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02623 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.538 | L2-Norm(final)=2.914 | 4320.2 samples/s | 67.5 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02350 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.544 | L2-Norm(final)=2.915 | 5814.9 samples/s | 90.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02043 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=2.918 | 1718.3 samples/s | 26.8 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01848 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.558 | L2-Norm(final)=2.922 | 4413.6 samples/s | 69.0 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01725 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=2.925 | 4420.6 samples/s | 69.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01601 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=2.929 | 5481.2 samples/s | 85.6 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01492 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=2.932 | 1724.2 samples/s | 26.9 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01403 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.579 | L2-Norm(final)=2.936 | 4432.4 samples/s | 69.3 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01349 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.583 | L2-Norm(final)=2.940 | 4530.7 samples/s | 70.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01288 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=2.943 | 5125.6 samples/s | 80.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01250 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=2.946 | 1815.5 samples/s | 28.4 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01194 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=2.949 | 4405.9 samples/s | 68.8 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01158 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=2.953 | 4477.5 samples/s | 70.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01121 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.600 | L2-Norm(final)=2.955 | 4898.0 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.7] | Loss=0.16481 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.505 | L2-Norm(final)=2.928 | 3477.6 samples/s | 54.3 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04066 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.912 | 4248.8 samples/s | 66.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03182 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=2.907 | 4219.5 samples/s | 65.9 steps/s
[Step=11350 Epoch=55.4] | Loss=0.02719 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.546 | L2-Norm(final)=2.907 | 4300.5 samples/s | 67.2 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02477 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.552 | L2-Norm(final)=2.907 | 5951.0 samples/s | 93.0 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02150 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.557 | L2-Norm(final)=2.909 | 1698.6 samples/s | 26.5 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01949 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=2.912 | 4378.7 samples/s | 68.4 steps/s
[Step=11550 Epoch=56.4] | Loss=0.01782 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.915 | 4444.9 samples/s | 69.5 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01665 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=2.919 | 5719.3 samples/s | 89.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01572 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.575 | L2-Norm(final)=2.922 | 1302.7 samples/s | 20.4 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01476 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=2.925 | 4059.6 samples/s | 63.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01396 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.582 | L2-Norm(final)=2.928 | 4375.4 samples/s | 68.4 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01340 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.931 | 4807.8 samples/s | 75.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01286 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=2.933 | 1734.9 samples/s | 27.1 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01229 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=2.936 | 4357.5 samples/s | 68.1 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01189 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=2.938 | 4435.3 samples/s | 69.3 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01159 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=2.940 | 4968.4 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.18844 | Reg=0.00182 | acc=0.8750 | L2-Norm=13.505 | L2-Norm(final)=2.928 | 3660.9 samples/s | 57.2 steps/s
[Step=8850 Epoch=43.1] | Loss=0.03823 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.521 | L2-Norm(final)=2.911 | 4222.3 samples/s | 66.0 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02919 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.531 | L2-Norm(final)=2.910 | 4370.0 samples/s | 68.3 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02656 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.540 | L2-Norm(final)=2.911 | 4448.0 samples/s | 69.5 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02318 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=2.914 | 6085.1 samples/s | 95.1 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02051 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=2.918 | 1686.7 samples/s | 26.4 steps/s
[Step=9100 Epoch=44.3] | Loss=0.01862 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=2.922 | 4305.3 samples/s | 67.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01716 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=2.925 | 4416.3 samples/s | 69.0 steps/s
[Step=9200 Epoch=44.8] | Loss=0.01624 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.571 | L2-Norm(final)=2.929 | 5437.6 samples/s | 85.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01523 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.932 | 1758.2 samples/s | 27.5 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01437 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=2.936 | 4501.2 samples/s | 70.3 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01373 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.939 | 4496.9 samples/s | 70.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01302 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=2.943 | 5067.6 samples/s | 79.2 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01236 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=2.947 | 1760.9 samples/s | 27.5 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01190 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=2.950 | 4235.3 samples/s | 66.2 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01157 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=2.954 | 4482.7 samples/s | 70.0 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01114 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=2.957 | 4647.4 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.4] | Loss=0.14506 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.505 | L2-Norm(final)=2.928 | 3682.4 samples/s | 57.5 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03411 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.527 | L2-Norm(final)=2.919 | 4074.0 samples/s | 63.7 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02715 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.537 | L2-Norm(final)=2.919 | 4484.8 samples/s | 70.1 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02458 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.545 | L2-Norm(final)=2.920 | 4437.7 samples/s | 69.3 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02205 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=2.922 | 6021.7 samples/s | 94.1 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01937 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=2.925 | 1735.5 samples/s | 27.1 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01746 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=2.929 | 4486.6 samples/s | 70.1 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01629 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.570 | L2-Norm(final)=2.933 | 4302.6 samples/s | 67.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01521 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=2.937 | 5515.1 samples/s | 86.2 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01422 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=2.940 | 1729.8 samples/s | 27.0 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01344 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.944 | 4437.2 samples/s | 69.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01265 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=2.948 | 4433.1 samples/s | 69.3 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01218 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=2.952 | 5197.2 samples/s | 81.2 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01165 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=2.956 | 1832.9 samples/s | 28.6 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01136 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.959 | 4422.2 samples/s | 69.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01095 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=2.963 | 4462.8 samples/s | 69.7 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01059 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.607 | L2-Norm(final)=2.966 | 4788.7 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=105.5] | Loss=0.01269 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.929 | 3504.1 samples/s | 54.8 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00416 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=2.934 | 3992.7 samples/s | 62.4 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00221 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=2.938 | 5507.1 samples/s | 86.0 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00151 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=2.941 | 1689.2 samples/s | 26.4 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00114 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=2.943 | 5212.8 samples/s | 81.4 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00092 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=2.945 | 1713.7 samples/s | 26.8 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00077 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=2.947 | 4842.0 samples/s | 75.7 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00066 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=2.948 | 1764.2 samples/s | 27.6 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00058 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=2.949 | 4466.5 samples/s | 69.8 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00052 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.950 | 1802.4 samples/s | 28.2 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00047 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=2.951 | 4243.2 samples/s | 66.3 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00043 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=2.952 | 1865.0 samples/s | 29.1 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=2.953 | 4287.5 samples/s | 67.0 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00036 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.954 | 1863.5 samples/s | 29.1 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00034 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=2.955 | 4369.7 samples/s | 68.3 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00032 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.956 | 1954.3 samples/s | 30.5 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00030 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.957 | 3825.1 samples/s | 59.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28755 | acc=0.8352 | tpr=0.7657 | fpr=0.0141 | 3938.2 samples/s | 15.4 steps/s
Avg test loss: 0.28748, Avg test acc: 0.83933, Avg tpr: 0.77240, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.32131 | acc=0.8841 | tpr=0.9779 | fpr=0.1176 | 3859.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.32180 | acc=0.8844 | tpr=0.9829 | fpr=0.1175 | 7726.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.32794 | acc=0.8846 | tpr=0.9827 | fpr=0.1172 | 7708.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.33079 | acc=0.8836 | tpr=0.9792 | fpr=0.1181 | 7545.6 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.33146 | acc=0.8829 | tpr=0.9790 | fpr=0.1189 | 7492.7 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.33443 | acc=0.8829 | tpr=0.9796 | fpr=0.1188 | 7588.6 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.33516 | acc=0.8830 | tpr=0.9787 | fpr=0.1187 | 7545.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.33566 | acc=0.8831 | tpr=0.9770 | fpr=0.1186 | 7811.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.33849 | acc=0.8827 | tpr=0.9771 | fpr=0.1190 | 7403.2 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.33873 | acc=0.8825 | tpr=0.9784 | fpr=0.1193 | 7671.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.33748 | acc=0.8826 | tpr=0.9777 | fpr=0.1191 | 14037.6 samples/s | 54.8 steps/s
Avg test loss: 0.33713, Avg test acc: 0.88265, Avg tpr: 0.97781, Avg fpr: 0.11908, total FA: 16534

server round 30/50

clients selected: [0 1 2 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.14555 | Reg=0.00182 | acc=0.9219 | L2-Norm=13.481 | L2-Norm(final)=2.945 | 3530.4 samples/s | 55.2 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03974 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.494 | L2-Norm(final)=2.937 | 4353.5 samples/s | 68.0 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02843 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.498 | L2-Norm(final)=2.936 | 4491.0 samples/s | 70.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02391 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.502 | L2-Norm(final)=2.938 | 4375.0 samples/s | 68.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02065 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=2.941 | 5805.2 samples/s | 90.7 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01758 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.943 | 1702.2 samples/s | 26.6 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01587 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.511 | L2-Norm(final)=2.945 | 4463.2 samples/s | 69.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01489 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=2.948 | 4490.5 samples/s | 70.2 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01366 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=2.950 | 5549.0 samples/s | 86.7 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01267 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=2.953 | 1772.4 samples/s | 27.7 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01187 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.956 | 4244.2 samples/s | 66.3 steps/s
[Step=16550 Epoch=80.7] | Loss=0.01121 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.524 | L2-Norm(final)=2.959 | 4481.0 samples/s | 70.0 steps/s
[Step=16600 Epoch=80.9] | Loss=0.01088 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=2.962 | 5177.6 samples/s | 80.9 steps/s
[Step=16650 Epoch=81.2] | Loss=0.01036 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=2.965 | 1782.0 samples/s | 27.8 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00990 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.968 | 4492.3 samples/s | 70.2 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00956 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=2.971 | 4503.5 samples/s | 70.4 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00921 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=2.973 | 4842.4 samples/s | 75.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.6] | Loss=0.25027 | Reg=0.00182 | acc=0.8438 | L2-Norm=13.481 | L2-Norm(final)=2.945 | 3804.1 samples/s | 59.4 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04685 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.497 | L2-Norm(final)=2.935 | 4093.5 samples/s | 64.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03321 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.502 | L2-Norm(final)=2.933 | 4493.4 samples/s | 70.2 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02775 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.934 | 4322.6 samples/s | 67.5 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02377 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=2.935 | 5860.8 samples/s | 91.6 steps/s
[Step=12250 Epoch=59.8] | Loss=0.02024 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.937 | 1660.3 samples/s | 25.9 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01802 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=2.939 | 4468.1 samples/s | 69.8 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01631 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=2.942 | 4458.2 samples/s | 69.7 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01525 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=2.945 | 5635.9 samples/s | 88.1 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01416 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=2.947 | 1749.3 samples/s | 27.3 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01310 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.950 | 4526.0 samples/s | 70.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01247 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=2.953 | 4432.6 samples/s | 69.3 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01189 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.955 | 5359.2 samples/s | 83.7 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01119 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.958 | 1725.1 samples/s | 27.0 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01070 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=2.961 | 4490.0 samples/s | 70.2 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01034 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=2.963 | 4325.5 samples/s | 67.6 steps/s
[Step=12800 Epoch=62.5] | Loss=0.01001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=2.966 | 4998.7 samples/s | 78.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=46.8] | Loss=0.30970 | Reg=0.00182 | acc=0.8281 | L2-Norm=13.481 | L2-Norm(final)=2.945 | 3747.7 samples/s | 58.6 steps/s
[Step=9650 Epoch=47.0] | Loss=0.04567 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.491 | L2-Norm(final)=2.936 | 4236.0 samples/s | 66.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03173 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.495 | L2-Norm(final)=2.934 | 4466.1 samples/s | 69.8 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02592 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.498 | L2-Norm(final)=2.935 | 4433.9 samples/s | 69.3 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02249 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.937 | 5943.1 samples/s | 92.9 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01921 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.506 | L2-Norm(final)=2.940 | 1721.5 samples/s | 26.9 steps/s
[Step=9900 Epoch=48.2] | Loss=0.01736 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.943 | 4420.2 samples/s | 69.1 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01598 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.513 | L2-Norm(final)=2.946 | 4479.5 samples/s | 70.0 steps/s
[Step=10000 Epoch=48.7] | Loss=0.01477 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.516 | L2-Norm(final)=2.949 | 5453.7 samples/s | 85.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01392 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=2.952 | 1715.3 samples/s | 26.8 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01294 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.955 | 4537.6 samples/s | 70.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01221 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=2.958 | 4417.7 samples/s | 69.0 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01165 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=2.961 | 5169.4 samples/s | 80.8 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01120 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=2.964 | 1800.0 samples/s | 28.1 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01082 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.966 | 4511.9 samples/s | 70.5 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01029 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=2.969 | 4301.4 samples/s | 67.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00993 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=2.972 | 4726.7 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.7] | Loss=0.09460 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.481 | L2-Norm(final)=2.945 | 3730.8 samples/s | 58.3 steps/s
[Step=13650 Epoch=66.9] | Loss=0.03184 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.494 | L2-Norm(final)=2.941 | 4011.1 samples/s | 62.7 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02396 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.500 | L2-Norm(final)=2.943 | 4528.8 samples/s | 70.8 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02179 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.945 | 4556.6 samples/s | 71.2 steps/s
[Step=13800 Epoch=67.7] | Loss=0.01847 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.508 | L2-Norm(final)=2.947 | 6019.9 samples/s | 94.1 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01600 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=2.950 | 1714.6 samples/s | 26.8 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01436 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.515 | L2-Norm(final)=2.953 | 4534.4 samples/s | 70.8 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01335 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=2.956 | 4465.7 samples/s | 69.8 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01233 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.960 | 5796.1 samples/s | 90.6 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01140 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.963 | 1699.1 samples/s | 26.5 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01080 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.966 | 4366.1 samples/s | 68.2 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01013 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=2.969 | 4073.7 samples/s | 63.7 steps/s
[Step=14200 Epoch=69.6] | Loss=0.00969 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=2.972 | 5524.5 samples/s | 86.3 steps/s
[Step=14250 Epoch=69.9] | Loss=0.00925 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=2.975 | 1744.3 samples/s | 27.3 steps/s
[Step=14300 Epoch=70.1] | Loss=0.00878 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.538 | L2-Norm(final)=2.978 | 4365.6 samples/s | 68.2 steps/s
[Step=14350 Epoch=70.4] | Loss=0.00848 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=2.981 | 4452.7 samples/s | 69.6 steps/s
[Step=14400 Epoch=70.6] | Loss=0.00818 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=2.984 | 5267.7 samples/s | 82.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=145.2] | Loss=0.06550 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.481 | L2-Norm(final)=2.945 | 3583.2 samples/s | 56.0 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00378 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=2.947 | 3821.2 samples/s | 59.7 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00199 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.950 | 5607.6 samples/s | 87.6 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00135 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=2.952 | 1642.7 samples/s | 25.7 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00102 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=2.953 | 5464.1 samples/s | 85.4 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00082 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.954 | 1674.8 samples/s | 26.2 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00069 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.955 | 5057.6 samples/s | 79.0 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00059 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.956 | 1706.3 samples/s | 26.7 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00052 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=2.957 | 4738.0 samples/s | 74.0 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=2.957 | 1761.6 samples/s | 27.5 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00042 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.958 | 4474.9 samples/s | 69.9 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.959 | 1744.7 samples/s | 27.3 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.959 | 4314.6 samples/s | 67.4 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=2.960 | 1861.3 samples/s | 29.1 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00031 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.960 | 4229.9 samples/s | 66.1 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00029 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=2.961 | 1823.5 samples/s | 28.5 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=2.961 | 4155.7 samples/s | 64.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30797 | acc=0.8293 | tpr=0.7570 | fpr=0.0136 | 3814.3 samples/s | 14.9 steps/s
Avg test loss: 0.30776, Avg test acc: 0.83308, Avg tpr: 0.76336, Avg fpr: 0.01359, total FA: 106

Testing server on iccad2012
[Step=  50] | Loss=0.31693 | acc=0.8897 | tpr=0.9779 | fpr=0.1119 | 3874.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.31688 | acc=0.8904 | tpr=0.9829 | fpr=0.1114 | 7560.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.32338 | acc=0.8903 | tpr=0.9827 | fpr=0.1114 | 7544.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.32631 | acc=0.8897 | tpr=0.9814 | fpr=0.1119 | 7811.5 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.32692 | acc=0.8890 | tpr=0.9808 | fpr=0.1127 | 7436.9 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.33021 | acc=0.8890 | tpr=0.9811 | fpr=0.1127 | 7858.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.33097 | acc=0.8891 | tpr=0.9800 | fpr=0.1125 | 7224.7 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.33165 | acc=0.8891 | tpr=0.9781 | fpr=0.1125 | 7328.2 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.33461 | acc=0.8888 | tpr=0.9776 | fpr=0.1128 | 7449.4 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.33491 | acc=0.8885 | tpr=0.9789 | fpr=0.1132 | 7465.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.33364 | acc=0.8887 | tpr=0.9781 | fpr=0.1129 | 14787.9 samples/s | 57.8 steps/s
Avg test loss: 0.33326, Avg test acc: 0.88873, Avg tpr: 0.97821, Avg fpr: 0.11289, total FA: 15675

server round 31/50

clients selected: [0 1 3 4 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=81.9] | Loss=0.19941 | Reg=0.00181 | acc=0.9062 | L2-Norm=13.464 | L2-Norm(final)=2.959 | 3622.5 samples/s | 56.6 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03634 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.954 | 4274.5 samples/s | 66.8 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02807 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=2.953 | 4453.7 samples/s | 69.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02482 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=2.953 | 4453.2 samples/s | 69.6 steps/s
[Step=17000 Epoch=82.9] | Loss=0.02292 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.490 | L2-Norm(final)=2.953 | 5838.9 samples/s | 91.2 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01978 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.954 | 1738.0 samples/s | 27.2 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01770 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=2.955 | 4443.2 samples/s | 69.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01619 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.958 | 4451.3 samples/s | 69.6 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01509 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.500 | L2-Norm(final)=2.960 | 5496.6 samples/s | 85.9 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01401 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.503 | L2-Norm(final)=2.963 | 1754.1 samples/s | 27.4 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01316 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.966 | 4419.9 samples/s | 69.1 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01247 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=2.968 | 4377.8 samples/s | 68.4 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01178 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=2.971 | 5171.0 samples/s | 80.8 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01129 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=2.974 | 1712.7 samples/s | 26.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01077 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.976 | 4079.0 samples/s | 63.7 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01021 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=2.979 | 4111.2 samples/s | 64.2 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00987 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.982 | 4528.7 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.5] | Loss=0.08008 | Reg=0.00181 | acc=0.9219 | L2-Norm=13.464 | L2-Norm(final)=2.959 | 3458.8 samples/s | 54.0 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03981 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.477 | L2-Norm(final)=2.952 | 4426.4 samples/s | 69.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02696 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=2.951 | 4489.5 samples/s | 70.1 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02397 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.485 | L2-Norm(final)=2.952 | 4503.8 samples/s | 70.4 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02085 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=2.954 | 6083.9 samples/s | 95.1 steps/s
[Step=13050 Epoch=63.7] | Loss=0.01818 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.956 | 1641.2 samples/s | 25.6 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01620 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.958 | 4229.0 samples/s | 66.1 steps/s
[Step=13150 Epoch=64.2] | Loss=0.01481 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.961 | 4494.7 samples/s | 70.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01368 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.499 | L2-Norm(final)=2.964 | 5657.8 samples/s | 88.4 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01277 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.966 | 1735.4 samples/s | 27.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01202 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.969 | 4414.7 samples/s | 69.0 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01135 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=2.972 | 4394.6 samples/s | 68.7 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01086 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.975 | 5329.6 samples/s | 83.3 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01024 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=2.977 | 1768.7 samples/s | 27.6 steps/s
[Step=13500 Epoch=65.9] | Loss=0.00986 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=2.980 | 4396.7 samples/s | 68.7 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00941 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.983 | 4348.2 samples/s | 67.9 steps/s
[Step=13600 Epoch=66.4] | Loss=0.00912 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.517 | L2-Norm(final)=2.985 | 5009.7 samples/s | 78.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.31666 | Reg=0.00181 | acc=0.8125 | L2-Norm=13.464 | L2-Norm(final)=2.959 | 3522.3 samples/s | 55.0 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03856 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.477 | L2-Norm(final)=2.953 | 4393.9 samples/s | 68.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02881 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=2.954 | 4458.0 samples/s | 69.7 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02426 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=2.954 | 4400.0 samples/s | 68.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02071 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=2.957 | 6023.6 samples/s | 94.1 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01788 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.959 | 1723.5 samples/s | 26.9 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01602 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=2.963 | 4420.0 samples/s | 69.1 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01452 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.966 | 4369.7 samples/s | 68.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01358 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.969 | 5427.1 samples/s | 84.8 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01259 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.972 | 1762.6 samples/s | 27.5 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01176 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=2.975 | 4407.8 samples/s | 68.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01109 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=2.978 | 4461.5 samples/s | 69.7 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01064 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.513 | L2-Norm(final)=2.981 | 5219.9 samples/s | 81.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01020 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.515 | L2-Norm(final)=2.984 | 1786.2 samples/s | 27.9 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00972 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=2.987 | 4468.5 samples/s | 69.8 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00939 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.520 | L2-Norm(final)=2.989 | 4361.7 samples/s | 68.2 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00908 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.992 | 4803.7 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.6] | Loss=0.26435 | Reg=0.00181 | acc=0.8438 | L2-Norm=13.464 | L2-Norm(final)=2.959 | 3644.8 samples/s | 56.9 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03777 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.473 | L2-Norm(final)=2.950 | 4145.2 samples/s | 64.8 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02817 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.479 | L2-Norm(final)=2.950 | 4455.4 samples/s | 69.6 steps/s
[Step=14550 Epoch=71.4] | Loss=0.02385 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=2.951 | 4483.8 samples/s | 70.1 steps/s
[Step=14600 Epoch=71.6] | Loss=0.02057 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=2.952 | 6148.4 samples/s | 96.1 steps/s
[Step=14650 Epoch=71.8] | Loss=0.01781 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.490 | L2-Norm(final)=2.955 | 1721.2 samples/s | 26.9 steps/s
[Step=14700 Epoch=72.1] | Loss=0.01576 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=2.957 | 4411.2 samples/s | 68.9 steps/s
[Step=14750 Epoch=72.3] | Loss=0.01441 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=2.960 | 4490.9 samples/s | 70.2 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01342 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.963 | 5812.2 samples/s | 90.8 steps/s
[Step=14850 Epoch=72.8] | Loss=0.01232 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.966 | 1669.0 samples/s | 26.1 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01150 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.970 | 4343.5 samples/s | 67.9 steps/s
[Step=14950 Epoch=73.3] | Loss=0.01090 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=2.973 | 4411.7 samples/s | 68.9 steps/s
[Step=15000 Epoch=73.6] | Loss=0.01048 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=2.976 | 5523.1 samples/s | 86.3 steps/s
[Step=15050 Epoch=73.8] | Loss=0.00992 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=2.979 | 1753.0 samples/s | 27.4 steps/s
[Step=15100 Epoch=74.0] | Loss=0.00939 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=2.982 | 4477.1 samples/s | 70.0 steps/s
[Step=15150 Epoch=74.3] | Loss=0.00907 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=2.985 | 4301.6 samples/s | 67.2 steps/s
[Step=15200 Epoch=74.5] | Loss=0.00873 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.988 | 5024.9 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8001 Epoch=76.3] | Loss=0.04264 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.464 | L2-Norm(final)=2.959 | 3668.7 samples/s | 57.3 steps/s
[Step=8050 Epoch=76.7] | Loss=0.00438 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.960 | 3861.2 samples/s | 60.3 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00229 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=2.961 | 5753.3 samples/s | 89.9 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00155 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=2.962 | 1641.8 samples/s | 25.7 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00117 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.963 | 5456.5 samples/s | 85.3 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00095 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.964 | 1697.6 samples/s | 26.5 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00079 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=2.965 | 5061.8 samples/s | 79.1 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00068 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=2.965 | 1712.2 samples/s | 26.8 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00060 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.966 | 4787.2 samples/s | 74.8 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00054 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=2.967 | 1761.3 samples/s | 27.5 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00049 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.967 | 4393.7 samples/s | 68.7 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00044 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.968 | 1811.1 samples/s | 28.3 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00041 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=2.968 | 4386.2 samples/s | 68.5 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00038 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.969 | 1837.1 samples/s | 28.7 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=2.969 | 4305.1 samples/s | 67.3 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=2.970 | 1843.3 samples/s | 28.8 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00031 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=2.970 | 4251.7 samples/s | 66.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32616 | acc=0.8223 | tpr=0.7463 | fpr=0.0129 | 3872.6 samples/s | 15.1 steps/s
Avg test loss: 0.32495, Avg test acc: 0.82727, Avg tpr: 0.75450, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.31309 | acc=0.8935 | tpr=0.9779 | fpr=0.1080 | 3927.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.31322 | acc=0.8948 | tpr=0.9829 | fpr=0.1069 | 7352.5 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.32030 | acc=0.8948 | tpr=0.9827 | fpr=0.1068 | 7630.9 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.32322 | acc=0.8945 | tpr=0.9803 | fpr=0.1070 | 7340.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.32368 | acc=0.8939 | tpr=0.9799 | fpr=0.1076 | 7388.5 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.32704 | acc=0.8938 | tpr=0.9804 | fpr=0.1078 | 7711.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.32790 | acc=0.8941 | tpr=0.9800 | fpr=0.1075 | 7505.7 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.32857 | acc=0.8939 | tpr=0.9781 | fpr=0.1076 | 7455.3 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.33160 | acc=0.8936 | tpr=0.9776 | fpr=0.1079 | 7407.9 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.33188 | acc=0.8933 | tpr=0.9789 | fpr=0.1083 | 7652.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.33051 | acc=0.8936 | tpr=0.9781 | fpr=0.1079 | 13873.7 samples/s | 54.2 steps/s
Avg test loss: 0.33013, Avg test acc: 0.89364, Avg tpr: 0.97821, Avg fpr: 0.10789, total FA: 14981

server round 32/50

clients selected: [0 1 5 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=85.8] | Loss=0.33312 | Reg=0.00181 | acc=0.8125 | L2-Norm=13.447 | L2-Norm(final)=2.980 | 3727.6 samples/s | 58.2 steps/s
[Step=17650 Epoch=86.1] | Loss=0.04651 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=2.969 | 4218.3 samples/s | 65.9 steps/s
[Step=17700 Epoch=86.3] | Loss=0.03300 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.462 | L2-Norm(final)=2.967 | 4473.7 samples/s | 69.9 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02745 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.465 | L2-Norm(final)=2.968 | 4456.8 samples/s | 69.6 steps/s
[Step=17800 Epoch=86.8] | Loss=0.02430 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.467 | L2-Norm(final)=2.968 | 5885.4 samples/s | 92.0 steps/s
[Step=17850 Epoch=87.0] | Loss=0.02058 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.470 | L2-Norm(final)=2.969 | 1728.5 samples/s | 27.0 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01848 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.972 | 4487.8 samples/s | 70.1 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01677 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=2.974 | 4484.9 samples/s | 70.1 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01550 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.479 | L2-Norm(final)=2.977 | 5620.1 samples/s | 87.8 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01436 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=2.979 | 1748.0 samples/s | 27.3 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01340 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=2.982 | 4493.9 samples/s | 70.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.01270 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=2.985 | 4540.7 samples/s | 70.9 steps/s
[Step=18200 Epoch=88.7] | Loss=0.01211 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=2.987 | 5187.1 samples/s | 81.0 steps/s
[Step=18250 Epoch=89.0] | Loss=0.01154 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.492 | L2-Norm(final)=2.990 | 1782.8 samples/s | 27.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.01105 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.993 | 4379.1 samples/s | 68.4 steps/s
[Step=18350 Epoch=89.5] | Loss=0.01049 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=2.995 | 4326.9 samples/s | 67.6 steps/s
[Step=18400 Epoch=89.7] | Loss=0.01013 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.998 | 4805.5 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.4] | Loss=0.21496 | Reg=0.00181 | acc=0.8750 | L2-Norm=13.447 | L2-Norm(final)=2.980 | 3494.4 samples/s | 54.6 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04144 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=2.972 | 4097.9 samples/s | 64.0 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02950 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.462 | L2-Norm(final)=2.971 | 4234.8 samples/s | 66.2 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02407 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.465 | L2-Norm(final)=2.972 | 4167.4 samples/s | 65.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02132 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.468 | L2-Norm(final)=2.973 | 6002.6 samples/s | 93.8 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01884 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.975 | 1667.2 samples/s | 26.0 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01668 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=2.978 | 4212.5 samples/s | 65.8 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01508 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.477 | L2-Norm(final)=2.981 | 4182.7 samples/s | 65.4 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01399 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.984 | 5526.4 samples/s | 86.4 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01295 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=2.986 | 1729.7 samples/s | 27.0 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01216 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=2.989 | 4427.7 samples/s | 69.2 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01157 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=2.992 | 4395.6 samples/s | 68.7 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01089 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.995 | 5310.9 samples/s | 83.0 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01038 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.998 | 1775.5 samples/s | 27.7 steps/s
[Step=14300 Epoch=69.8] | Loss=0.00993 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.494 | L2-Norm(final)=3.000 | 4501.7 samples/s | 70.3 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00971 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=3.003 | 4360.8 samples/s | 68.1 steps/s
[Step=14400 Epoch=70.3] | Loss=0.00931 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=3.005 | 4875.3 samples/s | 76.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=121.3] | Loss=0.01091 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.447 | L2-Norm(final)=2.981 | 3658.9 samples/s | 57.2 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00481 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.982 | 3871.8 samples/s | 60.5 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00247 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.983 | 5744.9 samples/s | 89.8 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00165 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.984 | 1660.9 samples/s | 26.0 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00125 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=2.985 | 5244.9 samples/s | 82.0 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00100 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.985 | 1677.2 samples/s | 26.2 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00084 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.986 | 4957.5 samples/s | 77.5 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00072 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=2.986 | 1700.4 samples/s | 26.6 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00063 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=2.986 | 4673.5 samples/s | 73.0 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00056 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=2.987 | 1786.2 samples/s | 27.9 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00051 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=2.987 | 4379.1 samples/s | 68.4 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=2.987 | 1821.6 samples/s | 28.5 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00043 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=2.988 | 4174.1 samples/s | 65.2 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00039 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=2.988 | 1822.6 samples/s | 28.5 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00037 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=2.988 | 4144.0 samples/s | 64.7 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00034 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=2.989 | 1825.9 samples/s | 28.5 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00032 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.989 | 4204.7 samples/s | 65.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=113.1] | Loss=0.05522 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.447 | L2-Norm(final)=2.980 | 3679.2 samples/s | 57.5 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00296 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=2.984 | 3897.8 samples/s | 60.9 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00164 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.987 | 5786.2 samples/s | 90.4 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00111 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.989 | 1672.9 samples/s | 26.1 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00084 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.990 | 5147.2 samples/s | 80.4 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00068 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=2.991 | 1712.0 samples/s | 26.7 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00057 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=2.992 | 4613.5 samples/s | 72.1 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00049 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=2.993 | 1764.3 samples/s | 27.6 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00043 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=2.993 | 4414.4 samples/s | 69.0 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00039 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=2.994 | 1833.6 samples/s | 28.6 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=2.995 | 4215.6 samples/s | 65.9 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00032 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=2.995 | 1868.4 samples/s | 29.2 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00030 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=2.996 | 4467.0 samples/s | 69.8 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.996 | 1815.4 samples/s | 28.4 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00026 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.997 | 4313.7 samples/s | 67.4 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00024 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=2.997 | 1908.6 samples/s | 29.8 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00023 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=2.998 | 4026.7 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8801 Epoch=83.9] | Loss=0.02145 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.447 | L2-Norm(final)=2.980 | 3572.6 samples/s | 55.8 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00201 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=2.985 | 3826.3 samples/s | 59.8 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00106 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.988 | 5851.6 samples/s | 91.4 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00072 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=2.990 | 1649.0 samples/s | 25.8 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00055 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=2.991 | 5226.4 samples/s | 81.7 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00045 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.992 | 1648.5 samples/s | 25.8 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00038 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=2.993 | 5028.4 samples/s | 78.6 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=2.994 | 1693.3 samples/s | 26.5 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00029 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=2.994 | 4780.4 samples/s | 74.7 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00026 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=2.995 | 1763.1 samples/s | 27.5 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00023 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.996 | 4555.7 samples/s | 71.2 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00021 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.996 | 1764.6 samples/s | 27.6 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00020 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=2.997 | 4251.4 samples/s | 66.4 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00018 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=2.997 | 1815.7 samples/s | 28.4 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00017 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=2.998 | 4311.4 samples/s | 67.4 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00016 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=2.998 | 1865.7 samples/s | 29.2 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00015 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=2.999 | 4323.9 samples/s | 67.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30347 | acc=0.8348 | tpr=0.7643 | fpr=0.0119 | 3831.5 samples/s | 15.0 steps/s
Avg test loss: 0.30326, Avg test acc: 0.83889, Avg tpr: 0.77129, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.34138 | acc=0.8830 | tpr=0.9823 | fpr=0.1187 | 3939.2 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.34134 | acc=0.8839 | tpr=0.9851 | fpr=0.1179 | 7840.7 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.34795 | acc=0.8843 | tpr=0.9841 | fpr=0.1176 | 7445.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.35059 | acc=0.8837 | tpr=0.9803 | fpr=0.1181 | 7459.6 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.35130 | acc=0.8828 | tpr=0.9790 | fpr=0.1189 | 7750.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.35469 | acc=0.8829 | tpr=0.9796 | fpr=0.1189 | 7425.4 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.35536 | acc=0.8831 | tpr=0.9787 | fpr=0.1187 | 7862.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.35582 | acc=0.8830 | tpr=0.9765 | fpr=0.1187 | 7703.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.35893 | acc=0.8827 | tpr=0.9761 | fpr=0.1190 | 7096.6 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.35929 | acc=0.8824 | tpr=0.9771 | fpr=0.1194 | 7234.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.35785 | acc=0.8825 | tpr=0.9761 | fpr=0.1192 | 13317.5 samples/s | 52.0 steps/s
Avg test loss: 0.35746, Avg test acc: 0.88260, Avg tpr: 0.97623, Avg fpr: 0.11910, total FA: 16537

server round 33/50

clients selected: [0 1 2 4 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=89.7] | Loss=0.22849 | Reg=0.00181 | acc=0.8594 | L2-Norm=13.443 | L2-Norm(final)=2.998 | 3597.2 samples/s | 56.2 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03213 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.456 | L2-Norm(final)=2.996 | 4376.3 samples/s | 68.4 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02402 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.996 | 4436.0 samples/s | 69.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02162 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.465 | L2-Norm(final)=2.996 | 4408.3 samples/s | 68.9 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01941 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.998 | 6011.8 samples/s | 93.9 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01695 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.999 | 1689.2 samples/s | 26.4 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01519 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=3.002 | 4477.0 samples/s | 70.0 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01417 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=3.004 | 4368.6 samples/s | 68.3 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01302 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=3.007 | 5537.3 samples/s | 86.5 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01210 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=3.009 | 1755.8 samples/s | 27.4 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01151 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=3.012 | 4268.0 samples/s | 66.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01092 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=3.014 | 4470.8 samples/s | 69.9 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=3.017 | 5196.0 samples/s | 81.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00992 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=3.019 | 1753.3 samples/s | 27.4 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00949 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=3.022 | 4086.4 samples/s | 63.8 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00911 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=3.024 | 4224.2 samples/s | 66.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00897 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=3.027 | 4721.5 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.3] | Loss=0.29829 | Reg=0.00181 | acc=0.8281 | L2-Norm=13.443 | L2-Norm(final)=2.998 | 3544.1 samples/s | 55.4 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04138 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.459 | L2-Norm(final)=2.990 | 4187.4 samples/s | 65.4 steps/s
[Step=14500 Epoch=70.8] | Loss=0.03062 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.464 | L2-Norm(final)=2.987 | 4449.8 samples/s | 69.5 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02471 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=2.986 | 4449.4 samples/s | 69.5 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02101 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.987 | 5956.3 samples/s | 93.1 steps/s
[Step=14650 Epoch=71.5] | Loss=0.01792 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.989 | 1714.7 samples/s | 26.8 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01597 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=2.992 | 4444.5 samples/s | 69.4 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01460 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=2.994 | 4359.4 samples/s | 68.1 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01354 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.997 | 5628.0 samples/s | 87.9 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01247 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=3.000 | 1739.2 samples/s | 27.2 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01175 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.484 | L2-Norm(final)=3.002 | 4476.7 samples/s | 69.9 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01115 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=3.005 | 4439.3 samples/s | 69.4 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01075 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=3.007 | 5237.0 samples/s | 81.8 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01023 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=3.010 | 1775.2 samples/s | 27.7 steps/s
[Step=15100 Epoch=73.7] | Loss=0.00976 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=3.012 | 4422.6 samples/s | 69.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00932 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.494 | L2-Norm(final)=3.014 | 4420.5 samples/s | 69.1 steps/s
[Step=15200 Epoch=74.2] | Loss=0.00910 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.496 | L2-Norm(final)=3.016 | 5118.5 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=50.7] | Loss=0.22414 | Reg=0.00181 | acc=0.8750 | L2-Norm=13.443 | L2-Norm(final)=2.998 | 3524.3 samples/s | 55.1 steps/s
[Step=10450 Epoch=50.9] | Loss=0.03845 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.455 | L2-Norm(final)=2.991 | 4116.4 samples/s | 64.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02779 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.461 | L2-Norm(final)=2.991 | 4404.3 samples/s | 68.8 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02302 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.466 | L2-Norm(final)=2.991 | 4428.6 samples/s | 69.2 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.992 | 5948.3 samples/s | 92.9 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01812 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.472 | L2-Norm(final)=2.994 | 1707.0 samples/s | 26.7 steps/s
[Step=10700 Epoch=52.1] | Loss=0.01602 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.474 | L2-Norm(final)=2.996 | 4387.4 samples/s | 68.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01484 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.477 | L2-Norm(final)=2.999 | 4287.3 samples/s | 67.0 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01378 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=3.001 | 5509.4 samples/s | 86.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01280 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=3.004 | 1731.6 samples/s | 27.1 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01188 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=3.006 | 4296.1 samples/s | 67.1 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01138 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=3.009 | 4441.8 samples/s | 69.4 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01090 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=3.012 | 5149.2 samples/s | 80.5 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01037 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=3.015 | 1797.1 samples/s | 28.1 steps/s
[Step=11100 Epoch=54.1] | Loss=0.00995 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=3.017 | 4460.6 samples/s | 69.7 steps/s
[Step=11150 Epoch=54.3] | Loss=0.00952 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=3.020 | 4409.8 samples/s | 68.9 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00926 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.499 | L2-Norm(final)=3.023 | 4850.5 samples/s | 75.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step11200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.5] | Loss=0.24200 | Reg=0.00181 | acc=0.8594 | L2-Norm=13.443 | L2-Norm(final)=2.998 | 3602.9 samples/s | 56.3 steps/s
[Step=15250 Epoch=74.8] | Loss=0.03823 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=2.990 | 4332.1 samples/s | 67.7 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02797 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.464 | L2-Norm(final)=2.989 | 4487.5 samples/s | 70.1 steps/s
[Step=15350 Epoch=75.3] | Loss=0.02367 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=2.989 | 4425.0 samples/s | 69.1 steps/s
[Step=15400 Epoch=75.5] | Loss=0.02122 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.470 | L2-Norm(final)=2.990 | 5939.7 samples/s | 92.8 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01830 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.473 | L2-Norm(final)=2.992 | 1729.2 samples/s | 27.0 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01606 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=2.995 | 4500.9 samples/s | 70.3 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01466 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.479 | L2-Norm(final)=2.997 | 4341.5 samples/s | 67.8 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01340 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=3.000 | 5767.4 samples/s | 90.1 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01235 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=3.003 | 1718.9 samples/s | 26.9 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01164 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=3.006 | 4494.1 samples/s | 70.2 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01090 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=3.009 | 4500.2 samples/s | 70.3 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01040 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.493 | L2-Norm(final)=3.012 | 5502.6 samples/s | 86.0 steps/s
[Step=15850 Epoch=77.7] | Loss=0.00987 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.495 | L2-Norm(final)=3.015 | 1751.2 samples/s | 27.4 steps/s
[Step=15900 Epoch=78.0] | Loss=0.00949 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=3.017 | 4820.6 samples/s | 75.3 steps/s
[Step=15950 Epoch=78.2] | Loss=0.00905 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.500 | L2-Norm(final)=3.020 | 4500.5 samples/s | 70.3 steps/s
[Step=16000 Epoch=78.5] | Loss=0.00871 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=3.023 | 5283.0 samples/s | 82.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=120.6] | Loss=0.03158 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.443 | L2-Norm(final)=2.998 | 3728.0 samples/s | 58.2 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00504 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.997 | 3768.0 samples/s | 58.9 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00261 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.998 | 5807.8 samples/s | 90.7 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00178 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=3.000 | 1658.5 samples/s | 25.9 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00134 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=3.001 | 5233.9 samples/s | 81.8 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00108 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=3.002 | 1730.9 samples/s | 27.0 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00091 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=3.002 | 4688.0 samples/s | 73.3 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00078 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=3.003 | 1746.4 samples/s | 27.3 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00069 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=3.003 | 4353.5 samples/s | 68.0 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=3.004 | 1809.5 samples/s | 28.3 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00055 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.005 | 4274.7 samples/s | 66.8 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00051 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=3.005 | 1857.1 samples/s | 29.0 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00047 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.006 | 4312.6 samples/s | 67.4 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00043 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.006 | 1813.6 samples/s | 28.3 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00040 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.006 | 4101.6 samples/s | 64.1 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00038 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=3.007 | 2025.8 samples/s | 31.7 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=3.007 | 3613.8 samples/s | 56.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31404 | acc=0.8320 | tpr=0.7596 | fpr=0.0109 | 3746.4 samples/s | 14.6 steps/s
Avg test loss: 0.31324, Avg test acc: 0.83448, Avg tpr: 0.76453, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.33425 | acc=0.8881 | tpr=0.9779 | fpr=0.1135 | 3846.0 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.33419 | acc=0.8884 | tpr=0.9829 | fpr=0.1134 | 8041.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.34098 | acc=0.8886 | tpr=0.9827 | fpr=0.1131 | 7367.8 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.34332 | acc=0.8885 | tpr=0.9792 | fpr=0.1131 | 7784.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.34378 | acc=0.8875 | tpr=0.9782 | fpr=0.1141 | 7891.1 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.34725 | acc=0.8875 | tpr=0.9789 | fpr=0.1142 | 7172.2 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.34799 | acc=0.8877 | tpr=0.9781 | fpr=0.1139 | 7550.4 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.34842 | acc=0.8876 | tpr=0.9759 | fpr=0.1140 | 7761.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.35146 | acc=0.8873 | tpr=0.9757 | fpr=0.1143 | 7500.6 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.35174 | acc=0.8870 | tpr=0.9767 | fpr=0.1146 | 7209.6 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.35035 | acc=0.8871 | tpr=0.9761 | fpr=0.1145 | 13791.0 samples/s | 53.9 steps/s
Avg test loss: 0.34995, Avg test acc: 0.88718, Avg tpr: 0.97623, Avg fpr: 0.11444, total FA: 15890

server round 34/50

clients selected: [1 2 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.2] | Loss=0.12566 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.437 | L2-Norm(final)=3.010 | 3483.7 samples/s | 54.4 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03909 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.447 | L2-Norm(final)=3.001 | 4484.3 samples/s | 70.1 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02909 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.000 | 4457.7 samples/s | 69.7 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02328 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.000 | 4493.7 samples/s | 70.2 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02016 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.002 | 5905.3 samples/s | 92.3 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01713 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.462 | L2-Norm(final)=3.004 | 1706.5 samples/s | 26.7 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01527 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=3.007 | 4525.6 samples/s | 70.7 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01416 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=3.009 | 4413.9 samples/s | 69.0 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01324 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=3.012 | 5628.1 samples/s | 87.9 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01218 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.472 | L2-Norm(final)=3.015 | 1686.5 samples/s | 26.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01142 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=3.017 | 4317.2 samples/s | 67.5 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01069 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=3.020 | 4398.8 samples/s | 68.7 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01026 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.479 | L2-Norm(final)=3.023 | 5256.3 samples/s | 82.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00975 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=3.025 | 1756.9 samples/s | 27.5 steps/s
[Step=15900 Epoch=77.6] | Loss=0.00946 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=3.028 | 4446.2 samples/s | 69.5 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00904 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=3.030 | 4462.1 samples/s | 69.7 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00868 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=3.033 | 4941.5 samples/s | 77.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.25120 | Reg=0.00181 | acc=0.8125 | L2-Norm=13.437 | L2-Norm(final)=3.010 | 3733.4 samples/s | 58.3 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04558 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.450 | L2-Norm(final)=3.000 | 4123.3 samples/s | 64.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03034 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=2.999 | 4255.8 samples/s | 66.5 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02441 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.001 | 4257.6 samples/s | 66.5 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02120 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=3.003 | 5997.0 samples/s | 93.7 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01851 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=3.005 | 1715.6 samples/s | 26.8 steps/s
[Step=11500 Epoch=56.0] | Loss=0.01646 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=3.008 | 4442.0 samples/s | 69.4 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01499 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=3.011 | 4462.0 samples/s | 69.7 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01401 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=3.014 | 5593.2 samples/s | 87.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01308 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=3.017 | 1746.2 samples/s | 27.3 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01222 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.481 | L2-Norm(final)=3.020 | 4484.6 samples/s | 70.1 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01155 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=3.023 | 4382.9 samples/s | 68.5 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01098 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=3.026 | 4948.8 samples/s | 77.3 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01054 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=3.028 | 1798.3 samples/s | 28.1 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01005 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=3.031 | 4402.8 samples/s | 68.8 steps/s
[Step=11950 Epoch=58.2] | Loss=0.00964 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=3.034 | 4422.8 samples/s | 69.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00932 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=3.036 | 4726.0 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=128.9] | Loss=0.12545 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.437 | L2-Norm(final)=3.010 | 3669.3 samples/s | 57.3 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00559 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.008 | 3820.1 samples/s | 59.7 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00291 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=3.009 | 5589.1 samples/s | 87.3 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00196 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=3.010 | 1681.5 samples/s | 26.3 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00148 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.011 | 5222.3 samples/s | 81.6 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00119 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.012 | 1705.1 samples/s | 26.6 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00100 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.012 | 4825.4 samples/s | 75.4 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00086 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.013 | 1762.3 samples/s | 27.5 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00076 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=3.013 | 4630.8 samples/s | 72.4 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00067 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=3.014 | 1767.2 samples/s | 27.6 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=3.014 | 4226.1 samples/s | 66.0 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00056 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=3.015 | 1799.7 samples/s | 28.1 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00051 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=3.015 | 4348.5 samples/s | 67.9 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00047 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.015 | 1843.4 samples/s | 28.8 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00044 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=3.016 | 4158.9 samples/s | 65.0 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00041 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.016 | 1848.5 samples/s | 28.9 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00039 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.016 | 3944.6 samples/s | 61.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=7201 Epoch=68.5] | Loss=0.01125 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.437 | L2-Norm(final)=3.010 | 3555.2 samples/s | 55.6 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00288 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=3.011 | 3745.3 samples/s | 58.5 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00148 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=3.012 | 5814.8 samples/s | 90.9 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00102 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=3.013 | 1658.4 samples/s | 25.9 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00078 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=3.014 | 5274.9 samples/s | 82.4 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00063 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.014 | 1715.4 samples/s | 26.8 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00053 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=3.015 | 4989.9 samples/s | 78.0 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.015 | 1748.2 samples/s | 27.3 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00040 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.016 | 4522.5 samples/s | 70.7 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00036 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.016 | 1806.0 samples/s | 28.2 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=3.016 | 4232.7 samples/s | 66.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00030 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=3.017 | 1846.5 samples/s | 28.9 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=3.017 | 4188.0 samples/s | 65.4 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00025 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=3.018 | 1875.0 samples/s | 29.3 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00024 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=3.018 | 4277.2 samples/s | 66.8 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00022 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=3.018 | 1842.7 samples/s | 28.8 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00021 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.019 | 4145.6 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=152.8] | Loss=0.02825 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.437 | L2-Norm(final)=3.010 | 3576.3 samples/s | 55.9 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00259 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.015 | 3901.6 samples/s | 61.0 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00134 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.017 | 5808.9 samples/s | 90.8 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00091 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=3.019 | 1673.9 samples/s | 26.2 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00069 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.020 | 5340.8 samples/s | 83.5 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00055 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.021 | 1678.2 samples/s | 26.2 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.021 | 5162.0 samples/s | 80.7 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00040 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.022 | 1720.7 samples/s | 26.9 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=3.022 | 4729.3 samples/s | 73.9 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00031 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=3.023 | 1761.0 samples/s | 27.5 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00028 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.023 | 4542.0 samples/s | 71.0 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00026 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=3.023 | 1799.3 samples/s | 28.1 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00024 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.024 | 4273.5 samples/s | 66.8 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00022 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.024 | 1829.8 samples/s | 28.6 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00021 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.025 | 4337.9 samples/s | 67.8 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00019 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=3.025 | 1831.2 samples/s | 28.6 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00018 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.025 | 4180.4 samples/s | 65.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29759 | acc=0.8423 | tpr=0.7741 | fpr=0.0094 | 3906.8 samples/s | 15.3 steps/s
Avg test loss: 0.29794, Avg test acc: 0.84478, Avg tpr: 0.77904, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.35861 | acc=0.8801 | tpr=0.9735 | fpr=0.1216 | 3881.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.35953 | acc=0.8805 | tpr=0.9808 | fpr=0.1214 | 7671.7 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.36636 | acc=0.8810 | tpr=0.9798 | fpr=0.1209 | 7302.2 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.36881 | acc=0.8809 | tpr=0.9770 | fpr=0.1209 | 7449.3 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.36958 | acc=0.8799 | tpr=0.9764 | fpr=0.1219 | 7459.2 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.37320 | acc=0.8798 | tpr=0.9775 | fpr=0.1220 | 7463.5 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.37385 | acc=0.8801 | tpr=0.9768 | fpr=0.1216 | 7476.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.37432 | acc=0.8800 | tpr=0.9743 | fpr=0.1217 | 7473.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.37750 | acc=0.8798 | tpr=0.9752 | fpr=0.1219 | 7395.4 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.37786 | acc=0.8796 | tpr=0.9767 | fpr=0.1222 | 7606.9 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.37648 | acc=0.8797 | tpr=0.9753 | fpr=0.1220 | 13772.9 samples/s | 53.8 steps/s
Avg test loss: 0.37608, Avg test acc: 0.87973, Avg tpr: 0.97504, Avg fpr: 0.12200, total FA: 16940

server round 35/50

clients selected: [3 4 7 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.2] | Loss=0.30214 | Reg=0.00180 | acc=0.8125 | L2-Norm=13.418 | L2-Norm(final)=3.040 | 3828.3 samples/s | 59.8 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03758 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.034 | 3976.3 samples/s | 62.1 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02779 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.436 | L2-Norm(final)=3.033 | 4336.6 samples/s | 67.8 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02244 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=3.034 | 4517.6 samples/s | 70.6 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01929 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.443 | L2-Norm(final)=3.035 | 5993.6 samples/s | 93.6 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01652 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=3.037 | 1727.8 samples/s | 27.0 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01476 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.039 | 4443.9 samples/s | 69.4 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01343 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=3.042 | 4397.3 samples/s | 68.7 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01248 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.044 | 5367.7 samples/s | 83.9 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01152 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.047 | 1771.2 samples/s | 27.7 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01069 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.050 | 4488.5 samples/s | 70.1 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00999 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=3.052 | 4371.5 samples/s | 68.3 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00960 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.463 | L2-Norm(final)=3.055 | 4982.4 samples/s | 77.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00913 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=3.057 | 1749.3 samples/s | 27.3 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00877 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=3.060 | 4312.8 samples/s | 67.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00849 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=3.062 | 4469.0 samples/s | 69.8 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00821 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=3.064 | 4860.1 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.5] | Loss=0.08879 | Reg=0.00180 | acc=0.9219 | L2-Norm=13.418 | L2-Norm(final)=3.040 | 3453.2 samples/s | 54.0 steps/s
[Step=16050 Epoch=78.7] | Loss=0.02810 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.435 | L2-Norm(final)=3.037 | 4348.6 samples/s | 67.9 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02197 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.441 | L2-Norm(final)=3.037 | 4445.5 samples/s | 69.5 steps/s
[Step=16150 Epoch=79.2] | Loss=0.01899 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.037 | 4491.2 samples/s | 70.2 steps/s
[Step=16200 Epoch=79.4] | Loss=0.01751 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.448 | L2-Norm(final)=3.038 | 5887.4 samples/s | 92.0 steps/s
[Step=16250 Epoch=79.7] | Loss=0.01528 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=3.040 | 1663.7 samples/s | 26.0 steps/s
[Step=16300 Epoch=79.9] | Loss=0.01365 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.042 | 4391.7 samples/s | 68.6 steps/s
[Step=16350 Epoch=80.2] | Loss=0.01253 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.045 | 4383.6 samples/s | 68.5 steps/s
[Step=16400 Epoch=80.4] | Loss=0.01147 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.047 | 5797.9 samples/s | 90.6 steps/s
[Step=16450 Epoch=80.7] | Loss=0.01060 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=3.050 | 1737.0 samples/s | 27.1 steps/s
[Step=16500 Epoch=80.9] | Loss=0.00999 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=3.052 | 4379.7 samples/s | 68.4 steps/s
[Step=16550 Epoch=81.2] | Loss=0.00939 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.466 | L2-Norm(final)=3.055 | 4338.0 samples/s | 67.8 steps/s
[Step=16600 Epoch=81.4] | Loss=0.00903 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=3.058 | 5340.8 samples/s | 83.5 steps/s
[Step=16650 Epoch=81.6] | Loss=0.00862 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=3.060 | 1729.1 samples/s | 27.0 steps/s
[Step=16700 Epoch=81.9] | Loss=0.00831 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=3.063 | 4427.7 samples/s | 69.2 steps/s
[Step=16750 Epoch=82.1] | Loss=0.00803 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=3.065 | 4409.3 samples/s | 68.9 steps/s
[Step=16800 Epoch=82.4] | Loss=0.00778 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=3.068 | 5240.9 samples/s | 81.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=160.4] | Loss=0.02249 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=3.040 | 3554.9 samples/s | 55.5 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00235 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=3.043 | 4093.9 samples/s | 64.0 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00123 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=3.046 | 5816.0 samples/s | 90.9 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00083 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=3.047 | 1647.0 samples/s | 25.7 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00063 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=3.048 | 5406.4 samples/s | 84.5 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00051 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.049 | 1676.1 samples/s | 26.2 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00043 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.050 | 4915.9 samples/s | 76.8 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00037 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=3.051 | 1712.0 samples/s | 26.8 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00032 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.051 | 4740.2 samples/s | 74.1 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00029 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.052 | 1772.6 samples/s | 27.7 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00026 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.052 | 4539.3 samples/s | 70.9 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00024 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.053 | 1828.6 samples/s | 28.6 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00022 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.053 | 4316.0 samples/s | 67.4 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00020 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=3.054 | 1783.5 samples/s | 27.9 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=3.054 | 4259.4 samples/s | 66.6 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00018 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=3.054 | 1813.5 samples/s | 28.3 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00017 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=3.055 | 4231.1 samples/s | 66.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=128.2] | Loss=0.03202 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.418 | L2-Norm(final)=3.040 | 3668.8 samples/s | 57.3 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00529 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.040 | 3921.4 samples/s | 61.3 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00273 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=3.042 | 5687.3 samples/s | 88.9 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00184 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.043 | 1652.8 samples/s | 25.8 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00139 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.044 | 5209.7 samples/s | 81.4 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00111 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.044 | 1658.5 samples/s | 25.9 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00093 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=3.045 | 4647.2 samples/s | 72.6 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00080 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=3.045 | 1730.5 samples/s | 27.0 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00071 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=3.046 | 4427.9 samples/s | 69.2 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00063 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=3.046 | 1832.9 samples/s | 28.6 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00057 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=3.047 | 4321.9 samples/s | 67.5 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00052 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=3.047 | 1861.3 samples/s | 29.1 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00048 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.048 | 4156.8 samples/s | 65.0 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00044 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.048 | 1889.8 samples/s | 29.5 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00041 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.048 | 4307.7 samples/s | 67.3 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00038 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.049 | 1987.7 samples/s | 31.1 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00036 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.049 | 3628.6 samples/s | 56.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=91.5] | Loss=0.01436 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=3.040 | 3501.9 samples/s | 54.7 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00209 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.044 | 3851.0 samples/s | 60.2 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00110 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=3.047 | 5852.5 samples/s | 91.4 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00074 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=3.049 | 1656.0 samples/s | 25.9 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.050 | 5496.6 samples/s | 85.9 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00046 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.051 | 1708.8 samples/s | 26.7 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00038 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=3.052 | 5177.1 samples/s | 80.9 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00033 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.053 | 1737.1 samples/s | 27.1 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00029 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.053 | 4822.6 samples/s | 75.4 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00026 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.054 | 1759.4 samples/s | 27.5 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00024 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.054 | 4433.6 samples/s | 69.3 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00022 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=3.055 | 1818.5 samples/s | 28.4 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00020 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.055 | 4341.0 samples/s | 67.8 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=3.056 | 1835.4 samples/s | 28.7 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00017 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=3.056 | 4287.8 samples/s | 67.0 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00016 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.057 | 1843.9 samples/s | 28.8 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00015 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.057 | 4188.2 samples/s | 65.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29663 | acc=0.8439 | tpr=0.7764 | fpr=0.0094 | 3864.6 samples/s | 15.1 steps/s
Avg test loss: 0.29681, Avg test acc: 0.84630, Avg tpr: 0.78137, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.35902 | acc=0.8820 | tpr=0.9735 | fpr=0.1196 | 3767.7 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.35977 | acc=0.8817 | tpr=0.9808 | fpr=0.1201 | 7633.3 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.36673 | acc=0.8822 | tpr=0.9827 | fpr=0.1197 | 7665.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.36938 | acc=0.8821 | tpr=0.9792 | fpr=0.1197 | 7510.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.37010 | acc=0.8810 | tpr=0.9782 | fpr=0.1208 | 7501.5 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.37370 | acc=0.8808 | tpr=0.9789 | fpr=0.1210 | 7719.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.37440 | acc=0.8810 | tpr=0.9781 | fpr=0.1207 | 7670.9 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.37489 | acc=0.8811 | tpr=0.9754 | fpr=0.1207 | 7741.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.37817 | acc=0.8808 | tpr=0.9761 | fpr=0.1209 | 6936.5 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.37849 | acc=0.8807 | tpr=0.9771 | fpr=0.1210 | 7893.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.37706 | acc=0.8809 | tpr=0.9757 | fpr=0.1208 | 12667.8 samples/s | 49.5 steps/s
Avg test loss: 0.37667, Avg test acc: 0.88095, Avg tpr: 0.97544, Avg fpr: 0.12077, total FA: 16769

server round 36/50

clients selected: [0 1 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=19201 Epoch=93.6] | Loss=0.16109 | Reg=0.00180 | acc=0.9219 | L2-Norm=13.403 | L2-Norm(final)=3.063 | 3594.1 samples/s | 56.2 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03265 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.418 | L2-Norm(final)=3.060 | 4048.2 samples/s | 63.3 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02257 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.060 | 4389.1 samples/s | 68.6 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01981 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.426 | L2-Norm(final)=3.060 | 4477.6 samples/s | 70.0 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01792 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.062 | 5971.9 samples/s | 93.3 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01576 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.064 | 1716.7 samples/s | 26.8 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01420 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.435 | L2-Norm(final)=3.066 | 4511.9 samples/s | 70.5 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01317 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=3.068 | 4494.1 samples/s | 70.2 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01240 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.441 | L2-Norm(final)=3.070 | 5543.9 samples/s | 86.6 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01158 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=3.073 | 1776.8 samples/s | 27.8 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01078 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=3.075 | 4474.3 samples/s | 69.9 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01022 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.077 | 4396.6 samples/s | 68.7 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00970 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=3.080 | 5254.7 samples/s | 82.1 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00930 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=3.082 | 1818.5 samples/s | 28.4 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00897 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.455 | L2-Norm(final)=3.084 | 4470.0 samples/s | 69.8 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00863 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.457 | L2-Norm(final)=3.087 | 4266.6 samples/s | 66.7 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00840 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=3.089 | 4629.3 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.1] | Loss=0.18273 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.403 | L2-Norm(final)=3.063 | 3455.1 samples/s | 54.0 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03284 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.059 | 4224.4 samples/s | 66.0 steps/s
[Step=16100 Epoch=78.6] | Loss=0.02445 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.423 | L2-Norm(final)=3.058 | 4460.3 samples/s | 69.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02066 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.058 | 4477.2 samples/s | 70.0 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01892 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=3.060 | 6085.0 samples/s | 95.1 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01651 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.061 | 1724.1 samples/s | 26.9 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01466 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.435 | L2-Norm(final)=3.063 | 4391.3 samples/s | 68.6 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01341 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.438 | L2-Norm(final)=3.066 | 4217.8 samples/s | 65.9 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01232 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.440 | L2-Norm(final)=3.068 | 5678.8 samples/s | 88.7 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01141 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=3.071 | 1739.8 samples/s | 27.2 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01062 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.073 | 4478.6 samples/s | 70.0 steps/s
[Step=16550 Epoch=80.8] | Loss=0.01019 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.447 | L2-Norm(final)=3.076 | 4446.3 samples/s | 69.5 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00969 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=3.078 | 5272.4 samples/s | 82.4 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00932 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=3.080 | 1736.3 samples/s | 27.1 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00892 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=3.083 | 4306.4 samples/s | 67.3 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00843 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=3.085 | 4480.0 samples/s | 70.0 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00820 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.456 | L2-Norm(final)=3.087 | 5069.2 samples/s | 79.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.1] | Loss=0.13828 | Reg=0.00180 | acc=0.8750 | L2-Norm=13.403 | L2-Norm(final)=3.063 | 3550.0 samples/s | 55.5 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02667 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.417 | L2-Norm(final)=3.063 | 4332.3 samples/s | 67.7 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02041 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.063 | 4480.8 samples/s | 70.0 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01728 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.428 | L2-Norm(final)=3.065 | 4456.4 samples/s | 69.6 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01596 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.432 | L2-Norm(final)=3.067 | 6010.0 samples/s | 93.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01389 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.069 | 1727.8 samples/s | 27.0 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01262 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=3.072 | 4511.3 samples/s | 70.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01183 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=3.074 | 4232.4 samples/s | 66.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01097 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=3.077 | 5488.8 samples/s | 85.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01019 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.079 | 1765.2 samples/s | 27.6 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00966 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=3.082 | 4312.6 samples/s | 67.4 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00918 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.450 | L2-Norm(final)=3.084 | 4298.2 samples/s | 67.2 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00871 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=3.087 | 5103.6 samples/s | 79.7 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00826 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=3.089 | 1801.9 samples/s | 28.2 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00785 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=3.092 | 4217.7 samples/s | 65.9 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00760 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=3.094 | 4476.8 samples/s | 70.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00740 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=3.096 | 4918.0 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=136.5] | Loss=0.10573 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.403 | L2-Norm(final)=3.063 | 3567.1 samples/s | 55.7 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00472 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.063 | 3972.9 samples/s | 62.1 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00241 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.063 | 5795.1 samples/s | 90.5 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00163 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=3.064 | 1641.1 samples/s | 25.6 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00123 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.065 | 5253.4 samples/s | 82.1 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00099 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.065 | 1727.5 samples/s | 27.0 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00083 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.066 | 4942.4 samples/s | 77.2 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00071 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.066 | 1760.6 samples/s | 27.5 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00063 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=3.067 | 4299.2 samples/s | 67.2 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=3.067 | 1809.3 samples/s | 28.3 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00050 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.068 | 4196.8 samples/s | 65.6 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00046 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.068 | 1798.4 samples/s | 28.1 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00042 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.068 | 4377.0 samples/s | 68.4 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00039 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.069 | 1844.8 samples/s | 28.8 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00036 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=3.069 | 4402.1 samples/s | 68.8 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00034 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=3.069 | 1818.3 samples/s | 28.4 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00032 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=3.070 | 4361.0 samples/s | 68.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=135.7] | Loss=0.01281 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.403 | L2-Norm(final)=3.064 | 3707.3 samples/s | 57.9 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00513 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.063 | 3990.6 samples/s | 62.4 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00280 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.064 | 5480.3 samples/s | 85.6 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00190 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.066 | 1688.0 samples/s | 26.4 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00143 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.067 | 5185.8 samples/s | 81.0 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00115 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.067 | 1719.7 samples/s | 26.9 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00097 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.068 | 4734.5 samples/s | 74.0 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00083 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.068 | 1743.0 samples/s | 27.2 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00073 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.069 | 4293.0 samples/s | 67.1 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00065 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=3.069 | 1818.0 samples/s | 28.4 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00059 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.070 | 4343.7 samples/s | 67.9 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00054 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.070 | 1823.6 samples/s | 28.5 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00049 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.071 | 4096.5 samples/s | 64.0 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00046 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.071 | 1850.9 samples/s | 28.9 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00043 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.071 | 4263.7 samples/s | 66.6 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00040 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.072 | 1892.7 samples/s | 29.6 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00037 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.072 | 4132.2 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30261 | acc=0.8441 | tpr=0.7766 | fpr=0.0092 | 3998.3 samples/s | 15.6 steps/s
Avg test loss: 0.30224, Avg test acc: 0.84586, Avg tpr: 0.78050, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.35746 | acc=0.8827 | tpr=0.9735 | fpr=0.1189 | 3998.8 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.35773 | acc=0.8832 | tpr=0.9808 | fpr=0.1186 | 7308.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.36502 | acc=0.8836 | tpr=0.9798 | fpr=0.1182 | 7455.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.36769 | acc=0.8835 | tpr=0.9770 | fpr=0.1182 | 7612.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.36833 | acc=0.8825 | tpr=0.9764 | fpr=0.1192 | 7370.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.37201 | acc=0.8822 | tpr=0.9767 | fpr=0.1195 | 7225.2 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.37265 | acc=0.8825 | tpr=0.9762 | fpr=0.1192 | 7453.8 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.37313 | acc=0.8825 | tpr=0.9737 | fpr=0.1192 | 7795.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.37649 | acc=0.8823 | tpr=0.9747 | fpr=0.1194 | 7364.0 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.37682 | acc=0.8821 | tpr=0.9758 | fpr=0.1196 | 7386.0 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.37532 | acc=0.8823 | tpr=0.9745 | fpr=0.1194 | 13752.0 samples/s | 53.7 steps/s
Avg test loss: 0.37494, Avg test acc: 0.88230, Avg tpr: 0.97464, Avg fpr: 0.11938, total FA: 16576

server round 37/50

clients selected: [2 3 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.14280 | Reg=0.00179 | acc=0.8750 | L2-Norm=13.390 | L2-Norm(final)=3.086 | 3636.0 samples/s | 56.8 steps/s
[Step=12050 Epoch=58.7] | Loss=0.03209 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.405 | L2-Norm(final)=3.082 | 4270.0 samples/s | 66.7 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02679 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.079 | 4480.3 samples/s | 70.0 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02242 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.079 | 4297.0 samples/s | 67.1 steps/s
[Step=12200 Epoch=59.4] | Loss=0.01897 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.079 | 6038.5 samples/s | 94.4 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01699 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=3.081 | 1667.3 samples/s | 26.1 steps/s
[Step=12300 Epoch=59.9] | Loss=0.01528 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.419 | L2-Norm(final)=3.082 | 4371.0 samples/s | 68.3 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01405 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=3.084 | 4442.9 samples/s | 69.4 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01302 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.086 | 5192.2 samples/s | 81.1 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01206 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.088 | 1749.5 samples/s | 27.3 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01137 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.091 | 4461.3 samples/s | 69.7 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01078 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.093 | 4373.3 samples/s | 68.3 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01034 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.433 | L2-Norm(final)=3.095 | 5124.2 samples/s | 80.1 steps/s
[Step=12650 Epoch=61.6] | Loss=0.00985 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.097 | 1784.0 samples/s | 27.9 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00943 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.437 | L2-Norm(final)=3.100 | 4347.0 samples/s | 67.9 steps/s
[Step=12750 Epoch=62.1] | Loss=0.00913 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=3.102 | 4377.6 samples/s | 68.4 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00884 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=3.104 | 4850.3 samples/s | 75.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.12647 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.390 | L2-Norm(final)=3.085 | 3564.4 samples/s | 55.7 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03685 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.078 | 4308.9 samples/s | 67.3 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02450 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.077 | 4502.1 samples/s | 70.3 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02068 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.412 | L2-Norm(final)=3.079 | 4363.1 samples/s | 68.2 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01750 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.081 | 5745.8 samples/s | 89.8 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01514 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.084 | 1708.7 samples/s | 26.7 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01359 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.087 | 4352.6 samples/s | 68.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01248 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.089 | 4381.9 samples/s | 68.5 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01162 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=3.092 | 5417.4 samples/s | 84.6 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01086 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.095 | 1749.6 samples/s | 27.3 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01012 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.097 | 4322.2 samples/s | 67.5 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00948 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.100 | 4475.4 samples/s | 69.9 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00906 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=3.102 | 5019.6 samples/s | 78.4 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00866 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=3.105 | 1772.5 samples/s | 27.7 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00825 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=3.107 | 4479.6 samples/s | 70.0 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00798 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=3.110 | 4301.6 samples/s | 67.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00771 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=3.112 | 4903.3 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=168.1] | Loss=0.05270 | Reg=0.00179 | acc=0.9375 | L2-Norm=13.390 | L2-Norm(final)=3.085 | 3644.2 samples/s | 56.9 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00257 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=3.088 | 3946.8 samples/s | 61.7 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00135 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.089 | 5871.4 samples/s | 91.7 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00097 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.091 | 1631.0 samples/s | 25.5 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00073 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.092 | 5426.8 samples/s | 84.8 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00059 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.093 | 1712.8 samples/s | 26.8 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00049 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.094 | 5097.7 samples/s | 79.7 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00042 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=3.095 | 1727.0 samples/s | 27.0 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00037 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.095 | 4780.9 samples/s | 74.7 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.096 | 1759.7 samples/s | 27.5 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00030 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=3.096 | 4340.9 samples/s | 67.8 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00027 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=3.097 | 1813.0 samples/s | 28.3 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00025 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=3.097 | 4379.3 samples/s | 68.4 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00023 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.098 | 1789.9 samples/s | 28.0 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00022 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=3.098 | 4156.1 samples/s | 64.9 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00020 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.098 | 1821.8 samples/s | 28.5 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.099 | 4226.5 samples/s | 66.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=143.2] | Loss=0.07799 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.390 | L2-Norm(final)=3.085 | 3733.1 samples/s | 58.3 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00535 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.083 | 3835.9 samples/s | 59.9 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00277 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.085 | 5642.9 samples/s | 88.2 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00187 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.086 | 1681.8 samples/s | 26.3 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00141 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.087 | 5255.3 samples/s | 82.1 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00113 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=3.088 | 1689.6 samples/s | 26.4 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00095 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.088 | 4750.2 samples/s | 74.2 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00082 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.089 | 1773.9 samples/s | 27.7 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00072 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.089 | 4279.6 samples/s | 66.9 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00064 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.090 | 1855.1 samples/s | 29.0 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00058 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=3.090 | 4344.4 samples/s | 67.9 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00053 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.091 | 1844.6 samples/s | 28.8 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00049 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.091 | 4250.1 samples/s | 66.4 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00045 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.092 | 1842.1 samples/s | 28.8 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00042 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=3.092 | 4258.5 samples/s | 66.5 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00039 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=3.092 | 1988.7 samples/s | 31.1 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00037 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=3.093 | 3707.0 samples/s | 57.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=99.1] | Loss=0.10568 | Reg=0.00179 | acc=0.9375 | L2-Norm=13.390 | L2-Norm(final)=3.085 | 3787.3 samples/s | 59.2 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00407 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.085 | 3943.4 samples/s | 61.6 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00210 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.086 | 5860.7 samples/s | 91.6 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00142 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.087 | 1660.5 samples/s | 25.9 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00107 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.088 | 5317.5 samples/s | 83.1 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00086 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.089 | 1710.4 samples/s | 26.7 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00072 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.089 | 4929.0 samples/s | 77.0 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00062 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.090 | 1743.8 samples/s | 27.2 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00055 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.090 | 4702.5 samples/s | 73.5 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00049 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.091 | 1760.1 samples/s | 27.5 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00044 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.091 | 4567.8 samples/s | 71.4 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00040 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.092 | 1780.6 samples/s | 27.8 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00037 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=3.092 | 4264.7 samples/s | 66.6 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00034 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=3.092 | 1780.6 samples/s | 27.8 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00032 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.093 | 4232.9 samples/s | 66.1 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00030 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=3.093 | 1832.2 samples/s | 28.6 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00028 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.093 | 4349.1 samples/s | 68.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32384 | acc=0.8364 | tpr=0.7652 | fpr=0.0089 | 3865.4 samples/s | 15.1 steps/s
Avg test loss: 0.32269, Avg test acc: 0.83869, Avg tpr: 0.76983, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.34913 | acc=0.8877 | tpr=0.9735 | fpr=0.1138 | 3937.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.34973 | acc=0.8877 | tpr=0.9808 | fpr=0.1141 | 7729.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.35695 | acc=0.8875 | tpr=0.9813 | fpr=0.1143 | 7415.7 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.35962 | acc=0.8872 | tpr=0.9781 | fpr=0.1144 | 7636.4 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.36011 | acc=0.8863 | tpr=0.9755 | fpr=0.1153 | 7482.5 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.36373 | acc=0.8862 | tpr=0.9760 | fpr=0.1154 | 7690.2 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.36428 | acc=0.8866 | tpr=0.9756 | fpr=0.1150 | 7561.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.36487 | acc=0.8866 | tpr=0.9732 | fpr=0.1150 | 7684.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.36811 | acc=0.8864 | tpr=0.9722 | fpr=0.1151 | 7560.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.36848 | acc=0.8861 | tpr=0.9731 | fpr=0.1154 | 7437.2 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.36708 | acc=0.8863 | tpr=0.9721 | fpr=0.1153 | 13927.1 samples/s | 54.4 steps/s
Avg test loss: 0.36670, Avg test acc: 0.88631, Avg tpr: 0.97227, Avg fpr: 0.11525, total FA: 16002

server round 38/50

clients selected: [0 2 4 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20001 Epoch=97.5] | Loss=0.18302 | Reg=0.00179 | acc=0.8750 | L2-Norm=13.380 | L2-Norm(final)=3.103 | 3571.0 samples/s | 55.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03315 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.397 | L2-Norm(final)=3.099 | 4380.5 samples/s | 68.4 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02417 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=3.098 | 4486.9 samples/s | 70.1 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02134 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.406 | L2-Norm(final)=3.097 | 4449.9 samples/s | 69.5 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01855 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.408 | L2-Norm(final)=3.098 | 5930.5 samples/s | 92.7 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01635 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=3.099 | 1677.2 samples/s | 26.2 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01456 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.100 | 4480.5 samples/s | 70.0 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01327 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.102 | 4466.3 samples/s | 69.8 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01229 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=3.104 | 5464.0 samples/s | 85.4 steps/s
[Step=20450 Epoch=99.7] | Loss=0.01142 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.106 | 1756.6 samples/s | 27.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.01055 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.108 | 4482.8 samples/s | 70.0 steps/s
[Step=20550 Epoch=100.2] | Loss=0.01003 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.111 | 4510.5 samples/s | 70.5 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00966 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.113 | 5218.6 samples/s | 81.5 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00942 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.115 | 1789.9 samples/s | 28.0 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00906 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=3.118 | 4455.9 samples/s | 69.6 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00869 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.120 | 4301.6 samples/s | 67.2 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00836 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.122 | 4670.5 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.17144 | Reg=0.00179 | acc=0.9062 | L2-Norm=13.380 | L2-Norm(final)=3.103 | 3818.8 samples/s | 59.7 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03959 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=3.092 | 4048.0 samples/s | 63.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02591 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=3.092 | 4467.6 samples/s | 69.8 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02116 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.404 | L2-Norm(final)=3.093 | 4349.7 samples/s | 68.0 steps/s
[Step=13000 Epoch=63.3] | Loss=0.01880 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.095 | 6042.6 samples/s | 94.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01651 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.098 | 1742.5 samples/s | 27.2 steps/s
[Step=13100 Epoch=63.8] | Loss=0.01487 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=3.100 | 4390.4 samples/s | 68.6 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01359 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.102 | 4482.2 samples/s | 70.0 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01255 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=3.104 | 5464.2 samples/s | 85.4 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01177 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.107 | 1762.2 samples/s | 27.5 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01105 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.109 | 4322.6 samples/s | 67.5 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01052 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=3.112 | 4232.5 samples/s | 66.1 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01000 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=3.114 | 4905.8 samples/s | 76.7 steps/s
[Step=13450 Epoch=65.5] | Loss=0.00956 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=3.116 | 1771.0 samples/s | 27.7 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00917 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=3.119 | 4497.7 samples/s | 70.3 steps/s
[Step=13550 Epoch=66.0] | Loss=0.00883 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=3.121 | 4397.7 samples/s | 68.7 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00852 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=3.123 | 4779.7 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step13600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=82.4] | Loss=0.08179 | Reg=0.00179 | acc=0.9219 | L2-Norm=13.380 | L2-Norm(final)=3.103 | 3672.0 samples/s | 57.4 steps/s
[Step=16850 Epoch=82.6] | Loss=0.02821 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=3.099 | 4155.2 samples/s | 64.9 steps/s
[Step=16900 Epoch=82.9] | Loss=0.02209 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.099 | 4427.6 samples/s | 69.2 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01876 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.099 | 4363.0 samples/s | 68.2 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01713 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.100 | 5590.9 samples/s | 87.4 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01480 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.101 | 1693.9 samples/s | 26.5 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01349 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.414 | L2-Norm(final)=3.103 | 4400.5 samples/s | 68.8 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01225 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.106 | 4407.0 samples/s | 68.9 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01120 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.108 | 5792.0 samples/s | 90.5 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01032 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=3.110 | 1745.4 samples/s | 27.3 steps/s
[Step=17300 Epoch=84.8] | Loss=0.00970 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.113 | 4295.1 samples/s | 67.1 steps/s
[Step=17350 Epoch=85.1] | Loss=0.00918 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=3.115 | 4476.6 samples/s | 69.9 steps/s
[Step=17400 Epoch=85.3] | Loss=0.00882 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=3.118 | 5567.4 samples/s | 87.0 steps/s
[Step=17450 Epoch=85.6] | Loss=0.00842 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=3.120 | 1724.1 samples/s | 26.9 steps/s
[Step=17500 Epoch=85.8] | Loss=0.00811 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=3.123 | 4371.7 samples/s | 68.3 steps/s
[Step=17550 Epoch=86.1] | Loss=0.00778 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.434 | L2-Norm(final)=3.125 | 4240.9 samples/s | 66.3 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00750 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.435 | L2-Norm(final)=3.127 | 5277.3 samples/s | 82.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=150.8] | Loss=0.05880 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.380 | L2-Norm(final)=3.103 | 3520.4 samples/s | 55.0 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00480 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.101 | 3997.9 samples/s | 62.5 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00249 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.103 | 5743.4 samples/s | 89.7 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00168 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.105 | 1645.9 samples/s | 25.7 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00127 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=3.105 | 5222.8 samples/s | 81.6 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00102 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.106 | 1688.3 samples/s | 26.4 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00086 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=3.107 | 4736.5 samples/s | 74.0 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00074 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=3.107 | 1775.7 samples/s | 27.7 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00065 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=3.108 | 4369.9 samples/s | 68.3 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00058 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=3.109 | 1796.3 samples/s | 28.1 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00052 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=3.109 | 4021.0 samples/s | 62.8 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00048 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=3.110 | 1843.6 samples/s | 28.8 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00044 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.110 | 4271.1 samples/s | 66.7 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00041 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.111 | 1863.9 samples/s | 29.1 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00038 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.111 | 4225.2 samples/s | 66.0 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00036 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.111 | 2037.8 samples/s | 31.8 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.112 | 3560.6 samples/s | 55.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=106.8] | Loss=0.05964 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.380 | L2-Norm(final)=3.103 | 3735.6 samples/s | 58.4 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00446 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=3.103 | 3786.8 samples/s | 59.2 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00233 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.105 | 5757.5 samples/s | 90.0 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00157 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.106 | 1652.8 samples/s | 25.8 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00119 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.107 | 5368.9 samples/s | 83.9 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00095 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=3.107 | 1705.6 samples/s | 26.7 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00080 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.108 | 5128.9 samples/s | 80.1 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00069 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.108 | 1745.1 samples/s | 27.3 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00060 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=3.109 | 4769.2 samples/s | 74.5 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=3.109 | 1729.3 samples/s | 27.0 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00049 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=3.109 | 4597.2 samples/s | 71.8 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00044 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=3.109 | 1788.3 samples/s | 27.9 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00041 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.110 | 4420.7 samples/s | 69.1 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00038 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=3.110 | 1823.2 samples/s | 28.5 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00035 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.110 | 4278.9 samples/s | 66.9 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.110 | 1844.3 samples/s | 28.8 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.111 | 4073.5 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32019 | acc=0.8377 | tpr=0.7671 | fpr=0.0089 | 3871.5 samples/s | 15.1 steps/s
Avg test loss: 0.31980, Avg test acc: 0.84033, Avg tpr: 0.77205, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.35283 | acc=0.8864 | tpr=0.9735 | fpr=0.1152 | 3894.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.35333 | acc=0.8879 | tpr=0.9808 | fpr=0.1138 | 7424.6 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.36032 | acc=0.8880 | tpr=0.9813 | fpr=0.1137 | 7497.8 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.36316 | acc=0.8878 | tpr=0.9781 | fpr=0.1138 | 7538.3 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.36347 | acc=0.8869 | tpr=0.9755 | fpr=0.1147 | 7617.3 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.36729 | acc=0.8867 | tpr=0.9767 | fpr=0.1150 | 7825.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.36782 | acc=0.8869 | tpr=0.9756 | fpr=0.1147 | 7457.1 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.36853 | acc=0.8869 | tpr=0.9732 | fpr=0.1147 | 7731.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.37192 | acc=0.8867 | tpr=0.9722 | fpr=0.1149 | 7535.8 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.37224 | acc=0.8865 | tpr=0.9731 | fpr=0.1151 | 7709.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.37087 | acc=0.8867 | tpr=0.9717 | fpr=0.1148 | 14321.3 samples/s | 55.9 steps/s
Avg test loss: 0.37048, Avg test acc: 0.88673, Avg tpr: 0.97187, Avg fpr: 0.11482, total FA: 15942

server round 39/50

clients selected: [0 2 3 4 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20801 Epoch=101.4] | Loss=0.19338 | Reg=0.00179 | acc=0.8906 | L2-Norm=13.370 | L2-Norm(final)=3.118 | 3884.4 samples/s | 60.7 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03321 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.386 | L2-Norm(final)=3.112 | 3884.1 samples/s | 60.7 steps/s
[Step=20900 Epoch=101.9] | Loss=0.02474 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=3.112 | 4434.2 samples/s | 69.3 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02154 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=3.112 | 4301.4 samples/s | 67.2 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01903 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=3.113 | 5861.2 samples/s | 91.6 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01631 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=3.114 | 1709.7 samples/s | 26.7 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01442 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.116 | 4451.7 samples/s | 69.6 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01326 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.118 | 4423.8 samples/s | 69.1 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01247 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.120 | 5417.0 samples/s | 84.6 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01158 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.122 | 1736.1 samples/s | 27.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01084 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=3.124 | 4333.5 samples/s | 67.7 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01026 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.413 | L2-Norm(final)=3.127 | 4410.2 samples/s | 68.9 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00980 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=3.129 | 5201.0 samples/s | 81.3 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00934 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=3.131 | 1774.4 samples/s | 27.7 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00888 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=3.133 | 4468.3 samples/s | 69.8 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00864 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.421 | L2-Norm(final)=3.136 | 4511.5 samples/s | 70.5 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00837 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=3.138 | 4734.2 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.17507 | Reg=0.00179 | acc=0.9062 | L2-Norm=13.370 | L2-Norm(final)=3.117 | 3772.8 samples/s | 59.0 steps/s
[Step=13650 Epoch=66.5] | Loss=0.03269 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.381 | L2-Norm(final)=3.112 | 4105.5 samples/s | 64.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02403 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.112 | 4428.9 samples/s | 69.2 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02199 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.391 | L2-Norm(final)=3.112 | 4408.0 samples/s | 68.9 steps/s
[Step=13800 Epoch=67.2] | Loss=0.01936 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=3.113 | 6028.3 samples/s | 94.2 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01675 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=3.114 | 1704.4 samples/s | 26.6 steps/s
[Step=13900 Epoch=67.7] | Loss=0.01491 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.116 | 4282.3 samples/s | 66.9 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01367 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.401 | L2-Norm(final)=3.118 | 4293.6 samples/s | 67.1 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01261 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.403 | L2-Norm(final)=3.121 | 5390.7 samples/s | 84.2 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01168 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=3.123 | 1758.3 samples/s | 27.5 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01097 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=3.126 | 4345.7 samples/s | 67.9 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01037 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.410 | L2-Norm(final)=3.128 | 4382.3 samples/s | 68.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00998 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.131 | 5173.1 samples/s | 80.8 steps/s
[Step=14250 Epoch=69.4] | Loss=0.00963 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.133 | 1794.9 samples/s | 28.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00924 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=3.136 | 4468.2 samples/s | 69.8 steps/s
[Step=14350 Epoch=69.9] | Loss=0.00887 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=3.138 | 4266.9 samples/s | 66.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00852 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.140 | 4531.2 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=81.9] | Loss=0.13523 | Reg=0.00179 | acc=0.8906 | L2-Norm=13.370 | L2-Norm(final)=3.118 | 3817.0 samples/s | 59.6 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03126 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=3.113 | 3962.8 samples/s | 61.9 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02266 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.391 | L2-Norm(final)=3.113 | 4346.6 samples/s | 67.9 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01927 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=3.114 | 4432.8 samples/s | 69.3 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01715 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.398 | L2-Norm(final)=3.115 | 5984.4 samples/s | 93.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01476 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=3.117 | 1684.0 samples/s | 26.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01312 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.119 | 4291.5 samples/s | 67.1 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01203 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.122 | 4383.3 samples/s | 68.5 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01113 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=3.124 | 5323.1 samples/s | 83.2 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01055 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.127 | 1710.2 samples/s | 26.7 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00984 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.129 | 4290.3 samples/s | 67.0 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00933 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.132 | 4252.0 samples/s | 66.4 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00893 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=3.134 | 5053.4 samples/s | 79.0 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00849 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.136 | 1787.2 samples/s | 27.9 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00812 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=3.139 | 4505.2 samples/s | 70.4 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00772 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=3.141 | 4335.3 samples/s | 67.7 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00751 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=3.143 | 4782.8 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=86.3] | Loss=0.15510 | Reg=0.00179 | acc=0.9219 | L2-Norm=13.370 | L2-Norm(final)=3.117 | 3744.5 samples/s | 58.5 steps/s
[Step=17650 Epoch=86.6] | Loss=0.02964 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.380 | L2-Norm(final)=3.111 | 4084.5 samples/s | 63.8 steps/s
[Step=17700 Epoch=86.8] | Loss=0.02196 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=3.111 | 4312.4 samples/s | 67.4 steps/s
[Step=17750 Epoch=87.0] | Loss=0.01888 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=3.112 | 4386.5 samples/s | 68.5 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01655 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.393 | L2-Norm(final)=3.114 | 6049.9 samples/s | 94.5 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01421 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=3.116 | 1673.4 samples/s | 26.1 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01272 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=3.118 | 4254.4 samples/s | 66.5 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01171 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.121 | 4296.7 samples/s | 67.1 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01085 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.123 | 5807.0 samples/s | 90.7 steps/s
[Step=18050 Epoch=88.5] | Loss=0.01001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=3.126 | 1739.4 samples/s | 27.2 steps/s
[Step=18100 Epoch=88.8] | Loss=0.00947 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=3.128 | 4338.0 samples/s | 67.8 steps/s
[Step=18150 Epoch=89.0] | Loss=0.00891 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=3.131 | 4503.8 samples/s | 70.4 steps/s
[Step=18200 Epoch=89.2] | Loss=0.00854 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=3.133 | 5224.6 samples/s | 81.6 steps/s
[Step=18250 Epoch=89.5] | Loss=0.00812 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=3.136 | 1762.4 samples/s | 27.5 steps/s
[Step=18300 Epoch=89.7] | Loss=0.00778 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=3.138 | 4453.8 samples/s | 69.6 steps/s
[Step=18350 Epoch=90.0] | Loss=0.00748 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=3.141 | 4531.7 samples/s | 70.8 steps/s
[Step=18400 Epoch=90.2] | Loss=0.00720 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=3.143 | 5121.8 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8001 Epoch=76.1] | Loss=0.02609 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.370 | L2-Norm(final)=3.118 | 3788.4 samples/s | 59.2 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00444 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=3.116 | 3812.7 samples/s | 59.6 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00233 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.117 | 5649.2 samples/s | 88.3 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00158 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=3.118 | 1644.3 samples/s | 25.7 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00119 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=3.119 | 5001.6 samples/s | 78.2 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00096 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=3.119 | 1705.8 samples/s | 26.7 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00080 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=3.119 | 4879.8 samples/s | 76.2 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00069 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=3.120 | 1744.3 samples/s | 27.3 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00060 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=3.120 | 4661.9 samples/s | 72.8 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=3.120 | 1798.3 samples/s | 28.1 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00049 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=3.121 | 4247.1 samples/s | 66.4 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00044 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.121 | 1802.0 samples/s | 28.2 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00041 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=3.121 | 4203.6 samples/s | 65.7 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00038 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.122 | 1850.2 samples/s | 28.9 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00035 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.122 | 4323.9 samples/s | 67.6 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.122 | 1860.4 samples/s | 29.1 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.122 | 4299.2 samples/s | 67.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31913 | acc=0.8387 | tpr=0.7688 | fpr=0.0097 | 3804.6 samples/s | 14.9 steps/s
Avg test loss: 0.31840, Avg test acc: 0.84089, Avg tpr: 0.77339, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.34645 | acc=0.8912 | tpr=0.9735 | fpr=0.1102 | 3951.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.34694 | acc=0.8922 | tpr=0.9808 | fpr=0.1094 | 7339.3 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.35410 | acc=0.8921 | tpr=0.9813 | fpr=0.1096 | 7600.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.35718 | acc=0.8916 | tpr=0.9770 | fpr=0.1099 | 8019.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.35743 | acc=0.8908 | tpr=0.9747 | fpr=0.1108 | 7167.7 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.36137 | acc=0.8904 | tpr=0.9753 | fpr=0.1111 | 6435.5 samples/s | 25.1 steps/s
[Step= 350] | Loss=0.36197 | acc=0.8906 | tpr=0.9737 | fpr=0.1109 | 7911.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.36287 | acc=0.8906 | tpr=0.9716 | fpr=0.1109 | 7597.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.36632 | acc=0.8904 | tpr=0.9708 | fpr=0.1111 | 5210.5 samples/s | 20.4 steps/s
[Step= 500] | Loss=0.36663 | acc=0.8901 | tpr=0.9718 | fpr=0.1113 | 7229.0 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.36527 | acc=0.8905 | tpr=0.9710 | fpr=0.1110 | 13561.0 samples/s | 53.0 steps/s
Avg test loss: 0.36487, Avg test acc: 0.89050, Avg tpr: 0.97108, Avg fpr: 0.11096, total FA: 15407

server round 40/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=105.3] | Loss=0.17079 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.358 | L2-Norm(final)=3.136 | 3535.3 samples/s | 55.2 steps/s
[Step=21650 Epoch=105.6] | Loss=0.04507 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=3.132 | 4129.7 samples/s | 64.5 steps/s
[Step=21700 Epoch=105.8] | Loss=0.03030 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.131 | 4494.7 samples/s | 70.2 steps/s
[Step=21750 Epoch=106.1] | Loss=0.02395 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.368 | L2-Norm(final)=3.131 | 4296.1 samples/s | 67.1 steps/s
[Step=21800 Epoch=106.3] | Loss=0.02087 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.370 | L2-Norm(final)=3.132 | 5873.8 samples/s | 91.8 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01882 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.133 | 1717.7 samples/s | 26.8 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01669 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.134 | 4392.9 samples/s | 68.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01533 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=3.135 | 4487.3 samples/s | 70.1 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01438 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.376 | L2-Norm(final)=3.136 | 5566.9 samples/s | 87.0 steps/s
[Step=22050 Epoch=107.5] | Loss=0.01317 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.137 | 1761.3 samples/s | 27.5 steps/s
[Step=22100 Epoch=107.8] | Loss=0.01226 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=3.139 | 4487.1 samples/s | 70.1 steps/s
[Step=22150 Epoch=108.0] | Loss=0.01167 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.140 | 4443.5 samples/s | 69.4 steps/s
[Step=22200 Epoch=108.3] | Loss=0.01115 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=3.141 | 5233.6 samples/s | 81.8 steps/s
[Step=22250 Epoch=108.5] | Loss=0.01063 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.143 | 1739.7 samples/s | 27.2 steps/s
[Step=22300 Epoch=108.7] | Loss=0.01018 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=3.144 | 4308.5 samples/s | 67.3 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00975 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.385 | L2-Norm(final)=3.146 | 4440.7 samples/s | 69.4 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00942 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=3.147 | 4912.6 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=82.0] | Loss=0.21703 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.358 | L2-Norm(final)=3.136 | 3591.7 samples/s | 56.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.04125 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.366 | L2-Norm(final)=3.133 | 4100.9 samples/s | 64.1 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02680 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.132 | 4314.3 samples/s | 67.4 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02096 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.133 | 4401.9 samples/s | 68.8 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01858 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.372 | L2-Norm(final)=3.134 | 5775.0 samples/s | 90.2 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01606 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.135 | 1712.2 samples/s | 26.8 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01404 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=3.136 | 4304.3 samples/s | 67.3 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01292 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=3.138 | 4354.4 samples/s | 68.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01201 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.139 | 5276.6 samples/s | 82.4 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01121 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=3.141 | 1755.4 samples/s | 27.4 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01050 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.142 | 4507.0 samples/s | 70.4 steps/s
[Step=17350 Epoch=84.7] | Loss=0.00997 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.144 | 4417.3 samples/s | 69.0 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00946 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=3.145 | 5264.6 samples/s | 82.3 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00899 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.384 | L2-Norm(final)=3.147 | 1740.8 samples/s | 27.2 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00856 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=3.148 | 4426.2 samples/s | 69.2 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00823 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=3.150 | 4389.2 samples/s | 68.6 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00797 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=3.151 | 4898.6 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.12221 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.358 | L2-Norm(final)=3.136 | 3820.3 samples/s | 59.7 steps/s
[Step=14450 Epoch=70.4] | Loss=0.03229 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.134 | 4045.5 samples/s | 63.2 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02324 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.134 | 4510.8 samples/s | 70.5 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01906 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.135 | 4367.9 samples/s | 68.2 steps/s
[Step=14600 Epoch=71.1] | Loss=0.01754 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.136 | 5826.0 samples/s | 91.0 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01518 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.374 | L2-Norm(final)=3.137 | 1704.3 samples/s | 26.6 steps/s
[Step=14700 Epoch=71.6] | Loss=0.01343 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=3.139 | 4408.2 samples/s | 68.9 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01268 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.377 | L2-Norm(final)=3.140 | 4477.4 samples/s | 70.0 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01188 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.141 | 5336.3 samples/s | 83.4 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01100 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.143 | 1713.0 samples/s | 26.8 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01033 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.381 | L2-Norm(final)=3.145 | 4384.8 samples/s | 68.5 steps/s
[Step=14950 Epoch=72.8] | Loss=0.00981 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.146 | 4426.2 samples/s | 69.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00945 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.384 | L2-Norm(final)=3.148 | 5064.4 samples/s | 79.1 steps/s
[Step=15050 Epoch=73.3] | Loss=0.00908 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=3.150 | 1788.2 samples/s | 27.9 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00871 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=3.151 | 4347.3 samples/s | 67.9 steps/s
[Step=15150 Epoch=73.8] | Loss=0.00844 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=3.153 | 4496.1 samples/s | 70.3 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00818 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=3.155 | 4826.8 samples/s | 75.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=144.0] | Loss=0.01725 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.358 | L2-Norm(final)=3.136 | 3974.3 samples/s | 62.1 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00289 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.140 | 3480.7 samples/s | 54.4 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00151 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.141 | 5531.8 samples/s | 86.4 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00103 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.142 | 1635.8 samples/s | 25.6 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00078 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.142 | 5302.2 samples/s | 82.8 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00063 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.143 | 1704.5 samples/s | 26.6 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00053 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.143 | 4948.1 samples/s | 77.3 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00046 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.144 | 1748.7 samples/s | 27.3 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00041 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.144 | 4657.2 samples/s | 72.8 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00036 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.144 | 1799.3 samples/s | 28.1 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.145 | 4315.1 samples/s | 67.4 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00030 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.145 | 1830.0 samples/s | 28.6 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00028 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.145 | 4302.6 samples/s | 67.2 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00026 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.145 | 1836.3 samples/s | 28.7 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00024 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.146 | 4329.2 samples/s | 67.6 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00023 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.146 | 1868.8 samples/s | 29.2 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00021 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.146 | 4068.5 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12001 Epoch=114.4] | Loss=0.03009 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.358 | L2-Norm(final)=3.136 | 3878.2 samples/s | 60.6 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00455 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.137 | 3781.2 samples/s | 59.1 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00234 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.138 | 5887.2 samples/s | 92.0 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00159 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.139 | 1672.8 samples/s | 26.1 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00121 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.140 | 5472.6 samples/s | 85.5 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00098 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.140 | 1707.6 samples/s | 26.7 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00082 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.141 | 5077.5 samples/s | 79.3 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00071 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.141 | 1713.6 samples/s | 26.8 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00063 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.141 | 4723.0 samples/s | 73.8 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00056 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.142 | 1778.4 samples/s | 27.8 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00051 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.142 | 4599.6 samples/s | 71.9 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00047 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.142 | 1804.7 samples/s | 28.2 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00043 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.143 | 4370.0 samples/s | 68.3 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.143 | 1811.0 samples/s | 28.3 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.143 | 4163.1 samples/s | 65.0 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.144 | 1848.7 samples/s | 28.9 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00033 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.144 | 4331.2 samples/s | 67.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31579 | acc=0.8394 | tpr=0.7699 | fpr=0.0097 | 2932.0 samples/s | 11.5 steps/s
Avg test loss: 0.31530, Avg test acc: 0.84221, Avg tpr: 0.77508, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.34371 | acc=0.8918 | tpr=0.9735 | fpr=0.1097 | 3901.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.34445 | acc=0.8927 | tpr=0.9808 | fpr=0.1090 | 7690.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.35149 | acc=0.8925 | tpr=0.9813 | fpr=0.1091 | 7717.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.35461 | acc=0.8921 | tpr=0.9770 | fpr=0.1095 | 7569.4 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.35489 | acc=0.8913 | tpr=0.9738 | fpr=0.1102 | 7387.8 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.35880 | acc=0.8911 | tpr=0.9745 | fpr=0.1104 | 7388.9 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.35938 | acc=0.8912 | tpr=0.9731 | fpr=0.1103 | 7269.5 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.36027 | acc=0.8912 | tpr=0.9710 | fpr=0.1103 | 7453.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.36371 | acc=0.8909 | tpr=0.9703 | fpr=0.1105 | 7355.2 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.36407 | acc=0.8907 | tpr=0.9714 | fpr=0.1107 | 7441.5 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.36278 | acc=0.8911 | tpr=0.9702 | fpr=0.1103 | 12844.1 samples/s | 50.2 steps/s
Avg test loss: 0.36238, Avg test acc: 0.89115, Avg tpr: 0.97029, Avg fpr: 0.11029, total FA: 15314

server round 41/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=109.2] | Loss=0.11004 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.349 | L2-Norm(final)=3.152 | 3713.4 samples/s | 58.0 steps/s
[Step=22450 Epoch=109.5] | Loss=0.03969 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.150 | 4275.1 samples/s | 66.8 steps/s
[Step=22500 Epoch=109.7] | Loss=0.02742 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.358 | L2-Norm(final)=3.150 | 4346.7 samples/s | 67.9 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02246 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=3.151 | 4459.2 samples/s | 69.7 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01908 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.152 | 6031.1 samples/s | 94.2 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01641 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.363 | L2-Norm(final)=3.153 | 1742.1 samples/s | 27.2 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01459 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.154 | 4410.5 samples/s | 68.9 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01332 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.155 | 4441.6 samples/s | 69.4 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01242 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.367 | L2-Norm(final)=3.157 | 5458.0 samples/s | 85.3 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01151 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.158 | 1724.7 samples/s | 26.9 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01086 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.160 | 4449.7 samples/s | 69.5 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01032 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.161 | 4419.9 samples/s | 69.1 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00985 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.163 | 5135.5 samples/s | 80.2 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00941 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.374 | L2-Norm(final)=3.164 | 1754.5 samples/s | 27.4 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00900 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=3.166 | 4346.0 samples/s | 67.9 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00866 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.376 | L2-Norm(final)=3.167 | 4320.0 samples/s | 67.5 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00835 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.168 | 4756.0 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step23200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.25134 | Reg=0.00178 | acc=0.8594 | L2-Norm=13.349 | L2-Norm(final)=3.152 | 3554.2 samples/s | 55.5 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03924 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.149 | 4110.7 samples/s | 64.2 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02597 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.358 | L2-Norm(final)=3.149 | 4481.2 samples/s | 70.0 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01992 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.150 | 4446.6 samples/s | 69.5 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01725 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.152 | 6076.5 samples/s | 94.9 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01482 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.154 | 1733.9 samples/s | 27.1 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01293 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.156 | 4402.8 samples/s | 68.8 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01213 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.157 | 4520.5 samples/s | 70.6 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01137 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.159 | 5472.6 samples/s | 85.5 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01052 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.161 | 1725.8 samples/s | 27.0 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00988 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.163 | 4293.0 samples/s | 67.1 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00937 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=3.164 | 4182.5 samples/s | 65.4 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00887 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.377 | L2-Norm(final)=3.166 | 5140.5 samples/s | 80.3 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00848 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.168 | 1814.1 samples/s | 28.3 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00815 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.170 | 4374.1 samples/s | 68.3 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00784 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.381 | L2-Norm(final)=3.171 | 4444.8 samples/s | 69.5 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00755 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.173 | 4788.3 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=151.6] | Loss=0.04697 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.349 | L2-Norm(final)=3.152 | 3586.8 samples/s | 56.0 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00373 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.154 | 4038.4 samples/s | 63.1 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00192 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.155 | 5756.6 samples/s | 89.9 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00133 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.156 | 1617.0 samples/s | 25.3 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00101 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.156 | 5274.5 samples/s | 82.4 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00082 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.157 | 1689.6 samples/s | 26.4 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00069 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.157 | 4860.5 samples/s | 75.9 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00059 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.158 | 1750.1 samples/s | 27.3 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.158 | 4563.2 samples/s | 71.3 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.158 | 1797.1 samples/s | 28.1 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.159 | 4024.3 samples/s | 62.9 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.159 | 1815.6 samples/s | 28.4 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.159 | 4262.9 samples/s | 66.6 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00033 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.159 | 1860.9 samples/s | 29.1 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00031 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.160 | 4287.3 samples/s | 67.0 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00029 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.160 | 1843.4 samples/s | 28.8 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00027 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.160 | 4120.0 samples/s | 64.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=8801 Epoch=83.7] | Loss=0.11634 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.349 | L2-Norm(final)=3.152 | 3551.1 samples/s | 55.5 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00696 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.153 | 3806.7 samples/s | 59.5 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00351 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.153 | 5504.7 samples/s | 86.0 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00235 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.154 | 1687.7 samples/s | 26.4 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00177 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.154 | 5203.7 samples/s | 81.3 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00143 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.154 | 1688.8 samples/s | 26.4 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00119 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.154 | 4968.8 samples/s | 77.6 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00103 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.154 | 1765.3 samples/s | 27.6 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00090 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.155 | 4566.7 samples/s | 71.4 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00080 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.155 | 1787.4 samples/s | 27.9 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00073 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.155 | 4386.4 samples/s | 68.5 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00066 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.155 | 1825.6 samples/s | 28.5 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00061 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.155 | 4284.3 samples/s | 66.9 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00056 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.156 | 1847.3 samples/s | 28.9 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.156 | 4298.4 samples/s | 67.2 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.156 | 1854.0 samples/s | 29.0 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00046 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.156 | 4267.8 samples/s | 66.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=175.7] | Loss=0.03888 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.349 | L2-Norm(final)=3.152 | 3560.5 samples/s | 55.6 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00505 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.153 | 3910.7 samples/s | 61.1 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00257 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.153 | 5868.6 samples/s | 91.7 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00173 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.154 | 1662.8 samples/s | 26.0 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00130 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.154 | 5516.6 samples/s | 86.2 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00105 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.155 | 1705.1 samples/s | 26.6 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00088 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.155 | 5048.1 samples/s | 78.9 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00076 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.155 | 1702.5 samples/s | 26.6 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.156 | 4775.6 samples/s | 74.6 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00060 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.156 | 1769.6 samples/s | 27.6 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00054 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.156 | 4509.9 samples/s | 70.5 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.156 | 1759.0 samples/s | 27.5 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.157 | 4248.6 samples/s | 66.4 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.157 | 1785.2 samples/s | 27.9 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.157 | 4006.4 samples/s | 62.6 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.157 | 1813.4 samples/s | 28.3 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.158 | 4353.6 samples/s | 68.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29169 | acc=0.8529 | tpr=0.7897 | fpr=0.0099 | 3966.0 samples/s | 15.5 steps/s
Avg test loss: 0.29246, Avg test acc: 0.85444, Avg tpr: 0.79320, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.36819 | acc=0.8818 | tpr=0.9779 | fpr=0.1199 | 3868.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.36885 | acc=0.8822 | tpr=0.9829 | fpr=0.1197 | 7535.4 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.37568 | acc=0.8825 | tpr=0.9827 | fpr=0.1194 | 7499.4 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.37880 | acc=0.8825 | tpr=0.9770 | fpr=0.1192 | 7572.3 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.37933 | acc=0.8821 | tpr=0.9747 | fpr=0.1196 | 7353.1 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.38321 | acc=0.8818 | tpr=0.9753 | fpr=0.1199 | 7330.3 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.38371 | acc=0.8821 | tpr=0.9743 | fpr=0.1196 | 7548.1 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.38453 | acc=0.8820 | tpr=0.9716 | fpr=0.1196 | 7482.7 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.38799 | acc=0.8819 | tpr=0.9713 | fpr=0.1197 | 7719.1 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.38840 | acc=0.8817 | tpr=0.9727 | fpr=0.1199 | 7287.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.38710 | acc=0.8819 | tpr=0.9713 | fpr=0.1197 | 14026.3 samples/s | 54.8 steps/s
Avg test loss: 0.38671, Avg test acc: 0.88199, Avg tpr: 0.97147, Avg fpr: 0.11964, total FA: 16612

server round 42/50

clients selected: [1 2 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.9] | Loss=0.12945 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.349 | L2-Norm(final)=3.167 | 3610.3 samples/s | 56.4 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03793 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.358 | L2-Norm(final)=3.165 | 4383.7 samples/s | 68.5 steps/s
[Step=17700 Epoch=86.4] | Loss=0.02644 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.164 | 4427.1 samples/s | 69.2 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02097 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.362 | L2-Norm(final)=3.165 | 4515.7 samples/s | 70.6 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01768 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.165 | 5981.6 samples/s | 93.5 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01517 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.167 | 1719.8 samples/s | 26.9 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01343 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.366 | L2-Norm(final)=3.168 | 4562.6 samples/s | 71.3 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01218 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.169 | 4499.9 samples/s | 70.3 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01145 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.171 | 5330.3 samples/s | 83.3 steps/s
[Step=18050 Epoch=88.1] | Loss=0.01055 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.172 | 1758.5 samples/s | 27.5 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00992 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.173 | 4257.0 samples/s | 66.5 steps/s
[Step=18150 Epoch=88.6] | Loss=0.00936 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=3.175 | 4479.6 samples/s | 70.0 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00893 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.176 | 5270.9 samples/s | 82.4 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00848 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=3.178 | 1781.2 samples/s | 27.8 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00819 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=3.179 | 4418.9 samples/s | 69.0 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00784 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.181 | 4476.5 samples/s | 69.9 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00755 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.182 | 4807.0 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.10382 | Reg=0.00178 | acc=0.9062 | L2-Norm=13.349 | L2-Norm(final)=3.167 | 3439.5 samples/s | 53.7 steps/s
[Step=15250 Epoch=74.3] | Loss=0.03195 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.166 | 4128.8 samples/s | 64.5 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02323 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.165 | 4473.9 samples/s | 69.9 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01946 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=3.166 | 4422.0 samples/s | 69.1 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01750 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.166 | 5827.0 samples/s | 91.0 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01559 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.167 | 1702.2 samples/s | 26.6 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01402 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=3.169 | 4395.9 samples/s | 68.7 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01279 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.170 | 4477.1 samples/s | 70.0 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01185 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.171 | 5516.6 samples/s | 86.2 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01097 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.173 | 1726.4 samples/s | 27.0 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01032 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.174 | 4415.6 samples/s | 69.0 steps/s
[Step=15750 Epoch=76.7] | Loss=0.00989 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.176 | 4197.3 samples/s | 65.6 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00946 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.177 | 5119.3 samples/s | 80.0 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00905 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.179 | 1796.6 samples/s | 28.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00866 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=3.180 | 4425.6 samples/s | 69.1 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00836 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.376 | L2-Norm(final)=3.182 | 4431.5 samples/s | 69.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00807 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.183 | 4894.8 samples/s | 76.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=90.2] | Loss=0.12024 | Reg=0.00178 | acc=0.9062 | L2-Norm=13.349 | L2-Norm(final)=3.167 | 3663.9 samples/s | 57.2 steps/s
[Step=18450 Epoch=90.5] | Loss=0.02853 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.165 | 4270.6 samples/s | 66.7 steps/s
[Step=18500 Epoch=90.7] | Loss=0.01969 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.165 | 4483.3 samples/s | 70.1 steps/s
[Step=18550 Epoch=91.0] | Loss=0.01600 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.363 | L2-Norm(final)=3.167 | 4485.8 samples/s | 70.1 steps/s
[Step=18600 Epoch=91.2] | Loss=0.01399 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.168 | 5838.7 samples/s | 91.2 steps/s
[Step=18650 Epoch=91.5] | Loss=0.01238 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.170 | 1682.7 samples/s | 26.3 steps/s
[Step=18700 Epoch=91.7] | Loss=0.01099 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.171 | 4350.8 samples/s | 68.0 steps/s
[Step=18750 Epoch=91.9] | Loss=0.01004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.173 | 4332.0 samples/s | 67.7 steps/s
[Step=18800 Epoch=92.2] | Loss=0.00940 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.175 | 5862.3 samples/s | 91.6 steps/s
[Step=18850 Epoch=92.4] | Loss=0.00876 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.176 | 1733.2 samples/s | 27.1 steps/s
[Step=18900 Epoch=92.7] | Loss=0.00816 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=3.178 | 4486.9 samples/s | 70.1 steps/s
[Step=18950 Epoch=92.9] | Loss=0.00789 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=3.180 | 4277.3 samples/s | 66.8 steps/s
[Step=19000 Epoch=93.2] | Loss=0.00752 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.181 | 5516.2 samples/s | 86.2 steps/s
[Step=19050 Epoch=93.4] | Loss=0.00719 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.183 | 1757.0 samples/s | 27.5 steps/s
[Step=19100 Epoch=93.7] | Loss=0.00684 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=3.185 | 4427.3 samples/s | 69.2 steps/s
[Step=19150 Epoch=93.9] | Loss=0.00656 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=3.186 | 4380.1 samples/s | 68.4 steps/s
[Step=19200 Epoch=94.2] | Loss=0.00639 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.384 | L2-Norm(final)=3.188 | 5260.9 samples/s | 82.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=183.4] | Loss=0.03806 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.349 | L2-Norm(final)=3.167 | 3651.8 samples/s | 57.1 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00408 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.169 | 4109.4 samples/s | 64.2 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00211 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.170 | 5804.6 samples/s | 90.7 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00142 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.171 | 1658.9 samples/s | 25.9 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00107 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.171 | 5466.6 samples/s | 85.4 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00086 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.172 | 1697.3 samples/s | 26.5 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00072 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.172 | 5095.4 samples/s | 79.6 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00062 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.172 | 1734.6 samples/s | 27.1 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.172 | 4739.9 samples/s | 74.1 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.173 | 1770.0 samples/s | 27.7 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.173 | 4321.9 samples/s | 67.5 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.173 | 1824.7 samples/s | 28.5 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.173 | 4180.9 samples/s | 65.3 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.174 | 1832.1 samples/s | 28.6 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.174 | 4123.6 samples/s | 64.4 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00030 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.174 | 1832.3 samples/s | 28.6 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00028 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.174 | 4216.6 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12801 Epoch=122.0] | Loss=0.04470 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.349 | L2-Norm(final)=3.167 | 3598.9 samples/s | 56.2 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00521 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.167 | 4084.6 samples/s | 63.8 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00267 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.168 | 5852.4 samples/s | 91.4 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00180 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.168 | 1653.5 samples/s | 25.8 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00137 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.169 | 5332.8 samples/s | 83.3 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00110 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.169 | 1656.9 samples/s | 25.9 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00093 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.169 | 5149.8 samples/s | 80.5 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00080 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.170 | 1728.3 samples/s | 27.0 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00070 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.170 | 4632.2 samples/s | 72.4 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00063 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.170 | 1755.9 samples/s | 27.4 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00057 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.171 | 4412.0 samples/s | 68.9 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.171 | 1792.4 samples/s | 28.0 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.171 | 4113.4 samples/s | 64.3 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.171 | 1816.6 samples/s | 28.4 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00041 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.172 | 4324.5 samples/s | 67.6 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.172 | 1802.0 samples/s | 28.2 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.172 | 4322.7 samples/s | 67.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29949 | acc=0.8495 | tpr=0.7845 | fpr=0.0094 | 3870.9 samples/s | 15.1 steps/s
Avg test loss: 0.30005, Avg test acc: 0.85095, Avg tpr: 0.78784, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.36010 | acc=0.8848 | tpr=0.9779 | fpr=0.1168 | 3920.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.36135 | acc=0.8856 | tpr=0.9829 | fpr=0.1162 | 7641.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.36832 | acc=0.8862 | tpr=0.9827 | fpr=0.1156 | 7759.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.37142 | acc=0.8862 | tpr=0.9770 | fpr=0.1155 | 7509.1 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.37184 | acc=0.8856 | tpr=0.9729 | fpr=0.1160 | 7705.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.37572 | acc=0.8852 | tpr=0.9738 | fpr=0.1164 | 7898.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.37629 | acc=0.8852 | tpr=0.9737 | fpr=0.1164 | 7371.2 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.37712 | acc=0.8852 | tpr=0.9710 | fpr=0.1163 | 7492.8 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.38059 | acc=0.8851 | tpr=0.9708 | fpr=0.1165 | 7572.9 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.38103 | acc=0.8850 | tpr=0.9718 | fpr=0.1165 | 7304.4 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.37982 | acc=0.8853 | tpr=0.9706 | fpr=0.1162 | 14025.2 samples/s | 54.8 steps/s
Avg test loss: 0.37943, Avg test acc: 0.88536, Avg tpr: 0.97029, Avg fpr: 0.11618, total FA: 16132

server round 43/50

clients selected: [0 2 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=23201 Epoch=113.1] | Loss=0.13896 | Reg=0.00178 | acc=0.9062 | L2-Norm=13.342 | L2-Norm(final)=3.181 | 3763.9 samples/s | 58.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.03616 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.179 | 4233.6 samples/s | 66.2 steps/s
[Step=23300 Epoch=113.6] | Loss=0.02458 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.352 | L2-Norm(final)=3.178 | 4385.4 samples/s | 68.5 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01968 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.179 | 4238.4 samples/s | 66.2 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01751 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.180 | 5907.9 samples/s | 92.3 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01527 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.181 | 1718.7 samples/s | 26.9 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01348 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.182 | 4414.6 samples/s | 69.0 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01232 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.183 | 4236.4 samples/s | 66.2 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01153 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.185 | 5492.8 samples/s | 85.8 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01071 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.186 | 1719.6 samples/s | 26.9 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01005 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.188 | 4497.5 samples/s | 70.3 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00961 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.189 | 4361.1 samples/s | 68.1 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00918 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.191 | 5186.0 samples/s | 81.0 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00878 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.192 | 1744.0 samples/s | 27.2 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00851 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.193 | 4371.7 samples/s | 68.3 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00813 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.195 | 4521.2 samples/s | 70.6 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00787 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.196 | 4776.1 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.04911 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.342 | L2-Norm(final)=3.181 | 3766.5 samples/s | 58.9 steps/s
[Step=16050 Epoch=78.2] | Loss=0.03041 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.179 | 4124.0 samples/s | 64.4 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02183 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.179 | 4362.6 samples/s | 68.2 steps/s
[Step=16150 Epoch=78.7] | Loss=0.01838 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.354 | L2-Norm(final)=3.180 | 4409.2 samples/s | 68.9 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01636 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.181 | 5804.5 samples/s | 90.7 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01467 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.357 | L2-Norm(final)=3.182 | 1699.5 samples/s | 26.6 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01321 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.359 | L2-Norm(final)=3.183 | 4502.0 samples/s | 70.3 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01212 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.184 | 4440.2 samples/s | 69.4 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01129 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.186 | 5562.7 samples/s | 86.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01061 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.187 | 1733.2 samples/s | 27.1 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01014 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.188 | 4381.5 samples/s | 68.5 steps/s
[Step=16550 Epoch=80.6] | Loss=0.00963 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=3.190 | 4539.9 samples/s | 70.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00928 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.191 | 5171.9 samples/s | 80.8 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00886 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.192 | 1790.3 samples/s | 28.0 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00854 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.194 | 4332.3 samples/s | 67.7 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00826 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.195 | 4337.5 samples/s | 67.8 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00798 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.197 | 4891.6 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=159.2] | Loss=0.05727 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.342 | L2-Norm(final)=3.180 | 3805.0 samples/s | 59.5 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00528 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.181 | 3683.1 samples/s | 57.5 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00270 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.182 | 5610.5 samples/s | 87.7 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00182 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.183 | 1667.1 samples/s | 26.0 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00138 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.183 | 5324.3 samples/s | 83.2 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00112 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.184 | 1701.9 samples/s | 26.6 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00094 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.184 | 4778.5 samples/s | 74.7 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00081 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.184 | 1751.1 samples/s | 27.4 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00071 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.185 | 4524.3 samples/s | 70.7 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.185 | 1793.2 samples/s | 28.0 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.185 | 4226.0 samples/s | 66.0 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00053 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.185 | 1840.7 samples/s | 28.8 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.186 | 4314.3 samples/s | 67.4 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.186 | 1821.1 samples/s | 28.5 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.186 | 4340.7 samples/s | 67.8 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.186 | 1881.9 samples/s | 29.4 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.187 | 4227.9 samples/s | 66.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=9601 Epoch=91.3] | Loss=0.05651 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.342 | L2-Norm(final)=3.181 | 3369.9 samples/s | 52.7 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00430 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.182 | 3822.5 samples/s | 59.7 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00220 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.182 | 5488.9 samples/s | 85.8 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00148 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.183 | 1649.7 samples/s | 25.8 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00113 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.183 | 5102.9 samples/s | 79.7 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00091 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.183 | 1716.8 samples/s | 26.8 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00076 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.184 | 5003.5 samples/s | 78.2 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00066 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.184 | 1736.7 samples/s | 27.1 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.184 | 4482.9 samples/s | 70.0 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.184 | 1766.8 samples/s | 27.6 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.185 | 4358.9 samples/s | 68.1 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.185 | 1796.8 samples/s | 28.1 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.185 | 4294.1 samples/s | 67.1 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.185 | 1881.1 samples/s | 29.4 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.185 | 4284.4 samples/s | 66.9 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.186 | 1819.2 samples/s | 28.4 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00030 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.186 | 4147.8 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=191.0] | Loss=0.00587 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.181 | 3722.4 samples/s | 58.2 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00418 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.182 | 3826.1 samples/s | 59.8 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00217 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.183 | 5627.3 samples/s | 87.9 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00146 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.184 | 1658.2 samples/s | 25.9 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00110 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.184 | 5396.9 samples/s | 84.3 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00089 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.185 | 1708.1 samples/s | 26.7 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00075 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.185 | 5092.5 samples/s | 79.6 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.186 | 1724.5 samples/s | 26.9 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00057 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.186 | 4853.2 samples/s | 75.8 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00051 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.186 | 1718.8 samples/s | 26.9 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00046 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.186 | 4524.2 samples/s | 70.7 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.187 | 1718.7 samples/s | 26.9 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.187 | 4301.7 samples/s | 67.2 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.187 | 1799.7 samples/s | 28.1 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00033 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.187 | 4056.5 samples/s | 63.4 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00031 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=3.188 | 1835.5 samples/s | 28.7 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00029 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=3.188 | 4074.9 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29627 | acc=0.8515 | tpr=0.7877 | fpr=0.0099 | 3896.6 samples/s | 15.2 steps/s
Avg test loss: 0.29663, Avg test acc: 0.85283, Avg tpr: 0.79076, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.36105 | acc=0.8855 | tpr=0.9735 | fpr=0.1160 | 3891.0 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.36230 | acc=0.8858 | tpr=0.9787 | fpr=0.1160 | 7226.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.36946 | acc=0.8864 | tpr=0.9798 | fpr=0.1153 | 7665.1 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.37249 | acc=0.8863 | tpr=0.9749 | fpr=0.1153 | 7541.0 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.37295 | acc=0.8856 | tpr=0.9721 | fpr=0.1159 | 7609.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.37693 | acc=0.8852 | tpr=0.9731 | fpr=0.1164 | 7301.7 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.37748 | acc=0.8852 | tpr=0.9731 | fpr=0.1164 | 7335.3 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.37828 | acc=0.8853 | tpr=0.9705 | fpr=0.1163 | 7853.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.38175 | acc=0.8851 | tpr=0.9698 | fpr=0.1164 | 7737.8 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.38218 | acc=0.8850 | tpr=0.9718 | fpr=0.1165 | 7457.6 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.38094 | acc=0.8852 | tpr=0.9706 | fpr=0.1163 | 14051.3 samples/s | 54.9 steps/s
Avg test loss: 0.38055, Avg test acc: 0.88528, Avg tpr: 0.97029, Avg fpr: 0.11626, total FA: 16143

server round 44/50

clients selected: [2 3 4 7 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.09947 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.340 | L2-Norm(final)=3.191 | 3749.8 samples/s | 58.6 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03128 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.345 | L2-Norm(final)=3.190 | 3922.3 samples/s | 61.3 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02230 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.348 | L2-Norm(final)=3.190 | 4257.1 samples/s | 66.5 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01864 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.350 | L2-Norm(final)=3.190 | 4326.8 samples/s | 67.6 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01666 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.191 | 6046.0 samples/s | 94.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01447 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.193 | 1695.7 samples/s | 26.5 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01292 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.354 | L2-Norm(final)=3.194 | 4374.8 samples/s | 68.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01202 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.195 | 4511.2 samples/s | 70.5 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01121 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.196 | 5555.1 samples/s | 86.8 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.198 | 1740.4 samples/s | 27.2 steps/s
[Step=17300 Epoch=84.3] | Loss=0.00991 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.199 | 4348.4 samples/s | 67.9 steps/s
[Step=17350 Epoch=84.5] | Loss=0.00945 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.201 | 4274.8 samples/s | 66.8 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00901 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.202 | 5213.2 samples/s | 81.5 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00858 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.204 | 1774.1 samples/s | 27.7 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00825 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.205 | 4434.6 samples/s | 69.3 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00797 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=3.207 | 4428.6 samples/s | 69.2 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00770 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.208 | 4876.2 samples/s | 76.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.7] | Loss=0.10696 | Reg=0.00178 | acc=0.9219 | L2-Norm=13.340 | L2-Norm(final)=3.191 | 3586.5 samples/s | 56.0 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02820 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.349 | L2-Norm(final)=3.192 | 4060.6 samples/s | 63.4 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02122 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.353 | L2-Norm(final)=3.192 | 4315.7 samples/s | 67.4 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01747 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.193 | 4408.2 samples/s | 68.9 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01498 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.194 | 5793.7 samples/s | 90.5 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01330 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.196 | 1679.6 samples/s | 26.2 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01182 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.198 | 4441.7 samples/s | 69.4 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01088 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.199 | 4464.0 samples/s | 69.7 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.201 | 5354.6 samples/s | 83.7 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00935 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=3.202 | 1737.8 samples/s | 27.2 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00876 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.204 | 4338.3 samples/s | 67.8 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00833 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.206 | 4452.8 samples/s | 69.6 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00795 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.207 | 5121.3 samples/s | 80.0 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00762 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.209 | 1780.0 samples/s | 27.8 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00728 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.211 | 4497.2 samples/s | 70.3 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00706 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.212 | 4457.8 samples/s | 69.7 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00682 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=3.214 | 4860.5 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step19200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=94.2] | Loss=0.09347 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.340 | L2-Norm(final)=3.191 | 3685.8 samples/s | 57.6 steps/s
[Step=19250 Epoch=94.4] | Loss=0.02931 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.346 | L2-Norm(final)=3.190 | 4167.6 samples/s | 65.1 steps/s
[Step=19300 Epoch=94.6] | Loss=0.02009 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.349 | L2-Norm(final)=3.190 | 4450.7 samples/s | 69.5 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01663 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.192 | 4512.8 samples/s | 70.5 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01421 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.193 | 5950.4 samples/s | 93.0 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01228 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.195 | 1692.1 samples/s | 26.4 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01100 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.196 | 4463.1 samples/s | 69.7 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01021 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.198 | 4502.5 samples/s | 70.4 steps/s
[Step=19600 Epoch=96.1] | Loss=0.00950 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.200 | 5763.7 samples/s | 90.1 steps/s
[Step=19650 Epoch=96.4] | Loss=0.00889 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.201 | 1728.6 samples/s | 27.0 steps/s
[Step=19700 Epoch=96.6] | Loss=0.00838 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.203 | 4415.3 samples/s | 69.0 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00788 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.205 | 4440.3 samples/s | 69.4 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00753 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.206 | 5528.2 samples/s | 86.4 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00719 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.208 | 1740.0 samples/s | 27.2 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00697 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.369 | L2-Norm(final)=3.209 | 4396.7 samples/s | 68.7 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00670 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=3.211 | 4349.7 samples/s | 68.0 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00649 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=3.213 | 5243.5 samples/s | 81.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=198.6] | Loss=0.06940 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.340 | L2-Norm(final)=3.191 | 3566.1 samples/s | 55.7 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00469 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.193 | 4020.7 samples/s | 62.8 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00239 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.194 | 5747.9 samples/s | 89.8 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00160 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.194 | 1675.5 samples/s | 26.2 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00121 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.194 | 5442.3 samples/s | 85.0 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00097 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.195 | 1690.4 samples/s | 26.4 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00081 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.195 | 4889.5 samples/s | 76.4 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00070 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.195 | 1753.9 samples/s | 27.4 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00061 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.195 | 4733.6 samples/s | 74.0 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.195 | 1772.3 samples/s | 27.7 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.195 | 4526.8 samples/s | 70.7 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.196 | 1802.1 samples/s | 28.2 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.196 | 4305.5 samples/s | 67.3 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.196 | 1797.9 samples/s | 28.1 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.196 | 4321.9 samples/s | 67.5 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.196 | 1839.5 samples/s | 28.7 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.196 | 4341.6 samples/s | 67.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=129.6] | Loss=0.05049 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.340 | L2-Norm(final)=3.191 | 3310.7 samples/s | 51.7 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00420 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.192 | 4252.0 samples/s | 66.4 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00215 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.193 | 5893.0 samples/s | 92.1 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00146 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.194 | 1652.6 samples/s | 25.8 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00111 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.194 | 5272.4 samples/s | 82.4 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00090 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.195 | 1687.4 samples/s | 26.4 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00075 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.195 | 5037.7 samples/s | 78.7 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00065 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.195 | 1729.9 samples/s | 27.0 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00057 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.196 | 4634.2 samples/s | 72.4 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00051 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.196 | 1747.1 samples/s | 27.3 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.196 | 4467.7 samples/s | 69.8 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.196 | 1764.5 samples/s | 27.6 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.197 | 4281.6 samples/s | 66.9 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.197 | 1820.1 samples/s | 28.4 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.197 | 4370.3 samples/s | 68.3 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.197 | 1843.9 samples/s | 28.8 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00030 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.198 | 4314.2 samples/s | 67.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30338 | acc=0.8480 | tpr=0.7824 | fpr=0.0094 | 3872.7 samples/s | 15.1 steps/s
Avg test loss: 0.30347, Avg test acc: 0.84959, Avg tpr: 0.78592, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.35519 | acc=0.8890 | tpr=0.9735 | fpr=0.1125 | 3839.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.35654 | acc=0.8893 | tpr=0.9808 | fpr=0.1124 | 7810.7 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.36400 | acc=0.8896 | tpr=0.9798 | fpr=0.1120 | 7668.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.36720 | acc=0.8895 | tpr=0.9749 | fpr=0.1120 | 7215.5 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.36754 | acc=0.8888 | tpr=0.9721 | fpr=0.1127 | 7579.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.37157 | acc=0.8885 | tpr=0.9731 | fpr=0.1131 | 7819.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.37219 | acc=0.8886 | tpr=0.9731 | fpr=0.1129 | 7238.2 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.37306 | acc=0.8885 | tpr=0.9705 | fpr=0.1130 | 7671.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.37657 | acc=0.8883 | tpr=0.9698 | fpr=0.1131 | 7287.6 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.37701 | acc=0.8882 | tpr=0.9718 | fpr=0.1133 | 7303.2 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.37576 | acc=0.8885 | tpr=0.9706 | fpr=0.1130 | 14072.5 samples/s | 55.0 steps/s
Avg test loss: 0.37538, Avg test acc: 0.88854, Avg tpr: 0.97029, Avg fpr: 0.11294, total FA: 15682

server round 45/50

clients selected: [0 3 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24001 Epoch=117.0] | Loss=0.07940 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.337 | L2-Norm(final)=3.202 | 3902.3 samples/s | 61.0 steps/s
[Step=24050 Epoch=117.3] | Loss=0.04238 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.344 | L2-Norm(final)=3.200 | 4112.7 samples/s | 64.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02877 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.199 | 4372.8 samples/s | 68.3 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02265 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.347 | L2-Norm(final)=3.199 | 4508.1 samples/s | 70.4 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01926 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.200 | 6038.9 samples/s | 94.4 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01649 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.201 | 1649.8 samples/s | 25.8 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01462 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.202 | 4545.3 samples/s | 71.0 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01357 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.203 | 4432.1 samples/s | 69.3 steps/s
[Step=24400 Epoch=119.0] | Loss=0.01244 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.204 | 5599.4 samples/s | 87.5 steps/s
[Step=24450 Epoch=119.2] | Loss=0.01146 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.206 | 1778.7 samples/s | 27.8 steps/s
[Step=24500 Epoch=119.5] | Loss=0.01078 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.207 | 4519.8 samples/s | 70.6 steps/s
[Step=24550 Epoch=119.7] | Loss=0.01028 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.208 | 4507.0 samples/s | 70.4 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00974 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.210 | 5197.9 samples/s | 81.2 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00927 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.211 | 1767.5 samples/s | 27.6 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00894 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.212 | 4370.9 samples/s | 68.3 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00857 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.213 | 4213.1 samples/s | 65.8 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00827 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=3.215 | 4799.2 samples/s | 75.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step24800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.6] | Loss=0.18012 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.337 | L2-Norm(final)=3.202 | 3692.8 samples/s | 57.7 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03390 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.200 | 4119.4 samples/s | 64.4 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02206 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.201 | 4503.5 samples/s | 70.4 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01786 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.201 | 4322.3 samples/s | 67.5 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01547 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.203 | 5833.5 samples/s | 91.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01458 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.204 | 1721.3 samples/s | 26.9 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01334 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.206 | 4431.7 samples/s | 69.2 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01225 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.207 | 4501.9 samples/s | 70.3 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01123 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.208 | 5302.2 samples/s | 82.8 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.209 | 1766.2 samples/s | 27.6 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00972 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.211 | 4459.8 samples/s | 69.7 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00918 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.212 | 4430.5 samples/s | 69.2 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00883 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=3.213 | 5202.7 samples/s | 81.3 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00834 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.215 | 1803.1 samples/s | 28.2 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00797 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.216 | 4464.6 samples/s | 69.8 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00770 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.367 | L2-Norm(final)=3.217 | 4497.6 samples/s | 70.3 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00744 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.219 | 4779.8 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=98.1] | Loss=0.15225 | Reg=0.00178 | acc=0.9219 | L2-Norm=13.337 | L2-Norm(final)=3.202 | 3537.1 samples/s | 55.3 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02982 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.345 | L2-Norm(final)=3.201 | 4087.4 samples/s | 63.9 steps/s
[Step=20100 Epoch=98.6] | Loss=0.02090 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.349 | L2-Norm(final)=3.201 | 4390.4 samples/s | 68.6 steps/s
[Step=20150 Epoch=98.8] | Loss=0.01705 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.202 | 4427.2 samples/s | 69.2 steps/s
[Step=20200 Epoch=99.1] | Loss=0.01485 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.203 | 6044.5 samples/s | 94.4 steps/s
[Step=20250 Epoch=99.3] | Loss=0.01268 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.204 | 1678.2 samples/s | 26.2 steps/s
[Step=20300 Epoch=99.5] | Loss=0.01121 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.206 | 4219.0 samples/s | 65.9 steps/s
[Step=20350 Epoch=99.8] | Loss=0.01016 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.207 | 4406.8 samples/s | 68.9 steps/s
[Step=20400 Epoch=100.0] | Loss=0.00960 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=3.209 | 5672.1 samples/s | 88.6 steps/s
[Step=20450 Epoch=100.3] | Loss=0.00899 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.210 | 1722.7 samples/s | 26.9 steps/s
[Step=20500 Epoch=100.5] | Loss=0.00843 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.211 | 4157.9 samples/s | 65.0 steps/s
[Step=20550 Epoch=100.8] | Loss=0.00802 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.213 | 4486.3 samples/s | 70.1 steps/s
[Step=20600 Epoch=101.0] | Loss=0.00766 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.215 | 5468.9 samples/s | 85.5 steps/s
[Step=20650 Epoch=101.3] | Loss=0.00730 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.216 | 1755.0 samples/s | 27.4 steps/s
[Step=20700 Epoch=101.5] | Loss=0.00701 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.217 | 4433.8 samples/s | 69.3 steps/s
[Step=20750 Epoch=101.8] | Loss=0.00670 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=3.219 | 4385.6 samples/s | 68.5 steps/s
[Step=20800 Epoch=102.0] | Loss=0.00650 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=3.220 | 5302.2 samples/s | 82.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step20800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=206.3] | Loss=0.02578 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.337 | L2-Norm(final)=3.202 | 3388.5 samples/s | 52.9 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00727 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.201 | 4149.1 samples/s | 64.8 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00368 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.201 | 5843.1 samples/s | 91.3 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00247 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.201 | 1625.1 samples/s | 25.4 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00186 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.201 | 5505.5 samples/s | 86.0 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00150 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.202 | 1690.8 samples/s | 26.4 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00125 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.202 | 5025.6 samples/s | 78.5 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00108 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.202 | 1731.4 samples/s | 27.1 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00095 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.203 | 4866.6 samples/s | 76.0 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00085 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.203 | 1770.4 samples/s | 27.7 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00076 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.203 | 4354.8 samples/s | 68.0 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00070 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.203 | 1793.4 samples/s | 28.0 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.204 | 4225.3 samples/s | 66.0 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00059 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.204 | 1842.9 samples/s | 28.8 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.204 | 4206.3 samples/s | 65.7 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.204 | 1845.2 samples/s | 28.8 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.205 | 4142.9 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step22400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=158.3] | Loss=0.14725 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.337 | L2-Norm(final)=3.202 | 3824.0 samples/s | 59.7 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00689 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.202 | 3560.3 samples/s | 55.6 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00350 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.202 | 5361.8 samples/s | 83.8 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00235 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.203 | 1681.1 samples/s | 26.3 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00178 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.203 | 5097.5 samples/s | 79.6 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00143 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.204 | 1728.3 samples/s | 27.0 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00120 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.204 | 4598.3 samples/s | 71.8 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00104 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.204 | 1775.9 samples/s | 27.7 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00091 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.205 | 4443.9 samples/s | 69.4 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00081 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.205 | 1778.1 samples/s | 27.8 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00074 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.205 | 4074.3 samples/s | 63.7 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.205 | 1841.6 samples/s | 28.8 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00062 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.206 | 4232.2 samples/s | 66.1 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00057 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.206 | 1865.7 samples/s | 29.2 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00053 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.206 | 4285.5 samples/s | 67.0 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.207 | 1972.7 samples/s | 30.8 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.207 | 3541.2 samples/s | 55.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29305 | acc=0.8525 | tpr=0.7891 | fpr=0.0099 | 4021.0 samples/s | 15.7 steps/s
Avg test loss: 0.29339, Avg test acc: 0.85512, Avg tpr: 0.79402, Avg fpr: 0.01051, total FA: 82

Testing server on iccad2012
[Step=  50] | Loss=0.36307 | acc=0.8854 | tpr=0.9735 | fpr=0.1162 | 3872.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.36462 | acc=0.8857 | tpr=0.9787 | fpr=0.1161 | 7423.5 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.37199 | acc=0.8863 | tpr=0.9798 | fpr=0.1154 | 7397.8 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.37510 | acc=0.8860 | tpr=0.9749 | fpr=0.1156 | 7514.5 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.37554 | acc=0.8854 | tpr=0.9721 | fpr=0.1162 | 7688.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.37944 | acc=0.8851 | tpr=0.9731 | fpr=0.1165 | 7814.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.37997 | acc=0.8852 | tpr=0.9731 | fpr=0.1164 | 7086.4 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.38077 | acc=0.8852 | tpr=0.9705 | fpr=0.1164 | 7777.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.38433 | acc=0.8850 | tpr=0.9698 | fpr=0.1165 | 7487.2 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.38482 | acc=0.8847 | tpr=0.9714 | fpr=0.1168 | 7385.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.38358 | acc=0.8850 | tpr=0.9702 | fpr=0.1165 | 14215.9 samples/s | 55.5 steps/s
Avg test loss: 0.38319, Avg test acc: 0.88504, Avg tpr: 0.96989, Avg fpr: 0.11650, total FA: 16176

server round 46/50

clients selected: [0 3 5 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24801 Epoch=120.9] | Loss=0.04528 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.336 | L2-Norm(final)=3.215 | 3711.2 samples/s | 58.0 steps/s
[Step=24850 Epoch=121.2] | Loss=0.03800 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.343 | L2-Norm(final)=3.213 | 4073.6 samples/s | 63.6 steps/s
[Step=24900 Epoch=121.4] | Loss=0.02561 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.213 | 4373.7 samples/s | 68.3 steps/s
[Step=24950 Epoch=121.7] | Loss=0.02051 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.347 | L2-Norm(final)=3.213 | 4396.7 samples/s | 68.7 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01779 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.214 | 6040.9 samples/s | 94.4 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01534 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.215 | 1720.3 samples/s | 26.9 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01363 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.351 | L2-Norm(final)=3.216 | 4415.1 samples/s | 69.0 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01228 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.217 | 4415.0 samples/s | 69.0 steps/s
[Step=25200 Epoch=122.9] | Loss=0.01153 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.354 | L2-Norm(final)=3.219 | 5553.8 samples/s | 86.8 steps/s
[Step=25250 Epoch=123.1] | Loss=0.01068 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.220 | 1728.9 samples/s | 27.0 steps/s
[Step=25300 Epoch=123.4] | Loss=0.01002 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.221 | 4281.3 samples/s | 66.9 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00943 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.223 | 4462.9 samples/s | 69.7 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00903 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.224 | 4966.8 samples/s | 77.6 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00867 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.225 | 1792.6 samples/s | 28.0 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00831 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.227 | 4464.6 samples/s | 69.8 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00799 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.228 | 4433.6 samples/s | 69.3 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00772 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.229 | 4862.9 samples/s | 76.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step25600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=97.5] | Loss=0.14694 | Reg=0.00178 | acc=0.9219 | L2-Norm=13.336 | L2-Norm(final)=3.215 | 3841.4 samples/s | 60.0 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02863 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.345 | L2-Norm(final)=3.215 | 4230.8 samples/s | 66.1 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01973 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.215 | 4442.6 samples/s | 69.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01684 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.350 | L2-Norm(final)=3.216 | 4300.1 samples/s | 67.2 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01496 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.217 | 6037.1 samples/s | 94.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01303 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.354 | L2-Norm(final)=3.219 | 1694.5 samples/s | 26.5 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01166 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.220 | 4444.0 samples/s | 69.4 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.221 | 4481.7 samples/s | 70.0 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00984 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.223 | 5472.3 samples/s | 85.5 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00918 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.224 | 1769.8 samples/s | 27.7 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00860 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.226 | 4389.2 samples/s | 68.6 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00825 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.227 | 4461.7 samples/s | 69.7 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00788 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.228 | 5092.3 samples/s | 79.6 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00749 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.230 | 1744.6 samples/s | 27.3 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00716 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.231 | 4178.5 samples/s | 65.3 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00694 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.233 | 4388.7 samples/s | 68.6 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00666 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=3.234 | 4909.8 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step20800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=166.8] | Loss=0.02045 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.336 | L2-Norm(final)=3.215 | 3417.8 samples/s | 53.4 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00492 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.216 | 4205.2 samples/s | 65.7 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00250 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.216 | 5791.9 samples/s | 90.5 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00168 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.217 | 1680.4 samples/s | 26.3 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00127 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.217 | 5257.3 samples/s | 82.1 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00102 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.217 | 1685.2 samples/s | 26.3 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00086 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.217 | 4727.9 samples/s | 73.9 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00074 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.218 | 1758.1 samples/s | 27.5 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00065 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.218 | 4584.9 samples/s | 71.6 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.218 | 1788.8 samples/s | 28.0 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00053 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.218 | 4311.6 samples/s | 67.4 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.219 | 1818.9 samples/s | 28.4 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.219 | 4292.7 samples/s | 67.1 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00041 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.219 | 1821.3 samples/s | 28.5 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.219 | 4224.7 samples/s | 66.0 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.220 | 1852.6 samples/s | 28.9 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.220 | 4309.0 samples/s | 67.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=10401 Epoch=98.9] | Loss=0.02725 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.336 | L2-Norm(final)=3.215 | 3482.3 samples/s | 54.4 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00572 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.215 | 4052.7 samples/s | 63.3 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00290 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.216 | 5671.7 samples/s | 88.6 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00195 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.217 | 1657.4 samples/s | 25.9 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00147 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.217 | 5182.5 samples/s | 81.0 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00118 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.217 | 1678.9 samples/s | 26.2 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00099 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.217 | 4977.3 samples/s | 77.8 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00085 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.218 | 1737.4 samples/s | 27.1 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00075 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.218 | 4594.7 samples/s | 71.8 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.218 | 1760.3 samples/s | 27.5 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00060 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.218 | 4338.1 samples/s | 67.8 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.218 | 1828.1 samples/s | 28.6 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00051 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.219 | 4296.4 samples/s | 67.1 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.219 | 1846.2 samples/s | 28.8 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.219 | 4379.1 samples/s | 68.4 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00041 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.219 | 1875.7 samples/s | 29.3 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.219 | 4052.6 samples/s | 63.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=165.9] | Loss=0.03886 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.336 | L2-Norm(final)=3.215 | 3503.6 samples/s | 54.7 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00301 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.218 | 4211.8 samples/s | 65.8 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00163 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.219 | 5567.2 samples/s | 87.0 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00111 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.220 | 1673.9 samples/s | 26.2 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00084 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.221 | 5177.0 samples/s | 80.9 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00069 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.221 | 1724.8 samples/s | 27.0 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.222 | 4832.9 samples/s | 75.5 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.222 | 1761.2 samples/s | 27.5 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.222 | 4391.6 samples/s | 68.6 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.223 | 1762.3 samples/s | 27.5 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.223 | 4261.9 samples/s | 66.6 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00033 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.223 | 1860.8 samples/s | 29.1 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00030 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.223 | 4333.8 samples/s | 67.7 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00028 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.224 | 1856.0 samples/s | 29.0 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00026 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.224 | 4245.2 samples/s | 66.3 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00025 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.224 | 1897.1 samples/s | 29.6 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00023 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.224 | 3916.7 samples/s | 61.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28982 | acc=0.8561 | tpr=0.7940 | fpr=0.0092 | 3856.8 samples/s | 15.1 steps/s
Avg test loss: 0.29010, Avg test acc: 0.85764, Avg tpr: 0.79746, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.37219 | acc=0.8834 | tpr=0.9735 | fpr=0.1182 | 3817.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37368 | acc=0.8838 | tpr=0.9808 | fpr=0.1180 | 7779.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.38133 | acc=0.8841 | tpr=0.9813 | fpr=0.1177 | 7631.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.38435 | acc=0.8841 | tpr=0.9760 | fpr=0.1175 | 7659.9 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.38496 | acc=0.8833 | tpr=0.9729 | fpr=0.1183 | 7565.7 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.38887 | acc=0.8829 | tpr=0.9738 | fpr=0.1188 | 7511.3 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.38941 | acc=0.8831 | tpr=0.9737 | fpr=0.1185 | 7690.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.39011 | acc=0.8830 | tpr=0.9716 | fpr=0.1186 | 7337.7 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.39366 | acc=0.8829 | tpr=0.9718 | fpr=0.1187 | 7490.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.39429 | acc=0.8827 | tpr=0.9727 | fpr=0.1190 | 7731.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.39300 | acc=0.8829 | tpr=0.9713 | fpr=0.1187 | 13788.8 samples/s | 53.9 steps/s
Avg test loss: 0.39261, Avg test acc: 0.88290, Avg tpr: 0.97147, Avg fpr: 0.11871, total FA: 16482

server round 47/50

clients selected: [1 2 4 5 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.8] | Loss=0.18948 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.335 | L2-Norm(final)=3.226 | 3700.1 samples/s | 57.8 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03684 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.345 | L2-Norm(final)=3.225 | 4276.9 samples/s | 66.8 steps/s
[Step=18500 Epoch=90.3] | Loss=0.02474 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.224 | 4538.5 samples/s | 70.9 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01988 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.224 | 4401.4 samples/s | 68.8 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01689 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.350 | L2-Norm(final)=3.225 | 5696.9 samples/s | 89.0 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01441 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.226 | 1712.1 samples/s | 26.8 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01294 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.352 | L2-Norm(final)=3.227 | 4487.2 samples/s | 70.1 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01187 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.353 | L2-Norm(final)=3.228 | 4505.4 samples/s | 70.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01089 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.229 | 5683.0 samples/s | 88.8 steps/s
[Step=18850 Epoch=92.0] | Loss=0.00998 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.230 | 1719.7 samples/s | 26.9 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00930 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.232 | 4460.6 samples/s | 69.7 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00882 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.233 | 4503.0 samples/s | 70.4 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00848 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.234 | 5302.8 samples/s | 82.9 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00811 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=3.236 | 1760.5 samples/s | 27.5 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00782 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.237 | 4430.5 samples/s | 69.2 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00750 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.238 | 4438.5 samples/s | 69.4 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00721 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.239 | 5024.4 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.14476 | Reg=0.00178 | acc=0.9062 | L2-Norm=13.335 | L2-Norm(final)=3.226 | 3683.8 samples/s | 57.6 steps/s
[Step=17650 Epoch=86.0] | Loss=0.02894 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.226 | 3954.3 samples/s | 61.8 steps/s
[Step=17700 Epoch=86.2] | Loss=0.02024 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.226 | 4259.0 samples/s | 66.5 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01706 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.226 | 4512.1 samples/s | 70.5 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01513 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.227 | 5872.4 samples/s | 91.8 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01308 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.228 | 1717.3 samples/s | 26.8 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01167 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.230 | 4306.6 samples/s | 67.3 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01077 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.231 | 4465.1 samples/s | 69.8 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01027 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.233 | 5511.1 samples/s | 86.1 steps/s
[Step=18050 Epoch=87.9] | Loss=0.00969 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.234 | 1729.6 samples/s | 27.0 steps/s
[Step=18100 Epoch=88.2] | Loss=0.00918 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.235 | 4405.3 samples/s | 68.8 steps/s
[Step=18150 Epoch=88.4] | Loss=0.00869 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.237 | 4316.5 samples/s | 67.4 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00826 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.238 | 5016.9 samples/s | 78.4 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00799 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.240 | 1798.1 samples/s | 28.1 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00772 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.241 | 4410.0 samples/s | 68.9 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00742 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=3.243 | 4308.8 samples/s | 67.3 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00715 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.244 | 4528.8 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step18400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=102.0] | Loss=0.16030 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.335 | L2-Norm(final)=3.226 | 3642.7 samples/s | 56.9 steps/s
[Step=20850 Epoch=102.2] | Loss=0.02916 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.344 | L2-Norm(final)=3.225 | 3919.6 samples/s | 61.2 steps/s
[Step=20900 Epoch=102.5] | Loss=0.01967 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.347 | L2-Norm(final)=3.225 | 4174.1 samples/s | 65.2 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01630 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.349 | L2-Norm(final)=3.226 | 4382.6 samples/s | 68.5 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01396 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.227 | 5938.8 samples/s | 92.8 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01203 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.229 | 1679.5 samples/s | 26.2 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01062 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.230 | 4425.6 samples/s | 69.1 steps/s
[Step=21150 Epoch=103.7] | Loss=0.00983 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.232 | 4405.2 samples/s | 68.8 steps/s
[Step=21200 Epoch=104.0] | Loss=0.00914 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.233 | 5656.4 samples/s | 88.4 steps/s
[Step=21250 Epoch=104.2] | Loss=0.00850 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.235 | 1674.8 samples/s | 26.2 steps/s
[Step=21300 Epoch=104.5] | Loss=0.00799 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.236 | 4252.9 samples/s | 66.5 steps/s
[Step=21350 Epoch=104.7] | Loss=0.00757 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.238 | 4444.7 samples/s | 69.4 steps/s
[Step=21400 Epoch=104.9] | Loss=0.00727 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=3.239 | 5508.2 samples/s | 86.1 steps/s
[Step=21450 Epoch=105.2] | Loss=0.00695 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=3.241 | 1693.2 samples/s | 26.5 steps/s
[Step=21500 Epoch=105.4] | Loss=0.00668 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=3.242 | 4227.5 samples/s | 66.1 steps/s
[Step=21550 Epoch=105.7] | Loss=0.00640 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=3.243 | 4287.7 samples/s | 67.0 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00617 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=3.245 | 5127.7 samples/s | 80.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_4/client_state-step21600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=174.4] | Loss=0.03930 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.335 | L2-Norm(final)=3.226 | 3552.2 samples/s | 55.5 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00344 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.228 | 3716.0 samples/s | 58.1 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00178 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.229 | 5686.6 samples/s | 88.9 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00121 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.229 | 1670.7 samples/s | 26.1 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00091 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.230 | 5328.6 samples/s | 83.3 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00074 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.230 | 1624.4 samples/s | 25.4 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00062 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.231 | 4904.9 samples/s | 76.6 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00054 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.231 | 1770.8 samples/s | 27.7 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.231 | 4609.4 samples/s | 72.0 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.231 | 1798.3 samples/s | 28.1 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.232 | 4338.1 samples/s | 67.8 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.232 | 1855.1 samples/s | 29.0 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.232 | 4143.1 samples/s | 64.7 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00030 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.232 | 1801.3 samples/s | 28.1 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00028 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.233 | 4279.2 samples/s | 66.9 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00026 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.233 | 1845.0 samples/s | 28.8 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00025 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=3.233 | 4163.4 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=137.3] | Loss=0.05480 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.335 | L2-Norm(final)=3.226 | 3505.7 samples/s | 54.8 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00507 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.226 | 3854.8 samples/s | 60.2 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00258 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.227 | 5899.0 samples/s | 92.2 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00174 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.227 | 1631.8 samples/s | 25.5 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00132 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.227 | 5397.8 samples/s | 84.3 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00106 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.228 | 1692.7 samples/s | 26.4 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00089 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.228 | 5067.4 samples/s | 79.2 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00077 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.228 | 1694.9 samples/s | 26.5 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00068 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.229 | 4825.7 samples/s | 75.4 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00061 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.229 | 1716.9 samples/s | 26.8 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.229 | 4322.1 samples/s | 67.5 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.229 | 1773.5 samples/s | 27.7 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00046 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.230 | 4210.3 samples/s | 65.8 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.230 | 1822.8 samples/s | 28.5 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.230 | 4113.3 samples/s | 64.3 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=3.230 | 1831.3 samples/s | 28.6 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=3.230 | 4167.7 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29357 | acc=0.8552 | tpr=0.7927 | fpr=0.0092 | 3841.4 samples/s | 15.0 steps/s
Avg test loss: 0.29350, Avg test acc: 0.85692, Avg tpr: 0.79635, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.36941 | acc=0.8856 | tpr=0.9735 | fpr=0.1160 | 3812.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37093 | acc=0.8861 | tpr=0.9787 | fpr=0.1156 | 7450.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.37877 | acc=0.8863 | tpr=0.9798 | fpr=0.1154 | 7442.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.38193 | acc=0.8862 | tpr=0.9749 | fpr=0.1154 | 7802.4 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.38246 | acc=0.8853 | tpr=0.9721 | fpr=0.1162 | 7561.9 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.38633 | acc=0.8849 | tpr=0.9731 | fpr=0.1167 | 7538.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.38693 | acc=0.8851 | tpr=0.9731 | fpr=0.1165 | 7656.7 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.38761 | acc=0.8849 | tpr=0.9710 | fpr=0.1166 | 6962.1 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.39118 | acc=0.8847 | tpr=0.9713 | fpr=0.1169 | 7665.5 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.39182 | acc=0.8845 | tpr=0.9722 | fpr=0.1171 | 7229.3 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.39060 | acc=0.8847 | tpr=0.9713 | fpr=0.1168 | 13521.3 samples/s | 52.8 steps/s
Avg test loss: 0.39021, Avg test acc: 0.88479, Avg tpr: 0.97147, Avg fpr: 0.11679, total FA: 16216

server round 48/50

clients selected: [0 2 3 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=25601 Epoch=124.8] | Loss=0.30909 | Reg=0.00178 | acc=0.8750 | L2-Norm=13.332 | L2-Norm(final)=3.242 | 3639.2 samples/s | 56.9 steps/s
[Step=25650 Epoch=125.1] | Loss=0.03622 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=3.242 | 4253.6 samples/s | 66.5 steps/s
[Step=25700 Epoch=125.3] | Loss=0.02374 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.343 | L2-Norm(final)=3.242 | 4337.4 samples/s | 67.8 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01914 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.345 | L2-Norm(final)=3.243 | 4517.8 samples/s | 70.6 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01691 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.244 | 5941.4 samples/s | 92.8 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01448 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.245 | 1734.6 samples/s | 27.1 steps/s
[Step=25900 Epoch=126.3] | Loss=0.01277 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.247 | 4498.4 samples/s | 70.3 steps/s
[Step=25950 Epoch=126.5] | Loss=0.01182 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.248 | 4443.5 samples/s | 69.4 steps/s
[Step=26000 Epoch=126.8] | Loss=0.01100 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.249 | 5465.1 samples/s | 85.4 steps/s
[Step=26050 Epoch=127.0] | Loss=0.01019 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.251 | 1762.1 samples/s | 27.5 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00943 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.252 | 4363.8 samples/s | 68.2 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00900 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.253 | 4436.1 samples/s | 69.3 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00872 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.357 | L2-Norm(final)=3.255 | 4975.5 samples/s | 77.7 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00827 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.256 | 1754.8 samples/s | 27.4 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00795 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.257 | 4432.0 samples/s | 69.2 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00766 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.258 | 4400.1 samples/s | 68.8 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00740 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.260 | 4724.2 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_0/client_state-step26400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.7] | Loss=0.20284 | Reg=0.00178 | acc=0.9062 | L2-Norm=13.332 | L2-Norm(final)=3.242 | 3515.8 samples/s | 54.9 steps/s
[Step=18450 Epoch=89.9] | Loss=0.03252 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.339 | L2-Norm(final)=3.241 | 4235.8 samples/s | 66.2 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02190 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.240 | 4360.0 samples/s | 68.1 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01825 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.241 | 4318.2 samples/s | 67.5 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01593 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.242 | 5789.3 samples/s | 90.5 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01394 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.243 | 1681.6 samples/s | 26.3 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01252 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.347 | L2-Norm(final)=3.244 | 4422.3 samples/s | 69.1 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01146 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.348 | L2-Norm(final)=3.245 | 4484.2 samples/s | 70.1 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01066 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.350 | L2-Norm(final)=3.247 | 5503.1 samples/s | 86.0 steps/s
[Step=18850 Epoch=91.8] | Loss=0.00995 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.248 | 1754.3 samples/s | 27.4 steps/s
[Step=18900 Epoch=92.1] | Loss=0.00949 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.249 | 4527.5 samples/s | 70.7 steps/s
[Step=18950 Epoch=92.3] | Loss=0.00892 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.251 | 4273.3 samples/s | 66.8 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00852 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.252 | 5045.8 samples/s | 78.8 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00820 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.254 | 1798.3 samples/s | 28.1 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00787 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.255 | 4448.2 samples/s | 69.5 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00756 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.256 | 4424.3 samples/s | 69.1 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00739 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.359 | L2-Norm(final)=3.258 | 4814.3 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=101.4] | Loss=0.16587 | Reg=0.00178 | acc=0.8125 | L2-Norm=13.332 | L2-Norm(final)=3.242 | 3537.6 samples/s | 55.3 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02881 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.341 | L2-Norm(final)=3.243 | 4282.2 samples/s | 66.9 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01983 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.344 | L2-Norm(final)=3.243 | 4534.5 samples/s | 70.9 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01608 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.244 | 4498.8 samples/s | 70.3 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01409 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.245 | 6016.1 samples/s | 94.0 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01212 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.247 | 1655.1 samples/s | 25.9 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01069 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.248 | 4388.9 samples/s | 68.6 steps/s
[Step=21150 Epoch=103.1] | Loss=0.00993 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.249 | 4153.3 samples/s | 64.9 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00932 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.251 | 5485.1 samples/s | 85.7 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00880 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.252 | 1751.5 samples/s | 27.4 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00835 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=3.254 | 4350.6 samples/s | 68.0 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00792 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.255 | 4220.8 samples/s | 66.0 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00750 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.256 | 4886.1 samples/s | 76.3 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00718 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.359 | L2-Norm(final)=3.258 | 1744.1 samples/s | 27.3 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00687 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.259 | 4367.5 samples/s | 68.2 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00662 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.261 | 4404.1 samples/s | 68.8 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00643 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.363 | L2-Norm(final)=3.262 | 4696.5 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step21600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=181.9] | Loss=0.08146 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.332 | L2-Norm(final)=3.242 | 3694.4 samples/s | 57.7 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00560 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.242 | 3821.8 samples/s | 59.7 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00284 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.242 | 5797.5 samples/s | 90.6 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00191 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.242 | 1662.3 samples/s | 26.0 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00144 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.242 | 5141.4 samples/s | 80.3 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00116 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.242 | 1698.2 samples/s | 26.5 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00097 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.243 | 4885.0 samples/s | 76.3 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00084 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.243 | 1698.9 samples/s | 26.5 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00073 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.243 | 4506.7 samples/s | 70.4 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00066 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.243 | 1756.6 samples/s | 27.4 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00059 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.243 | 4230.3 samples/s | 66.1 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00054 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.244 | 1816.2 samples/s | 28.4 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.244 | 4006.6 samples/s | 62.6 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00046 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.244 | 1840.0 samples/s | 28.8 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.244 | 4161.9 samples/s | 65.0 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.245 | 1835.4 samples/s | 28.7 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.245 | 4220.0 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_0/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=213.9] | Loss=0.02597 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.332 | L2-Norm(final)=3.243 | 3822.6 samples/s | 59.7 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00308 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.245 | 3778.2 samples/s | 59.0 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00158 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.246 | 5844.3 samples/s | 91.3 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00107 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.246 | 1648.4 samples/s | 25.8 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00081 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.247 | 5182.6 samples/s | 81.0 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00065 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.247 | 1622.7 samples/s | 25.4 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00055 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.247 | 5022.2 samples/s | 78.5 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.247 | 1738.9 samples/s | 27.2 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.248 | 4740.9 samples/s | 74.1 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.248 | 1749.3 samples/s | 27.3 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.248 | 4541.2 samples/s | 71.0 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00031 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.248 | 1806.3 samples/s | 28.2 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00029 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.248 | 4262.2 samples/s | 66.6 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00026 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.249 | 1843.9 samples/s | 28.8 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00025 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=3.249 | 4356.2 samples/s | 68.1 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00023 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=3.249 | 1845.1 samples/s | 28.8 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00022 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=3.249 | 4374.4 samples/s | 68.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_2/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29721 | acc=0.8545 | tpr=0.7914 | fpr=0.0084 | 3735.8 samples/s | 14.6 steps/s
Avg test loss: 0.29729, Avg test acc: 0.85624, Avg tpr: 0.79513, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.36907 | acc=0.8878 | tpr=0.9735 | fpr=0.1137 | 3947.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.37096 | acc=0.8879 | tpr=0.9787 | fpr=0.1138 | 7647.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.37886 | acc=0.8883 | tpr=0.9798 | fpr=0.1134 | 7399.9 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.38201 | acc=0.8880 | tpr=0.9749 | fpr=0.1136 | 7468.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.38260 | acc=0.8872 | tpr=0.9721 | fpr=0.1143 | 7550.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.38648 | acc=0.8866 | tpr=0.9731 | fpr=0.1149 | 7282.7 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.38709 | acc=0.8870 | tpr=0.9731 | fpr=0.1146 | 7614.9 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.38774 | acc=0.8867 | tpr=0.9710 | fpr=0.1148 | 7168.1 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.39136 | acc=0.8865 | tpr=0.9708 | fpr=0.1150 | 7204.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.39200 | acc=0.8862 | tpr=0.9727 | fpr=0.1154 | 7363.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.39076 | acc=0.8864 | tpr=0.9717 | fpr=0.1152 | 13684.5 samples/s | 53.5 steps/s
Avg test loss: 0.39038, Avg test acc: 0.88641, Avg tpr: 0.97187, Avg fpr: 0.11515, total FA: 15988

server round 49/50

clients selected: [1 2 3 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.7] | Loss=0.20878 | Reg=0.00178 | acc=0.8594 | L2-Norm=13.330 | L2-Norm(final)=3.255 | 3769.8 samples/s | 58.9 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03622 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.338 | L2-Norm(final)=3.253 | 3925.1 samples/s | 61.3 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02414 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.252 | 4427.1 samples/s | 69.2 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01878 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.253 | 4470.0 samples/s | 69.8 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01589 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.254 | 5759.6 samples/s | 90.0 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01363 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.255 | 1662.1 samples/s | 26.0 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01195 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.256 | 4432.9 samples/s | 69.3 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01111 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.257 | 4358.3 samples/s | 68.1 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01024 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.258 | 5632.2 samples/s | 88.0 steps/s
[Step=19650 Epoch=95.9] | Loss=0.00950 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.259 | 1766.7 samples/s | 27.6 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00898 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.350 | L2-Norm(final)=3.261 | 4473.5 samples/s | 69.9 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00849 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.262 | 4478.4 samples/s | 70.0 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00813 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.263 | 5319.5 samples/s | 83.1 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00774 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.264 | 1735.0 samples/s | 27.1 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00739 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.266 | 4335.2 samples/s | 67.7 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00718 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.267 | 4148.2 samples/s | 64.8 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00693 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.268 | 4941.8 samples/s | 77.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.6] | Loss=0.08039 | Reg=0.00178 | acc=0.9219 | L2-Norm=13.330 | L2-Norm(final)=3.255 | 3447.1 samples/s | 53.9 steps/s
[Step=19250 Epoch=93.8] | Loss=0.02444 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=3.255 | 4435.6 samples/s | 69.3 steps/s
[Step=19300 Epoch=94.0] | Loss=0.01728 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.256 | 4457.5 samples/s | 69.6 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01493 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.345 | L2-Norm(final)=3.257 | 4466.5 samples/s | 69.8 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01386 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.258 | 6006.2 samples/s | 93.8 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01235 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=3.259 | 1710.8 samples/s | 26.7 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01103 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=3.260 | 4240.7 samples/s | 66.3 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01021 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.261 | 4190.7 samples/s | 65.5 steps/s
[Step=19600 Epoch=95.5] | Loss=0.00965 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.353 | L2-Norm(final)=3.262 | 5391.7 samples/s | 84.2 steps/s
[Step=19650 Epoch=95.7] | Loss=0.00903 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.354 | L2-Norm(final)=3.264 | 1730.4 samples/s | 27.0 steps/s
[Step=19700 Epoch=96.0] | Loss=0.00837 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=3.265 | 4402.6 samples/s | 68.8 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00801 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=3.266 | 4526.7 samples/s | 70.7 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00771 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.268 | 5119.1 samples/s | 80.0 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00737 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.269 | 1797.9 samples/s | 28.1 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00709 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=3.271 | 4524.2 samples/s | 70.7 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00687 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=3.272 | 4459.4 samples/s | 69.7 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00667 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=3.273 | 4568.6 samples/s | 71.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=105.3] | Loss=0.30959 | Reg=0.00178 | acc=0.8750 | L2-Norm=13.330 | L2-Norm(final)=3.255 | 3892.0 samples/s | 60.8 steps/s
[Step=21650 Epoch=105.6] | Loss=0.03487 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.253 | 3957.4 samples/s | 61.8 steps/s
[Step=21700 Epoch=105.8] | Loss=0.02253 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.341 | L2-Norm(final)=3.254 | 4470.0 samples/s | 69.8 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01761 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.255 | 4498.4 samples/s | 70.3 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01545 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.256 | 6080.3 samples/s | 95.0 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01336 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.347 | L2-Norm(final)=3.257 | 1748.9 samples/s | 27.3 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01187 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=3.259 | 4456.3 samples/s | 69.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01099 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.349 | L2-Norm(final)=3.260 | 4471.8 samples/s | 69.9 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=3.261 | 5536.0 samples/s | 86.5 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00931 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=3.263 | 1712.4 samples/s | 26.8 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00871 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=3.264 | 4414.0 samples/s | 69.0 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00822 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=3.265 | 4456.4 samples/s | 69.6 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00780 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=3.267 | 5223.5 samples/s | 81.6 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00743 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=3.268 | 1779.5 samples/s | 27.8 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00715 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=3.270 | 4517.6 samples/s | 70.6 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00687 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=3.271 | 4387.7 samples/s | 68.6 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00664 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=3.272 | 4807.8 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_asml1_3/client_state-step22400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=11201 Epoch=106.5] | Loss=0.07418 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.330 | L2-Norm(final)=3.255 | 3830.0 samples/s | 59.8 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00545 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.255 | 3577.2 samples/s | 55.9 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00276 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.256 | 5424.8 samples/s | 84.8 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00185 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.256 | 1695.0 samples/s | 26.5 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00140 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=3.256 | 5344.1 samples/s | 83.5 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00113 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=3.256 | 1719.4 samples/s | 26.9 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00094 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=3.256 | 5030.3 samples/s | 78.6 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00081 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.257 | 1766.7 samples/s | 27.6 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00071 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.257 | 4592.9 samples/s | 71.8 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.257 | 1741.2 samples/s | 27.2 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00057 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=3.257 | 4315.7 samples/s | 67.4 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.257 | 1835.1 samples/s | 28.7 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.258 | 4422.0 samples/s | 69.1 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.258 | 1828.2 samples/s | 28.6 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=3.258 | 4142.6 samples/s | 64.7 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=3.258 | 1873.4 samples/s | 29.3 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=3.258 | 4209.4 samples/s | 65.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_1/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=173.4] | Loss=0.09901 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.330 | L2-Norm(final)=3.255 | 3679.1 samples/s | 57.5 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00580 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.255 | 3975.1 samples/s | 62.1 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00298 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.255 | 5722.9 samples/s | 89.4 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00202 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.256 | 1693.2 samples/s | 26.5 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00153 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=3.256 | 5222.4 samples/s | 81.6 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00123 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.256 | 1716.2 samples/s | 26.8 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00103 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=3.256 | 4764.3 samples/s | 74.4 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00089 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=3.257 | 1744.8 samples/s | 27.3 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00078 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=3.257 | 4366.2 samples/s | 68.2 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00070 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=3.257 | 1824.0 samples/s | 28.5 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00063 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=3.257 | 4247.4 samples/s | 66.4 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=3.258 | 1840.7 samples/s | 28.8 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00053 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=3.258 | 4336.6 samples/s | 67.8 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=3.258 | 1874.0 samples/s | 29.3 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00046 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=3.258 | 4321.4 samples/s | 67.5 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=3.258 | 1916.8 samples/s | 30.0 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=3.258 | 3634.3 samples/s | 56.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr0.5/client_iccad2012_3/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29868 | acc=0.8533 | tpr=0.7899 | fpr=0.0092 | 3839.6 samples/s | 15.0 steps/s
Avg test loss: 0.29929, Avg test acc: 0.85588, Avg tpr: 0.79478, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.36927 | acc=0.8888 | tpr=0.9735 | fpr=0.1127 | 3909.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.37100 | acc=0.8889 | tpr=0.9787 | fpr=0.1127 | 7367.9 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.37901 | acc=0.8892 | tpr=0.9798 | fpr=0.1125 | 7727.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.38214 | acc=0.8889 | tpr=0.9749 | fpr=0.1127 | 7504.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.38265 | acc=0.8881 | tpr=0.9721 | fpr=0.1134 | 7423.5 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.38659 | acc=0.8876 | tpr=0.9731 | fpr=0.1139 | 7573.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.38722 | acc=0.8881 | tpr=0.9731 | fpr=0.1135 | 7813.7 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.38797 | acc=0.8878 | tpr=0.9710 | fpr=0.1137 | 7138.4 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.39162 | acc=0.8875 | tpr=0.9708 | fpr=0.1140 | 7599.1 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.39218 | acc=0.8872 | tpr=0.9722 | fpr=0.1143 | 7415.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.39094 | acc=0.8874 | tpr=0.9713 | fpr=0.1141 | 14710.0 samples/s | 57.5 steps/s
Avg test loss: 0.39054, Avg test acc: 0.88747, Avg tpr: 0.97147, Avg fpr: 0.11406, total FA: 15837
