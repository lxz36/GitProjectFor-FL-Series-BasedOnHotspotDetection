#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-a5i5_froma5i5_sr1.0/client_asml1_0', 'models/model-a5i5_froma5i5_sr1.0/client_asml1_1', 'models/model-a5i5_froma5i5_sr1.0/client_asml1_2', 'models/model-a5i5_froma5i5_sr1.0/client_asml1_3', 'models/model-a5i5_froma5i5_sr1.0/client_asml1_4', 'models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0', 'models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1', 'models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2', 'models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3', 'models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35904 | Reg=0.00356 | acc=0.5000 | L2-Norm=18.862 | L2-Norm(final)=1.948 | 2679.8 samples/s | 41.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29175 | Reg=0.00329 | acc=0.8594 | L2-Norm=18.141 | L2-Norm(final)=1.941 | 4516.5 samples/s | 70.6 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24765 | Reg=0.00320 | acc=0.8906 | L2-Norm=17.872 | L2-Norm(final)=1.948 | 4312.9 samples/s | 67.4 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22656 | Reg=0.00314 | acc=0.9219 | L2-Norm=17.727 | L2-Norm(final)=1.951 | 4323.5 samples/s | 67.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20680 | Reg=0.00311 | acc=0.8906 | L2-Norm=17.637 | L2-Norm(final)=1.956 | 5917.9 samples/s | 92.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18780 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.576 | L2-Norm(final)=1.962 | 1786.8 samples/s | 27.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17505 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.528 | L2-Norm(final)=1.968 | 4325.9 samples/s | 67.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16363 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.491 | L2-Norm(final)=1.973 | 4363.5 samples/s | 68.2 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15469 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.459 | L2-Norm(final)=1.979 | 5374.9 samples/s | 84.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14572 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.437 | L2-Norm(final)=1.985 | 1813.8 samples/s | 28.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13823 | Reg=0.00304 | acc=0.9219 | L2-Norm=17.419 | L2-Norm(final)=1.991 | 4340.4 samples/s | 67.8 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13203 | Reg=0.00303 | acc=0.9219 | L2-Norm=17.404 | L2-Norm(final)=1.997 | 4367.6 samples/s | 68.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12566 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.391 | L2-Norm(final)=2.002 | 4990.4 samples/s | 78.0 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.12021 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.380 | L2-Norm(final)=2.007 | 1835.8 samples/s | 28.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11544 | Reg=0.00302 | acc=0.9531 | L2-Norm=17.373 | L2-Norm(final)=2.013 | 4282.7 samples/s | 66.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11119 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.367 | L2-Norm(final)=2.018 | 4277.5 samples/s | 66.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10686 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.364 | L2-Norm(final)=2.023 | 4659.3 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37683 | Reg=0.00356 | acc=0.3594 | L2-Norm=18.862 | L2-Norm(final)=1.948 | 4011.4 samples/s | 62.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31121 | Reg=0.00334 | acc=0.7188 | L2-Norm=18.262 | L2-Norm(final)=1.940 | 4083.9 samples/s | 63.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25588 | Reg=0.00328 | acc=0.7344 | L2-Norm=18.096 | L2-Norm(final)=1.954 | 4306.0 samples/s | 67.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23276 | Reg=0.00325 | acc=0.7969 | L2-Norm=18.014 | L2-Norm(final)=1.962 | 4438.2 samples/s | 69.3 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21275 | Reg=0.00323 | acc=0.7969 | L2-Norm=17.966 | L2-Norm(final)=1.971 | 5899.6 samples/s | 92.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19417 | Reg=0.00322 | acc=0.9219 | L2-Norm=17.937 | L2-Norm(final)=1.980 | 1733.3 samples/s | 27.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17872 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.922 | L2-Norm(final)=1.990 | 4431.7 samples/s | 69.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16766 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.912 | L2-Norm(final)=2.000 | 4261.0 samples/s | 66.6 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15704 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.905 | L2-Norm(final)=2.009 | 5474.5 samples/s | 85.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14651 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.900 | L2-Norm(final)=2.018 | 1789.9 samples/s | 28.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13752 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.899 | L2-Norm(final)=2.027 | 4159.6 samples/s | 65.0 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13081 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.899 | L2-Norm(final)=2.036 | 4238.2 samples/s | 66.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12504 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.899 | L2-Norm(final)=2.044 | 5159.6 samples/s | 80.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11898 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.901 | L2-Norm(final)=2.052 | 1826.3 samples/s | 28.5 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11325 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.904 | L2-Norm(final)=2.060 | 4339.5 samples/s | 67.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10897 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.906 | L2-Norm(final)=2.068 | 4294.9 samples/s | 67.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10487 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.909 | L2-Norm(final)=2.075 | 4797.7 samples/s | 75.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35309 | Reg=0.00356 | acc=0.5469 | L2-Norm=18.862 | L2-Norm(final)=1.949 | 3937.6 samples/s | 61.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31586 | Reg=0.00331 | acc=0.7344 | L2-Norm=18.198 | L2-Norm(final)=1.935 | 4109.1 samples/s | 64.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.26377 | Reg=0.00323 | acc=0.8438 | L2-Norm=17.967 | L2-Norm(final)=1.946 | 4292.4 samples/s | 67.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23227 | Reg=0.00319 | acc=0.8750 | L2-Norm=17.845 | L2-Norm(final)=1.958 | 4321.1 samples/s | 67.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20957 | Reg=0.00316 | acc=0.7656 | L2-Norm=17.764 | L2-Norm(final)=1.966 | 5887.8 samples/s | 92.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19090 | Reg=0.00314 | acc=0.9062 | L2-Norm=17.708 | L2-Norm(final)=1.974 | 1777.2 samples/s | 27.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17510 | Reg=0.00312 | acc=0.9219 | L2-Norm=17.671 | L2-Norm(final)=1.983 | 4261.4 samples/s | 66.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16346 | Reg=0.00311 | acc=0.9219 | L2-Norm=17.643 | L2-Norm(final)=1.991 | 4275.3 samples/s | 66.8 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15474 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.621 | L2-Norm(final)=1.998 | 5494.5 samples/s | 85.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14512 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.606 | L2-Norm(final)=2.006 | 1812.2 samples/s | 28.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13618 | Reg=0.00310 | acc=0.8906 | L2-Norm=17.595 | L2-Norm(final)=2.014 | 4251.6 samples/s | 66.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12928 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.585 | L2-Norm(final)=2.022 | 4343.7 samples/s | 67.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12382 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.576 | L2-Norm(final)=2.029 | 5005.1 samples/s | 78.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11814 | Reg=0.00309 | acc=0.8906 | L2-Norm=17.570 | L2-Norm(final)=2.036 | 1848.0 samples/s | 28.9 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11265 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=2.044 | 4312.9 samples/s | 67.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10769 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.568 | L2-Norm(final)=2.051 | 4348.5 samples/s | 67.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10350 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.567 | L2-Norm(final)=2.059 | 4750.2 samples/s | 74.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36778 | Reg=0.00356 | acc=0.5469 | L2-Norm=18.862 | L2-Norm(final)=1.948 | 3953.0 samples/s | 61.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31362 | Reg=0.00329 | acc=0.6875 | L2-Norm=18.149 | L2-Norm(final)=1.939 | 3950.1 samples/s | 61.7 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.26626 | Reg=0.00320 | acc=0.7656 | L2-Norm=17.879 | L2-Norm(final)=1.951 | 4369.0 samples/s | 68.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23465 | Reg=0.00315 | acc=0.7969 | L2-Norm=17.740 | L2-Norm(final)=1.964 | 4339.7 samples/s | 67.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21168 | Reg=0.00312 | acc=0.7812 | L2-Norm=17.656 | L2-Norm(final)=1.976 | 5874.1 samples/s | 91.8 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19209 | Reg=0.00310 | acc=0.9219 | L2-Norm=17.603 | L2-Norm(final)=1.986 | 1755.3 samples/s | 27.4 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17556 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.568 | L2-Norm(final)=1.996 | 4356.1 samples/s | 68.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16281 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.542 | L2-Norm(final)=2.005 | 4315.0 samples/s | 67.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15392 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.521 | L2-Norm(final)=2.014 | 5495.9 samples/s | 85.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14591 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.511 | L2-Norm(final)=2.022 | 1818.8 samples/s | 28.4 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13793 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.508 | L2-Norm(final)=2.029 | 4195.5 samples/s | 65.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13116 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.506 | L2-Norm(final)=2.036 | 4244.7 samples/s | 66.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12468 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.504 | L2-Norm(final)=2.042 | 4959.5 samples/s | 77.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11834 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.503 | L2-Norm(final)=2.049 | 1838.9 samples/s | 28.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11244 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.502 | L2-Norm(final)=2.056 | 4239.8 samples/s | 66.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10771 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.502 | L2-Norm(final)=2.062 | 4318.4 samples/s | 67.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10353 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=2.068 | 4579.1 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34564 | Reg=0.00356 | acc=0.5000 | L2-Norm=18.862 | L2-Norm(final)=1.949 | 3676.3 samples/s | 57.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31545 | Reg=0.00330 | acc=0.6562 | L2-Norm=18.159 | L2-Norm(final)=1.935 | 4254.1 samples/s | 66.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25675 | Reg=0.00321 | acc=0.8594 | L2-Norm=17.906 | L2-Norm(final)=1.947 | 4276.0 samples/s | 66.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22768 | Reg=0.00316 | acc=0.8750 | L2-Norm=17.766 | L2-Norm(final)=1.955 | 4386.4 samples/s | 68.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20475 | Reg=0.00312 | acc=0.8438 | L2-Norm=17.672 | L2-Norm(final)=1.964 | 5928.7 samples/s | 92.6 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18590 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.607 | L2-Norm(final)=1.971 | 1734.1 samples/s | 27.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17073 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.560 | L2-Norm(final)=1.979 | 4303.7 samples/s | 67.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15965 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.524 | L2-Norm(final)=1.986 | 4105.3 samples/s | 64.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14970 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.496 | L2-Norm(final)=1.993 | 5458.3 samples/s | 85.3 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14009 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.475 | L2-Norm(final)=2.000 | 1747.4 samples/s | 27.3 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.13131 | Reg=0.00305 | acc=0.9062 | L2-Norm=17.458 | L2-Norm(final)=2.007 | 4232.9 samples/s | 66.1 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12448 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.447 | L2-Norm(final)=2.014 | 4256.5 samples/s | 66.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11880 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.438 | L2-Norm(final)=2.022 | 5337.5 samples/s | 83.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11280 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.432 | L2-Norm(final)=2.028 | 1799.4 samples/s | 28.1 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10808 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.427 | L2-Norm(final)=2.035 | 4201.3 samples/s | 65.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10321 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.424 | L2-Norm(final)=2.041 | 4252.7 samples/s | 66.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09939 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.422 | L2-Norm(final)=2.047 | 5052.6 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31696 | Reg=0.00356 | acc=0.6094 | L2-Norm=18.862 | L2-Norm(final)=1.950 | 3756.0 samples/s | 58.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14186 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.369 | L2-Norm(final)=1.973 | 3775.9 samples/s | 59.0 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08653 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.199 | L2-Norm(final)=1.995 | 5636.0 samples/s | 88.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06014 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.009 | 1683.7 samples/s | 26.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04713 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.987 | L2-Norm(final)=2.019 | 5131.6 samples/s | 80.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03820 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=2.027 | 1743.8 samples/s | 27.2 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03189 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=2.033 | 4820.7 samples/s | 75.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02735 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=2.039 | 1768.5 samples/s | 27.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02394 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.043 | 4360.9 samples/s | 68.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02129 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.638 | L2-Norm(final)=2.047 | 1820.8 samples/s | 28.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01916 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=2.052 | 4195.3 samples/s | 65.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01742 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.511 | L2-Norm(final)=2.056 | 1878.7 samples/s | 29.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01597 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.450 | L2-Norm(final)=2.060 | 3999.9 samples/s | 62.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01475 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.390 | L2-Norm(final)=2.064 | 1890.8 samples/s | 29.5 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01369 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=2.068 | 4204.8 samples/s | 65.7 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01278 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.273 | L2-Norm(final)=2.072 | 1911.7 samples/s | 29.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01198 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.216 | L2-Norm(final)=2.076 | 3927.3 samples/s | 61.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32250 | Reg=0.00356 | acc=0.5938 | L2-Norm=18.862 | L2-Norm(final)=1.950 | 4222.0 samples/s | 66.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14420 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.345 | L2-Norm(final)=1.973 | 3516.5 samples/s | 54.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08726 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=1.992 | 5536.3 samples/s | 86.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06232 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.077 | L2-Norm(final)=2.006 | 1688.1 samples/s | 26.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04762 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.018 | 5099.0 samples/s | 79.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03870 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.028 | 1731.8 samples/s | 27.1 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03233 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.868 | L2-Norm(final)=2.037 | 4793.5 samples/s | 74.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02778 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=2.044 | 1775.4 samples/s | 27.7 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02432 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=2.050 | 4325.2 samples/s | 67.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02162 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=2.055 | 1842.6 samples/s | 28.8 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01946 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.618 | L2-Norm(final)=2.059 | 4074.4 samples/s | 63.7 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01770 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.556 | L2-Norm(final)=2.063 | 1911.7 samples/s | 29.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01622 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=2.066 | 4086.5 samples/s | 63.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01498 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.434 | L2-Norm(final)=2.069 | 1889.2 samples/s | 29.5 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01391 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.375 | L2-Norm(final)=2.071 | 4120.5 samples/s | 64.4 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01299 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.316 | L2-Norm(final)=2.074 | 1883.9 samples/s | 29.4 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01217 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=2.076 | 4135.5 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33395 | Reg=0.00356 | acc=0.5469 | L2-Norm=18.862 | L2-Norm(final)=1.948 | 3594.8 samples/s | 56.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14314 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.328 | L2-Norm(final)=1.969 | 3900.1 samples/s | 60.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08236 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=1.987 | 5757.4 samples/s | 90.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05693 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.042 | L2-Norm(final)=2.000 | 1690.0 samples/s | 26.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04441 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=2.009 | 5111.2 samples/s | 79.9 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03574 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=2.017 | 1690.8 samples/s | 26.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02983 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=2.023 | 4857.3 samples/s | 75.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02558 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=2.028 | 1743.3 samples/s | 27.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02240 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.702 | L2-Norm(final)=2.032 | 4669.6 samples/s | 73.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01991 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.642 | L2-Norm(final)=2.036 | 1783.9 samples/s | 27.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01793 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.582 | L2-Norm(final)=2.038 | 4283.9 samples/s | 66.9 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01630 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=2.041 | 1833.9 samples/s | 28.7 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01495 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=2.043 | 4210.0 samples/s | 65.8 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01380 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.407 | L2-Norm(final)=2.045 | 1864.6 samples/s | 29.1 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01281 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.350 | L2-Norm(final)=2.047 | 4114.2 samples/s | 64.3 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01196 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=2.049 | 1891.8 samples/s | 29.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01122 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=2.050 | 4164.3 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34618 | Reg=0.00356 | acc=0.5156 | L2-Norm=18.862 | L2-Norm(final)=1.949 | 3986.7 samples/s | 62.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13385 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.274 | L2-Norm(final)=1.969 | 3630.9 samples/s | 56.7 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08465 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=1.981 | 5504.2 samples/s | 86.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05892 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.925 | L2-Norm(final)=1.993 | 1687.0 samples/s | 26.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04529 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=2.003 | 5043.7 samples/s | 78.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03660 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=2.011 | 1751.7 samples/s | 27.4 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03065 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.684 | L2-Norm(final)=2.018 | 4638.2 samples/s | 72.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02632 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.617 | L2-Norm(final)=2.023 | 1807.3 samples/s | 28.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02304 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=2.028 | 4136.2 samples/s | 64.6 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.02049 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=2.032 | 1847.6 samples/s | 28.9 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01845 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=2.036 | 3986.1 samples/s | 62.3 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01677 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=2.039 | 1866.3 samples/s | 29.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01538 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=2.041 | 4081.9 samples/s | 63.8 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.01420 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=2.044 | 1889.4 samples/s | 29.5 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01319 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.197 | L2-Norm(final)=2.046 | 4019.7 samples/s | 62.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01231 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.141 | L2-Norm(final)=2.048 | 1975.5 samples/s | 30.9 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01154 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.086 | L2-Norm(final)=2.050 | 3706.3 samples/s | 57.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33098 | Reg=0.00356 | acc=0.5469 | L2-Norm=18.862 | L2-Norm(final)=1.949 | 3752.1 samples/s | 58.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14105 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.388 | L2-Norm(final)=1.972 | 3690.9 samples/s | 57.7 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08456 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.243 | L2-Norm(final)=1.994 | 5591.3 samples/s | 87.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06128 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.154 | L2-Norm(final)=2.012 | 1665.2 samples/s | 26.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04721 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.024 | 5217.9 samples/s | 81.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03791 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=2.035 | 1724.4 samples/s | 26.9 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03164 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.043 | 4824.3 samples/s | 75.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02714 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=2.049 | 1770.1 samples/s | 27.7 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02376 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=2.054 | 4623.9 samples/s | 72.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02113 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=2.059 | 1772.6 samples/s | 27.7 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01902 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.706 | L2-Norm(final)=2.063 | 4380.9 samples/s | 68.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01730 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.644 | L2-Norm(final)=2.066 | 1838.9 samples/s | 28.7 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01586 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.582 | L2-Norm(final)=2.069 | 4171.6 samples/s | 65.2 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01464 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.522 | L2-Norm(final)=2.072 | 1872.9 samples/s | 29.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01360 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=2.075 | 4103.8 samples/s | 64.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01269 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.402 | L2-Norm(final)=2.078 | 1862.1 samples/s | 29.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01190 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.344 | L2-Norm(final)=2.080 | 4081.0 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24553 | acc=0.7628 | tpr=0.7952 | fpr=0.3075 | 3799.4 samples/s | 14.8 steps/s
Avg test loss: 0.24717, Avg test acc: 0.76184, Avg tpr: 0.79524, Avg fpr: 0.31163, total FA: 2431

Testing server on iccad2012
[Step=  50] | Loss=0.29612 | acc=0.7281 | tpr=0.9425 | fpr=0.2757 | 3788.7 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.29796 | acc=0.7234 | tpr=0.9574 | fpr=0.2810 | 7157.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.29717 | acc=0.7248 | tpr=0.9625 | fpr=0.2796 | 7295.6 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.29732 | acc=0.7247 | tpr=0.9607 | fpr=0.2796 | 6918.1 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.29770 | acc=0.7249 | tpr=0.9590 | fpr=0.2793 | 7278.2 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.29747 | acc=0.7256 | tpr=0.9556 | fpr=0.2786 | 7196.8 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.29814 | acc=0.7248 | tpr=0.9524 | fpr=0.2793 | 6915.5 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.29816 | acc=0.7250 | tpr=0.9502 | fpr=0.2791 | 7228.1 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.29842 | acc=0.7248 | tpr=0.9503 | fpr=0.2793 | 7399.4 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.29829 | acc=0.7245 | tpr=0.9493 | fpr=0.2796 | 6723.7 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.29753 | acc=0.7253 | tpr=0.9495 | fpr=0.2788 | 12913.6 samples/s | 50.4 steps/s
Avg test loss: 0.29747, Avg test acc: 0.72528, Avg tpr: 0.94929, Avg fpr: 0.27879, total FA: 38710

server round 1/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.24068 | Reg=0.00249 | acc=0.7969 | L2-Norm=15.791 | L2-Norm(final)=2.099 | 3737.0 samples/s | 58.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17812 | Reg=0.00257 | acc=0.8906 | L2-Norm=16.039 | L2-Norm(final)=2.079 | 4101.5 samples/s | 64.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15617 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.135 | L2-Norm(final)=2.078 | 4199.3 samples/s | 65.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14165 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.178 | L2-Norm(final)=2.081 | 4279.9 samples/s | 66.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13101 | Reg=0.00263 | acc=0.9062 | L2-Norm=16.207 | L2-Norm(final)=2.086 | 5759.6 samples/s | 90.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11942 | Reg=0.00264 | acc=0.8750 | L2-Norm=16.233 | L2-Norm(final)=2.092 | 1748.3 samples/s | 27.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11161 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.260 | L2-Norm(final)=2.099 | 4310.5 samples/s | 67.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10432 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.284 | L2-Norm(final)=2.107 | 4179.8 samples/s | 65.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09903 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.304 | L2-Norm(final)=2.114 | 5426.6 samples/s | 84.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09325 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=2.121 | 1789.2 samples/s | 28.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08800 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.344 | L2-Norm(final)=2.128 | 4314.7 samples/s | 67.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08391 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.362 | L2-Norm(final)=2.135 | 4284.9 samples/s | 67.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08046 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.380 | L2-Norm(final)=2.141 | 5023.6 samples/s | 78.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07752 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.397 | L2-Norm(final)=2.147 | 1851.7 samples/s | 28.9 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07381 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=2.154 | 4286.6 samples/s | 67.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07140 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.431 | L2-Norm(final)=2.160 | 4282.0 samples/s | 66.9 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06895 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=2.166 | 4612.7 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.22974 | Reg=0.00249 | acc=0.7969 | L2-Norm=15.791 | L2-Norm(final)=2.097 | 3783.9 samples/s | 59.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17505 | Reg=0.00256 | acc=0.7969 | L2-Norm=15.992 | L2-Norm(final)=2.094 | 4041.9 samples/s | 63.2 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15323 | Reg=0.00258 | acc=0.9062 | L2-Norm=16.077 | L2-Norm(final)=2.097 | 4122.0 samples/s | 64.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14006 | Reg=0.00260 | acc=0.9375 | L2-Norm=16.128 | L2-Norm(final)=2.101 | 4259.6 samples/s | 66.6 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13062 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.165 | L2-Norm(final)=2.106 | 5771.6 samples/s | 90.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11921 | Reg=0.00262 | acc=0.8750 | L2-Norm=16.199 | L2-Norm(final)=2.111 | 1734.3 samples/s | 27.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11162 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.232 | L2-Norm(final)=2.118 | 4277.2 samples/s | 66.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10598 | Reg=0.00264 | acc=0.9062 | L2-Norm=16.262 | L2-Norm(final)=2.123 | 4307.4 samples/s | 67.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10116 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.289 | L2-Norm(final)=2.128 | 5492.1 samples/s | 85.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09492 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.314 | L2-Norm(final)=2.133 | 1770.2 samples/s | 27.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08966 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.338 | L2-Norm(final)=2.139 | 4223.1 samples/s | 66.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08545 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.360 | L2-Norm(final)=2.144 | 4182.5 samples/s | 65.4 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08199 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.382 | L2-Norm(final)=2.149 | 5038.1 samples/s | 78.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07809 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.403 | L2-Norm(final)=2.155 | 1813.9 samples/s | 28.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07485 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.424 | L2-Norm(final)=2.160 | 4193.6 samples/s | 65.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07220 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.444 | L2-Norm(final)=2.165 | 4218.0 samples/s | 65.9 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06962 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.465 | L2-Norm(final)=2.170 | 4811.4 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.27680 | Reg=0.00249 | acc=0.6719 | L2-Norm=15.791 | L2-Norm(final)=2.097 | 4063.3 samples/s | 63.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.18330 | Reg=0.00256 | acc=0.8438 | L2-Norm=15.992 | L2-Norm(final)=2.084 | 3898.0 samples/s | 60.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16221 | Reg=0.00259 | acc=0.9375 | L2-Norm=16.080 | L2-Norm(final)=2.088 | 4202.8 samples/s | 65.7 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14117 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.132 | L2-Norm(final)=2.094 | 4298.2 samples/s | 67.2 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13412 | Reg=0.00261 | acc=0.9062 | L2-Norm=16.166 | L2-Norm(final)=2.099 | 5683.2 samples/s | 88.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12132 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.195 | L2-Norm(final)=2.104 | 1753.7 samples/s | 27.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11413 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.228 | L2-Norm(final)=2.111 | 4158.8 samples/s | 65.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10666 | Reg=0.00264 | acc=0.9375 | L2-Norm=16.261 | L2-Norm(final)=2.120 | 4271.5 samples/s | 66.7 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.10118 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.292 | L2-Norm(final)=2.127 | 5262.5 samples/s | 82.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09478 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.321 | L2-Norm(final)=2.135 | 1790.3 samples/s | 28.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09039 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.349 | L2-Norm(final)=2.143 | 4154.9 samples/s | 64.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08652 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.374 | L2-Norm(final)=2.150 | 4280.2 samples/s | 66.9 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08317 | Reg=0.00269 | acc=0.9531 | L2-Norm=16.398 | L2-Norm(final)=2.157 | 4971.9 samples/s | 77.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07958 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.422 | L2-Norm(final)=2.163 | 1847.9 samples/s | 28.9 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07617 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.445 | L2-Norm(final)=2.170 | 4246.0 samples/s | 66.3 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07353 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.467 | L2-Norm(final)=2.176 | 4286.5 samples/s | 67.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07159 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.486 | L2-Norm(final)=2.181 | 4645.5 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.25307 | Reg=0.00249 | acc=0.7188 | L2-Norm=15.791 | L2-Norm(final)=2.096 | 3921.9 samples/s | 61.3 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17987 | Reg=0.00258 | acc=0.8906 | L2-Norm=16.069 | L2-Norm(final)=2.084 | 3974.5 samples/s | 62.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14973 | Reg=0.00262 | acc=0.8906 | L2-Norm=16.193 | L2-Norm(final)=2.088 | 4256.6 samples/s | 66.5 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14311 | Reg=0.00264 | acc=0.9062 | L2-Norm=16.254 | L2-Norm(final)=2.091 | 4201.9 samples/s | 65.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13284 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.307 | L2-Norm(final)=2.095 | 5758.7 samples/s | 90.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11905 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.349 | L2-Norm(final)=2.101 | 1755.2 samples/s | 27.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11079 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.387 | L2-Norm(final)=2.109 | 4288.4 samples/s | 67.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10455 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.420 | L2-Norm(final)=2.116 | 4206.8 samples/s | 65.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09970 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.451 | L2-Norm(final)=2.122 | 5319.3 samples/s | 83.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09425 | Reg=0.00272 | acc=0.9219 | L2-Norm=16.482 | L2-Norm(final)=2.128 | 1797.3 samples/s | 28.1 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08848 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.510 | L2-Norm(final)=2.134 | 4286.5 samples/s | 67.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08453 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.535 | L2-Norm(final)=2.141 | 4266.5 samples/s | 66.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08136 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.558 | L2-Norm(final)=2.147 | 4894.1 samples/s | 76.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07777 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.582 | L2-Norm(final)=2.153 | 1816.2 samples/s | 28.4 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07462 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.606 | L2-Norm(final)=2.159 | 4272.3 samples/s | 66.8 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07177 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.629 | L2-Norm(final)=2.165 | 4295.5 samples/s | 67.1 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06931 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.650 | L2-Norm(final)=2.170 | 4608.8 samples/s | 72.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step1600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.21960 | Reg=0.00249 | acc=0.7812 | L2-Norm=15.791 | L2-Norm(final)=2.099 | 4148.6 samples/s | 64.8 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.15920 | Reg=0.00257 | acc=0.8906 | L2-Norm=16.033 | L2-Norm(final)=2.092 | 3848.9 samples/s | 60.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14378 | Reg=0.00260 | acc=0.8125 | L2-Norm=16.139 | L2-Norm(final)=2.096 | 4346.0 samples/s | 67.9 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.13397 | Reg=0.00262 | acc=0.9219 | L2-Norm=16.190 | L2-Norm(final)=2.100 | 4323.4 samples/s | 67.6 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12468 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.225 | L2-Norm(final)=2.105 | 5873.1 samples/s | 91.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11180 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.254 | L2-Norm(final)=2.112 | 1743.6 samples/s | 27.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10387 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.280 | L2-Norm(final)=2.119 | 4328.3 samples/s | 67.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09715 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.304 | L2-Norm(final)=2.127 | 4221.0 samples/s | 66.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09367 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.327 | L2-Norm(final)=2.133 | 5676.8 samples/s | 88.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08828 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.349 | L2-Norm(final)=2.138 | 1734.0 samples/s | 27.1 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.08330 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.370 | L2-Norm(final)=2.145 | 4233.3 samples/s | 66.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07917 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.390 | L2-Norm(final)=2.151 | 4225.9 samples/s | 66.0 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.07646 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.409 | L2-Norm(final)=2.157 | 5345.6 samples/s | 83.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07299 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.427 | L2-Norm(final)=2.162 | 1789.2 samples/s | 28.0 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.07032 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.444 | L2-Norm(final)=2.168 | 4262.0 samples/s | 66.6 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06802 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.461 | L2-Norm(final)=2.172 | 4202.4 samples/s | 65.7 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06570 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.476 | L2-Norm(final)=2.177 | 5023.5 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.19600 | Reg=0.00249 | acc=0.7969 | L2-Norm=15.791 | L2-Norm(final)=2.098 | 3931.8 samples/s | 61.4 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.05347 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=2.091 | 3636.9 samples/s | 56.8 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02938 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=2.093 | 5492.8 samples/s | 85.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02133 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.236 | L2-Norm(final)=2.098 | 1689.9 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01629 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.235 | L2-Norm(final)=2.102 | 5082.2 samples/s | 79.4 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01307 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.222 | L2-Norm(final)=2.106 | 1734.6 samples/s | 27.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01090 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.199 | L2-Norm(final)=2.109 | 4709.6 samples/s | 73.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00934 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=2.111 | 1787.3 samples/s | 27.9 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00818 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.142 | L2-Norm(final)=2.113 | 4510.5 samples/s | 70.5 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00727 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=2.115 | 1835.9 samples/s | 28.7 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00655 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.076 | L2-Norm(final)=2.116 | 4160.1 samples/s | 65.0 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00595 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.042 | L2-Norm(final)=2.118 | 1869.2 samples/s | 29.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00546 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=2.119 | 4073.4 samples/s | 63.6 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00504 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=2.120 | 1889.1 samples/s | 29.5 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00468 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.939 | L2-Norm(final)=2.121 | 4090.2 samples/s | 63.9 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00437 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.904 | L2-Norm(final)=2.122 | 1879.6 samples/s | 29.4 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00410 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.869 | L2-Norm(final)=2.123 | 4010.4 samples/s | 62.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step1600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.15827 | Reg=0.00249 | acc=0.8281 | L2-Norm=15.791 | L2-Norm(final)=2.098 | 3814.8 samples/s | 59.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06624 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=2.088 | 3671.3 samples/s | 57.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03867 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=2.096 | 5579.5 samples/s | 87.2 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02601 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=2.104 | 1688.9 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01965 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=2.110 | 5094.0 samples/s | 79.6 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01576 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.346 | L2-Norm(final)=2.115 | 1727.5 samples/s | 27.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01314 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.322 | L2-Norm(final)=2.118 | 4681.3 samples/s | 73.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01127 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=2.121 | 1750.2 samples/s | 27.3 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00986 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.260 | L2-Norm(final)=2.123 | 4513.1 samples/s | 70.5 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00877 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.225 | L2-Norm(final)=2.125 | 1815.2 samples/s | 28.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00789 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=2.126 | 4111.7 samples/s | 64.2 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00718 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=2.127 | 1892.8 samples/s | 29.6 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00658 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=2.128 | 4070.6 samples/s | 63.6 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00608 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.081 | L2-Norm(final)=2.129 | 1896.5 samples/s | 29.6 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00564 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=2.130 | 4101.8 samples/s | 64.1 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00527 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.007 | L2-Norm(final)=2.131 | 1910.9 samples/s | 29.9 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00494 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=2.132 | 4079.7 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.19034 | Reg=0.00249 | acc=0.8125 | L2-Norm=15.791 | L2-Norm(final)=2.097 | 3860.9 samples/s | 60.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04499 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=2.102 | 3760.1 samples/s | 58.8 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02593 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.294 | L2-Norm(final)=2.106 | 5689.6 samples/s | 88.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01748 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=2.110 | 1675.2 samples/s | 26.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01314 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=2.114 | 5316.3 samples/s | 83.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01053 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.274 | L2-Norm(final)=2.117 | 1693.2 samples/s | 26.5 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00878 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=2.119 | 4850.8 samples/s | 75.8 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00753 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=2.121 | 1746.5 samples/s | 27.3 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00659 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=2.122 | 4489.0 samples/s | 70.1 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00586 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=2.124 | 1765.6 samples/s | 27.6 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00528 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=2.125 | 4350.3 samples/s | 68.0 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00480 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.059 | L2-Norm(final)=2.126 | 1812.8 samples/s | 28.3 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00440 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=2.126 | 4162.6 samples/s | 65.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00406 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.982 | L2-Norm(final)=2.127 | 1865.1 samples/s | 29.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00377 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=2.128 | 3995.4 samples/s | 62.4 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00352 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.906 | L2-Norm(final)=2.129 | 1907.5 samples/s | 29.8 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00330 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.868 | L2-Norm(final)=2.129 | 4035.8 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.15316 | Reg=0.00249 | acc=0.8594 | L2-Norm=15.791 | L2-Norm(final)=2.096 | 3801.7 samples/s | 59.4 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.05522 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=2.091 | 3830.8 samples/s | 59.9 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.03395 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.258 | L2-Norm(final)=2.096 | 5487.7 samples/s | 85.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02335 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=2.101 | 1697.1 samples/s | 26.5 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01759 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=2.105 | 4982.3 samples/s | 77.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01409 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=2.109 | 1729.0 samples/s | 27.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01176 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.215 | L2-Norm(final)=2.112 | 4544.2 samples/s | 71.0 steps/s
[Step=1150 Epoch=10.8] | Loss=0.01009 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=2.114 | 1802.0 samples/s | 28.2 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00883 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.150 | L2-Norm(final)=2.116 | 4288.3 samples/s | 67.0 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00785 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.115 | L2-Norm(final)=2.118 | 1872.0 samples/s | 29.3 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00707 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.080 | L2-Norm(final)=2.120 | 4086.9 samples/s | 63.9 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00643 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.045 | L2-Norm(final)=2.121 | 1905.6 samples/s | 29.8 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00590 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.009 | L2-Norm(final)=2.123 | 4097.5 samples/s | 64.0 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00544 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.974 | L2-Norm(final)=2.124 | 1880.9 samples/s | 29.4 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00506 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=2.125 | 4131.5 samples/s | 64.6 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00472 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.903 | L2-Norm(final)=2.126 | 2012.2 samples/s | 31.4 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00443 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.868 | L2-Norm(final)=2.127 | 3688.8 samples/s | 57.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step1600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.12057 | Reg=0.00249 | acc=0.9219 | L2-Norm=15.791 | L2-Norm(final)=2.097 | 3711.3 samples/s | 58.0 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06872 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.180 | L2-Norm(final)=2.078 | 3975.1 samples/s | 62.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03809 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=2.081 | 5680.3 samples/s | 88.8 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02582 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.330 | L2-Norm(final)=2.090 | 1690.9 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01944 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=2.096 | 5265.3 samples/s | 82.3 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01559 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.308 | L2-Norm(final)=2.102 | 1724.6 samples/s | 26.9 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01300 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=2.106 | 4917.9 samples/s | 76.8 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01115 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.254 | L2-Norm(final)=2.109 | 1737.8 samples/s | 27.2 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00976 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=2.112 | 4624.4 samples/s | 72.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00868 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=2.114 | 1809.2 samples/s | 28.3 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00781 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.156 | L2-Norm(final)=2.116 | 4405.0 samples/s | 68.8 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00710 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.122 | L2-Norm(final)=2.118 | 1819.6 samples/s | 28.4 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00651 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.087 | L2-Norm(final)=2.119 | 4203.1 samples/s | 65.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00601 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.053 | L2-Norm(final)=2.120 | 1867.8 samples/s | 29.2 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00559 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=2.122 | 4159.1 samples/s | 65.0 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00521 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.983 | L2-Norm(final)=2.123 | 1892.0 samples/s | 29.6 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00489 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.948 | L2-Norm(final)=2.124 | 4099.6 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24396 | acc=0.7726 | tpr=0.7667 | fpr=0.2146 | 3826.2 samples/s | 14.9 steps/s
Avg test loss: 0.24673, Avg test acc: 0.76785, Avg tpr: 0.76255, Avg fpr: 0.22048, total FA: 1720

Testing server on iccad2012
[Step=  50] | Loss=0.27103 | acc=0.7973 | tpr=0.9779 | fpr=0.2060 | 3781.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.27384 | acc=0.7957 | tpr=0.9851 | fpr=0.2079 | 7400.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.27446 | acc=0.7958 | tpr=0.9856 | fpr=0.2077 | 7236.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.27457 | acc=0.7957 | tpr=0.9869 | fpr=0.2078 | 7027.0 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.27402 | acc=0.7962 | tpr=0.9843 | fpr=0.2073 | 7331.1 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.27457 | acc=0.7968 | tpr=0.9825 | fpr=0.2066 | 7045.9 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.27620 | acc=0.7954 | tpr=0.9812 | fpr=0.2080 | 7221.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.27594 | acc=0.7960 | tpr=0.9803 | fpr=0.2074 | 7344.3 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.27717 | acc=0.7954 | tpr=0.9805 | fpr=0.2079 | 6967.9 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.27681 | acc=0.7955 | tpr=0.9815 | fpr=0.2078 | 7096.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.27563 | acc=0.7962 | tpr=0.9821 | fpr=0.2072 | 13432.2 samples/s | 52.5 steps/s
Avg test loss: 0.27555, Avg test acc: 0.79621, Avg tpr: 0.98217, Avg fpr: 0.20717, total FA: 28765

server round 2/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.18248 | Reg=0.00233 | acc=0.7969 | L2-Norm=15.278 | L2-Norm(final)=2.181 | 4106.9 samples/s | 64.2 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.12184 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.483 | L2-Norm(final)=2.180 | 3848.1 samples/s | 60.1 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11066 | Reg=0.00242 | acc=0.9219 | L2-Norm=15.569 | L2-Norm(final)=2.175 | 4259.9 samples/s | 66.6 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10269 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.616 | L2-Norm(final)=2.174 | 4275.4 samples/s | 66.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09735 | Reg=0.00245 | acc=0.9219 | L2-Norm=15.658 | L2-Norm(final)=2.176 | 5882.5 samples/s | 91.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08760 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.697 | L2-Norm(final)=2.180 | 1771.2 samples/s | 27.7 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08174 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.729 | L2-Norm(final)=2.184 | 4274.4 samples/s | 66.8 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07582 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.758 | L2-Norm(final)=2.190 | 4304.0 samples/s | 67.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07186 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.786 | L2-Norm(final)=2.197 | 5444.0 samples/s | 85.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06762 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.816 | L2-Norm(final)=2.204 | 1801.6 samples/s | 28.2 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06401 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.845 | L2-Norm(final)=2.212 | 4155.0 samples/s | 64.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06219 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.872 | L2-Norm(final)=2.219 | 4194.8 samples/s | 65.5 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05946 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.897 | L2-Norm(final)=2.225 | 5013.1 samples/s | 78.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05686 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.921 | L2-Norm(final)=2.231 | 1834.0 samples/s | 28.7 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05480 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.944 | L2-Norm(final)=2.237 | 4318.2 samples/s | 67.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05290 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.966 | L2-Norm(final)=2.242 | 4304.9 samples/s | 67.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05162 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.988 | L2-Norm(final)=2.247 | 4690.4 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.26048 | Reg=0.00233 | acc=0.7500 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 3894.4 samples/s | 60.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.13277 | Reg=0.00239 | acc=0.9219 | L2-Norm=15.471 | L2-Norm(final)=2.178 | 3980.1 samples/s | 62.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11124 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.550 | L2-Norm(final)=2.177 | 4298.7 samples/s | 67.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10327 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.595 | L2-Norm(final)=2.179 | 4342.0 samples/s | 67.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09598 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.633 | L2-Norm(final)=2.182 | 5823.9 samples/s | 91.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08568 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.670 | L2-Norm(final)=2.188 | 1749.9 samples/s | 27.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07976 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.703 | L2-Norm(final)=2.195 | 4304.2 samples/s | 67.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07481 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.734 | L2-Norm(final)=2.202 | 4286.9 samples/s | 67.0 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07134 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.763 | L2-Norm(final)=2.208 | 5484.7 samples/s | 85.7 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06754 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.792 | L2-Norm(final)=2.214 | 1794.5 samples/s | 28.0 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06384 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.820 | L2-Norm(final)=2.220 | 4278.9 samples/s | 66.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06187 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.845 | L2-Norm(final)=2.225 | 4256.6 samples/s | 66.5 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05957 | Reg=0.00252 | acc=0.9219 | L2-Norm=15.869 | L2-Norm(final)=2.230 | 5233.8 samples/s | 81.8 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05665 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.892 | L2-Norm(final)=2.235 | 1827.0 samples/s | 28.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05466 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.916 | L2-Norm(final)=2.240 | 4312.1 samples/s | 67.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05274 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.939 | L2-Norm(final)=2.245 | 4337.1 samples/s | 67.8 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05148 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.960 | L2-Norm(final)=2.249 | 4836.0 samples/s | 75.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.31029 | Reg=0.00233 | acc=0.7031 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 3677.2 samples/s | 57.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.13002 | Reg=0.00239 | acc=0.8594 | L2-Norm=15.446 | L2-Norm(final)=2.174 | 4191.0 samples/s | 65.5 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11760 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.524 | L2-Norm(final)=2.174 | 4278.3 samples/s | 66.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10554 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.579 | L2-Norm(final)=2.182 | 4292.9 samples/s | 67.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09959 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.625 | L2-Norm(final)=2.188 | 5886.2 samples/s | 92.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08842 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.669 | L2-Norm(final)=2.197 | 1751.6 samples/s | 27.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08303 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.708 | L2-Norm(final)=2.205 | 4303.1 samples/s | 67.2 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07749 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.744 | L2-Norm(final)=2.213 | 4231.4 samples/s | 66.1 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07511 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.777 | L2-Norm(final)=2.219 | 5424.7 samples/s | 84.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.07088 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.810 | L2-Norm(final)=2.226 | 1803.8 samples/s | 28.2 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06698 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.839 | L2-Norm(final)=2.233 | 4326.5 samples/s | 67.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06528 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.867 | L2-Norm(final)=2.238 | 4255.5 samples/s | 66.5 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06234 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.896 | L2-Norm(final)=2.244 | 4976.3 samples/s | 77.8 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05956 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.923 | L2-Norm(final)=2.249 | 1860.2 samples/s | 29.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05698 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.947 | L2-Norm(final)=2.255 | 4358.3 samples/s | 68.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05507 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.970 | L2-Norm(final)=2.260 | 4403.2 samples/s | 68.8 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05332 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.991 | L2-Norm(final)=2.265 | 4696.5 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.27734 | Reg=0.00233 | acc=0.6875 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 4015.9 samples/s | 62.7 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.12294 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.455 | L2-Norm(final)=2.173 | 4019.9 samples/s | 62.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10507 | Reg=0.00241 | acc=0.9219 | L2-Norm=15.530 | L2-Norm(final)=2.177 | 4382.7 samples/s | 68.5 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09939 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.579 | L2-Norm(final)=2.181 | 4339.4 samples/s | 67.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09317 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.620 | L2-Norm(final)=2.187 | 5763.9 samples/s | 90.1 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08283 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.654 | L2-Norm(final)=2.194 | 1753.5 samples/s | 27.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07753 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.686 | L2-Norm(final)=2.201 | 4347.0 samples/s | 67.9 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07269 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.715 | L2-Norm(final)=2.208 | 4320.0 samples/s | 67.5 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06936 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.743 | L2-Norm(final)=2.214 | 5476.2 samples/s | 85.6 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06503 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.769 | L2-Norm(final)=2.219 | 1823.8 samples/s | 28.5 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06205 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.794 | L2-Norm(final)=2.226 | 4293.0 samples/s | 67.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05885 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.816 | L2-Norm(final)=2.231 | 4330.8 samples/s | 67.7 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05720 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.835 | L2-Norm(final)=2.235 | 4946.8 samples/s | 77.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05467 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.856 | L2-Norm(final)=2.240 | 1849.4 samples/s | 28.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05275 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.878 | L2-Norm(final)=2.245 | 4354.6 samples/s | 68.0 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05083 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.898 | L2-Norm(final)=2.250 | 4320.3 samples/s | 67.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04941 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.917 | L2-Norm(final)=2.254 | 4757.6 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.28376 | Reg=0.00233 | acc=0.7188 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 3957.9 samples/s | 61.8 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12310 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.458 | L2-Norm(final)=2.178 | 3980.0 samples/s | 62.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10487 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.539 | L2-Norm(final)=2.185 | 4194.2 samples/s | 65.5 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.09627 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.584 | L2-Norm(final)=2.190 | 4321.4 samples/s | 67.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09051 | Reg=0.00244 | acc=0.9219 | L2-Norm=15.616 | L2-Norm(final)=2.194 | 5948.4 samples/s | 92.9 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.08187 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.645 | L2-Norm(final)=2.199 | 1746.1 samples/s | 27.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07605 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.672 | L2-Norm(final)=2.206 | 4331.9 samples/s | 67.7 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.07196 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.696 | L2-Norm(final)=2.212 | 4313.8 samples/s | 67.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06802 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.719 | L2-Norm(final)=2.218 | 5714.0 samples/s | 89.3 steps/s
[Step=2050 Epoch=10.1] | Loss=0.06408 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.740 | L2-Norm(final)=2.224 | 1780.3 samples/s | 27.8 steps/s
[Step=2100 Epoch=10.3] | Loss=0.06091 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.762 | L2-Norm(final)=2.230 | 4199.2 samples/s | 65.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05883 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.784 | L2-Norm(final)=2.237 | 4303.6 samples/s | 67.2 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05640 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.806 | L2-Norm(final)=2.242 | 5255.5 samples/s | 82.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05405 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.826 | L2-Norm(final)=2.248 | 1809.7 samples/s | 28.3 steps/s
[Step=2300 Epoch=11.3] | Loss=0.05184 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.845 | L2-Norm(final)=2.253 | 4255.3 samples/s | 66.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05030 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.862 | L2-Norm(final)=2.258 | 4224.7 samples/s | 66.0 steps/s
[Step=2400 Epoch=11.8] | Loss=0.04868 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.878 | L2-Norm(final)=2.262 | 5058.2 samples/s | 79.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step2400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.17509 | Reg=0.00233 | acc=0.8438 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 3955.0 samples/s | 61.8 steps/s
[Step=1650 Epoch=15.6] | Loss=0.02982 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.500 | L2-Norm(final)=2.165 | 3792.9 samples/s | 59.3 steps/s
[Step=1700 Epoch=16.1] | Loss=0.01650 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=2.164 | 5490.5 samples/s | 85.8 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01144 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.575 | L2-Norm(final)=2.167 | 1680.0 samples/s | 26.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00865 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.569 | L2-Norm(final)=2.171 | 5188.6 samples/s | 81.1 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00693 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.552 | L2-Norm(final)=2.174 | 1714.5 samples/s | 26.8 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00578 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.529 | L2-Norm(final)=2.176 | 4715.2 samples/s | 73.7 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00496 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.502 | L2-Norm(final)=2.178 | 1772.3 samples/s | 27.7 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00434 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.473 | L2-Norm(final)=2.179 | 4437.9 samples/s | 69.3 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00386 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.443 | L2-Norm(final)=2.180 | 1858.0 samples/s | 29.0 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00347 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=2.181 | 4223.3 samples/s | 66.0 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00316 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.380 | L2-Norm(final)=2.182 | 1875.0 samples/s | 29.3 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00290 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.348 | L2-Norm(final)=2.182 | 4050.2 samples/s | 63.3 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00267 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=2.183 | 1910.4 samples/s | 29.8 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00248 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.283 | L2-Norm(final)=2.184 | 4105.6 samples/s | 64.1 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00232 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.251 | L2-Norm(final)=2.184 | 1902.5 samples/s | 29.7 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00217 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=2.185 | 3980.1 samples/s | 62.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.09589 | Reg=0.00233 | acc=0.9219 | L2-Norm=15.278 | L2-Norm(final)=2.181 | 3716.5 samples/s | 58.1 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03261 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.494 | L2-Norm(final)=2.177 | 3902.0 samples/s | 61.0 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01865 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.605 | L2-Norm(final)=2.178 | 5683.7 samples/s | 88.8 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01267 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.640 | L2-Norm(final)=2.184 | 1692.7 samples/s | 26.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00986 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.646 | L2-Norm(final)=2.188 | 5104.7 samples/s | 79.8 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00792 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.643 | L2-Norm(final)=2.191 | 1743.5 samples/s | 27.2 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00662 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.629 | L2-Norm(final)=2.193 | 4838.4 samples/s | 75.6 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00567 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.610 | L2-Norm(final)=2.195 | 1788.7 samples/s | 27.9 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00497 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.586 | L2-Norm(final)=2.197 | 4324.2 samples/s | 67.6 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00442 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.559 | L2-Norm(final)=2.198 | 1819.1 samples/s | 28.4 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00397 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.531 | L2-Norm(final)=2.199 | 4056.4 samples/s | 63.4 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00361 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.501 | L2-Norm(final)=2.200 | 1906.4 samples/s | 29.8 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00331 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=2.201 | 4067.8 samples/s | 63.6 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00306 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=2.202 | 1896.2 samples/s | 29.6 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00284 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.408 | L2-Norm(final)=2.203 | 4097.6 samples/s | 64.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00265 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.376 | L2-Norm(final)=2.204 | 1905.8 samples/s | 29.8 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00249 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=2.204 | 4115.7 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.12195 | Reg=0.00233 | acc=0.9062 | L2-Norm=15.278 | L2-Norm(final)=2.180 | 3838.0 samples/s | 60.0 steps/s
[Step=1650 Epoch=15.8] | Loss=0.02103 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.516 | L2-Norm(final)=2.181 | 3846.7 samples/s | 60.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01386 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.576 | L2-Norm(final)=2.182 | 5725.1 samples/s | 89.5 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00994 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.594 | L2-Norm(final)=2.184 | 1686.2 samples/s | 26.3 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00750 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.589 | L2-Norm(final)=2.185 | 5276.5 samples/s | 82.4 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00601 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.571 | L2-Norm(final)=2.187 | 1725.9 samples/s | 27.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00502 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.548 | L2-Norm(final)=2.189 | 4973.5 samples/s | 77.7 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00430 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.520 | L2-Norm(final)=2.190 | 1773.9 samples/s | 27.7 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00377 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=2.191 | 4471.7 samples/s | 69.9 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00335 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.458 | L2-Norm(final)=2.192 | 1812.4 samples/s | 28.3 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00301 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.425 | L2-Norm(final)=2.193 | 4422.1 samples/s | 69.1 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00274 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=2.193 | 1848.1 samples/s | 28.9 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00251 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.359 | L2-Norm(final)=2.194 | 4072.2 samples/s | 63.6 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00232 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.325 | L2-Norm(final)=2.194 | 1875.8 samples/s | 29.3 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00215 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.291 | L2-Norm(final)=2.195 | 4084.6 samples/s | 63.8 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00201 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.258 | L2-Norm(final)=2.195 | 1859.8 samples/s | 29.1 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00189 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.224 | L2-Norm(final)=2.196 | 4070.8 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.10633 | Reg=0.00233 | acc=0.9219 | L2-Norm=15.278 | L2-Norm(final)=2.181 | 4034.1 samples/s | 63.0 steps/s
[Step=1650 Epoch=15.5] | Loss=0.03524 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.543 | L2-Norm(final)=2.163 | 3566.8 samples/s | 55.7 steps/s
[Step=1700 Epoch=16.0] | Loss=0.02319 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.641 | L2-Norm(final)=2.160 | 5512.8 samples/s | 86.1 steps/s
[Step=1750 Epoch=16.5] | Loss=0.01593 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.671 | L2-Norm(final)=2.161 | 1696.5 samples/s | 26.5 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01203 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.671 | L2-Norm(final)=2.164 | 5085.6 samples/s | 79.5 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00967 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.658 | L2-Norm(final)=2.167 | 1770.2 samples/s | 27.7 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00806 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=2.169 | 4676.7 samples/s | 73.1 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00692 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.613 | L2-Norm(final)=2.171 | 1801.7 samples/s | 28.2 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00605 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.585 | L2-Norm(final)=2.173 | 4111.9 samples/s | 64.2 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00538 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.555 | L2-Norm(final)=2.174 | 1835.8 samples/s | 28.7 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00485 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.525 | L2-Norm(final)=2.175 | 4122.6 samples/s | 64.4 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00441 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=2.177 | 1875.5 samples/s | 29.3 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00404 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=2.177 | 4052.6 samples/s | 63.3 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00373 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.429 | L2-Norm(final)=2.178 | 1914.6 samples/s | 29.9 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00347 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.397 | L2-Norm(final)=2.179 | 4094.4 samples/s | 64.0 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00324 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.365 | L2-Norm(final)=2.180 | 1948.6 samples/s | 30.4 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00303 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.332 | L2-Norm(final)=2.181 | 3784.2 samples/s | 59.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.11280 | Reg=0.00233 | acc=0.9062 | L2-Norm=15.278 | L2-Norm(final)=2.181 | 3891.6 samples/s | 60.8 steps/s
[Step=1650 Epoch=15.7] | Loss=0.02590 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.499 | L2-Norm(final)=2.188 | 3784.5 samples/s | 59.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01684 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.618 | L2-Norm(final)=2.187 | 5750.9 samples/s | 89.9 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01157 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.662 | L2-Norm(final)=2.191 | 1655.8 samples/s | 25.9 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00870 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.671 | L2-Norm(final)=2.195 | 5277.6 samples/s | 82.5 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00698 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.663 | L2-Norm(final)=2.197 | 1726.9 samples/s | 27.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00583 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.645 | L2-Norm(final)=2.200 | 4870.0 samples/s | 76.1 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00500 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.623 | L2-Norm(final)=2.202 | 1750.2 samples/s | 27.3 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00438 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.597 | L2-Norm(final)=2.203 | 4583.6 samples/s | 71.6 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00389 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.570 | L2-Norm(final)=2.205 | 1784.3 samples/s | 27.9 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00350 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.541 | L2-Norm(final)=2.206 | 4423.0 samples/s | 69.1 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00319 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.511 | L2-Norm(final)=2.207 | 1841.6 samples/s | 28.8 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00292 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.481 | L2-Norm(final)=2.208 | 4208.1 samples/s | 65.8 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00270 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.451 | L2-Norm(final)=2.209 | 1890.7 samples/s | 29.5 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00251 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.420 | L2-Norm(final)=2.209 | 4006.2 samples/s | 62.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00234 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.388 | L2-Norm(final)=2.210 | 1882.5 samples/s | 29.4 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00219 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.357 | L2-Norm(final)=2.211 | 4030.9 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31056 | acc=0.7451 | tpr=0.6478 | fpr=0.0436 | 3830.0 samples/s | 15.0 steps/s
Avg test loss: 0.31404, Avg test acc: 0.74217, Avg tpr: 0.64580, Avg fpr: 0.04589, total FA: 358

Testing server on iccad2012
[Step=  50] | Loss=0.21600 | acc=0.8679 | tpr=0.9735 | fpr=0.1340 | 3785.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.21874 | acc=0.8679 | tpr=0.9808 | fpr=0.1343 | 7200.8 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.22086 | acc=0.8671 | tpr=0.9827 | fpr=0.1350 | 7044.4 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.22113 | acc=0.8679 | tpr=0.9825 | fpr=0.1342 | 7238.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.21991 | acc=0.8680 | tpr=0.9808 | fpr=0.1340 | 7331.5 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.22082 | acc=0.8677 | tpr=0.9796 | fpr=0.1343 | 7201.9 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.22245 | acc=0.8670 | tpr=0.9781 | fpr=0.1350 | 7122.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.22277 | acc=0.8672 | tpr=0.9765 | fpr=0.1348 | 7207.5 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.22482 | acc=0.8665 | tpr=0.9776 | fpr=0.1355 | 7159.6 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.22455 | acc=0.8664 | tpr=0.9789 | fpr=0.1357 | 7148.7 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.22319 | acc=0.8672 | tpr=0.9785 | fpr=0.1348 | 13322.1 samples/s | 52.0 steps/s
Avg test loss: 0.22318, Avg test acc: 0.86719, Avg tpr: 0.97861, Avg fpr: 0.13483, total FA: 18721

server round 3/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.14331 | Reg=0.00222 | acc=0.9062 | L2-Norm=14.916 | L2-Norm(final)=2.255 | 4056.1 samples/s | 63.4 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09805 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.060 | L2-Norm(final)=2.246 | 3848.4 samples/s | 60.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08826 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.131 | L2-Norm(final)=2.246 | 4246.2 samples/s | 66.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07825 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.176 | L2-Norm(final)=2.249 | 4265.7 samples/s | 66.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07486 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.210 | L2-Norm(final)=2.254 | 5910.2 samples/s | 92.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06888 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.241 | L2-Norm(final)=2.258 | 1724.4 samples/s | 26.9 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06280 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.275 | L2-Norm(final)=2.266 | 4263.1 samples/s | 66.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05838 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.309 | L2-Norm(final)=2.274 | 4213.8 samples/s | 65.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05665 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.342 | L2-Norm(final)=2.280 | 5374.0 samples/s | 84.0 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05415 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.371 | L2-Norm(final)=2.284 | 1813.3 samples/s | 28.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05161 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.398 | L2-Norm(final)=2.288 | 4143.2 samples/s | 64.7 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04923 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.423 | L2-Norm(final)=2.293 | 4273.3 samples/s | 66.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04766 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.447 | L2-Norm(final)=2.298 | 5007.9 samples/s | 78.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04555 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.470 | L2-Norm(final)=2.302 | 1840.0 samples/s | 28.8 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04395 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.491 | L2-Norm(final)=2.306 | 4257.3 samples/s | 66.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04267 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.511 | L2-Norm(final)=2.309 | 4313.9 samples/s | 67.4 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04165 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.530 | L2-Norm(final)=2.313 | 4592.9 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.28244 | Reg=0.00222 | acc=0.8125 | L2-Norm=14.916 | L2-Norm(final)=2.254 | 3848.8 samples/s | 60.1 steps/s
[Step=2450 Epoch=12.0] | Loss=0.10061 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.040 | L2-Norm(final)=2.245 | 4062.1 samples/s | 63.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08930 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.110 | L2-Norm(final)=2.243 | 4227.8 samples/s | 66.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08117 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.162 | L2-Norm(final)=2.245 | 4311.3 samples/s | 67.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07676 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.205 | L2-Norm(final)=2.248 | 5829.1 samples/s | 91.1 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06841 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.244 | L2-Norm(final)=2.254 | 1753.6 samples/s | 27.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06455 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.282 | L2-Norm(final)=2.259 | 4382.8 samples/s | 68.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06142 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.317 | L2-Norm(final)=2.264 | 4269.4 samples/s | 66.7 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05820 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=2.270 | 5460.2 samples/s | 85.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05477 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.384 | L2-Norm(final)=2.276 | 1785.8 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05172 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.415 | L2-Norm(final)=2.282 | 4307.2 samples/s | 67.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04975 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.443 | L2-Norm(final)=2.288 | 4372.0 samples/s | 68.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04891 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.469 | L2-Norm(final)=2.291 | 5261.2 samples/s | 82.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04731 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.492 | L2-Norm(final)=2.294 | 1830.5 samples/s | 28.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04561 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.517 | L2-Norm(final)=2.298 | 4298.6 samples/s | 67.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04417 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.540 | L2-Norm(final)=2.301 | 4361.8 samples/s | 68.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04312 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.563 | L2-Norm(final)=2.304 | 4859.0 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.30660 | Reg=0.00222 | acc=0.7188 | L2-Norm=14.916 | L2-Norm(final)=2.254 | 4166.3 samples/s | 65.1 steps/s
[Step=2450 Epoch=11.9] | Loss=0.10137 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.035 | L2-Norm(final)=2.243 | 3807.8 samples/s | 59.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08970 | Reg=0.00228 | acc=0.9062 | L2-Norm=15.099 | L2-Norm(final)=2.246 | 4218.5 samples/s | 65.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08192 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.143 | L2-Norm(final)=2.248 | 4201.9 samples/s | 65.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07869 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.178 | L2-Norm(final)=2.251 | 5851.4 samples/s | 91.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06987 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.217 | L2-Norm(final)=2.259 | 1745.6 samples/s | 27.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06418 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.253 | L2-Norm(final)=2.269 | 4261.3 samples/s | 66.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06073 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.287 | L2-Norm(final)=2.277 | 4268.1 samples/s | 66.7 steps/s
[Step=2800 Epoch=13.6] | Loss=0.05877 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.320 | L2-Norm(final)=2.284 | 5328.7 samples/s | 83.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05588 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.352 | L2-Norm(final)=2.290 | 1789.9 samples/s | 28.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05362 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.384 | L2-Norm(final)=2.297 | 4240.9 samples/s | 66.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05110 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.414 | L2-Norm(final)=2.304 | 4266.8 samples/s | 66.7 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04966 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.444 | L2-Norm(final)=2.311 | 4975.3 samples/s | 77.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04746 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.473 | L2-Norm(final)=2.317 | 1828.5 samples/s | 28.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04628 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.499 | L2-Norm(final)=2.323 | 4274.1 samples/s | 66.8 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04549 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.526 | L2-Norm(final)=2.327 | 4276.5 samples/s | 66.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04470 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.551 | L2-Norm(final)=2.331 | 4555.2 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.20610 | Reg=0.00222 | acc=0.8438 | L2-Norm=14.916 | L2-Norm(final)=2.255 | 3977.6 samples/s | 62.1 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09012 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.033 | L2-Norm(final)=2.251 | 3871.0 samples/s | 60.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08146 | Reg=0.00228 | acc=0.9219 | L2-Norm=15.113 | L2-Norm(final)=2.257 | 4233.1 samples/s | 66.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07695 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.165 | L2-Norm(final)=2.258 | 4177.9 samples/s | 65.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07316 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.204 | L2-Norm(final)=2.259 | 5838.6 samples/s | 91.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06603 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.237 | L2-Norm(final)=2.261 | 1762.3 samples/s | 27.5 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06065 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.268 | L2-Norm(final)=2.266 | 4335.9 samples/s | 67.7 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05740 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.298 | L2-Norm(final)=2.271 | 4220.6 samples/s | 65.9 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05482 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.325 | L2-Norm(final)=2.275 | 5395.4 samples/s | 84.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05133 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=2.279 | 1787.3 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04823 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.377 | L2-Norm(final)=2.285 | 4317.5 samples/s | 67.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04622 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.401 | L2-Norm(final)=2.289 | 4258.4 samples/s | 66.5 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04508 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.424 | L2-Norm(final)=2.293 | 4922.4 samples/s | 76.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04324 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.446 | L2-Norm(final)=2.297 | 1850.2 samples/s | 28.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04171 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.468 | L2-Norm(final)=2.301 | 4276.1 samples/s | 66.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04068 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.489 | L2-Norm(final)=2.305 | 4285.8 samples/s | 67.0 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03942 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.508 | L2-Norm(final)=2.308 | 4662.6 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.20872 | Reg=0.00222 | acc=0.7812 | L2-Norm=14.916 | L2-Norm(final)=2.255 | 3731.5 samples/s | 58.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08801 | Reg=0.00227 | acc=0.9531 | L2-Norm=15.075 | L2-Norm(final)=2.247 | 4233.3 samples/s | 66.1 steps/s
[Step=2500 Epoch=12.3] | Loss=0.08118 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.150 | L2-Norm(final)=2.251 | 4308.5 samples/s | 67.3 steps/s
[Step=2550 Epoch=12.5] | Loss=0.07735 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.203 | L2-Norm(final)=2.252 | 4301.8 samples/s | 67.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07319 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.244 | L2-Norm(final)=2.252 | 5788.5 samples/s | 90.4 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06684 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.278 | L2-Norm(final)=2.255 | 1753.7 samples/s | 27.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06369 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.311 | L2-Norm(final)=2.259 | 4338.0 samples/s | 67.8 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05892 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.344 | L2-Norm(final)=2.264 | 4353.2 samples/s | 68.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05585 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.374 | L2-Norm(final)=2.269 | 5740.6 samples/s | 89.7 steps/s
[Step=2850 Epoch=14.0] | Loss=0.05291 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.404 | L2-Norm(final)=2.274 | 1770.5 samples/s | 27.7 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05034 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.433 | L2-Norm(final)=2.280 | 4333.1 samples/s | 67.7 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04877 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.460 | L2-Norm(final)=2.285 | 4232.5 samples/s | 66.1 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04657 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.485 | L2-Norm(final)=2.290 | 5349.3 samples/s | 83.6 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04482 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.508 | L2-Norm(final)=2.296 | 1798.1 samples/s | 28.1 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04350 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.530 | L2-Norm(final)=2.300 | 4367.0 samples/s | 68.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04199 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.551 | L2-Norm(final)=2.304 | 4331.4 samples/s | 67.7 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04110 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.572 | L2-Norm(final)=2.308 | 5055.5 samples/s | 79.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.03739 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.916 | L2-Norm(final)=2.256 | 3980.6 samples/s | 62.2 steps/s
[Step=2450 Epoch=23.2] | Loss=0.02180 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.123 | L2-Norm(final)=2.235 | 3794.3 samples/s | 59.3 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01399 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.210 | L2-Norm(final)=2.231 | 5571.9 samples/s | 87.1 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00955 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.237 | L2-Norm(final)=2.231 | 1670.0 samples/s | 26.1 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00722 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.236 | L2-Norm(final)=2.233 | 5166.5 samples/s | 80.7 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00579 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.222 | L2-Norm(final)=2.234 | 1745.0 samples/s | 27.3 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00483 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=2.236 | 4736.0 samples/s | 74.0 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00414 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=2.237 | 1762.0 samples/s | 27.5 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00362 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.153 | L2-Norm(final)=2.238 | 4418.6 samples/s | 69.0 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00322 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=2.239 | 1832.3 samples/s | 28.6 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00290 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=2.239 | 4089.0 samples/s | 63.9 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00264 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.065 | L2-Norm(final)=2.240 | 1871.0 samples/s | 29.2 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00242 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.034 | L2-Norm(final)=2.240 | 4047.3 samples/s | 63.2 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00223 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.003 | L2-Norm(final)=2.241 | 1869.2 samples/s | 29.2 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00207 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=2.241 | 4045.9 samples/s | 63.2 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00194 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.940 | L2-Norm(final)=2.241 | 1907.3 samples/s | 29.8 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00181 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.909 | L2-Norm(final)=2.242 | 3965.8 samples/s | 62.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.08879 | Reg=0.00222 | acc=0.9219 | L2-Norm=14.916 | L2-Norm(final)=2.254 | 3802.3 samples/s | 59.4 steps/s
[Step=2450 Epoch=23.3] | Loss=0.02398 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=2.229 | 3814.9 samples/s | 59.6 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01312 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.205 | L2-Norm(final)=2.228 | 5640.2 samples/s | 88.1 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00878 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.225 | L2-Norm(final)=2.232 | 1657.4 samples/s | 25.9 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00661 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.217 | L2-Norm(final)=2.236 | 5120.2 samples/s | 80.0 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00530 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.198 | L2-Norm(final)=2.238 | 1713.9 samples/s | 26.8 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00442 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=2.240 | 4814.0 samples/s | 75.2 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00379 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=2.242 | 1743.7 samples/s | 27.2 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00331 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=2.243 | 4439.5 samples/s | 69.4 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00295 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.084 | L2-Norm(final)=2.244 | 1822.2 samples/s | 28.5 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00265 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.052 | L2-Norm(final)=2.245 | 4077.6 samples/s | 63.7 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00241 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=2.246 | 1871.9 samples/s | 29.2 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00221 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=2.246 | 4104.5 samples/s | 64.1 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00204 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=2.247 | 1870.0 samples/s | 29.2 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00190 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=2.248 | 4089.4 samples/s | 63.9 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00177 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=2.248 | 1879.0 samples/s | 29.4 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00166 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=2.249 | 4054.6 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step3200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.05798 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.916 | L2-Norm(final)=2.255 | 3963.1 samples/s | 61.9 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02242 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.178 | L2-Norm(final)=2.236 | 3735.2 samples/s | 58.4 steps/s
[Step=2500 Epoch=23.9] | Loss=0.01415 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.273 | L2-Norm(final)=2.235 | 5640.6 samples/s | 88.1 steps/s
[Step=2550 Epoch=24.4] | Loss=0.00958 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=2.238 | 1659.7 samples/s | 25.9 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00719 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.291 | L2-Norm(final)=2.240 | 5291.2 samples/s | 82.7 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00576 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.272 | L2-Norm(final)=2.242 | 1692.0 samples/s | 26.4 steps/s
[Step=2700 Epoch=25.8] | Loss=0.00480 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.247 | L2-Norm(final)=2.243 | 4908.7 samples/s | 76.7 steps/s
[Step=2750 Epoch=26.3] | Loss=0.00412 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=2.244 | 1750.0 samples/s | 27.3 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00360 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=2.245 | 4531.0 samples/s | 70.8 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00320 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=2.246 | 1795.7 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00288 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=2.246 | 4393.9 samples/s | 68.7 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00262 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.088 | L2-Norm(final)=2.247 | 1803.1 samples/s | 28.2 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00240 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.054 | L2-Norm(final)=2.248 | 4014.1 samples/s | 62.7 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00222 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=2.248 | 1849.7 samples/s | 28.9 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00206 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.986 | L2-Norm(final)=2.249 | 4047.4 samples/s | 63.2 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00192 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.952 | L2-Norm(final)=2.249 | 1874.9 samples/s | 29.3 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00180 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.917 | L2-Norm(final)=2.249 | 4075.4 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.02909 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.916 | L2-Norm(final)=2.255 | 3562.0 samples/s | 55.7 steps/s
[Step=2450 Epoch=23.1] | Loss=0.03886 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=2.203 | 3915.0 samples/s | 61.2 steps/s
[Step=2500 Epoch=23.6] | Loss=0.02050 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.238 | L2-Norm(final)=2.194 | 5480.3 samples/s | 85.6 steps/s
[Step=2550 Epoch=24.0] | Loss=0.01371 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.260 | L2-Norm(final)=2.196 | 1697.0 samples/s | 26.5 steps/s
[Step=2600 Epoch=24.5] | Loss=0.01030 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.253 | L2-Norm(final)=2.198 | 4996.6 samples/s | 78.1 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00825 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.234 | L2-Norm(final)=2.200 | 1212.6 samples/s | 18.9 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00688 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.209 | L2-Norm(final)=2.201 | 4193.0 samples/s | 65.5 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00590 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.181 | L2-Norm(final)=2.202 | 1780.6 samples/s | 27.8 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00516 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.152 | L2-Norm(final)=2.203 | 4413.5 samples/s | 69.0 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00459 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=2.204 | 1886.8 samples/s | 29.5 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00413 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.090 | L2-Norm(final)=2.205 | 4087.2 samples/s | 63.9 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00376 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=2.205 | 1895.9 samples/s | 29.6 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00344 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=2.206 | 4122.7 samples/s | 64.4 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00318 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.996 | L2-Norm(final)=2.207 | 1900.5 samples/s | 29.7 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00295 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=2.207 | 4069.8 samples/s | 63.6 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00276 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.933 | L2-Norm(final)=2.208 | 2071.4 samples/s | 32.4 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00259 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=2.208 | 3614.9 samples/s | 56.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.06074 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.916 | L2-Norm(final)=2.254 | 3673.9 samples/s | 57.4 steps/s
[Step=2450 Epoch=23.4] | Loss=0.01820 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.095 | L2-Norm(final)=2.243 | 3852.3 samples/s | 60.2 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01337 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.204 | L2-Norm(final)=2.240 | 5639.3 samples/s | 88.1 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00953 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.251 | L2-Norm(final)=2.239 | 1673.4 samples/s | 26.1 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00717 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.260 | L2-Norm(final)=2.240 | 5317.4 samples/s | 83.1 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00595 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.255 | L2-Norm(final)=2.242 | 1699.5 samples/s | 26.6 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00497 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.247 | L2-Norm(final)=2.246 | 4745.3 samples/s | 74.1 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00426 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.232 | L2-Norm(final)=2.249 | 1738.4 samples/s | 27.2 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00373 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.212 | L2-Norm(final)=2.251 | 4627.5 samples/s | 72.3 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00332 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.188 | L2-Norm(final)=2.253 | 1800.6 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00299 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.162 | L2-Norm(final)=2.255 | 4404.0 samples/s | 68.8 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00272 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=2.257 | 1833.4 samples/s | 28.6 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00249 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=2.258 | 4096.4 samples/s | 64.0 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00230 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=2.259 | 1875.8 samples/s | 29.3 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00214 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.048 | L2-Norm(final)=2.261 | 4049.3 samples/s | 63.3 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00200 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.017 | L2-Norm(final)=2.262 | 1870.4 samples/s | 29.2 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00187 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.986 | L2-Norm(final)=2.263 | 4007.5 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40503 | acc=0.6870 | tpr=0.5597 | fpr=0.0367 | 3828.1 samples/s | 15.0 steps/s
Avg test loss: 0.40785, Avg test acc: 0.68331, Avg tpr: 0.55692, Avg fpr: 0.03871, total FA: 302

Testing server on iccad2012
[Step=  50] | Loss=0.20837 | acc=0.8880 | tpr=0.9735 | fpr=0.1136 | 3844.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.21165 | acc=0.8892 | tpr=0.9829 | fpr=0.1126 | 7170.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.21550 | acc=0.8882 | tpr=0.9841 | fpr=0.1136 | 7225.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.21613 | acc=0.8878 | tpr=0.9836 | fpr=0.1139 | 7206.4 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.21437 | acc=0.8881 | tpr=0.9834 | fpr=0.1136 | 7067.5 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.21557 | acc=0.8876 | tpr=0.9818 | fpr=0.1141 | 7101.9 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.21742 | acc=0.8870 | tpr=0.9812 | fpr=0.1148 | 7331.1 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.21781 | acc=0.8873 | tpr=0.9798 | fpr=0.1144 | 7155.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.22033 | acc=0.8866 | tpr=0.9796 | fpr=0.1151 | 7173.3 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.22019 | acc=0.8864 | tpr=0.9806 | fpr=0.1153 | 7025.4 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.21885 | acc=0.8871 | tpr=0.9805 | fpr=0.1146 | 12902.9 samples/s | 50.4 steps/s
Avg test loss: 0.21879, Avg test acc: 0.88706, Avg tpr: 0.98059, Avg fpr: 0.11464, total FA: 15917

server round 4/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.25987 | Reg=0.00213 | acc=0.7969 | L2-Norm=14.590 | L2-Norm(final)=2.300 | 3732.0 samples/s | 58.3 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08493 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.710 | L2-Norm(final)=2.282 | 4171.9 samples/s | 65.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07614 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.779 | L2-Norm(final)=2.283 | 4249.7 samples/s | 66.4 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06964 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.825 | L2-Norm(final)=2.285 | 4272.9 samples/s | 66.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06654 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.860 | L2-Norm(final)=2.284 | 5709.6 samples/s | 89.2 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06306 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.897 | L2-Norm(final)=2.285 | 1734.4 samples/s | 27.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05863 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.935 | L2-Norm(final)=2.290 | 4241.2 samples/s | 66.3 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05573 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.970 | L2-Norm(final)=2.295 | 4287.3 samples/s | 67.0 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05319 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.004 | L2-Norm(final)=2.299 | 5319.9 samples/s | 83.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05005 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.035 | L2-Norm(final)=2.303 | 1791.6 samples/s | 28.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04731 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=2.309 | 4241.1 samples/s | 66.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04524 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.092 | L2-Norm(final)=2.314 | 4258.2 samples/s | 66.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04395 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.119 | L2-Norm(final)=2.319 | 4986.7 samples/s | 77.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04247 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.146 | L2-Norm(final)=2.323 | 1843.0 samples/s | 28.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04100 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=2.327 | 4289.9 samples/s | 67.0 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04013 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.197 | L2-Norm(final)=2.331 | 4317.7 samples/s | 67.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03948 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.223 | L2-Norm(final)=2.334 | 4703.0 samples/s | 73.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.38371 | Reg=0.00213 | acc=0.6875 | L2-Norm=14.590 | L2-Norm(final)=2.301 | 3872.6 samples/s | 60.5 steps/s
[Step=3250 Epoch=15.9] | Loss=0.10374 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.731 | L2-Norm(final)=2.278 | 4069.1 samples/s | 63.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.08087 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.811 | L2-Norm(final)=2.287 | 4197.8 samples/s | 65.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07353 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.858 | L2-Norm(final)=2.292 | 4191.0 samples/s | 65.5 steps/s
[Step=3400 Epoch=16.6] | Loss=0.07019 | Reg=0.00222 | acc=0.9062 | L2-Norm=14.895 | L2-Norm(final)=2.292 | 5718.9 samples/s | 89.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06285 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.931 | L2-Norm(final)=2.294 | 1736.0 samples/s | 27.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05796 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.966 | L2-Norm(final)=2.299 | 4292.9 samples/s | 67.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05441 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.999 | L2-Norm(final)=2.305 | 4209.3 samples/s | 65.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05251 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.027 | L2-Norm(final)=2.310 | 5517.4 samples/s | 86.2 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04880 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.054 | L2-Norm(final)=2.314 | 1771.5 samples/s | 27.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04630 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.080 | L2-Norm(final)=2.319 | 4288.6 samples/s | 67.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04421 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.104 | L2-Norm(final)=2.325 | 4271.6 samples/s | 66.7 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04309 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=2.329 | 5183.7 samples/s | 81.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04152 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.149 | L2-Norm(final)=2.333 | 1786.1 samples/s | 27.9 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03966 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.170 | L2-Norm(final)=2.338 | 4410.5 samples/s | 68.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03844 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.190 | L2-Norm(final)=2.342 | 4379.5 samples/s | 68.4 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03711 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.208 | L2-Norm(final)=2.346 | 4887.0 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.24099 | Reg=0.00213 | acc=0.8281 | L2-Norm=14.590 | L2-Norm(final)=2.302 | 3745.2 samples/s | 58.5 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09449 | Reg=0.00216 | acc=0.9062 | L2-Norm=14.710 | L2-Norm(final)=2.291 | 4151.6 samples/s | 64.9 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07976 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.775 | L2-Norm(final)=2.293 | 4228.6 samples/s | 66.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07708 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.823 | L2-Norm(final)=2.295 | 4210.0 samples/s | 65.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06936 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.864 | L2-Norm(final)=2.298 | 5764.7 samples/s | 90.1 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06434 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.903 | L2-Norm(final)=2.303 | 1743.1 samples/s | 27.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05929 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.942 | L2-Norm(final)=2.309 | 4189.8 samples/s | 65.5 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05585 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=2.316 | 4249.9 samples/s | 66.4 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05230 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.014 | L2-Norm(final)=2.324 | 5382.0 samples/s | 84.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04930 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=2.331 | 1792.7 samples/s | 28.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04680 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.075 | L2-Norm(final)=2.337 | 4244.5 samples/s | 66.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04519 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.103 | L2-Norm(final)=2.342 | 4248.4 samples/s | 66.4 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04434 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.130 | L2-Norm(final)=2.347 | 4939.4 samples/s | 77.2 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04288 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.155 | L2-Norm(final)=2.350 | 1858.0 samples/s | 29.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04113 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.179 | L2-Norm(final)=2.354 | 4185.0 samples/s | 65.4 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04004 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.201 | L2-Norm(final)=2.358 | 4192.3 samples/s | 65.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03881 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.222 | L2-Norm(final)=2.362 | 4601.2 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.38270 | Reg=0.00213 | acc=0.7344 | L2-Norm=14.590 | L2-Norm(final)=2.301 | 3737.7 samples/s | 58.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08086 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.757 | L2-Norm(final)=2.299 | 4277.1 samples/s | 66.8 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07377 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.833 | L2-Norm(final)=2.304 | 4199.6 samples/s | 65.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07001 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.885 | L2-Norm(final)=2.303 | 4328.8 samples/s | 67.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06471 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.928 | L2-Norm(final)=2.303 | 5938.9 samples/s | 92.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05707 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=2.309 | 1772.0 samples/s | 27.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05297 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.000 | L2-Norm(final)=2.313 | 4395.7 samples/s | 68.7 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05003 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.031 | L2-Norm(final)=2.317 | 4337.4 samples/s | 67.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04790 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=2.321 | 5429.6 samples/s | 84.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04687 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.088 | L2-Norm(final)=2.324 | 1782.3 samples/s | 27.8 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04439 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.118 | L2-Norm(final)=2.328 | 4278.8 samples/s | 66.9 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04306 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.145 | L2-Norm(final)=2.331 | 4324.0 samples/s | 67.6 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04177 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.172 | L2-Norm(final)=2.333 | 4977.2 samples/s | 77.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04025 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.198 | L2-Norm(final)=2.335 | 1856.4 samples/s | 29.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03905 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.222 | L2-Norm(final)=2.338 | 4408.1 samples/s | 68.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03768 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.245 | L2-Norm(final)=2.339 | 4244.8 samples/s | 66.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03649 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.268 | L2-Norm(final)=2.342 | 4687.5 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.26053 | Reg=0.00213 | acc=0.7969 | L2-Norm=14.590 | L2-Norm(final)=2.301 | 3933.8 samples/s | 61.5 steps/s
[Step=3250 Epoch=15.9] | Loss=0.08346 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.730 | L2-Norm(final)=2.290 | 4007.5 samples/s | 62.6 steps/s
[Step=3300 Epoch=16.2] | Loss=0.07564 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.801 | L2-Norm(final)=2.292 | 4315.8 samples/s | 67.4 steps/s
[Step=3350 Epoch=16.4] | Loss=0.06871 | Reg=0.00221 | acc=0.9375 | L2-Norm=14.854 | L2-Norm(final)=2.292 | 4191.3 samples/s | 65.5 steps/s
[Step=3400 Epoch=16.7] | Loss=0.06393 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.896 | L2-Norm(final)=2.293 | 5906.1 samples/s | 92.3 steps/s
[Step=3450 Epoch=16.9] | Loss=0.05732 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.935 | L2-Norm(final)=2.296 | 1755.5 samples/s | 27.4 steps/s
[Step=3500 Epoch=17.2] | Loss=0.05255 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.970 | L2-Norm(final)=2.301 | 4252.2 samples/s | 66.4 steps/s
[Step=3550 Epoch=17.4] | Loss=0.04895 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.003 | L2-Norm(final)=2.307 | 4275.9 samples/s | 66.8 steps/s
[Step=3600 Epoch=17.7] | Loss=0.04686 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.031 | L2-Norm(final)=2.312 | 5687.8 samples/s | 88.9 steps/s
[Step=3650 Epoch=17.9] | Loss=0.04425 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=2.317 | 1796.2 samples/s | 28.1 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04219 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.087 | L2-Norm(final)=2.322 | 4333.6 samples/s | 67.7 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04047 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.111 | L2-Norm(final)=2.327 | 4314.0 samples/s | 67.4 steps/s
[Step=3800 Epoch=18.6] | Loss=0.03924 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.134 | L2-Norm(final)=2.331 | 5410.9 samples/s | 84.5 steps/s
[Step=3850 Epoch=18.9] | Loss=0.03808 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.156 | L2-Norm(final)=2.334 | 1788.5 samples/s | 27.9 steps/s
[Step=3900 Epoch=19.1] | Loss=0.03674 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.177 | L2-Norm(final)=2.337 | 4301.5 samples/s | 67.2 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03565 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=2.341 | 4218.6 samples/s | 65.9 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03492 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.217 | L2-Norm(final)=2.344 | 5160.0 samples/s | 80.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.02545 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.590 | L2-Norm(final)=2.303 | 3775.8 samples/s | 59.0 steps/s
[Step=3250 Epoch=30.8] | Loss=0.02448 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.806 | L2-Norm(final)=2.298 | 3866.4 samples/s | 60.4 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01345 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.937 | L2-Norm(final)=2.289 | 5584.0 samples/s | 87.2 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00984 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.977 | L2-Norm(final)=2.287 | 1688.8 samples/s | 26.4 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00755 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=2.288 | 4983.5 samples/s | 77.9 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00605 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=2.290 | 1731.9 samples/s | 27.1 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00504 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.974 | L2-Norm(final)=2.292 | 4708.3 samples/s | 73.6 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00433 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=2.293 | 1767.7 samples/s | 27.6 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00379 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.933 | L2-Norm(final)=2.294 | 4365.9 samples/s | 68.2 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00337 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.908 | L2-Norm(final)=2.295 | 1827.2 samples/s | 28.5 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00303 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.881 | L2-Norm(final)=2.296 | 4207.5 samples/s | 65.7 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00276 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=2.297 | 1865.9 samples/s | 29.2 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00253 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.825 | L2-Norm(final)=2.297 | 3986.2 samples/s | 62.3 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00233 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=2.298 | 1893.2 samples/s | 29.6 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00217 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.766 | L2-Norm(final)=2.299 | 4056.1 samples/s | 63.4 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00202 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.736 | L2-Norm(final)=2.299 | 1880.5 samples/s | 29.4 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00190 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.706 | L2-Norm(final)=2.300 | 4023.8 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.08297 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.590 | L2-Norm(final)=2.302 | 3487.0 samples/s | 54.5 steps/s
[Step=3250 Epoch=30.9] | Loss=0.02684 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.794 | L2-Norm(final)=2.285 | 3885.6 samples/s | 60.7 steps/s
[Step=3300 Epoch=31.4] | Loss=0.01618 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=2.268 | 5636.9 samples/s | 88.1 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01088 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=2.266 | 1659.1 samples/s | 25.9 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00818 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.000 | L2-Norm(final)=2.267 | 5109.4 samples/s | 79.8 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00654 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.993 | L2-Norm(final)=2.268 | 1727.5 samples/s | 27.0 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00546 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.977 | L2-Norm(final)=2.269 | 4789.1 samples/s | 74.8 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00468 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.956 | L2-Norm(final)=2.270 | 1779.7 samples/s | 27.8 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00409 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.931 | L2-Norm(final)=2.270 | 4414.3 samples/s | 69.0 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00364 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=2.271 | 1812.7 samples/s | 28.3 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00328 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.877 | L2-Norm(final)=2.272 | 4127.9 samples/s | 64.5 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00298 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=2.272 | 1878.0 samples/s | 29.3 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00273 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.818 | L2-Norm(final)=2.273 | 3970.9 samples/s | 62.0 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00252 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.788 | L2-Norm(final)=2.273 | 1916.7 samples/s | 29.9 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00234 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=2.274 | 4033.9 samples/s | 63.0 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00219 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=2.274 | 1873.8 samples/s | 29.3 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00205 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.697 | L2-Norm(final)=2.275 | 3999.2 samples/s | 62.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.02486 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.590 | L2-Norm(final)=2.303 | 4097.3 samples/s | 64.0 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01471 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.742 | L2-Norm(final)=2.295 | 3662.0 samples/s | 57.2 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00828 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.829 | L2-Norm(final)=2.287 | 5617.9 samples/s | 87.8 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00783 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=2.286 | 1654.4 samples/s | 25.8 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00657 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.878 | L2-Norm(final)=2.282 | 5151.0 samples/s | 80.5 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00528 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.889 | L2-Norm(final)=2.283 | 1709.7 samples/s | 26.7 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00440 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.884 | L2-Norm(final)=2.284 | 4920.3 samples/s | 76.9 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00378 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.870 | L2-Norm(final)=2.285 | 1759.6 samples/s | 27.5 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00331 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.851 | L2-Norm(final)=2.286 | 4616.8 samples/s | 72.1 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00294 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.828 | L2-Norm(final)=2.287 | 1767.0 samples/s | 27.6 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00265 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.803 | L2-Norm(final)=2.288 | 4346.0 samples/s | 67.9 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00241 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=2.288 | 1791.6 samples/s | 28.0 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00221 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.748 | L2-Norm(final)=2.289 | 4108.2 samples/s | 64.2 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00204 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.719 | L2-Norm(final)=2.290 | 1884.8 samples/s | 29.5 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00189 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.689 | L2-Norm(final)=2.290 | 4149.7 samples/s | 64.8 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00177 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=2.291 | 1860.5 samples/s | 29.1 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00166 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=2.291 | 4132.9 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.04782 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.590 | L2-Norm(final)=2.302 | 3960.7 samples/s | 61.9 steps/s
[Step=3250 Epoch=30.6] | Loss=0.01575 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.742 | L2-Norm(final)=2.288 | 3609.3 samples/s | 56.4 steps/s
[Step=3300 Epoch=31.1] | Loss=0.01658 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=2.274 | 5494.5 samples/s | 85.9 steps/s
[Step=3350 Epoch=31.6] | Loss=0.01128 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.922 | L2-Norm(final)=2.271 | 1695.1 samples/s | 26.5 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00858 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=2.272 | 4971.4 samples/s | 77.7 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00690 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=2.274 | 1751.6 samples/s | 27.4 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00575 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.939 | L2-Norm(final)=2.276 | 4555.8 samples/s | 71.2 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00493 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.923 | L2-Norm(final)=2.278 | 1780.9 samples/s | 27.8 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00432 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=2.279 | 4177.8 samples/s | 65.3 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00384 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.880 | L2-Norm(final)=2.280 | 1836.1 samples/s | 28.7 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00346 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=2.281 | 4097.1 samples/s | 64.0 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00314 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.828 | L2-Norm(final)=2.282 | 1901.4 samples/s | 29.7 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00288 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=2.282 | 4040.9 samples/s | 63.1 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00266 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=2.283 | 1884.1 samples/s | 29.4 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00247 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=2.284 | 4025.8 samples/s | 62.9 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00231 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.717 | L2-Norm(final)=2.284 | 1960.1 samples/s | 30.6 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00216 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.688 | L2-Norm(final)=2.285 | 3720.2 samples/s | 58.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.5] | Loss=0.01890 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=2.303 | 3820.4 samples/s | 59.7 steps/s
[Step=3250 Epoch=31.0] | Loss=0.03257 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.814 | L2-Norm(final)=2.279 | 3805.2 samples/s | 59.5 steps/s
[Step=3300 Epoch=31.5] | Loss=0.02069 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.027 | L2-Norm(final)=2.244 | 5580.5 samples/s | 87.2 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01419 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.105 | L2-Norm(final)=2.236 | 1680.3 samples/s | 26.3 steps/s
[Step=3400 Epoch=32.4] | Loss=0.01084 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=2.234 | 5234.4 samples/s | 81.8 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00869 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=2.233 | 1723.8 samples/s | 26.9 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00725 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=2.234 | 4867.0 samples/s | 76.0 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00626 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=2.234 | 1769.8 samples/s | 27.7 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00548 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.094 | L2-Norm(final)=2.235 | 4626.0 samples/s | 72.3 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00487 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=2.236 | 1796.4 samples/s | 28.1 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00439 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.049 | L2-Norm(final)=2.237 | 4304.9 samples/s | 67.3 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00399 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=2.237 | 1797.2 samples/s | 28.1 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00366 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.998 | L2-Norm(final)=2.238 | 4054.0 samples/s | 63.3 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00338 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.971 | L2-Norm(final)=2.239 | 1852.5 samples/s | 28.9 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00314 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.944 | L2-Norm(final)=2.240 | 4031.3 samples/s | 63.0 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00293 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.917 | L2-Norm(final)=2.240 | 1881.8 samples/s | 29.4 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00274 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.889 | L2-Norm(final)=2.241 | 4023.3 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40121 | acc=0.7039 | tpr=0.5806 | fpr=0.0282 | 3824.9 samples/s | 14.9 steps/s
Avg test loss: 0.40193, Avg test acc: 0.70062, Avg tpr: 0.57819, Avg fpr: 0.03012, total FA: 235

Testing server on iccad2012
[Step=  50] | Loss=0.20570 | acc=0.8919 | tpr=0.9735 | fpr=0.1096 | 3799.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.20771 | acc=0.8929 | tpr=0.9851 | fpr=0.1088 | 7204.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.21096 | acc=0.8927 | tpr=0.9856 | fpr=0.1090 | 7300.9 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.21179 | acc=0.8930 | tpr=0.9858 | fpr=0.1087 | 7139.5 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.20973 | acc=0.8937 | tpr=0.9843 | fpr=0.1079 | 7265.8 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.21081 | acc=0.8930 | tpr=0.9818 | fpr=0.1086 | 7271.9 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.21241 | acc=0.8925 | tpr=0.9806 | fpr=0.1091 | 7183.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.21281 | acc=0.8926 | tpr=0.9787 | fpr=0.1090 | 7367.7 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.21515 | acc=0.8919 | tpr=0.9791 | fpr=0.1096 | 6965.2 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.21516 | acc=0.8916 | tpr=0.9802 | fpr=0.1100 | 6828.8 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.21385 | acc=0.8922 | tpr=0.9797 | fpr=0.1094 | 13417.8 samples/s | 52.4 steps/s
Avg test loss: 0.21377, Avg test acc: 0.89220, Avg tpr: 0.97979, Avg fpr: 0.10939, total FA: 15189

server round 5/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.15228 | Reg=0.00206 | acc=0.8906 | L2-Norm=14.343 | L2-Norm(final)=2.332 | 4124.3 samples/s | 64.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.09174 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.472 | L2-Norm(final)=2.313 | 3874.9 samples/s | 60.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07615 | Reg=0.00212 | acc=0.9219 | L2-Norm=14.554 | L2-Norm(final)=2.322 | 4287.3 samples/s | 67.0 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06875 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.607 | L2-Norm(final)=2.323 | 4311.2 samples/s | 67.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06234 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.648 | L2-Norm(final)=2.324 | 5876.5 samples/s | 91.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05778 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.684 | L2-Norm(final)=2.326 | 1772.1 samples/s | 27.7 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05249 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.718 | L2-Norm(final)=2.330 | 4337.7 samples/s | 67.8 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04916 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.749 | L2-Norm(final)=2.336 | 4332.6 samples/s | 67.7 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04750 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.778 | L2-Norm(final)=2.339 | 5441.0 samples/s | 85.0 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04502 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.806 | L2-Norm(final)=2.342 | 1816.4 samples/s | 28.4 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04317 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.832 | L2-Norm(final)=2.346 | 4335.0 samples/s | 67.7 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04118 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.856 | L2-Norm(final)=2.348 | 4296.2 samples/s | 67.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03990 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.880 | L2-Norm(final)=2.352 | 5097.4 samples/s | 79.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03990 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=2.354 | 1867.2 samples/s | 29.2 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03858 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.933 | L2-Norm(final)=2.357 | 4215.6 samples/s | 65.9 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03764 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.959 | L2-Norm(final)=2.359 | 4276.0 samples/s | 66.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03656 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.983 | L2-Norm(final)=2.362 | 4673.0 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.26738 | Reg=0.00206 | acc=0.7344 | L2-Norm=14.343 | L2-Norm(final)=2.331 | 4013.0 samples/s | 62.7 steps/s
[Step=4050 Epoch=19.8] | Loss=0.09606 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.468 | L2-Norm(final)=2.308 | 4058.9 samples/s | 63.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07546 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.542 | L2-Norm(final)=2.315 | 4307.9 samples/s | 67.3 steps/s
[Step=4150 Epoch=20.3] | Loss=0.06561 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.595 | L2-Norm(final)=2.323 | 4293.2 samples/s | 67.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06170 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.639 | L2-Norm(final)=2.327 | 5919.1 samples/s | 92.5 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05550 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.677 | L2-Norm(final)=2.330 | 1766.4 samples/s | 27.6 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05192 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.711 | L2-Norm(final)=2.335 | 4432.1 samples/s | 69.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04896 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.743 | L2-Norm(final)=2.339 | 4388.8 samples/s | 68.6 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04716 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.772 | L2-Norm(final)=2.342 | 5535.8 samples/s | 86.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04529 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.801 | L2-Norm(final)=2.343 | 1771.6 samples/s | 27.7 steps/s
[Step=4500 Epoch=22.0] | Loss=0.04334 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.831 | L2-Norm(final)=2.346 | 4299.3 samples/s | 67.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04086 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=2.349 | 4254.7 samples/s | 66.5 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03953 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=2.353 | 5205.5 samples/s | 81.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03810 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.911 | L2-Norm(final)=2.356 | 1790.7 samples/s | 28.0 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03656 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.935 | L2-Norm(final)=2.359 | 4229.8 samples/s | 66.1 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03539 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.960 | L2-Norm(final)=2.363 | 4214.6 samples/s | 65.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03459 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.984 | L2-Norm(final)=2.367 | 4806.6 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.29269 | Reg=0.00206 | acc=0.7656 | L2-Norm=14.343 | L2-Norm(final)=2.331 | 3996.6 samples/s | 62.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.09300 | Reg=0.00210 | acc=0.9062 | L2-Norm=14.483 | L2-Norm(final)=2.314 | 4000.8 samples/s | 62.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07858 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.559 | L2-Norm(final)=2.319 | 4370.5 samples/s | 68.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.07158 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.614 | L2-Norm(final)=2.322 | 4441.5 samples/s | 69.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06529 | Reg=0.00215 | acc=0.8906 | L2-Norm=14.662 | L2-Norm(final)=2.326 | 5778.5 samples/s | 90.3 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05940 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.707 | L2-Norm(final)=2.333 | 1777.4 samples/s | 27.8 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05582 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.747 | L2-Norm(final)=2.338 | 4418.3 samples/s | 69.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.05366 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.786 | L2-Norm(final)=2.343 | 4377.5 samples/s | 68.4 steps/s
[Step=4400 Epoch=21.4] | Loss=0.05098 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.826 | L2-Norm(final)=2.347 | 5294.9 samples/s | 82.7 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04848 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.866 | L2-Norm(final)=2.352 | 1821.1 samples/s | 28.5 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04639 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.905 | L2-Norm(final)=2.357 | 4309.5 samples/s | 67.3 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04453 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=2.363 | 4447.2 samples/s | 69.5 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04319 | Reg=0.00225 | acc=0.9219 | L2-Norm=14.982 | L2-Norm(final)=2.367 | 5095.6 samples/s | 79.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04251 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.017 | L2-Norm(final)=2.370 | 1813.6 samples/s | 28.3 steps/s
[Step=4700 Epoch=22.9] | Loss=0.04121 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.052 | L2-Norm(final)=2.373 | 4339.7 samples/s | 67.8 steps/s
[Step=4750 Epoch=23.1] | Loss=0.04020 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.085 | L2-Norm(final)=2.376 | 4318.1 samples/s | 67.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03922 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.115 | L2-Norm(final)=2.378 | 4757.9 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.36257 | Reg=0.00206 | acc=0.7656 | L2-Norm=14.343 | L2-Norm(final)=2.330 | 4091.4 samples/s | 63.9 steps/s
[Step=4050 Epoch=19.8] | Loss=0.09347 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.479 | L2-Norm(final)=2.313 | 3963.9 samples/s | 61.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07411 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=2.324 | 4396.8 samples/s | 68.7 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06766 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.621 | L2-Norm(final)=2.328 | 4459.1 samples/s | 69.7 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06328 | Reg=0.00215 | acc=0.8906 | L2-Norm=14.671 | L2-Norm(final)=2.328 | 5725.2 samples/s | 89.5 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05526 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.719 | L2-Norm(final)=2.333 | 1736.9 samples/s | 27.1 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05123 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.760 | L2-Norm(final)=2.340 | 4375.6 samples/s | 68.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04871 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.792 | L2-Norm(final)=2.344 | 4439.6 samples/s | 69.4 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04696 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.822 | L2-Norm(final)=2.347 | 5334.9 samples/s | 83.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04469 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.852 | L2-Norm(final)=2.351 | 1815.2 samples/s | 28.4 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04294 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.882 | L2-Norm(final)=2.354 | 4379.7 samples/s | 68.4 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04094 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.912 | L2-Norm(final)=2.358 | 4199.5 samples/s | 65.6 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03979 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.941 | L2-Norm(final)=2.362 | 5029.2 samples/s | 78.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03810 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.968 | L2-Norm(final)=2.366 | 1847.1 samples/s | 28.9 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03659 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.993 | L2-Norm(final)=2.370 | 4350.6 samples/s | 68.0 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03536 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.018 | L2-Norm(final)=2.374 | 4306.3 samples/s | 67.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03434 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.040 | L2-Norm(final)=2.377 | 4713.8 samples/s | 73.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step4800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.21400 | Reg=0.00206 | acc=0.8750 | L2-Norm=14.343 | L2-Norm(final)=2.331 | 3834.8 samples/s | 59.9 steps/s
[Step=4050 Epoch=19.9] | Loss=0.09773 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.495 | L2-Norm(final)=2.308 | 4128.3 samples/s | 64.5 steps/s
[Step=4100 Epoch=20.1] | Loss=0.07782 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.589 | L2-Norm(final)=2.317 | 4338.6 samples/s | 67.8 steps/s
[Step=4150 Epoch=20.4] | Loss=0.06937 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.648 | L2-Norm(final)=2.322 | 4280.9 samples/s | 66.9 steps/s
[Step=4200 Epoch=20.6] | Loss=0.06505 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.694 | L2-Norm(final)=2.324 | 5957.7 samples/s | 93.1 steps/s
[Step=4250 Epoch=20.8] | Loss=0.05767 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.734 | L2-Norm(final)=2.329 | 1739.2 samples/s | 27.2 steps/s
[Step=4300 Epoch=21.1] | Loss=0.05336 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.770 | L2-Norm(final)=2.334 | 4298.0 samples/s | 67.2 steps/s
[Step=4350 Epoch=21.3] | Loss=0.04951 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.802 | L2-Norm(final)=2.340 | 4168.2 samples/s | 65.1 steps/s
[Step=4400 Epoch=21.6] | Loss=0.04687 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.832 | L2-Norm(final)=2.345 | 5667.7 samples/s | 88.6 steps/s
[Step=4450 Epoch=21.8] | Loss=0.04401 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=2.349 | 1789.5 samples/s | 28.0 steps/s
[Step=4500 Epoch=22.1] | Loss=0.04136 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.886 | L2-Norm(final)=2.355 | 4315.3 samples/s | 67.4 steps/s
[Step=4550 Epoch=22.3] | Loss=0.03946 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.910 | L2-Norm(final)=2.360 | 4349.4 samples/s | 68.0 steps/s
[Step=4600 Epoch=22.6] | Loss=0.03828 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.935 | L2-Norm(final)=2.365 | 5376.3 samples/s | 84.0 steps/s
[Step=4650 Epoch=22.8] | Loss=0.03684 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=2.369 | 1812.7 samples/s | 28.3 steps/s
[Step=4700 Epoch=23.0] | Loss=0.03559 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.980 | L2-Norm(final)=2.373 | 4413.1 samples/s | 69.0 steps/s
[Step=4750 Epoch=23.3] | Loss=0.03489 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.001 | L2-Norm(final)=2.376 | 4322.9 samples/s | 67.5 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03368 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.022 | L2-Norm(final)=2.379 | 5159.3 samples/s | 80.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.01885 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.343 | L2-Norm(final)=2.333 | 3629.6 samples/s | 56.7 steps/s
[Step=4050 Epoch=38.4] | Loss=0.01192 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=2.332 | 4122.7 samples/s | 64.4 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00963 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.319 | 5586.7 samples/s | 87.3 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00669 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=2.315 | 1700.2 samples/s | 26.6 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00518 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.600 | L2-Norm(final)=2.316 | 5132.0 samples/s | 80.2 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00509 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=2.315 | 1745.5 samples/s | 27.3 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00441 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=2.313 | 4736.8 samples/s | 74.0 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00379 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=2.314 | 1744.5 samples/s | 27.3 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00332 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.580 | L2-Norm(final)=2.315 | 4405.1 samples/s | 68.8 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00295 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.316 | 1816.6 samples/s | 28.4 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00266 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=2.317 | 4181.2 samples/s | 65.3 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00242 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=2.318 | 1886.8 samples/s | 29.5 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00222 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.494 | L2-Norm(final)=2.318 | 4193.8 samples/s | 65.5 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00205 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=2.319 | 1896.7 samples/s | 29.6 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00190 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=2.320 | 4056.1 samples/s | 63.4 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00177 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=2.320 | 1912.7 samples/s | 29.9 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00166 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=2.321 | 4189.2 samples/s | 65.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step4800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.04674 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.343 | L2-Norm(final)=2.332 | 3674.9 samples/s | 57.4 steps/s
[Step=4050 Epoch=38.5] | Loss=0.00713 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.485 | L2-Norm(final)=2.343 | 3968.4 samples/s | 62.0 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01291 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.567 | L2-Norm(final)=2.342 | 5658.1 samples/s | 88.4 steps/s
[Step=4150 Epoch=39.5] | Loss=0.01208 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.719 | L2-Norm(final)=2.306 | 1680.8 samples/s | 26.3 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00921 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.807 | L2-Norm(final)=2.289 | 5102.9 samples/s | 79.7 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00745 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.852 | L2-Norm(final)=2.281 | 1717.0 samples/s | 26.8 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00622 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.873 | L2-Norm(final)=2.276 | 4732.7 samples/s | 73.9 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00533 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.878 | L2-Norm(final)=2.273 | 1795.5 samples/s | 28.1 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00467 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.874 | L2-Norm(final)=2.271 | 4388.9 samples/s | 68.6 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00415 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.864 | L2-Norm(final)=2.270 | 1832.3 samples/s | 28.6 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00374 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.849 | L2-Norm(final)=2.269 | 4142.8 samples/s | 64.7 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00340 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.832 | L2-Norm(final)=2.268 | 1876.2 samples/s | 29.3 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00312 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.812 | L2-Norm(final)=2.268 | 4135.3 samples/s | 64.6 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00288 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.791 | L2-Norm(final)=2.268 | 1910.2 samples/s | 29.8 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00267 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.769 | L2-Norm(final)=2.269 | 3928.7 samples/s | 61.4 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00249 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=2.270 | 1862.8 samples/s | 29.1 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00234 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=2.271 | 4029.5 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.02778 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.343 | L2-Norm(final)=2.333 | 3613.7 samples/s | 56.5 steps/s
[Step=4050 Epoch=38.7] | Loss=0.02182 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=2.315 | 3924.4 samples/s | 61.3 steps/s
[Step=4100 Epoch=39.2] | Loss=0.01318 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.725 | L2-Norm(final)=2.292 | 5705.5 samples/s | 89.1 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00885 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=2.287 | 1680.7 samples/s | 26.3 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00666 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=2.286 | 5179.8 samples/s | 80.9 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00533 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.741 | L2-Norm(final)=2.286 | 1713.8 samples/s | 26.8 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00445 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.717 | L2-Norm(final)=2.286 | 4808.6 samples/s | 75.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00381 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.689 | L2-Norm(final)=2.287 | 1754.1 samples/s | 27.4 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00334 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=2.287 | 4568.8 samples/s | 71.4 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00297 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=2.288 | 1787.2 samples/s | 27.9 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00267 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.595 | L2-Norm(final)=2.289 | 4250.7 samples/s | 66.4 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00243 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.289 | 1836.4 samples/s | 28.7 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00223 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.529 | L2-Norm(final)=2.290 | 4233.3 samples/s | 66.1 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00206 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=2.290 | 1881.5 samples/s | 29.4 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00191 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=2.291 | 4057.3 samples/s | 63.4 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00178 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.428 | L2-Norm(final)=2.291 | 1884.2 samples/s | 29.4 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00167 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=2.292 | 4162.7 samples/s | 65.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.07100 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.343 | L2-Norm(final)=2.331 | 3799.8 samples/s | 59.4 steps/s
[Step=4050 Epoch=38.2] | Loss=0.01845 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.467 | L2-Norm(final)=2.320 | 3831.4 samples/s | 59.9 steps/s
[Step=4100 Epoch=38.6] | Loss=0.01103 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=2.322 | 5600.0 samples/s | 87.5 steps/s
[Step=4150 Epoch=39.1] | Loss=0.00750 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.605 | L2-Norm(final)=2.326 | 1716.0 samples/s | 26.8 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00600 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=2.330 | 5103.3 samples/s | 79.7 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00491 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=2.332 | 1756.9 samples/s | 27.5 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00411 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=2.334 | 4550.8 samples/s | 71.1 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00352 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.336 | 1790.1 samples/s | 28.0 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00308 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=2.338 | 4234.0 samples/s | 66.2 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00274 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.539 | L2-Norm(final)=2.339 | 1856.7 samples/s | 29.0 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00247 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=2.340 | 4180.7 samples/s | 65.3 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00224 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=2.341 | 1883.5 samples/s | 29.4 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00206 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=2.342 | 4135.3 samples/s | 64.6 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00190 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.431 | L2-Norm(final)=2.343 | 1892.9 samples/s | 29.6 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00176 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.403 | L2-Norm(final)=2.343 | 4024.2 samples/s | 62.9 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00165 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=2.344 | 2070.4 samples/s | 32.4 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00154 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=2.345 | 3491.2 samples/s | 54.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.04461 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.343 | L2-Norm(final)=2.332 | 3731.4 samples/s | 58.3 steps/s
[Step=4050 Epoch=38.6] | Loss=0.01245 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.501 | L2-Norm(final)=2.327 | 3827.3 samples/s | 59.8 steps/s
[Step=4100 Epoch=39.1] | Loss=0.00709 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.570 | L2-Norm(final)=2.339 | 5586.9 samples/s | 87.3 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00479 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=2.347 | 1681.7 samples/s | 26.3 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00361 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=2.353 | 5133.6 samples/s | 80.2 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00289 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.552 | L2-Norm(final)=2.357 | 1691.1 samples/s | 26.4 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00241 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=2.360 | 4845.2 samples/s | 75.7 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00207 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=2.362 | 1735.8 samples/s | 27.1 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00181 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=2.364 | 4563.4 samples/s | 71.3 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00161 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=2.366 | 1815.6 samples/s | 28.4 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00145 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.408 | L2-Norm(final)=2.367 | 4215.4 samples/s | 65.9 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00132 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=2.368 | 1803.1 samples/s | 28.2 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00121 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=2.369 | 4097.2 samples/s | 64.0 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00112 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.314 | L2-Norm(final)=2.370 | 1865.4 samples/s | 29.1 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00104 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=2.371 | 4018.9 samples/s | 62.8 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00097 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.372 | 1894.2 samples/s | 29.6 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00091 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=2.373 | 4116.5 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.53333 | acc=0.6380 | tpr=0.4782 | fpr=0.0149 | 3779.9 samples/s | 14.8 steps/s
Avg test loss: 0.53364, Avg test acc: 0.63551, Avg tpr: 0.47701, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.18907 | acc=0.9087 | tpr=0.9690 | fpr=0.0924 | 3752.7 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.19081 | acc=0.9098 | tpr=0.9808 | fpr=0.0915 | 7204.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.19380 | acc=0.9098 | tpr=0.9827 | fpr=0.0915 | 7252.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.19489 | acc=0.9101 | tpr=0.9803 | fpr=0.0912 | 7302.2 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.19318 | acc=0.9107 | tpr=0.9790 | fpr=0.0905 | 7280.5 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.19476 | acc=0.9100 | tpr=0.9760 | fpr=0.0912 | 6931.3 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.19628 | acc=0.9094 | tpr=0.9756 | fpr=0.0918 | 7269.8 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.19663 | acc=0.9096 | tpr=0.9759 | fpr=0.0916 | 7186.5 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.19863 | acc=0.9094 | tpr=0.9771 | fpr=0.0918 | 7104.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.19840 | acc=0.9092 | tpr=0.9775 | fpr=0.0920 | 7061.0 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.19711 | acc=0.9100 | tpr=0.9773 | fpr=0.0912 | 13622.5 samples/s | 53.2 steps/s
Avg test loss: 0.19700, Avg test acc: 0.91002, Avg tpr: 0.97702, Avg fpr: 0.09119, total FA: 12662

server round 6/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.44507 | Reg=0.00200 | acc=0.6562 | L2-Norm=14.125 | L2-Norm(final)=2.363 | 3720.8 samples/s | 58.1 steps/s
[Step=4850 Epoch=23.6] | Loss=0.09102 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.297 | L2-Norm(final)=2.327 | 4284.7 samples/s | 66.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07189 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.382 | L2-Norm(final)=2.335 | 4273.9 samples/s | 66.8 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06451 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=2.344 | 4227.5 samples/s | 66.1 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06079 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.484 | L2-Norm(final)=2.345 | 5785.8 samples/s | 90.4 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05664 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=2.348 | 1754.4 samples/s | 27.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.05239 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.570 | L2-Norm(final)=2.353 | 4285.0 samples/s | 67.0 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04910 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.609 | L2-Norm(final)=2.358 | 4197.4 samples/s | 65.6 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04660 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=2.363 | 5296.8 samples/s | 82.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04328 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=2.368 | 1794.7 samples/s | 28.0 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04120 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.709 | L2-Norm(final)=2.373 | 4186.8 samples/s | 65.4 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03946 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.738 | L2-Norm(final)=2.378 | 4263.0 samples/s | 66.6 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03871 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=2.382 | 4971.9 samples/s | 77.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03685 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.790 | L2-Norm(final)=2.386 | 1815.8 samples/s | 28.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03576 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=2.389 | 4215.7 samples/s | 65.9 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03467 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.835 | L2-Norm(final)=2.393 | 4240.6 samples/s | 66.3 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03361 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.856 | L2-Norm(final)=2.396 | 4586.0 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.53904 | Reg=0.00200 | acc=0.6719 | L2-Norm=14.125 | L2-Norm(final)=2.361 | 3967.2 samples/s | 62.0 steps/s
[Step=4850 Epoch=23.7] | Loss=0.09543 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.328 | L2-Norm(final)=2.324 | 3919.7 samples/s | 61.2 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07656 | Reg=0.00208 | acc=0.9375 | L2-Norm=14.406 | L2-Norm(final)=2.322 | 4262.3 samples/s | 66.6 steps/s
[Step=4950 Epoch=24.2] | Loss=0.06832 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.458 | L2-Norm(final)=2.321 | 4249.0 samples/s | 66.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06153 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.504 | L2-Norm(final)=2.323 | 5832.1 samples/s | 91.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05408 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.543 | L2-Norm(final)=2.326 | 1738.6 samples/s | 27.2 steps/s
[Step=5100 Epoch=24.9] | Loss=0.05010 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.577 | L2-Norm(final)=2.331 | 4256.2 samples/s | 66.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04678 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.607 | L2-Norm(final)=2.334 | 4209.9 samples/s | 65.8 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04431 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.634 | L2-Norm(final)=2.338 | 5423.6 samples/s | 84.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04180 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.662 | L2-Norm(final)=2.342 | 1750.2 samples/s | 27.3 steps/s
[Step=5300 Epoch=25.9] | Loss=0.03963 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=2.347 | 4210.0 samples/s | 65.8 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03797 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.720 | L2-Norm(final)=2.353 | 4213.4 samples/s | 65.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03756 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.749 | L2-Norm(final)=2.357 | 5083.6 samples/s | 79.4 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03625 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=2.359 | 1809.7 samples/s | 28.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03478 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.803 | L2-Norm(final)=2.362 | 4182.5 samples/s | 65.4 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03398 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=2.365 | 4203.2 samples/s | 65.7 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03288 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.850 | L2-Norm(final)=2.368 | 4755.9 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.23542 | Reg=0.00200 | acc=0.8594 | L2-Norm=14.125 | L2-Norm(final)=2.363 | 3850.2 samples/s | 60.2 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07397 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.251 | L2-Norm(final)=2.341 | 4125.0 samples/s | 64.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06506 | Reg=0.00205 | acc=0.8750 | L2-Norm=14.326 | L2-Norm(final)=2.350 | 4216.1 samples/s | 65.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05873 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.375 | L2-Norm(final)=2.350 | 4243.0 samples/s | 66.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05518 | Reg=0.00208 | acc=0.9375 | L2-Norm=14.420 | L2-Norm(final)=2.356 | 5825.0 samples/s | 91.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05013 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=2.361 | 1737.6 samples/s | 27.1 steps/s
[Step=5100 Epoch=24.8] | Loss=0.04767 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.513 | L2-Norm(final)=2.367 | 4255.2 samples/s | 66.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04539 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.555 | L2-Norm(final)=2.371 | 4251.1 samples/s | 66.4 steps/s
[Step=5200 Epoch=25.3] | Loss=0.04341 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=2.374 | 5525.9 samples/s | 86.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04031 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.624 | L2-Norm(final)=2.379 | 1774.7 samples/s | 27.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03848 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.655 | L2-Norm(final)=2.384 | 4198.0 samples/s | 65.6 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03704 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.684 | L2-Norm(final)=2.390 | 4345.0 samples/s | 67.9 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03623 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.711 | L2-Norm(final)=2.394 | 4927.0 samples/s | 77.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03471 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.737 | L2-Norm(final)=2.399 | 1848.3 samples/s | 28.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03399 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.763 | L2-Norm(final)=2.403 | 4240.4 samples/s | 66.3 steps/s
[Step=5550 Epoch=27.0] | Loss=0.03315 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.788 | L2-Norm(final)=2.406 | 4247.3 samples/s | 66.4 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03237 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=2.410 | 4606.5 samples/s | 72.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.34086 | Reg=0.00200 | acc=0.7188 | L2-Norm=14.125 | L2-Norm(final)=2.363 | 4022.4 samples/s | 62.9 steps/s
[Step=4850 Epoch=23.7] | Loss=0.09174 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.320 | L2-Norm(final)=2.332 | 3908.2 samples/s | 61.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07328 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.415 | L2-Norm(final)=2.337 | 4214.2 samples/s | 65.8 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06217 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.473 | L2-Norm(final)=2.343 | 4278.5 samples/s | 66.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05636 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=2.349 | 5699.4 samples/s | 89.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05053 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.561 | L2-Norm(final)=2.353 | 1761.2 samples/s | 27.5 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04708 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.594 | L2-Norm(final)=2.356 | 4299.9 samples/s | 67.2 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04421 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.623 | L2-Norm(final)=2.359 | 4431.2 samples/s | 69.2 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04169 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.652 | L2-Norm(final)=2.364 | 5425.3 samples/s | 84.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03896 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=2.370 | 1812.2 samples/s | 28.3 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03716 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.702 | L2-Norm(final)=2.374 | 4255.1 samples/s | 66.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03522 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=2.379 | 4320.6 samples/s | 67.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03440 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=2.382 | 4882.6 samples/s | 76.3 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03335 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=2.385 | 1846.3 samples/s | 28.8 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03207 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.784 | L2-Norm(final)=2.389 | 4265.1 samples/s | 66.6 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03093 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=2.392 | 4276.6 samples/s | 66.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03032 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.824 | L2-Norm(final)=2.395 | 4699.2 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.5] | Loss=0.38083 | Reg=0.00200 | acc=0.7500 | L2-Norm=14.125 | L2-Norm(final)=2.363 | 4218.0 samples/s | 65.9 steps/s
[Step=4850 Epoch=23.8] | Loss=0.08051 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.321 | L2-Norm(final)=2.343 | 3767.4 samples/s | 58.9 steps/s
[Step=4900 Epoch=24.0] | Loss=0.07033 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.403 | L2-Norm(final)=2.342 | 4264.6 samples/s | 66.6 steps/s
[Step=4950 Epoch=24.3] | Loss=0.06329 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.460 | L2-Norm(final)=2.340 | 4336.2 samples/s | 67.8 steps/s
[Step=5000 Epoch=24.5] | Loss=0.05810 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.506 | L2-Norm(final)=2.342 | 6007.6 samples/s | 93.9 steps/s
[Step=5050 Epoch=24.8] | Loss=0.05089 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=2.345 | 1723.3 samples/s | 26.9 steps/s
[Step=5100 Epoch=25.0] | Loss=0.04556 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.581 | L2-Norm(final)=2.350 | 4316.7 samples/s | 67.4 steps/s
[Step=5150 Epoch=25.3] | Loss=0.04282 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.611 | L2-Norm(final)=2.356 | 4253.2 samples/s | 66.5 steps/s
[Step=5200 Epoch=25.5] | Loss=0.04140 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.638 | L2-Norm(final)=2.359 | 5540.4 samples/s | 86.6 steps/s
[Step=5250 Epoch=25.7] | Loss=0.03894 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.664 | L2-Norm(final)=2.363 | 1761.6 samples/s | 27.5 steps/s
[Step=5300 Epoch=26.0] | Loss=0.03675 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.689 | L2-Norm(final)=2.367 | 4259.3 samples/s | 66.6 steps/s
[Step=5350 Epoch=26.2] | Loss=0.03522 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.711 | L2-Norm(final)=2.370 | 4273.1 samples/s | 66.8 steps/s
[Step=5400 Epoch=26.5] | Loss=0.03396 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.732 | L2-Norm(final)=2.373 | 5325.1 samples/s | 83.2 steps/s
[Step=5450 Epoch=26.7] | Loss=0.03259 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.754 | L2-Norm(final)=2.377 | 1787.0 samples/s | 27.9 steps/s
[Step=5500 Epoch=27.0] | Loss=0.03135 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.775 | L2-Norm(final)=2.380 | 4266.9 samples/s | 66.7 steps/s
[Step=5550 Epoch=27.2] | Loss=0.03071 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.795 | L2-Norm(final)=2.383 | 4236.3 samples/s | 66.2 steps/s
[Step=5600 Epoch=27.5] | Loss=0.03011 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.816 | L2-Norm(final)=2.386 | 5072.2 samples/s | 79.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.03774 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.125 | L2-Norm(final)=2.365 | 3761.4 samples/s | 58.8 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00877 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=2.348 | 3779.8 samples/s | 59.1 steps/s
[Step=4900 Epoch=46.4] | Loss=0.01002 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=2.338 | 5441.7 samples/s | 85.0 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00715 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=2.334 | 1679.6 samples/s | 26.2 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00563 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=2.332 | 5120.4 samples/s | 80.0 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00451 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=2.332 | 1733.7 samples/s | 27.1 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00376 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=2.333 | 4775.3 samples/s | 74.6 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00322 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=2.334 | 1787.4 samples/s | 27.9 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00282 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.333 | L2-Norm(final)=2.335 | 4385.0 samples/s | 68.5 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00251 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=2.336 | 1820.9 samples/s | 28.5 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00226 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=2.338 | 4150.9 samples/s | 64.9 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00205 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=2.340 | 1882.2 samples/s | 29.4 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00188 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.225 | L2-Norm(final)=2.342 | 4000.3 samples/s | 62.5 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00174 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=2.344 | 1901.3 samples/s | 29.7 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00162 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=2.346 | 4016.7 samples/s | 62.8 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00151 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=2.348 | 1909.8 samples/s | 29.8 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00141 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=2.350 | 4085.6 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step5600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.7] | Loss=0.00525 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=2.366 | 4013.3 samples/s | 62.7 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00767 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=2.368 | 3647.1 samples/s | 57.0 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00624 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.265 | L2-Norm(final)=2.367 | 5567.9 samples/s | 87.0 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00475 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=2.368 | 1658.7 samples/s | 25.9 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00384 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=2.372 | 5077.4 samples/s | 79.3 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00348 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=2.374 | 1731.8 samples/s | 27.1 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00310 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=2.377 | 4806.7 samples/s | 75.1 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00268 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=2.379 | 1781.9 samples/s | 27.8 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00235 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=2.382 | 4397.3 samples/s | 68.7 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00209 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=2.384 | 1822.3 samples/s | 28.5 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00188 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=2.386 | 4165.9 samples/s | 65.1 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00171 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=2.387 | 1880.2 samples/s | 29.4 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00157 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=2.389 | 4058.5 samples/s | 63.4 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00145 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=2.390 | 1897.6 samples/s | 29.7 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00134 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.225 | L2-Norm(final)=2.391 | 4136.8 samples/s | 64.6 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00125 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=2.392 | 1885.4 samples/s | 29.5 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00118 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=2.393 | 4110.2 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.03712 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.125 | L2-Norm(final)=2.364 | 3791.5 samples/s | 59.2 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00423 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=2.368 | 3755.8 samples/s | 58.7 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00502 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.262 | L2-Norm(final)=2.373 | 5630.0 samples/s | 88.0 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00347 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=2.365 | 1654.7 samples/s | 25.9 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00316 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=2.363 | 5161.7 samples/s | 80.7 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00324 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=2.358 | 1710.0 samples/s | 26.7 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00273 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=2.354 | 4876.8 samples/s | 76.2 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00257 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=2.351 | 1775.7 samples/s | 27.7 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00226 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=2.350 | 4635.5 samples/s | 72.4 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00201 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=2.349 | 1789.2 samples/s | 28.0 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00181 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=2.348 | 4355.3 samples/s | 68.1 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00164 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=2.348 | 1806.3 samples/s | 28.2 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00151 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.348 | 4216.7 samples/s | 65.9 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00139 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=2.347 | 1904.2 samples/s | 29.8 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00129 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.204 | L2-Norm(final)=2.347 | 4130.5 samples/s | 64.5 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00121 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.179 | L2-Norm(final)=2.347 | 1877.9 samples/s | 29.3 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00113 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.347 | 4134.9 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.2] | Loss=0.01153 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=2.366 | 3934.2 samples/s | 61.5 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00739 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=2.379 | 3556.4 samples/s | 55.6 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00754 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.361 | L2-Norm(final)=2.376 | 5550.9 samples/s | 86.7 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00680 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.447 | L2-Norm(final)=2.367 | 1679.2 samples/s | 26.2 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00573 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.505 | L2-Norm(final)=2.363 | 5024.5 samples/s | 78.5 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00498 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=2.359 | 1748.7 samples/s | 27.3 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00530 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.580 | L2-Norm(final)=2.355 | 4462.6 samples/s | 69.7 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00475 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.606 | L2-Norm(final)=2.348 | 1814.7 samples/s | 28.4 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00417 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=2.345 | 4320.6 samples/s | 67.5 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00371 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.624 | L2-Norm(final)=2.343 | 1830.0 samples/s | 28.6 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00334 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=2.341 | 4066.0 samples/s | 63.5 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00304 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=2.340 | 1886.4 samples/s | 29.5 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00278 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=2.340 | 4173.7 samples/s | 65.2 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00257 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=2.340 | 1910.2 samples/s | 29.8 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00239 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=2.340 | 3938.8 samples/s | 61.5 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00223 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=2.340 | 2005.2 samples/s | 31.3 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00209 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=2.340 | 3665.7 samples/s | 57.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.03220 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.125 | L2-Norm(final)=2.365 | 3788.4 samples/s | 59.2 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00755 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.269 | L2-Norm(final)=2.377 | 3861.2 samples/s | 60.3 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00978 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.418 | L2-Norm(final)=2.356 | 5662.2 samples/s | 88.5 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00676 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.502 | L2-Norm(final)=2.348 | 1638.2 samples/s | 25.6 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00509 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.533 | L2-Norm(final)=2.347 | 5141.7 samples/s | 80.3 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00408 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.538 | L2-Norm(final)=2.348 | 1719.5 samples/s | 26.9 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00340 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.530 | L2-Norm(final)=2.348 | 4886.5 samples/s | 76.4 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00292 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=2.349 | 1750.4 samples/s | 27.4 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00255 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.494 | L2-Norm(final)=2.350 | 4633.2 samples/s | 72.4 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00227 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=2.350 | 1795.2 samples/s | 28.0 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00204 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=2.351 | 4434.3 samples/s | 69.3 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00186 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=2.351 | 1864.6 samples/s | 29.1 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00170 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.393 | L2-Norm(final)=2.352 | 4163.2 samples/s | 65.0 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00157 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=2.353 | 1839.5 samples/s | 28.7 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00146 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=2.353 | 4104.6 samples/s | 64.1 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00136 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=2.354 | 1850.8 samples/s | 28.9 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00128 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=2.354 | 4032.6 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49140 | acc=0.6708 | tpr=0.5249 | fpr=0.0124 | 3771.1 samples/s | 14.7 steps/s
Avg test loss: 0.49397, Avg test acc: 0.66792, Avg tpr: 0.52363, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.17328 | acc=0.9184 | tpr=0.9602 | fpr=0.0823 | 3810.1 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.17556 | acc=0.9183 | tpr=0.9723 | fpr=0.0827 | 7095.7 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.17745 | acc=0.9185 | tpr=0.9683 | fpr=0.0825 | 7332.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.17844 | acc=0.9181 | tpr=0.9705 | fpr=0.0828 | 6969.7 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.17667 | acc=0.9186 | tpr=0.9703 | fpr=0.0823 | 7360.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.17798 | acc=0.9178 | tpr=0.9702 | fpr=0.0832 | 7128.7 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.17938 | acc=0.9172 | tpr=0.9687 | fpr=0.0837 | 7247.8 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.17987 | acc=0.9172 | tpr=0.9677 | fpr=0.0837 | 7025.5 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.18177 | acc=0.9170 | tpr=0.9693 | fpr=0.0840 | 7326.9 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.18149 | acc=0.9167 | tpr=0.9709 | fpr=0.0843 | 6796.5 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.18038 | acc=0.9173 | tpr=0.9702 | fpr=0.0837 | 13951.7 samples/s | 54.5 steps/s
Avg test loss: 0.18032, Avg test acc: 0.91725, Avg tpr: 0.96989, Avg fpr: 0.08370, total FA: 11622

server round 7/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.42088 | Reg=0.00194 | acc=0.7031 | L2-Norm=13.923 | L2-Norm(final)=2.390 | 3735.0 samples/s | 58.4 steps/s
[Step=5650 Epoch=27.6] | Loss=0.08275 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.118 | L2-Norm(final)=2.361 | 4204.4 samples/s | 65.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.07057 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=2.361 | 4127.5 samples/s | 64.5 steps/s
[Step=5750 Epoch=28.0] | Loss=0.06217 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.268 | L2-Norm(final)=2.363 | 4293.7 samples/s | 67.1 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05609 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.316 | L2-Norm(final)=2.368 | 5817.1 samples/s | 90.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04981 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=2.375 | 1738.1 samples/s | 27.2 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04548 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.394 | L2-Norm(final)=2.380 | 4304.5 samples/s | 67.3 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04312 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.425 | L2-Norm(final)=2.386 | 4340.6 samples/s | 67.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04097 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.453 | L2-Norm(final)=2.388 | 5339.1 samples/s | 83.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03876 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.480 | L2-Norm(final)=2.391 | 1797.4 samples/s | 28.1 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03646 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.505 | L2-Norm(final)=2.395 | 4302.6 samples/s | 67.2 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03503 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.528 | L2-Norm(final)=2.398 | 4248.0 samples/s | 66.4 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03386 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.551 | L2-Norm(final)=2.401 | 5082.3 samples/s | 79.4 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03239 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.574 | L2-Norm(final)=2.405 | 1823.5 samples/s | 28.5 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03113 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.596 | L2-Norm(final)=2.409 | 4243.2 samples/s | 66.3 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03013 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=2.412 | 4267.5 samples/s | 66.7 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02931 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.635 | L2-Norm(final)=2.415 | 4641.3 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.43837 | Reg=0.00194 | acc=0.7500 | L2-Norm=13.923 | L2-Norm(final)=2.390 | 3756.9 samples/s | 58.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.09301 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.141 | L2-Norm(final)=2.354 | 4295.4 samples/s | 67.1 steps/s
[Step=5700 Epoch=27.8] | Loss=0.07207 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.241 | L2-Norm(final)=2.359 | 4332.5 samples/s | 67.7 steps/s
[Step=5750 Epoch=28.1] | Loss=0.06278 | Reg=0.00205 | acc=0.9219 | L2-Norm=14.306 | L2-Norm(final)=2.364 | 4252.5 samples/s | 66.4 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05970 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.357 | L2-Norm(final)=2.369 | 5839.6 samples/s | 91.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.05341 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=2.372 | 1749.9 samples/s | 27.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04835 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.451 | L2-Norm(final)=2.378 | 4389.8 samples/s | 68.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04493 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.489 | L2-Norm(final)=2.383 | 4268.8 samples/s | 66.7 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04295 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.526 | L2-Norm(final)=2.387 | 5383.9 samples/s | 84.1 steps/s
[Step=6050 Epoch=29.5] | Loss=0.04070 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.559 | L2-Norm(final)=2.392 | 1814.6 samples/s | 28.4 steps/s
[Step=6100 Epoch=29.8] | Loss=0.03869 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.590 | L2-Norm(final)=2.396 | 4330.3 samples/s | 67.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03694 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.618 | L2-Norm(final)=2.400 | 4327.7 samples/s | 67.6 steps/s
[Step=6200 Epoch=30.3] | Loss=0.03539 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=2.404 | 5242.9 samples/s | 81.9 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03385 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.671 | L2-Norm(final)=2.409 | 1824.9 samples/s | 28.5 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03278 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=2.414 | 4326.7 samples/s | 67.6 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03157 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=2.418 | 4388.2 samples/s | 68.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03062 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=2.423 | 4807.1 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step6400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.23853 | Reg=0.00194 | acc=0.7969 | L2-Norm=13.923 | L2-Norm(final)=2.391 | 3896.4 samples/s | 60.9 steps/s
[Step=5650 Epoch=27.5] | Loss=0.07619 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.111 | L2-Norm(final)=2.365 | 4136.0 samples/s | 64.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.06375 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.199 | L2-Norm(final)=2.374 | 4330.0 samples/s | 67.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05803 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=2.376 | 4373.3 samples/s | 68.3 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05485 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.305 | L2-Norm(final)=2.379 | 5942.4 samples/s | 92.8 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04945 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.348 | L2-Norm(final)=2.381 | 1757.1 samples/s | 27.5 steps/s
[Step=5900 Epoch=28.7] | Loss=0.04590 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.385 | L2-Norm(final)=2.386 | 4250.3 samples/s | 66.4 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04329 | Reg=0.00208 | acc=0.9219 | L2-Norm=14.421 | L2-Norm(final)=2.392 | 4233.7 samples/s | 66.2 steps/s
[Step=6000 Epoch=29.2] | Loss=0.04184 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.456 | L2-Norm(final)=2.395 | 5282.7 samples/s | 82.5 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03965 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.491 | L2-Norm(final)=2.399 | 1802.1 samples/s | 28.2 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03788 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.525 | L2-Norm(final)=2.403 | 4285.7 samples/s | 67.0 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03681 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.556 | L2-Norm(final)=2.406 | 4350.5 samples/s | 68.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03609 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.585 | L2-Norm(final)=2.407 | 4921.2 samples/s | 76.9 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03465 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.613 | L2-Norm(final)=2.409 | 1841.1 samples/s | 28.8 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03349 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.641 | L2-Norm(final)=2.411 | 4277.8 samples/s | 66.8 steps/s
[Step=6350 Epoch=30.9] | Loss=0.03242 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=2.414 | 4197.0 samples/s | 65.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03132 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.692 | L2-Norm(final)=2.417 | 4688.3 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.34694 | Reg=0.00194 | acc=0.7656 | L2-Norm=13.923 | L2-Norm(final)=2.391 | 3656.8 samples/s | 57.1 steps/s
[Step=5650 Epoch=27.6] | Loss=0.07720 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.138 | L2-Norm(final)=2.359 | 4258.9 samples/s | 66.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.06653 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.223 | L2-Norm(final)=2.360 | 4322.9 samples/s | 67.5 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05766 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=2.362 | 4289.5 samples/s | 67.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05503 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.334 | L2-Norm(final)=2.362 | 5814.6 samples/s | 90.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04921 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.376 | L2-Norm(final)=2.363 | 1776.3 samples/s | 27.8 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04513 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.412 | L2-Norm(final)=2.367 | 4284.5 samples/s | 66.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04192 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=2.372 | 4338.8 samples/s | 67.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04036 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.475 | L2-Norm(final)=2.378 | 5388.8 samples/s | 84.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03795 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.504 | L2-Norm(final)=2.382 | 1781.3 samples/s | 27.8 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03626 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=2.386 | 4346.7 samples/s | 67.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03463 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=2.390 | 4207.8 samples/s | 65.7 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03329 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.578 | L2-Norm(final)=2.393 | 4993.3 samples/s | 78.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03202 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.600 | L2-Norm(final)=2.396 | 1843.6 samples/s | 28.8 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03066 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=2.399 | 4212.5 samples/s | 65.8 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02989 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.643 | L2-Norm(final)=2.403 | 4275.1 samples/s | 66.8 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02910 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.664 | L2-Norm(final)=2.406 | 4722.7 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step6400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.5] | Loss=0.38441 | Reg=0.00194 | acc=0.7188 | L2-Norm=13.923 | L2-Norm(final)=2.390 | 3837.1 samples/s | 60.0 steps/s
[Step=5650 Epoch=27.7] | Loss=0.08506 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.097 | L2-Norm(final)=2.355 | 4064.8 samples/s | 63.5 steps/s
[Step=5700 Epoch=28.0] | Loss=0.06348 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.187 | L2-Norm(final)=2.364 | 4181.2 samples/s | 65.3 steps/s
[Step=5750 Epoch=28.2] | Loss=0.05673 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=2.366 | 4255.9 samples/s | 66.5 steps/s
[Step=5800 Epoch=28.4] | Loss=0.05469 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.297 | L2-Norm(final)=2.364 | 5896.0 samples/s | 92.1 steps/s
[Step=5850 Epoch=28.7] | Loss=0.04894 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.344 | L2-Norm(final)=2.366 | 1731.7 samples/s | 27.1 steps/s
[Step=5900 Epoch=28.9] | Loss=0.04591 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.385 | L2-Norm(final)=2.369 | 4381.5 samples/s | 68.5 steps/s
[Step=5950 Epoch=29.2] | Loss=0.04331 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=2.372 | 4205.7 samples/s | 65.7 steps/s
[Step=6000 Epoch=29.4] | Loss=0.04127 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.457 | L2-Norm(final)=2.375 | 5525.8 samples/s | 86.3 steps/s
[Step=6050 Epoch=29.7] | Loss=0.03898 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=2.379 | 1757.2 samples/s | 27.5 steps/s
[Step=6100 Epoch=29.9] | Loss=0.03683 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=2.384 | 4296.6 samples/s | 67.1 steps/s
[Step=6150 Epoch=30.2] | Loss=0.03536 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.558 | L2-Norm(final)=2.389 | 4193.7 samples/s | 65.5 steps/s
[Step=6200 Epoch=30.4] | Loss=0.03410 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.588 | L2-Norm(final)=2.392 | 5363.0 samples/s | 83.8 steps/s
[Step=6250 Epoch=30.6] | Loss=0.03242 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=2.397 | 1798.2 samples/s | 28.1 steps/s
[Step=6300 Epoch=30.9] | Loss=0.03107 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.642 | L2-Norm(final)=2.401 | 4205.3 samples/s | 65.7 steps/s
[Step=6350 Epoch=31.1] | Loss=0.03018 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.665 | L2-Norm(final)=2.406 | 4249.0 samples/s | 66.4 steps/s
[Step=6400 Epoch=31.4] | Loss=0.02980 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.689 | L2-Norm(final)=2.408 | 4999.6 samples/s | 78.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.01150 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=2.393 | 3681.3 samples/s | 57.5 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00871 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=2.390 | 3878.4 samples/s | 60.6 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00557 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=2.395 | 5574.8 samples/s | 87.1 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00385 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.218 | L2-Norm(final)=2.398 | 1662.0 samples/s | 26.0 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00293 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=2.402 | 5062.8 samples/s | 79.1 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00235 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=2.406 | 1748.8 samples/s | 27.3 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00196 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.409 | 4732.9 samples/s | 74.0 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00168 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=2.412 | 1781.2 samples/s | 27.8 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00147 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=2.414 | 4479.4 samples/s | 70.0 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00131 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.415 | 1818.6 samples/s | 28.4 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00118 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=2.417 | 4135.5 samples/s | 64.6 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00107 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=2.418 | 1877.5 samples/s | 29.3 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00098 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.013 | L2-Norm(final)=2.419 | 4067.7 samples/s | 63.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00091 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.420 | 1881.2 samples/s | 29.4 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00084 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=2.421 | 4016.0 samples/s | 62.8 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00079 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=2.421 | 1886.8 samples/s | 29.5 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00074 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=2.422 | 3962.5 samples/s | 61.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.3] | Loss=0.04131 | Reg=0.00194 | acc=0.9375 | L2-Norm=13.923 | L2-Norm(final)=2.392 | 3780.3 samples/s | 59.1 steps/s
[Step=5650 Epoch=53.7] | Loss=0.01003 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.385 | 3711.1 samples/s | 58.0 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00556 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=2.398 | 5651.0 samples/s | 88.3 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00559 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.147 | L2-Norm(final)=2.397 | 1667.7 samples/s | 26.1 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00562 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.190 | L2-Norm(final)=2.391 | 5000.2 samples/s | 78.1 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00460 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.239 | L2-Norm(final)=2.386 | 1707.1 samples/s | 26.7 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00388 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=2.383 | 4787.0 samples/s | 74.8 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00333 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=2.382 | 1754.0 samples/s | 27.4 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00292 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=2.382 | 4368.1 samples/s | 68.3 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00262 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=2.382 | 1816.2 samples/s | 28.4 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00237 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.260 | L2-Norm(final)=2.382 | 4042.6 samples/s | 63.2 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00216 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=2.382 | 1868.9 samples/s | 29.2 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00198 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=2.383 | 3883.4 samples/s | 60.7 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00182 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.383 | 1871.4 samples/s | 29.2 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00169 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.383 | 4037.9 samples/s | 63.1 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00158 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=2.384 | 1844.9 samples/s | 28.8 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00148 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.150 | L2-Norm(final)=2.384 | 4081.2 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.5] | Loss=0.01873 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=2.393 | 3662.0 samples/s | 57.2 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00457 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=2.418 | 3523.1 samples/s | 55.0 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00422 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.126 | L2-Norm(final)=2.419 | 5499.9 samples/s | 85.9 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00365 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=2.419 | 1649.7 samples/s | 25.8 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00348 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.197 | L2-Norm(final)=2.414 | 4931.5 samples/s | 77.1 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00282 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=2.410 | 1683.2 samples/s | 26.3 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00235 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=2.408 | 4768.6 samples/s | 74.5 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00202 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=2.407 | 1681.1 samples/s | 26.3 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00177 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=2.407 | 4378.4 samples/s | 68.4 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00157 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.164 | L2-Norm(final)=2.406 | 1729.8 samples/s | 27.0 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00141 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=2.406 | 4401.7 samples/s | 68.8 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00129 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=2.406 | 1705.8 samples/s | 26.7 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00118 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.406 | 3963.9 samples/s | 61.9 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00109 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=2.406 | 1775.0 samples/s | 27.7 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00101 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=2.406 | 3793.3 samples/s | 59.3 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00094 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=2.407 | 1866.6 samples/s | 29.2 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00089 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=2.407 | 4086.2 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=52.8] | Loss=0.03089 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.923 | L2-Norm(final)=2.392 | 3834.2 samples/s | 59.9 steps/s
[Step=5650 Epoch=53.2] | Loss=0.01184 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.383 | 3672.9 samples/s | 57.4 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00850 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=2.380 | 5241.3 samples/s | 81.9 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00575 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=2.384 | 1640.5 samples/s | 25.6 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00434 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=2.389 | 5004.9 samples/s | 78.2 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00347 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=2.392 | 1759.6 samples/s | 27.5 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00290 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=2.395 | 4516.7 samples/s | 70.6 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00249 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=2.397 | 1830.7 samples/s | 28.6 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00218 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=2.399 | 4263.0 samples/s | 66.6 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00194 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.111 | L2-Norm(final)=2.401 | 1861.7 samples/s | 29.1 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00174 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=2.402 | 4049.9 samples/s | 63.3 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00158 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.050 | L2-Norm(final)=2.403 | 1855.8 samples/s | 29.0 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00145 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=2.404 | 4079.4 samples/s | 63.7 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00134 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=2.405 | 1907.1 samples/s | 29.8 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00125 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.957 | L2-Norm(final)=2.406 | 4063.0 samples/s | 63.5 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00116 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=2.407 | 1997.5 samples/s | 31.2 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00109 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=2.408 | 3777.6 samples/s | 59.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step6400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.4] | Loss=0.00778 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=2.393 | 3750.5 samples/s | 58.6 steps/s
[Step=5650 Epoch=53.8] | Loss=0.01175 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=2.380 | 3769.6 samples/s | 58.9 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00691 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.375 | 5650.2 samples/s | 88.3 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00462 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.171 | L2-Norm(final)=2.380 | 1638.0 samples/s | 25.6 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00347 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=2.383 | 5303.8 samples/s | 82.9 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00278 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=2.385 | 1734.7 samples/s | 27.1 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00232 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=2.387 | 4890.3 samples/s | 76.4 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00199 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.388 | 1738.3 samples/s | 27.2 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00174 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.390 | 4683.7 samples/s | 73.2 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00155 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=2.391 | 1791.3 samples/s | 28.0 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00139 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=2.392 | 4313.1 samples/s | 67.4 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00127 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=2.393 | 1838.0 samples/s | 28.7 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00116 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.932 | L2-Norm(final)=2.394 | 4133.6 samples/s | 64.6 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00107 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=2.395 | 1856.6 samples/s | 29.0 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00100 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=2.395 | 4033.5 samples/s | 63.0 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00093 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=2.396 | 1885.3 samples/s | 29.5 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00087 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.804 | L2-Norm(final)=2.397 | 4048.0 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40021 | acc=0.7403 | tpr=0.6288 | fpr=0.0176 | 3776.8 samples/s | 14.8 steps/s
Avg test loss: 0.39882, Avg test acc: 0.73756, Avg tpr: 0.62645, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.23407 | acc=0.8937 | tpr=0.9735 | fpr=0.1078 | 3774.4 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.23663 | acc=0.8939 | tpr=0.9808 | fpr=0.1078 | 7116.9 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.24000 | acc=0.8928 | tpr=0.9798 | fpr=0.1088 | 7284.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.24117 | acc=0.8932 | tpr=0.9814 | fpr=0.1084 | 7155.6 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.23930 | acc=0.8937 | tpr=0.9808 | fpr=0.1079 | 7273.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.24109 | acc=0.8927 | tpr=0.9804 | fpr=0.1089 | 7176.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.24297 | acc=0.8921 | tpr=0.9787 | fpr=0.1095 | 7081.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.24358 | acc=0.8919 | tpr=0.9781 | fpr=0.1096 | 7160.1 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.24613 | acc=0.8917 | tpr=0.9791 | fpr=0.1099 | 7087.5 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.24581 | acc=0.8916 | tpr=0.9802 | fpr=0.1100 | 7014.5 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.24447 | acc=0.8922 | tpr=0.9801 | fpr=0.1094 | 13242.8 samples/s | 51.7 steps/s
Avg test loss: 0.24436, Avg test acc: 0.89216, Avg tpr: 0.97979, Avg fpr: 0.10943, total FA: 15194

server round 8/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.18404 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.712 | L2-Norm(final)=2.431 | 3794.7 samples/s | 59.3 steps/s
[Step=6450 Epoch=31.5] | Loss=0.08247 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.860 | L2-Norm(final)=2.395 | 4065.8 samples/s | 63.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.06645 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.945 | L2-Norm(final)=2.396 | 4351.4 samples/s | 68.0 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05768 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.010 | L2-Norm(final)=2.396 | 4247.3 samples/s | 66.4 steps/s
[Step=6600 Epoch=32.2] | Loss=0.05288 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=2.396 | 5687.4 samples/s | 88.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04792 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.106 | L2-Norm(final)=2.399 | 1757.7 samples/s | 27.5 steps/s
[Step=6700 Epoch=32.7] | Loss=0.04475 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.150 | L2-Norm(final)=2.406 | 4245.6 samples/s | 66.3 steps/s
[Step=6750 Epoch=32.9] | Loss=0.04208 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.191 | L2-Norm(final)=2.410 | 4327.9 samples/s | 67.6 steps/s
[Step=6800 Epoch=33.2] | Loss=0.04054 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.229 | L2-Norm(final)=2.413 | 5281.8 samples/s | 82.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03838 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=2.415 | 1805.7 samples/s | 28.2 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03649 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.295 | L2-Norm(final)=2.418 | 4244.7 samples/s | 66.3 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03502 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=2.421 | 4204.1 samples/s | 65.7 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03358 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.352 | L2-Norm(final)=2.423 | 4988.5 samples/s | 77.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.03257 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.380 | L2-Norm(final)=2.425 | 1813.4 samples/s | 28.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.03116 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=2.428 | 4235.7 samples/s | 66.2 steps/s
[Step=7150 Epoch=34.9] | Loss=0.03073 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.432 | L2-Norm(final)=2.431 | 4290.0 samples/s | 67.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02987 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.457 | L2-Norm(final)=2.433 | 4555.0 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.37936 | Reg=0.00188 | acc=0.7656 | L2-Norm=13.712 | L2-Norm(final)=2.429 | 3863.4 samples/s | 60.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06709 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.878 | L2-Norm(final)=2.407 | 4086.1 samples/s | 63.8 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05720 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.960 | L2-Norm(final)=2.410 | 4354.4 samples/s | 68.0 steps/s
[Step=6550 Epoch=32.0] | Loss=0.05179 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.018 | L2-Norm(final)=2.409 | 4232.9 samples/s | 66.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04873 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.066 | L2-Norm(final)=2.411 | 5824.4 samples/s | 91.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04483 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=2.412 | 1732.2 samples/s | 27.1 steps/s
[Step=6700 Epoch=32.7] | Loss=0.04098 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.148 | L2-Norm(final)=2.416 | 4275.7 samples/s | 66.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03896 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.184 | L2-Norm(final)=2.420 | 4175.0 samples/s | 65.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03728 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.218 | L2-Norm(final)=2.422 | 5369.4 samples/s | 83.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03494 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.425 | 1798.4 samples/s | 28.1 steps/s
[Step=6900 Epoch=33.7] | Loss=0.03325 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=2.429 | 4209.0 samples/s | 65.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03227 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.307 | L2-Norm(final)=2.432 | 4353.6 samples/s | 68.0 steps/s
[Step=7000 Epoch=34.2] | Loss=0.03117 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.333 | L2-Norm(final)=2.434 | 5236.5 samples/s | 81.8 steps/s
[Step=7050 Epoch=34.4] | Loss=0.03011 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.359 | L2-Norm(final)=2.436 | 1800.5 samples/s | 28.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02888 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.383 | L2-Norm(final)=2.438 | 4196.7 samples/s | 65.6 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02801 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.406 | L2-Norm(final)=2.441 | 4245.6 samples/s | 66.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02710 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=2.444 | 4819.8 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.35360 | Reg=0.00188 | acc=0.7969 | L2-Norm=13.712 | L2-Norm(final)=2.430 | 3991.6 samples/s | 62.4 steps/s
[Step=6450 Epoch=31.4] | Loss=0.07547 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.863 | L2-Norm(final)=2.400 | 4036.4 samples/s | 63.1 steps/s
[Step=6500 Epoch=31.7] | Loss=0.06173 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.951 | L2-Norm(final)=2.407 | 4257.0 samples/s | 66.5 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05551 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=2.412 | 4332.6 samples/s | 67.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.05346 | Reg=0.00198 | acc=0.9375 | L2-Norm=14.078 | L2-Norm(final)=2.416 | 5830.3 samples/s | 91.1 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04889 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=2.421 | 1727.4 samples/s | 27.0 steps/s
[Step=6700 Epoch=32.6] | Loss=0.04424 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.185 | L2-Norm(final)=2.427 | 4211.7 samples/s | 65.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.04170 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=2.434 | 4146.4 samples/s | 64.8 steps/s
[Step=6800 Epoch=33.1] | Loss=0.04016 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.265 | L2-Norm(final)=2.438 | 5372.3 samples/s | 83.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03953 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.301 | L2-Norm(final)=2.440 | 1779.5 samples/s | 27.8 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03738 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.337 | L2-Norm(final)=2.444 | 4259.2 samples/s | 66.6 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03577 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.371 | L2-Norm(final)=2.447 | 4283.2 samples/s | 66.9 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03496 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.402 | L2-Norm(final)=2.449 | 4936.0 samples/s | 77.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.03359 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=2.451 | 1827.1 samples/s | 28.5 steps/s
[Step=7100 Epoch=34.6] | Loss=0.03224 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=2.454 | 4343.8 samples/s | 67.9 steps/s
[Step=7150 Epoch=34.8] | Loss=0.03151 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.487 | L2-Norm(final)=2.456 | 4246.8 samples/s | 66.4 steps/s
[Step=7200 Epoch=35.1] | Loss=0.03055 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.512 | L2-Norm(final)=2.458 | 4556.5 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.40506 | Reg=0.00188 | acc=0.7500 | L2-Norm=13.712 | L2-Norm(final)=2.429 | 4042.9 samples/s | 63.2 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06305 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.869 | L2-Norm(final)=2.407 | 3833.6 samples/s | 59.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05518 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.952 | L2-Norm(final)=2.411 | 4240.9 samples/s | 66.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04929 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.018 | L2-Norm(final)=2.416 | 4295.0 samples/s | 67.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04552 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.072 | L2-Norm(final)=2.415 | 5796.0 samples/s | 90.6 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04047 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=2.419 | 1709.5 samples/s | 26.7 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03754 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=2.422 | 4027.3 samples/s | 62.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03553 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=2.427 | 4155.4 samples/s | 64.9 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03411 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.230 | L2-Norm(final)=2.432 | 5336.2 samples/s | 83.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03212 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.266 | L2-Norm(final)=2.437 | 1815.6 samples/s | 28.4 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03056 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.299 | L2-Norm(final)=2.443 | 4372.6 samples/s | 68.3 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02975 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.331 | L2-Norm(final)=2.447 | 4349.3 samples/s | 68.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02882 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=2.449 | 5180.7 samples/s | 80.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02801 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=2.452 | 1863.9 samples/s | 29.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02732 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.417 | L2-Norm(final)=2.454 | 4240.6 samples/s | 66.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02670 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=2.456 | 4301.9 samples/s | 67.2 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02619 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.468 | L2-Norm(final)=2.458 | 4600.7 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.4] | Loss=0.39755 | Reg=0.00188 | acc=0.7031 | L2-Norm=13.712 | L2-Norm(final)=2.429 | 3882.5 samples/s | 60.7 steps/s
[Step=6450 Epoch=31.6] | Loss=0.07526 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.935 | L2-Norm(final)=2.401 | 4028.6 samples/s | 62.9 steps/s
[Step=6500 Epoch=31.9] | Loss=0.05962 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=2.399 | 4277.9 samples/s | 66.8 steps/s
[Step=6550 Epoch=32.1] | Loss=0.05324 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.090 | L2-Norm(final)=2.397 | 4271.4 samples/s | 66.7 steps/s
[Step=6600 Epoch=32.4] | Loss=0.04919 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.134 | L2-Norm(final)=2.396 | 5959.0 samples/s | 93.1 steps/s
[Step=6650 Epoch=32.6] | Loss=0.04432 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.174 | L2-Norm(final)=2.398 | 1755.7 samples/s | 27.4 steps/s
[Step=6700 Epoch=32.9] | Loss=0.04104 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=2.401 | 4426.3 samples/s | 69.2 steps/s
[Step=6750 Epoch=33.1] | Loss=0.03799 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=2.405 | 4257.0 samples/s | 66.5 steps/s
[Step=6800 Epoch=33.3] | Loss=0.03714 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.274 | L2-Norm(final)=2.407 | 5540.2 samples/s | 86.6 steps/s
[Step=6850 Epoch=33.6] | Loss=0.03493 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=2.409 | 1784.8 samples/s | 27.9 steps/s
[Step=6900 Epoch=33.8] | Loss=0.03323 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.340 | L2-Norm(final)=2.414 | 4371.1 samples/s | 68.3 steps/s
[Step=6950 Epoch=34.1] | Loss=0.03193 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.370 | L2-Norm(final)=2.417 | 4240.9 samples/s | 66.3 steps/s
[Step=7000 Epoch=34.3] | Loss=0.03116 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.398 | L2-Norm(final)=2.419 | 5120.3 samples/s | 80.0 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02962 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=2.421 | 1760.8 samples/s | 27.5 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02888 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.450 | L2-Norm(final)=2.423 | 4188.5 samples/s | 65.4 steps/s
[Step=7150 Epoch=35.1] | Loss=0.02769 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=2.425 | 4210.7 samples/s | 65.8 steps/s
[Step=7200 Epoch=35.3] | Loss=0.02685 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=2.427 | 5068.2 samples/s | 79.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.7] | Loss=0.08540 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.712 | L2-Norm(final)=2.430 | 3763.1 samples/s | 58.8 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00813 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=2.428 | 3837.3 samples/s | 60.0 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00854 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=2.409 | 5588.2 samples/s | 87.3 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00685 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=2.400 | 1692.3 samples/s | 26.4 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00520 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=2.394 | 5105.3 samples/s | 79.8 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00417 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=2.392 | 1742.5 samples/s | 27.2 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00353 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.391 | 4758.2 samples/s | 74.3 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00316 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=2.390 | 1854.2 samples/s | 29.0 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00278 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=2.390 | 4525.8 samples/s | 70.7 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00247 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.391 | 1914.0 samples/s | 29.9 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00222 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.391 | 4399.2 samples/s | 68.7 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00202 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=2.391 | 1910.6 samples/s | 29.9 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00185 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=2.392 | 4373.9 samples/s | 68.3 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00171 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=2.392 | 1964.2 samples/s | 30.7 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00159 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=2.392 | 4411.6 samples/s | 68.9 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00148 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.392 | 1962.5 samples/s | 30.7 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00139 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=2.393 | 4287.6 samples/s | 67.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.9] | Loss=0.02754 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.712 | L2-Norm(final)=2.432 | 3877.3 samples/s | 60.6 steps/s
[Step=6450 Epoch=61.4] | Loss=0.01146 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=2.421 | 3635.1 samples/s | 56.8 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00589 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.002 | L2-Norm(final)=2.429 | 5853.5 samples/s | 91.5 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00394 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=2.436 | 1759.2 samples/s | 27.5 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00296 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=2.440 | 5431.9 samples/s | 84.9 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00237 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=2.443 | 1816.1 samples/s | 28.4 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00197 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=2.445 | 5003.4 samples/s | 78.2 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00169 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=2.447 | 1867.1 samples/s | 29.2 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00148 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=2.449 | 4696.5 samples/s | 73.4 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00132 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=2.450 | 1900.2 samples/s | 29.7 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00119 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=2.452 | 4437.5 samples/s | 69.3 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00108 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.802 | L2-Norm(final)=2.453 | 1945.1 samples/s | 30.4 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00099 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.454 | 4375.9 samples/s | 68.4 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00092 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.455 | 1973.2 samples/s | 30.8 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00085 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=2.456 | 4382.6 samples/s | 68.5 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00079 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.457 | 1987.0 samples/s | 31.0 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00074 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.458 | 4339.6 samples/s | 67.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.1] | Loss=0.00758 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.433 | 4237.5 samples/s | 66.2 steps/s
[Step=6450 Epoch=61.6] | Loss=0.00816 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.994 | L2-Norm(final)=2.425 | 3725.5 samples/s | 58.2 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00425 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=2.437 | 5878.6 samples/s | 91.9 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00613 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=2.425 | 1752.0 samples/s | 27.4 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00489 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=2.409 | 5470.3 samples/s | 85.5 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00428 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=2.399 | 1781.8 samples/s | 27.8 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00362 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=2.394 | 5190.7 samples/s | 81.1 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00313 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=2.391 | 1819.4 samples/s | 28.4 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00274 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=2.390 | 4889.7 samples/s | 76.4 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00243 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.389 | 1867.7 samples/s | 29.2 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00219 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.233 | L2-Norm(final)=2.388 | 4636.0 samples/s | 72.4 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00199 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=2.387 | 1904.6 samples/s | 29.8 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00182 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.387 | 4500.7 samples/s | 70.3 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00168 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=2.386 | 1951.3 samples/s | 30.5 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00156 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.386 | 4306.9 samples/s | 67.3 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00146 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.386 | 1971.9 samples/s | 30.8 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00137 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=2.386 | 4216.2 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.3] | Loss=0.01219 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.712 | L2-Norm(final)=2.433 | 4212.5 samples/s | 65.8 steps/s
[Step=6450 Epoch=60.8] | Loss=0.01139 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=2.440 | 3826.1 samples/s | 59.8 steps/s
[Step=6500 Epoch=61.2] | Loss=0.00870 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.426 | 5865.8 samples/s | 91.7 steps/s
[Step=6550 Epoch=61.7] | Loss=0.00628 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.420 | 1765.3 samples/s | 27.6 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00474 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=2.420 | 5215.5 samples/s | 81.5 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00380 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=2.422 | 1842.4 samples/s | 28.8 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00317 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=2.423 | 4824.0 samples/s | 75.4 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00272 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=2.425 | 1883.5 samples/s | 29.4 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00238 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.426 | 4513.9 samples/s | 70.5 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00212 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.427 | 1934.3 samples/s | 30.2 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00190 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=2.428 | 4352.4 samples/s | 68.0 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00173 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=2.429 | 1963.5 samples/s | 30.7 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00159 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=2.430 | 4537.0 samples/s | 70.9 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00147 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=2.430 | 1976.3 samples/s | 30.9 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00136 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=2.431 | 4272.7 samples/s | 66.8 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00127 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=2.432 | 2128.1 samples/s | 33.3 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00119 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=2.433 | 3730.4 samples/s | 58.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.0] | Loss=0.04890 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.712 | L2-Norm(final)=2.432 | 3628.9 samples/s | 56.7 steps/s
[Step=6450 Epoch=61.5] | Loss=0.00941 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.990 | L2-Norm(final)=2.429 | 3876.4 samples/s | 60.6 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00805 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=2.401 | 5563.1 samples/s | 86.9 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00567 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=2.381 | 1737.1 samples/s | 27.1 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00538 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=2.371 | 5403.9 samples/s | 84.4 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00437 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=2.364 | 1793.6 samples/s | 28.0 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00443 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.220 | L2-Norm(final)=2.359 | 5130.3 samples/s | 80.2 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00383 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=2.355 | 1819.7 samples/s | 28.4 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00335 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=2.354 | 4932.2 samples/s | 77.1 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00298 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=2.353 | 1873.2 samples/s | 29.3 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00268 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=2.353 | 4549.3 samples/s | 71.1 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00244 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=2.353 | 1841.7 samples/s | 28.8 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00224 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.208 | L2-Norm(final)=2.353 | 4087.7 samples/s | 63.9 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00207 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=2.353 | 1971.9 samples/s | 30.8 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00192 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.171 | L2-Norm(final)=2.353 | 4176.4 samples/s | 65.3 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00179 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=2.354 | 1970.6 samples/s | 30.8 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00168 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=2.354 | 4265.2 samples/s | 66.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57438 | acc=0.6504 | tpr=0.4936 | fpr=0.0092 | 4044.0 samples/s | 15.8 steps/s
Avg test loss: 0.57341, Avg test acc: 0.64861, Avg tpr: 0.49368, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.19132 | acc=0.9230 | tpr=0.9735 | fpr=0.0779 | 3996.1 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.19362 | acc=0.9229 | tpr=0.9744 | fpr=0.0780 | 7427.5 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.19764 | acc=0.9216 | tpr=0.9755 | fpr=0.0794 | 7100.6 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.19873 | acc=0.9213 | tpr=0.9770 | fpr=0.0797 | 4539.0 samples/s | 17.7 steps/s
[Step= 250] | Loss=0.19659 | acc=0.9213 | tpr=0.9764 | fpr=0.0797 | 7263.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.19819 | acc=0.9206 | tpr=0.9760 | fpr=0.0804 | 7455.4 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.19952 | acc=0.9203 | tpr=0.9750 | fpr=0.0807 | 7086.5 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.20027 | acc=0.9203 | tpr=0.9737 | fpr=0.0807 | 6830.0 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.20263 | acc=0.9199 | tpr=0.9747 | fpr=0.0811 | 7160.8 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.20253 | acc=0.9196 | tpr=0.9758 | fpr=0.0814 | 7250.2 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.20128 | acc=0.9201 | tpr=0.9757 | fpr=0.0809 | 13701.2 samples/s | 53.5 steps/s
Avg test loss: 0.20116, Avg test acc: 0.92011, Avg tpr: 0.97504, Avg fpr: 0.08089, total FA: 11231

server round 9/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.37339 | Reg=0.00184 | acc=0.7812 | L2-Norm=13.576 | L2-Norm(final)=2.435 | 3719.9 samples/s | 58.1 steps/s
[Step=7250 Epoch=35.4] | Loss=0.07071 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.776 | L2-Norm(final)=2.416 | 4147.2 samples/s | 64.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05997 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.875 | L2-Norm(final)=2.415 | 4134.2 samples/s | 64.6 steps/s
[Step=7350 Epoch=35.8] | Loss=0.05229 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=2.419 | 4131.7 samples/s | 64.6 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04842 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.985 | L2-Norm(final)=2.420 | 5601.8 samples/s | 87.5 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04509 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.032 | L2-Norm(final)=2.423 | 1720.5 samples/s | 26.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04163 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.074 | L2-Norm(final)=2.425 | 4082.5 samples/s | 63.8 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03987 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=2.428 | 4112.5 samples/s | 64.3 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03796 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=2.432 | 5443.3 samples/s | 85.1 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03652 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.433 | 1807.9 samples/s | 28.2 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03498 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=2.435 | 4224.2 samples/s | 66.0 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03335 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.258 | L2-Norm(final)=2.438 | 4296.7 samples/s | 67.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03205 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=2.440 | 5029.3 samples/s | 78.6 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03060 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=2.443 | 1854.5 samples/s | 29.0 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02950 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.349 | L2-Norm(final)=2.446 | 4305.1 samples/s | 67.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02847 | Reg=0.00207 | acc=0.9375 | L2-Norm=14.376 | L2-Norm(final)=2.448 | 4299.9 samples/s | 67.2 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02804 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=2.450 | 4782.7 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.41851 | Reg=0.00184 | acc=0.6875 | L2-Norm=13.576 | L2-Norm(final)=2.435 | 3976.0 samples/s | 62.1 steps/s
[Step=7250 Epoch=35.4] | Loss=0.08157 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.808 | L2-Norm(final)=2.399 | 4195.2 samples/s | 65.5 steps/s
[Step=7300 Epoch=35.6] | Loss=0.06301 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=2.407 | 4439.3 samples/s | 69.4 steps/s
[Step=7350 Epoch=35.9] | Loss=0.05556 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.972 | L2-Norm(final)=2.409 | 4274.3 samples/s | 66.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.05085 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.025 | L2-Norm(final)=2.411 | 5908.6 samples/s | 92.3 steps/s
[Step=7450 Epoch=36.4] | Loss=0.04613 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.072 | L2-Norm(final)=2.411 | 1785.4 samples/s | 27.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04180 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=2.415 | 4485.0 samples/s | 70.1 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03956 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.153 | L2-Norm(final)=2.418 | 4250.4 samples/s | 66.4 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03787 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=2.419 | 5544.1 samples/s | 86.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03597 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.221 | L2-Norm(final)=2.421 | 1790.9 samples/s | 28.0 steps/s
[Step=7700 Epoch=37.6] | Loss=0.03370 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.251 | L2-Norm(final)=2.425 | 4395.7 samples/s | 68.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03194 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=2.429 | 4413.0 samples/s | 69.0 steps/s
[Step=7800 Epoch=38.1] | Loss=0.03083 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.303 | L2-Norm(final)=2.433 | 5279.9 samples/s | 82.5 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02957 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=2.436 | 1846.2 samples/s | 28.8 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02836 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=2.440 | 4357.4 samples/s | 68.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02741 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.370 | L2-Norm(final)=2.444 | 4332.2 samples/s | 67.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02681 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.391 | L2-Norm(final)=2.447 | 4968.1 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.45506 | Reg=0.00184 | acc=0.7188 | L2-Norm=13.576 | L2-Norm(final)=2.433 | 3664.1 samples/s | 57.3 steps/s
[Step=7250 Epoch=35.3] | Loss=0.07383 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=2.411 | 4340.6 samples/s | 67.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05945 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.881 | L2-Norm(final)=2.418 | 4405.3 samples/s | 68.8 steps/s
[Step=7350 Epoch=35.8] | Loss=0.05289 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.944 | L2-Norm(final)=2.421 | 4431.4 samples/s | 69.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.05089 | Reg=0.00196 | acc=0.9531 | L2-Norm=13.995 | L2-Norm(final)=2.419 | 5950.1 samples/s | 93.0 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04574 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=2.421 | 1745.7 samples/s | 27.3 steps/s
[Step=7500 Epoch=36.5] | Loss=0.04225 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.085 | L2-Norm(final)=2.426 | 4329.4 samples/s | 67.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03992 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=2.429 | 4473.6 samples/s | 69.9 steps/s
[Step=7600 Epoch=37.0] | Loss=0.03881 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.157 | L2-Norm(final)=2.431 | 5486.1 samples/s | 85.7 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03631 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.191 | L2-Norm(final)=2.434 | 1826.0 samples/s | 28.5 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03469 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.221 | L2-Norm(final)=2.438 | 4416.1 samples/s | 69.0 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03321 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.441 | 4363.0 samples/s | 68.2 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03205 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=2.445 | 5151.4 samples/s | 80.5 steps/s
[Step=7850 Epoch=38.2] | Loss=0.03134 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.303 | L2-Norm(final)=2.447 | 1908.1 samples/s | 29.8 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03046 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=2.450 | 4414.0 samples/s | 69.0 steps/s
[Step=7950 Epoch=38.7] | Loss=0.03004 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.357 | L2-Norm(final)=2.452 | 4434.7 samples/s | 69.3 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02918 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.384 | L2-Norm(final)=2.454 | 4560.5 samples/s | 71.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.47514 | Reg=0.00184 | acc=0.7031 | L2-Norm=13.576 | L2-Norm(final)=2.435 | 3764.7 samples/s | 58.8 steps/s
[Step=7250 Epoch=35.4] | Loss=0.07130 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.799 | L2-Norm(final)=2.411 | 4214.2 samples/s | 65.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05732 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.884 | L2-Norm(final)=2.416 | 4458.8 samples/s | 69.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04972 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.414 | 4594.4 samples/s | 71.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04697 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=2.412 | 5975.5 samples/s | 93.4 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04139 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.017 | L2-Norm(final)=2.416 | 1764.4 samples/s | 27.6 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03805 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=2.421 | 4351.7 samples/s | 68.0 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03559 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.087 | L2-Norm(final)=2.426 | 4360.5 samples/s | 68.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03420 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=2.430 | 5488.0 samples/s | 85.7 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03213 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.432 | 1836.9 samples/s | 28.7 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03051 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=2.436 | 4244.9 samples/s | 66.3 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02958 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.196 | L2-Norm(final)=2.439 | 4311.6 samples/s | 67.4 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02815 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.442 | 4982.8 samples/s | 77.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02709 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=2.446 | 1836.7 samples/s | 28.7 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02588 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=2.450 | 4327.9 samples/s | 67.6 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02505 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.289 | L2-Norm(final)=2.455 | 4358.7 samples/s | 68.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02440 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.310 | L2-Norm(final)=2.458 | 4874.0 samples/s | 76.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.3] | Loss=0.45221 | Reg=0.00184 | acc=0.6875 | L2-Norm=13.576 | L2-Norm(final)=2.434 | 4057.7 samples/s | 63.4 steps/s
[Step=7250 Epoch=35.6] | Loss=0.07864 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.766 | L2-Norm(final)=2.398 | 4184.8 samples/s | 65.4 steps/s
[Step=7300 Epoch=35.8] | Loss=0.06218 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.879 | L2-Norm(final)=2.401 | 4405.3 samples/s | 68.8 steps/s
[Step=7350 Epoch=36.0] | Loss=0.05459 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.954 | L2-Norm(final)=2.407 | 4456.4 samples/s | 69.6 steps/s
[Step=7400 Epoch=36.3] | Loss=0.04952 | Reg=0.00196 | acc=0.9375 | L2-Norm=14.016 | L2-Norm(final)=2.411 | 6025.2 samples/s | 94.1 steps/s
[Step=7450 Epoch=36.5] | Loss=0.04403 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.069 | L2-Norm(final)=2.416 | 1732.2 samples/s | 27.1 steps/s
[Step=7500 Epoch=36.8] | Loss=0.04024 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.114 | L2-Norm(final)=2.422 | 4410.4 samples/s | 68.9 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03736 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.152 | L2-Norm(final)=2.428 | 4341.4 samples/s | 67.8 steps/s
[Step=7600 Epoch=37.3] | Loss=0.03566 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.186 | L2-Norm(final)=2.431 | 5723.0 samples/s | 89.4 steps/s
[Step=7650 Epoch=37.5] | Loss=0.03392 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.434 | 1779.6 samples/s | 27.8 steps/s
[Step=7700 Epoch=37.8] | Loss=0.03167 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=2.437 | 4215.4 samples/s | 65.9 steps/s
[Step=7750 Epoch=38.0] | Loss=0.03009 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.269 | L2-Norm(final)=2.441 | 4257.4 samples/s | 66.5 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02907 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=2.444 | 5327.1 samples/s | 83.2 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02825 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.318 | L2-Norm(final)=2.447 | 1772.9 samples/s | 27.7 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02712 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=2.450 | 4318.8 samples/s | 67.5 steps/s
[Step=7950 Epoch=39.0] | Loss=0.02614 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.367 | L2-Norm(final)=2.453 | 4241.8 samples/s | 66.3 steps/s
[Step=8000 Epoch=39.2] | Loss=0.02547 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=2.456 | 5025.9 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.2] | Loss=0.00424 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.438 | 3807.3 samples/s | 59.5 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00331 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.665 | L2-Norm(final)=2.478 | 3691.4 samples/s | 57.7 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00678 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=2.451 | 5578.9 samples/s | 87.2 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00524 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=2.436 | 1670.4 samples/s | 26.1 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00429 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.869 | L2-Norm(final)=2.432 | 5013.5 samples/s | 78.3 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00393 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=2.427 | 1165.2 samples/s | 18.2 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00410 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=2.422 | 4622.2 samples/s | 72.2 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00371 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=2.415 | 1742.4 samples/s | 27.2 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00329 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=2.411 | 4359.1 samples/s | 68.1 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00296 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=2.409 | 1807.9 samples/s | 28.2 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00267 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.408 | 4150.4 samples/s | 64.9 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00243 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=2.408 | 1875.1 samples/s | 29.3 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00222 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.407 | 4101.6 samples/s | 64.1 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00205 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=2.407 | 1910.8 samples/s | 29.9 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00191 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=2.407 | 4059.6 samples/s | 63.4 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00178 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=2.407 | 1891.8 samples/s | 29.6 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00167 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.989 | L2-Norm(final)=2.407 | 3971.9 samples/s | 62.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.5] | Loss=0.02738 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.576 | L2-Norm(final)=2.437 | 3735.3 samples/s | 58.4 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00715 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.436 | 3851.7 samples/s | 60.2 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00399 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=2.448 | 5704.7 samples/s | 89.1 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00272 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=2.459 | 1654.8 samples/s | 25.9 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00205 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.466 | 5216.6 samples/s | 81.5 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00164 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=2.472 | 1735.0 samples/s | 27.1 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00137 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=2.475 | 4735.0 samples/s | 74.0 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00117 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=2.478 | 1744.4 samples/s | 27.3 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00103 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.480 | 4383.0 samples/s | 68.5 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00091 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=2.482 | 1819.1 samples/s | 28.4 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00082 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=2.483 | 4057.8 samples/s | 63.4 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00075 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.485 | 1841.9 samples/s | 28.8 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00068 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=2.486 | 4152.1 samples/s | 64.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00063 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=2.487 | 1863.6 samples/s | 29.1 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00059 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=2.488 | 4014.6 samples/s | 62.7 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00055 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.489 | 1894.2 samples/s | 29.6 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00051 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.489 | 3964.3 samples/s | 61.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.8] | Loss=0.01919 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.576 | L2-Norm(final)=2.439 | 3744.3 samples/s | 58.5 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00327 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.456 | 3763.1 samples/s | 58.8 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00205 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=2.466 | 5748.9 samples/s | 89.8 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00426 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.755 | L2-Norm(final)=2.464 | 1644.7 samples/s | 25.7 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00522 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=2.446 | 5275.0 samples/s | 82.4 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00463 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=2.432 | 1702.2 samples/s | 26.6 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00389 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=2.426 | 4813.8 samples/s | 75.2 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00334 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=2.424 | 1726.3 samples/s | 27.0 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00293 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.422 | 4560.5 samples/s | 71.3 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00260 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=2.422 | 1771.9 samples/s | 27.7 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00234 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=2.421 | 4263.4 samples/s | 66.6 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00213 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.053 | L2-Norm(final)=2.421 | 1819.9 samples/s | 28.4 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00195 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=2.421 | 4102.5 samples/s | 64.1 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00180 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=2.421 | 1848.6 samples/s | 28.9 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00167 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=2.421 | 4000.2 samples/s | 62.5 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00156 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.422 | 1852.1 samples/s | 28.9 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00147 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.422 | 4119.2 samples/s | 64.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=67.9] | Loss=0.06473 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.576 | L2-Norm(final)=2.437 | 3896.7 samples/s | 60.9 steps/s
[Step=7250 Epoch=68.3] | Loss=0.01249 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.813 | L2-Norm(final)=2.407 | 3659.2 samples/s | 57.2 steps/s
[Step=7300 Epoch=68.8] | Loss=0.01096 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.963 | L2-Norm(final)=2.383 | 5541.1 samples/s | 86.6 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00775 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=2.374 | 1703.8 samples/s | 26.6 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00589 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=2.372 | 4913.4 samples/s | 76.8 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00472 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=2.372 | 1722.7 samples/s | 26.9 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00393 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.372 | 4418.6 samples/s | 69.0 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00337 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=2.373 | 1774.6 samples/s | 27.7 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00295 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=2.373 | 4258.2 samples/s | 66.5 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00263 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.374 | 1817.2 samples/s | 28.4 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00236 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=2.375 | 4037.0 samples/s | 63.1 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00215 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=2.376 | 1874.4 samples/s | 29.3 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00197 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=2.376 | 4107.2 samples/s | 64.2 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00182 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=2.377 | 1885.4 samples/s | 29.5 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00169 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=2.378 | 3939.4 samples/s | 61.6 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00158 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.379 | 1951.6 samples/s | 30.5 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00148 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=2.379 | 3690.4 samples/s | 57.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.6] | Loss=0.03793 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.576 | L2-Norm(final)=2.437 | 3923.7 samples/s | 61.3 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00832 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.428 | 3582.1 samples/s | 56.0 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00482 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=2.442 | 5669.3 samples/s | 88.6 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00369 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.893 | L2-Norm(final)=2.449 | 1661.3 samples/s | 26.0 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00317 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=2.455 | 5138.1 samples/s | 80.3 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00401 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.940 | L2-Norm(final)=2.452 | 1695.4 samples/s | 26.5 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00371 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=2.445 | 4922.1 samples/s | 76.9 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00319 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=2.440 | 1739.0 samples/s | 27.2 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00280 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=2.437 | 4646.6 samples/s | 72.6 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00249 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=2.436 | 1773.6 samples/s | 27.7 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00224 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=2.435 | 4387.4 samples/s | 68.6 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00204 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.038 | L2-Norm(final)=2.434 | 1797.6 samples/s | 28.1 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00187 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=2.433 | 4001.5 samples/s | 62.5 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00173 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=2.433 | 1876.3 samples/s | 29.3 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00160 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.002 | L2-Norm(final)=2.432 | 3813.1 samples/s | 59.6 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00150 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=2.432 | 1863.7 samples/s | 29.1 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00140 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=2.432 | 4023.9 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33554 | acc=0.7693 | tpr=0.6716 | fpr=0.0186 | 3789.5 samples/s | 14.8 steps/s
Avg test loss: 0.33349, Avg test acc: 0.76689, Avg tpr: 0.67046, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.22238 | acc=0.8987 | tpr=0.9735 | fpr=0.1027 | 3727.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.22552 | acc=0.8989 | tpr=0.9829 | fpr=0.1027 | 7248.1 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.22892 | acc=0.8978 | tpr=0.9856 | fpr=0.1038 | 7481.1 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.23044 | acc=0.8975 | tpr=0.9858 | fpr=0.1041 | 6815.5 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.22916 | acc=0.8974 | tpr=0.9834 | fpr=0.1042 | 6991.9 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.23032 | acc=0.8970 | tpr=0.9818 | fpr=0.1045 | 7225.6 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.23172 | acc=0.8964 | tpr=0.9812 | fpr=0.1052 | 7217.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.23193 | acc=0.8966 | tpr=0.9819 | fpr=0.1050 | 7070.4 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.23429 | acc=0.8961 | tpr=0.9825 | fpr=0.1055 | 6948.5 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.23432 | acc=0.8957 | tpr=0.9833 | fpr=0.1059 | 6872.4 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.23290 | acc=0.8964 | tpr=0.9837 | fpr=0.1052 | 13536.1 samples/s | 52.9 steps/s
Avg test loss: 0.23280, Avg test acc: 0.89639, Avg tpr: 0.98336, Avg fpr: 0.10519, total FA: 14605

server round 10/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.18335 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.499 | L2-Norm(final)=2.456 | 3998.3 samples/s | 62.5 steps/s
[Step=8050 Epoch=39.3] | Loss=0.07170 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.568 | L2-Norm(final)=2.439 | 4147.5 samples/s | 64.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.05073 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.599 | L2-Norm(final)=2.446 | 4309.3 samples/s | 67.3 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04287 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.454 | 4223.2 samples/s | 66.0 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03862 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.645 | L2-Norm(final)=2.460 | 5847.1 samples/s | 91.4 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03329 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=2.467 | 1746.1 samples/s | 27.3 steps/s
[Step=8300 Epoch=40.5] | Loss=0.03057 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=2.474 | 4213.7 samples/s | 65.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02801 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.689 | L2-Norm(final)=2.479 | 4170.3 samples/s | 65.2 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02614 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=2.486 | 5326.5 samples/s | 83.2 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02417 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=2.491 | 1785.3 samples/s | 27.9 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02274 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.497 | 4252.4 samples/s | 66.4 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02125 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=2.502 | 4232.6 samples/s | 66.1 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02073 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.737 | L2-Norm(final)=2.507 | 4937.2 samples/s | 77.1 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01976 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.510 | 1829.0 samples/s | 28.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01895 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.750 | L2-Norm(final)=2.514 | 4114.7 samples/s | 64.3 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01819 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.756 | L2-Norm(final)=2.517 | 4235.6 samples/s | 66.2 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01755 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.521 | 4648.0 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.15002 | Reg=0.00182 | acc=0.8750 | L2-Norm=13.499 | L2-Norm(final)=2.457 | 3882.4 samples/s | 60.7 steps/s
[Step=8050 Epoch=39.3] | Loss=0.07590 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.583 | L2-Norm(final)=2.437 | 3939.9 samples/s | 61.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.05498 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=2.439 | 4230.6 samples/s | 66.1 steps/s
[Step=8150 Epoch=39.8] | Loss=0.04470 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.645 | L2-Norm(final)=2.449 | 4331.5 samples/s | 67.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03869 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.666 | L2-Norm(final)=2.456 | 5678.2 samples/s | 88.7 steps/s
[Step=8250 Epoch=40.3] | Loss=0.03458 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.682 | L2-Norm(final)=2.463 | 1738.4 samples/s | 27.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.03112 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.697 | L2-Norm(final)=2.470 | 4198.9 samples/s | 65.6 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02891 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.709 | L2-Norm(final)=2.476 | 4162.1 samples/s | 65.0 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02684 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=2.482 | 5395.6 samples/s | 84.3 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02525 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.489 | 1765.9 samples/s | 27.6 steps/s
[Step=8500 Epoch=41.5] | Loss=0.02380 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.745 | L2-Norm(final)=2.494 | 4157.3 samples/s | 65.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02232 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.756 | L2-Norm(final)=2.500 | 4190.5 samples/s | 65.5 steps/s
[Step=8600 Epoch=42.0] | Loss=0.02135 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=2.505 | 5060.1 samples/s | 79.1 steps/s
[Step=8650 Epoch=42.2] | Loss=0.02031 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.510 | 1821.8 samples/s | 28.5 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01947 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=2.514 | 4189.2 samples/s | 65.5 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01873 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=2.518 | 4198.7 samples/s | 65.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01819 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.799 | L2-Norm(final)=2.523 | 4787.3 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.24383 | Reg=0.00182 | acc=0.8594 | L2-Norm=13.499 | L2-Norm(final)=2.456 | 3774.8 samples/s | 59.0 steps/s
[Step=8050 Epoch=39.2] | Loss=0.06101 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.557 | L2-Norm(final)=2.445 | 4071.3 samples/s | 63.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04989 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.585 | L2-Norm(final)=2.449 | 4250.2 samples/s | 66.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04281 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.602 | L2-Norm(final)=2.451 | 4060.2 samples/s | 63.4 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03856 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.619 | L2-Norm(final)=2.457 | 5737.1 samples/s | 89.6 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03560 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.636 | L2-Norm(final)=2.462 | 1756.5 samples/s | 27.4 steps/s
[Step=8300 Epoch=40.4] | Loss=0.03166 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.651 | L2-Norm(final)=2.466 | 4177.9 samples/s | 65.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02948 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.665 | L2-Norm(final)=2.472 | 4306.9 samples/s | 67.3 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02792 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.676 | L2-Norm(final)=2.477 | 5382.5 samples/s | 84.1 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02595 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.481 | 1796.2 samples/s | 28.1 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02467 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.486 | 4186.0 samples/s | 65.4 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02316 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.707 | L2-Norm(final)=2.491 | 4197.4 samples/s | 65.6 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02206 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=2.496 | 4854.9 samples/s | 75.9 steps/s
[Step=8650 Epoch=42.1] | Loss=0.02107 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=2.501 | 1828.6 samples/s | 28.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.02013 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.734 | L2-Norm(final)=2.506 | 4294.1 samples/s | 67.1 steps/s
[Step=8750 Epoch=42.6] | Loss=0.01929 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.511 | 4185.4 samples/s | 65.4 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01881 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.749 | L2-Norm(final)=2.515 | 4574.1 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.13374 | Reg=0.00182 | acc=0.8750 | L2-Norm=13.499 | L2-Norm(final)=2.456 | 3970.4 samples/s | 62.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.06003 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.575 | L2-Norm(final)=2.444 | 4055.2 samples/s | 63.4 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04560 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.609 | L2-Norm(final)=2.448 | 4198.9 samples/s | 65.6 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04024 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.631 | L2-Norm(final)=2.456 | 4321.8 samples/s | 67.5 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03618 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.647 | L2-Norm(final)=2.460 | 5826.4 samples/s | 91.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03174 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.663 | L2-Norm(final)=2.466 | 1723.0 samples/s | 26.9 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02860 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=2.472 | 4206.0 samples/s | 65.7 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02658 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=2.478 | 4260.5 samples/s | 66.6 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02502 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.483 | 5398.6 samples/s | 84.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02315 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.716 | L2-Norm(final)=2.488 | 1764.3 samples/s | 27.6 steps/s
[Step=8500 Epoch=41.5] | Loss=0.02157 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.726 | L2-Norm(final)=2.494 | 4227.6 samples/s | 66.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02048 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.499 | 4233.9 samples/s | 66.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01966 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.504 | 4876.3 samples/s | 76.2 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01873 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=2.508 | 1837.3 samples/s | 28.7 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01802 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.758 | L2-Norm(final)=2.513 | 4196.5 samples/s | 65.6 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01730 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.765 | L2-Norm(final)=2.517 | 4210.2 samples/s | 65.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01676 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.522 | 4635.7 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.24231 | Reg=0.00182 | acc=0.7969 | L2-Norm=13.499 | L2-Norm(final)=2.456 | 3756.1 samples/s | 58.7 steps/s
[Step=8050 Epoch=39.5] | Loss=0.06275 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=2.440 | 4155.9 samples/s | 64.9 steps/s
[Step=8100 Epoch=39.7] | Loss=0.04558 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.588 | L2-Norm(final)=2.446 | 4331.6 samples/s | 67.7 steps/s
[Step=8150 Epoch=40.0] | Loss=0.04137 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.608 | L2-Norm(final)=2.449 | 4303.8 samples/s | 67.2 steps/s
[Step=8200 Epoch=40.2] | Loss=0.03765 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=2.451 | 5829.7 samples/s | 91.1 steps/s
[Step=8250 Epoch=40.5] | Loss=0.03281 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.642 | L2-Norm(final)=2.456 | 1716.7 samples/s | 26.8 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02968 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=2.463 | 4268.6 samples/s | 66.7 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02708 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.469 | 4275.0 samples/s | 66.8 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02517 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=2.475 | 5582.0 samples/s | 87.2 steps/s
[Step=8450 Epoch=41.4] | Loss=0.02340 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=2.480 | 1752.1 samples/s | 27.4 steps/s
[Step=8500 Epoch=41.7] | Loss=0.02189 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.486 | 4192.4 samples/s | 65.5 steps/s
[Step=8550 Epoch=41.9] | Loss=0.02092 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.712 | L2-Norm(final)=2.491 | 4259.1 samples/s | 66.5 steps/s
[Step=8600 Epoch=42.2] | Loss=0.02001 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.720 | L2-Norm(final)=2.495 | 5271.8 samples/s | 82.4 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01889 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=2.499 | 1788.7 samples/s | 27.9 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01811 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.503 | 4249.3 samples/s | 66.4 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01739 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=2.508 | 4306.1 samples/s | 67.3 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01705 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=2.512 | 5143.4 samples/s | 80.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.08711 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.499 | L2-Norm(final)=2.455 | 3847.6 samples/s | 60.1 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00491 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=2.463 | 3666.4 samples/s | 57.3 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00253 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=2.473 | 5551.7 samples/s | 86.7 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00171 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=2.479 | 1675.2 samples/s | 26.2 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00129 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=2.483 | 5095.3 samples/s | 79.6 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00104 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=2.486 | 1697.7 samples/s | 26.5 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00087 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=2.489 | 4787.9 samples/s | 74.8 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00075 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=2.490 | 1763.1 samples/s | 27.5 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00065 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.492 | 4368.9 samples/s | 68.3 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00058 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.494 | 1804.4 samples/s | 28.2 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00053 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=2.495 | 4037.6 samples/s | 63.1 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00048 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=2.496 | 1887.0 samples/s | 29.5 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00044 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=2.497 | 3994.2 samples/s | 62.4 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00041 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=2.498 | 1843.2 samples/s | 28.8 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00038 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=2.499 | 4134.8 samples/s | 64.6 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00035 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=2.500 | 1878.7 samples/s | 29.4 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=2.501 | 4134.7 samples/s | 64.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.04062 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.499 | L2-Norm(final)=2.457 | 3847.6 samples/s | 60.1 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00462 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=2.467 | 3634.1 samples/s | 56.8 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00246 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.476 | 5531.1 samples/s | 86.4 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00165 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=2.482 | 1641.2 samples/s | 25.6 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00124 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=2.487 | 5090.6 samples/s | 79.5 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00100 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=2.490 | 1747.5 samples/s | 27.3 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00083 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.492 | 4595.5 samples/s | 71.8 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00072 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=2.494 | 1780.8 samples/s | 27.8 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00063 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=2.496 | 4488.1 samples/s | 70.1 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.498 | 1819.1 samples/s | 28.4 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00050 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=2.499 | 4162.0 samples/s | 65.0 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.500 | 1820.1 samples/s | 28.4 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00042 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=2.502 | 4002.9 samples/s | 62.5 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00039 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.503 | 1875.6 samples/s | 29.3 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00036 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=2.504 | 4091.6 samples/s | 63.9 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00034 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=2.505 | 1897.0 samples/s | 29.6 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=2.506 | 3992.0 samples/s | 62.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.01143 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.457 | 3964.4 samples/s | 61.9 steps/s
[Step=8050 Epoch=76.9] | Loss=0.00337 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=2.478 | 3534.7 samples/s | 55.2 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00182 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.489 | 5512.8 samples/s | 86.1 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00123 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.496 | 1647.8 samples/s | 25.7 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00093 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=2.501 | 5105.5 samples/s | 79.8 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00075 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=2.505 | 1680.0 samples/s | 26.3 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00062 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=2.508 | 4833.3 samples/s | 75.5 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00054 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=2.510 | 1736.8 samples/s | 27.1 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00047 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=2.512 | 4575.4 samples/s | 71.5 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00042 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.514 | 1757.3 samples/s | 27.5 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00038 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=2.516 | 4296.9 samples/s | 67.1 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00034 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=2.517 | 1808.1 samples/s | 28.3 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00032 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.519 | 4132.7 samples/s | 64.6 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00029 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=2.520 | 1836.0 samples/s | 28.7 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.522 | 3996.1 samples/s | 62.4 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00025 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=2.523 | 1835.7 samples/s | 28.7 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00024 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=2.524 | 4075.9 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.02148 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.499 | L2-Norm(final)=2.457 | 3569.7 samples/s | 55.8 steps/s
[Step=8050 Epoch=75.9] | Loss=0.00437 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=2.471 | 3931.4 samples/s | 61.4 steps/s
[Step=8100 Epoch=76.3] | Loss=0.00239 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.482 | 5518.9 samples/s | 86.2 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00162 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=2.489 | 1665.4 samples/s | 26.0 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00122 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.493 | 5009.0 samples/s | 78.3 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00098 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.553 | L2-Norm(final)=2.497 | 1763.0 samples/s | 27.5 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00082 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=2.499 | 4488.4 samples/s | 70.1 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00070 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.501 | 1763.9 samples/s | 27.6 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00062 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=2.503 | 4246.3 samples/s | 66.3 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00055 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.505 | 1845.3 samples/s | 28.8 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00049 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.506 | 4076.2 samples/s | 63.7 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00045 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=2.507 | 1871.4 samples/s | 29.2 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00041 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.509 | 4127.7 samples/s | 64.5 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00038 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=2.510 | 1896.5 samples/s | 29.6 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00036 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=2.511 | 4071.9 samples/s | 63.6 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00033 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=2.512 | 2029.7 samples/s | 31.7 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=2.513 | 3427.7 samples/s | 53.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.06776 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.499 | L2-Norm(final)=2.456 | 3627.9 samples/s | 56.7 steps/s
[Step=8050 Epoch=76.7] | Loss=0.00294 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=2.472 | 3773.0 samples/s | 59.0 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00155 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=2.481 | 5643.6 samples/s | 88.2 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00105 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=2.487 | 1645.6 samples/s | 25.7 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00079 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=2.491 | 5204.3 samples/s | 81.3 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00064 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.494 | 1702.8 samples/s | 26.6 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00054 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=2.496 | 4777.7 samples/s | 74.7 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00046 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.498 | 1702.0 samples/s | 26.6 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=2.500 | 4556.7 samples/s | 71.2 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00036 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.502 | 1790.1 samples/s | 28.0 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=2.503 | 4383.5 samples/s | 68.5 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00030 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=2.505 | 1810.7 samples/s | 28.3 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00027 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=2.506 | 4167.4 samples/s | 65.1 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00025 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=2.507 | 1837.5 samples/s | 28.7 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00024 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=2.508 | 4089.1 samples/s | 63.9 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00022 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=2.509 | 1882.6 samples/s | 29.4 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00021 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=2.510 | 4037.6 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41962 | acc=0.7734 | tpr=0.6731 | fpr=0.0087 | 3790.7 samples/s | 14.8 steps/s
Avg test loss: 0.41793, Avg test acc: 0.77174, Avg tpr: 0.67226, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.24459 | acc=0.9075 | tpr=0.9602 | fpr=0.0934 | 3736.1 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.24675 | acc=0.9078 | tpr=0.9744 | fpr=0.0934 | 7171.8 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.25044 | acc=0.9069 | tpr=0.9726 | fpr=0.0943 | 7405.0 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.25205 | acc=0.9065 | tpr=0.9749 | fpr=0.0947 | 7134.0 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.25042 | acc=0.9064 | tpr=0.9747 | fpr=0.0949 | 7105.9 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.25142 | acc=0.9061 | tpr=0.9745 | fpr=0.0952 | 7165.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.25274 | acc=0.9057 | tpr=0.9743 | fpr=0.0956 | 7054.6 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.25321 | acc=0.9056 | tpr=0.9737 | fpr=0.0957 | 7152.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.25563 | acc=0.9052 | tpr=0.9752 | fpr=0.0961 | 7019.0 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.25547 | acc=0.9050 | tpr=0.9762 | fpr=0.0963 | 7055.3 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.25389 | acc=0.9054 | tpr=0.9761 | fpr=0.0958 | 13222.1 samples/s | 51.6 steps/s
Avg test loss: 0.25375, Avg test acc: 0.90543, Avg tpr: 0.97583, Avg fpr: 0.09585, total FA: 13309

server round 11/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.41428 | Reg=0.00177 | acc=0.7656 | L2-Norm=13.320 | L2-Norm(final)=2.547 | 3955.8 samples/s | 61.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.06104 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=2.513 | 3857.9 samples/s | 60.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04353 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.476 | L2-Norm(final)=2.516 | 4277.3 samples/s | 66.8 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03846 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.503 | L2-Norm(final)=2.520 | 4271.6 samples/s | 66.7 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03545 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=2.523 | 5795.9 samples/s | 90.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.03560 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=2.524 | 1747.3 samples/s | 27.3 steps/s
[Step=9100 Epoch=44.4] | Loss=0.03210 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=2.527 | 4185.2 samples/s | 65.4 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02894 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.582 | L2-Norm(final)=2.533 | 4225.0 samples/s | 66.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02730 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=2.539 | 5279.3 samples/s | 82.5 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02541 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.611 | L2-Norm(final)=2.544 | 1765.1 samples/s | 27.6 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02369 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.624 | L2-Norm(final)=2.549 | 4251.8 samples/s | 66.4 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02255 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=2.554 | 4165.3 samples/s | 65.1 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02153 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=2.559 | 5084.8 samples/s | 79.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.02067 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.654 | L2-Norm(final)=2.563 | 1840.5 samples/s | 28.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01968 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=2.567 | 4246.2 samples/s | 66.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01906 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.570 | 4221.0 samples/s | 66.0 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01826 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.678 | L2-Norm(final)=2.574 | 4612.9 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.26701 | Reg=0.00177 | acc=0.8594 | L2-Norm=13.320 | L2-Norm(final)=2.547 | 4300.2 samples/s | 67.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05790 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.428 | L2-Norm(final)=2.513 | 3679.6 samples/s | 57.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04538 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.469 | L2-Norm(final)=2.510 | 4155.1 samples/s | 64.9 steps/s
[Step=8950 Epoch=43.7] | Loss=0.03748 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.494 | L2-Norm(final)=2.515 | 4234.9 samples/s | 66.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03380 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.512 | L2-Norm(final)=2.520 | 5808.9 samples/s | 90.8 steps/s
[Step=9050 Epoch=44.2] | Loss=0.02977 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.524 | 1762.0 samples/s | 27.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02646 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=2.530 | 4346.8 samples/s | 67.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02499 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.555 | L2-Norm(final)=2.534 | 4194.6 samples/s | 65.5 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02313 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.538 | 5303.9 samples/s | 82.9 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02146 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=2.544 | 1741.4 samples/s | 27.2 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01998 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=2.550 | 4212.1 samples/s | 65.8 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01919 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.555 | 4190.3 samples/s | 65.5 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01835 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=2.559 | 5017.4 samples/s | 78.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01737 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.563 | 1820.9 samples/s | 28.5 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01662 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.568 | 4195.9 samples/s | 65.6 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01586 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=2.573 | 4250.2 samples/s | 66.4 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01541 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=2.577 | 4729.1 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.32882 | Reg=0.00177 | acc=0.8594 | L2-Norm=13.320 | L2-Norm(final)=2.547 | 4196.3 samples/s | 65.6 steps/s
[Step=8850 Epoch=43.1] | Loss=0.06054 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.413 | L2-Norm(final)=2.508 | 3637.3 samples/s | 56.8 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04518 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.451 | L2-Norm(final)=2.509 | 4190.2 samples/s | 65.5 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03911 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.513 | 4208.4 samples/s | 65.8 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03545 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.495 | L2-Norm(final)=2.518 | 5764.5 samples/s | 90.1 steps/s
[Step=9050 Epoch=44.1] | Loss=0.03263 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.514 | L2-Norm(final)=2.524 | 1727.4 samples/s | 27.0 steps/s
[Step=9100 Epoch=44.3] | Loss=0.03002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.531 | L2-Norm(final)=2.527 | 4303.5 samples/s | 67.2 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02780 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.547 | L2-Norm(final)=2.532 | 4225.3 samples/s | 66.0 steps/s
[Step=9200 Epoch=44.8] | Loss=0.02618 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=2.537 | 5418.2 samples/s | 84.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02446 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.573 | L2-Norm(final)=2.542 | 1801.4 samples/s | 28.1 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02326 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.547 | 4234.0 samples/s | 66.2 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02195 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.552 | 4144.2 samples/s | 64.8 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02083 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=2.557 | 4968.0 samples/s | 77.6 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01983 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=2.562 | 1811.1 samples/s | 28.3 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01901 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.623 | L2-Norm(final)=2.567 | 4175.2 samples/s | 65.2 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01813 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=2.572 | 4242.9 samples/s | 66.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01743 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.639 | L2-Norm(final)=2.577 | 4563.1 samples/s | 71.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.23087 | Reg=0.00177 | acc=0.9219 | L2-Norm=13.320 | L2-Norm(final)=2.548 | 4087.0 samples/s | 63.9 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05180 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=2.518 | 3757.8 samples/s | 58.7 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04165 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.457 | L2-Norm(final)=2.516 | 4287.4 samples/s | 67.0 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03569 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.481 | L2-Norm(final)=2.519 | 4267.2 samples/s | 66.7 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03238 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=2.523 | 5713.1 samples/s | 89.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02835 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.518 | L2-Norm(final)=2.528 | 1729.7 samples/s | 27.0 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02553 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=2.534 | 4214.0 samples/s | 65.8 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02377 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.544 | L2-Norm(final)=2.539 | 4215.7 samples/s | 65.9 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02233 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=2.544 | 5427.5 samples/s | 84.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02114 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=2.548 | 1785.1 samples/s | 27.9 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01983 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=2.553 | 4203.6 samples/s | 65.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01892 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.583 | L2-Norm(final)=2.558 | 4224.4 samples/s | 66.0 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01813 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=2.561 | 5026.8 samples/s | 78.5 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01735 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=2.565 | 1840.8 samples/s | 28.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01670 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.605 | L2-Norm(final)=2.569 | 4179.0 samples/s | 65.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01602 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.572 | 4165.5 samples/s | 65.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01574 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.617 | L2-Norm(final)=2.576 | 4617.1 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=43.2] | Loss=0.20168 | Reg=0.00177 | acc=0.8438 | L2-Norm=13.320 | L2-Norm(final)=2.548 | 4000.4 samples/s | 62.5 steps/s
[Step=8850 Epoch=43.4] | Loss=0.05155 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.422 | L2-Norm(final)=2.519 | 3886.2 samples/s | 60.7 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03913 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=2.517 | 4269.6 samples/s | 66.7 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03612 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.480 | L2-Norm(final)=2.518 | 4260.1 samples/s | 66.6 steps/s
[Step=9000 Epoch=44.1] | Loss=0.03242 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.498 | L2-Norm(final)=2.519 | 5840.4 samples/s | 91.3 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02855 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.515 | L2-Norm(final)=2.523 | 1725.9 samples/s | 27.0 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02548 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.531 | L2-Norm(final)=2.527 | 4224.3 samples/s | 66.0 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02348 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=2.533 | 4230.1 samples/s | 66.1 steps/s
[Step=9200 Epoch=45.1] | Loss=0.02198 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.556 | L2-Norm(final)=2.537 | 5656.9 samples/s | 88.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.02082 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.542 | 1765.9 samples/s | 27.6 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01962 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.577 | L2-Norm(final)=2.547 | 4254.3 samples/s | 66.5 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01878 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.587 | L2-Norm(final)=2.551 | 4207.5 samples/s | 65.7 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01796 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.596 | L2-Norm(final)=2.555 | 5280.5 samples/s | 82.5 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01739 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=2.559 | 1782.2 samples/s | 27.8 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01648 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=2.562 | 4292.9 samples/s | 67.1 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01592 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=2.567 | 4092.5 samples/s | 63.9 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01554 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.627 | L2-Norm(final)=2.570 | 4981.6 samples/s | 77.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.06823 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.320 | L2-Norm(final)=2.547 | 3703.8 samples/s | 57.9 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00522 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=2.537 | 3740.5 samples/s | 58.4 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00287 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=2.544 | 5365.0 samples/s | 83.8 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00193 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.550 | 1669.7 samples/s | 26.1 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00145 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=2.554 | 5006.8 samples/s | 78.2 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00117 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=2.557 | 1692.9 samples/s | 26.5 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00097 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.559 | 4613.5 samples/s | 72.1 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00084 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=2.561 | 1768.3 samples/s | 27.6 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00073 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=2.563 | 4404.6 samples/s | 68.8 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00065 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=2.564 | 1803.5 samples/s | 28.2 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00059 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=2.565 | 4137.8 samples/s | 64.7 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00054 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.567 | 1867.7 samples/s | 29.2 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00049 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=2.568 | 4019.3 samples/s | 62.8 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00045 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.569 | 1902.9 samples/s | 29.7 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00042 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=2.570 | 4019.4 samples/s | 62.8 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=2.571 | 1867.7 samples/s | 29.2 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00037 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=2.571 | 3942.9 samples/s | 61.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.7] | Loss=0.00904 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.550 | 3761.6 samples/s | 58.8 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00305 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=2.552 | 3723.1 samples/s | 58.2 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00213 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.555 | 5586.8 samples/s | 87.3 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00143 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=2.558 | 1648.6 samples/s | 25.8 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00107 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.560 | 5107.1 samples/s | 79.8 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00086 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=2.562 | 1695.2 samples/s | 26.5 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00072 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=2.563 | 4727.4 samples/s | 73.9 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00062 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=2.564 | 1759.8 samples/s | 27.5 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=2.565 | 4356.7 samples/s | 68.1 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00048 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.566 | 1820.1 samples/s | 28.4 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=2.567 | 4109.4 samples/s | 64.2 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=2.568 | 1883.0 samples/s | 29.4 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00036 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.568 | 4020.6 samples/s | 62.8 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00033 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=2.569 | 1852.8 samples/s | 29.0 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00031 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=2.570 | 4022.9 samples/s | 62.9 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00029 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=2.570 | 1846.9 samples/s | 28.9 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00027 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=2.571 | 3976.4 samples/s | 62.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=84.0] | Loss=0.06365 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.320 | L2-Norm(final)=2.548 | 3743.3 samples/s | 58.5 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00583 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.446 | L2-Norm(final)=2.539 | 3768.9 samples/s | 58.9 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00300 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.545 | 5663.9 samples/s | 88.5 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00203 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=2.550 | 1677.2 samples/s | 26.2 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00153 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=2.554 | 5191.9 samples/s | 81.1 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00123 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=2.556 | 1690.9 samples/s | 26.4 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00103 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.558 | 4965.3 samples/s | 77.6 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00088 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=2.560 | 1746.1 samples/s | 27.3 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00077 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=2.561 | 4466.2 samples/s | 69.8 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00069 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=2.563 | 1793.4 samples/s | 28.0 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00062 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=2.564 | 4292.7 samples/s | 67.1 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00056 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=2.565 | 1795.9 samples/s | 28.1 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00052 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=2.566 | 4099.9 samples/s | 64.1 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=2.567 | 1838.9 samples/s | 28.7 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00044 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=2.568 | 4078.6 samples/s | 63.7 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00041 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=2.568 | 1853.4 samples/s | 29.0 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00039 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=2.569 | 4089.4 samples/s | 63.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step9600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=82.9] | Loss=0.02753 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.320 | L2-Norm(final)=2.549 | 3910.5 samples/s | 61.1 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00616 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=2.537 | 3745.7 samples/s | 58.5 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00378 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=2.543 | 5486.8 samples/s | 85.7 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00287 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.549 | 1665.2 samples/s | 26.0 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00219 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.554 | 5026.4 samples/s | 78.5 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00176 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.558 | 1735.4 samples/s | 27.1 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00147 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.562 | 4509.9 samples/s | 70.5 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00126 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=2.564 | 1775.6 samples/s | 27.7 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00110 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=2.567 | 4081.0 samples/s | 63.8 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00098 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=2.569 | 1815.3 samples/s | 28.4 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00089 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=2.570 | 4043.2 samples/s | 63.2 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00081 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=2.572 | 1849.6 samples/s | 28.9 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00074 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=2.573 | 4002.7 samples/s | 62.5 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00068 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=2.574 | 1901.5 samples/s | 29.7 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00063 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=2.576 | 4020.9 samples/s | 62.8 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00059 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=2.577 | 2038.9 samples/s | 31.9 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00056 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.578 | 3629.5 samples/s | 56.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.9] | Loss=0.01016 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.549 | 3612.2 samples/s | 56.4 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00389 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=2.552 | 3905.0 samples/s | 61.0 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00206 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=2.564 | 5620.4 samples/s | 87.8 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00138 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=2.571 | 1643.7 samples/s | 25.7 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00104 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=2.575 | 5213.7 samples/s | 81.5 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00084 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=2.578 | 1691.1 samples/s | 26.4 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00070 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=2.580 | 4842.1 samples/s | 75.7 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00060 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=2.582 | 1743.5 samples/s | 27.2 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00053 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=2.583 | 4551.9 samples/s | 71.1 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00047 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=2.585 | 1799.9 samples/s | 28.1 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=2.586 | 4195.0 samples/s | 65.5 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=2.587 | 1817.5 samples/s | 28.4 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.588 | 4059.3 samples/s | 63.4 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00033 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=2.589 | 1861.5 samples/s | 29.1 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00030 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=2.590 | 3961.5 samples/s | 61.9 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.591 | 1873.1 samples/s | 29.3 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=2.591 | 4005.0 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37581 | acc=0.7921 | tpr=0.7007 | fpr=0.0094 | 3767.2 samples/s | 14.7 steps/s
Avg test loss: 0.37491, Avg test acc: 0.79069, Avg tpr: 0.70059, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.24954 | acc=0.9086 | tpr=0.9690 | fpr=0.0925 | 3763.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.25288 | acc=0.9080 | tpr=0.9765 | fpr=0.0932 | 7070.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.25637 | acc=0.9067 | tpr=0.9755 | fpr=0.0945 | 7248.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.25822 | acc=0.9060 | tpr=0.9781 | fpr=0.0954 | 7221.6 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.25612 | acc=0.9060 | tpr=0.9764 | fpr=0.0952 | 7161.9 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.25731 | acc=0.9053 | tpr=0.9760 | fpr=0.0960 | 7263.2 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.25881 | acc=0.9047 | tpr=0.9750 | fpr=0.0965 | 7074.1 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.25954 | acc=0.9045 | tpr=0.9737 | fpr=0.0968 | 7219.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.26192 | acc=0.9044 | tpr=0.9752 | fpr=0.0969 | 6942.5 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.26157 | acc=0.9042 | tpr=0.9762 | fpr=0.0971 | 7037.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.26019 | acc=0.9045 | tpr=0.9749 | fpr=0.0968 | 13232.7 samples/s | 51.7 steps/s
Avg test loss: 0.26006, Avg test acc: 0.90451, Avg tpr: 0.97464, Avg fpr: 0.09676, total FA: 13435

server round 12/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.17607 | Reg=0.00173 | acc=0.9219 | L2-Norm=13.160 | L2-Norm(final)=2.610 | 3773.9 samples/s | 59.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05959 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.268 | L2-Norm(final)=2.579 | 4066.2 samples/s | 63.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04400 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.313 | L2-Norm(final)=2.580 | 4192.3 samples/s | 65.5 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03743 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.341 | L2-Norm(final)=2.584 | 4221.5 samples/s | 66.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03428 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=2.588 | 5762.3 samples/s | 90.0 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02997 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=2.593 | 1736.1 samples/s | 27.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02729 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.399 | L2-Norm(final)=2.600 | 4169.1 samples/s | 65.1 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02512 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=2.605 | 4257.8 samples/s | 66.5 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02372 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=2.610 | 5225.8 samples/s | 81.7 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02215 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=2.614 | 1772.9 samples/s | 27.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.02077 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.447 | L2-Norm(final)=2.618 | 4187.7 samples/s | 65.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01976 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=2.623 | 4230.4 samples/s | 66.1 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01890 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.464 | L2-Norm(final)=2.626 | 5064.9 samples/s | 79.1 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01819 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.471 | L2-Norm(final)=2.630 | 1829.8 samples/s | 28.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01742 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=2.633 | 4223.3 samples/s | 66.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01668 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=2.637 | 4297.6 samples/s | 67.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01606 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=2.640 | 4711.9 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.12993 | Reg=0.00173 | acc=0.9062 | L2-Norm=13.160 | L2-Norm(final)=2.610 | 3764.8 samples/s | 58.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05214 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.256 | L2-Norm(final)=2.578 | 4103.8 samples/s | 64.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04200 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.304 | L2-Norm(final)=2.579 | 4230.1 samples/s | 66.1 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03646 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=2.582 | 4280.4 samples/s | 66.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03440 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.360 | L2-Norm(final)=2.582 | 5572.9 samples/s | 87.1 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02981 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.380 | L2-Norm(final)=2.586 | 1731.5 samples/s | 27.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02670 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.397 | L2-Norm(final)=2.591 | 4314.9 samples/s | 67.4 steps/s
[Step=9950 Epoch=48.6] | Loss=0.02501 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.412 | L2-Norm(final)=2.597 | 4264.3 samples/s | 66.6 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02371 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=2.600 | 5348.1 samples/s | 83.6 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02219 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.604 | 1776.3 samples/s | 27.8 steps/s
[Step=10100 Epoch=49.3] | Loss=0.02104 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.450 | L2-Norm(final)=2.609 | 4317.6 samples/s | 67.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01981 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.461 | L2-Norm(final)=2.613 | 4241.6 samples/s | 66.3 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01886 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.618 | 5024.2 samples/s | 78.5 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01814 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=2.622 | 1811.5 samples/s | 28.3 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01746 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.626 | 4258.2 samples/s | 66.5 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01669 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.498 | L2-Norm(final)=2.630 | 4182.8 samples/s | 65.4 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01627 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.505 | L2-Norm(final)=2.634 | 4860.1 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.38651 | Reg=0.00173 | acc=0.7969 | L2-Norm=13.160 | L2-Norm(final)=2.608 | 3953.9 samples/s | 61.8 steps/s
[Step=9650 Epoch=47.0] | Loss=0.05425 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.229 | L2-Norm(final)=2.572 | 3798.9 samples/s | 59.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04073 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.263 | L2-Norm(final)=2.570 | 4219.2 samples/s | 65.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03604 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=2.573 | 4201.0 samples/s | 65.6 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03301 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.306 | L2-Norm(final)=2.577 | 5868.2 samples/s | 91.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02935 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.325 | L2-Norm(final)=2.583 | 1749.0 samples/s | 27.3 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02736 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.342 | L2-Norm(final)=2.589 | 4141.2 samples/s | 64.7 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02572 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=2.594 | 4320.3 samples/s | 67.5 steps/s
[Step=10000 Epoch=48.7] | Loss=0.02453 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.372 | L2-Norm(final)=2.598 | 5341.2 samples/s | 83.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02282 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=2.603 | 1800.3 samples/s | 28.1 steps/s
[Step=10100 Epoch=49.2] | Loss=0.02176 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=2.608 | 4222.6 samples/s | 66.0 steps/s
[Step=10150 Epoch=49.5] | Loss=0.02052 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=2.613 | 4262.2 samples/s | 66.6 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01995 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.420 | L2-Norm(final)=2.617 | 4943.1 samples/s | 77.2 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01926 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=2.621 | 1845.1 samples/s | 28.8 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01846 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.624 | 4130.5 samples/s | 64.5 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01770 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=2.628 | 4216.6 samples/s | 65.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01723 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.456 | L2-Norm(final)=2.632 | 4626.8 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.32907 | Reg=0.00173 | acc=0.8594 | L2-Norm=13.160 | L2-Norm(final)=2.608 | 3846.8 samples/s | 60.1 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04241 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.272 | L2-Norm(final)=2.584 | 4153.4 samples/s | 64.9 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03343 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=2.589 | 4302.5 samples/s | 67.2 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03187 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=2.590 | 4355.5 samples/s | 68.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02967 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.360 | L2-Norm(final)=2.591 | 5828.8 samples/s | 91.1 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02761 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.380 | L2-Norm(final)=2.592 | 1724.6 samples/s | 26.9 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02553 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=2.594 | 4196.0 samples/s | 65.6 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02341 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.412 | L2-Norm(final)=2.598 | 4188.2 samples/s | 65.4 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02231 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=2.602 | 5354.9 samples/s | 83.7 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02079 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.605 | 1775.8 samples/s | 27.7 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01970 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.609 | 4303.4 samples/s | 67.2 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01881 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.457 | L2-Norm(final)=2.612 | 4298.3 samples/s | 67.2 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01803 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=2.615 | 4994.4 samples/s | 78.0 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01738 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.618 | 1837.5 samples/s | 28.7 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01681 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=2.621 | 4119.0 samples/s | 64.4 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01607 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=2.625 | 4176.6 samples/s | 65.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01540 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.497 | L2-Norm(final)=2.629 | 4673.3 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=47.1] | Loss=0.17303 | Reg=0.00173 | acc=0.8906 | L2-Norm=13.160 | L2-Norm(final)=2.609 | 3988.8 samples/s | 62.3 steps/s
[Step=9650 Epoch=47.3] | Loss=0.04662 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.273 | L2-Norm(final)=2.582 | 4016.2 samples/s | 62.8 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03843 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=2.578 | 4295.8 samples/s | 67.1 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03394 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.336 | L2-Norm(final)=2.581 | 4217.9 samples/s | 65.9 steps/s
[Step=9800 Epoch=48.1] | Loss=0.03015 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=2.584 | 5884.2 samples/s | 91.9 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02633 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=2.590 | 1739.5 samples/s | 27.2 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02413 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.386 | L2-Norm(final)=2.595 | 4236.0 samples/s | 66.2 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02239 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.398 | L2-Norm(final)=2.600 | 4234.0 samples/s | 66.2 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02077 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=2.605 | 5578.3 samples/s | 87.2 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01947 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=2.609 | 1750.4 samples/s | 27.4 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01837 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=2.614 | 4313.7 samples/s | 67.4 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01741 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=2.619 | 4179.5 samples/s | 65.3 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01656 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=2.624 | 5365.4 samples/s | 83.8 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01604 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=2.628 | 1803.9 samples/s | 28.2 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01526 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.633 | 4244.4 samples/s | 66.3 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01480 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.469 | L2-Norm(final)=2.637 | 4262.9 samples/s | 66.6 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01425 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.476 | L2-Norm(final)=2.641 | 5026.7 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.00709 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.160 | L2-Norm(final)=2.611 | 3565.7 samples/s | 55.7 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00489 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=2.609 | 3813.9 samples/s | 59.6 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00319 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=2.605 | 5483.3 samples/s | 85.7 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00214 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.609 | 1646.5 samples/s | 25.7 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00162 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.315 | L2-Norm(final)=2.611 | 5139.4 samples/s | 80.3 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00130 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.614 | 1722.9 samples/s | 26.9 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00108 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=2.616 | 4680.8 samples/s | 73.1 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00093 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=2.617 | 1747.6 samples/s | 27.3 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00081 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=2.619 | 4373.0 samples/s | 68.3 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00072 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=2.620 | 1791.6 samples/s | 28.0 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00065 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=2.621 | 4090.3 samples/s | 63.9 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00059 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.622 | 1845.4 samples/s | 28.8 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00054 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=2.623 | 4194.9 samples/s | 65.5 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00050 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=2.624 | 1878.2 samples/s | 29.3 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00047 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=2.625 | 4158.6 samples/s | 65.0 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00044 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=2.626 | 1853.8 samples/s | 29.0 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00041 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=2.627 | 4008.7 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.3] | Loss=0.01061 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.160 | L2-Norm(final)=2.611 | 3749.1 samples/s | 58.6 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00515 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.604 | 3720.8 samples/s | 58.1 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00282 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=2.606 | 5593.8 samples/s | 87.4 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00192 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.612 | 1650.2 samples/s | 25.8 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00145 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=2.617 | 5130.1 samples/s | 80.2 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00116 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.620 | 1696.0 samples/s | 26.5 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00097 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=2.623 | 4742.1 samples/s | 74.1 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00083 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.625 | 1711.7 samples/s | 26.7 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00073 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.626 | 4387.0 samples/s | 68.5 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00065 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=2.628 | 1779.8 samples/s | 27.8 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00058 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=2.629 | 4181.5 samples/s | 65.3 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00053 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=2.630 | 1859.9 samples/s | 29.1 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00049 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=2.631 | 4097.0 samples/s | 64.0 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00045 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=2.632 | 1861.8 samples/s | 29.1 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00042 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=2.632 | 4007.1 samples/s | 62.6 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00039 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=2.633 | 1899.8 samples/s | 29.7 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00036 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=2.634 | 3946.7 samples/s | 61.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.7] | Loss=0.06400 | Reg=0.00173 | acc=0.9375 | L2-Norm=13.160 | L2-Norm(final)=2.610 | 4099.0 samples/s | 64.0 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00400 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.616 | 3535.2 samples/s | 55.2 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00253 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=2.619 | 5750.1 samples/s | 89.8 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00171 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.323 | L2-Norm(final)=2.625 | 1657.6 samples/s | 25.9 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00129 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=2.629 | 5137.6 samples/s | 80.3 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00104 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=2.631 | 1700.4 samples/s | 26.6 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00086 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=2.634 | 4949.1 samples/s | 77.3 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00074 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=2.635 | 1729.8 samples/s | 27.0 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00065 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=2.637 | 4586.3 samples/s | 71.7 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00058 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.638 | 1789.9 samples/s | 28.0 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00052 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=2.639 | 4367.3 samples/s | 68.2 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00047 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.640 | 1812.9 samples/s | 28.3 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00044 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=2.641 | 4076.0 samples/s | 63.7 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00040 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=2.642 | 1834.5 samples/s | 28.7 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00037 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=2.643 | 4115.0 samples/s | 64.3 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00035 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=2.643 | 1858.0 samples/s | 29.0 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00033 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=2.644 | 4123.4 samples/s | 64.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=90.5] | Loss=0.02406 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.160 | L2-Norm(final)=2.611 | 3824.4 samples/s | 59.8 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00275 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.623 | 3642.8 samples/s | 56.9 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00150 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=2.634 | 5533.9 samples/s | 86.5 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00102 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=2.641 | 1669.8 samples/s | 26.1 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00076 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.645 | 4979.5 samples/s | 77.8 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00062 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=2.648 | 1704.6 samples/s | 26.6 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00052 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=2.650 | 4543.4 samples/s | 71.0 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00045 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=2.652 | 1764.8 samples/s | 27.6 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=2.654 | 4213.4 samples/s | 65.8 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00035 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=2.655 | 1846.3 samples/s | 28.8 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=2.656 | 4102.8 samples/s | 64.1 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00028 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=2.657 | 1873.8 samples/s | 29.3 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00026 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=2.658 | 3978.2 samples/s | 62.2 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00024 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=2.659 | 1839.9 samples/s | 28.7 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=2.660 | 4050.6 samples/s | 63.3 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00021 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=2.661 | 1867.6 samples/s | 29.2 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00020 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=2.661 | 3946.2 samples/s | 61.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.5] | Loss=0.02138 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.160 | L2-Norm(final)=2.609 | 3809.4 samples/s | 59.5 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00967 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=2.575 | 3732.5 samples/s | 58.3 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00527 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=2.569 | 5612.2 samples/s | 87.7 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00352 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=2.571 | 1662.4 samples/s | 26.0 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00265 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=2.573 | 5168.8 samples/s | 80.8 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00212 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=2.575 | 1665.1 samples/s | 26.0 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00177 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=2.576 | 4790.0 samples/s | 74.8 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00152 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.577 | 1721.7 samples/s | 26.9 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00133 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=2.579 | 4493.9 samples/s | 70.2 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00118 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=2.580 | 1752.6 samples/s | 27.4 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00107 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=2.581 | 4319.0 samples/s | 67.5 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00097 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=2.582 | 1802.2 samples/s | 28.2 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00089 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=2.583 | 4166.7 samples/s | 65.1 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00082 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=2.584 | 1859.2 samples/s | 29.0 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00076 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=2.585 | 3980.8 samples/s | 62.2 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00071 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=2.586 | 1858.2 samples/s | 29.0 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00067 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.140 | L2-Norm(final)=2.587 | 4139.8 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41087 | acc=0.7792 | tpr=0.6813 | fpr=0.0082 | 3799.9 samples/s | 14.8 steps/s
Avg test loss: 0.41073, Avg test acc: 0.77743, Avg tpr: 0.68071, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.24871 | acc=0.9116 | tpr=0.9690 | fpr=0.0895 | 3843.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.25275 | acc=0.9122 | tpr=0.9787 | fpr=0.0891 | 6789.7 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.25667 | acc=0.9109 | tpr=0.9784 | fpr=0.0904 | 7294.8 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.25793 | acc=0.9107 | tpr=0.9792 | fpr=0.0906 | 7041.1 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.25577 | acc=0.9106 | tpr=0.9764 | fpr=0.0906 | 7039.4 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.25699 | acc=0.9103 | tpr=0.9760 | fpr=0.0909 | 7297.2 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.25868 | acc=0.9101 | tpr=0.9743 | fpr=0.0910 | 7087.9 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.25947 | acc=0.9100 | tpr=0.9732 | fpr=0.0911 | 7136.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.26172 | acc=0.9101 | tpr=0.9747 | fpr=0.0911 | 7056.1 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.26122 | acc=0.9099 | tpr=0.9758 | fpr=0.0913 | 6967.1 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.25983 | acc=0.9104 | tpr=0.9745 | fpr=0.0908 | 12405.6 samples/s | 48.5 steps/s
Avg test loss: 0.25965, Avg test acc: 0.91040, Avg tpr: 0.97425, Avg fpr: 0.09076, total FA: 12602

server round 13/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.27180 | Reg=0.00169 | acc=0.7969 | L2-Norm=13.018 | L2-Norm(final)=2.665 | 4059.5 samples/s | 63.4 steps/s
[Step=10450 Epoch=51.0] | Loss=0.05928 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=2.631 | 3854.6 samples/s | 60.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.04296 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=2.634 | 4217.3 samples/s | 65.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03700 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.239 | L2-Norm(final)=2.639 | 4230.7 samples/s | 66.1 steps/s
[Step=10600 Epoch=51.7] | Loss=0.03332 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.261 | L2-Norm(final)=2.642 | 5768.8 samples/s | 90.1 steps/s
[Step=10650 Epoch=51.9] | Loss=0.03109 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=2.645 | 1739.5 samples/s | 27.2 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02880 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=2.647 | 4389.7 samples/s | 68.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02691 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=2.649 | 4316.2 samples/s | 67.4 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02528 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.330 | L2-Norm(final)=2.652 | 5415.5 samples/s | 84.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02340 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=2.655 | 1780.2 samples/s | 27.8 steps/s
[Step=10900 Epoch=53.2] | Loss=0.02211 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.355 | L2-Norm(final)=2.659 | 4231.2 samples/s | 66.1 steps/s
[Step=10950 Epoch=53.4] | Loss=0.02092 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=2.662 | 4147.5 samples/s | 64.8 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02032 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.374 | L2-Norm(final)=2.665 | 4891.4 samples/s | 76.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01967 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.382 | L2-Norm(final)=2.667 | 1788.8 samples/s | 28.0 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01882 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=2.669 | 4190.2 samples/s | 65.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01797 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=2.672 | 4188.9 samples/s | 65.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01750 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=2.675 | 4502.4 samples/s | 70.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.8] | Loss=0.34360 | Reg=0.00169 | acc=0.8125 | L2-Norm=13.018 | L2-Norm(final)=2.664 | 3887.6 samples/s | 60.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.05018 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.135 | L2-Norm(final)=2.638 | 3880.9 samples/s | 60.6 steps/s
[Step=10500 Epoch=51.2] | Loss=0.04141 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.183 | L2-Norm(final)=2.635 | 4200.0 samples/s | 65.6 steps/s
[Step=10550 Epoch=51.5] | Loss=0.03530 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.213 | L2-Norm(final)=2.637 | 4125.4 samples/s | 64.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.03327 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.238 | L2-Norm(final)=2.639 | 5712.9 samples/s | 89.3 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02898 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=2.643 | 1730.6 samples/s | 27.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02569 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=2.651 | 4184.9 samples/s | 65.4 steps/s
[Step=10750 Epoch=52.5] | Loss=0.02351 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.657 | 4199.9 samples/s | 65.6 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02249 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.310 | L2-Norm(final)=2.662 | 5341.3 samples/s | 83.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02138 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.323 | L2-Norm(final)=2.666 | 1767.4 samples/s | 27.6 steps/s
[Step=10900 Epoch=53.2] | Loss=0.02006 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=2.669 | 4244.7 samples/s | 66.3 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01883 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=2.674 | 4135.8 samples/s | 64.6 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01814 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=2.678 | 4972.9 samples/s | 77.7 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01711 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.682 | 1773.9 samples/s | 27.7 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01614 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=2.686 | 4126.7 samples/s | 64.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01562 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=2.691 | 4318.7 samples/s | 67.5 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01509 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=2.695 | 4931.8 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.19969 | Reg=0.00169 | acc=0.8594 | L2-Norm=13.018 | L2-Norm(final)=2.665 | 3872.9 samples/s | 60.5 steps/s
[Step=10450 Epoch=50.9] | Loss=0.06002 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.117 | L2-Norm(final)=2.630 | 4143.5 samples/s | 64.7 steps/s
[Step=10500 Epoch=51.2] | Loss=0.04305 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.167 | L2-Norm(final)=2.635 | 4182.2 samples/s | 65.3 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03826 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=2.639 | 4225.0 samples/s | 66.0 steps/s
[Step=10600 Epoch=51.6] | Loss=0.03563 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=2.638 | 5627.4 samples/s | 87.9 steps/s
[Step=10650 Epoch=51.9] | Loss=0.03174 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=2.640 | 1712.6 samples/s | 26.8 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02916 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.264 | L2-Norm(final)=2.644 | 4205.4 samples/s | 65.7 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02706 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.279 | L2-Norm(final)=2.647 | 4168.7 samples/s | 65.1 steps/s
[Step=10800 Epoch=52.6] | Loss=0.02519 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.293 | L2-Norm(final)=2.651 | 5237.3 samples/s | 81.8 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02349 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=2.655 | 1783.6 samples/s | 27.9 steps/s
[Step=10900 Epoch=53.1] | Loss=0.02271 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.317 | L2-Norm(final)=2.658 | 4311.6 samples/s | 67.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.02145 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=2.661 | 4170.8 samples/s | 65.2 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02046 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.338 | L2-Norm(final)=2.665 | 4969.4 samples/s | 77.6 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01963 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=2.668 | 1856.9 samples/s | 29.0 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01874 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=2.672 | 4200.6 samples/s | 65.6 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01831 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.364 | L2-Norm(final)=2.676 | 4257.5 samples/s | 66.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01767 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=2.678 | 4643.6 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.35602 | Reg=0.00169 | acc=0.8281 | L2-Norm=13.018 | L2-Norm(final)=2.664 | 3732.4 samples/s | 58.3 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04533 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.125 | L2-Norm(final)=2.644 | 4176.0 samples/s | 65.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03733 | Reg=0.00173 | acc=0.9531 | L2-Norm=13.167 | L2-Norm(final)=2.644 | 4344.7 samples/s | 67.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03260 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=2.645 | 4211.6 samples/s | 65.8 steps/s
[Step=10600 Epoch=51.7] | Loss=0.03077 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=2.647 | 5888.1 samples/s | 92.0 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02661 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=2.650 | 1721.6 samples/s | 26.9 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02435 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=2.654 | 4261.4 samples/s | 66.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02250 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.657 | 4231.5 samples/s | 66.1 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02131 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=2.661 | 5341.6 samples/s | 83.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01990 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=2.665 | 1787.2 samples/s | 27.9 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01870 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=2.669 | 4288.8 samples/s | 67.0 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01792 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=2.672 | 4264.8 samples/s | 66.6 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01691 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.314 | L2-Norm(final)=2.677 | 4967.0 samples/s | 77.6 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01637 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.322 | L2-Norm(final)=2.680 | 1825.5 samples/s | 28.5 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01577 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=2.684 | 4136.9 samples/s | 64.6 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01506 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=2.688 | 4228.9 samples/s | 66.1 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01481 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=2.691 | 4589.6 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step11200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=51.0] | Loss=0.29175 | Reg=0.00169 | acc=0.7969 | L2-Norm=13.018 | L2-Norm(final)=2.664 | 4104.7 samples/s | 64.1 steps/s
[Step=10450 Epoch=51.2] | Loss=0.04343 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.113 | L2-Norm(final)=2.642 | 3740.5 samples/s | 58.4 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03368 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=2.644 | 4165.4 samples/s | 65.1 steps/s
[Step=10550 Epoch=51.7] | Loss=0.03128 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.186 | L2-Norm(final)=2.645 | 4224.3 samples/s | 66.0 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02900 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.210 | L2-Norm(final)=2.646 | 5942.2 samples/s | 92.8 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02581 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=2.649 | 1732.0 samples/s | 27.1 steps/s
[Step=10700 Epoch=52.5] | Loss=0.02299 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=2.655 | 4259.4 samples/s | 66.6 steps/s
[Step=10750 Epoch=52.7] | Loss=0.02109 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.661 | 4316.5 samples/s | 67.4 steps/s
[Step=10800 Epoch=53.0] | Loss=0.02006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.665 | 5581.0 samples/s | 87.2 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01904 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.669 | 1737.5 samples/s | 27.1 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01811 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.301 | L2-Norm(final)=2.673 | 4207.1 samples/s | 65.7 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01719 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=2.678 | 4196.2 samples/s | 65.6 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01650 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.681 | 5262.8 samples/s | 82.2 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01560 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.329 | L2-Norm(final)=2.685 | 1779.4 samples/s | 27.8 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01503 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.337 | L2-Norm(final)=2.689 | 4273.3 samples/s | 66.8 steps/s
[Step=11150 Epoch=54.7] | Loss=0.01446 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.345 | L2-Norm(final)=2.693 | 4250.6 samples/s | 66.4 steps/s
[Step=11200 Epoch=54.9] | Loss=0.01404 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.352 | L2-Norm(final)=2.697 | 5087.3 samples/s | 79.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.6] | Loss=0.13899 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.018 | L2-Norm(final)=2.663 | 3905.4 samples/s | 61.0 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00867 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=2.634 | 3554.2 samples/s | 55.5 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00485 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=2.636 | 5466.9 samples/s | 85.4 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00326 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=2.639 | 1666.7 samples/s | 26.0 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00245 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=2.642 | 5084.7 samples/s | 79.4 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00196 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=2.643 | 1716.8 samples/s | 26.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00164 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=2.645 | 4683.2 samples/s | 73.2 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00140 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=2.646 | 1759.1 samples/s | 27.5 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00123 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.152 | L2-Norm(final)=2.647 | 4282.5 samples/s | 66.9 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00109 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.648 | 1812.1 samples/s | 28.3 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00098 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=2.648 | 4055.2 samples/s | 63.4 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00089 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.111 | L2-Norm(final)=2.649 | 1855.0 samples/s | 29.0 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00082 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=2.650 | 4104.4 samples/s | 64.1 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00076 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=2.650 | 1879.1 samples/s | 29.4 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00070 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=2.651 | 4086.1 samples/s | 63.8 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00066 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=2.651 | 1869.9 samples/s | 29.2 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00062 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=2.651 | 4051.0 samples/s | 63.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step11200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.9] | Loss=0.08223 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.018 | L2-Norm(final)=2.664 | 3755.3 samples/s | 58.7 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00306 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=2.667 | 3908.2 samples/s | 61.1 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00616 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.170 | L2-Norm(final)=2.660 | 5520.4 samples/s | 86.3 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00456 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=2.646 | 1670.7 samples/s | 26.1 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00345 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.640 | 5202.2 samples/s | 81.3 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00276 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=2.637 | 1745.5 samples/s | 27.3 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00231 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=2.636 | 4644.4 samples/s | 72.6 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00198 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=2.635 | 1773.6 samples/s | 27.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00173 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=2.635 | 4373.7 samples/s | 68.3 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00154 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=2.635 | 1804.1 samples/s | 28.2 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00139 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=2.635 | 4094.8 samples/s | 64.0 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00126 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.635 | 1877.6 samples/s | 29.3 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00116 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.635 | 4064.1 samples/s | 63.5 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00107 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=2.635 | 1904.1 samples/s | 29.8 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00099 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.636 | 4131.0 samples/s | 64.5 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00093 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=2.636 | 1872.4 samples/s | 29.3 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00087 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=2.637 | 4082.8 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.3] | Loss=0.06470 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.018 | L2-Norm(final)=2.664 | 3642.4 samples/s | 56.9 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00589 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.649 | 3956.4 samples/s | 61.8 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00308 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=2.650 | 5637.5 samples/s | 88.1 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00207 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=2.655 | 1670.2 samples/s | 26.1 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00156 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=2.659 | 5221.0 samples/s | 81.6 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00125 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=2.661 | 1715.4 samples/s | 26.8 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00104 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.663 | 4753.2 samples/s | 74.3 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00089 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.664 | 1745.4 samples/s | 27.3 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00078 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=2.665 | 4509.0 samples/s | 70.5 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00069 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=2.666 | 1778.1 samples/s | 27.8 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00063 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=2.667 | 4255.7 samples/s | 66.5 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00057 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=2.668 | 1828.8 samples/s | 28.6 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00052 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.669 | 4131.2 samples/s | 64.6 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00048 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=2.670 | 1831.0 samples/s | 28.6 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00045 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=2.670 | 4027.1 samples/s | 62.9 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00042 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=2.671 | 1866.9 samples/s | 29.2 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=2.671 | 4033.5 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.0] | Loss=0.00493 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=2.666 | 3773.4 samples/s | 59.0 steps/s
[Step=10450 Epoch=98.5] | Loss=0.00827 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.156 | L2-Norm(final)=2.647 | 3858.8 samples/s | 60.3 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00460 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=2.637 | 5510.2 samples/s | 86.1 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00313 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.637 | 1682.6 samples/s | 26.3 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00235 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=2.639 | 4984.4 samples/s | 77.9 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00190 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.640 | 1753.4 samples/s | 27.4 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00158 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.642 | 4432.6 samples/s | 69.3 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00136 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=2.643 | 1787.3 samples/s | 27.9 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00119 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=2.645 | 4208.8 samples/s | 65.8 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00106 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.646 | 1858.8 samples/s | 29.0 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00095 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=2.647 | 4198.4 samples/s | 65.6 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00087 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.647 | 1880.3 samples/s | 29.4 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00079 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=2.648 | 4110.0 samples/s | 64.2 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00073 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=2.649 | 1867.0 samples/s | 29.2 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00068 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=2.650 | 3990.6 samples/s | 62.4 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00064 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.159 | L2-Norm(final)=2.650 | 2016.1 samples/s | 31.5 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00060 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=2.651 | 3603.4 samples/s | 56.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.1] | Loss=0.01874 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.018 | L2-Norm(final)=2.666 | 3790.3 samples/s | 59.2 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00686 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=2.641 | 3835.3 samples/s | 59.9 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00475 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=2.646 | 5677.8 samples/s | 88.7 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00345 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=2.649 | 1654.2 samples/s | 25.8 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00262 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.651 | 5113.4 samples/s | 79.9 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00211 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.654 | 1729.4 samples/s | 27.0 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00176 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=2.657 | 4798.0 samples/s | 75.0 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00151 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=2.659 | 1745.7 samples/s | 27.3 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00132 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=2.660 | 4678.1 samples/s | 73.1 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00117 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=2.662 | 1815.6 samples/s | 28.4 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00106 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=2.663 | 4277.5 samples/s | 66.8 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00096 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=2.664 | 1832.2 samples/s | 28.6 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00088 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=2.665 | 4019.0 samples/s | 62.8 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00081 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.165 | L2-Norm(final)=2.665 | 1878.7 samples/s | 29.4 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00076 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=2.666 | 4180.6 samples/s | 65.3 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00071 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.667 | 1865.1 samples/s | 29.1 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00066 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.668 | 4170.9 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38116 | acc=0.7797 | tpr=0.6815 | fpr=0.0072 | 3823.9 samples/s | 14.9 steps/s
Avg test loss: 0.38108, Avg test acc: 0.77683, Avg tpr: 0.67937, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.23166 | acc=0.9144 | tpr=0.9690 | fpr=0.0866 | 3774.4 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.23426 | acc=0.9158 | tpr=0.9765 | fpr=0.0854 | 7224.4 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.23775 | acc=0.9140 | tpr=0.9741 | fpr=0.0871 | 7166.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.23895 | acc=0.9143 | tpr=0.9749 | fpr=0.0868 | 7195.3 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.23694 | acc=0.9145 | tpr=0.9738 | fpr=0.0865 | 7007.4 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.23800 | acc=0.9141 | tpr=0.9745 | fpr=0.0870 | 7120.9 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.23954 | acc=0.9139 | tpr=0.9737 | fpr=0.0872 | 7315.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.24026 | acc=0.9140 | tpr=0.9737 | fpr=0.0871 | 7034.4 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.24246 | acc=0.9141 | tpr=0.9752 | fpr=0.0870 | 6847.1 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.24180 | acc=0.9139 | tpr=0.9762 | fpr=0.0872 | 7312.0 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.24054 | acc=0.9143 | tpr=0.9749 | fpr=0.0868 | 12964.4 samples/s | 50.6 steps/s
Avg test loss: 0.24036, Avg test acc: 0.91431, Avg tpr: 0.97464, Avg fpr: 0.08679, total FA: 12050

server round 14/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.30097 | Reg=0.00167 | acc=0.7969 | L2-Norm=12.936 | L2-Norm(final)=2.697 | 3987.5 samples/s | 62.3 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04218 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.682 | 4197.6 samples/s | 65.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03664 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.097 | L2-Norm(final)=2.683 | 4280.3 samples/s | 66.9 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03166 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=2.685 | 4366.3 samples/s | 68.2 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02888 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.148 | L2-Norm(final)=2.688 | 5862.5 samples/s | 91.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02575 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=2.693 | 1747.6 samples/s | 27.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02288 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=2.698 | 4342.8 samples/s | 67.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02092 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.197 | L2-Norm(final)=2.705 | 4313.6 samples/s | 67.4 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01984 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=2.710 | 5383.9 samples/s | 84.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01887 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=2.714 | 1808.1 samples/s | 28.3 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01783 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=2.718 | 4247.6 samples/s | 66.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01716 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=2.722 | 4298.3 samples/s | 67.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01662 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=2.725 | 4904.5 samples/s | 76.6 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01576 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=2.729 | 1836.0 samples/s | 28.7 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01557 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.260 | L2-Norm(final)=2.733 | 4258.5 samples/s | 66.5 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01489 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.267 | L2-Norm(final)=2.736 | 4292.8 samples/s | 67.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01468 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=2.739 | 4729.6 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.7] | Loss=0.32931 | Reg=0.00167 | acc=0.8281 | L2-Norm=12.936 | L2-Norm(final)=2.697 | 4104.6 samples/s | 64.1 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04636 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.045 | L2-Norm(final)=2.679 | 3828.9 samples/s | 59.8 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03694 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.089 | L2-Norm(final)=2.676 | 4328.3 samples/s | 67.6 steps/s
[Step=11350 Epoch=55.4] | Loss=0.03190 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=2.679 | 4184.3 samples/s | 65.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.03112 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.141 | L2-Norm(final)=2.680 | 5830.0 samples/s | 91.1 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02760 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=2.682 | 1728.5 samples/s | 27.0 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02501 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=2.687 | 4239.5 samples/s | 66.2 steps/s
[Step=11550 Epoch=56.4] | Loss=0.02336 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=2.692 | 4275.6 samples/s | 66.8 steps/s
[Step=11600 Epoch=56.6] | Loss=0.02224 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.212 | L2-Norm(final)=2.696 | 5440.9 samples/s | 85.0 steps/s
[Step=11650 Epoch=56.8] | Loss=0.02081 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=2.700 | 1793.7 samples/s | 28.0 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01959 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.237 | L2-Norm(final)=2.705 | 4278.4 samples/s | 66.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01865 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=2.709 | 4262.9 samples/s | 66.6 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01794 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.258 | L2-Norm(final)=2.713 | 5118.7 samples/s | 80.0 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01725 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.268 | L2-Norm(final)=2.717 | 1844.0 samples/s | 28.8 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01679 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=2.720 | 4280.1 samples/s | 66.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01607 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=2.724 | 4167.4 samples/s | 65.1 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01548 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=2.728 | 4813.0 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.15059 | Reg=0.00167 | acc=0.8906 | L2-Norm=12.936 | L2-Norm(final)=2.698 | 3805.8 samples/s | 59.5 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04940 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.041 | L2-Norm(final)=2.677 | 4198.7 samples/s | 65.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03750 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=2.677 | 4353.7 samples/s | 68.0 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03349 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.110 | L2-Norm(final)=2.683 | 4361.9 samples/s | 68.2 steps/s
[Step=11400 Epoch=55.5] | Loss=0.03139 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.132 | L2-Norm(final)=2.685 | 5886.7 samples/s | 92.0 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02798 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.151 | L2-Norm(final)=2.689 | 1774.3 samples/s | 27.7 steps/s
[Step=11500 Epoch=56.0] | Loss=0.02568 | Reg=0.00173 | acc=0.9531 | L2-Norm=13.167 | L2-Norm(final)=2.694 | 4323.6 samples/s | 67.6 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02354 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.181 | L2-Norm(final)=2.699 | 4299.9 samples/s | 67.2 steps/s
[Step=11600 Epoch=56.5] | Loss=0.02235 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=2.704 | 5310.1 samples/s | 83.0 steps/s
[Step=11650 Epoch=56.8] | Loss=0.02088 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.205 | L2-Norm(final)=2.708 | 1769.3 samples/s | 27.6 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01985 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.713 | 4394.7 samples/s | 68.7 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01881 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=2.718 | 4306.5 samples/s | 67.3 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01796 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=2.722 | 5003.2 samples/s | 78.2 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01730 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.727 | 1853.0 samples/s | 29.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01655 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=2.731 | 4331.6 samples/s | 67.7 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01583 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.259 | L2-Norm(final)=2.735 | 4284.8 samples/s | 66.9 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01537 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=2.739 | 4622.0 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.21865 | Reg=0.00167 | acc=0.8281 | L2-Norm=12.936 | L2-Norm(final)=2.697 | 3848.3 samples/s | 60.1 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04235 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.058 | L2-Norm(final)=2.678 | 4221.7 samples/s | 66.0 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03523 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=2.682 | 4335.7 samples/s | 67.7 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03166 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.135 | L2-Norm(final)=2.683 | 4332.0 samples/s | 67.7 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02925 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.158 | L2-Norm(final)=2.686 | 5799.1 samples/s | 90.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02594 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=2.690 | 1761.3 samples/s | 27.5 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02362 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=2.695 | 4454.4 samples/s | 69.6 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02176 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=2.699 | 4299.5 samples/s | 67.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.02091 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.216 | L2-Norm(final)=2.703 | 5484.7 samples/s | 85.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01962 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=2.708 | 1806.1 samples/s | 28.2 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01855 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=2.712 | 4242.3 samples/s | 66.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01762 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.716 | 4234.0 samples/s | 66.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01672 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.252 | L2-Norm(final)=2.720 | 5021.4 samples/s | 78.5 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01605 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.259 | L2-Norm(final)=2.725 | 1828.1 samples/s | 28.6 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01540 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=2.729 | 4259.7 samples/s | 66.6 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01468 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.272 | L2-Norm(final)=2.734 | 4268.2 samples/s | 66.7 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01432 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.279 | L2-Norm(final)=2.738 | 4740.3 samples/s | 74.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.9] | Loss=0.32072 | Reg=0.00167 | acc=0.7969 | L2-Norm=12.936 | L2-Norm(final)=2.696 | 3711.3 samples/s | 58.0 steps/s
[Step=11250 Epoch=55.2] | Loss=0.05350 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.049 | L2-Norm(final)=2.664 | 4313.1 samples/s | 67.4 steps/s
[Step=11300 Epoch=55.4] | Loss=0.03904 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.097 | L2-Norm(final)=2.666 | 4394.5 samples/s | 68.7 steps/s
[Step=11350 Epoch=55.7] | Loss=0.03241 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.672 | 4283.5 samples/s | 66.9 steps/s
[Step=11400 Epoch=55.9] | Loss=0.03009 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.150 | L2-Norm(final)=2.679 | 5868.9 samples/s | 91.7 steps/s
[Step=11450 Epoch=56.1] | Loss=0.02653 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.170 | L2-Norm(final)=2.684 | 1725.9 samples/s | 27.0 steps/s
[Step=11500 Epoch=56.4] | Loss=0.02418 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.187 | L2-Norm(final)=2.689 | 4210.1 samples/s | 65.8 steps/s
[Step=11550 Epoch=56.6] | Loss=0.02267 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=2.693 | 4287.5 samples/s | 67.0 steps/s
[Step=11600 Epoch=56.9] | Loss=0.02105 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=2.698 | 5515.2 samples/s | 86.2 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01969 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=2.702 | 1771.2 samples/s | 27.7 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01831 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=2.707 | 4282.8 samples/s | 66.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01763 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.245 | L2-Norm(final)=2.711 | 4293.2 samples/s | 67.1 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01680 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=2.716 | 5347.7 samples/s | 83.6 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01609 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=2.720 | 1800.9 samples/s | 28.1 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01538 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.724 | 4253.8 samples/s | 66.5 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01471 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=2.728 | 4332.2 samples/s | 67.7 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01423 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.285 | L2-Norm(final)=2.733 | 5119.3 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.1] | Loss=0.00943 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=2.699 | 3919.2 samples/s | 61.2 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00521 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.003 | L2-Norm(final)=2.726 | 3843.5 samples/s | 60.1 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00442 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=2.715 | 5597.3 samples/s | 87.5 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00341 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.711 | 1701.8 samples/s | 26.6 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00258 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=2.711 | 5235.4 samples/s | 81.8 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00206 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=2.712 | 1695.6 samples/s | 26.5 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00172 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=2.713 | 4676.1 samples/s | 73.1 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00148 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=2.714 | 1788.5 samples/s | 27.9 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00130 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=2.714 | 4594.8 samples/s | 71.8 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00115 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=2.715 | 1821.2 samples/s | 28.5 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00104 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.113 | L2-Norm(final)=2.716 | 4068.4 samples/s | 63.6 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00094 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=2.717 | 1846.2 samples/s | 28.8 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00087 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=2.718 | 4018.8 samples/s | 62.8 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00080 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=2.718 | 1870.6 samples/s | 29.2 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00074 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=2.719 | 4068.1 samples/s | 63.6 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00069 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=2.720 | 1891.3 samples/s | 29.6 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00065 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=2.720 | 4005.8 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.5] | Loss=0.01277 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.936 | L2-Norm(final)=2.700 | 3962.5 samples/s | 61.9 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00216 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=2.714 | 3686.9 samples/s | 57.6 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00113 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=2.724 | 5573.4 samples/s | 87.1 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00076 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=2.730 | 1652.3 samples/s | 25.8 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00057 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=2.733 | 5124.5 samples/s | 80.1 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00046 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=2.736 | 1720.8 samples/s | 26.9 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00038 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=2.738 | 4739.8 samples/s | 74.1 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00033 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=2.739 | 1749.0 samples/s | 27.3 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00029 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=2.741 | 4394.4 samples/s | 68.7 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00026 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=2.742 | 1814.2 samples/s | 28.3 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00023 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=2.743 | 4006.8 samples/s | 62.6 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00021 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=2.744 | 1822.0 samples/s | 28.5 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=2.745 | 4156.6 samples/s | 64.9 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=2.746 | 1893.3 samples/s | 29.6 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=2.746 | 4089.9 samples/s | 63.9 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00016 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=2.747 | 1891.6 samples/s | 29.6 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00015 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=2.748 | 4093.4 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=107.0] | Loss=0.02343 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.936 | L2-Norm(final)=2.699 | 3811.9 samples/s | 59.6 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00264 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=2.710 | 3690.5 samples/s | 57.7 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00135 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=2.718 | 5533.4 samples/s | 86.5 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00091 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=2.723 | 1668.0 samples/s | 26.1 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00068 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=2.726 | 5204.7 samples/s | 81.3 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00055 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=2.729 | 1699.1 samples/s | 26.5 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00046 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=2.731 | 4879.4 samples/s | 76.2 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=2.733 | 1755.2 samples/s | 27.4 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00034 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=2.734 | 4613.3 samples/s | 72.1 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00031 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=2.736 | 1761.9 samples/s | 27.5 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00028 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=2.737 | 4333.1 samples/s | 67.7 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00025 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=2.739 | 1828.6 samples/s | 28.6 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00023 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=2.740 | 4141.2 samples/s | 64.7 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=2.741 | 1844.2 samples/s | 28.8 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00020 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=2.742 | 4107.4 samples/s | 64.2 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=2.743 | 1857.5 samples/s | 29.0 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00017 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=2.744 | 4000.6 samples/s | 62.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=105.5] | Loss=0.04555 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.936 | L2-Norm(final)=2.696 | 3697.2 samples/s | 57.8 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00524 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.028 | L2-Norm(final)=2.683 | 3710.6 samples/s | 58.0 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00405 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=2.689 | 5490.9 samples/s | 85.8 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00307 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=2.686 | 1684.2 samples/s | 26.3 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00231 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=2.687 | 4981.0 samples/s | 77.8 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00186 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.688 | 1754.6 samples/s | 27.4 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00155 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.689 | 4536.8 samples/s | 70.9 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00133 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=2.690 | 1757.6 samples/s | 27.5 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00116 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=2.690 | 4138.7 samples/s | 64.7 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00103 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=2.691 | 1850.4 samples/s | 28.9 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00093 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=2.692 | 4120.3 samples/s | 64.4 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00085 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=2.692 | 1901.7 samples/s | 29.7 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00078 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=2.693 | 4186.9 samples/s | 65.4 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00072 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=2.694 | 1913.9 samples/s | 29.9 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00067 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=2.694 | 4053.9 samples/s | 63.3 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00062 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.695 | 1937.3 samples/s | 30.3 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00058 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=2.695 | 3747.5 samples/s | 58.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.8] | Loss=0.01562 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.936 | L2-Norm(final)=2.699 | 3962.2 samples/s | 61.9 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00232 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.707 | 3563.3 samples/s | 55.7 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00138 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.717 | 5581.0 samples/s | 87.2 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00095 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=2.724 | 1656.1 samples/s | 25.9 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00071 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=2.728 | 5191.9 samples/s | 81.1 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00057 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=2.731 | 1707.6 samples/s | 26.7 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00048 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=2.734 | 4842.7 samples/s | 75.7 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00041 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=2.736 | 1761.8 samples/s | 27.5 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00036 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=2.737 | 4485.9 samples/s | 70.1 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00032 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=2.738 | 1763.7 samples/s | 27.6 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00029 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=2.739 | 4318.5 samples/s | 67.5 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00026 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=2.740 | 1802.1 samples/s | 28.2 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00024 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=2.741 | 4065.7 samples/s | 63.5 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00022 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.742 | 1818.3 samples/s | 28.4 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00021 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=2.742 | 3966.4 samples/s | 62.0 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00019 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=2.743 | 1860.1 samples/s | 29.1 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=2.744 | 4062.0 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35879 | acc=0.8092 | tpr=0.7254 | fpr=0.0087 | 2810.5 samples/s | 11.0 steps/s
Avg test loss: 0.35820, Avg test acc: 0.80627, Avg tpr: 0.72338, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.27430 | acc=0.9002 | tpr=0.9646 | fpr=0.1009 | 3763.3 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.27684 | acc=0.9013 | tpr=0.9744 | fpr=0.1000 | 7069.0 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.28055 | acc=0.9003 | tpr=0.9726 | fpr=0.1010 | 7094.0 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.28185 | acc=0.9002 | tpr=0.9749 | fpr=0.1012 | 7426.5 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.27947 | acc=0.9007 | tpr=0.9738 | fpr=0.1006 | 6721.6 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.28047 | acc=0.9005 | tpr=0.9745 | fpr=0.1008 | 7246.2 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.28222 | acc=0.9001 | tpr=0.9731 | fpr=0.1012 | 7095.5 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.28289 | acc=0.9002 | tpr=0.9721 | fpr=0.1011 | 7021.9 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.28534 | acc=0.9003 | tpr=0.9737 | fpr=0.1011 | 7042.0 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.28485 | acc=0.9000 | tpr=0.9749 | fpr=0.1014 | 7134.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.28311 | acc=0.9005 | tpr=0.9733 | fpr=0.1008 | 12930.2 samples/s | 50.5 steps/s
Avg test loss: 0.28300, Avg test acc: 0.90048, Avg tpr: 0.97306, Avg fpr: 0.10084, total FA: 14002

server round 15/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.22584 | Reg=0.00165 | acc=0.8594 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3954.9 samples/s | 61.8 steps/s
[Step=12050 Epoch=58.8] | Loss=0.05122 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=2.720 | 3909.6 samples/s | 61.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.04201 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=2.714 | 4221.1 samples/s | 66.0 steps/s
[Step=12150 Epoch=59.2] | Loss=0.03554 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.032 | L2-Norm(final)=2.718 | 4183.1 samples/s | 65.4 steps/s
[Step=12200 Epoch=59.5] | Loss=0.03119 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.055 | L2-Norm(final)=2.724 | 5735.9 samples/s | 89.6 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02729 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.073 | L2-Norm(final)=2.729 | 1724.1 samples/s | 26.9 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02413 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=2.735 | 4150.7 samples/s | 64.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02297 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=2.740 | 4246.4 samples/s | 66.4 steps/s
[Step=12400 Epoch=60.5] | Loss=0.02168 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.113 | L2-Norm(final)=2.744 | 5234.7 samples/s | 81.8 steps/s
[Step=12450 Epoch=60.7] | Loss=0.02020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.123 | L2-Norm(final)=2.748 | 1775.5 samples/s | 27.7 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01907 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=2.753 | 4221.3 samples/s | 66.0 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01807 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.142 | L2-Norm(final)=2.758 | 4150.2 samples/s | 64.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01743 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=2.762 | 4998.1 samples/s | 78.1 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01655 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.159 | L2-Norm(final)=2.767 | 1843.8 samples/s | 28.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01602 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=2.771 | 4154.1 samples/s | 64.9 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01546 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=2.774 | 4160.4 samples/s | 65.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01507 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=2.777 | 4543.0 samples/s | 71.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.28326 | Reg=0.00165 | acc=0.8125 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3641.3 samples/s | 56.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03741 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.945 | L2-Norm(final)=2.739 | 4119.5 samples/s | 64.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03078 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.990 | L2-Norm(final)=2.744 | 4254.1 samples/s | 66.5 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02936 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.018 | L2-Norm(final)=2.744 | 4180.6 samples/s | 65.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02837 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.042 | L2-Norm(final)=2.746 | 5838.2 samples/s | 91.2 steps/s
[Step=12250 Epoch=59.8] | Loss=0.02552 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=2.749 | 1735.1 samples/s | 27.1 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02293 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=2.753 | 4253.6 samples/s | 66.5 steps/s
[Step=12350 Epoch=60.3] | Loss=0.02089 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=2.759 | 4142.3 samples/s | 64.7 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01924 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.110 | L2-Norm(final)=2.765 | 5367.1 samples/s | 83.9 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01811 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.122 | L2-Norm(final)=2.770 | 1762.1 samples/s | 27.5 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01728 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=2.775 | 4178.9 samples/s | 65.3 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01664 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.143 | L2-Norm(final)=2.779 | 4256.2 samples/s | 66.5 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01602 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=2.782 | 5070.9 samples/s | 79.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01517 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=2.787 | 1797.8 samples/s | 28.1 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01447 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=2.791 | 4270.1 samples/s | 66.7 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01410 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.180 | L2-Norm(final)=2.795 | 4277.7 samples/s | 66.8 steps/s
[Step=12800 Epoch=62.5] | Loss=0.01374 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.187 | L2-Norm(final)=2.799 | 4709.6 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.34016 | Reg=0.00165 | acc=0.8125 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3957.3 samples/s | 61.8 steps/s
[Step=12050 Epoch=58.7] | Loss=0.05599 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.965 | L2-Norm(final)=2.725 | 3898.7 samples/s | 60.9 steps/s
[Step=12100 Epoch=59.0] | Loss=0.04199 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.015 | L2-Norm(final)=2.728 | 4236.6 samples/s | 66.2 steps/s
[Step=12150 Epoch=59.2] | Loss=0.03682 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=2.731 | 4385.7 samples/s | 68.5 steps/s
[Step=12200 Epoch=59.4] | Loss=0.03266 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.067 | L2-Norm(final)=2.734 | 5911.5 samples/s | 92.4 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02906 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=2.738 | 1742.7 samples/s | 27.2 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02622 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.101 | L2-Norm(final)=2.744 | 4209.0 samples/s | 65.8 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02439 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=2.750 | 4332.9 samples/s | 67.7 steps/s
[Step=12400 Epoch=60.4] | Loss=0.02336 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.128 | L2-Norm(final)=2.755 | 5304.9 samples/s | 82.9 steps/s
[Step=12450 Epoch=60.7] | Loss=0.02196 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.759 | 1761.7 samples/s | 27.5 steps/s
[Step=12500 Epoch=60.9] | Loss=0.02068 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=2.764 | 4269.1 samples/s | 66.7 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01990 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=2.768 | 4259.6 samples/s | 66.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01893 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.166 | L2-Norm(final)=2.773 | 4904.3 samples/s | 76.6 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01801 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=2.777 | 1826.8 samples/s | 28.5 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01726 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=2.782 | 4193.5 samples/s | 65.5 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01670 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=2.786 | 4160.7 samples/s | 65.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01618 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.196 | L2-Norm(final)=2.791 | 4641.4 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.20244 | Reg=0.00165 | acc=0.8750 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3861.2 samples/s | 60.3 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04527 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.977 | L2-Norm(final)=2.732 | 4062.5 samples/s | 63.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03352 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=2.738 | 4122.2 samples/s | 64.4 steps/s
[Step=12150 Epoch=59.3] | Loss=0.03058 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.059 | L2-Norm(final)=2.743 | 4098.5 samples/s | 64.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02661 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=2.746 | 5699.4 samples/s | 89.1 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02431 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=2.749 | 1720.8 samples/s | 26.9 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02285 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.110 | L2-Norm(final)=2.752 | 4200.5 samples/s | 65.6 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02124 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.124 | L2-Norm(final)=2.754 | 4260.0 samples/s | 66.6 steps/s
[Step=12400 Epoch=60.5] | Loss=0.02005 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=2.757 | 5282.0 samples/s | 82.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01892 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=2.760 | 1777.6 samples/s | 27.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01767 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=2.764 | 4195.5 samples/s | 65.6 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01665 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=2.768 | 4225.6 samples/s | 66.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01624 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.174 | L2-Norm(final)=2.772 | 4878.3 samples/s | 76.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01566 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=2.775 | 1842.6 samples/s | 28.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01487 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=2.779 | 4245.0 samples/s | 66.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01427 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=2.783 | 4198.0 samples/s | 65.6 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01401 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=2.786 | 4590.3 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.9] | Loss=0.14431 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.845 | L2-Norm(final)=2.764 | 3959.5 samples/s | 61.9 steps/s
[Step=12050 Epoch=59.1] | Loss=0.03735 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.958 | L2-Norm(final)=2.741 | 3853.6 samples/s | 60.2 steps/s
[Step=12100 Epoch=59.3] | Loss=0.03081 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.002 | L2-Norm(final)=2.741 | 4193.0 samples/s | 65.5 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02825 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.029 | L2-Norm(final)=2.743 | 4168.3 samples/s | 65.1 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02575 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=2.746 | 5845.8 samples/s | 91.3 steps/s
[Step=12250 Epoch=60.1] | Loss=0.02347 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=2.751 | 1707.6 samples/s | 26.7 steps/s
[Step=12300 Epoch=60.3] | Loss=0.02170 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=2.755 | 4183.0 samples/s | 65.4 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01994 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=2.759 | 4209.2 samples/s | 65.8 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01857 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=2.764 | 5535.4 samples/s | 86.5 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01728 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.123 | L2-Norm(final)=2.768 | 1740.1 samples/s | 27.2 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01636 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=2.773 | 4242.9 samples/s | 66.3 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01567 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.142 | L2-Norm(final)=2.777 | 4233.2 samples/s | 66.1 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01523 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=2.780 | 5263.6 samples/s | 82.2 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01443 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=2.783 | 1776.8 samples/s | 27.8 steps/s
[Step=12700 Epoch=62.3] | Loss=0.01364 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.165 | L2-Norm(final)=2.787 | 4217.2 samples/s | 65.9 steps/s
[Step=12750 Epoch=62.5] | Loss=0.01326 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.172 | L2-Norm(final)=2.791 | 4242.0 samples/s | 66.3 steps/s
[Step=12800 Epoch=62.8] | Loss=0.01291 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=2.794 | 5082.8 samples/s | 79.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.01480 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.845 | L2-Norm(final)=2.766 | 3738.9 samples/s | 58.4 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00332 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.956 | L2-Norm(final)=2.772 | 3961.0 samples/s | 61.9 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00206 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=2.782 | 5502.0 samples/s | 86.0 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00189 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=2.787 | 1687.9 samples/s | 26.4 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00165 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=2.788 | 5091.5 samples/s | 79.6 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00134 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=2.792 | 1713.2 samples/s | 26.8 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00112 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=2.795 | 4711.0 samples/s | 73.6 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00096 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=2.797 | 1778.7 samples/s | 27.8 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00084 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=2.799 | 4368.5 samples/s | 68.3 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00075 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=2.801 | 1797.0 samples/s | 28.1 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00068 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=2.802 | 4115.5 samples/s | 64.3 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00061 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=2.804 | 1852.2 samples/s | 28.9 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00056 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=2.805 | 3971.9 samples/s | 62.1 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00052 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=2.806 | 1877.5 samples/s | 29.3 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.807 | 4010.9 samples/s | 62.7 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00045 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=2.808 | 1894.3 samples/s | 29.6 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00042 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=2.809 | 3974.0 samples/s | 62.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step12800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.01009 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.766 | 3649.3 samples/s | 57.0 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00703 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.012 | L2-Norm(final)=2.763 | 3881.3 samples/s | 60.6 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00442 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.087 | L2-Norm(final)=2.760 | 5529.0 samples/s | 86.4 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00355 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=2.758 | 1653.5 samples/s | 25.8 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00270 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=2.756 | 5137.2 samples/s | 80.3 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00218 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=2.756 | 1693.6 samples/s | 26.5 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00182 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.756 | 4791.7 samples/s | 74.9 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00156 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.757 | 1749.8 samples/s | 27.3 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00136 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=2.758 | 4393.1 samples/s | 68.6 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00121 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=2.758 | 1792.1 samples/s | 28.0 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00109 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=2.759 | 4153.2 samples/s | 64.9 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00099 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=2.759 | 1790.7 samples/s | 28.0 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00091 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=2.760 | 4006.2 samples/s | 62.6 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00084 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=2.760 | 1876.5 samples/s | 29.3 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00078 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=2.761 | 4058.1 samples/s | 63.4 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00073 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=2.761 | 1887.5 samples/s | 29.5 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00068 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=2.761 | 4009.6 samples/s | 62.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step12800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.01092 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.765 | 4118.8 samples/s | 64.4 steps/s
[Step=12050 Epoch=115.1] | Loss=0.01059 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=2.736 | 3502.8 samples/s | 54.7 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00566 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=2.733 | 5469.0 samples/s | 85.5 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00398 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=2.734 | 1674.4 samples/s | 26.2 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00299 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=2.736 | 5184.4 samples/s | 81.0 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00239 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=2.737 | 1709.4 samples/s | 26.7 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00200 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.739 | 4868.7 samples/s | 76.1 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00171 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.740 | 1753.2 samples/s | 27.4 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00150 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=2.740 | 4625.6 samples/s | 72.3 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00133 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=2.741 | 1760.4 samples/s | 27.5 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00120 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=2.742 | 4330.9 samples/s | 67.7 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00109 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=2.742 | 1790.3 samples/s | 28.0 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00100 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=2.743 | 4111.3 samples/s | 64.2 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00092 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=2.744 | 1837.5 samples/s | 28.7 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00086 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.744 | 4075.1 samples/s | 63.7 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00080 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=2.745 | 1876.6 samples/s | 29.3 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00075 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.031 | L2-Norm(final)=2.745 | 4022.9 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.03691 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3730.2 samples/s | 58.3 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00516 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=2.753 | 3697.9 samples/s | 57.8 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00331 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=2.752 | 5505.7 samples/s | 86.0 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00231 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=2.757 | 1683.3 samples/s | 26.3 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00173 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=2.761 | 4941.1 samples/s | 77.2 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00139 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.763 | 1757.1 samples/s | 27.5 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00116 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=2.765 | 4584.1 samples/s | 71.6 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00100 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=2.767 | 1765.4 samples/s | 27.6 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00087 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.768 | 4260.7 samples/s | 66.6 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00078 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=2.770 | 1830.9 samples/s | 28.6 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00070 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=2.771 | 4165.0 samples/s | 65.1 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00064 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=2.772 | 1919.3 samples/s | 30.0 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00058 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=2.773 | 4031.1 samples/s | 63.0 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00054 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=2.774 | 1894.1 samples/s | 29.6 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00050 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=2.775 | 4072.7 samples/s | 63.6 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00047 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=2.775 | 2039.3 samples/s | 31.9 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00044 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=2.776 | 3656.1 samples/s | 57.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.04269 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.845 | L2-Norm(final)=2.763 | 3642.3 samples/s | 56.9 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00190 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=2.766 | 4049.5 samples/s | 63.3 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00112 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=2.774 | 5661.9 samples/s | 88.5 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00086 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=2.780 | 1686.2 samples/s | 26.3 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00065 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=2.785 | 5157.7 samples/s | 80.6 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00052 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=2.788 | 1702.4 samples/s | 26.6 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00044 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=2.791 | 4659.3 samples/s | 72.8 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00037 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=2.793 | 1724.2 samples/s | 26.9 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=2.794 | 4599.1 samples/s | 71.9 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00029 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=2.795 | 1777.7 samples/s | 27.8 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=2.797 | 4318.5 samples/s | 67.5 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=2.798 | 1823.8 samples/s | 28.5 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00022 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=2.799 | 4168.8 samples/s | 65.1 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00020 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=2.800 | 1831.8 samples/s | 28.6 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=2.800 | 3956.9 samples/s | 61.8 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00018 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=2.801 | 1890.7 samples/s | 29.5 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00017 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=2.802 | 4036.1 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37565 | acc=0.7901 | tpr=0.6977 | fpr=0.0094 | 3766.6 samples/s | 14.7 steps/s
Avg test loss: 0.37625, Avg test acc: 0.78540, Avg tpr: 0.69295, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.24667 | acc=0.9133 | tpr=0.9690 | fpr=0.0877 | 3736.7 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.24936 | acc=0.9134 | tpr=0.9765 | fpr=0.0878 | 7280.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.25360 | acc=0.9120 | tpr=0.9784 | fpr=0.0892 | 7259.2 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.25461 | acc=0.9118 | tpr=0.9803 | fpr=0.0894 | 7062.6 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.25257 | acc=0.9123 | tpr=0.9782 | fpr=0.0889 | 7190.7 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.25392 | acc=0.9121 | tpr=0.9782 | fpr=0.0891 | 7096.9 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.25579 | acc=0.9120 | tpr=0.9768 | fpr=0.0892 | 7196.9 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.25678 | acc=0.9119 | tpr=0.9776 | fpr=0.0893 | 7045.5 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.25919 | acc=0.9118 | tpr=0.9786 | fpr=0.0894 | 6957.3 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.25885 | acc=0.9118 | tpr=0.9793 | fpr=0.0894 | 7399.4 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.25733 | acc=0.9122 | tpr=0.9785 | fpr=0.0890 | 12637.3 samples/s | 49.4 steps/s
Avg test loss: 0.25713, Avg test acc: 0.91217, Avg tpr: 0.97861, Avg fpr: 0.08903, total FA: 12362

server round 16/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.29760 | Reg=0.00164 | acc=0.8594 | L2-Norm=12.796 | L2-Norm(final)=2.811 | 3962.5 samples/s | 61.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04913 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.933 | L2-Norm(final)=2.783 | 3925.3 samples/s | 61.3 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03984 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=2.777 | 4216.3 samples/s | 65.9 steps/s
[Step=12950 Epoch=63.1] | Loss=0.03495 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=2.778 | 4187.9 samples/s | 65.4 steps/s
[Step=13000 Epoch=63.4] | Loss=0.03043 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=2.781 | 5619.7 samples/s | 87.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02692 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.787 | 1734.5 samples/s | 27.1 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02404 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.071 | L2-Norm(final)=2.792 | 4179.6 samples/s | 65.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02262 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.084 | L2-Norm(final)=2.797 | 4147.2 samples/s | 64.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02118 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=2.801 | 5261.7 samples/s | 82.2 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01969 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=2.805 | 1789.4 samples/s | 28.0 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01874 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=2.809 | 4257.6 samples/s | 66.5 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01795 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.813 | 4288.7 samples/s | 67.0 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01712 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.134 | L2-Norm(final)=2.817 | 4977.6 samples/s | 77.8 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01626 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=2.820 | 1847.9 samples/s | 28.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01564 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.150 | L2-Norm(final)=2.824 | 4251.9 samples/s | 66.4 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01535 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.157 | L2-Norm(final)=2.827 | 4251.7 samples/s | 66.4 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01494 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=2.830 | 4578.8 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.5] | Loss=0.23771 | Reg=0.00164 | acc=0.8750 | L2-Norm=12.796 | L2-Norm(final)=2.812 | 4075.8 samples/s | 63.7 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04327 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.908 | L2-Norm(final)=2.784 | 3631.9 samples/s | 56.7 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03561 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.954 | L2-Norm(final)=2.786 | 4221.0 samples/s | 66.0 steps/s
[Step=12950 Epoch=63.2] | Loss=0.03220 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=2.786 | 4236.9 samples/s | 66.2 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02883 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.003 | L2-Norm(final)=2.787 | 5813.4 samples/s | 90.8 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02550 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=2.790 | 1709.9 samples/s | 26.7 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02290 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.035 | L2-Norm(final)=2.795 | 4207.9 samples/s | 65.7 steps/s
[Step=13150 Epoch=64.2] | Loss=0.02120 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.799 | 4232.9 samples/s | 66.1 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01956 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=2.805 | 5337.0 samples/s | 83.4 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01871 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.071 | L2-Norm(final)=2.809 | 1755.4 samples/s | 27.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01780 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.082 | L2-Norm(final)=2.814 | 4359.1 samples/s | 68.1 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01711 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.094 | L2-Norm(final)=2.818 | 4277.2 samples/s | 66.8 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01639 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=2.823 | 5166.9 samples/s | 80.7 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01557 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=2.827 | 1810.9 samples/s | 28.3 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01511 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.123 | L2-Norm(final)=2.831 | 4354.6 samples/s | 68.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01458 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.834 | 4196.2 samples/s | 65.6 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01407 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=2.838 | 4759.7 samples/s | 74.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.37150 | Reg=0.00164 | acc=0.8594 | L2-Norm=12.796 | L2-Norm(final)=2.810 | 3741.0 samples/s | 58.5 steps/s
[Step=12850 Epoch=62.6] | Loss=0.05000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=2.780 | 4151.1 samples/s | 64.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03906 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=2.784 | 4183.4 samples/s | 65.4 steps/s
[Step=12950 Epoch=63.1] | Loss=0.03233 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.987 | L2-Norm(final)=2.791 | 4153.3 samples/s | 64.9 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02963 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.009 | L2-Norm(final)=2.798 | 5754.4 samples/s | 89.9 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02591 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=2.803 | 1734.6 samples/s | 27.1 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02441 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=2.808 | 4245.4 samples/s | 66.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02299 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.060 | L2-Norm(final)=2.812 | 4271.3 samples/s | 66.7 steps/s
[Step=13200 Epoch=64.3] | Loss=0.02119 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.073 | L2-Norm(final)=2.817 | 5274.6 samples/s | 82.4 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01971 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.084 | L2-Norm(final)=2.822 | 1792.3 samples/s | 28.0 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01886 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.095 | L2-Norm(final)=2.826 | 4372.0 samples/s | 68.3 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01803 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=2.830 | 4216.6 samples/s | 65.9 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01725 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=2.834 | 4842.2 samples/s | 75.7 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01660 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=2.839 | 1840.3 samples/s | 28.8 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01601 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.130 | L2-Norm(final)=2.842 | 4224.2 samples/s | 66.0 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01551 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=2.846 | 4281.9 samples/s | 66.9 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01503 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.144 | L2-Norm(final)=2.850 | 4685.1 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.27709 | Reg=0.00164 | acc=0.8438 | L2-Norm=12.796 | L2-Norm(final)=2.812 | 4124.1 samples/s | 64.4 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04093 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.912 | L2-Norm(final)=2.789 | 3878.3 samples/s | 60.6 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03284 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.958 | L2-Norm(final)=2.791 | 4213.6 samples/s | 65.8 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02827 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.986 | L2-Norm(final)=2.796 | 4240.4 samples/s | 66.3 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02647 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.007 | L2-Norm(final)=2.798 | 5790.7 samples/s | 90.5 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02353 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=2.801 | 1729.9 samples/s | 27.0 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02181 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=2.806 | 4283.7 samples/s | 66.9 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02097 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=2.810 | 4239.0 samples/s | 66.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01949 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=2.813 | 5372.6 samples/s | 83.9 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01821 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=2.818 | 1767.4 samples/s | 27.6 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01730 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=2.822 | 4273.0 samples/s | 66.8 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01646 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.095 | L2-Norm(final)=2.826 | 4205.0 samples/s | 65.7 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01578 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=2.830 | 4969.5 samples/s | 77.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01503 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.111 | L2-Norm(final)=2.834 | 1812.4 samples/s | 28.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01460 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=2.838 | 4375.2 samples/s | 68.4 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01401 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.125 | L2-Norm(final)=2.842 | 4316.6 samples/s | 67.4 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01353 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.845 | 4688.4 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step13600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.8] | Loss=0.26031 | Reg=0.00164 | acc=0.8125 | L2-Norm=12.796 | L2-Norm(final)=2.812 | 4015.2 samples/s | 62.7 steps/s
[Step=12850 Epoch=63.0] | Loss=0.04900 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=2.778 | 3919.2 samples/s | 61.2 steps/s
[Step=12900 Epoch=63.3] | Loss=0.03605 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.978 | L2-Norm(final)=2.775 | 4272.2 samples/s | 66.8 steps/s
[Step=12950 Epoch=63.5] | Loss=0.03092 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.010 | L2-Norm(final)=2.779 | 4220.6 samples/s | 65.9 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02780 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.034 | L2-Norm(final)=2.784 | 5903.0 samples/s | 92.2 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02473 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=2.787 | 1720.2 samples/s | 26.9 steps/s
[Step=13100 Epoch=64.2] | Loss=0.02255 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.069 | L2-Norm(final)=2.792 | 4269.0 samples/s | 66.7 steps/s
[Step=13150 Epoch=64.5] | Loss=0.02077 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.083 | L2-Norm(final)=2.797 | 4151.3 samples/s | 64.9 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01982 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=2.801 | 5565.1 samples/s | 87.0 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01900 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=2.805 | 1746.8 samples/s | 27.3 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01777 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.115 | L2-Norm(final)=2.809 | 4165.5 samples/s | 65.1 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01698 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.124 | L2-Norm(final)=2.813 | 4235.9 samples/s | 66.2 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01601 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=2.817 | 5219.1 samples/s | 81.5 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01523 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=2.821 | 1783.3 samples/s | 27.9 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01467 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=2.824 | 4243.8 samples/s | 66.3 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01434 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.150 | L2-Norm(final)=2.827 | 4228.9 samples/s | 66.1 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01377 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=2.830 | 4952.9 samples/s | 77.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.3] | Loss=0.00532 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=2.814 | 3915.5 samples/s | 61.2 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00212 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=2.829 | 3730.5 samples/s | 58.3 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00123 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=2.841 | 5561.4 samples/s | 86.9 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00083 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=2.848 | 1681.1 samples/s | 26.3 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00062 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=2.852 | 5098.9 samples/s | 79.7 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00050 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=2.854 | 1731.5 samples/s | 27.1 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00042 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=2.857 | 4648.4 samples/s | 72.6 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00036 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=2.858 | 1761.3 samples/s | 27.5 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00031 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=2.860 | 4358.4 samples/s | 68.1 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00028 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=2.861 | 1812.0 samples/s | 28.3 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00025 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.862 | 4071.4 samples/s | 63.6 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00023 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=2.863 | 1849.7 samples/s | 28.9 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00021 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=2.864 | 4133.6 samples/s | 64.6 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00019 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=2.865 | 1891.6 samples/s | 29.6 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00018 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=2.865 | 4221.3 samples/s | 66.0 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00017 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=2.866 | 1840.7 samples/s | 28.8 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=2.867 | 3969.9 samples/s | 62.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step13600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.8] | Loss=0.00146 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=2.813 | 3951.6 samples/s | 61.7 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00725 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=2.809 | 3627.6 samples/s | 56.7 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00373 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=2.811 | 5655.6 samples/s | 88.4 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00255 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=2.816 | 1673.2 samples/s | 26.1 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00191 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=2.821 | 5216.2 samples/s | 81.5 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00156 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=2.824 | 1717.6 samples/s | 26.8 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00130 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=2.828 | 4704.0 samples/s | 73.5 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00112 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=2.831 | 1753.5 samples/s | 27.4 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00098 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=2.834 | 4368.8 samples/s | 68.3 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00087 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=2.837 | 1792.7 samples/s | 28.0 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00078 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=2.839 | 4096.6 samples/s | 64.0 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00071 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=2.841 | 1857.5 samples/s | 29.0 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00065 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=2.843 | 4029.8 samples/s | 63.0 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00060 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=2.845 | 1864.1 samples/s | 29.1 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00056 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=2.847 | 4172.6 samples/s | 65.2 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00052 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=2.848 | 1898.9 samples/s | 29.7 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00049 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=2.850 | 4093.2 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.2] | Loss=0.04023 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.796 | L2-Norm(final)=2.812 | 3930.2 samples/s | 61.4 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00392 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=2.803 | 3688.2 samples/s | 57.6 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00203 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=2.810 | 5546.9 samples/s | 86.7 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00136 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=2.814 | 1650.5 samples/s | 25.8 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00102 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=2.817 | 5114.4 samples/s | 79.9 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00082 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=2.818 | 1722.0 samples/s | 26.9 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00068 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=2.820 | 4901.6 samples/s | 76.6 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00059 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=2.821 | 1756.8 samples/s | 27.4 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00051 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=2.822 | 4554.3 samples/s | 71.2 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00046 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=2.823 | 1835.2 samples/s | 28.7 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00041 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=2.824 | 4313.5 samples/s | 67.4 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00038 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=2.824 | 1813.8 samples/s | 28.3 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00034 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=2.825 | 4076.8 samples/s | 63.7 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00032 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=2.826 | 1858.8 samples/s | 29.0 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00030 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=2.826 | 4000.7 samples/s | 62.5 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00028 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=2.827 | 1864.1 samples/s | 29.1 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00026 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=2.827 | 4072.8 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=120.6] | Loss=0.00848 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.796 | L2-Norm(final)=2.813 | 3931.7 samples/s | 61.4 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00504 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=2.802 | 3942.4 samples/s | 61.6 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00332 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=2.808 | 5432.0 samples/s | 84.9 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00435 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=2.804 | 1692.9 samples/s | 26.5 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00351 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=2.798 | 5093.3 samples/s | 79.6 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00281 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=2.796 | 1744.1 samples/s | 27.3 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00235 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=2.796 | 4662.5 samples/s | 72.9 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00201 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=2.795 | 1800.9 samples/s | 28.1 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00176 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=2.795 | 4179.9 samples/s | 65.3 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00157 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=2.796 | 1823.1 samples/s | 28.5 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00141 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.796 | 3996.9 samples/s | 62.5 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00128 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=2.796 | 1890.4 samples/s | 29.5 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00118 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=2.797 | 4152.2 samples/s | 64.9 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00109 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=2.797 | 1885.0 samples/s | 29.5 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00101 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=2.798 | 4007.5 samples/s | 62.6 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00094 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=2.798 | 2038.7 samples/s | 31.9 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00088 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=2.799 | 3698.1 samples/s | 57.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step13600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.0] | Loss=0.02384 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.796 | L2-Norm(final)=2.812 | 3630.3 samples/s | 56.7 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00660 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=2.784 | 4036.8 samples/s | 63.1 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00362 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=2.778 | 5668.7 samples/s | 88.6 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00272 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=2.778 | 1682.8 samples/s | 26.3 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00213 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=2.778 | 5284.7 samples/s | 82.6 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00172 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=2.780 | 1714.6 samples/s | 26.8 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00143 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=2.782 | 4800.7 samples/s | 75.0 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00123 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.784 | 1752.0 samples/s | 27.4 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00108 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=2.785 | 4527.0 samples/s | 70.7 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00096 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.003 | L2-Norm(final)=2.786 | 1766.7 samples/s | 27.6 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00086 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=2.788 | 4320.4 samples/s | 67.5 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00078 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=2.788 | 1813.9 samples/s | 28.3 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00072 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=2.789 | 4125.1 samples/s | 64.5 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00066 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=2.790 | 1883.5 samples/s | 29.4 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00062 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=2.791 | 3990.4 samples/s | 62.4 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00058 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=2.792 | 1854.0 samples/s | 29.0 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00054 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=2.792 | 4212.9 samples/s | 65.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31035 | acc=0.8287 | tpr=0.7545 | fpr=0.0102 | 3804.8 samples/s | 14.9 steps/s
Avg test loss: 0.30916, Avg test acc: 0.82547, Avg tpr: 0.75223, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.29046 | acc=0.8903 | tpr=0.9602 | fpr=0.1109 | 3750.6 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.29426 | acc=0.8914 | tpr=0.9723 | fpr=0.1101 | 7170.6 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.29827 | acc=0.8901 | tpr=0.9712 | fpr=0.1114 | 7249.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.29931 | acc=0.8903 | tpr=0.9749 | fpr=0.1112 | 7169.9 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.29711 | acc=0.8909 | tpr=0.9738 | fpr=0.1106 | 7048.3 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.29872 | acc=0.8909 | tpr=0.9745 | fpr=0.1106 | 7225.0 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.30098 | acc=0.8903 | tpr=0.9737 | fpr=0.1112 | 7451.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.30187 | acc=0.8902 | tpr=0.9743 | fpr=0.1114 | 6867.3 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.30465 | acc=0.8900 | tpr=0.9757 | fpr=0.1115 | 7082.6 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.30452 | acc=0.8898 | tpr=0.9771 | fpr=0.1118 | 6822.1 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.30265 | acc=0.8903 | tpr=0.9761 | fpr=0.1113 | 13147.8 samples/s | 51.4 steps/s
Avg test loss: 0.30257, Avg test acc: 0.89026, Avg tpr: 0.97583, Avg fpr: 0.11129, total FA: 15453

server round 17/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.28307 | Reg=0.00163 | acc=0.8438 | L2-Norm=12.757 | L2-Norm(final)=2.858 | 3721.6 samples/s | 58.2 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04058 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.880 | L2-Norm(final)=2.840 | 4307.3 samples/s | 67.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03343 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=2.838 | 4264.2 samples/s | 66.6 steps/s
[Step=13750 Epoch=67.0] | Loss=0.03014 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=2.839 | 4296.7 samples/s | 67.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02844 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=2.840 | 5779.2 samples/s | 90.3 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02569 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=2.841 | 1753.3 samples/s | 27.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02319 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.002 | L2-Norm(final)=2.844 | 4226.3 samples/s | 66.0 steps/s
[Step=13950 Epoch=68.0] | Loss=0.02093 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.016 | L2-Norm(final)=2.849 | 4232.7 samples/s | 66.1 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01990 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=2.853 | 5364.9 samples/s | 83.8 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01899 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=2.857 | 1783.3 samples/s | 27.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01799 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.049 | L2-Norm(final)=2.860 | 4265.6 samples/s | 66.7 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01711 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.059 | L2-Norm(final)=2.864 | 4269.6 samples/s | 66.7 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01668 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.068 | L2-Norm(final)=2.867 | 4978.1 samples/s | 77.8 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01576 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.076 | L2-Norm(final)=2.870 | 1811.4 samples/s | 28.3 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01511 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=2.873 | 4149.8 samples/s | 64.8 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01465 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.091 | L2-Norm(final)=2.876 | 4162.4 samples/s | 65.0 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01427 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=2.878 | 4596.4 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.4] | Loss=0.17132 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.757 | L2-Norm(final)=2.859 | 3811.6 samples/s | 59.6 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03879 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.868 | L2-Norm(final)=2.833 | 4088.4 samples/s | 63.9 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03302 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=2.836 | 4287.2 samples/s | 67.0 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02888 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.952 | L2-Norm(final)=2.840 | 4086.1 samples/s | 63.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02718 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.977 | L2-Norm(final)=2.843 | 5845.9 samples/s | 91.3 steps/s
[Step=13850 Epoch=67.6] | Loss=0.02433 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=2.846 | 1745.1 samples/s | 27.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02237 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.014 | L2-Norm(final)=2.851 | 4230.3 samples/s | 66.1 steps/s
[Step=13950 Epoch=68.1] | Loss=0.02129 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.028 | L2-Norm(final)=2.855 | 4225.5 samples/s | 66.0 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01963 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=2.860 | 5494.1 samples/s | 85.8 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01834 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.052 | L2-Norm(final)=2.865 | 1778.8 samples/s | 27.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01728 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.063 | L2-Norm(final)=2.869 | 4276.8 samples/s | 66.8 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01664 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=2.873 | 4314.4 samples/s | 67.4 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01585 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.081 | L2-Norm(final)=2.878 | 5000.5 samples/s | 78.1 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01530 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=2.882 | 1811.1 samples/s | 28.3 steps/s
[Step=14300 Epoch=69.8] | Loss=0.01466 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=2.885 | 4183.0 samples/s | 65.4 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01406 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=2.889 | 4223.9 samples/s | 66.0 steps/s
[Step=14400 Epoch=70.3] | Loss=0.01354 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.110 | L2-Norm(final)=2.893 | 4819.8 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.10115 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 3937.8 samples/s | 61.5 steps/s
[Step=13650 Epoch=66.5] | Loss=0.04318 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.870 | L2-Norm(final)=2.840 | 4163.4 samples/s | 65.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03447 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.920 | L2-Norm(final)=2.839 | 4151.9 samples/s | 64.9 steps/s
[Step=13750 Epoch=67.0] | Loss=0.03171 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.947 | L2-Norm(final)=2.838 | 4310.6 samples/s | 67.4 steps/s
[Step=13800 Epoch=67.2] | Loss=0.03053 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.969 | L2-Norm(final)=2.839 | 5839.1 samples/s | 91.2 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02698 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.989 | L2-Norm(final)=2.843 | 1753.9 samples/s | 27.4 steps/s
[Step=13900 Epoch=67.7] | Loss=0.02417 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=2.848 | 4196.9 samples/s | 65.6 steps/s
[Step=13950 Epoch=68.0] | Loss=0.02255 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.853 | 4257.6 samples/s | 66.5 steps/s
[Step=14000 Epoch=68.2] | Loss=0.02131 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.033 | L2-Norm(final)=2.858 | 5398.3 samples/s | 84.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01998 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.044 | L2-Norm(final)=2.862 | 1797.4 samples/s | 28.1 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01896 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=2.866 | 4221.6 samples/s | 66.0 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01808 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=2.870 | 4198.9 samples/s | 65.6 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01723 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=2.875 | 4940.0 samples/s | 77.2 steps/s
[Step=14250 Epoch=69.4] | Loss=0.01642 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.083 | L2-Norm(final)=2.880 | 1823.8 samples/s | 28.5 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01573 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.092 | L2-Norm(final)=2.885 | 4185.9 samples/s | 65.4 steps/s
[Step=14350 Epoch=69.9] | Loss=0.01514 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=2.890 | 4198.4 samples/s | 65.6 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01479 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=2.894 | 4646.1 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.10209 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 4018.2 samples/s | 62.8 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03992 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.879 | L2-Norm(final)=2.842 | 3936.9 samples/s | 61.5 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03232 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=2.846 | 4313.3 samples/s | 67.4 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02732 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.958 | L2-Norm(final)=2.847 | 4208.0 samples/s | 65.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02591 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.977 | L2-Norm(final)=2.847 | 5899.6 samples/s | 92.2 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02298 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.993 | L2-Norm(final)=2.848 | 1755.7 samples/s | 27.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02110 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.007 | L2-Norm(final)=2.852 | 4258.4 samples/s | 66.5 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01963 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.019 | L2-Norm(final)=2.855 | 4215.3 samples/s | 65.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01861 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.029 | L2-Norm(final)=2.858 | 5349.1 samples/s | 83.6 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01765 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=2.861 | 1768.9 samples/s | 27.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01665 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.864 | 4193.6 samples/s | 65.5 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01597 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.867 | 4290.5 samples/s | 67.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01533 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=2.870 | 4978.6 samples/s | 77.8 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01456 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=2.874 | 1830.0 samples/s | 28.6 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01398 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=2.878 | 4280.1 samples/s | 66.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01363 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.082 | L2-Norm(final)=2.882 | 4267.7 samples/s | 66.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01315 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=2.885 | 4594.2 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.7] | Loss=0.24265 | Reg=0.00163 | acc=0.8594 | L2-Norm=12.757 | L2-Norm(final)=2.859 | 3907.4 samples/s | 61.1 steps/s
[Step=13650 Epoch=66.9] | Loss=0.04059 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.853 | L2-Norm(final)=2.835 | 4000.5 samples/s | 62.5 steps/s
[Step=13700 Epoch=67.2] | Loss=0.03374 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.898 | L2-Norm(final)=2.836 | 4147.5 samples/s | 64.8 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02905 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.929 | L2-Norm(final)=2.837 | 4251.3 samples/s | 66.4 steps/s
[Step=13800 Epoch=67.7] | Loss=0.02620 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.952 | L2-Norm(final)=2.838 | 5970.2 samples/s | 93.3 steps/s
[Step=13850 Epoch=67.9] | Loss=0.02314 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=2.843 | 1753.0 samples/s | 27.4 steps/s
[Step=13900 Epoch=68.2] | Loss=0.02026 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.987 | L2-Norm(final)=2.849 | 4243.0 samples/s | 66.3 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01889 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.000 | L2-Norm(final)=2.856 | 4309.0 samples/s | 67.3 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01801 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.011 | L2-Norm(final)=2.860 | 5710.2 samples/s | 89.2 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01704 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.021 | L2-Norm(final)=2.863 | 1763.5 samples/s | 27.6 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01634 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=2.867 | 4318.7 samples/s | 67.5 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01565 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=2.871 | 4197.0 samples/s | 65.6 steps/s
[Step=14200 Epoch=69.6] | Loss=0.01493 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.875 | 5288.4 samples/s | 82.6 steps/s
[Step=14250 Epoch=69.9] | Loss=0.01424 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.879 | 1783.9 samples/s | 27.9 steps/s
[Step=14300 Epoch=70.1] | Loss=0.01357 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.062 | L2-Norm(final)=2.884 | 4262.1 samples/s | 66.6 steps/s
[Step=14350 Epoch=70.4] | Loss=0.01320 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=2.888 | 4199.5 samples/s | 65.6 steps/s
[Step=14400 Epoch=70.6] | Loss=0.01269 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=2.892 | 5069.0 samples/s | 79.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.9] | Loss=0.01983 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 3861.8 samples/s | 60.3 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00264 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=2.878 | 3750.0 samples/s | 58.6 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00239 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.925 | L2-Norm(final)=2.883 | 5554.3 samples/s | 86.8 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00168 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=2.880 | 1665.0 samples/s | 26.0 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00126 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=2.881 | 5080.1 samples/s | 79.4 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00103 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=2.882 | 1729.9 samples/s | 27.0 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00087 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=2.884 | 4781.0 samples/s | 74.7 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00075 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=2.885 | 1760.3 samples/s | 27.5 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00065 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=2.887 | 4330.2 samples/s | 67.7 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00058 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=2.888 | 1819.5 samples/s | 28.4 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00052 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=2.889 | 4197.8 samples/s | 65.6 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00048 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=2.889 | 1834.0 samples/s | 28.7 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00044 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=2.890 | 4108.7 samples/s | 64.2 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00040 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=2.891 | 1890.5 samples/s | 29.5 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00037 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=2.891 | 4192.9 samples/s | 65.5 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00035 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=2.892 | 1888.2 samples/s | 29.5 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00033 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=2.892 | 4038.4 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.4] | Loss=0.07665 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.757 | L2-Norm(final)=2.858 | 3645.8 samples/s | 57.0 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00283 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=2.852 | 3872.5 samples/s | 60.5 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00148 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=2.859 | 5426.3 samples/s | 84.8 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00099 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=2.863 | 1681.1 samples/s | 26.3 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00075 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=2.866 | 5198.5 samples/s | 81.2 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00060 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=2.869 | 1726.7 samples/s | 27.0 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00050 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=2.870 | 4661.0 samples/s | 72.8 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00043 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=2.872 | 1792.7 samples/s | 28.0 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00038 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=2.873 | 4484.6 samples/s | 70.1 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00034 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=2.875 | 1791.1 samples/s | 28.0 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00030 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=2.876 | 4199.7 samples/s | 65.6 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00028 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=2.877 | 1844.2 samples/s | 28.8 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00025 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=2.878 | 4053.5 samples/s | 63.3 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00023 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=2.879 | 1903.3 samples/s | 29.7 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=2.880 | 4129.7 samples/s | 64.5 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=2.881 | 1886.0 samples/s | 29.5 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00019 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=2.882 | 3897.0 samples/s | 60.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.9] | Loss=0.00576 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 3696.6 samples/s | 57.8 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00307 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=2.861 | 3999.6 samples/s | 62.5 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00159 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=2.869 | 5651.2 samples/s | 88.3 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00108 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=2.874 | 1650.8 samples/s | 25.8 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00113 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=2.877 | 5274.8 samples/s | 82.4 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00093 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=2.877 | 1712.1 samples/s | 26.8 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00078 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=2.878 | 4930.2 samples/s | 77.0 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00067 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=2.879 | 1741.9 samples/s | 27.2 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00058 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=2.879 | 4605.9 samples/s | 72.0 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00052 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=2.880 | 1795.8 samples/s | 28.1 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00047 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=2.880 | 4305.7 samples/s | 67.3 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00043 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=2.881 | 1828.5 samples/s | 28.6 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00039 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=2.881 | 4192.0 samples/s | 65.5 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00036 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=2.882 | 1877.4 samples/s | 29.3 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00034 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=2.882 | 3953.6 samples/s | 61.8 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00031 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=2.883 | 1880.7 samples/s | 29.4 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00029 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=2.883 | 4046.2 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.2] | Loss=0.04296 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 3523.4 samples/s | 55.1 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00401 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=2.866 | 3836.4 samples/s | 59.9 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00246 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=2.868 | 5555.0 samples/s | 86.8 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00166 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=2.871 | 1686.1 samples/s | 26.3 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00125 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=2.873 | 4984.7 samples/s | 77.9 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00101 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.876 | 1739.5 samples/s | 27.2 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00084 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=2.878 | 4635.6 samples/s | 72.4 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00072 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=2.879 | 1806.1 samples/s | 28.2 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00063 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=2.881 | 4223.2 samples/s | 66.0 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00056 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=2.882 | 1829.5 samples/s | 28.6 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00051 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=2.883 | 4119.6 samples/s | 64.4 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00046 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=2.884 | 1860.2 samples/s | 29.1 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00042 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=2.885 | 4184.6 samples/s | 65.4 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00039 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=2.886 | 1890.7 samples/s | 29.5 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00036 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.887 | 4037.3 samples/s | 63.1 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00034 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=2.888 | 1980.1 samples/s | 30.9 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00032 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=2.889 | 3557.6 samples/s | 55.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.6] | Loss=0.03891 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.757 | L2-Norm(final)=2.860 | 3748.0 samples/s | 58.6 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00213 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=2.873 | 3657.7 samples/s | 57.2 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00173 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=2.882 | 5695.6 samples/s | 89.0 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00133 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=2.888 | 1664.7 samples/s | 26.0 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00102 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=2.892 | 5164.3 samples/s | 80.7 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00082 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=2.896 | 1711.6 samples/s | 26.7 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00069 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=2.899 | 4943.4 samples/s | 77.2 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00059 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=2.901 | 1751.6 samples/s | 27.4 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00052 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=2.903 | 4526.6 samples/s | 70.7 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00046 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=2.905 | 1784.4 samples/s | 27.9 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00041 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=2.906 | 4364.1 samples/s | 68.2 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00038 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=2.907 | 1811.9 samples/s | 28.3 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00034 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=2.908 | 4142.5 samples/s | 64.7 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00032 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=2.909 | 1859.5 samples/s | 29.1 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00030 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=2.910 | 4136.7 samples/s | 64.6 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00028 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=2.911 | 1862.4 samples/s | 29.1 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00026 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=2.911 | 4065.7 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42150 | acc=0.7852 | tpr=0.6900 | fpr=0.0082 | 3804.1 samples/s | 14.9 steps/s
Avg test loss: 0.42028, Avg test acc: 0.78223, Avg tpr: 0.68742, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.25025 | acc=0.9201 | tpr=0.9558 | fpr=0.0806 | 3797.4 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.25472 | acc=0.9197 | tpr=0.9701 | fpr=0.0812 | 7282.7 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.25907 | acc=0.9187 | tpr=0.9712 | fpr=0.0822 | 7015.2 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.25975 | acc=0.9186 | tpr=0.9727 | fpr=0.0824 | 7160.5 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.25762 | acc=0.9190 | tpr=0.9721 | fpr=0.0820 | 7225.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.25929 | acc=0.9189 | tpr=0.9716 | fpr=0.0820 | 7031.4 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.26128 | acc=0.9187 | tpr=0.9706 | fpr=0.0823 | 7206.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.26206 | acc=0.9187 | tpr=0.9716 | fpr=0.0822 | 7171.6 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.26471 | acc=0.9189 | tpr=0.9732 | fpr=0.0821 | 6893.1 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.26440 | acc=0.9187 | tpr=0.9749 | fpr=0.0824 | 7045.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.26300 | acc=0.9189 | tpr=0.9741 | fpr=0.0821 | 13312.3 samples/s | 52.0 steps/s
Avg test loss: 0.26283, Avg test acc: 0.91897, Avg tpr: 0.97345, Avg fpr: 0.08202, total FA: 11388

server round 18/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.36617 | Reg=0.00161 | acc=0.8125 | L2-Norm=12.708 | L2-Norm(final)=2.918 | 3623.5 samples/s | 56.6 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04568 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.845 | L2-Norm(final)=2.891 | 4141.0 samples/s | 64.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03757 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=2.893 | 4236.2 samples/s | 66.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.03282 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.929 | L2-Norm(final)=2.894 | 4231.6 samples/s | 66.1 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02952 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=2.894 | 5946.0 samples/s | 92.9 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02582 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=2.896 | 1740.2 samples/s | 27.2 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02320 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=2.901 | 4196.6 samples/s | 65.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.02210 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.999 | L2-Norm(final)=2.904 | 4209.2 samples/s | 65.8 steps/s
[Step=14800 Epoch=72.2] | Loss=0.02061 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=2.906 | 5361.4 samples/s | 83.8 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01929 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=2.909 | 1748.7 samples/s | 27.3 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01834 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.032 | L2-Norm(final)=2.911 | 4224.0 samples/s | 66.0 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01764 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=2.913 | 4260.4 samples/s | 66.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01678 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=2.915 | 4931.1 samples/s | 77.0 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01585 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=2.918 | 1819.9 samples/s | 28.4 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01523 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=2.921 | 4149.7 samples/s | 64.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01465 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=2.924 | 4272.0 samples/s | 66.8 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01416 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=2.926 | 4648.5 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.3] | Loss=0.22159 | Reg=0.00161 | acc=0.8594 | L2-Norm=12.708 | L2-Norm(final)=2.919 | 4014.5 samples/s | 62.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04224 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.841 | L2-Norm(final)=2.894 | 3901.4 samples/s | 61.0 steps/s
[Step=14500 Epoch=70.8] | Loss=0.03307 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=2.893 | 4284.0 samples/s | 66.9 steps/s
[Step=14550 Epoch=71.0] | Loss=0.03094 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=2.891 | 4291.7 samples/s | 67.1 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02902 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.952 | L2-Norm(final)=2.889 | 5642.4 samples/s | 88.2 steps/s
[Step=14650 Epoch=71.5] | Loss=0.02534 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.972 | L2-Norm(final)=2.889 | 1727.0 samples/s | 27.0 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02302 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.988 | L2-Norm(final)=2.894 | 4208.7 samples/s | 65.8 steps/s
[Step=14750 Epoch=72.0] | Loss=0.02163 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=2.897 | 4178.4 samples/s | 65.3 steps/s
[Step=14800 Epoch=72.2] | Loss=0.02015 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=2.899 | 5387.9 samples/s | 84.2 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01864 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=2.904 | 1745.7 samples/s | 27.3 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01760 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=2.908 | 4248.3 samples/s | 66.4 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01701 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=2.912 | 4264.8 samples/s | 66.6 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01628 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=2.916 | 5106.0 samples/s | 79.8 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01535 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=2.920 | 1795.1 samples/s | 28.0 steps/s
[Step=15100 Epoch=73.7] | Loss=0.01475 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=2.925 | 4245.0 samples/s | 66.3 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01414 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=2.929 | 4226.4 samples/s | 66.0 steps/s
[Step=15200 Epoch=74.2] | Loss=0.01389 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=2.933 | 4875.4 samples/s | 76.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.15884 | Reg=0.00161 | acc=0.8906 | L2-Norm=12.708 | L2-Norm(final)=2.919 | 3837.4 samples/s | 60.0 steps/s
[Step=14450 Epoch=70.4] | Loss=0.04539 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.836 | L2-Norm(final)=2.880 | 4042.4 samples/s | 63.2 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03208 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.888 | L2-Norm(final)=2.885 | 4301.3 samples/s | 67.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02902 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.916 | L2-Norm(final)=2.890 | 4249.0 samples/s | 66.4 steps/s
[Step=14600 Epoch=71.1] | Loss=0.02686 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.938 | L2-Norm(final)=2.895 | 5724.7 samples/s | 89.4 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02462 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=2.900 | 1730.8 samples/s | 27.0 steps/s
[Step=14700 Epoch=71.6] | Loss=0.02276 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=2.904 | 4262.1 samples/s | 66.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.02095 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=2.909 | 4230.8 samples/s | 66.1 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01990 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.998 | L2-Norm(final)=2.915 | 5364.1 samples/s | 83.8 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01860 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=2.920 | 1788.5 samples/s | 27.9 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01757 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=2.925 | 4249.0 samples/s | 66.4 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01685 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.030 | L2-Norm(final)=2.931 | 4276.6 samples/s | 66.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01642 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=2.935 | 5047.3 samples/s | 78.9 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01589 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=2.939 | 1827.2 samples/s | 28.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01519 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=2.943 | 4221.2 samples/s | 66.0 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01472 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=2.948 | 4227.1 samples/s | 66.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01444 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=2.952 | 4526.4 samples/s | 70.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.36739 | Reg=0.00161 | acc=0.7969 | L2-Norm=12.708 | L2-Norm(final)=2.918 | 3637.9 samples/s | 56.8 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04296 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=2.889 | 4211.2 samples/s | 65.8 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03263 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=2.892 | 4282.1 samples/s | 66.9 steps/s
[Step=14550 Epoch=71.0] | Loss=0.03033 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.928 | L2-Norm(final)=2.894 | 4229.4 samples/s | 66.1 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02698 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.950 | L2-Norm(final)=2.898 | 5839.4 samples/s | 91.2 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02326 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=2.905 | 1732.5 samples/s | 27.1 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02144 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=2.912 | 4194.2 samples/s | 65.5 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01978 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.992 | L2-Norm(final)=2.917 | 4237.0 samples/s | 66.2 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01891 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.002 | L2-Norm(final)=2.922 | 5431.1 samples/s | 84.9 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01780 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=2.927 | 1801.4 samples/s | 28.1 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01702 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=2.931 | 4146.4 samples/s | 64.8 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01651 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.030 | L2-Norm(final)=2.935 | 4239.1 samples/s | 66.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01589 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=2.938 | 4910.6 samples/s | 76.7 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01540 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=2.941 | 1806.4 samples/s | 28.2 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01475 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=2.944 | 4307.1 samples/s | 67.3 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01415 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=2.948 | 4177.9 samples/s | 65.3 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01369 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=2.952 | 4598.1 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.6] | Loss=0.24055 | Reg=0.00161 | acc=0.8750 | L2-Norm=12.708 | L2-Norm(final)=2.919 | 3957.9 samples/s | 61.8 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03572 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.826 | L2-Norm(final)=2.898 | 3979.4 samples/s | 62.2 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02739 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.867 | L2-Norm(final)=2.900 | 4296.2 samples/s | 67.1 steps/s
[Step=14550 Epoch=71.4] | Loss=0.02736 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.897 | L2-Norm(final)=2.897 | 4349.6 samples/s | 68.0 steps/s
[Step=14600 Epoch=71.6] | Loss=0.02642 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.921 | L2-Norm(final)=2.894 | 5970.7 samples/s | 93.3 steps/s
[Step=14650 Epoch=71.8] | Loss=0.02354 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=2.894 | 1728.2 samples/s | 27.0 steps/s
[Step=14700 Epoch=72.1] | Loss=0.02172 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.963 | L2-Norm(final)=2.897 | 4203.8 samples/s | 65.7 steps/s
[Step=14750 Epoch=72.3] | Loss=0.02046 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.979 | L2-Norm(final)=2.900 | 4215.2 samples/s | 65.9 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01901 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=2.903 | 5491.3 samples/s | 85.8 steps/s
[Step=14850 Epoch=72.8] | Loss=0.01790 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=2.906 | 1780.6 samples/s | 27.8 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01701 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.018 | L2-Norm(final)=2.910 | 4136.1 samples/s | 64.6 steps/s
[Step=14950 Epoch=73.3] | Loss=0.01608 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.028 | L2-Norm(final)=2.913 | 4208.1 samples/s | 65.8 steps/s
[Step=15000 Epoch=73.6] | Loss=0.01539 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.038 | L2-Norm(final)=2.917 | 5254.6 samples/s | 82.1 steps/s
[Step=15050 Epoch=73.8] | Loss=0.01512 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.048 | L2-Norm(final)=2.919 | 1783.9 samples/s | 27.9 steps/s
[Step=15100 Epoch=74.0] | Loss=0.01455 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=2.922 | 4206.7 samples/s | 65.7 steps/s
[Step=15150 Epoch=74.3] | Loss=0.01388 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=2.924 | 4170.1 samples/s | 65.2 steps/s
[Step=15200 Epoch=74.5] | Loss=0.01341 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=2.927 | 5005.7 samples/s | 78.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=136.5] | Loss=0.01164 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.708 | L2-Norm(final)=2.921 | 3624.0 samples/s | 56.6 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00913 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.860 | L2-Norm(final)=2.898 | 3932.9 samples/s | 61.5 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00525 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=2.884 | 5615.0 samples/s | 87.7 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00357 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=2.883 | 1664.0 samples/s | 26.0 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00268 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=2.884 | 5031.6 samples/s | 78.6 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00215 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=2.886 | 1733.7 samples/s | 27.1 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00179 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=2.887 | 4640.9 samples/s | 72.5 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00154 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=2.889 | 1786.5 samples/s | 27.9 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00135 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=2.890 | 4298.1 samples/s | 67.2 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00120 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=2.891 | 1819.5 samples/s | 28.4 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00108 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=2.892 | 4152.5 samples/s | 64.9 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00098 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=2.893 | 1886.9 samples/s | 29.5 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00090 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=2.894 | 4101.1 samples/s | 64.1 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00083 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=2.894 | 1875.1 samples/s | 29.3 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00077 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=2.895 | 4062.5 samples/s | 63.5 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00072 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=2.896 | 1881.0 samples/s | 29.4 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00068 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.897 | 4124.3 samples/s | 64.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step15200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.0] | Loss=0.00577 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=2.921 | 3878.6 samples/s | 60.6 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00822 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=2.906 | 3737.9 samples/s | 58.4 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00428 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=2.903 | 5645.5 samples/s | 88.2 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00286 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=2.906 | 1677.8 samples/s | 26.2 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00215 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=2.909 | 5223.5 samples/s | 81.6 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00172 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=2.911 | 1729.2 samples/s | 27.0 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00144 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.912 | 4721.6 samples/s | 73.8 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00123 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=2.914 | 1718.5 samples/s | 26.9 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00108 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=2.915 | 4477.4 samples/s | 70.0 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00096 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=2.916 | 1803.2 samples/s | 28.2 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00087 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=2.917 | 4052.3 samples/s | 63.3 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00079 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=2.918 | 1845.9 samples/s | 28.8 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00072 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=2.919 | 4085.4 samples/s | 63.8 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00067 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=2.920 | 1851.0 samples/s | 28.9 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00062 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.863 | L2-Norm(final)=2.921 | 3984.6 samples/s | 62.3 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00058 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.853 | L2-Norm(final)=2.922 | 1861.5 samples/s | 29.1 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00054 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=2.922 | 4023.4 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.5] | Loss=0.00705 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=2.921 | 3822.4 samples/s | 59.7 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00413 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=2.918 | 3649.5 samples/s | 57.0 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00257 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.866 | L2-Norm(final)=2.916 | 5561.3 samples/s | 86.9 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00173 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=2.917 | 1671.9 samples/s | 26.1 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00130 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=2.918 | 5392.6 samples/s | 84.3 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00104 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=2.919 | 1715.8 samples/s | 26.8 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00087 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=2.919 | 4932.0 samples/s | 77.1 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00075 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=2.920 | 1732.8 samples/s | 27.1 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00065 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=2.921 | 4478.3 samples/s | 70.0 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00058 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=2.921 | 1776.5 samples/s | 27.8 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00052 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=2.922 | 4358.2 samples/s | 68.1 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00048 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=2.922 | 1879.9 samples/s | 29.4 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00044 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.819 | L2-Norm(final)=2.923 | 4014.3 samples/s | 62.7 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00040 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=2.923 | 1870.7 samples/s | 29.2 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00037 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=2.924 | 4117.8 samples/s | 64.3 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00035 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=2.924 | 1871.7 samples/s | 29.2 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00033 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=2.924 | 4066.7 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=135.7] | Loss=0.06064 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.708 | L2-Norm(final)=2.920 | 4061.4 samples/s | 63.5 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00258 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=2.926 | 3745.5 samples/s | 58.5 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00179 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=2.926 | 5487.4 samples/s | 85.7 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00120 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=2.930 | 1671.7 samples/s | 26.1 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00091 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=2.934 | 5099.9 samples/s | 79.7 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00073 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=2.936 | 1726.6 samples/s | 27.0 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00061 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.819 | L2-Norm(final)=2.938 | 4673.3 samples/s | 73.0 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00052 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=2.940 | 1786.5 samples/s | 27.9 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00046 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=2.941 | 4226.2 samples/s | 66.0 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00041 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=2.942 | 1831.3 samples/s | 28.6 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00037 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=2.944 | 4041.0 samples/s | 63.1 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00033 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=2.945 | 1874.3 samples/s | 29.3 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00031 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=2.946 | 4063.4 samples/s | 63.5 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00028 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=2.947 | 1868.3 samples/s | 29.2 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00026 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=2.948 | 4003.8 samples/s | 62.6 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00025 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=2.949 | 1945.1 samples/s | 30.4 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=2.949 | 3769.4 samples/s | 58.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.3] | Loss=0.00058 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=2.921 | 3731.0 samples/s | 58.3 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00124 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=2.937 | 3833.3 samples/s | 59.9 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00082 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=2.945 | 5547.6 samples/s | 86.7 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00063 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=2.951 | 1652.0 samples/s | 25.8 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00047 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=2.957 | 5180.9 samples/s | 81.0 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00038 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=2.961 | 1682.2 samples/s | 26.3 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00032 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=2.964 | 4882.8 samples/s | 76.3 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=2.966 | 1761.7 samples/s | 27.5 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=2.968 | 4446.7 samples/s | 69.5 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=2.970 | 1794.1 samples/s | 28.0 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00019 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=2.971 | 4316.8 samples/s | 67.4 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00018 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=2.973 | 1842.5 samples/s | 28.8 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=2.974 | 4113.4 samples/s | 64.3 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00015 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=2.975 | 1879.4 samples/s | 29.4 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=2.976 | 4151.0 samples/s | 64.9 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00013 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=2.977 | 1900.0 samples/s | 29.7 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00012 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=2.978 | 4129.2 samples/s | 64.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34121 | acc=0.8137 | tpr=0.7321 | fpr=0.0092 | 3805.1 samples/s | 14.9 steps/s
Avg test loss: 0.34181, Avg test acc: 0.81140, Avg tpr: 0.73090, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.27928 | acc=0.9048 | tpr=0.9646 | fpr=0.0963 | 3741.4 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.28273 | acc=0.9055 | tpr=0.9723 | fpr=0.0957 | 7188.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.28658 | acc=0.9044 | tpr=0.9697 | fpr=0.0968 | 7145.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.28688 | acc=0.9045 | tpr=0.9705 | fpr=0.0967 | 7175.3 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.28466 | acc=0.9045 | tpr=0.9694 | fpr=0.0967 | 7346.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.28634 | acc=0.9041 | tpr=0.9687 | fpr=0.0970 | 6949.5 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.28838 | acc=0.9034 | tpr=0.9681 | fpr=0.0978 | 7094.3 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.28964 | acc=0.9032 | tpr=0.9705 | fpr=0.0980 | 7167.2 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.29214 | acc=0.9033 | tpr=0.9722 | fpr=0.0979 | 7071.1 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.29189 | acc=0.9030 | tpr=0.9740 | fpr=0.0983 | 7080.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.29023 | acc=0.9034 | tpr=0.9737 | fpr=0.0979 | 12826.3 samples/s | 50.1 steps/s
Avg test loss: 0.29002, Avg test acc: 0.90343, Avg tpr: 0.97306, Avg fpr: 0.09784, total FA: 13585

server round 19/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.19664 | Reg=0.00161 | acc=0.8906 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 4214.5 samples/s | 65.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.04667 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=2.932 | 3864.2 samples/s | 60.4 steps/s
[Step=15300 Epoch=74.6] | Loss=0.03695 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.830 | L2-Norm(final)=2.924 | 4231.7 samples/s | 66.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.03092 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.860 | L2-Norm(final)=2.928 | 4213.9 samples/s | 65.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02796 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.881 | L2-Norm(final)=2.930 | 5790.5 samples/s | 90.5 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02452 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=2.933 | 1734.9 samples/s | 27.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.02237 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=2.936 | 4220.1 samples/s | 65.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.02088 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.923 | L2-Norm(final)=2.940 | 4296.2 samples/s | 67.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01957 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=2.943 | 5421.8 samples/s | 84.7 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01828 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.943 | L2-Norm(final)=2.946 | 1807.2 samples/s | 28.2 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01720 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=2.949 | 4153.7 samples/s | 64.9 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01636 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=2.952 | 4167.5 samples/s | 65.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01566 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=2.955 | 5010.6 samples/s | 78.3 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01511 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.972 | L2-Norm(final)=2.957 | 1828.5 samples/s | 28.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01455 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=2.959 | 4162.9 samples/s | 65.0 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01422 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=2.961 | 4238.6 samples/s | 66.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01375 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=2.962 | 4637.2 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.2] | Loss=0.16589 | Reg=0.00161 | acc=0.8750 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 4104.0 samples/s | 64.1 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03920 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=2.933 | 3908.6 samples/s | 61.1 steps/s
[Step=15300 Epoch=74.7] | Loss=0.03231 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.825 | L2-Norm(final)=2.935 | 4214.4 samples/s | 65.8 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02999 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.855 | L2-Norm(final)=2.940 | 4232.7 samples/s | 66.1 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02607 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.880 | L2-Norm(final)=2.947 | 5784.8 samples/s | 90.4 steps/s
[Step=15450 Epoch=75.4] | Loss=0.02247 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.901 | L2-Norm(final)=2.957 | 1748.6 samples/s | 27.3 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01995 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=2.965 | 4285.8 samples/s | 67.0 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01930 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=2.972 | 4229.0 samples/s | 66.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01883 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=2.976 | 5423.2 samples/s | 84.7 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01743 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=2.981 | 1755.9 samples/s | 27.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01616 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=2.986 | 4226.4 samples/s | 66.0 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01550 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=2.991 | 4179.6 samples/s | 65.3 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01491 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.988 | L2-Norm(final)=2.995 | 5031.8 samples/s | 78.6 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01433 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.997 | L2-Norm(final)=2.999 | 1804.4 samples/s | 28.2 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01375 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=3.002 | 4345.1 samples/s | 67.9 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01317 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=3.006 | 4235.7 samples/s | 66.2 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01265 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.019 | L2-Norm(final)=3.011 | 4830.2 samples/s | 75.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.19407 | Reg=0.00161 | acc=0.8906 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 4040.1 samples/s | 63.1 steps/s
[Step=15250 Epoch=74.3] | Loss=0.04253 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.780 | L2-Norm(final)=2.930 | 4063.3 samples/s | 63.5 steps/s
[Step=15300 Epoch=74.5] | Loss=0.03630 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.830 | L2-Norm(final)=2.933 | 4292.6 samples/s | 67.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.03087 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=2.936 | 4242.9 samples/s | 66.3 steps/s
[Step=15400 Epoch=75.0] | Loss=0.02842 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.883 | L2-Norm(final)=2.942 | 5740.4 samples/s | 89.7 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02640 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=2.946 | 1738.3 samples/s | 27.2 steps/s
[Step=15500 Epoch=75.5] | Loss=0.02374 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.922 | L2-Norm(final)=2.951 | 4284.0 samples/s | 66.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.02153 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=2.958 | 4278.2 samples/s | 66.8 steps/s
[Step=15600 Epoch=76.0] | Loss=0.02046 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=2.963 | 5326.1 samples/s | 83.2 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01959 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=2.966 | 1782.6 samples/s | 27.9 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01847 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.974 | L2-Norm(final)=2.970 | 4220.3 samples/s | 65.9 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01790 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=2.973 | 4278.1 samples/s | 66.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01711 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.995 | L2-Norm(final)=2.976 | 4869.4 samples/s | 76.1 steps/s
[Step=15850 Epoch=77.2] | Loss=0.01632 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=2.980 | 1832.0 samples/s | 28.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01569 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=2.984 | 4181.5 samples/s | 65.3 steps/s
[Step=15950 Epoch=77.7] | Loss=0.01520 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.020 | L2-Norm(final)=2.987 | 4241.3 samples/s | 66.3 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01475 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.028 | L2-Norm(final)=2.991 | 4590.0 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.13285 | Reg=0.00161 | acc=0.8906 | L2-Norm=12.670 | L2-Norm(final)=2.963 | 3845.4 samples/s | 60.1 steps/s
[Step=15250 Epoch=74.4] | Loss=0.04334 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.797 | L2-Norm(final)=2.935 | 4167.2 samples/s | 65.1 steps/s
[Step=15300 Epoch=74.6] | Loss=0.03126 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=2.933 | 4295.4 samples/s | 67.1 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02886 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.870 | L2-Norm(final)=2.936 | 4246.5 samples/s | 66.4 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02675 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.888 | L2-Norm(final)=2.936 | 5848.1 samples/s | 91.4 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02375 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.905 | L2-Norm(final)=2.939 | 1734.5 samples/s | 27.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.02167 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.920 | L2-Norm(final)=2.943 | 4256.2 samples/s | 66.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.02006 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.932 | L2-Norm(final)=2.948 | 4217.2 samples/s | 65.9 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01851 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=2.952 | 5286.0 samples/s | 82.6 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01735 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=2.956 | 1776.5 samples/s | 27.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01628 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=2.960 | 4299.6 samples/s | 67.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01570 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=2.964 | 4246.8 samples/s | 66.4 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01498 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.972 | L2-Norm(final)=2.967 | 4998.9 samples/s | 78.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01427 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=2.971 | 1817.6 samples/s | 28.4 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01389 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.985 | L2-Norm(final)=2.974 | 4228.0 samples/s | 66.1 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01334 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.990 | L2-Norm(final)=2.977 | 4162.5 samples/s | 65.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01275 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=2.981 | 4678.2 samples/s | 73.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.5] | Loss=0.19280 | Reg=0.00161 | acc=0.9062 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 3931.0 samples/s | 61.4 steps/s
[Step=15250 Epoch=74.8] | Loss=0.03301 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=2.941 | 4085.3 samples/s | 63.8 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02977 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.824 | L2-Norm(final)=2.940 | 4275.0 samples/s | 66.8 steps/s
[Step=15350 Epoch=75.3] | Loss=0.02620 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.851 | L2-Norm(final)=2.942 | 4211.7 samples/s | 65.8 steps/s
[Step=15400 Epoch=75.5] | Loss=0.02391 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=2.945 | 5848.8 samples/s | 91.4 steps/s
[Step=15450 Epoch=75.8] | Loss=0.02183 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=2.949 | 1716.4 samples/s | 26.8 steps/s
[Step=15500 Epoch=76.0] | Loss=0.02004 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=2.954 | 4255.9 samples/s | 66.5 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01830 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.919 | L2-Norm(final)=2.959 | 4238.8 samples/s | 66.2 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01761 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.932 | L2-Norm(final)=2.964 | 5587.5 samples/s | 87.3 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01638 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=2.968 | 1751.5 samples/s | 27.4 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01511 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=2.974 | 4228.5 samples/s | 66.1 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01461 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.960 | L2-Norm(final)=2.978 | 4282.0 samples/s | 66.9 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01388 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=2.982 | 5315.5 samples/s | 83.1 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01333 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=2.986 | 1792.5 samples/s | 28.0 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01278 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=2.989 | 4274.4 samples/s | 66.8 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01240 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.987 | L2-Norm(final)=2.993 | 4333.1 samples/s | 67.7 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01193 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=2.996 | 5104.1 samples/s | 79.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.0] | Loss=0.00417 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=2.964 | 3651.2 samples/s | 57.0 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00325 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=2.975 | 3833.8 samples/s | 59.9 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00311 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=2.979 | 5381.3 samples/s | 84.1 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00213 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=2.976 | 1672.9 samples/s | 26.1 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00161 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=2.978 | 5161.3 samples/s | 80.6 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00129 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=2.980 | 1717.5 samples/s | 26.8 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00107 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=2.982 | 4650.8 samples/s | 72.7 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00092 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=2.983 | 1768.9 samples/s | 27.6 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00081 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=2.985 | 4382.8 samples/s | 68.5 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00072 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=2.986 | 1773.2 samples/s | 27.7 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00065 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=2.988 | 4010.8 samples/s | 62.7 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00059 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=2.989 | 1849.8 samples/s | 28.9 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00054 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=2.990 | 3992.7 samples/s | 62.4 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00050 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=2.991 | 1901.3 samples/s | 29.7 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00046 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=2.992 | 3998.6 samples/s | 62.5 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00043 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=2.993 | 1851.2 samples/s | 28.9 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00041 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=2.994 | 4065.4 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.6] | Loss=0.07870 | Reg=0.00161 | acc=0.9375 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 3816.5 samples/s | 59.6 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00666 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=2.935 | 3656.4 samples/s | 57.1 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00400 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=2.936 | 5661.8 samples/s | 88.5 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00271 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=2.942 | 1662.8 samples/s | 26.0 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00203 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=2.947 | 5029.7 samples/s | 78.6 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00163 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=2.950 | 1716.1 samples/s | 26.8 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00136 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=2.953 | 4749.4 samples/s | 74.2 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00117 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=2.955 | 1758.7 samples/s | 27.5 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00102 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=2.957 | 4372.8 samples/s | 68.3 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00091 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=2.958 | 1815.2 samples/s | 28.4 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00082 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=2.960 | 4213.9 samples/s | 65.8 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00074 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=2.961 | 1859.4 samples/s | 29.1 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00068 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.819 | L2-Norm(final)=2.962 | 4069.0 samples/s | 63.6 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00063 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=2.964 | 1901.1 samples/s | 29.7 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00059 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=2.965 | 3993.4 samples/s | 62.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00055 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=2.966 | 1885.9 samples/s | 29.5 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00051 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=2.966 | 3961.8 samples/s | 61.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=145.2] | Loss=0.03428 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.670 | L2-Norm(final)=2.962 | 3606.8 samples/s | 56.4 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00181 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=2.964 | 3914.9 samples/s | 61.2 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00092 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=2.971 | 5517.8 samples/s | 86.2 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00062 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=2.976 | 1666.6 samples/s | 26.0 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00047 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=2.978 | 5259.2 samples/s | 82.2 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00038 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=2.980 | 1701.3 samples/s | 26.6 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00031 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=2.982 | 4923.0 samples/s | 76.9 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00027 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=2.984 | 1740.0 samples/s | 27.2 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00024 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=2.985 | 4611.7 samples/s | 72.1 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=2.986 | 1775.8 samples/s | 27.7 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00019 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=2.987 | 4430.8 samples/s | 69.2 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00017 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=2.988 | 1805.6 samples/s | 28.2 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=2.989 | 4095.5 samples/s | 64.0 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00015 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=2.990 | 1848.3 samples/s | 28.9 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00014 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=2.991 | 4081.3 samples/s | 63.8 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00013 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=2.992 | 1877.0 samples/s | 29.3 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=2.993 | 4078.3 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=143.2] | Loss=0.02648 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.670 | L2-Norm(final)=2.964 | 3707.2 samples/s | 57.9 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00318 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=2.965 | 4028.2 samples/s | 62.9 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00209 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=2.965 | 5539.2 samples/s | 86.5 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00228 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=2.965 | 1688.3 samples/s | 26.4 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00207 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=2.961 | 5003.3 samples/s | 78.2 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00190 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=2.959 | 1761.9 samples/s | 27.5 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00159 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=2.957 | 4511.3 samples/s | 70.5 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00136 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=2.955 | 1784.9 samples/s | 27.9 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00119 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=2.954 | 4150.7 samples/s | 64.9 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00106 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=2.954 | 1841.6 samples/s | 28.8 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00096 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=2.953 | 4118.3 samples/s | 64.3 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00087 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=2.953 | 1874.1 samples/s | 29.3 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00080 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=2.953 | 4125.7 samples/s | 64.5 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00074 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=2.952 | 1887.5 samples/s | 29.5 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00068 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=2.952 | 4098.8 samples/s | 64.0 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00064 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=2.952 | 1880.7 samples/s | 29.4 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00060 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=2.952 | 4059.7 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.9] | Loss=0.02084 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.670 | L2-Norm(final)=2.963 | 3959.4 samples/s | 61.9 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00546 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=2.955 | 3621.9 samples/s | 56.6 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00520 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=2.925 | 5563.0 samples/s | 86.9 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00375 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=2.911 | 1665.2 samples/s | 26.0 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00282 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=2.906 | 5208.2 samples/s | 81.4 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00226 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=2.903 | 1686.8 samples/s | 26.4 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00189 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=2.902 | 4781.0 samples/s | 74.7 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00162 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=2.901 | 1732.7 samples/s | 27.1 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00142 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=2.901 | 4600.3 samples/s | 71.9 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00126 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=2.901 | 1774.9 samples/s | 27.7 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00114 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.901 | 4331.4 samples/s | 67.7 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00103 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=2.902 | 1822.5 samples/s | 28.5 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00095 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=2.902 | 4108.6 samples/s | 64.2 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00088 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=2.903 | 1839.2 samples/s | 28.7 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00081 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=2.903 | 4128.2 samples/s | 64.5 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00076 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=2.904 | 1882.8 samples/s | 29.4 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00071 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=2.904 | 4125.2 samples/s | 64.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37784 | acc=0.7958 | tpr=0.7063 | fpr=0.0099 | 3773.1 samples/s | 14.7 steps/s
Avg test loss: 0.37826, Avg test acc: 0.79209, Avg tpr: 0.70292, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.25474 | acc=0.9162 | tpr=0.9558 | fpr=0.0845 | 3812.3 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.25844 | acc=0.9177 | tpr=0.9680 | fpr=0.0832 | 7182.0 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.26224 | acc=0.9168 | tpr=0.9683 | fpr=0.0842 | 7077.6 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.26268 | acc=0.9170 | tpr=0.9705 | fpr=0.0840 | 7116.9 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.26034 | acc=0.9176 | tpr=0.9712 | fpr=0.0834 | 7009.3 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.26253 | acc=0.9170 | tpr=0.9709 | fpr=0.0840 | 7233.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.26481 | acc=0.9165 | tpr=0.9699 | fpr=0.0845 | 7148.6 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.26605 | acc=0.9164 | tpr=0.9705 | fpr=0.0846 | 4378.5 samples/s | 17.1 steps/s
[Step= 450] | Loss=0.26860 | acc=0.9164 | tpr=0.9722 | fpr=0.0846 | 6989.2 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.26805 | acc=0.9162 | tpr=0.9740 | fpr=0.0848 | 7138.6 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.26663 | acc=0.9165 | tpr=0.9733 | fpr=0.0845 | 12810.6 samples/s | 50.0 steps/s
Avg test loss: 0.26638, Avg test acc: 0.91656, Avg tpr: 0.97306, Avg fpr: 0.08447, total FA: 11728

server round 20/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.26242 | Reg=0.00160 | acc=0.8281 | L2-Norm=12.650 | L2-Norm(final)=3.001 | 4027.6 samples/s | 62.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04512 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=2.981 | 3817.3 samples/s | 59.6 steps/s
[Step=16100 Epoch=78.5] | Loss=0.03175 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.725 | L2-Norm(final)=2.983 | 4225.8 samples/s | 66.0 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02704 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.736 | L2-Norm(final)=2.985 | 4273.2 samples/s | 66.8 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02315 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=2.988 | 5777.5 samples/s | 90.3 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01994 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=2.992 | 1719.8 samples/s | 26.9 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01807 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=2.996 | 4209.2 samples/s | 65.8 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01672 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=3.001 | 4236.3 samples/s | 66.2 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01542 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=3.005 | 5377.4 samples/s | 84.0 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01450 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=3.009 | 1764.0 samples/s | 27.6 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01370 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.777 | L2-Norm(final)=3.012 | 4186.6 samples/s | 65.4 steps/s
[Step=16550 Epoch=80.7] | Loss=0.01279 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.016 | 4231.1 samples/s | 66.1 steps/s
[Step=16600 Epoch=80.9] | Loss=0.01227 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=3.019 | 4927.3 samples/s | 77.0 steps/s
[Step=16650 Epoch=81.2] | Loss=0.01171 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.022 | 1817.3 samples/s | 28.4 steps/s
[Step=16700 Epoch=81.4] | Loss=0.01124 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=3.025 | 4173.8 samples/s | 65.2 steps/s
[Step=16750 Epoch=81.7] | Loss=0.01085 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=3.028 | 4302.1 samples/s | 67.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.01049 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.794 | L2-Norm(final)=3.031 | 4596.2 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.1] | Loss=0.29686 | Reg=0.00160 | acc=0.7969 | L2-Norm=12.650 | L2-Norm(final)=3.001 | 3740.4 samples/s | 58.4 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04814 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=2.977 | 4111.3 samples/s | 64.2 steps/s
[Step=16100 Epoch=78.6] | Loss=0.03347 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.719 | L2-Norm(final)=2.978 | 4134.6 samples/s | 64.6 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02638 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.731 | L2-Norm(final)=2.983 | 4229.7 samples/s | 66.1 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02290 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.739 | L2-Norm(final)=2.988 | 5739.5 samples/s | 89.7 steps/s
[Step=16250 Epoch=79.3] | Loss=0.02024 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=2.994 | 1712.2 samples/s | 26.8 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01788 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=2.999 | 4287.4 samples/s | 67.0 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01622 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.005 | 4266.8 samples/s | 66.7 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01507 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=3.009 | 5434.3 samples/s | 84.9 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01383 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.014 | 1757.5 samples/s | 27.5 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01292 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.770 | L2-Norm(final)=3.018 | 4220.9 samples/s | 66.0 steps/s
[Step=16550 Epoch=80.8] | Loss=0.01205 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.023 | 4162.6 samples/s | 65.0 steps/s
[Step=16600 Epoch=81.0] | Loss=0.01149 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.027 | 5093.3 samples/s | 79.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.01108 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.030 | 1812.9 samples/s | 28.3 steps/s
[Step=16700 Epoch=81.5] | Loss=0.01056 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=3.034 | 4174.7 samples/s | 65.2 steps/s
[Step=16750 Epoch=81.7] | Loss=0.01016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.037 | 4232.3 samples/s | 66.1 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00969 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.041 | 4794.7 samples/s | 74.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.38795 | Reg=0.00160 | acc=0.8125 | L2-Norm=12.650 | L2-Norm(final)=3.001 | 4096.5 samples/s | 64.0 steps/s
[Step=16050 Epoch=78.2] | Loss=0.04214 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.701 | L2-Norm(final)=2.985 | 3789.6 samples/s | 59.2 steps/s
[Step=16100 Epoch=78.4] | Loss=0.03109 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.719 | L2-Norm(final)=2.988 | 4163.6 samples/s | 65.1 steps/s
[Step=16150 Epoch=78.7] | Loss=0.02528 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=2.992 | 4243.2 samples/s | 66.3 steps/s
[Step=16200 Epoch=78.9] | Loss=0.02203 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.739 | L2-Norm(final)=2.997 | 5637.7 samples/s | 88.1 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01980 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.001 | 1740.7 samples/s | 27.2 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01770 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=3.006 | 4153.0 samples/s | 64.9 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01626 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.011 | 4247.8 samples/s | 66.4 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01506 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=3.016 | 5339.6 samples/s | 83.4 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01399 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.020 | 1790.6 samples/s | 28.0 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01302 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=3.024 | 4201.6 samples/s | 65.6 steps/s
[Step=16550 Epoch=80.6] | Loss=0.01225 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=3.029 | 4208.3 samples/s | 65.8 steps/s
[Step=16600 Epoch=80.9] | Loss=0.01183 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=3.033 | 4906.1 samples/s | 76.7 steps/s
[Step=16650 Epoch=81.1] | Loss=0.01138 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.036 | 1804.6 samples/s | 28.2 steps/s
[Step=16700 Epoch=81.4] | Loss=0.01091 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=3.040 | 4153.9 samples/s | 64.9 steps/s
[Step=16750 Epoch=81.6] | Loss=0.01044 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.044 | 4281.3 samples/s | 66.9 steps/s
[Step=16800 Epoch=81.9] | Loss=0.01021 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=3.047 | 4638.3 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.09721 | Reg=0.00160 | acc=0.9062 | L2-Norm=12.650 | L2-Norm(final)=3.002 | 3898.0 samples/s | 60.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03401 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.702 | L2-Norm(final)=2.997 | 4011.0 samples/s | 62.7 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02499 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.720 | L2-Norm(final)=2.999 | 4279.4 samples/s | 66.9 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02049 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.730 | L2-Norm(final)=3.004 | 4175.7 samples/s | 65.2 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01778 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.009 | 5800.3 samples/s | 90.6 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01579 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.745 | L2-Norm(final)=3.015 | 1752.4 samples/s | 27.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01439 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=3.020 | 4157.0 samples/s | 65.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01343 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=3.024 | 4060.9 samples/s | 63.5 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01258 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=3.028 | 5237.5 samples/s | 81.8 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01177 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=3.032 | 1770.9 samples/s | 27.7 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01106 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=3.036 | 4218.0 samples/s | 65.9 steps/s
[Step=16550 Epoch=80.7] | Loss=0.01052 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=3.039 | 4218.2 samples/s | 65.9 steps/s
[Step=16600 Epoch=81.0] | Loss=0.01010 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.772 | L2-Norm(final)=3.043 | 4875.9 samples/s | 76.2 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00959 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.046 | 1840.3 samples/s | 28.8 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00920 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.050 | 4287.3 samples/s | 67.0 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00887 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.053 | 4172.3 samples/s | 65.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00860 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.057 | 4482.0 samples/s | 70.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step16800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.5] | Loss=0.25476 | Reg=0.00160 | acc=0.8594 | L2-Norm=12.650 | L2-Norm(final)=3.001 | 3714.6 samples/s | 58.0 steps/s
[Step=16050 Epoch=78.7] | Loss=0.04337 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.697 | L2-Norm(final)=2.986 | 4226.2 samples/s | 66.0 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02887 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=2.989 | 4228.2 samples/s | 66.1 steps/s
[Step=16150 Epoch=79.2] | Loss=0.02359 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.726 | L2-Norm(final)=2.995 | 4220.7 samples/s | 65.9 steps/s
[Step=16200 Epoch=79.4] | Loss=0.02022 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=3.001 | 5935.4 samples/s | 92.7 steps/s
[Step=16250 Epoch=79.7] | Loss=0.01749 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.740 | L2-Norm(final)=3.007 | 1706.7 samples/s | 26.7 steps/s
[Step=16300 Epoch=79.9] | Loss=0.01558 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=3.012 | 4211.9 samples/s | 65.8 steps/s
[Step=16350 Epoch=80.2] | Loss=0.01420 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=3.017 | 4260.8 samples/s | 66.6 steps/s
[Step=16400 Epoch=80.4] | Loss=0.01338 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.754 | L2-Norm(final)=3.021 | 5508.2 samples/s | 86.1 steps/s
[Step=16450 Epoch=80.7] | Loss=0.01238 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.757 | L2-Norm(final)=3.024 | 1749.9 samples/s | 27.3 steps/s
[Step=16500 Epoch=80.9] | Loss=0.01167 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.028 | 4305.6 samples/s | 67.3 steps/s
[Step=16550 Epoch=81.2] | Loss=0.01136 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.764 | L2-Norm(final)=3.031 | 4336.1 samples/s | 67.8 steps/s
[Step=16600 Epoch=81.4] | Loss=0.01083 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=3.034 | 5340.2 samples/s | 83.4 steps/s
[Step=16650 Epoch=81.6] | Loss=0.01023 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=3.037 | 1812.4 samples/s | 28.3 steps/s
[Step=16700 Epoch=81.9] | Loss=0.00971 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.040 | 4224.2 samples/s | 66.0 steps/s
[Step=16750 Epoch=82.1] | Loss=0.00931 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.044 | 4188.5 samples/s | 65.4 steps/s
[Step=16800 Epoch=82.4] | Loss=0.00900 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.047 | 5012.5 samples/s | 78.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.03617 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.650 | L2-Norm(final)=3.002 | 3755.5 samples/s | 58.7 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00249 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.006 | 3735.0 samples/s | 58.4 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00128 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=3.011 | 5450.6 samples/s | 85.2 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00087 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.014 | 1669.4 samples/s | 26.1 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00066 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.017 | 5156.4 samples/s | 80.6 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00053 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.019 | 1714.1 samples/s | 26.8 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00044 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.020 | 4681.3 samples/s | 73.1 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00038 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=3.021 | 1785.1 samples/s | 27.9 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00034 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.023 | 4312.5 samples/s | 67.4 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00030 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.024 | 1242.7 samples/s | 19.4 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.025 | 4170.4 samples/s | 65.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00025 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.026 | 1842.0 samples/s | 28.8 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00023 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.027 | 4068.1 samples/s | 63.6 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.028 | 1882.8 samples/s | 29.4 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00020 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.028 | 4031.7 samples/s | 63.0 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00018 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=3.029 | 1891.2 samples/s | 29.5 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.030 | 4006.7 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.2] | Loss=0.00269 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.003 | 3565.4 samples/s | 55.7 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00380 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.000 | 3954.3 samples/s | 61.8 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00196 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.003 | 5625.7 samples/s | 87.9 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00132 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.005 | 1688.2 samples/s | 26.4 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00100 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.007 | 5027.1 samples/s | 78.5 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00080 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=3.009 | 1747.6 samples/s | 27.3 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00067 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=3.011 | 4759.3 samples/s | 74.4 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00058 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=3.012 | 1784.0 samples/s | 27.9 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00051 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.013 | 4477.1 samples/s | 70.0 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00045 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.014 | 1809.3 samples/s | 28.3 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00041 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=3.015 | 4161.5 samples/s | 65.0 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00037 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.016 | 1865.7 samples/s | 29.2 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00034 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.017 | 4038.0 samples/s | 63.1 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00032 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.018 | 1895.5 samples/s | 29.6 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00030 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.019 | 4020.6 samples/s | 62.8 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.020 | 1897.0 samples/s | 29.6 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00026 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.021 | 4051.5 samples/s | 63.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.8] | Loss=0.01118 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.650 | L2-Norm(final)=3.003 | 3948.5 samples/s | 61.7 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00215 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.011 | 3666.2 samples/s | 57.3 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00110 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=3.016 | 5639.6 samples/s | 88.1 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00074 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.018 | 1681.2 samples/s | 26.3 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00056 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.020 | 5160.7 samples/s | 80.6 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00045 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=3.021 | 1689.1 samples/s | 26.4 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00038 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=3.023 | 4864.8 samples/s | 76.0 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00032 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.024 | 1739.7 samples/s | 27.2 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=3.025 | 4590.3 samples/s | 71.7 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00025 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.026 | 1784.7 samples/s | 27.9 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00023 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.027 | 4137.4 samples/s | 64.6 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.027 | 1805.3 samples/s | 28.2 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00019 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.028 | 4048.8 samples/s | 63.3 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00018 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.029 | 1892.9 samples/s | 29.6 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=3.030 | 4008.3 samples/s | 62.6 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.030 | 1869.4 samples/s | 29.2 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.031 | 4063.2 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step16800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.10065 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.650 | L2-Norm(final)=3.001 | 3893.6 samples/s | 60.8 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00407 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=3.000 | 3595.5 samples/s | 56.2 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00209 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=3.004 | 5541.8 samples/s | 86.6 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00142 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.008 | 1701.3 samples/s | 26.6 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00107 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=3.010 | 5063.5 samples/s | 79.1 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00086 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=3.013 | 1749.8 samples/s | 27.3 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00072 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.015 | 4665.9 samples/s | 72.9 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00062 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.016 | 1788.5 samples/s | 27.9 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00055 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=3.018 | 4203.3 samples/s | 65.7 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00049 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.019 | 1811.9 samples/s | 28.3 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00044 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.021 | 4113.2 samples/s | 64.3 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00040 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.022 | 1862.7 samples/s | 29.1 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00037 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.023 | 4057.7 samples/s | 63.4 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00034 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.024 | 1869.7 samples/s | 29.2 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00032 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.025 | 4041.0 samples/s | 63.1 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00030 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.027 | 2048.2 samples/s | 32.0 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00028 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.028 | 3471.9 samples/s | 54.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.5] | Loss=0.04560 | Reg=0.00160 | acc=0.9531 | L2-Norm=12.650 | L2-Norm(final)=3.002 | 3934.4 samples/s | 61.5 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00225 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.012 | 3691.3 samples/s | 57.7 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00121 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=3.019 | 5741.6 samples/s | 89.7 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00082 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=3.023 | 1684.1 samples/s | 26.3 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00062 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.026 | 5146.3 samples/s | 80.4 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00050 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.028 | 1704.1 samples/s | 26.6 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00042 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.030 | 4749.7 samples/s | 74.2 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00036 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.031 | 1767.2 samples/s | 27.6 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00032 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=3.032 | 4391.7 samples/s | 68.6 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00029 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.034 | 1761.2 samples/s | 27.5 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00026 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.035 | 4329.3 samples/s | 67.6 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.036 | 1822.2 samples/s | 28.5 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00022 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.037 | 4068.7 samples/s | 63.6 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00020 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.038 | 1855.5 samples/s | 29.0 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00019 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.039 | 4064.8 samples/s | 63.5 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00017 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.040 | 1839.1 samples/s | 28.7 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00016 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.040 | 4034.6 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30807 | acc=0.8476 | tpr=0.7822 | fpr=0.0104 | 3783.8 samples/s | 14.8 steps/s
Avg test loss: 0.30673, Avg test acc: 0.84570, Avg tpr: 0.78143, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.31462 | acc=0.8955 | tpr=0.9513 | fpr=0.1055 | 3772.6 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.31817 | acc=0.8964 | tpr=0.9659 | fpr=0.1049 | 7204.5 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.32195 | acc=0.8955 | tpr=0.9669 | fpr=0.1058 | 7092.7 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.32185 | acc=0.8956 | tpr=0.9683 | fpr=0.1058 | 6998.0 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.31895 | acc=0.8962 | tpr=0.9668 | fpr=0.1050 | 7346.8 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.32077 | acc=0.8958 | tpr=0.9665 | fpr=0.1055 | 7025.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.32349 | acc=0.8952 | tpr=0.9662 | fpr=0.1061 | 7217.3 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.32471 | acc=0.8951 | tpr=0.9672 | fpr=0.1062 | 7034.1 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.32728 | acc=0.8952 | tpr=0.9693 | fpr=0.1062 | 7013.4 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.32696 | acc=0.8949 | tpr=0.9714 | fpr=0.1065 | 6987.6 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.32517 | acc=0.8952 | tpr=0.9706 | fpr=0.1061 | 12803.8 samples/s | 50.0 steps/s
Avg test loss: 0.32490, Avg test acc: 0.89525, Avg tpr: 0.97029, Avg fpr: 0.10612, total FA: 14734

server round 21/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.19124 | Reg=0.00159 | acc=0.8438 | L2-Norm=12.609 | L2-Norm(final)=3.066 | 3832.4 samples/s | 59.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.04139 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.047 | 4067.9 samples/s | 63.6 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02945 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.682 | L2-Norm(final)=3.042 | 4237.2 samples/s | 66.2 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02474 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.694 | L2-Norm(final)=3.043 | 4252.2 samples/s | 66.4 steps/s
[Step=17000 Epoch=82.9] | Loss=0.02084 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=3.046 | 5831.1 samples/s | 91.1 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01824 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.709 | L2-Norm(final)=3.050 | 1742.1 samples/s | 27.2 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01625 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.055 | 4225.1 samples/s | 66.0 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01467 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=3.060 | 4156.2 samples/s | 64.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01378 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=3.064 | 5307.6 samples/s | 82.9 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01286 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.068 | 1762.5 samples/s | 27.5 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01194 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=3.072 | 4226.7 samples/s | 66.0 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01136 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=3.076 | 4281.5 samples/s | 66.9 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01075 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.079 | 4991.6 samples/s | 78.0 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.083 | 1855.8 samples/s | 29.0 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00966 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.087 | 4298.2 samples/s | 67.2 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00935 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.749 | L2-Norm(final)=3.090 | 4259.9 samples/s | 66.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00907 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=3.093 | 4536.3 samples/s | 70.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.0] | Loss=0.25367 | Reg=0.00159 | acc=0.8438 | L2-Norm=12.609 | L2-Norm(final)=3.066 | 3910.5 samples/s | 61.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.04108 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=3.045 | 4050.5 samples/s | 63.3 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02905 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.681 | L2-Norm(final)=3.041 | 4268.7 samples/s | 66.7 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02472 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.043 | 4371.4 samples/s | 68.3 steps/s
[Step=17000 Epoch=83.0] | Loss=0.02074 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=3.048 | 5927.7 samples/s | 92.6 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01781 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.053 | 1748.7 samples/s | 27.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01575 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.058 | 4238.8 samples/s | 66.2 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01425 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.721 | L2-Norm(final)=3.064 | 4209.5 samples/s | 65.8 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01326 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.726 | L2-Norm(final)=3.068 | 5470.4 samples/s | 85.5 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01248 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.073 | 1764.7 samples/s | 27.6 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01164 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.734 | L2-Norm(final)=3.076 | 4276.2 samples/s | 66.8 steps/s
[Step=17350 Epoch=84.7] | Loss=0.01083 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=3.081 | 4202.4 samples/s | 65.7 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01048 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.085 | 5132.2 samples/s | 80.2 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00994 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.088 | 1805.1 samples/s | 28.2 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00959 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.091 | 4289.4 samples/s | 67.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00922 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=3.095 | 4268.3 samples/s | 66.7 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00886 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=3.098 | 4882.3 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.16877 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.609 | L2-Norm(final)=3.066 | 3840.2 samples/s | 60.0 steps/s
[Step=16850 Epoch=82.1] | Loss=0.04158 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.655 | L2-Norm(final)=3.042 | 4030.6 samples/s | 63.0 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02852 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.672 | L2-Norm(final)=3.041 | 4348.0 samples/s | 67.9 steps/s
[Step=16950 Epoch=82.6] | Loss=0.02367 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=3.043 | 4179.1 samples/s | 65.3 steps/s
[Step=17000 Epoch=82.8] | Loss=0.02091 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.046 | 5712.0 samples/s | 89.2 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01817 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.050 | 1751.8 samples/s | 27.4 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01627 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.701 | L2-Norm(final)=3.054 | 4241.4 samples/s | 66.3 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01470 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=3.058 | 4328.1 samples/s | 67.6 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01383 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.063 | 5234.0 samples/s | 81.8 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01319 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.714 | L2-Norm(final)=3.066 | 1800.0 samples/s | 28.1 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01246 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=3.070 | 4221.6 samples/s | 66.0 steps/s
[Step=17350 Epoch=84.5] | Loss=0.01182 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.721 | L2-Norm(final)=3.073 | 4209.6 samples/s | 65.8 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01125 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.076 | 5087.0 samples/s | 79.5 steps/s
[Step=17450 Epoch=85.0] | Loss=0.01066 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=3.080 | 1842.3 samples/s | 28.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.083 | 4314.2 samples/s | 67.4 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00982 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.733 | L2-Norm(final)=3.086 | 4278.5 samples/s | 66.9 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00964 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.089 | 4623.5 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.17293 | Reg=0.00159 | acc=0.9062 | L2-Norm=12.609 | L2-Norm(final)=3.066 | 3963.2 samples/s | 61.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03908 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.662 | L2-Norm(final)=3.042 | 4103.6 samples/s | 64.1 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02740 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=3.042 | 4333.5 samples/s | 67.7 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02226 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.692 | L2-Norm(final)=3.046 | 4236.0 samples/s | 66.2 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01992 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=3.050 | 5881.0 samples/s | 91.9 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01703 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=3.054 | 1722.7 samples/s | 26.9 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01527 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.059 | 4330.8 samples/s | 67.7 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01392 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.719 | L2-Norm(final)=3.063 | 4346.8 samples/s | 67.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01296 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.723 | L2-Norm(final)=3.067 | 5420.9 samples/s | 84.7 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01206 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=3.071 | 1802.9 samples/s | 28.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01150 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.730 | L2-Norm(final)=3.075 | 4269.1 samples/s | 66.7 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01101 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=3.078 | 4229.5 samples/s | 66.1 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01048 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.737 | L2-Norm(final)=3.082 | 5063.0 samples/s | 79.1 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00990 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=3.085 | 1856.1 samples/s | 29.0 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00943 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=3.088 | 4293.0 samples/s | 67.1 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00913 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=3.092 | 4285.0 samples/s | 67.0 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00884 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=3.095 | 4781.9 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.4] | Loss=0.11511 | Reg=0.00159 | acc=0.9062 | L2-Norm=12.609 | L2-Norm(final)=3.067 | 3846.7 samples/s | 60.1 steps/s
[Step=16850 Epoch=82.6] | Loss=0.03003 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.650 | L2-Norm(final)=3.056 | 4150.8 samples/s | 64.9 steps/s
[Step=16900 Epoch=82.9] | Loss=0.02225 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.666 | L2-Norm(final)=3.056 | 4328.6 samples/s | 67.6 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01823 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=3.059 | 4276.0 samples/s | 66.8 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01609 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=3.063 | 5978.3 samples/s | 93.4 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01416 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.068 | 1737.3 samples/s | 27.1 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01282 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.073 | 4261.1 samples/s | 66.6 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01178 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=3.078 | 4236.2 samples/s | 66.2 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01093 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.706 | L2-Norm(final)=3.082 | 5557.6 samples/s | 86.8 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01009 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=3.086 | 1747.1 samples/s | 27.3 steps/s
[Step=17300 Epoch=84.8] | Loss=0.00943 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.713 | L2-Norm(final)=3.090 | 4282.4 samples/s | 66.9 steps/s
[Step=17350 Epoch=85.1] | Loss=0.00922 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.094 | 4254.4 samples/s | 66.5 steps/s
[Step=17400 Epoch=85.3] | Loss=0.00884 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=3.097 | 5259.5 samples/s | 82.2 steps/s
[Step=17450 Epoch=85.6] | Loss=0.00840 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=3.100 | 1786.0 samples/s | 27.9 steps/s
[Step=17500 Epoch=85.8] | Loss=0.00807 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.103 | 4236.9 samples/s | 66.2 steps/s
[Step=17550 Epoch=86.1] | Loss=0.00785 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.727 | L2-Norm(final)=3.106 | 4298.4 samples/s | 67.2 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00758 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=3.109 | 5016.0 samples/s | 78.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step17600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.2] | Loss=0.00703 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.067 | 3913.6 samples/s | 61.2 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00137 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.074 | 3657.9 samples/s | 57.2 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00087 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.077 | 5551.9 samples/s | 86.7 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00062 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=3.080 | 1660.8 samples/s | 26.0 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00047 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.083 | 5088.3 samples/s | 79.5 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00038 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=3.085 | 1737.8 samples/s | 27.2 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00032 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.087 | 4607.8 samples/s | 72.0 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.088 | 1760.9 samples/s | 27.5 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.089 | 4362.1 samples/s | 68.2 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.090 | 1824.3 samples/s | 28.5 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00019 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=3.091 | 4043.7 samples/s | 63.2 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00018 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=3.092 | 1881.4 samples/s | 29.4 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.093 | 3970.7 samples/s | 62.0 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.094 | 1866.8 samples/s | 29.2 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.095 | 4114.1 samples/s | 64.3 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00013 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.095 | 1877.3 samples/s | 29.3 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.096 | 3991.3 samples/s | 62.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.8] | Loss=0.03803 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.609 | L2-Norm(final)=3.066 | 4387.0 samples/s | 68.5 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00202 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.070 | 3604.3 samples/s | 56.3 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00105 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.074 | 5609.3 samples/s | 87.6 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00071 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.076 | 1654.9 samples/s | 25.9 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00054 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.078 | 5182.4 samples/s | 81.0 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00043 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.080 | 1739.8 samples/s | 27.2 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00036 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.081 | 4741.9 samples/s | 74.1 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00031 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.082 | 1737.0 samples/s | 27.1 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=3.083 | 4372.2 samples/s | 68.3 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.084 | 1824.3 samples/s | 28.5 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00022 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.085 | 4149.0 samples/s | 64.8 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00020 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.086 | 1871.2 samples/s | 29.2 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00018 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.087 | 4080.3 samples/s | 63.8 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.087 | 1843.5 samples/s | 28.8 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.088 | 4088.5 samples/s | 63.9 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.089 | 1877.2 samples/s | 29.3 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00014 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=3.089 | 4079.5 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step17600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.4] | Loss=0.00577 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.067 | 3802.0 samples/s | 59.4 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00150 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.080 | 3837.5 samples/s | 60.0 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00078 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=3.086 | 5632.9 samples/s | 88.0 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00053 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=3.089 | 1676.6 samples/s | 26.2 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00040 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.091 | 5110.7 samples/s | 79.9 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00032 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=3.093 | 1670.4 samples/s | 26.1 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=3.094 | 4974.7 samples/s | 77.7 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00023 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.095 | 1721.4 samples/s | 26.9 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00020 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.096 | 4644.0 samples/s | 72.6 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00018 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.096 | 1785.2 samples/s | 27.9 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00016 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.097 | 4358.0 samples/s | 68.1 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=3.098 | 1820.3 samples/s | 28.4 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=3.098 | 4021.7 samples/s | 62.8 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00013 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.099 | 1871.8 samples/s | 29.2 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.099 | 4125.2 samples/s | 64.5 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.100 | 1897.2 samples/s | 29.6 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=3.100 | 4164.4 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=158.3] | Loss=0.00961 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.067 | 3703.7 samples/s | 57.9 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00235 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=3.076 | 3800.5 samples/s | 59.4 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00126 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.081 | 5421.6 samples/s | 84.7 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00085 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=3.084 | 1672.9 samples/s | 26.1 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00065 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=3.087 | 4863.1 samples/s | 76.0 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00052 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=3.088 | 1730.2 samples/s | 27.0 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00044 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.090 | 4616.1 samples/s | 72.1 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00038 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.091 | 1782.7 samples/s | 27.9 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00033 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.092 | 4267.8 samples/s | 66.7 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00029 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.093 | 1832.9 samples/s | 28.6 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.094 | 4015.1 samples/s | 62.7 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.094 | 1836.5 samples/s | 28.7 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00022 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.095 | 4101.8 samples/s | 64.1 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.096 | 1888.0 samples/s | 29.5 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00019 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=3.096 | 3966.5 samples/s | 62.0 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00018 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.097 | 1992.3 samples/s | 31.1 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=3.098 | 3533.0 samples/s | 55.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.1] | Loss=0.03733 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.609 | L2-Norm(final)=3.067 | 3736.7 samples/s | 58.4 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00155 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.076 | 3799.9 samples/s | 59.4 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00080 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.080 | 5585.5 samples/s | 87.3 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00054 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=3.083 | 1694.4 samples/s | 26.5 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00041 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.084 | 5134.3 samples/s | 80.2 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00033 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.086 | 1702.8 samples/s | 26.6 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.087 | 4849.5 samples/s | 75.8 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.088 | 1731.8 samples/s | 27.1 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.089 | 4594.1 samples/s | 71.8 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00019 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.090 | 1764.0 samples/s | 27.6 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00017 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.091 | 4426.4 samples/s | 69.2 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00016 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=3.092 | 1827.3 samples/s | 28.6 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.093 | 4102.6 samples/s | 64.1 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00013 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.094 | 1855.3 samples/s | 29.0 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=3.094 | 4127.4 samples/s | 64.5 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.095 | 1849.1 samples/s | 28.9 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.096 | 4046.2 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37487 | acc=0.8244 | tpr=0.7476 | fpr=0.0089 | 3741.4 samples/s | 14.6 steps/s
Avg test loss: 0.37493, Avg test acc: 0.82290, Avg tpr: 0.74704, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.27935 | acc=0.9155 | tpr=0.9469 | fpr=0.0851 | 3794.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.28415 | acc=0.9177 | tpr=0.9638 | fpr=0.0832 | 7190.1 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.28811 | acc=0.9171 | tpr=0.9654 | fpr=0.0838 | 7078.4 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.28790 | acc=0.9171 | tpr=0.9672 | fpr=0.0839 | 7198.6 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.28514 | acc=0.9175 | tpr=0.9651 | fpr=0.0834 | 7259.6 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.28708 | acc=0.9170 | tpr=0.9651 | fpr=0.0839 | 6955.9 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.28985 | acc=0.9167 | tpr=0.9649 | fpr=0.0842 | 6958.8 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.29118 | acc=0.9166 | tpr=0.9650 | fpr=0.0843 | 7180.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.29391 | acc=0.9167 | tpr=0.9669 | fpr=0.0842 | 6982.6 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.29342 | acc=0.9166 | tpr=0.9687 | fpr=0.0843 | 7019.7 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.29173 | acc=0.9170 | tpr=0.9674 | fpr=0.0840 | 13488.0 samples/s | 52.7 steps/s
Avg test loss: 0.29143, Avg test acc: 0.91698, Avg tpr: 0.96672, Avg fpr: 0.08393, total FA: 11653

server round 22/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.15356 | Reg=0.00158 | acc=0.8594 | L2-Norm=12.566 | L2-Norm(final)=3.123 | 3982.0 samples/s | 62.2 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03386 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.611 | L2-Norm(final)=3.103 | 3968.6 samples/s | 62.0 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02561 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.098 | 4341.8 samples/s | 67.8 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02139 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.638 | L2-Norm(final)=3.099 | 4344.1 samples/s | 67.9 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01901 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.102 | 5816.9 samples/s | 90.9 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01653 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.105 | 1738.2 samples/s | 27.2 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01475 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=3.110 | 4334.1 samples/s | 67.7 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01379 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=3.114 | 4287.9 samples/s | 67.0 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01273 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.117 | 5409.8 samples/s | 84.5 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01177 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=3.122 | 1776.3 samples/s | 27.8 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01124 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.680 | L2-Norm(final)=3.125 | 4203.7 samples/s | 65.7 steps/s
[Step=18150 Epoch=88.5] | Loss=0.01071 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=3.129 | 4273.8 samples/s | 66.8 steps/s
[Step=18200 Epoch=88.7] | Loss=0.01028 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.686 | L2-Norm(final)=3.132 | 4938.7 samples/s | 77.2 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00982 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.135 | 1840.5 samples/s | 28.8 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00937 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.138 | 4294.0 samples/s | 67.1 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00904 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.141 | 4239.1 samples/s | 66.2 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00888 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.144 | 4661.4 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.9] | Loss=0.36896 | Reg=0.00158 | acc=0.7812 | L2-Norm=12.566 | L2-Norm(final)=3.122 | 3985.2 samples/s | 62.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03547 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.101 | 3987.8 samples/s | 62.3 steps/s
[Step=17700 Epoch=86.4] | Loss=0.02637 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.631 | L2-Norm(final)=3.099 | 4223.7 samples/s | 66.0 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02243 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.100 | 4112.0 samples/s | 64.2 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01996 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.102 | 5743.7 samples/s | 89.7 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01704 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.105 | 1731.3 samples/s | 27.1 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01496 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.110 | 4276.5 samples/s | 66.8 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01359 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=3.114 | 4309.1 samples/s | 67.3 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01244 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=3.119 | 5429.8 samples/s | 84.8 steps/s
[Step=18050 Epoch=88.1] | Loss=0.01178 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=3.123 | 1770.0 samples/s | 27.7 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01096 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.680 | L2-Norm(final)=3.126 | 4232.3 samples/s | 66.1 steps/s
[Step=18150 Epoch=88.6] | Loss=0.01051 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=3.129 | 4332.1 samples/s | 67.7 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00998 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.686 | L2-Norm(final)=3.132 | 5039.7 samples/s | 78.7 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00959 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.135 | 1833.9 samples/s | 28.7 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00912 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.138 | 4202.4 samples/s | 65.7 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00880 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.141 | 4331.3 samples/s | 67.7 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00850 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.144 | 4988.1 samples/s | 77.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.13323 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.566 | L2-Norm(final)=3.123 | 3723.7 samples/s | 58.2 steps/s
[Step=17650 Epoch=86.0] | Loss=0.04177 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.095 | 4227.3 samples/s | 66.1 steps/s
[Step=17700 Epoch=86.2] | Loss=0.03023 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.623 | L2-Norm(final)=3.090 | 4253.0 samples/s | 66.5 steps/s
[Step=17750 Epoch=86.5] | Loss=0.02463 | Reg=0.00160 | acc=0.9531 | L2-Norm=12.635 | L2-Norm(final)=3.092 | 4338.2 samples/s | 67.8 steps/s
[Step=17800 Epoch=86.7] | Loss=0.02158 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.095 | 5817.7 samples/s | 90.9 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01910 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.099 | 1739.8 samples/s | 27.2 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01712 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.659 | L2-Norm(final)=3.103 | 4364.4 samples/s | 68.2 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01577 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.107 | 4255.3 samples/s | 66.5 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01476 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=3.110 | 5389.4 samples/s | 84.2 steps/s
[Step=18050 Epoch=87.9] | Loss=0.01372 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.114 | 1777.8 samples/s | 27.8 steps/s
[Step=18100 Epoch=88.2] | Loss=0.01296 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.118 | 4323.4 samples/s | 67.6 steps/s
[Step=18150 Epoch=88.4] | Loss=0.01244 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.681 | L2-Norm(final)=3.121 | 4282.2 samples/s | 66.9 steps/s
[Step=18200 Epoch=88.7] | Loss=0.01188 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.124 | 5010.2 samples/s | 78.3 steps/s
[Step=18250 Epoch=88.9] | Loss=0.01133 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=3.127 | 1831.0 samples/s | 28.6 steps/s
[Step=18300 Epoch=89.2] | Loss=0.01088 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.130 | 4388.7 samples/s | 68.6 steps/s
[Step=18350 Epoch=89.4] | Loss=0.01048 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.694 | L2-Norm(final)=3.134 | 4173.0 samples/s | 65.2 steps/s
[Step=18400 Epoch=89.7] | Loss=0.01007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.137 | 4656.3 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.38571 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.566 | L2-Norm(final)=3.121 | 3863.5 samples/s | 60.4 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03280 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=3.101 | 3987.7 samples/s | 62.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02543 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.100 | 4392.4 samples/s | 68.6 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02079 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.101 | 4378.4 samples/s | 68.4 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01795 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.105 | 5856.2 samples/s | 91.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01590 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.109 | 1757.3 samples/s | 27.5 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01415 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.114 | 4322.4 samples/s | 67.5 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01284 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.119 | 4193.2 samples/s | 65.5 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01216 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.123 | 5390.9 samples/s | 84.2 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01122 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.674 | L2-Norm(final)=3.127 | 1796.6 samples/s | 28.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01087 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=3.131 | 4308.1 samples/s | 67.3 steps/s
[Step=18150 Epoch=88.5] | Loss=0.01021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=3.134 | 4304.5 samples/s | 67.3 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00978 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=3.138 | 4927.7 samples/s | 77.0 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00926 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.141 | 1845.5 samples/s | 28.8 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00910 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.144 | 4238.1 samples/s | 66.2 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00873 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.147 | 4296.1 samples/s | 67.1 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00832 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.150 | 4701.7 samples/s | 73.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step18400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=86.3] | Loss=0.08249 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.566 | L2-Norm(final)=3.123 | 4014.4 samples/s | 62.7 steps/s
[Step=17650 Epoch=86.6] | Loss=0.03395 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=3.103 | 3859.8 samples/s | 60.3 steps/s
[Step=17700 Epoch=86.8] | Loss=0.02462 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.100 | 4205.6 samples/s | 65.7 steps/s
[Step=17750 Epoch=87.0] | Loss=0.02073 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.640 | L2-Norm(final)=3.101 | 4262.9 samples/s | 66.6 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01842 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.649 | L2-Norm(final)=3.104 | 5970.2 samples/s | 93.3 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01552 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.656 | L2-Norm(final)=3.109 | 1743.2 samples/s | 27.2 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01396 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=3.114 | 4320.2 samples/s | 67.5 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01306 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=3.118 | 4342.0 samples/s | 67.8 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01214 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=3.121 | 5580.0 samples/s | 87.2 steps/s
[Step=18050 Epoch=88.5] | Loss=0.01116 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=3.124 | 1755.0 samples/s | 27.4 steps/s
[Step=18100 Epoch=88.8] | Loss=0.01061 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.128 | 4085.0 samples/s | 63.8 steps/s
[Step=18150 Epoch=89.0] | Loss=0.01012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.131 | 4202.0 samples/s | 65.7 steps/s
[Step=18200 Epoch=89.2] | Loss=0.00979 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.134 | 5366.4 samples/s | 83.9 steps/s
[Step=18250 Epoch=89.5] | Loss=0.00920 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.137 | 1771.6 samples/s | 27.7 steps/s
[Step=18300 Epoch=89.7] | Loss=0.00889 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.140 | 4275.4 samples/s | 66.8 steps/s
[Step=18350 Epoch=90.0] | Loss=0.00851 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=3.143 | 4201.8 samples/s | 65.7 steps/s
[Step=18400 Epoch=90.2] | Loss=0.00829 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.146 | 5121.6 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=166.8] | Loss=0.03007 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.566 | L2-Norm(final)=3.124 | 3813.2 samples/s | 59.6 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00149 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.136 | 3676.6 samples/s | 57.4 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00269 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.132 | 5514.5 samples/s | 86.2 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00181 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.129 | 1650.3 samples/s | 25.8 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00136 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.127 | 5154.5 samples/s | 80.5 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00109 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.127 | 1717.6 samples/s | 26.8 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00091 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.127 | 4617.6 samples/s | 72.1 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00079 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.127 | 1750.4 samples/s | 27.4 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00069 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.128 | 4396.0 samples/s | 68.7 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00061 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.128 | 1833.5 samples/s | 28.6 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00055 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.128 | 4206.3 samples/s | 65.7 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00050 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.129 | 1835.0 samples/s | 28.7 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00046 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.129 | 4064.7 samples/s | 63.5 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00043 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=3.129 | 1888.9 samples/s | 29.5 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00040 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.130 | 4013.5 samples/s | 62.7 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00037 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=3.130 | 1895.5 samples/s | 29.6 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00035 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.131 | 4019.8 samples/s | 62.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.4] | Loss=0.10247 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.566 | L2-Norm(final)=3.122 | 3848.8 samples/s | 60.1 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00363 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.119 | 3689.3 samples/s | 57.6 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00185 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=3.124 | 5545.9 samples/s | 86.7 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00124 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=3.126 | 1667.8 samples/s | 26.1 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00093 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.128 | 4984.5 samples/s | 77.9 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00075 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.129 | 1718.1 samples/s | 26.8 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00062 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.131 | 4756.7 samples/s | 74.3 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00054 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.132 | 1761.5 samples/s | 27.5 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00047 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.133 | 4320.1 samples/s | 67.5 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00042 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=3.134 | 1822.2 samples/s | 28.5 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00038 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.134 | 4150.1 samples/s | 64.8 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00034 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.135 | 1872.2 samples/s | 29.3 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00032 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.136 | 4077.3 samples/s | 63.7 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00029 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.137 | 1886.8 samples/s | 29.5 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00027 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.137 | 4171.7 samples/s | 65.2 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00025 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.138 | 1896.3 samples/s | 29.6 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00024 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.139 | 3971.4 samples/s | 62.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step18400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=168.1] | Loss=0.00614 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.124 | 3595.2 samples/s | 56.2 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00118 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.138 | 3896.2 samples/s | 60.9 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00070 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=3.143 | 5538.8 samples/s | 86.5 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00047 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.145 | 1664.4 samples/s | 26.0 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00035 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.147 | 5156.8 samples/s | 80.6 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00028 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=3.148 | 1701.8 samples/s | 26.6 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00024 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=3.149 | 4830.3 samples/s | 75.5 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00020 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.150 | 1727.2 samples/s | 27.0 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00018 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.150 | 4659.3 samples/s | 72.8 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.151 | 1786.5 samples/s | 27.9 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00014 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.151 | 4313.8 samples/s | 67.4 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.151 | 1848.5 samples/s | 28.9 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00012 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.152 | 4201.5 samples/s | 65.6 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=3.152 | 1871.3 samples/s | 29.2 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.152 | 4057.9 samples/s | 63.4 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.153 | 1873.5 samples/s | 29.3 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00009 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.153 | 4109.1 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=165.9] | Loss=0.01957 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.566 | L2-Norm(final)=3.124 | 4112.0 samples/s | 64.2 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00378 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.134 | 3624.2 samples/s | 56.6 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00199 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.137 | 5529.2 samples/s | 86.4 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00135 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.140 | 1682.2 samples/s | 26.3 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00102 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.142 | 4921.2 samples/s | 76.9 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00082 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.144 | 1719.4 samples/s | 26.9 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00068 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.145 | 4502.2 samples/s | 70.3 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00059 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.146 | 1797.4 samples/s | 28.1 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00052 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.147 | 4153.6 samples/s | 64.9 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00046 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.148 | 1829.2 samples/s | 28.6 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00041 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.148 | 4049.3 samples/s | 63.3 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00038 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.634 | L2-Norm(final)=3.149 | 1859.0 samples/s | 29.0 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00035 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.150 | 4045.4 samples/s | 63.2 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00032 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=3.151 | 1891.2 samples/s | 29.5 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00030 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.151 | 3999.9 samples/s | 62.5 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00028 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.152 | 2071.8 samples/s | 32.4 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00026 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.152 | 3348.5 samples/s | 52.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.8] | Loss=0.07326 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.566 | L2-Norm(final)=3.123 | 3677.3 samples/s | 57.5 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00310 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=3.114 | 3736.3 samples/s | 58.4 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00159 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.116 | 5621.1 samples/s | 87.8 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00110 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.118 | 1640.6 samples/s | 25.6 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00083 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.120 | 5094.7 samples/s | 79.6 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00067 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.122 | 1688.5 samples/s | 26.4 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00056 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.123 | 4887.6 samples/s | 76.4 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00048 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=3.124 | 1738.8 samples/s | 27.2 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00042 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.125 | 4562.4 samples/s | 71.3 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00037 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=3.125 | 1759.8 samples/s | 27.5 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00034 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.126 | 4219.5 samples/s | 65.9 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00031 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.127 | 1823.1 samples/s | 28.5 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00028 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.127 | 4115.6 samples/s | 64.3 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00026 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.128 | 1879.8 samples/s | 29.4 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00024 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.128 | 3918.7 samples/s | 61.2 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00023 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.129 | 1874.4 samples/s | 29.3 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00021 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.129 | 4040.1 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30009 | acc=0.8519 | tpr=0.7883 | fpr=0.0102 | 3754.3 samples/s | 14.7 steps/s
Avg test loss: 0.30049, Avg test acc: 0.85083, Avg tpr: 0.78895, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.32825 | acc=0.8993 | tpr=0.9558 | fpr=0.1017 | 3762.3 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.33115 | acc=0.9016 | tpr=0.9680 | fpr=0.0996 | 7275.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.33507 | acc=0.9010 | tpr=0.9683 | fpr=0.1003 | 7303.8 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.33521 | acc=0.9011 | tpr=0.9694 | fpr=0.1001 | 6996.6 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.33218 | acc=0.9016 | tpr=0.9677 | fpr=0.0996 | 7296.3 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.33431 | acc=0.9009 | tpr=0.9687 | fpr=0.1003 | 7089.4 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.33733 | acc=0.9005 | tpr=0.9681 | fpr=0.1008 | 7039.7 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.33854 | acc=0.9002 | tpr=0.9672 | fpr=0.1010 | 7084.4 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.34130 | acc=0.9003 | tpr=0.9688 | fpr=0.1010 | 6943.6 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.34072 | acc=0.8999 | tpr=0.9705 | fpr=0.1014 | 7256.2 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.33862 | acc=0.9003 | tpr=0.9702 | fpr=0.1009 | 13250.0 samples/s | 51.8 steps/s
Avg test loss: 0.33829, Avg test acc: 0.90036, Avg tpr: 0.96989, Avg fpr: 0.10091, total FA: 14011

server round 23/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.14584 | Reg=0.00157 | acc=0.8750 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3920.5 samples/s | 61.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03321 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.150 | 3949.3 samples/s | 61.7 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02423 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.590 | L2-Norm(final)=3.143 | 4179.3 samples/s | 65.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02021 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.144 | 4144.1 samples/s | 64.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01867 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.145 | 5799.4 samples/s | 90.6 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01635 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.616 | L2-Norm(final)=3.148 | 1746.2 samples/s | 27.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01451 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.152 | 4344.2 samples/s | 67.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01338 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.155 | 4253.9 samples/s | 66.5 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01248 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.632 | L2-Norm(final)=3.159 | 5440.3 samples/s | 85.0 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01173 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=3.162 | 1808.1 samples/s | 28.3 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01108 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.164 | 4384.4 samples/s | 68.5 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01052 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.167 | 4305.3 samples/s | 67.3 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00995 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.170 | 4870.9 samples/s | 76.1 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00967 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.173 | 1873.8 samples/s | 29.3 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00922 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.176 | 4319.5 samples/s | 67.5 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00882 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.179 | 4404.0 samples/s | 68.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00872 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.181 | 4733.6 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.8] | Loss=0.18576 | Reg=0.00157 | acc=0.9062 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3962.8 samples/s | 61.9 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02848 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.568 | L2-Norm(final)=3.154 | 3875.6 samples/s | 60.6 steps/s
[Step=18500 Epoch=90.3] | Loss=0.02164 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.584 | L2-Norm(final)=3.151 | 4272.4 samples/s | 66.8 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01895 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.153 | 4190.2 samples/s | 65.5 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01679 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.156 | 5874.3 samples/s | 91.8 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01470 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.611 | L2-Norm(final)=3.160 | 1703.4 samples/s | 26.6 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01300 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.618 | L2-Norm(final)=3.165 | 4330.4 samples/s | 67.7 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01218 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=3.169 | 4230.7 samples/s | 66.1 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01133 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.173 | 5392.9 samples/s | 84.3 steps/s
[Step=18850 Epoch=92.0] | Loss=0.01052 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.177 | 1809.4 samples/s | 28.3 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00993 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=3.181 | 4200.8 samples/s | 65.6 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00940 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.184 | 4318.3 samples/s | 67.5 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00906 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.188 | 5144.1 samples/s | 80.4 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00870 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.191 | 1790.3 samples/s | 28.0 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00831 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.195 | 4270.3 samples/s | 66.7 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00801 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.198 | 4287.0 samples/s | 67.0 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00784 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.201 | 4939.7 samples/s | 77.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.16359 | Reg=0.00157 | acc=0.8750 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3906.2 samples/s | 61.0 steps/s
[Step=18450 Epoch=89.9] | Loss=0.02663 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=3.154 | 4133.1 samples/s | 64.6 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02272 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=3.149 | 4314.7 samples/s | 67.4 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01995 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.595 | L2-Norm(final)=3.149 | 4338.4 samples/s | 67.8 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01798 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.152 | 5844.6 samples/s | 91.3 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01576 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.613 | L2-Norm(final)=3.157 | 1728.6 samples/s | 27.0 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01412 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.161 | 4330.1 samples/s | 67.7 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01328 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.165 | 4167.3 samples/s | 65.1 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01272 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.168 | 5275.6 samples/s | 82.4 steps/s
[Step=18850 Epoch=91.8] | Loss=0.01202 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.171 | 1790.9 samples/s | 28.0 steps/s
[Step=18900 Epoch=92.1] | Loss=0.01127 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.636 | L2-Norm(final)=3.175 | 4369.9 samples/s | 68.3 steps/s
[Step=18950 Epoch=92.3] | Loss=0.01071 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=3.178 | 4288.3 samples/s | 67.0 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01031 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.181 | 4938.9 samples/s | 77.2 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00980 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.185 | 1841.7 samples/s | 28.8 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00942 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.188 | 4149.7 samples/s | 64.8 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00914 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.651 | L2-Norm(final)=3.191 | 4208.2 samples/s | 65.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00898 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.654 | L2-Norm(final)=3.194 | 4521.0 samples/s | 70.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.14332 | Reg=0.00157 | acc=0.8438 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3749.7 samples/s | 58.6 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02970 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.576 | L2-Norm(final)=3.151 | 4155.2 samples/s | 64.9 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02064 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.594 | L2-Norm(final)=3.154 | 4353.6 samples/s | 68.0 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01807 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.605 | L2-Norm(final)=3.156 | 4317.8 samples/s | 67.5 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01617 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.613 | L2-Norm(final)=3.159 | 5794.5 samples/s | 90.5 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01457 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.162 | 1764.2 samples/s | 27.6 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01309 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.166 | 4321.2 samples/s | 67.5 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01196 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.170 | 4185.5 samples/s | 65.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01137 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.636 | L2-Norm(final)=3.173 | 5353.0 samples/s | 83.6 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01086 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.640 | L2-Norm(final)=3.177 | 1760.4 samples/s | 27.5 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01010 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.643 | L2-Norm(final)=3.180 | 4203.0 samples/s | 65.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00953 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.183 | 4249.3 samples/s | 66.4 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00912 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.187 | 4982.9 samples/s | 77.9 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00877 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.190 | 1839.0 samples/s | 28.7 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00846 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.193 | 4302.3 samples/s | 67.2 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00815 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.656 | L2-Norm(final)=3.196 | 4312.6 samples/s | 67.4 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00787 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.199 | 4685.7 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step19200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=90.2] | Loss=0.18929 | Reg=0.00157 | acc=0.8750 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3816.9 samples/s | 59.6 steps/s
[Step=18450 Epoch=90.5] | Loss=0.03411 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.569 | L2-Norm(final)=3.152 | 4098.9 samples/s | 64.0 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02491 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.584 | L2-Norm(final)=3.147 | 4177.6 samples/s | 65.3 steps/s
[Step=18550 Epoch=91.0] | Loss=0.02047 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.148 | 4250.2 samples/s | 66.4 steps/s
[Step=18600 Epoch=91.2] | Loss=0.01807 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=3.151 | 5996.5 samples/s | 93.7 steps/s
[Step=18650 Epoch=91.5] | Loss=0.01553 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.154 | 1738.0 samples/s | 27.2 steps/s
[Step=18700 Epoch=91.7] | Loss=0.01411 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.157 | 4350.2 samples/s | 68.0 steps/s
[Step=18750 Epoch=91.9] | Loss=0.01262 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=3.161 | 4304.7 samples/s | 67.3 steps/s
[Step=18800 Epoch=92.2] | Loss=0.01179 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=3.164 | 5678.1 samples/s | 88.7 steps/s
[Step=18850 Epoch=92.4] | Loss=0.01111 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.168 | 1765.0 samples/s | 27.6 steps/s
[Step=18900 Epoch=92.7] | Loss=0.01030 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.171 | 4292.5 samples/s | 67.1 steps/s
[Step=18950 Epoch=92.9] | Loss=0.00986 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.627 | L2-Norm(final)=3.174 | 4264.8 samples/s | 66.6 steps/s
[Step=19000 Epoch=93.2] | Loss=0.00938 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.630 | L2-Norm(final)=3.177 | 5162.1 samples/s | 80.7 steps/s
[Step=19050 Epoch=93.4] | Loss=0.00887 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.180 | 1784.4 samples/s | 27.9 steps/s
[Step=19100 Epoch=93.7] | Loss=0.00853 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.635 | L2-Norm(final)=3.183 | 4334.8 samples/s | 67.7 steps/s
[Step=19150 Epoch=93.9] | Loss=0.00820 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.186 | 4285.8 samples/s | 67.0 steps/s
[Step=19200 Epoch=94.2] | Loss=0.00801 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.639 | L2-Norm(final)=3.190 | 5082.2 samples/s | 79.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step19200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=174.4] | Loss=0.02802 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.528 | L2-Norm(final)=3.167 | 3801.9 samples/s | 59.4 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00315 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=3.161 | 3674.6 samples/s | 57.4 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00159 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.162 | 5507.5 samples/s | 86.1 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00108 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.164 | 1653.5 samples/s | 25.8 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00081 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.165 | 5132.6 samples/s | 80.2 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00065 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.166 | 1731.8 samples/s | 27.1 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00055 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.166 | 4730.1 samples/s | 73.9 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00047 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.167 | 1747.3 samples/s | 27.3 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00041 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.168 | 4443.6 samples/s | 69.4 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00037 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.168 | 1802.8 samples/s | 28.2 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00033 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.169 | 4092.3 samples/s | 63.9 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00030 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.169 | 1827.3 samples/s | 28.6 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00028 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=3.170 | 3940.4 samples/s | 61.6 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00026 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=3.170 | 1874.3 samples/s | 29.3 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00024 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.171 | 4041.4 samples/s | 63.1 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00022 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.171 | 1882.3 samples/s | 29.4 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00021 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.172 | 4137.8 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step19200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.0] | Loss=0.00257 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.168 | 4034.6 samples/s | 63.0 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00176 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.178 | 3649.9 samples/s | 57.0 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00093 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.183 | 5533.4 samples/s | 86.5 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00062 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.185 | 1646.2 samples/s | 25.7 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00047 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.186 | 5077.2 samples/s | 79.3 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00038 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=3.187 | 1722.0 samples/s | 26.9 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00031 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=3.188 | 4717.3 samples/s | 73.7 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00027 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.188 | 1796.9 samples/s | 28.1 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00024 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=3.189 | 4528.2 samples/s | 70.8 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00021 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=3.189 | 1819.9 samples/s | 28.4 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00019 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.189 | 4075.3 samples/s | 63.7 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00017 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.189 | 1867.3 samples/s | 29.2 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00016 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.190 | 4157.2 samples/s | 65.0 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=3.190 | 1918.3 samples/s | 30.0 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00014 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.190 | 4086.3 samples/s | 63.8 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00013 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.191 | 1929.6 samples/s | 30.2 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.191 | 3998.4 samples/s | 62.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.7] | Loss=0.01060 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.168 | 3601.8 samples/s | 56.3 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00144 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.179 | 3745.6 samples/s | 58.5 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00076 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.184 | 5658.4 samples/s | 88.4 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00052 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.187 | 1665.6 samples/s | 26.0 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00039 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.190 | 5177.9 samples/s | 80.9 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00031 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.191 | 1681.8 samples/s | 26.3 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00026 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=3.192 | 4825.1 samples/s | 75.4 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00022 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=3.193 | 1753.7 samples/s | 27.4 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00020 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=3.194 | 4395.6 samples/s | 68.7 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00018 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.195 | 1774.9 samples/s | 27.7 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.196 | 4320.4 samples/s | 67.5 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00014 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.196 | 1844.6 samples/s | 28.8 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00013 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.197 | 4240.5 samples/s | 66.3 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.197 | 1851.9 samples/s | 28.9 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.198 | 4092.7 samples/s | 63.9 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.198 | 1831.3 samples/s | 28.6 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.199 | 3952.0 samples/s | 61.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step19200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=173.4] | Loss=0.00335 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.168 | 3768.7 samples/s | 58.9 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00136 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.181 | 3811.2 samples/s | 59.6 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00070 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=3.185 | 5553.9 samples/s | 86.8 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00047 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=3.187 | 1686.1 samples/s | 26.3 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00036 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=3.188 | 5004.7 samples/s | 78.2 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00029 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.189 | 1749.9 samples/s | 27.3 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00024 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.189 | 4576.4 samples/s | 71.5 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00021 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.190 | 1797.2 samples/s | 28.1 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00018 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.191 | 4107.1 samples/s | 64.2 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.191 | 1840.4 samples/s | 28.8 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00015 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.192 | 4065.0 samples/s | 63.5 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.192 | 1889.7 samples/s | 29.5 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.193 | 4106.6 samples/s | 64.2 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.193 | 1899.8 samples/s | 29.7 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.194 | 4013.3 samples/s | 62.7 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.194 | 1971.4 samples/s | 30.8 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00009 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.194 | 3840.8 samples/s | 60.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.4] | Loss=0.00561 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.168 | 3601.1 samples/s | 56.3 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00231 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=3.172 | 4008.3 samples/s | 62.6 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00117 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.175 | 5658.4 samples/s | 88.4 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00079 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.177 | 1651.0 samples/s | 25.8 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00059 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=3.179 | 5149.7 samples/s | 80.5 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00048 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.180 | 1691.5 samples/s | 26.4 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00040 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.181 | 4896.5 samples/s | 76.5 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00034 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=3.182 | 1764.6 samples/s | 27.6 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00030 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=3.183 | 4604.8 samples/s | 72.0 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00027 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.183 | 1830.7 samples/s | 28.6 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00024 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=3.184 | 4253.5 samples/s | 66.5 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00022 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.185 | 1813.1 samples/s | 28.3 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00020 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.186 | 4078.8 samples/s | 63.7 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00019 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.186 | 1863.5 samples/s | 29.1 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=3.187 | 4036.0 samples/s | 63.1 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00016 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.188 | 1922.3 samples/s | 30.0 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.188 | 3985.4 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35430 | acc=0.8341 | tpr=0.7616 | fpr=0.0084 | 3739.6 samples/s | 14.6 steps/s
Avg test loss: 0.35410, Avg test acc: 0.83220, Avg tpr: 0.76068, Avg fpr: 0.01051, total FA: 82

Testing server on iccad2012
[Step=  50] | Loss=0.30440 | acc=0.9140 | tpr=0.9513 | fpr=0.0867 | 3785.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.30813 | acc=0.9151 | tpr=0.9659 | fpr=0.0859 | 7203.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.31287 | acc=0.9143 | tpr=0.9669 | fpr=0.0866 | 7252.1 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.31326 | acc=0.9139 | tpr=0.9672 | fpr=0.0871 | 7002.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.31014 | acc=0.9143 | tpr=0.9659 | fpr=0.0866 | 7081.2 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.31223 | acc=0.9138 | tpr=0.9673 | fpr=0.0872 | 7161.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.31518 | acc=0.9132 | tpr=0.9668 | fpr=0.0878 | 7187.9 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.31644 | acc=0.9131 | tpr=0.9666 | fpr=0.0879 | 7413.5 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.31935 | acc=0.9131 | tpr=0.9688 | fpr=0.0879 | 6830.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.31861 | acc=0.9130 | tpr=0.9705 | fpr=0.0880 | 6972.2 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.31662 | acc=0.9134 | tpr=0.9702 | fpr=0.0876 | 13249.7 samples/s | 51.8 steps/s
Avg test loss: 0.31630, Avg test acc: 0.91342, Avg tpr: 0.96989, Avg fpr: 0.08761, total FA: 12164

server round 24/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.29203 | Reg=0.00156 | acc=0.8750 | L2-Norm=12.488 | L2-Norm(final)=3.211 | 3976.9 samples/s | 62.1 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03494 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.187 | 4096.5 samples/s | 64.0 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02668 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.182 | 4261.6 samples/s | 66.6 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02267 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.182 | 4326.1 samples/s | 67.6 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01926 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.184 | 5912.4 samples/s | 92.4 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01669 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=3.186 | 1723.8 samples/s | 26.9 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01463 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.589 | L2-Norm(final)=3.190 | 4152.0 samples/s | 64.9 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01339 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.193 | 4271.5 samples/s | 66.7 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01263 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.597 | L2-Norm(final)=3.196 | 5276.6 samples/s | 82.4 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01187 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.199 | 1804.5 samples/s | 28.2 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01109 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.202 | 4329.7 samples/s | 67.7 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01049 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.206 | 4227.4 samples/s | 66.1 steps/s
[Step=19800 Epoch=96.5] | Loss=0.01024 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=3.208 | 4977.4 samples/s | 77.8 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00990 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.612 | L2-Norm(final)=3.210 | 1818.0 samples/s | 28.4 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00956 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=3.213 | 4215.0 samples/s | 65.9 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00915 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.215 | 4226.4 samples/s | 66.0 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00888 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=3.217 | 4670.7 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.7] | Loss=0.13066 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.488 | L2-Norm(final)=3.213 | 3751.7 samples/s | 58.6 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03764 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.186 | 4118.5 samples/s | 64.4 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02804 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.562 | L2-Norm(final)=3.181 | 4235.4 samples/s | 66.2 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02389 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.182 | 4242.5 samples/s | 66.3 steps/s
[Step=19400 Epoch=94.7] | Loss=0.02066 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.582 | L2-Norm(final)=3.185 | 5803.9 samples/s | 90.7 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01777 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.589 | L2-Norm(final)=3.188 | 1727.6 samples/s | 27.0 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01592 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.596 | L2-Norm(final)=3.192 | 4190.1 samples/s | 65.5 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01436 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.195 | 4202.6 samples/s | 65.7 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01333 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.605 | L2-Norm(final)=3.199 | 5426.2 samples/s | 84.8 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01213 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.202 | 1746.9 samples/s | 27.3 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01135 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.206 | 4255.7 samples/s | 66.5 steps/s
[Step=19750 Epoch=96.4] | Loss=0.01077 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.209 | 4295.7 samples/s | 67.1 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01027 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.212 | 5089.2 samples/s | 79.5 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00976 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.215 | 1804.5 samples/s | 28.2 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00935 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.624 | L2-Norm(final)=3.218 | 4205.6 samples/s | 65.7 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00903 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.221 | 4209.8 samples/s | 65.8 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00869 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=3.224 | 4777.8 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.16459 | Reg=0.00156 | acc=0.9062 | L2-Norm=12.488 | L2-Norm(final)=3.212 | 3948.8 samples/s | 61.7 steps/s
[Step=19250 Epoch=93.8] | Loss=0.03350 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=3.188 | 3957.8 samples/s | 61.8 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02398 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.185 | 4214.5 samples/s | 65.9 steps/s
[Step=19350 Epoch=94.3] | Loss=0.02050 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=3.186 | 4210.3 samples/s | 65.8 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01799 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.189 | 5793.9 samples/s | 90.5 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01607 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=3.193 | 1734.6 samples/s | 27.1 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01429 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=3.197 | 4185.7 samples/s | 65.4 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01310 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=3.201 | 4201.6 samples/s | 65.7 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01221 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.205 | 5278.0 samples/s | 82.5 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01146 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=3.209 | 1784.9 samples/s | 27.9 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01079 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.212 | 4297.2 samples/s | 67.1 steps/s
[Step=19750 Epoch=96.2] | Loss=0.01035 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.216 | 4252.7 samples/s | 66.4 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00991 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.219 | 5012.9 samples/s | 78.3 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00950 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.223 | 1838.9 samples/s | 28.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00909 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=3.226 | 4298.3 samples/s | 67.2 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00874 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.229 | 4300.4 samples/s | 67.2 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00857 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.619 | L2-Norm(final)=3.232 | 4637.4 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.15178 | Reg=0.00156 | acc=0.9062 | L2-Norm=12.488 | L2-Norm(final)=3.212 | 3989.5 samples/s | 62.3 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02964 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.542 | L2-Norm(final)=3.198 | 3922.0 samples/s | 61.3 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02064 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.560 | L2-Norm(final)=3.196 | 4240.7 samples/s | 66.3 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01841 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.571 | L2-Norm(final)=3.198 | 4319.6 samples/s | 67.5 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01645 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.200 | 5820.8 samples/s | 91.0 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01661 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.586 | L2-Norm(final)=3.202 | 1730.6 samples/s | 27.0 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01505 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.592 | L2-Norm(final)=3.203 | 4206.2 samples/s | 65.7 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01379 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.598 | L2-Norm(final)=3.205 | 4309.5 samples/s | 67.3 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01292 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.208 | 5383.6 samples/s | 84.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01230 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=3.210 | 1795.7 samples/s | 28.1 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01159 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=3.213 | 4279.8 samples/s | 66.9 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01085 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.215 | 4189.7 samples/s | 65.5 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01057 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.218 | 4860.8 samples/s | 75.9 steps/s
[Step=19850 Epoch=96.8] | Loss=0.01016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.221 | 1840.7 samples/s | 28.8 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00980 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.624 | L2-Norm(final)=3.223 | 4312.2 samples/s | 67.4 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00936 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.627 | L2-Norm(final)=3.225 | 4241.4 samples/s | 66.3 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00902 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.228 | 4693.0 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=94.2] | Loss=0.18457 | Reg=0.00156 | acc=0.9219 | L2-Norm=12.488 | L2-Norm(final)=3.212 | 3975.1 samples/s | 62.1 steps/s
[Step=19250 Epoch=94.4] | Loss=0.03468 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.532 | L2-Norm(final)=3.191 | 4002.9 samples/s | 62.5 steps/s
[Step=19300 Epoch=94.6] | Loss=0.02448 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.549 | L2-Norm(final)=3.188 | 4229.4 samples/s | 66.1 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01941 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.190 | 4232.9 samples/s | 66.1 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01748 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=3.193 | 5896.5 samples/s | 92.1 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01528 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.571 | L2-Norm(final)=3.196 | 1712.0 samples/s | 26.8 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01350 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.199 | 4247.5 samples/s | 66.4 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01246 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=3.203 | 4338.1 samples/s | 67.8 steps/s
[Step=19600 Epoch=96.1] | Loss=0.01166 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.585 | L2-Norm(final)=3.206 | 5657.9 samples/s | 88.4 steps/s
[Step=19650 Epoch=96.4] | Loss=0.01080 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=3.209 | 1768.9 samples/s | 27.6 steps/s
[Step=19700 Epoch=96.6] | Loss=0.01014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.212 | 4249.5 samples/s | 66.4 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00967 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.215 | 4308.4 samples/s | 67.3 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00913 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.218 | 5345.0 samples/s | 83.5 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00874 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.221 | 1783.0 samples/s | 27.9 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00840 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.602 | L2-Norm(final)=3.224 | 4312.3 samples/s | 67.4 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00798 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.227 | 4332.2 samples/s | 67.7 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00773 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.230 | 5037.4 samples/s | 78.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step20000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=181.9] | Loss=0.01890 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.488 | L2-Norm(final)=3.213 | 4003.4 samples/s | 62.6 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00175 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.221 | 3505.7 samples/s | 54.8 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00091 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.225 | 5673.3 samples/s | 88.6 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00061 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.228 | 1646.7 samples/s | 25.7 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00046 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.230 | 5046.1 samples/s | 78.8 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00037 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.231 | 1718.5 samples/s | 26.9 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00031 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.233 | 4664.3 samples/s | 72.9 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00027 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.233 | 1756.4 samples/s | 27.4 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00023 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.234 | 4395.7 samples/s | 68.7 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.235 | 1844.7 samples/s | 28.8 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.235 | 4323.9 samples/s | 67.6 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.236 | 1861.1 samples/s | 29.1 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.236 | 4228.9 samples/s | 66.1 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.237 | 1875.1 samples/s | 29.3 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.237 | 3944.8 samples/s | 61.6 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.238 | 1845.3 samples/s | 28.8 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.238 | 4177.1 samples/s | 65.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=182.6] | Loss=0.01422 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.488 | L2-Norm(final)=3.214 | 3833.7 samples/s | 59.9 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00142 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.230 | 3753.1 samples/s | 58.6 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00083 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.237 | 5641.9 samples/s | 88.2 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00056 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.241 | 1665.3 samples/s | 26.0 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00042 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.243 | 5031.5 samples/s | 78.6 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00034 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.244 | 1729.2 samples/s | 27.0 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00028 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.246 | 4798.5 samples/s | 75.0 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00024 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.247 | 1753.2 samples/s | 27.4 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00021 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.247 | 4437.6 samples/s | 69.3 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00019 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.248 | 1785.6 samples/s | 27.9 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.249 | 4147.4 samples/s | 64.8 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00016 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.249 | 1848.8 samples/s | 28.9 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00014 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.250 | 3982.2 samples/s | 62.2 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00013 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.251 | 1876.9 samples/s | 29.3 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.251 | 4062.7 samples/s | 63.5 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.252 | 1882.9 samples/s | 29.4 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.252 | 4032.4 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.4] | Loss=0.01540 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.488 | L2-Norm(final)=3.214 | 3896.0 samples/s | 60.9 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00270 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.210 | 3763.7 samples/s | 58.8 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00185 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.212 | 5485.8 samples/s | 85.7 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00126 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=3.214 | 1651.6 samples/s | 25.8 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00095 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=3.217 | 5208.1 samples/s | 81.4 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00076 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.218 | 1692.8 samples/s | 26.5 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00064 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.220 | 4858.5 samples/s | 75.9 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00055 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.221 | 1741.2 samples/s | 27.2 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00048 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.222 | 4604.8 samples/s | 72.0 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00043 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.223 | 1753.1 samples/s | 27.4 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00039 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.224 | 4279.0 samples/s | 66.9 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00035 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.225 | 1796.9 samples/s | 28.1 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00032 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.225 | 4075.1 samples/s | 63.7 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00030 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.226 | 1851.9 samples/s | 28.9 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00028 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.227 | 3970.3 samples/s | 62.0 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00026 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.227 | 1883.8 samples/s | 29.4 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.228 | 4055.4 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=180.9] | Loss=0.00651 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.214 | 3711.1 samples/s | 58.0 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00310 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.220 | 3969.8 samples/s | 62.0 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00161 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.224 | 5510.2 samples/s | 86.1 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.227 | 1690.1 samples/s | 26.4 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00086 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.229 | 5049.2 samples/s | 78.9 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00069 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.231 | 1716.3 samples/s | 26.8 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00058 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=3.233 | 4576.2 samples/s | 71.5 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00050 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.234 | 1764.6 samples/s | 27.6 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00044 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=3.236 | 4265.3 samples/s | 66.6 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00039 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.237 | 1872.7 samples/s | 29.3 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00035 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.238 | 4013.6 samples/s | 62.7 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00032 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.239 | 1869.1 samples/s | 29.2 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00029 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.240 | 4071.8 samples/s | 63.6 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00027 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.241 | 1892.5 samples/s | 29.6 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00025 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.241 | 4035.8 samples/s | 63.1 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00024 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.242 | 2013.3 samples/s | 31.5 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00022 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.243 | 3531.5 samples/s | 55.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.0] | Loss=0.05992 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.488 | L2-Norm(final)=3.213 | 3770.3 samples/s | 58.9 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00234 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.215 | 3746.0 samples/s | 58.5 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00123 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.218 | 5657.6 samples/s | 88.4 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00083 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=3.221 | 1655.1 samples/s | 25.9 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00062 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.223 | 5276.0 samples/s | 82.4 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00050 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.224 | 1670.1 samples/s | 26.1 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00042 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.225 | 4776.6 samples/s | 74.6 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00036 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.226 | 1758.8 samples/s | 27.5 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00032 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.226 | 4453.8 samples/s | 69.6 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00028 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=3.227 | 1745.3 samples/s | 27.3 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00025 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.227 | 4340.1 samples/s | 67.8 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00023 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.228 | 1816.1 samples/s | 28.4 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.228 | 4043.6 samples/s | 63.2 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00020 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.229 | 1845.3 samples/s | 28.8 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.229 | 4114.5 samples/s | 64.3 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.230 | 1888.6 samples/s | 29.5 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.230 | 4065.1 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30065 | acc=0.8556 | tpr=0.7937 | fpr=0.0099 | 3735.1 samples/s | 14.6 steps/s
Avg test loss: 0.30121, Avg test acc: 0.85395, Avg tpr: 0.79268, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.32606 | acc=0.9011 | tpr=0.9602 | fpr=0.1000 | 3782.7 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.32922 | acc=0.9022 | tpr=0.9701 | fpr=0.0991 | 7096.6 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.33343 | acc=0.9013 | tpr=0.9697 | fpr=0.0999 | 7120.1 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.33338 | acc=0.9012 | tpr=0.9694 | fpr=0.1000 | 7127.3 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.33014 | acc=0.9018 | tpr=0.9668 | fpr=0.0994 | 7103.7 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.33215 | acc=0.9013 | tpr=0.9695 | fpr=0.0999 | 7330.4 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.33524 | acc=0.9009 | tpr=0.9687 | fpr=0.1003 | 6843.6 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.33651 | acc=0.9008 | tpr=0.9688 | fpr=0.1004 | 7319.8 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.33909 | acc=0.9008 | tpr=0.9703 | fpr=0.1005 | 6841.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.33858 | acc=0.9005 | tpr=0.9718 | fpr=0.1008 | 7133.3 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.33678 | acc=0.9009 | tpr=0.9710 | fpr=0.1004 | 13187.1 samples/s | 51.5 steps/s
Avg test loss: 0.33643, Avg test acc: 0.90089, Avg tpr: 0.97068, Avg fpr: 0.10038, total FA: 13938

server round 25/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.06240 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3885.1 samples/s | 60.7 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02950 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.504 | L2-Norm(final)=3.238 | 3933.9 samples/s | 61.5 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02195 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.232 | 4247.4 samples/s | 66.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01858 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.527 | L2-Norm(final)=3.233 | 4285.2 samples/s | 67.0 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01713 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.535 | L2-Norm(final)=3.235 | 5813.5 samples/s | 90.8 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01516 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.238 | 1723.5 samples/s | 26.9 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01370 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.241 | 4189.8 samples/s | 65.5 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01266 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.243 | 4197.2 samples/s | 65.6 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01187 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.246 | 5339.2 samples/s | 83.4 steps/s
[Step=20450 Epoch=99.7] | Loss=0.01106 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.562 | L2-Norm(final)=3.249 | 1805.7 samples/s | 28.2 steps/s
[Step=20500 Epoch=100.0] | Loss=0.01025 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.253 | 4336.7 samples/s | 67.8 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00982 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=3.256 | 4394.6 samples/s | 68.7 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00950 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.259 | 5003.3 samples/s | 78.2 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00918 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.575 | L2-Norm(final)=3.262 | 1836.4 samples/s | 28.7 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00878 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.578 | L2-Norm(final)=3.264 | 4199.1 samples/s | 65.6 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00848 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.580 | L2-Norm(final)=3.267 | 4172.4 samples/s | 65.2 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00816 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=3.269 | 4573.0 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.6] | Loss=0.14666 | Reg=0.00155 | acc=0.9062 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 4058.1 samples/s | 63.4 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02209 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.246 | 3901.0 samples/s | 61.0 steps/s
[Step=20100 Epoch=98.1] | Loss=0.01808 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.520 | L2-Norm(final)=3.246 | 4182.7 samples/s | 65.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01693 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=3.246 | 4268.8 samples/s | 66.7 steps/s
[Step=20200 Epoch=98.6] | Loss=0.01536 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.538 | L2-Norm(final)=3.247 | 5826.1 samples/s | 91.0 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01350 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.250 | 1750.2 samples/s | 27.3 steps/s
[Step=20300 Epoch=99.1] | Loss=0.01236 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.550 | L2-Norm(final)=3.253 | 4201.4 samples/s | 65.6 steps/s
[Step=20350 Epoch=99.3] | Loss=0.01129 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.555 | L2-Norm(final)=3.256 | 4180.6 samples/s | 65.3 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01052 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.259 | 5293.3 samples/s | 82.7 steps/s
[Step=20450 Epoch=99.8] | Loss=0.00977 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=3.263 | 1775.4 samples/s | 27.7 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00925 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.266 | 4121.6 samples/s | 64.4 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00864 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.269 | 4202.1 samples/s | 65.7 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00833 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.273 | 5168.3 samples/s | 80.8 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00798 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.276 | 1807.3 samples/s | 28.2 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00769 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.279 | 4236.1 samples/s | 66.2 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00739 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.282 | 4219.1 samples/s | 65.9 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00712 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=3.285 | 4810.4 samples/s | 75.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.05181 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3681.7 samples/s | 57.5 steps/s
[Step=20050 Epoch=97.7] | Loss=0.02879 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.505 | L2-Norm(final)=3.242 | 4132.6 samples/s | 64.6 steps/s
[Step=20100 Epoch=97.9] | Loss=0.02269 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.240 | 4336.1 samples/s | 67.8 steps/s
[Step=20150 Epoch=98.2] | Loss=0.01932 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.241 | 4246.1 samples/s | 66.3 steps/s
[Step=20200 Epoch=98.4] | Loss=0.01747 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.244 | 5882.1 samples/s | 91.9 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01522 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.247 | 1755.5 samples/s | 27.4 steps/s
[Step=20300 Epoch=98.9] | Loss=0.01385 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.251 | 4333.8 samples/s | 67.7 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01251 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.559 | L2-Norm(final)=3.255 | 4317.6 samples/s | 67.5 steps/s
[Step=20400 Epoch=99.4] | Loss=0.01181 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.564 | L2-Norm(final)=3.258 | 5394.1 samples/s | 84.3 steps/s
[Step=20450 Epoch=99.6] | Loss=0.01136 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.568 | L2-Norm(final)=3.261 | 1789.2 samples/s | 28.0 steps/s
[Step=20500 Epoch=99.9] | Loss=0.01066 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.264 | 4194.2 samples/s | 65.5 steps/s
[Step=20550 Epoch=100.1] | Loss=0.01011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.267 | 4410.9 samples/s | 68.9 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00970 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.270 | 5075.0 samples/s | 79.3 steps/s
[Step=20650 Epoch=100.6] | Loss=0.00934 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=3.273 | 1828.4 samples/s | 28.6 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00900 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.276 | 4205.6 samples/s | 65.7 steps/s
[Step=20750 Epoch=101.1] | Loss=0.00869 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.586 | L2-Norm(final)=3.278 | 4226.7 samples/s | 66.0 steps/s
[Step=20800 Epoch=101.3] | Loss=0.00841 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=3.281 | 4554.5 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.05574 | Reg=0.00155 | acc=0.9219 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3889.5 samples/s | 60.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02868 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.241 | 4018.6 samples/s | 62.8 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01953 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.527 | L2-Norm(final)=3.242 | 4222.9 samples/s | 66.0 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01615 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=3.246 | 4173.8 samples/s | 65.2 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01497 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.249 | 5845.7 samples/s | 91.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01342 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.252 | 1745.3 samples/s | 27.3 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01212 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.255 | 4244.5 samples/s | 66.3 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01095 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.259 | 4273.4 samples/s | 66.8 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01041 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.262 | 5376.5 samples/s | 84.0 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00989 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=3.266 | 1797.8 samples/s | 28.1 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00936 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.269 | 4252.9 samples/s | 66.5 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00892 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.272 | 4221.5 samples/s | 66.0 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00856 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.275 | 4898.3 samples/s | 76.5 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00819 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=3.278 | 1828.3 samples/s | 28.6 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00779 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.281 | 4262.6 samples/s | 66.6 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00747 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.285 | 4309.9 samples/s | 67.3 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00739 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=3.288 | 4630.4 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step20800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=98.1] | Loss=0.11290 | Reg=0.00155 | acc=0.8750 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3869.5 samples/s | 60.5 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02858 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=3.241 | 4013.4 samples/s | 62.7 steps/s
[Step=20100 Epoch=98.6] | Loss=0.02223 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.527 | L2-Norm(final)=3.234 | 4276.1 samples/s | 66.8 steps/s
[Step=20150 Epoch=98.8] | Loss=0.02001 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.534 | L2-Norm(final)=3.233 | 4344.9 samples/s | 67.9 steps/s
[Step=20200 Epoch=99.1] | Loss=0.01740 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.233 | 6018.0 samples/s | 94.0 steps/s
[Step=20250 Epoch=99.3] | Loss=0.01510 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.235 | 1712.2 samples/s | 26.8 steps/s
[Step=20300 Epoch=99.5] | Loss=0.01357 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.237 | 4346.4 samples/s | 67.9 steps/s
[Step=20350 Epoch=99.8] | Loss=0.01246 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.239 | 4293.0 samples/s | 67.1 steps/s
[Step=20400 Epoch=100.0] | Loss=0.01156 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.242 | 5583.5 samples/s | 87.2 steps/s
[Step=20450 Epoch=100.3] | Loss=0.01086 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.559 | L2-Norm(final)=3.245 | 1782.1 samples/s | 27.8 steps/s
[Step=20500 Epoch=100.5] | Loss=0.01033 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.562 | L2-Norm(final)=3.248 | 4354.2 samples/s | 68.0 steps/s
[Step=20550 Epoch=100.8] | Loss=0.00976 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=3.250 | 4312.7 samples/s | 67.4 steps/s
[Step=20600 Epoch=101.0] | Loss=0.00932 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.253 | 5386.4 samples/s | 84.2 steps/s
[Step=20650 Epoch=101.3] | Loss=0.00888 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=3.255 | 1773.9 samples/s | 27.7 steps/s
[Step=20700 Epoch=101.5] | Loss=0.00851 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.258 | 4291.8 samples/s | 67.1 steps/s
[Step=20750 Epoch=101.8] | Loss=0.00816 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.260 | 4278.3 samples/s | 66.8 steps/s
[Step=20800 Epoch=102.0] | Loss=0.00789 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.263 | 5094.4 samples/s | 79.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step20800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.02090 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3886.3 samples/s | 60.7 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00197 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.258 | 3576.8 samples/s | 55.9 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00102 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.262 | 5638.7 samples/s | 88.1 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00070 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.265 | 1681.4 samples/s | 26.3 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00052 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.267 | 5032.0 samples/s | 78.6 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00042 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=3.268 | 1707.9 samples/s | 26.7 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00035 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.270 | 4707.2 samples/s | 73.6 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00030 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.271 | 1765.6 samples/s | 27.6 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00027 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.273 | 4367.4 samples/s | 68.2 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.274 | 1817.1 samples/s | 28.4 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=3.275 | 4104.6 samples/s | 64.1 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.276 | 1873.4 samples/s | 29.3 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.277 | 4066.9 samples/s | 63.5 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.278 | 1883.3 samples/s | 29.4 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00015 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.279 | 4031.6 samples/s | 63.0 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.280 | 1899.9 samples/s | 29.7 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.281 | 3989.6 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step20800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.04192 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.459 | L2-Norm(final)=3.256 | 3783.9 samples/s | 59.1 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00141 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.261 | 3617.6 samples/s | 56.5 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00073 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.263 | 5426.3 samples/s | 84.8 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00049 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.265 | 1670.0 samples/s | 26.1 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00037 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.267 | 5127.4 samples/s | 80.1 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00030 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.268 | 1735.9 samples/s | 27.1 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00025 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.268 | 4744.7 samples/s | 74.1 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00022 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.269 | 1779.6 samples/s | 27.8 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.270 | 4329.1 samples/s | 67.6 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=3.270 | 1816.0 samples/s | 28.4 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.271 | 4068.5 samples/s | 63.6 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.271 | 1839.6 samples/s | 28.7 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.272 | 3960.4 samples/s | 61.9 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.272 | 1856.7 samples/s | 29.0 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.272 | 4047.9 samples/s | 63.2 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.273 | 1892.4 samples/s | 29.6 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.273 | 3984.6 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step20800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=191.0] | Loss=0.00972 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3779.8 samples/s | 59.1 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00344 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.252 | 3726.3 samples/s | 58.2 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00176 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.251 | 5542.8 samples/s | 86.6 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00118 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.253 | 1669.3 samples/s | 26.1 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00089 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.254 | 5228.1 samples/s | 81.7 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00071 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.254 | 1707.7 samples/s | 26.7 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00059 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.255 | 4965.2 samples/s | 77.6 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00051 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.256 | 1750.2 samples/s | 27.3 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.257 | 4573.7 samples/s | 71.5 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00040 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.258 | 1749.4 samples/s | 27.3 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00036 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.259 | 4361.9 samples/s | 68.2 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00033 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.259 | 1846.9 samples/s | 28.9 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00030 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=3.260 | 4068.2 samples/s | 63.6 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00028 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.261 | 1876.5 samples/s | 29.3 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00026 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.262 | 4086.6 samples/s | 63.9 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.263 | 1871.6 samples/s | 29.2 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00023 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.263 | 4028.0 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step20800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.02590 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3630.1 samples/s | 56.7 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00116 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.264 | 3757.8 samples/s | 58.7 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00067 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.267 | 5478.6 samples/s | 85.6 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.270 | 1713.6 samples/s | 26.8 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00034 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.271 | 5044.6 samples/s | 78.8 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00027 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.273 | 1744.3 samples/s | 27.3 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00023 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.274 | 4554.8 samples/s | 71.2 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00020 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.275 | 1762.5 samples/s | 27.5 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.276 | 4147.9 samples/s | 64.8 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=3.276 | 1836.4 samples/s | 28.7 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.277 | 4193.9 samples/s | 65.5 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.278 | 1870.0 samples/s | 29.2 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.278 | 4053.6 samples/s | 63.3 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.279 | 1888.9 samples/s | 29.5 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.279 | 3982.9 samples/s | 62.2 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.280 | 1956.9 samples/s | 30.6 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.280 | 3868.2 samples/s | 60.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step20800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.6] | Loss=0.03129 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.459 | L2-Norm(final)=3.255 | 3929.5 samples/s | 61.4 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00364 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.257 | 3574.8 samples/s | 55.9 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00189 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.257 | 5705.3 samples/s | 89.1 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00127 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.259 | 1663.7 samples/s | 26.0 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00095 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.260 | 5267.6 samples/s | 82.3 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00081 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.261 | 1689.5 samples/s | 26.4 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00068 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.262 | 4820.3 samples/s | 75.3 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00058 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.263 | 1756.6 samples/s | 27.4 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00051 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=3.264 | 4673.3 samples/s | 73.0 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.264 | 1801.2 samples/s | 28.1 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00041 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.265 | 4387.1 samples/s | 68.5 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00037 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.266 | 1832.9 samples/s | 28.6 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00034 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.266 | 4043.6 samples/s | 63.2 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00032 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.267 | 1848.3 samples/s | 28.9 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00029 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=3.268 | 4037.7 samples/s | 63.1 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00027 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.268 | 1870.8 samples/s | 29.2 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00026 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.269 | 4174.6 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35625 | acc=0.8343 | tpr=0.7616 | fpr=0.0079 | 2807.4 samples/s | 11.0 steps/s
Avg test loss: 0.35833, Avg test acc: 0.83136, Avg tpr: 0.75905, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.30270 | acc=0.9130 | tpr=0.9558 | fpr=0.0877 | 2832.7 samples/s | 11.1 steps/s
[Step= 100] | Loss=0.30779 | acc=0.9147 | tpr=0.9680 | fpr=0.0863 | 7074.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.31224 | acc=0.9136 | tpr=0.9683 | fpr=0.0874 | 7310.4 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.31215 | acc=0.9132 | tpr=0.9683 | fpr=0.0878 | 7167.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.30905 | acc=0.9133 | tpr=0.9668 | fpr=0.0877 | 7205.0 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.31097 | acc=0.9128 | tpr=0.9687 | fpr=0.0882 | 7075.0 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.31395 | acc=0.9123 | tpr=0.9681 | fpr=0.0887 | 7157.8 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.31535 | acc=0.9123 | tpr=0.9683 | fpr=0.0887 | 6887.0 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.31823 | acc=0.9122 | tpr=0.9703 | fpr=0.0888 | 7181.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.31785 | acc=0.9121 | tpr=0.9718 | fpr=0.0890 | 7116.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.31615 | acc=0.9124 | tpr=0.9710 | fpr=0.0887 | 12754.8 samples/s | 49.8 steps/s
Avg test loss: 0.31579, Avg test acc: 0.91240, Avg tpr: 0.97029, Avg fpr: 0.08865, total FA: 12309

server round 26/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.04974 | Reg=0.00154 | acc=0.9219 | L2-Norm=12.428 | L2-Norm(final)=3.299 | 3384.1 samples/s | 52.9 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02944 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.285 | 2075.5 samples/s | 32.4 steps/s
[Step=20900 Epoch=101.9] | Loss=0.02061 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.505 | L2-Norm(final)=3.282 | 3880.6 samples/s | 60.6 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01926 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.513 | L2-Norm(final)=3.282 | 4134.9 samples/s | 64.6 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01727 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.281 | 6094.3 samples/s | 95.2 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01526 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.282 | 1722.5 samples/s | 26.9 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01374 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.285 | 4237.3 samples/s | 66.2 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01282 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.287 | 4283.8 samples/s | 66.9 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01196 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.290 | 5324.5 samples/s | 83.2 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01119 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.541 | L2-Norm(final)=3.293 | 1800.8 samples/s | 28.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01061 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.295 | 4318.6 samples/s | 67.5 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.298 | 4237.4 samples/s | 66.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00971 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.301 | 4929.1 samples/s | 77.0 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00919 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.303 | 1848.4 samples/s | 28.9 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00889 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=3.306 | 4262.7 samples/s | 66.6 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00860 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.556 | L2-Norm(final)=3.308 | 4287.5 samples/s | 67.0 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00832 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.311 | 4727.1 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.5] | Loss=0.17884 | Reg=0.00154 | acc=0.9062 | L2-Norm=12.428 | L2-Norm(final)=3.297 | 3911.9 samples/s | 61.1 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03178 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.478 | L2-Norm(final)=3.276 | 3775.4 samples/s | 59.0 steps/s
[Step=20900 Epoch=102.0] | Loss=0.02280 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.495 | L2-Norm(final)=3.274 | 4164.2 samples/s | 65.1 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01819 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.276 | 4140.0 samples/s | 64.7 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01640 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.514 | L2-Norm(final)=3.280 | 5834.0 samples/s | 91.2 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01471 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.284 | 1735.6 samples/s | 27.1 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01312 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.289 | 4241.8 samples/s | 66.3 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01203 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.534 | L2-Norm(final)=3.293 | 4267.8 samples/s | 66.7 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01136 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.297 | 5479.2 samples/s | 85.6 steps/s
[Step=21250 Epoch=103.7] | Loss=0.01064 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=3.301 | 1778.3 samples/s | 27.8 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00987 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.304 | 4265.9 samples/s | 66.7 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00929 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.308 | 4284.5 samples/s | 66.9 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00893 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.552 | L2-Norm(final)=3.311 | 5106.0 samples/s | 79.8 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00860 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.314 | 1807.7 samples/s | 28.2 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00815 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.317 | 4230.9 samples/s | 66.1 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00781 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.320 | 4277.3 samples/s | 66.8 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00750 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.323 | 4778.8 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.30475 | Reg=0.00154 | acc=0.7969 | L2-Norm=12.428 | L2-Norm(final)=3.297 | 4156.7 samples/s | 64.9 steps/s
[Step=20850 Epoch=101.6] | Loss=0.03545 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.478 | L2-Norm(final)=3.279 | 3837.8 samples/s | 60.0 steps/s
[Step=20900 Epoch=101.8] | Loss=0.02480 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.495 | L2-Norm(final)=3.276 | 4279.9 samples/s | 66.9 steps/s
[Step=20950 Epoch=102.1] | Loss=0.02099 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.276 | 4247.9 samples/s | 66.4 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01801 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.513 | L2-Norm(final)=3.279 | 5802.6 samples/s | 90.7 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01573 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.283 | 1738.1 samples/s | 27.2 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01416 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.287 | 4198.8 samples/s | 65.6 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01311 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.290 | 4174.6 samples/s | 65.2 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01238 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=3.294 | 5314.2 samples/s | 83.0 steps/s
[Step=21250 Epoch=103.5] | Loss=0.01172 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.538 | L2-Norm(final)=3.297 | 1806.6 samples/s | 28.2 steps/s
[Step=21300 Epoch=103.8] | Loss=0.01136 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=3.300 | 4326.2 samples/s | 67.6 steps/s
[Step=21350 Epoch=104.0] | Loss=0.01076 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.302 | 4198.9 samples/s | 65.6 steps/s
[Step=21400 Epoch=104.3] | Loss=0.01035 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.305 | 4997.4 samples/s | 78.1 steps/s
[Step=21450 Epoch=104.5] | Loss=0.00997 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.307 | 1845.3 samples/s | 28.8 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00952 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.310 | 4371.8 samples/s | 68.3 steps/s
[Step=21550 Epoch=105.0] | Loss=0.00924 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.312 | 4340.0 samples/s | 67.8 steps/s
[Step=21600 Epoch=105.2] | Loss=0.00889 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.315 | 4782.5 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.21676 | Reg=0.00154 | acc=0.8750 | L2-Norm=12.428 | L2-Norm(final)=3.297 | 4157.9 samples/s | 65.0 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03347 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.481 | L2-Norm(final)=3.279 | 3823.1 samples/s | 59.7 steps/s
[Step=20900 Epoch=101.9] | Loss=0.02162 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.279 | 4265.0 samples/s | 66.6 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01799 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.282 | 4206.3 samples/s | 65.7 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01637 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.285 | 5793.7 samples/s | 90.5 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01441 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.523 | L2-Norm(final)=3.289 | 1734.6 samples/s | 27.1 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01290 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.292 | 4228.5 samples/s | 66.1 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01206 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.296 | 4175.7 samples/s | 65.2 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01135 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.300 | 5278.9 samples/s | 82.5 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01053 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.303 | 1762.4 samples/s | 27.5 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00998 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.306 | 4438.2 samples/s | 69.3 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00937 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.310 | 4183.1 samples/s | 65.4 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00909 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.313 | 4938.7 samples/s | 77.2 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00866 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.316 | 1833.6 samples/s | 28.6 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00827 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.319 | 4202.0 samples/s | 65.7 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00795 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=3.322 | 4211.6 samples/s | 65.8 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00772 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.325 | 4744.0 samples/s | 74.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step21600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=102.0] | Loss=0.14349 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.428 | L2-Norm(final)=3.298 | 3850.1 samples/s | 60.2 steps/s
[Step=20850 Epoch=102.2] | Loss=0.03046 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.279 | 3813.4 samples/s | 59.6 steps/s
[Step=20900 Epoch=102.5] | Loss=0.02212 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.279 | 4169.7 samples/s | 65.2 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01928 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.282 | 4239.9 samples/s | 66.2 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01708 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.284 | 5795.7 samples/s | 90.6 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01452 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.288 | 1696.5 samples/s | 26.5 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01275 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.293 | 4227.2 samples/s | 66.1 steps/s
[Step=21150 Epoch=103.7] | Loss=0.01181 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.528 | L2-Norm(final)=3.297 | 4277.2 samples/s | 66.8 steps/s
[Step=21200 Epoch=104.0] | Loss=0.01124 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.300 | 5479.1 samples/s | 85.6 steps/s
[Step=21250 Epoch=104.2] | Loss=0.01068 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=3.303 | 1753.4 samples/s | 27.4 steps/s
[Step=21300 Epoch=104.5] | Loss=0.00998 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.539 | L2-Norm(final)=3.306 | 4285.8 samples/s | 67.0 steps/s
[Step=21350 Epoch=104.7] | Loss=0.00948 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.542 | L2-Norm(final)=3.309 | 4083.2 samples/s | 63.8 steps/s
[Step=21400 Epoch=104.9] | Loss=0.00901 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.312 | 5253.0 samples/s | 82.1 steps/s
[Step=21450 Epoch=105.2] | Loss=0.00865 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.315 | 1769.5 samples/s | 27.6 steps/s
[Step=21500 Epoch=105.4] | Loss=0.00831 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.318 | 4426.3 samples/s | 69.2 steps/s
[Step=21550 Epoch=105.7] | Loss=0.00800 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.320 | 4152.1 samples/s | 64.9 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00768 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.323 | 5013.3 samples/s | 78.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step21600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.1] | Loss=0.02861 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.428 | L2-Norm(final)=3.298 | 3966.0 samples/s | 62.0 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00225 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.306 | 3421.2 samples/s | 53.5 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00122 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.309 | 5519.3 samples/s | 86.2 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.311 | 1664.2 samples/s | 26.0 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00062 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.313 | 5023.8 samples/s | 78.5 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00050 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.314 | 1706.1 samples/s | 26.7 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00042 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.315 | 4668.8 samples/s | 72.9 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00036 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=3.316 | 1753.4 samples/s | 27.4 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00031 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.317 | 4419.0 samples/s | 69.0 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00028 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.317 | 1825.8 samples/s | 28.5 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00025 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.318 | 4133.4 samples/s | 64.6 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00023 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.318 | 1840.0 samples/s | 28.7 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.319 | 3951.4 samples/s | 61.7 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.319 | 1857.1 samples/s | 29.0 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.320 | 4006.3 samples/s | 62.6 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.320 | 1869.2 samples/s | 29.2 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.321 | 3986.5 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step21600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.9] | Loss=0.02647 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.428 | L2-Norm(final)=3.299 | 3923.6 samples/s | 61.3 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00143 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.304 | 3524.6 samples/s | 55.1 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00084 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.307 | 5648.7 samples/s | 88.3 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00057 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.309 | 1651.0 samples/s | 25.8 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00043 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.311 | 5094.3 samples/s | 79.6 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00035 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.312 | 1692.0 samples/s | 26.4 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00029 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.313 | 4703.6 samples/s | 73.5 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00025 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.314 | 1799.7 samples/s | 28.1 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00022 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.315 | 4416.4 samples/s | 69.0 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00020 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.316 | 1820.1 samples/s | 28.4 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.317 | 4099.5 samples/s | 64.1 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.317 | 1852.3 samples/s | 28.9 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00015 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.318 | 4059.8 samples/s | 63.4 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.318 | 1902.9 samples/s | 29.7 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.319 | 4029.7 samples/s | 63.0 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.319 | 1870.0 samples/s | 29.2 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=3.319 | 3909.6 samples/s | 61.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step21600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.6] | Loss=0.00932 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.299 | 3675.9 samples/s | 57.4 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00149 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.304 | 3887.3 samples/s | 60.7 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00078 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.308 | 5754.4 samples/s | 89.9 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00053 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.311 | 1659.4 samples/s | 25.9 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00040 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.313 | 5301.8 samples/s | 82.8 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00032 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.315 | 1682.9 samples/s | 26.3 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00027 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.316 | 4940.0 samples/s | 77.2 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00023 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.318 | 1714.6 samples/s | 26.8 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00020 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.319 | 4606.4 samples/s | 72.0 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.320 | 1750.2 samples/s | 27.3 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.321 | 4380.2 samples/s | 68.4 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00015 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.322 | 1825.5 samples/s | 28.5 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.322 | 4125.0 samples/s | 64.5 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.323 | 1856.0 samples/s | 29.0 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=3.324 | 4069.0 samples/s | 63.6 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.325 | 1858.2 samples/s | 29.0 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.325 | 4061.8 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step21600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=196.0] | Loss=0.01757 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.428 | L2-Norm(final)=3.299 | 3805.8 samples/s | 59.5 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00065 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.314 | 3706.2 samples/s | 57.9 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00039 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.318 | 5526.5 samples/s | 86.4 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00028 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.321 | 1676.6 samples/s | 26.2 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.324 | 5082.5 samples/s | 79.4 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.325 | 1724.4 samples/s | 26.9 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.326 | 4621.3 samples/s | 72.2 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.327 | 1773.4 samples/s | 27.7 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.328 | 4308.6 samples/s | 67.3 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.328 | 1846.0 samples/s | 28.8 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.329 | 4138.3 samples/s | 64.7 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.330 | 1883.5 samples/s | 29.4 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.330 | 3940.4 samples/s | 61.6 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.331 | 1836.9 samples/s | 28.7 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=3.331 | 4077.8 samples/s | 63.7 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=3.331 | 1992.7 samples/s | 31.1 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=3.332 | 3515.6 samples/s | 54.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.3] | Loss=0.01005 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.428 | L2-Norm(final)=3.299 | 3588.3 samples/s | 56.1 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00052 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.313 | 3930.5 samples/s | 61.4 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00027 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=3.318 | 5690.7 samples/s | 88.9 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.320 | 1658.7 samples/s | 25.9 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.322 | 5142.0 samples/s | 80.3 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.323 | 1729.9 samples/s | 27.0 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.324 | 4870.9 samples/s | 76.1 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.325 | 1745.8 samples/s | 27.3 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.325 | 4480.6 samples/s | 70.0 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=3.326 | 1813.3 samples/s | 28.3 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=3.327 | 4365.0 samples/s | 68.2 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.327 | 1829.5 samples/s | 28.6 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.328 | 4038.6 samples/s | 63.1 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=3.328 | 1880.8 samples/s | 29.4 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=3.329 | 4022.8 samples/s | 62.9 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00004 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=3.329 | 1873.5 samples/s | 29.3 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00004 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=3.330 | 4126.5 samples/s | 64.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28536 | acc=0.8651 | tpr=0.8074 | fpr=0.0097 | 3760.0 samples/s | 14.7 steps/s
Avg test loss: 0.28625, Avg test acc: 0.86277, Avg tpr: 0.80550, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.34524 | acc=0.8938 | tpr=0.9602 | fpr=0.1074 | 3773.9 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.34978 | acc=0.8956 | tpr=0.9701 | fpr=0.1058 | 7278.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.35461 | acc=0.8949 | tpr=0.9712 | fpr=0.1065 | 7378.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.35457 | acc=0.8948 | tpr=0.9705 | fpr=0.1066 | 6736.4 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.35153 | acc=0.8949 | tpr=0.9686 | fpr=0.1065 | 7127.1 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.35327 | acc=0.8941 | tpr=0.9709 | fpr=0.1073 | 7194.9 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.35624 | acc=0.8936 | tpr=0.9699 | fpr=0.1078 | 7165.0 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.35758 | acc=0.8935 | tpr=0.9705 | fpr=0.1079 | 7543.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.36033 | acc=0.8936 | tpr=0.9718 | fpr=0.1078 | 6779.5 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.36035 | acc=0.8932 | tpr=0.9731 | fpr=0.1082 | 6864.1 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.35837 | acc=0.8938 | tpr=0.9725 | fpr=0.1077 | 13449.0 samples/s | 52.5 steps/s
Avg test loss: 0.35806, Avg test acc: 0.89380, Avg tpr: 0.97227, Avg fpr: 0.10762, total FA: 14943

server round 27/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.09998 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.388 | L2-Norm(final)=3.346 | 3724.7 samples/s | 58.2 steps/s
[Step=21650 Epoch=105.6] | Loss=0.03117 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.327 | 4292.5 samples/s | 67.1 steps/s
[Step=21700 Epoch=105.8] | Loss=0.02183 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.449 | L2-Norm(final)=3.325 | 4280.2 samples/s | 66.9 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01855 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.326 | 4191.0 samples/s | 65.5 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01656 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.328 | 5652.1 samples/s | 88.3 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01453 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.332 | 1735.9 samples/s | 27.1 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01311 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.476 | L2-Norm(final)=3.335 | 4187.5 samples/s | 65.4 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01234 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.338 | 4207.7 samples/s | 65.7 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01142 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.341 | 5401.2 samples/s | 84.4 steps/s
[Step=22050 Epoch=107.5] | Loss=0.01057 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.344 | 1794.8 samples/s | 28.0 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00984 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.490 | L2-Norm(final)=3.347 | 4311.6 samples/s | 67.4 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00976 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.350 | 4253.7 samples/s | 66.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00938 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.351 | 4965.2 samples/s | 77.6 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00901 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.354 | 1825.8 samples/s | 28.5 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00861 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.500 | L2-Norm(final)=3.356 | 4222.4 samples/s | 66.0 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00834 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.358 | 4233.2 samples/s | 66.1 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00803 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.503 | L2-Norm(final)=3.361 | 4632.3 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.4] | Loss=0.17157 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.388 | L2-Norm(final)=3.346 | 3944.6 samples/s | 61.6 steps/s
[Step=21650 Epoch=105.6] | Loss=0.03298 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.432 | L2-Norm(final)=3.321 | 3877.7 samples/s | 60.6 steps/s
[Step=21700 Epoch=105.9] | Loss=0.02330 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.450 | L2-Norm(final)=3.318 | 4194.4 samples/s | 65.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01829 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.321 | 4235.3 samples/s | 66.2 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01660 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.468 | L2-Norm(final)=3.325 | 5936.9 samples/s | 92.8 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01431 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.329 | 1724.3 samples/s | 26.9 steps/s
[Step=21900 Epoch=106.9] | Loss=0.01276 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.334 | 4218.6 samples/s | 65.9 steps/s
[Step=21950 Epoch=107.1] | Loss=0.01167 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.338 | 4302.9 samples/s | 67.2 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01085 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.342 | 5493.7 samples/s | 85.8 steps/s
[Step=22050 Epoch=107.6] | Loss=0.01002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.346 | 1807.2 samples/s | 28.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00962 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.349 | 4272.7 samples/s | 66.8 steps/s
[Step=22150 Epoch=108.1] | Loss=0.00923 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.352 | 4231.1 samples/s | 66.1 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00895 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.355 | 5107.3 samples/s | 79.8 steps/s
[Step=22250 Epoch=108.6] | Loss=0.00843 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.358 | 1787.0 samples/s | 27.9 steps/s
[Step=22300 Epoch=108.8] | Loss=0.00814 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.361 | 4137.9 samples/s | 64.7 steps/s
[Step=22350 Epoch=109.1] | Loss=0.00794 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.507 | L2-Norm(final)=3.363 | 4234.2 samples/s | 66.2 steps/s
[Step=22400 Epoch=109.3] | Loss=0.00765 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.366 | 4746.0 samples/s | 74.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step22400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.02885 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.388 | L2-Norm(final)=3.347 | 3788.5 samples/s | 59.2 steps/s
[Step=21650 Epoch=105.5] | Loss=0.02357 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.335 | 3975.9 samples/s | 62.1 steps/s
[Step=21700 Epoch=105.7] | Loss=0.01950 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.333 | 4282.8 samples/s | 66.9 steps/s
[Step=21750 Epoch=106.0] | Loss=0.01755 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.334 | 4246.7 samples/s | 66.4 steps/s
[Step=21800 Epoch=106.2] | Loss=0.01598 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.336 | 5863.3 samples/s | 91.6 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01404 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.339 | 1724.5 samples/s | 26.9 steps/s
[Step=21900 Epoch=106.7] | Loss=0.01282 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.342 | 4226.3 samples/s | 66.0 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01193 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.346 | 4254.8 samples/s | 66.5 steps/s
[Step=22000 Epoch=107.2] | Loss=0.01125 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.488 | L2-Norm(final)=3.349 | 5160.4 samples/s | 80.6 steps/s
[Step=22050 Epoch=107.4] | Loss=0.01050 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=3.352 | 1786.8 samples/s | 27.9 steps/s
[Step=22100 Epoch=107.7] | Loss=0.00985 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.355 | 4135.1 samples/s | 64.6 steps/s
[Step=22150 Epoch=107.9] | Loss=0.00960 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.358 | 4282.6 samples/s | 66.9 steps/s
[Step=22200 Epoch=108.2] | Loss=0.00926 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.501 | L2-Norm(final)=3.360 | 4952.0 samples/s | 77.4 steps/s
[Step=22250 Epoch=108.4] | Loss=0.00890 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.363 | 1834.2 samples/s | 28.7 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00863 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.365 | 4291.4 samples/s | 67.1 steps/s
[Step=22350 Epoch=108.9] | Loss=0.00838 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.508 | L2-Norm(final)=3.367 | 4297.3 samples/s | 67.1 steps/s
[Step=22400 Epoch=109.1] | Loss=0.00831 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=3.369 | 4624.4 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step22400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.16302 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.388 | L2-Norm(final)=3.346 | 3717.1 samples/s | 58.1 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02560 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.329 | 4036.4 samples/s | 63.1 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01855 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.328 | 4197.8 samples/s | 65.6 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01617 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.332 | 4209.6 samples/s | 65.8 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01510 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.335 | 5744.7 samples/s | 89.8 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01350 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.468 | L2-Norm(final)=3.339 | 1750.7 samples/s | 27.4 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01213 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.343 | 4283.0 samples/s | 66.9 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01103 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.347 | 4201.8 samples/s | 65.7 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01035 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.351 | 5300.2 samples/s | 82.8 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00964 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.486 | L2-Norm(final)=3.355 | 1780.2 samples/s | 27.8 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00901 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.490 | L2-Norm(final)=3.359 | 4203.1 samples/s | 65.7 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00862 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.362 | 4233.1 samples/s | 66.1 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00827 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.366 | 5006.8 samples/s | 78.2 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00782 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.369 | 1850.4 samples/s | 28.9 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00758 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.501 | L2-Norm(final)=3.373 | 4282.4 samples/s | 66.9 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00741 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.376 | 4219.3 samples/s | 65.9 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00715 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.379 | 4612.4 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step22400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.9] | Loss=0.20500 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.388 | L2-Norm(final)=3.346 | 3761.8 samples/s | 58.8 steps/s
[Step=21650 Epoch=106.2] | Loss=0.03157 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.429 | L2-Norm(final)=3.327 | 4140.6 samples/s | 64.7 steps/s
[Step=21700 Epoch=106.4] | Loss=0.02180 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.443 | L2-Norm(final)=3.325 | 4202.8 samples/s | 65.7 steps/s
[Step=21750 Epoch=106.7] | Loss=0.01798 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.325 | 4158.4 samples/s | 65.0 steps/s
[Step=21800 Epoch=106.9] | Loss=0.01528 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.327 | 5934.9 samples/s | 92.7 steps/s
[Step=21850 Epoch=107.1] | Loss=0.01352 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.331 | 1732.0 samples/s | 27.1 steps/s
[Step=21900 Epoch=107.4] | Loss=0.01210 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.334 | 4175.2 samples/s | 65.2 steps/s
[Step=21950 Epoch=107.6] | Loss=0.01119 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.471 | L2-Norm(final)=3.338 | 4256.0 samples/s | 66.5 steps/s
[Step=22000 Epoch=107.9] | Loss=0.01048 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.340 | 5644.7 samples/s | 88.2 steps/s
[Step=22050 Epoch=108.1] | Loss=0.00985 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=3.343 | 1758.8 samples/s | 27.5 steps/s
[Step=22100 Epoch=108.4] | Loss=0.00949 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.346 | 4223.5 samples/s | 66.0 steps/s
[Step=22150 Epoch=108.6] | Loss=0.00895 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.349 | 4243.1 samples/s | 66.3 steps/s
[Step=22200 Epoch=108.9] | Loss=0.00848 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.352 | 5308.1 samples/s | 82.9 steps/s
[Step=22250 Epoch=109.1] | Loss=0.00805 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=3.355 | 1781.2 samples/s | 27.8 steps/s
[Step=22300 Epoch=109.4] | Loss=0.00765 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.358 | 4226.6 samples/s | 66.0 steps/s
[Step=22350 Epoch=109.6] | Loss=0.00740 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.360 | 4178.2 samples/s | 65.3 steps/s
[Step=22400 Epoch=109.8] | Loss=0.00735 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.495 | L2-Norm(final)=3.363 | 5015.1 samples/s | 78.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step22400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=204.7] | Loss=0.11127 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.388 | L2-Norm(final)=3.346 | 3829.7 samples/s | 59.8 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00416 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.348 | 3800.2 samples/s | 59.4 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00210 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.350 | 5615.2 samples/s | 87.7 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00140 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.351 | 1685.9 samples/s | 26.3 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00105 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.351 | 5050.9 samples/s | 78.9 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00084 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.352 | 1685.2 samples/s | 26.3 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00070 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.352 | 4636.9 samples/s | 72.5 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00060 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.353 | 1751.4 samples/s | 27.4 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00053 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.353 | 4573.1 samples/s | 71.5 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00047 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.353 | 1845.6 samples/s | 28.8 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00042 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.354 | 4161.2 samples/s | 65.0 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00039 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.354 | 1841.3 samples/s | 28.8 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00035 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.354 | 4009.9 samples/s | 62.7 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00033 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.355 | 1888.1 samples/s | 29.5 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.355 | 4156.8 samples/s | 64.9 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00028 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.355 | 1899.6 samples/s | 29.7 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=3.355 | 4038.7 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step22400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.5] | Loss=0.00229 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=3.347 | 3627.4 samples/s | 56.7 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00205 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.352 | 3849.2 samples/s | 60.1 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00105 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.354 | 5524.0 samples/s | 86.3 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00070 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.355 | 1675.4 samples/s | 26.2 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00053 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.356 | 5032.3 samples/s | 78.6 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00043 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.356 | 1715.9 samples/s | 26.8 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00036 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.357 | 4778.2 samples/s | 74.7 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00030 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.357 | 1773.6 samples/s | 27.7 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00027 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.357 | 4430.2 samples/s | 69.2 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00024 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.358 | 1814.7 samples/s | 28.4 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.358 | 4068.1 samples/s | 63.6 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00020 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.358 | 1846.1 samples/s | 28.8 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.359 | 4023.6 samples/s | 62.9 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.359 | 1888.2 samples/s | 29.5 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.359 | 4068.1 samples/s | 63.6 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.360 | 1894.4 samples/s | 29.6 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.360 | 4104.3 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step22400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=206.3] | Loss=0.01384 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.388 | L2-Norm(final)=3.347 | 3968.0 samples/s | 62.0 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00162 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.353 | 3580.0 samples/s | 55.9 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00083 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.356 | 5604.2 samples/s | 87.6 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00056 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.359 | 1666.2 samples/s | 26.0 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00042 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.361 | 5093.6 samples/s | 79.6 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00034 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.362 | 1695.8 samples/s | 26.5 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00028 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.364 | 4863.3 samples/s | 76.0 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00024 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.365 | 1740.6 samples/s | 27.2 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=3.366 | 4517.8 samples/s | 70.6 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00019 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.366 | 1769.6 samples/s | 27.7 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.367 | 4345.2 samples/s | 67.9 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00016 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=3.368 | 1804.3 samples/s | 28.2 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.369 | 4066.0 samples/s | 63.5 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=3.370 | 1841.9 samples/s | 28.8 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=3.370 | 4087.2 samples/s | 63.9 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=3.371 | 1828.5 samples/s | 28.6 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00011 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.371 | 4149.9 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step22400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=203.5] | Loss=0.02157 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.388 | L2-Norm(final)=3.347 | 3773.1 samples/s | 59.0 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00511 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.330 | 3773.2 samples/s | 59.0 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00280 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.325 | 5510.9 samples/s | 86.1 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00190 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.326 | 1678.0 samples/s | 26.2 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00142 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.326 | 4932.5 samples/s | 77.1 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00114 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.327 | 1734.5 samples/s | 27.1 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00095 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.327 | 4545.9 samples/s | 71.0 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.328 | 1798.7 samples/s | 28.1 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00072 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.328 | 4205.7 samples/s | 65.7 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00064 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.329 | 1837.2 samples/s | 28.7 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00057 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.329 | 4078.8 samples/s | 63.7 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00052 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.330 | 1887.7 samples/s | 29.5 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00048 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.330 | 4174.6 samples/s | 65.2 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00044 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.330 | 1864.7 samples/s | 29.1 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00041 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.331 | 3877.3 samples/s | 60.6 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00038 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.331 | 1952.7 samples/s | 30.5 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00036 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.332 | 3836.0 samples/s | 59.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step22400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.9] | Loss=0.00924 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.388 | L2-Norm(final)=3.347 | 3781.5 samples/s | 59.1 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00241 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.348 | 3690.5 samples/s | 57.7 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00123 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.347 | 5593.4 samples/s | 87.4 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00083 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.348 | 1690.7 samples/s | 26.4 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00063 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.350 | 5136.2 samples/s | 80.3 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00051 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.351 | 1716.0 samples/s | 26.8 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00043 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.353 | 4950.7 samples/s | 77.4 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00037 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.354 | 1762.4 samples/s | 27.5 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00032 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.355 | 4642.9 samples/s | 72.5 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00029 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.356 | 1791.3 samples/s | 28.0 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00026 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.357 | 4430.2 samples/s | 69.2 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00024 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.358 | 1829.8 samples/s | 28.6 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00022 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.358 | 4043.7 samples/s | 63.2 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00020 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=3.359 | 1857.7 samples/s | 29.0 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00019 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=3.360 | 4030.2 samples/s | 63.0 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=3.360 | 1865.5 samples/s | 29.1 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00016 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.361 | 4139.3 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34833 | acc=0.8341 | tpr=0.7618 | fpr=0.0087 | 3739.8 samples/s | 14.6 steps/s
Avg test loss: 0.34874, Avg test acc: 0.83164, Avg tpr: 0.75957, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.27981 | acc=0.9198 | tpr=0.9513 | fpr=0.0808 | 3789.6 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.28591 | acc=0.9210 | tpr=0.9659 | fpr=0.0799 | 7119.5 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.29129 | acc=0.9196 | tpr=0.9683 | fpr=0.0813 | 7241.0 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.29165 | acc=0.9192 | tpr=0.9683 | fpr=0.0817 | 6953.0 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.28899 | acc=0.9195 | tpr=0.9668 | fpr=0.0813 | 7231.1 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.29048 | acc=0.9192 | tpr=0.9687 | fpr=0.0817 | 7080.3 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.29338 | acc=0.9186 | tpr=0.9681 | fpr=0.0823 | 7081.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.29467 | acc=0.9185 | tpr=0.9683 | fpr=0.0824 | 7281.4 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.29741 | acc=0.9186 | tpr=0.9698 | fpr=0.0823 | 6773.6 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.29712 | acc=0.9184 | tpr=0.9714 | fpr=0.0825 | 6896.0 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.29550 | acc=0.9188 | tpr=0.9706 | fpr=0.0821 | 13262.6 samples/s | 51.8 steps/s
Avg test loss: 0.29520, Avg test acc: 0.91885, Avg tpr: 0.97029, Avg fpr: 0.08208, total FA: 11397

server round 28/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.22549 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.355 | L2-Norm(final)=3.381 | 3876.0 samples/s | 60.6 steps/s
[Step=22450 Epoch=109.5] | Loss=0.03694 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.408 | L2-Norm(final)=3.360 | 4114.5 samples/s | 64.3 steps/s
[Step=22500 Epoch=109.7] | Loss=0.02593 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=3.357 | 4208.9 samples/s | 65.8 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02145 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.436 | L2-Norm(final)=3.358 | 4261.9 samples/s | 66.6 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01896 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=3.361 | 5704.4 samples/s | 89.1 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01630 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.365 | 1755.5 samples/s | 27.4 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01439 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.369 | 4278.7 samples/s | 66.9 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01338 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.373 | 4369.7 samples/s | 68.3 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01241 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.376 | 5378.5 samples/s | 84.0 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01167 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.380 | 1785.2 samples/s | 27.9 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01096 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.470 | L2-Norm(final)=3.383 | 4279.3 samples/s | 66.9 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01033 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.473 | L2-Norm(final)=3.386 | 4254.7 samples/s | 66.5 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00973 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.390 | 5045.0 samples/s | 78.8 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00936 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.393 | 1830.3 samples/s | 28.6 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00888 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.396 | 4345.3 samples/s | 67.9 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00868 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.399 | 4278.5 samples/s | 66.9 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00836 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.402 | 4576.0 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.3] | Loss=0.11691 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 4014.8 samples/s | 62.7 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02887 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=3.362 | 3806.1 samples/s | 59.5 steps/s
[Step=22500 Epoch=109.8] | Loss=0.02047 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.429 | L2-Norm(final)=3.363 | 4302.3 samples/s | 67.2 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01730 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.439 | L2-Norm(final)=3.367 | 4204.5 samples/s | 65.7 steps/s
[Step=22600 Epoch=110.3] | Loss=0.01538 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.370 | 5809.1 samples/s | 90.8 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01346 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.373 | 1728.2 samples/s | 27.0 steps/s
[Step=22700 Epoch=110.8] | Loss=0.01226 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.457 | L2-Norm(final)=3.377 | 4268.4 samples/s | 66.7 steps/s
[Step=22750 Epoch=111.0] | Loss=0.01117 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.381 | 4259.7 samples/s | 66.6 steps/s
[Step=22800 Epoch=111.3] | Loss=0.01044 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.465 | L2-Norm(final)=3.385 | 5399.1 samples/s | 84.4 steps/s
[Step=22850 Epoch=111.5] | Loss=0.00974 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.388 | 1775.2 samples/s | 27.7 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00915 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.392 | 4248.7 samples/s | 66.4 steps/s
[Step=22950 Epoch=112.0] | Loss=0.00872 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.395 | 4227.9 samples/s | 66.1 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00834 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.398 | 5112.2 samples/s | 79.9 steps/s
[Step=23050 Epoch=112.5] | Loss=0.00797 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.401 | 1795.7 samples/s | 28.1 steps/s
[Step=23100 Epoch=112.7] | Loss=0.00767 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.404 | 4242.3 samples/s | 66.3 steps/s
[Step=23150 Epoch=113.0] | Loss=0.00735 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.407 | 4194.3 samples/s | 65.5 steps/s
[Step=23200 Epoch=113.2] | Loss=0.00711 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.410 | 4919.1 samples/s | 76.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step23200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.1] | Loss=0.32113 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.355 | L2-Norm(final)=3.381 | 3817.9 samples/s | 59.7 steps/s
[Step=22450 Epoch=109.4] | Loss=0.03258 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.398 | L2-Norm(final)=3.360 | 3996.0 samples/s | 62.4 steps/s
[Step=22500 Epoch=109.6] | Loss=0.02291 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.413 | L2-Norm(final)=3.358 | 4343.1 samples/s | 67.9 steps/s
[Step=22550 Epoch=109.9] | Loss=0.01876 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.360 | 4303.8 samples/s | 67.2 steps/s
[Step=22600 Epoch=110.1] | Loss=0.01695 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.429 | L2-Norm(final)=3.363 | 5801.9 samples/s | 90.7 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01463 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.367 | 1731.6 samples/s | 27.1 steps/s
[Step=22700 Epoch=110.6] | Loss=0.01318 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.372 | 4241.7 samples/s | 66.3 steps/s
[Step=22750 Epoch=110.8] | Loss=0.01218 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.445 | L2-Norm(final)=3.376 | 4315.0 samples/s | 67.4 steps/s
[Step=22800 Epoch=111.1] | Loss=0.01142 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.449 | L2-Norm(final)=3.380 | 5232.6 samples/s | 81.8 steps/s
[Step=22850 Epoch=111.3] | Loss=0.01085 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.384 | 1755.3 samples/s | 27.4 steps/s
[Step=22900 Epoch=111.6] | Loss=0.01035 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.387 | 4292.4 samples/s | 67.1 steps/s
[Step=22950 Epoch=111.8] | Loss=0.00990 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=3.390 | 4164.7 samples/s | 65.1 steps/s
[Step=23000 Epoch=112.1] | Loss=0.00933 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.393 | 5137.7 samples/s | 80.3 steps/s
[Step=23050 Epoch=112.3] | Loss=0.00900 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.464 | L2-Norm(final)=3.396 | 1842.4 samples/s | 28.8 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00867 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.399 | 4306.6 samples/s | 67.3 steps/s
[Step=23150 Epoch=112.8] | Loss=0.00842 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.401 | 4345.3 samples/s | 67.9 steps/s
[Step=23200 Epoch=113.0] | Loss=0.00807 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.404 | 4701.9 samples/s | 73.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step23200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.14709 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 3820.1 samples/s | 59.7 steps/s
[Step=22450 Epoch=109.5] | Loss=0.03259 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.359 | 4189.4 samples/s | 65.5 steps/s
[Step=22500 Epoch=109.7] | Loss=0.02230 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.358 | 4353.4 samples/s | 68.0 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01894 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.359 | 4210.1 samples/s | 65.8 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01608 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.450 | L2-Norm(final)=3.362 | 5865.1 samples/s | 91.6 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01442 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.366 | 1748.3 samples/s | 27.3 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01290 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.370 | 4266.6 samples/s | 66.7 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01156 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.375 | 4347.4 samples/s | 67.9 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01074 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.470 | L2-Norm(final)=3.379 | 5364.5 samples/s | 83.8 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01006 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.382 | 1799.7 samples/s | 28.1 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00953 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.385 | 4246.4 samples/s | 66.3 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00911 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.388 | 4166.8 samples/s | 65.1 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00874 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.392 | 4893.1 samples/s | 76.5 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00845 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=3.395 | 1852.2 samples/s | 28.9 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00812 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.398 | 4311.7 samples/s | 67.4 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00777 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.401 | 4267.5 samples/s | 66.7 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00749 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=3.404 | 4683.8 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step23200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.9] | Loss=0.34610 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.355 | L2-Norm(final)=3.380 | 3933.4 samples/s | 61.5 steps/s
[Step=22450 Epoch=110.1] | Loss=0.02661 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=3.365 | 3823.7 samples/s | 59.7 steps/s
[Step=22500 Epoch=110.3] | Loss=0.01980 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=3.366 | 4190.8 samples/s | 65.5 steps/s
[Step=22550 Epoch=110.6] | Loss=0.01684 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.368 | 4223.4 samples/s | 66.0 steps/s
[Step=22600 Epoch=110.8] | Loss=0.01546 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.424 | L2-Norm(final)=3.370 | 5870.3 samples/s | 91.7 steps/s
[Step=22650 Epoch=111.1] | Loss=0.01342 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.373 | 1714.0 samples/s | 26.8 steps/s
[Step=22700 Epoch=111.3] | Loss=0.01214 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.377 | 4298.2 samples/s | 67.2 steps/s
[Step=22750 Epoch=111.6] | Loss=0.01135 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.380 | 4299.7 samples/s | 67.2 steps/s
[Step=22800 Epoch=111.8] | Loss=0.01068 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.383 | 5748.3 samples/s | 89.8 steps/s
[Step=22850 Epoch=112.1] | Loss=0.01004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.386 | 1776.7 samples/s | 27.8 steps/s
[Step=22900 Epoch=112.3] | Loss=0.00940 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.388 | 4351.7 samples/s | 68.0 steps/s
[Step=22950 Epoch=112.5] | Loss=0.00883 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.392 | 4327.8 samples/s | 67.6 steps/s
[Step=23000 Epoch=112.8] | Loss=0.00838 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.455 | L2-Norm(final)=3.395 | 5427.9 samples/s | 84.8 steps/s
[Step=23050 Epoch=113.0] | Loss=0.00803 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.398 | 1763.7 samples/s | 27.6 steps/s
[Step=23100 Epoch=113.3] | Loss=0.00770 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.401 | 4227.2 samples/s | 66.1 steps/s
[Step=23150 Epoch=113.5] | Loss=0.00730 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.404 | 4255.0 samples/s | 66.5 steps/s
[Step=23200 Epoch=113.8] | Loss=0.00710 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.464 | L2-Norm(final)=3.407 | 5075.9 samples/s | 79.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step23200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=212.3] | Loss=0.03694 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 3774.3 samples/s | 59.0 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00262 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=3.394 | 3786.2 samples/s | 59.2 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00135 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.397 | 5668.6 samples/s | 88.6 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00090 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.399 | 1696.2 samples/s | 26.5 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00068 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=3.400 | 5102.5 samples/s | 79.7 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00055 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.402 | 1721.9 samples/s | 26.9 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00046 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.403 | 4614.2 samples/s | 72.1 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00040 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=3.403 | 1756.7 samples/s | 27.4 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00035 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=3.404 | 4335.0 samples/s | 67.7 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00031 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.405 | 1830.7 samples/s | 28.6 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00028 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=3.406 | 4262.1 samples/s | 66.6 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00025 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=3.407 | 1903.1 samples/s | 29.7 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00023 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=3.407 | 4169.2 samples/s | 65.1 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00022 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=3.408 | 1875.7 samples/s | 29.3 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00020 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.409 | 4059.5 samples/s | 63.4 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.409 | 1880.1 samples/s | 29.4 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=3.410 | 4043.0 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step23200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.1] | Loss=0.00416 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 3679.2 samples/s | 57.5 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00339 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=3.378 | 3786.6 samples/s | 59.2 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00180 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=3.375 | 5550.3 samples/s | 86.7 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00121 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=3.375 | 1653.6 samples/s | 25.8 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00091 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=3.376 | 5192.8 samples/s | 81.1 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00073 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.376 | 1708.3 samples/s | 26.7 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00061 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=3.377 | 4682.7 samples/s | 73.2 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00053 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=3.377 | 1786.2 samples/s | 27.9 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00046 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=3.378 | 4404.9 samples/s | 68.8 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00041 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.378 | 1817.8 samples/s | 28.4 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00037 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=3.379 | 4168.6 samples/s | 65.1 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00034 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=3.379 | 1844.7 samples/s | 28.8 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00031 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=3.380 | 4030.1 samples/s | 63.0 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00029 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=3.380 | 1902.8 samples/s | 29.7 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=3.381 | 4174.4 samples/s | 65.2 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00025 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=3.381 | 1906.7 samples/s | 29.8 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00023 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=3.382 | 4153.0 samples/s | 64.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step23200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.9] | Loss=0.03237 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 3866.1 samples/s | 60.4 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00116 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.390 | 3949.3 samples/s | 61.7 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00061 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.397 | 5633.3 samples/s | 88.0 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00046 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=3.402 | 1671.3 samples/s | 26.1 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00035 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=3.405 | 5205.4 samples/s | 81.3 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00028 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=3.407 | 1724.2 samples/s | 26.9 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00023 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=3.409 | 4856.4 samples/s | 75.9 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00020 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=3.410 | 1754.4 samples/s | 27.4 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=3.411 | 4639.6 samples/s | 72.5 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=3.412 | 1783.6 samples/s | 27.9 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=3.413 | 4389.5 samples/s | 68.6 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=3.413 | 1821.1 samples/s | 28.5 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=3.414 | 4237.0 samples/s | 66.2 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00011 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=3.415 | 1892.0 samples/s | 29.6 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=3.415 | 4170.8 samples/s | 65.2 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.416 | 1885.1 samples/s | 29.5 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=3.416 | 4075.5 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step23200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=211.1] | Loss=0.05900 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.355 | L2-Norm(final)=3.381 | 3715.8 samples/s | 58.1 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00144 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=3.389 | 3961.3 samples/s | 61.9 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00073 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.391 | 5667.8 samples/s | 88.6 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00049 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=3.393 | 1724.4 samples/s | 26.9 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00037 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=3.394 | 4961.5 samples/s | 77.5 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00030 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=3.395 | 1754.6 samples/s | 27.4 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00025 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=3.395 | 4665.8 samples/s | 72.9 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00021 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=3.396 | 1792.0 samples/s | 28.0 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=3.397 | 4261.8 samples/s | 66.6 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00017 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=3.397 | 1874.5 samples/s | 29.3 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00015 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=3.398 | 4134.9 samples/s | 64.6 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=3.399 | 1915.7 samples/s | 29.9 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00013 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=3.399 | 4177.8 samples/s | 65.3 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.400 | 1921.4 samples/s | 30.0 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00011 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=3.400 | 4052.9 samples/s | 63.3 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.401 | 1996.8 samples/s | 31.2 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.401 | 3666.4 samples/s | 57.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step23200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.5] | Loss=0.01873 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.355 | L2-Norm(final)=3.382 | 3600.3 samples/s | 56.3 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00211 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.392 | 4112.6 samples/s | 64.3 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00115 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.395 | 5848.2 samples/s | 91.4 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00077 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.399 | 1710.1 samples/s | 26.7 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00058 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.401 | 5367.6 samples/s | 83.9 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00047 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.402 | 1723.4 samples/s | 26.9 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00039 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.403 | 4904.0 samples/s | 76.6 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00033 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.404 | 1735.3 samples/s | 27.1 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00029 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.405 | 4590.7 samples/s | 71.7 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00026 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.405 | 1806.4 samples/s | 28.2 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00024 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.406 | 4445.8 samples/s | 69.5 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.406 | 1817.5 samples/s | 28.4 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00020 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.407 | 4189.4 samples/s | 65.5 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00018 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=3.407 | 1861.0 samples/s | 29.1 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=3.408 | 4003.8 samples/s | 62.6 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.408 | 1862.4 samples/s | 29.1 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=3.409 | 4046.2 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27114 | acc=0.8689 | tpr=0.8133 | fpr=0.0104 | 3841.8 samples/s | 15.0 steps/s
Avg test loss: 0.27129, Avg test acc: 0.86818, Avg tpr: 0.81384, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.35395 | acc=0.8916 | tpr=0.9513 | fpr=0.1094 | 3806.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.35830 | acc=0.8925 | tpr=0.9659 | fpr=0.1088 | 7112.9 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.36350 | acc=0.8918 | tpr=0.9683 | fpr=0.1096 | 7158.6 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.36331 | acc=0.8915 | tpr=0.9683 | fpr=0.1099 | 7281.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.36065 | acc=0.8918 | tpr=0.9677 | fpr=0.1096 | 6984.5 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.36206 | acc=0.8914 | tpr=0.9695 | fpr=0.1100 | 7382.3 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.36512 | acc=0.8910 | tpr=0.9687 | fpr=0.1104 | 6936.0 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.36649 | acc=0.8909 | tpr=0.9688 | fpr=0.1105 | 7345.9 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.36927 | acc=0.8909 | tpr=0.9703 | fpr=0.1105 | 6859.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.36936 | acc=0.8903 | tpr=0.9718 | fpr=0.1112 | 7074.6 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.36747 | acc=0.8907 | tpr=0.9710 | fpr=0.1107 | 13060.0 samples/s | 51.0 steps/s
Avg test loss: 0.36713, Avg test acc: 0.89077, Avg tpr: 0.97068, Avg fpr: 0.11068, total FA: 15368

server round 29/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.14004 | Reg=0.00152 | acc=0.9062 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 4078.2 samples/s | 63.7 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02905 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.369 | L2-Norm(final)=3.412 | 3988.3 samples/s | 62.3 steps/s
[Step=23300 Epoch=113.6] | Loss=0.02193 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=3.410 | 4260.6 samples/s | 66.6 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01825 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.395 | L2-Norm(final)=3.411 | 4323.9 samples/s | 67.6 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01674 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.414 | 5773.3 samples/s | 90.2 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01436 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.417 | 1732.4 samples/s | 27.1 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01290 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=3.421 | 4177.2 samples/s | 65.3 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01194 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.424 | 4176.5 samples/s | 65.3 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01126 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.427 | 5333.3 samples/s | 83.3 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01042 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.430 | 1796.4 samples/s | 28.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00982 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.433 | 4407.4 samples/s | 68.9 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00937 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.437 | 4313.2 samples/s | 67.4 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00900 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.435 | L2-Norm(final)=3.440 | 5056.1 samples/s | 79.0 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00854 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.442 | 1847.2 samples/s | 28.9 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00823 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.445 | 4310.4 samples/s | 67.4 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00801 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.443 | L2-Norm(final)=3.448 | 4234.3 samples/s | 66.2 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00790 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.450 | 4591.2 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.2] | Loss=0.11427 | Reg=0.00152 | acc=0.9375 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3756.0 samples/s | 58.7 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02263 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=3.417 | 4156.7 samples/s | 64.9 steps/s
[Step=23300 Epoch=113.7] | Loss=0.01890 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.376 | L2-Norm(final)=3.415 | 4403.1 samples/s | 68.8 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01566 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.417 | 4362.4 samples/s | 68.2 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01421 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=3.421 | 5931.8 samples/s | 92.7 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01294 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=3.425 | 1752.5 samples/s | 27.4 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01156 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.430 | 4355.6 samples/s | 68.1 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01050 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.435 | 4286.1 samples/s | 67.0 steps/s
[Step=23600 Epoch=115.2] | Loss=0.00970 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.440 | 5483.5 samples/s | 85.7 steps/s
[Step=23650 Epoch=115.4] | Loss=0.00889 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.445 | 1749.6 samples/s | 27.3 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00838 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=3.450 | 4175.1 samples/s | 65.2 steps/s
[Step=23750 Epoch=115.9] | Loss=0.00802 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.428 | L2-Norm(final)=3.454 | 4193.0 samples/s | 65.5 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00773 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.458 | 5144.3 samples/s | 80.4 steps/s
[Step=23850 Epoch=116.4] | Loss=0.00742 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.461 | 1814.4 samples/s | 28.3 steps/s
[Step=23900 Epoch=116.6] | Loss=0.00719 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.436 | L2-Norm(final)=3.465 | 4192.1 samples/s | 65.5 steps/s
[Step=23950 Epoch=116.9] | Loss=0.00696 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.468 | 4224.3 samples/s | 66.0 steps/s
[Step=24000 Epoch=117.1] | Loss=0.00669 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.472 | 4823.9 samples/s | 75.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.0] | Loss=0.15945 | Reg=0.00152 | acc=0.9375 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3680.8 samples/s | 57.5 steps/s
[Step=23250 Epoch=113.3] | Loss=0.02285 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=3.418 | 4081.9 samples/s | 63.8 steps/s
[Step=23300 Epoch=113.5] | Loss=0.01922 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=3.418 | 4200.3 samples/s | 65.6 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01610 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=3.419 | 4188.4 samples/s | 65.4 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01453 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.395 | L2-Norm(final)=3.423 | 5711.9 samples/s | 89.2 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01294 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=3.427 | 1727.2 samples/s | 27.0 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01194 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.431 | 4321.6 samples/s | 67.5 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01128 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.411 | L2-Norm(final)=3.435 | 4229.9 samples/s | 66.1 steps/s
[Step=23600 Epoch=115.0] | Loss=0.01045 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=3.439 | 5394.8 samples/s | 84.3 steps/s
[Step=23650 Epoch=115.2] | Loss=0.00977 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.443 | 1804.6 samples/s | 28.2 steps/s
[Step=23700 Epoch=115.5] | Loss=0.00951 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.446 | 4197.6 samples/s | 65.6 steps/s
[Step=23750 Epoch=115.7] | Loss=0.00909 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.426 | L2-Norm(final)=3.449 | 4172.8 samples/s | 65.2 steps/s
[Step=23800 Epoch=116.0] | Loss=0.00893 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=3.452 | 4802.6 samples/s | 75.0 steps/s
[Step=23850 Epoch=116.2] | Loss=0.00859 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.431 | L2-Norm(final)=3.455 | 1844.9 samples/s | 28.8 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00826 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.458 | 4329.3 samples/s | 67.6 steps/s
[Step=23950 Epoch=116.7] | Loss=0.00796 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.461 | 4467.1 samples/s | 69.8 steps/s
[Step=24000 Epoch=116.9] | Loss=0.00777 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.463 | 4680.7 samples/s | 73.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.17243 | Reg=0.00152 | acc=0.9062 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3839.8 samples/s | 60.0 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02663 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=3.418 | 4002.8 samples/s | 62.5 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01957 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.420 | 4331.4 samples/s | 67.7 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01640 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=3.422 | 4350.4 samples/s | 68.0 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01440 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=3.426 | 5645.8 samples/s | 88.2 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01285 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.412 | L2-Norm(final)=3.430 | 1765.2 samples/s | 27.6 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01161 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.434 | 4417.6 samples/s | 69.0 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01076 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.423 | L2-Norm(final)=3.437 | 4357.3 samples/s | 68.1 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.441 | 5468.3 samples/s | 85.4 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00953 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.444 | 1795.4 samples/s | 28.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00894 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.447 | 4356.9 samples/s | 68.1 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00876 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.438 | L2-Norm(final)=3.450 | 4409.6 samples/s | 68.9 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00847 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.453 | 5179.8 samples/s | 80.9 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00811 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=3.455 | 1801.7 samples/s | 28.2 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00776 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.458 | 4224.2 samples/s | 66.0 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00745 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.461 | 4314.9 samples/s | 67.4 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00719 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.452 | L2-Norm(final)=3.464 | 4649.0 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.8] | Loss=0.04509 | Reg=0.00152 | acc=0.9531 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3990.3 samples/s | 62.3 steps/s
[Step=23250 Epoch=114.0] | Loss=0.01841 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.360 | L2-Norm(final)=3.428 | 3920.7 samples/s | 61.3 steps/s
[Step=23300 Epoch=114.3] | Loss=0.01631 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=3.427 | 4292.9 samples/s | 67.1 steps/s
[Step=23350 Epoch=114.5] | Loss=0.01439 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.382 | L2-Norm(final)=3.427 | 4244.5 samples/s | 66.3 steps/s
[Step=23400 Epoch=114.7] | Loss=0.01335 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=3.428 | 5943.0 samples/s | 92.9 steps/s
[Step=23450 Epoch=115.0] | Loss=0.01228 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=3.430 | 1711.1 samples/s | 26.7 steps/s
[Step=23500 Epoch=115.2] | Loss=0.01138 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=3.432 | 4203.0 samples/s | 65.7 steps/s
[Step=23550 Epoch=115.5] | Loss=0.01039 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.405 | L2-Norm(final)=3.434 | 4265.0 samples/s | 66.6 steps/s
[Step=23600 Epoch=115.7] | Loss=0.00967 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=3.437 | 5636.8 samples/s | 88.1 steps/s
[Step=23650 Epoch=116.0] | Loss=0.00925 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.439 | 1775.9 samples/s | 27.7 steps/s
[Step=23700 Epoch=116.2] | Loss=0.00876 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.442 | 4209.5 samples/s | 65.8 steps/s
[Step=23750 Epoch=116.5] | Loss=0.00830 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.444 | 4350.8 samples/s | 68.0 steps/s
[Step=23800 Epoch=116.7] | Loss=0.00795 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.422 | L2-Norm(final)=3.447 | 5267.4 samples/s | 82.3 steps/s
[Step=23850 Epoch=117.0] | Loss=0.00753 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=3.449 | 1797.8 samples/s | 28.1 steps/s
[Step=23900 Epoch=117.2] | Loss=0.00717 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.452 | 4245.3 samples/s | 66.3 steps/s
[Step=23950 Epoch=117.4] | Loss=0.00694 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.454 | 4187.8 samples/s | 65.4 steps/s
[Step=24000 Epoch=117.7] | Loss=0.00677 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.457 | 4909.5 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=219.8] | Loss=0.01013 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.431 | 4171.8 samples/s | 65.2 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00393 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=3.435 | 3365.4 samples/s | 52.6 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00208 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.431 | 5464.1 samples/s | 85.4 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00139 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.431 | 1679.6 samples/s | 26.2 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00105 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.431 | 5227.4 samples/s | 81.7 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00084 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.432 | 1742.6 samples/s | 27.2 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00070 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=3.432 | 4793.3 samples/s | 74.9 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00060 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.432 | 1759.2 samples/s | 27.5 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00053 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.433 | 4333.5 samples/s | 67.7 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00047 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.433 | 1801.8 samples/s | 28.2 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00042 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=3.433 | 4077.9 samples/s | 63.7 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00039 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=3.434 | 1850.8 samples/s | 28.9 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00035 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.434 | 4008.8 samples/s | 62.6 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00033 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=3.434 | 1899.8 samples/s | 29.7 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00030 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=3.435 | 3858.6 samples/s | 60.3 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00028 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=3.435 | 1869.4 samples/s | 29.2 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=3.435 | 4057.1 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=220.7] | Loss=0.00080 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3881.5 samples/s | 60.6 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00128 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=3.441 | 3668.8 samples/s | 57.3 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00066 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.443 | 5655.1 samples/s | 88.4 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00044 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=3.444 | 1683.0 samples/s | 26.3 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00033 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=3.445 | 5088.4 samples/s | 79.5 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=3.446 | 1703.9 samples/s | 26.6 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00022 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=3.447 | 4695.1 samples/s | 73.4 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=3.447 | 1760.2 samples/s | 27.5 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00017 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=3.448 | 4323.2 samples/s | 67.5 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=3.448 | 1816.0 samples/s | 28.4 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=3.448 | 4145.6 samples/s | 64.8 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=3.449 | 1862.5 samples/s | 29.1 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00011 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=3.449 | 3955.4 samples/s | 61.8 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00011 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.449 | 1846.3 samples/s | 28.8 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=3.450 | 4156.0 samples/s | 64.9 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.450 | 1854.8 samples/s | 29.0 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=3.450 | 4042.9 samples/s | 63.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.6] | Loss=0.01511 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.431 | 3838.9 samples/s | 60.0 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00198 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=3.431 | 3618.2 samples/s | 56.5 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00110 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.434 | 5596.5 samples/s | 87.4 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00074 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.437 | 1643.0 samples/s | 25.7 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00056 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=3.438 | 5227.2 samples/s | 81.7 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00045 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.439 | 1733.6 samples/s | 27.1 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00038 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=3.440 | 4875.3 samples/s | 76.2 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=3.441 | 1761.8 samples/s | 27.5 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00028 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=3.442 | 4571.0 samples/s | 71.4 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00025 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.443 | 1803.5 samples/s | 28.2 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00023 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=3.444 | 4254.3 samples/s | 66.5 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00021 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=3.445 | 1802.2 samples/s | 28.2 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=3.446 | 4150.8 samples/s | 64.9 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=3.447 | 1899.1 samples/s | 29.7 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=3.448 | 4100.6 samples/s | 64.1 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=3.449 | 1870.7 samples/s | 29.2 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=3.450 | 4027.0 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step24000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=218.6] | Loss=0.02134 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.431 | 3932.2 samples/s | 61.4 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00167 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=3.438 | 3602.6 samples/s | 56.3 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00092 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.441 | 5582.5 samples/s | 87.2 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00062 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=3.443 | 1676.3 samples/s | 26.2 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00046 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=3.445 | 4906.1 samples/s | 76.7 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00037 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=3.446 | 1748.2 samples/s | 27.3 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00031 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=3.447 | 4596.6 samples/s | 71.8 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=3.447 | 1801.9 samples/s | 28.2 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00023 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=3.448 | 4261.4 samples/s | 66.6 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00021 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=3.448 | 1858.4 samples/s | 29.0 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=3.449 | 3899.1 samples/s | 60.9 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00017 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=3.449 | 1886.1 samples/s | 29.5 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.449 | 4215.7 samples/s | 65.9 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.450 | 1868.0 samples/s | 29.2 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=3.450 | 4090.8 samples/s | 63.9 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00013 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=3.450 | 2084.9 samples/s | 32.6 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.451 | 3397.2 samples/s | 53.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.1] | Loss=0.05764 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.323 | L2-Norm(final)=3.430 | 3857.9 samples/s | 60.3 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00211 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=3.431 | 3665.3 samples/s | 57.3 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00109 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=3.434 | 5706.4 samples/s | 89.2 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00074 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.435 | 1662.9 samples/s | 26.0 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00055 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=3.437 | 5318.9 samples/s | 83.1 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00045 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=3.438 | 1722.2 samples/s | 26.9 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00037 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=3.438 | 4820.5 samples/s | 75.3 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=3.439 | 1710.4 samples/s | 26.7 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00028 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=3.440 | 4567.7 samples/s | 71.4 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00025 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=3.440 | 1784.7 samples/s | 27.9 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00023 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=3.441 | 4273.6 samples/s | 66.8 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00021 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=3.441 | 1823.0 samples/s | 28.5 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=3.442 | 4178.0 samples/s | 65.3 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.442 | 1897.5 samples/s | 29.6 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.443 | 3985.9 samples/s | 62.3 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=3.443 | 1856.0 samples/s | 29.0 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=3.443 | 3942.3 samples/s | 61.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36825 | acc=0.8298 | tpr=0.7554 | fpr=0.0084 | 3819.5 samples/s | 14.9 steps/s
Avg test loss: 0.36643, Avg test acc: 0.82811, Avg tpr: 0.75462, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.28451 | acc=0.9245 | tpr=0.9558 | fpr=0.0760 | 3758.4 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.29030 | acc=0.9252 | tpr=0.9680 | fpr=0.0756 | 7327.8 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.29586 | acc=0.9238 | tpr=0.9712 | fpr=0.0770 | 7000.0 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.29628 | acc=0.9236 | tpr=0.9694 | fpr=0.0772 | 7243.4 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.29347 | acc=0.9238 | tpr=0.9686 | fpr=0.0770 | 7221.9 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.29543 | acc=0.9235 | tpr=0.9702 | fpr=0.0773 | 7195.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.29836 | acc=0.9230 | tpr=0.9693 | fpr=0.0778 | 7245.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.29986 | acc=0.9232 | tpr=0.9694 | fpr=0.0777 | 7026.0 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.30299 | acc=0.9233 | tpr=0.9708 | fpr=0.0775 | 7076.3 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.30275 | acc=0.9231 | tpr=0.9722 | fpr=0.0778 | 7701.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.30100 | acc=0.9233 | tpr=0.9717 | fpr=0.0776 | 12082.3 samples/s | 47.2 steps/s
Avg test loss: 0.30071, Avg test acc: 0.92336, Avg tpr: 0.97187, Avg fpr: 0.07752, total FA: 10764

server round 30/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.24150 | Reg=0.00151 | acc=0.8438 | L2-Norm=12.301 | L2-Norm(final)=3.475 | 3927.4 samples/s | 61.4 steps/s
[Step=24050 Epoch=117.3] | Loss=0.03308 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.328 | L2-Norm(final)=3.467 | 4052.9 samples/s | 63.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02279 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.335 | L2-Norm(final)=3.465 | 4273.3 samples/s | 66.8 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01744 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=3.465 | 4345.8 samples/s | 67.9 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01498 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=3.467 | 5911.9 samples/s | 92.4 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01280 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=3.470 | 1741.6 samples/s | 27.2 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01130 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=3.473 | 4288.2 samples/s | 67.0 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01018 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.352 | L2-Norm(final)=3.476 | 4327.2 samples/s | 67.6 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00953 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.354 | L2-Norm(final)=3.478 | 5424.6 samples/s | 84.8 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00901 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=3.481 | 1768.7 samples/s | 27.6 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00854 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=3.483 | 4210.1 samples/s | 65.8 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00805 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=3.485 | 4219.2 samples/s | 65.9 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00758 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=3.487 | 4897.7 samples/s | 76.5 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00722 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.362 | L2-Norm(final)=3.489 | 1817.8 samples/s | 28.4 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00684 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.492 | 4336.7 samples/s | 67.8 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00662 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=3.494 | 4256.6 samples/s | 66.5 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00652 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.366 | L2-Norm(final)=3.496 | 4651.2 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.1] | Loss=0.16006 | Reg=0.00151 | acc=0.9219 | L2-Norm=12.301 | L2-Norm(final)=3.475 | 3737.9 samples/s | 58.4 steps/s
[Step=24050 Epoch=117.4] | Loss=0.03569 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.330 | L2-Norm(final)=3.464 | 4069.0 samples/s | 63.6 steps/s
[Step=24100 Epoch=117.6] | Loss=0.02311 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=3.463 | 4177.2 samples/s | 65.3 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01883 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.346 | L2-Norm(final)=3.464 | 4287.5 samples/s | 67.0 steps/s
[Step=24200 Epoch=118.1] | Loss=0.01571 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=3.466 | 5816.7 samples/s | 90.9 steps/s
[Step=24250 Epoch=118.3] | Loss=0.01344 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=3.468 | 1736.9 samples/s | 27.1 steps/s
[Step=24300 Epoch=118.6] | Loss=0.01192 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=3.471 | 4339.8 samples/s | 67.8 steps/s
[Step=24350 Epoch=118.8] | Loss=0.01065 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.474 | 4385.8 samples/s | 68.5 steps/s
[Step=24400 Epoch=119.1] | Loss=0.00975 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=3.477 | 5433.0 samples/s | 84.9 steps/s
[Step=24450 Epoch=119.3] | Loss=0.00898 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=3.479 | 1792.7 samples/s | 28.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00833 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=3.482 | 4224.3 samples/s | 66.0 steps/s
[Step=24550 Epoch=119.8] | Loss=0.00792 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.366 | L2-Norm(final)=3.485 | 4103.8 samples/s | 64.1 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00759 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=3.487 | 4962.9 samples/s | 77.5 steps/s
[Step=24650 Epoch=120.3] | Loss=0.00726 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=3.489 | 1837.9 samples/s | 28.7 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00697 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.371 | L2-Norm(final)=3.492 | 4267.5 samples/s | 66.7 steps/s
[Step=24750 Epoch=120.8] | Loss=0.00664 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.372 | L2-Norm(final)=3.494 | 4243.8 samples/s | 66.3 steps/s
[Step=24800 Epoch=121.0] | Loss=0.00650 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=3.496 | 4807.3 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step24800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=116.9] | Loss=0.19441 | Reg=0.00151 | acc=0.8438 | L2-Norm=12.301 | L2-Norm(final)=3.475 | 3999.2 samples/s | 62.5 steps/s
[Step=24050 Epoch=117.2] | Loss=0.03194 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.464 | 3945.1 samples/s | 61.6 steps/s
[Step=24100 Epoch=117.4] | Loss=0.02240 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.463 | 4257.6 samples/s | 66.5 steps/s
[Step=24150 Epoch=117.7] | Loss=0.01841 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.336 | L2-Norm(final)=3.465 | 4229.5 samples/s | 66.1 steps/s
[Step=24200 Epoch=117.9] | Loss=0.01528 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=3.468 | 5648.9 samples/s | 88.3 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01348 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=3.471 | 1751.6 samples/s | 27.4 steps/s
[Step=24300 Epoch=118.4] | Loss=0.01190 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=3.474 | 4325.1 samples/s | 67.6 steps/s
[Step=24350 Epoch=118.6] | Loss=0.01074 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=3.477 | 4252.3 samples/s | 66.4 steps/s
[Step=24400 Epoch=118.9] | Loss=0.01003 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.352 | L2-Norm(final)=3.481 | 5420.9 samples/s | 84.7 steps/s
[Step=24450 Epoch=119.1] | Loss=0.00934 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=3.483 | 1746.6 samples/s | 27.3 steps/s
[Step=24500 Epoch=119.4] | Loss=0.00878 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=3.486 | 4160.3 samples/s | 65.0 steps/s
[Step=24550 Epoch=119.6] | Loss=0.00823 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.489 | 4139.2 samples/s | 64.7 steps/s
[Step=24600 Epoch=119.9] | Loss=0.00780 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=3.492 | 4856.1 samples/s | 75.9 steps/s
[Step=24650 Epoch=120.1] | Loss=0.00746 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=3.494 | 1837.6 samples/s | 28.7 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00712 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=3.497 | 4179.6 samples/s | 65.3 steps/s
[Step=24750 Epoch=120.6] | Loss=0.00682 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=3.500 | 4318.3 samples/s | 67.5 steps/s
[Step=24800 Epoch=120.8] | Loss=0.00663 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.367 | L2-Norm(final)=3.502 | 4595.3 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step24800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.28200 | Reg=0.00151 | acc=0.8594 | L2-Norm=12.301 | L2-Norm(final)=3.475 | 3927.9 samples/s | 61.4 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02931 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.330 | L2-Norm(final)=3.469 | 3815.8 samples/s | 59.6 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01935 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=3.469 | 4301.2 samples/s | 67.2 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01576 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.344 | L2-Norm(final)=3.471 | 4280.5 samples/s | 66.9 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01325 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=3.474 | 5833.4 samples/s | 91.1 steps/s
[Step=24250 Epoch=118.3] | Loss=0.01127 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=3.477 | 1728.4 samples/s | 27.0 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=3.480 | 4155.3 samples/s | 64.9 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00940 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=3.483 | 4284.9 samples/s | 67.0 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00865 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=3.486 | 5444.6 samples/s | 85.1 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00799 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.361 | L2-Norm(final)=3.488 | 1791.7 samples/s | 28.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00762 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=3.491 | 4446.6 samples/s | 69.5 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00722 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=3.493 | 4210.2 samples/s | 65.8 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00688 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=3.496 | 4951.4 samples/s | 77.4 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00652 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=3.498 | 1842.3 samples/s | 28.8 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00621 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=3.500 | 4265.3 samples/s | 66.6 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00599 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=3.503 | 4295.3 samples/s | 67.1 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00580 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=3.505 | 4582.6 samples/s | 71.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step24800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.7] | Loss=0.44061 | Reg=0.00151 | acc=0.8125 | L2-Norm=12.301 | L2-Norm(final)=3.475 | 3976.9 samples/s | 62.1 steps/s
[Step=24050 Epoch=117.9] | Loss=0.03849 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=3.464 | 3893.6 samples/s | 60.8 steps/s
[Step=24100 Epoch=118.2] | Loss=0.02395 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.465 | 4301.5 samples/s | 67.2 steps/s
[Step=24150 Epoch=118.4] | Loss=0.01883 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.336 | L2-Norm(final)=3.467 | 4291.2 samples/s | 67.0 steps/s
[Step=24200 Epoch=118.7] | Loss=0.01591 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=3.470 | 5870.2 samples/s | 91.7 steps/s
[Step=24250 Epoch=118.9] | Loss=0.01347 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.472 | 1719.4 samples/s | 26.9 steps/s
[Step=24300 Epoch=119.2] | Loss=0.01183 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=3.475 | 4254.7 samples/s | 66.5 steps/s
[Step=24350 Epoch=119.4] | Loss=0.01071 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=3.478 | 4180.2 samples/s | 65.3 steps/s
[Step=24400 Epoch=119.7] | Loss=0.00987 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=3.480 | 5614.1 samples/s | 87.7 steps/s
[Step=24450 Epoch=119.9] | Loss=0.00907 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=3.483 | 1743.4 samples/s | 27.2 steps/s
[Step=24500 Epoch=120.1] | Loss=0.00846 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=3.485 | 4174.9 samples/s | 65.2 steps/s
[Step=24550 Epoch=120.4] | Loss=0.00791 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=3.488 | 4185.7 samples/s | 65.4 steps/s
[Step=24600 Epoch=120.6] | Loss=0.00756 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=3.490 | 5284.4 samples/s | 82.6 steps/s
[Step=24650 Epoch=120.9] | Loss=0.00717 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=3.493 | 1779.8 samples/s | 27.8 steps/s
[Step=24700 Epoch=121.1] | Loss=0.00683 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=3.495 | 4295.2 samples/s | 67.1 steps/s
[Step=24750 Epoch=121.4] | Loss=0.00652 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=3.497 | 4191.8 samples/s | 65.5 steps/s
[Step=24800 Epoch=121.6] | Loss=0.00632 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=3.500 | 5035.3 samples/s | 78.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step24800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.476 | 3591.8 samples/s | 56.1 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00255 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.481 | 3954.6 samples/s | 61.8 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00129 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.484 | 5561.4 samples/s | 86.9 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00087 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.485 | 1664.7 samples/s | 26.0 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00065 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.486 | 5201.9 samples/s | 81.3 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00053 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.487 | 1707.1 samples/s | 26.7 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00044 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.487 | 4724.1 samples/s | 73.8 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00038 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=3.488 | 1759.4 samples/s | 27.5 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00033 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.488 | 4274.2 samples/s | 66.8 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.489 | 1810.2 samples/s | 28.3 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.489 | 4072.0 samples/s | 63.6 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.490 | 1862.0 samples/s | 29.1 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.490 | 4141.5 samples/s | 64.7 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.490 | 1891.1 samples/s | 29.5 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.491 | 4134.0 samples/s | 64.6 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.491 | 1875.5 samples/s | 29.3 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.491 | 3994.5 samples/s | 62.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step24800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.3] | Loss=0.01078 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.301 | L2-Norm(final)=3.476 | 3705.5 samples/s | 57.9 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00146 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.477 | 3830.9 samples/s | 59.9 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00074 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.478 | 5620.8 samples/s | 87.8 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00050 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.479 | 1705.5 samples/s | 26.6 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.480 | 5340.5 samples/s | 83.4 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00031 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.480 | 1730.0 samples/s | 27.0 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00026 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.481 | 4651.8 samples/s | 72.7 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.481 | 1755.1 samples/s | 27.4 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.482 | 4335.1 samples/s | 67.7 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.482 | 1821.2 samples/s | 28.5 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.482 | 4190.2 samples/s | 65.5 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.483 | 1889.9 samples/s | 29.5 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.483 | 4239.5 samples/s | 66.2 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.484 | 1869.9 samples/s | 29.2 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.484 | 3995.3 samples/s | 62.4 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.484 | 1901.2 samples/s | 29.7 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.485 | 4003.4 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step24800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=229.2] | Loss=0.02439 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.301 | L2-Norm(final)=3.476 | 3668.6 samples/s | 57.3 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00147 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.479 | 3888.3 samples/s | 60.8 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00075 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.481 | 5611.4 samples/s | 87.7 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00051 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.482 | 1674.6 samples/s | 26.2 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00039 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.483 | 5173.9 samples/s | 80.8 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00031 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.484 | 1696.0 samples/s | 26.5 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00026 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.485 | 4955.2 samples/s | 77.4 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00023 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.486 | 1732.6 samples/s | 27.1 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.486 | 4562.8 samples/s | 71.3 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.487 | 1763.1 samples/s | 27.5 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.487 | 4307.7 samples/s | 67.3 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.488 | 1797.7 samples/s | 28.1 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.489 | 4222.1 samples/s | 66.0 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.489 | 1856.8 samples/s | 29.0 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.490 | 4103.8 samples/s | 64.1 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.490 | 1853.4 samples/s | 29.0 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.491 | 4020.2 samples/s | 62.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step24800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=226.2] | Loss=0.00196 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.476 | 4089.8 samples/s | 63.9 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00103 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.481 | 3499.9 samples/s | 54.7 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00054 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.484 | 5481.4 samples/s | 85.6 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00040 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.486 | 1669.2 samples/s | 26.1 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00030 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=3.488 | 4947.9 samples/s | 77.3 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.489 | 1740.1 samples/s | 27.2 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00020 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.490 | 4610.0 samples/s | 72.0 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00018 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.490 | 1807.4 samples/s | 28.2 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.491 | 4300.7 samples/s | 67.2 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.492 | 1842.5 samples/s | 28.8 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.492 | 3975.3 samples/s | 62.1 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.492 | 1874.2 samples/s | 29.3 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.493 | 4198.5 samples/s | 65.6 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.493 | 1899.3 samples/s | 29.7 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.494 | 4149.8 samples/s | 64.8 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.494 | 2021.2 samples/s | 31.6 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.494 | 3656.5 samples/s | 57.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step24800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.8] | Loss=0.01542 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.301 | L2-Norm(final)=3.476 | 3681.3 samples/s | 57.5 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00085 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.483 | 3670.2 samples/s | 57.3 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00044 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.485 | 5570.4 samples/s | 87.0 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00030 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.486 | 1682.9 samples/s | 26.3 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00023 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.487 | 5359.1 samples/s | 83.7 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00018 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.488 | 1730.0 samples/s | 27.0 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.489 | 4849.2 samples/s | 75.8 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.489 | 1732.2 samples/s | 27.1 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.490 | 4697.3 samples/s | 73.4 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.490 | 1770.1 samples/s | 27.7 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.491 | 4300.8 samples/s | 67.2 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.491 | 1835.9 samples/s | 28.7 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.491 | 4213.4 samples/s | 65.8 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.492 | 1882.7 samples/s | 29.4 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00007 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.492 | 4110.4 samples/s | 64.2 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00007 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.493 | 1864.4 samples/s | 29.1 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.493 | 3980.5 samples/s | 62.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26688 | acc=0.8773 | tpr=0.8252 | fpr=0.0097 | 3769.4 samples/s | 14.7 steps/s
Avg test loss: 0.26578, Avg test acc: 0.87631, Avg tpr: 0.82509, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.36181 | acc=0.8938 | tpr=0.9513 | fpr=0.1072 | 3816.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.36684 | acc=0.8952 | tpr=0.9659 | fpr=0.1062 | 7030.0 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.37195 | acc=0.8940 | tpr=0.9683 | fpr=0.1073 | 7307.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.37178 | acc=0.8934 | tpr=0.9672 | fpr=0.1080 | 7420.5 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.36903 | acc=0.8939 | tpr=0.9668 | fpr=0.1074 | 7129.6 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.37046 | acc=0.8936 | tpr=0.9687 | fpr=0.1077 | 7171.4 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.37352 | acc=0.8931 | tpr=0.9681 | fpr=0.1082 | 7359.6 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.37496 | acc=0.8931 | tpr=0.9677 | fpr=0.1083 | 6988.5 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.37789 | acc=0.8932 | tpr=0.9693 | fpr=0.1082 | 7070.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.37796 | acc=0.8928 | tpr=0.9709 | fpr=0.1087 | 7082.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.37598 | acc=0.8931 | tpr=0.9702 | fpr=0.1083 | 12887.5 samples/s | 50.3 steps/s
Avg test loss: 0.37570, Avg test acc: 0.89310, Avg tpr: 0.96989, Avg fpr: 0.10830, total FA: 15037

server round 31/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.17484 | Reg=0.00151 | acc=0.9062 | L2-Norm=12.284 | L2-Norm(final)=3.514 | 3863.5 samples/s | 60.4 steps/s
[Step=24850 Epoch=121.2] | Loss=0.03227 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.504 | 3896.8 samples/s | 60.9 steps/s
[Step=24900 Epoch=121.4] | Loss=0.02219 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.501 | 4144.3 samples/s | 64.8 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01668 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.316 | L2-Norm(final)=3.501 | 4187.7 samples/s | 65.4 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01420 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.503 | 5872.2 samples/s | 91.8 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01221 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.505 | 1737.3 samples/s | 27.1 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01076 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=3.508 | 4301.4 samples/s | 67.2 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=3.510 | 4278.5 samples/s | 66.9 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00916 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.512 | 5321.2 samples/s | 83.1 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00866 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=3.515 | 1781.5 samples/s | 27.8 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00806 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.517 | 4179.0 samples/s | 65.3 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00759 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=3.519 | 4183.4 samples/s | 65.4 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00720 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=3.521 | 4970.0 samples/s | 77.7 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00690 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=3.523 | 1835.4 samples/s | 28.7 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00687 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=3.525 | 4310.1 samples/s | 67.3 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00660 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=3.527 | 4329.3 samples/s | 67.6 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00635 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=3.529 | 4676.7 samples/s | 73.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.0] | Loss=0.15858 | Reg=0.00151 | acc=0.9062 | L2-Norm=12.284 | L2-Norm(final)=3.514 | 3674.0 samples/s | 57.4 steps/s
[Step=24850 Epoch=121.3] | Loss=0.03082 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.505 | 4251.0 samples/s | 66.4 steps/s
[Step=24900 Epoch=121.5] | Loss=0.02074 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.311 | L2-Norm(final)=3.502 | 4258.4 samples/s | 66.5 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01662 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.503 | 4198.2 samples/s | 65.6 steps/s
[Step=25000 Epoch=122.0] | Loss=0.01431 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.505 | 5711.0 samples/s | 89.2 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01231 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.507 | 1718.9 samples/s | 26.9 steps/s
[Step=25100 Epoch=122.5] | Loss=0.01088 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=3.509 | 4275.4 samples/s | 66.8 steps/s
[Step=25150 Epoch=122.7] | Loss=0.00992 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=3.512 | 4279.3 samples/s | 66.9 steps/s
[Step=25200 Epoch=123.0] | Loss=0.00908 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.514 | 5437.5 samples/s | 85.0 steps/s
[Step=25250 Epoch=123.2] | Loss=0.00841 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.517 | 1782.7 samples/s | 27.9 steps/s
[Step=25300 Epoch=123.5] | Loss=0.00788 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.519 | 4280.7 samples/s | 66.9 steps/s
[Step=25350 Epoch=123.7] | Loss=0.00745 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=3.522 | 4298.1 samples/s | 67.2 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00708 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=3.524 | 5146.0 samples/s | 80.4 steps/s
[Step=25450 Epoch=124.2] | Loss=0.00668 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.337 | L2-Norm(final)=3.526 | 1781.7 samples/s | 27.8 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00649 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=3.528 | 4217.4 samples/s | 65.9 steps/s
[Step=25550 Epoch=124.7] | Loss=0.00616 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=3.530 | 4131.3 samples/s | 64.6 steps/s
[Step=25600 Epoch=124.9] | Loss=0.00589 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=3.532 | 4731.6 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step25600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.8] | Loss=0.22328 | Reg=0.00151 | acc=0.8594 | L2-Norm=12.284 | L2-Norm(final)=3.514 | 4236.5 samples/s | 66.2 steps/s
[Step=24850 Epoch=121.1] | Loss=0.02622 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.508 | 3583.5 samples/s | 56.0 steps/s
[Step=24900 Epoch=121.3] | Loss=0.01823 | Reg=0.00152 | acc=0.9531 | L2-Norm=12.313 | L2-Norm(final)=3.507 | 4255.7 samples/s | 66.5 steps/s
[Step=24950 Epoch=121.6] | Loss=0.01535 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.509 | 4278.6 samples/s | 66.9 steps/s
[Step=25000 Epoch=121.8] | Loss=0.01321 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.321 | L2-Norm(final)=3.511 | 5847.7 samples/s | 91.4 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01122 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.324 | L2-Norm(final)=3.513 | 1726.5 samples/s | 27.0 steps/s
[Step=25100 Epoch=122.3] | Loss=0.01015 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.327 | L2-Norm(final)=3.516 | 4213.3 samples/s | 65.8 steps/s
[Step=25150 Epoch=122.5] | Loss=0.00948 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.518 | 4279.8 samples/s | 66.9 steps/s
[Step=25200 Epoch=122.8] | Loss=0.00883 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.521 | 5383.7 samples/s | 84.1 steps/s
[Step=25250 Epoch=123.0] | Loss=0.00820 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.523 | 1788.4 samples/s | 27.9 steps/s
[Step=25300 Epoch=123.3] | Loss=0.00774 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.334 | L2-Norm(final)=3.525 | 4262.8 samples/s | 66.6 steps/s
[Step=25350 Epoch=123.5] | Loss=0.00726 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=3.527 | 4286.5 samples/s | 67.0 steps/s
[Step=25400 Epoch=123.8] | Loss=0.00699 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=3.530 | 5038.1 samples/s | 78.7 steps/s
[Step=25450 Epoch=124.0] | Loss=0.00670 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=3.532 | 1849.3 samples/s | 28.9 steps/s
[Step=25500 Epoch=124.2] | Loss=0.00643 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=3.534 | 4283.4 samples/s | 66.9 steps/s
[Step=25550 Epoch=124.5] | Loss=0.00632 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=3.536 | 4189.4 samples/s | 65.5 steps/s
[Step=25600 Epoch=124.7] | Loss=0.00611 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.538 | 4562.4 samples/s | 71.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step25600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.21341 | Reg=0.00151 | acc=0.8906 | L2-Norm=12.284 | L2-Norm(final)=3.514 | 3926.3 samples/s | 61.3 steps/s
[Step=24850 Epoch=121.2] | Loss=0.02424 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.510 | 3841.4 samples/s | 60.0 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01718 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.316 | L2-Norm(final)=3.510 | 4181.5 samples/s | 65.3 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01340 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.512 | 4252.8 samples/s | 66.5 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01192 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.514 | 5852.9 samples/s | 91.5 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01023 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=3.516 | 1752.1 samples/s | 27.4 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00924 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=3.518 | 4277.5 samples/s | 66.8 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00843 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.330 | L2-Norm(final)=3.520 | 4298.7 samples/s | 67.2 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00796 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.522 | 5354.2 samples/s | 83.7 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00747 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=3.525 | 1787.1 samples/s | 27.9 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00699 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=3.527 | 4310.8 samples/s | 67.4 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00660 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=3.529 | 4280.5 samples/s | 66.9 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00633 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=3.531 | 5061.6 samples/s | 79.1 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00602 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=3.533 | 1838.6 samples/s | 28.7 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00580 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=3.536 | 4367.1 samples/s | 68.2 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00560 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=3.538 | 4416.4 samples/s | 69.0 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00538 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=3.540 | 4667.4 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step25600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.6] | Loss=0.10044 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.284 | L2-Norm(final)=3.515 | 3909.8 samples/s | 61.1 steps/s
[Step=24850 Epoch=121.9] | Loss=0.02281 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.511 | 4060.5 samples/s | 63.4 steps/s
[Step=24900 Epoch=122.1] | Loss=0.01617 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.311 | L2-Norm(final)=3.514 | 4223.4 samples/s | 66.0 steps/s
[Step=24950 Epoch=122.4] | Loss=0.01328 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.315 | L2-Norm(final)=3.515 | 4225.4 samples/s | 66.0 steps/s
[Step=25000 Epoch=122.6] | Loss=0.01166 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.318 | L2-Norm(final)=3.517 | 5883.8 samples/s | 91.9 steps/s
[Step=25050 Epoch=122.8] | Loss=0.01021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.518 | 1727.1 samples/s | 27.0 steps/s
[Step=25100 Epoch=123.1] | Loss=0.00912 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.520 | 4212.8 samples/s | 65.8 steps/s
[Step=25150 Epoch=123.3] | Loss=0.00818 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=3.522 | 4375.7 samples/s | 68.4 steps/s
[Step=25200 Epoch=123.6] | Loss=0.00756 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=3.525 | 5650.4 samples/s | 88.3 steps/s
[Step=25250 Epoch=123.8] | Loss=0.00714 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=3.527 | 1760.9 samples/s | 27.5 steps/s
[Step=25300 Epoch=124.1] | Loss=0.00666 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.530 | 4206.3 samples/s | 65.7 steps/s
[Step=25350 Epoch=124.3] | Loss=0.00640 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=3.532 | 4189.8 samples/s | 65.5 steps/s
[Step=25400 Epoch=124.6] | Loss=0.00615 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.534 | 5261.9 samples/s | 82.2 steps/s
[Step=25450 Epoch=124.8] | Loss=0.00584 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=3.536 | 1799.7 samples/s | 28.1 steps/s
[Step=25500 Epoch=125.0] | Loss=0.00565 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=3.538 | 4284.5 samples/s | 66.9 steps/s
[Step=25550 Epoch=125.3] | Loss=0.00546 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=3.540 | 4290.0 samples/s | 67.0 steps/s
[Step=25600 Epoch=125.5] | Loss=0.00527 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=3.542 | 5103.4 samples/s | 79.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step25600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.0] | Loss=0.04367 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.284 | L2-Norm(final)=3.515 | 3966.3 samples/s | 62.0 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00301 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.520 | 3596.8 samples/s | 56.2 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00156 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.521 | 5456.9 samples/s | 85.3 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00105 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.522 | 1656.7 samples/s | 25.9 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00079 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.522 | 5074.7 samples/s | 79.3 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00063 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=3.523 | 1725.2 samples/s | 27.0 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00053 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.523 | 4861.5 samples/s | 76.0 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00045 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.523 | 1770.5 samples/s | 27.7 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00040 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.524 | 4442.4 samples/s | 69.4 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.524 | 1801.7 samples/s | 28.2 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00032 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.524 | 4037.2 samples/s | 63.1 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.524 | 1827.3 samples/s | 28.6 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.524 | 4027.0 samples/s | 62.9 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.525 | 1871.9 samples/s | 29.2 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00023 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.525 | 4085.8 samples/s | 63.8 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.525 | 1852.0 samples/s | 28.9 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.525 | 3959.5 samples/s | 61.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step25600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.9] | Loss=0.01287 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.515 | 3619.1 samples/s | 56.5 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00227 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.520 | 3802.3 samples/s | 59.4 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00114 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.520 | 5559.6 samples/s | 86.9 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00077 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.521 | 1658.8 samples/s | 25.9 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00058 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.521 | 5023.4 samples/s | 78.5 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00046 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=3.521 | 1725.1 samples/s | 27.0 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00039 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.522 | 4702.9 samples/s | 73.5 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00033 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.522 | 1779.9 samples/s | 27.8 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00029 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.522 | 4497.4 samples/s | 70.3 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00026 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.522 | 1781.1 samples/s | 27.8 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00023 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.523 | 4090.0 samples/s | 63.9 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.523 | 1866.0 samples/s | 29.2 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.523 | 4060.0 samples/s | 63.4 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.523 | 1870.5 samples/s | 29.2 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.523 | 4187.0 samples/s | 65.4 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.524 | 1867.0 samples/s | 29.2 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.524 | 4018.8 samples/s | 62.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step25600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.8] | Loss=0.03936 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.284 | L2-Norm(final)=3.515 | 3898.5 samples/s | 60.9 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00139 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.521 | 3570.1 samples/s | 55.8 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00071 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.523 | 5620.1 samples/s | 87.8 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00048 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.524 | 1663.8 samples/s | 26.0 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.525 | 5297.0 samples/s | 82.8 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.526 | 1177.9 samples/s | 18.4 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.527 | 4462.9 samples/s | 69.7 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.527 | 1714.3 samples/s | 26.8 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.528 | 4574.9 samples/s | 71.5 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.528 | 1780.8 samples/s | 27.8 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.529 | 4260.2 samples/s | 66.6 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.529 | 1834.9 samples/s | 28.7 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.529 | 4117.1 samples/s | 64.3 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.530 | 1848.0 samples/s | 28.9 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.530 | 4103.8 samples/s | 64.1 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.531 | 1876.4 samples/s | 29.3 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.531 | 4155.7 samples/s | 64.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step25600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=233.7] | Loss=0.02765 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.284 | L2-Norm(final)=3.514 | 4058.8 samples/s | 63.4 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00250 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.518 | 3488.5 samples/s | 54.5 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00139 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.519 | 5520.0 samples/s | 86.3 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00094 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.520 | 1693.9 samples/s | 26.5 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00071 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.520 | 5039.6 samples/s | 78.7 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00057 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.521 | 1721.3 samples/s | 26.9 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00047 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.521 | 4613.2 samples/s | 72.1 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00041 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.521 | 1781.9 samples/s | 27.8 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.521 | 4243.4 samples/s | 66.3 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00032 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.522 | 1888.7 samples/s | 29.5 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.522 | 4042.2 samples/s | 63.2 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00026 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.522 | 1863.0 samples/s | 29.1 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.522 | 3976.9 samples/s | 62.1 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.522 | 1894.3 samples/s | 29.6 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.523 | 4055.5 samples/s | 63.4 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.523 | 2044.8 samples/s | 32.0 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.523 | 3535.3 samples/s | 55.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step25600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.4] | Loss=0.03102 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.284 | L2-Norm(final)=3.515 | 4006.0 samples/s | 62.6 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00183 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.521 | 3588.2 samples/s | 56.1 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00093 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.522 | 5537.3 samples/s | 86.5 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00062 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.523 | 1649.5 samples/s | 25.8 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00047 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.524 | 5256.2 samples/s | 82.1 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.524 | 1701.7 samples/s | 26.6 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00032 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.525 | 4836.7 samples/s | 75.6 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.525 | 1748.0 samples/s | 27.3 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.526 | 4657.3 samples/s | 72.8 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.526 | 1788.4 samples/s | 27.9 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.527 | 4369.5 samples/s | 68.3 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.527 | 1840.0 samples/s | 28.8 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.527 | 4153.1 samples/s | 64.9 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.528 | 1871.1 samples/s | 29.2 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.528 | 4166.3 samples/s | 65.1 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.528 | 1887.4 samples/s | 29.5 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.529 | 4169.5 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31621 | acc=0.8572 | tpr=0.7956 | fpr=0.0092 | 3768.8 samples/s | 14.7 steps/s
Avg test loss: 0.31505, Avg test acc: 0.85640, Avg tpr: 0.79600, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.32691 | acc=0.9119 | tpr=0.9513 | fpr=0.0888 | 3808.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.33313 | acc=0.9134 | tpr=0.9659 | fpr=0.0875 | 7086.1 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.33887 | acc=0.9125 | tpr=0.9669 | fpr=0.0885 | 7714.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.33889 | acc=0.9121 | tpr=0.9661 | fpr=0.0889 | 6815.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.33604 | acc=0.9124 | tpr=0.9651 | fpr=0.0886 | 7047.8 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.33779 | acc=0.9122 | tpr=0.9673 | fpr=0.0888 | 7154.0 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.34082 | acc=0.9117 | tpr=0.9668 | fpr=0.0893 | 6977.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.34246 | acc=0.9118 | tpr=0.9672 | fpr=0.0892 | 7332.7 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.34557 | acc=0.9118 | tpr=0.9688 | fpr=0.0892 | 7023.4 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.34532 | acc=0.9115 | tpr=0.9700 | fpr=0.0896 | 6926.5 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.34340 | acc=0.9118 | tpr=0.9694 | fpr=0.0892 | 13337.2 samples/s | 52.1 steps/s
Avg test loss: 0.34307, Avg test acc: 0.91179, Avg tpr: 0.96870, Avg fpr: 0.08924, total FA: 12391

server round 32/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.04392 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 3851.3 samples/s | 60.2 steps/s
[Step=25650 Epoch=125.1] | Loss=0.02527 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.541 | 4141.7 samples/s | 64.7 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01861 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.538 | 4223.3 samples/s | 66.0 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01524 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.538 | 4233.2 samples/s | 66.1 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01315 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.539 | 5875.5 samples/s | 91.8 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01126 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.310 | L2-Norm(final)=3.541 | 1746.2 samples/s | 27.3 steps/s
[Step=25900 Epoch=126.3] | Loss=0.01018 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.543 | 4336.2 samples/s | 67.8 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00936 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.545 | 4301.2 samples/s | 67.2 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00875 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=3.547 | 5455.1 samples/s | 85.2 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00803 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.550 | 1805.0 samples/s | 28.2 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00752 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=3.552 | 4308.9 samples/s | 67.3 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00714 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.554 | 4323.6 samples/s | 67.6 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00688 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.324 | L2-Norm(final)=3.556 | 5032.3 samples/s | 78.6 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00673 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=3.558 | 1821.5 samples/s | 28.5 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00642 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=3.560 | 4207.5 samples/s | 65.7 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00615 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=3.563 | 4209.6 samples/s | 65.8 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00598 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.565 | 4648.1 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.9] | Loss=0.14386 | Reg=0.00151 | acc=0.8750 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 3717.6 samples/s | 58.1 steps/s
[Step=25650 Epoch=125.2] | Loss=0.03452 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.294 | L2-Norm(final)=3.535 | 4120.6 samples/s | 64.4 steps/s
[Step=25700 Epoch=125.4] | Loss=0.02183 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.304 | L2-Norm(final)=3.533 | 4190.6 samples/s | 65.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01739 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.309 | L2-Norm(final)=3.534 | 4274.8 samples/s | 66.8 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01453 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.536 | 5715.4 samples/s | 89.3 steps/s
[Step=25850 Epoch=126.1] | Loss=0.01237 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=3.539 | 1709.1 samples/s | 26.7 steps/s
[Step=25900 Epoch=126.4] | Loss=0.01074 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.541 | 4249.4 samples/s | 66.4 steps/s
[Step=25950 Epoch=126.6] | Loss=0.00979 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.544 | 4300.2 samples/s | 67.2 steps/s
[Step=26000 Epoch=126.9] | Loss=0.00912 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=3.546 | 5376.6 samples/s | 84.0 steps/s
[Step=26050 Epoch=127.1] | Loss=0.00839 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=3.548 | 1777.6 samples/s | 27.8 steps/s
[Step=26100 Epoch=127.4] | Loss=0.00796 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=3.551 | 4344.8 samples/s | 67.9 steps/s
[Step=26150 Epoch=127.6] | Loss=0.00748 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.553 | 4341.0 samples/s | 67.8 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00709 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.555 | 5227.6 samples/s | 81.7 steps/s
[Step=26250 Epoch=128.1] | Loss=0.00672 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.557 | 1796.3 samples/s | 28.1 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00649 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=3.559 | 4139.5 samples/s | 64.7 steps/s
[Step=26350 Epoch=128.6] | Loss=0.00627 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=3.561 | 4164.7 samples/s | 65.1 steps/s
[Step=26400 Epoch=128.8] | Loss=0.00605 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=3.563 | 4765.6 samples/s | 74.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step26400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.7] | Loss=0.12734 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.269 | L2-Norm(final)=3.548 | 3809.3 samples/s | 59.5 steps/s
[Step=25650 Epoch=125.0] | Loss=0.02755 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.294 | L2-Norm(final)=3.540 | 4043.3 samples/s | 63.2 steps/s
[Step=25700 Epoch=125.2] | Loss=0.01960 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.539 | 4183.3 samples/s | 65.4 steps/s
[Step=25750 Epoch=125.5] | Loss=0.01576 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.307 | L2-Norm(final)=3.540 | 4233.3 samples/s | 66.1 steps/s
[Step=25800 Epoch=125.7] | Loss=0.01336 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.541 | 5743.1 samples/s | 89.7 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01166 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.544 | 1750.2 samples/s | 27.3 steps/s
[Step=25900 Epoch=126.2] | Loss=0.01029 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.546 | 4191.4 samples/s | 65.5 steps/s
[Step=25950 Epoch=126.4] | Loss=0.00954 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.549 | 4210.7 samples/s | 65.8 steps/s
[Step=26000 Epoch=126.7] | Loss=0.00885 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=3.551 | 5295.2 samples/s | 82.7 steps/s
[Step=26050 Epoch=126.9] | Loss=0.00828 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.322 | L2-Norm(final)=3.554 | 1790.6 samples/s | 28.0 steps/s
[Step=26100 Epoch=127.2] | Loss=0.00787 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=3.557 | 4240.8 samples/s | 66.3 steps/s
[Step=26150 Epoch=127.4] | Loss=0.00746 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.325 | L2-Norm(final)=3.559 | 4333.9 samples/s | 67.7 steps/s
[Step=26200 Epoch=127.7] | Loss=0.00709 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=3.561 | 5060.2 samples/s | 79.1 steps/s
[Step=26250 Epoch=127.9] | Loss=0.00670 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=3.564 | 1833.5 samples/s | 28.6 steps/s
[Step=26300 Epoch=128.1] | Loss=0.00640 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=3.566 | 4400.9 samples/s | 68.8 steps/s
[Step=26350 Epoch=128.4] | Loss=0.00624 | Reg=0.00152 | acc=0.9531 | L2-Norm=12.331 | L2-Norm(final)=3.568 | 4214.4 samples/s | 65.9 steps/s
[Step=26400 Epoch=128.6] | Loss=0.00605 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=3.571 | 4503.4 samples/s | 70.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step26400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.14923 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.269 | L2-Norm(final)=3.548 | 3743.0 samples/s | 58.5 steps/s
[Step=25650 Epoch=125.1] | Loss=0.03138 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.296 | L2-Norm(final)=3.538 | 4125.7 samples/s | 64.5 steps/s
[Step=25700 Epoch=125.3] | Loss=0.02177 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.304 | L2-Norm(final)=3.536 | 4321.8 samples/s | 67.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01713 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.536 | 4272.4 samples/s | 66.8 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01404 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.538 | 5828.7 samples/s | 91.1 steps/s
[Step=25850 Epoch=126.1] | Loss=0.01199 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=3.540 | 1762.2 samples/s | 27.5 steps/s
[Step=25900 Epoch=126.3] | Loss=0.01048 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.542 | 4194.0 samples/s | 65.5 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00949 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=3.545 | 4278.1 samples/s | 66.8 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00892 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.320 | L2-Norm(final)=3.547 | 5415.7 samples/s | 84.6 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00825 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.549 | 1761.6 samples/s | 27.5 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00778 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=3.552 | 4254.0 samples/s | 66.5 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00737 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.324 | L2-Norm(final)=3.554 | 4222.9 samples/s | 66.0 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00705 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=3.556 | 4901.3 samples/s | 76.6 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00669 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=3.558 | 1856.6 samples/s | 29.0 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00641 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=3.560 | 4245.3 samples/s | 66.3 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00618 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=3.562 | 4291.6 samples/s | 67.1 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00591 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=3.564 | 4615.6 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step26400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=125.5] | Loss=0.25353 | Reg=0.00151 | acc=0.8594 | L2-Norm=12.269 | L2-Norm(final)=3.548 | 3958.7 samples/s | 61.9 steps/s
[Step=25650 Epoch=125.8] | Loss=0.02366 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.542 | 3840.9 samples/s | 60.0 steps/s
[Step=25700 Epoch=126.0] | Loss=0.01591 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=3.543 | 4219.7 samples/s | 65.9 steps/s
[Step=25750 Epoch=126.3] | Loss=0.01346 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.304 | L2-Norm(final)=3.545 | 4303.2 samples/s | 67.2 steps/s
[Step=25800 Epoch=126.5] | Loss=0.01152 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.307 | L2-Norm(final)=3.546 | 5915.4 samples/s | 92.4 steps/s
[Step=25850 Epoch=126.8] | Loss=0.00980 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.549 | 1733.5 samples/s | 27.1 steps/s
[Step=25900 Epoch=127.0] | Loss=0.00867 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.551 | 4254.8 samples/s | 66.5 steps/s
[Step=25950 Epoch=127.3] | Loss=0.00803 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=3.553 | 4371.0 samples/s | 68.3 steps/s
[Step=26000 Epoch=127.5] | Loss=0.00747 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=3.556 | 5723.9 samples/s | 89.4 steps/s
[Step=26050 Epoch=127.7] | Loss=0.00700 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=3.558 | 1770.0 samples/s | 27.7 steps/s
[Step=26100 Epoch=128.0] | Loss=0.00660 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.318 | L2-Norm(final)=3.560 | 4273.4 samples/s | 66.8 steps/s
[Step=26150 Epoch=128.2] | Loss=0.00626 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=3.562 | 4282.2 samples/s | 66.9 steps/s
[Step=26200 Epoch=128.5] | Loss=0.00595 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=3.564 | 5374.4 samples/s | 84.0 steps/s
[Step=26250 Epoch=128.7] | Loss=0.00565 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=3.566 | 1786.2 samples/s | 27.9 steps/s
[Step=26300 Epoch=129.0] | Loss=0.00546 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=3.568 | 4305.6 samples/s | 67.3 steps/s
[Step=26350 Epoch=129.2] | Loss=0.00530 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=3.570 | 4310.3 samples/s | 67.3 steps/s
[Step=26400 Epoch=129.5] | Loss=0.00509 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=3.572 | 5250.3 samples/s | 82.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step26400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=242.6] | Loss=0.02718 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 4072.4 samples/s | 63.6 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00129 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.555 | 3693.2 samples/s | 57.7 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00071 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.557 | 5741.1 samples/s | 89.7 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00049 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.559 | 1675.5 samples/s | 26.2 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00037 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.560 | 5148.1 samples/s | 80.4 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.561 | 1720.3 samples/s | 26.9 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.562 | 4711.7 samples/s | 73.6 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.562 | 1778.6 samples/s | 27.8 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.563 | 4242.9 samples/s | 66.3 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.563 | 1818.7 samples/s | 28.4 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.564 | 4169.5 samples/s | 65.1 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.564 | 1845.3 samples/s | 28.8 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.564 | 4188.0 samples/s | 65.4 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.565 | 1898.4 samples/s | 29.7 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.565 | 4063.3 samples/s | 63.5 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.565 | 1890.1 samples/s | 29.5 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.565 | 4124.8 samples/s | 64.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step26400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=243.5] | Loss=0.03488 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 3857.7 samples/s | 60.3 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00311 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.553 | 3714.2 samples/s | 58.0 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00159 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.554 | 5473.0 samples/s | 85.5 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00107 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.555 | 1657.9 samples/s | 25.9 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00080 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.556 | 5124.4 samples/s | 80.1 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00064 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.557 | 1728.6 samples/s | 27.0 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00054 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.557 | 4840.3 samples/s | 75.6 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00046 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.557 | 1767.8 samples/s | 27.6 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00040 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.558 | 4351.2 samples/s | 68.0 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.558 | 1816.5 samples/s | 28.4 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00032 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.558 | 4126.5 samples/s | 64.5 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.558 | 1848.0 samples/s | 28.9 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.558 | 4089.3 samples/s | 63.9 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.559 | 1868.1 samples/s | 29.2 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00023 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.559 | 4154.1 samples/s | 64.9 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.559 | 1882.6 samples/s | 29.4 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.559 | 4024.8 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step26400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.5] | Loss=0.00041 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 4094.4 samples/s | 64.0 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00141 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.555 | 3502.5 samples/s | 54.7 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00074 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.557 | 5754.6 samples/s | 89.9 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00049 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.559 | 1672.3 samples/s | 26.1 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00037 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.560 | 5209.7 samples/s | 81.4 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.561 | 1729.1 samples/s | 27.0 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.561 | 5078.0 samples/s | 79.3 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.562 | 1746.4 samples/s | 27.3 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.562 | 4656.3 samples/s | 72.8 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.563 | 1788.1 samples/s | 27.9 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.563 | 4319.7 samples/s | 67.5 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.563 | 1830.6 samples/s | 28.6 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.564 | 4092.4 samples/s | 63.9 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.564 | 1854.7 samples/s | 29.0 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.565 | 3996.4 samples/s | 62.4 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.565 | 1870.5 samples/s | 29.2 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.565 | 4063.4 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step26400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=241.2] | Loss=0.01279 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 3795.9 samples/s | 59.3 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00150 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.558 | 3904.0 samples/s | 61.0 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00076 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.559 | 5616.1 samples/s | 87.8 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00051 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.560 | 1681.2 samples/s | 26.3 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00039 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.561 | 4932.4 samples/s | 77.1 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00031 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.562 | 1727.6 samples/s | 27.0 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00026 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.562 | 4524.7 samples/s | 70.7 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.563 | 1781.1 samples/s | 27.8 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.563 | 4265.1 samples/s | 66.6 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.563 | 1847.1 samples/s | 28.9 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.564 | 4137.6 samples/s | 64.6 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.564 | 1879.0 samples/s | 29.4 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.564 | 4042.3 samples/s | 63.2 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.564 | 1870.6 samples/s | 29.2 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.565 | 4033.7 samples/s | 63.0 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.565 | 1951.5 samples/s | 30.5 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.565 | 3761.7 samples/s | 58.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step26400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.0] | Loss=0.02668 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=3.549 | 3642.5 samples/s | 56.9 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00081 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.555 | 3829.7 samples/s | 59.8 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00041 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.557 | 5566.7 samples/s | 87.0 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00028 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.558 | 1679.1 samples/s | 26.2 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.559 | 5233.8 samples/s | 81.8 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.559 | 1694.6 samples/s | 26.5 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.560 | 4811.4 samples/s | 75.2 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.560 | 1745.3 samples/s | 27.3 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.561 | 4521.0 samples/s | 70.6 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.561 | 1768.6 samples/s | 27.6 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00009 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.561 | 4372.0 samples/s | 68.3 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.562 | 1803.3 samples/s | 28.2 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.562 | 4123.9 samples/s | 64.4 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00007 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.562 | 1844.5 samples/s | 28.8 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00007 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.563 | 4047.1 samples/s | 63.2 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.563 | 1854.9 samples/s | 29.0 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.563 | 4198.6 samples/s | 65.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26993 | acc=0.8767 | tpr=0.8243 | fpr=0.0094 | 3793.1 samples/s | 14.8 steps/s
Avg test loss: 0.26917, Avg test acc: 0.87655, Avg tpr: 0.82561, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.36519 | acc=0.8962 | tpr=0.9469 | fpr=0.1047 | 3810.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37140 | acc=0.8982 | tpr=0.9638 | fpr=0.1030 | 7222.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.37700 | acc=0.8972 | tpr=0.9640 | fpr=0.1040 | 7288.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.37672 | acc=0.8968 | tpr=0.9628 | fpr=0.1044 | 6943.0 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.37380 | acc=0.8975 | tpr=0.9624 | fpr=0.1037 | 7261.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.37536 | acc=0.8974 | tpr=0.9651 | fpr=0.1039 | 7081.7 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.37835 | acc=0.8969 | tpr=0.9649 | fpr=0.1044 | 7044.7 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.37997 | acc=0.8970 | tpr=0.9650 | fpr=0.1042 | 7222.9 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.38319 | acc=0.8972 | tpr=0.9669 | fpr=0.1041 | 6990.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.38313 | acc=0.8968 | tpr=0.9683 | fpr=0.1045 | 7081.5 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.38104 | acc=0.8971 | tpr=0.9674 | fpr=0.1042 | 12817.5 samples/s | 50.1 steps/s
Avg test loss: 0.38076, Avg test acc: 0.89711, Avg tpr: 0.96672, Avg fpr: 0.10416, total FA: 14462

server round 33/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.14019 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 3946.6 samples/s | 61.7 steps/s
[Step=26450 Epoch=129.0] | Loss=0.02761 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.573 | 3982.9 samples/s | 62.2 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01956 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.571 | 4307.9 samples/s | 67.3 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01544 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.572 | 4170.5 samples/s | 65.2 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01366 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.573 | 5727.0 samples/s | 89.5 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01172 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.574 | 1749.0 samples/s | 27.3 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01041 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.576 | 4218.2 samples/s | 65.9 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00944 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.578 | 4217.0 samples/s | 65.9 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00877 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.297 | L2-Norm(final)=3.581 | 5383.8 samples/s | 84.1 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00818 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.583 | 1771.7 samples/s | 27.7 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00765 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=3.585 | 4355.6 samples/s | 68.1 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00724 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.587 | 4309.7 samples/s | 67.3 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00700 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.589 | 5005.0 samples/s | 78.2 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00673 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.591 | 1823.2 samples/s | 28.5 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00646 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.593 | 4270.5 samples/s | 66.7 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00630 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.595 | 4295.7 samples/s | 67.1 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00603 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.597 | 4684.9 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.8] | Loss=0.24074 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 3987.4 samples/s | 62.3 steps/s
[Step=26450 Epoch=129.1] | Loss=0.02979 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.276 | L2-Norm(final)=3.573 | 3976.1 samples/s | 62.1 steps/s
[Step=26500 Epoch=129.3] | Loss=0.01861 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.572 | 4271.1 samples/s | 66.7 steps/s
[Step=26550 Epoch=129.6] | Loss=0.01442 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.574 | 4253.7 samples/s | 66.5 steps/s
[Step=26600 Epoch=129.8] | Loss=0.01291 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.291 | L2-Norm(final)=3.576 | 5813.0 samples/s | 90.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01127 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.577 | 1723.0 samples/s | 26.9 steps/s
[Step=26700 Epoch=130.3] | Loss=0.00987 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.579 | 4215.4 samples/s | 65.9 steps/s
[Step=26750 Epoch=130.5] | Loss=0.00896 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.581 | 4232.0 samples/s | 66.1 steps/s
[Step=26800 Epoch=130.8] | Loss=0.00814 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.583 | 5405.5 samples/s | 84.5 steps/s
[Step=26850 Epoch=131.0] | Loss=0.00769 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.585 | 1780.4 samples/s | 27.8 steps/s
[Step=26900 Epoch=131.3] | Loss=0.00725 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.587 | 4259.5 samples/s | 66.6 steps/s
[Step=26950 Epoch=131.5] | Loss=0.00690 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.588 | 4231.2 samples/s | 66.1 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00649 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.590 | 5139.7 samples/s | 80.3 steps/s
[Step=27050 Epoch=132.0] | Loss=0.00617 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.592 | 1819.4 samples/s | 28.4 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00593 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.594 | 4215.0 samples/s | 65.9 steps/s
[Step=27150 Epoch=132.5] | Loss=0.00579 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=3.595 | 4170.3 samples/s | 65.2 steps/s
[Step=27200 Epoch=132.7] | Loss=0.00555 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.597 | 4754.2 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step27200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.6] | Loss=0.07165 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 4141.0 samples/s | 64.7 steps/s
[Step=26450 Epoch=128.9] | Loss=0.02358 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.576 | 3877.0 samples/s | 60.6 steps/s
[Step=26500 Epoch=129.1] | Loss=0.01624 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=3.576 | 4255.3 samples/s | 66.5 steps/s
[Step=26550 Epoch=129.4] | Loss=0.01399 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.576 | 4460.9 samples/s | 69.7 steps/s
[Step=26600 Epoch=129.6] | Loss=0.01204 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.578 | 5854.4 samples/s | 91.5 steps/s
[Step=26650 Epoch=129.9] | Loss=0.01028 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.580 | 1777.9 samples/s | 27.8 steps/s
[Step=26700 Epoch=130.1] | Loss=0.00912 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.583 | 4281.3 samples/s | 66.9 steps/s
[Step=26750 Epoch=130.3] | Loss=0.00842 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.298 | L2-Norm(final)=3.585 | 4238.2 samples/s | 66.2 steps/s
[Step=26800 Epoch=130.6] | Loss=0.00789 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.587 | 5136.3 samples/s | 80.3 steps/s
[Step=26850 Epoch=130.8] | Loss=0.00744 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.590 | 1768.7 samples/s | 27.6 steps/s
[Step=26900 Epoch=131.1] | Loss=0.00699 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=3.592 | 4220.0 samples/s | 65.9 steps/s
[Step=26950 Epoch=131.3] | Loss=0.00672 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.594 | 4264.9 samples/s | 66.6 steps/s
[Step=27000 Epoch=131.6] | Loss=0.00646 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=3.596 | 4934.1 samples/s | 77.1 steps/s
[Step=27050 Epoch=131.8] | Loss=0.00614 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=3.598 | 1836.5 samples/s | 28.7 steps/s
[Step=27100 Epoch=132.0] | Loss=0.00591 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=3.601 | 4284.0 samples/s | 66.9 steps/s
[Step=27150 Epoch=132.3] | Loss=0.00570 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=3.603 | 4336.2 samples/s | 67.8 steps/s
[Step=27200 Epoch=132.5] | Loss=0.00557 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=3.605 | 4649.4 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step27200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.05231 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 4168.8 samples/s | 65.1 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01944 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.578 | 3791.0 samples/s | 59.2 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01430 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.578 | 4283.9 samples/s | 66.9 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01215 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.285 | L2-Norm(final)=3.579 | 4326.5 samples/s | 67.6 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01055 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.580 | 5912.6 samples/s | 92.4 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00934 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.582 | 1773.6 samples/s | 27.7 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00840 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.583 | 4337.2 samples/s | 67.8 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00773 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.585 | 4321.4 samples/s | 67.5 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00717 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.295 | L2-Norm(final)=3.587 | 5388.6 samples/s | 84.2 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00672 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.589 | 1772.0 samples/s | 27.7 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00656 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.591 | 4163.5 samples/s | 65.1 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00617 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.593 | 4131.0 samples/s | 64.5 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00588 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.594 | 4877.7 samples/s | 76.2 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00556 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.596 | 1821.4 samples/s | 28.5 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00534 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.303 | L2-Norm(final)=3.598 | 4246.3 samples/s | 66.3 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00515 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.600 | 4234.9 samples/s | 66.2 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00502 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.602 | 4592.1 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step27200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=129.5] | Loss=0.05724 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 4218.7 samples/s | 65.9 steps/s
[Step=26450 Epoch=129.7] | Loss=0.02076 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.577 | 3617.6 samples/s | 56.5 steps/s
[Step=26500 Epoch=130.0] | Loss=0.01478 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.577 | 4262.9 samples/s | 66.6 steps/s
[Step=26550 Epoch=130.2] | Loss=0.01242 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.577 | 4141.5 samples/s | 64.7 steps/s
[Step=26600 Epoch=130.4] | Loss=0.01100 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.579 | 5810.6 samples/s | 90.8 steps/s
[Step=26650 Epoch=130.7] | Loss=0.00957 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.581 | 1719.0 samples/s | 26.9 steps/s
[Step=26700 Epoch=130.9] | Loss=0.00861 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.583 | 4266.9 samples/s | 66.7 steps/s
[Step=26750 Epoch=131.2] | Loss=0.00780 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.293 | L2-Norm(final)=3.585 | 4371.4 samples/s | 68.3 steps/s
[Step=26800 Epoch=131.4] | Loss=0.00733 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.587 | 5575.9 samples/s | 87.1 steps/s
[Step=26850 Epoch=131.7] | Loss=0.00704 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.589 | 1760.9 samples/s | 27.5 steps/s
[Step=26900 Epoch=131.9] | Loss=0.00665 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.591 | 4314.5 samples/s | 67.4 steps/s
[Step=26950 Epoch=132.2] | Loss=0.00629 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.593 | 4366.0 samples/s | 68.2 steps/s
[Step=27000 Epoch=132.4] | Loss=0.00591 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.595 | 5259.2 samples/s | 82.2 steps/s
[Step=27050 Epoch=132.6] | Loss=0.00558 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.597 | 1772.6 samples/s | 27.7 steps/s
[Step=27100 Epoch=132.9] | Loss=0.00534 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=3.599 | 4339.5 samples/s | 67.8 steps/s
[Step=27150 Epoch=133.1] | Loss=0.00512 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=3.601 | 4144.7 samples/s | 64.8 steps/s
[Step=27200 Epoch=133.4] | Loss=0.00499 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=3.603 | 5140.5 samples/s | 80.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step27200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=250.2] | Loss=0.08996 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 3607.4 samples/s | 56.4 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00255 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.588 | 3952.4 samples/s | 61.8 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00129 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.589 | 5531.0 samples/s | 86.4 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00086 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.590 | 1692.1 samples/s | 26.4 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00065 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.590 | 5080.3 samples/s | 79.4 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00052 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.591 | 1717.1 samples/s | 26.8 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00043 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.591 | 4729.5 samples/s | 73.9 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00037 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.591 | 1752.7 samples/s | 27.4 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00033 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.592 | 4405.7 samples/s | 68.8 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.592 | 1816.6 samples/s | 28.4 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.592 | 4104.5 samples/s | 64.1 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00024 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.592 | 1857.4 samples/s | 29.0 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.593 | 4109.7 samples/s | 64.2 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.593 | 1876.0 samples/s | 29.3 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.593 | 4259.4 samples/s | 66.6 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.593 | 1888.5 samples/s | 29.5 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.593 | 4038.6 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step27200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.1] | Loss=0.02237 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 4037.9 samples/s | 63.1 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00275 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.589 | 3491.3 samples/s | 54.6 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00139 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.590 | 5677.8 samples/s | 88.7 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00093 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.590 | 1637.8 samples/s | 25.6 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00070 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.591 | 5145.1 samples/s | 80.4 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00056 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.591 | 1729.3 samples/s | 27.0 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00047 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.591 | 4772.6 samples/s | 74.6 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00040 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.591 | 1770.0 samples/s | 27.7 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00035 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.592 | 4494.0 samples/s | 70.2 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00031 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.592 | 1807.3 samples/s | 28.2 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00028 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.592 | 4081.7 samples/s | 63.8 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00026 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.592 | 1863.4 samples/s | 29.1 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.592 | 4138.7 samples/s | 64.7 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.592 | 1906.7 samples/s | 29.8 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.592 | 4127.8 samples/s | 64.5 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.593 | 1912.9 samples/s | 29.9 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.593 | 4066.7 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step27200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=252.1] | Loss=0.01570 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.254 | L2-Norm(final)=3.583 | 3592.8 samples/s | 56.1 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00143 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.588 | 3864.4 samples/s | 60.4 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00073 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.589 | 5735.9 samples/s | 89.6 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00049 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.589 | 1685.3 samples/s | 26.3 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00037 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.590 | 5279.6 samples/s | 82.5 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.590 | 1695.0 samples/s | 26.5 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.591 | 4861.4 samples/s | 76.0 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.591 | 1742.5 samples/s | 27.2 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.591 | 4615.0 samples/s | 72.1 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.591 | 1806.9 samples/s | 28.2 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.592 | 4309.4 samples/s | 67.3 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.592 | 1802.0 samples/s | 28.2 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.592 | 4146.7 samples/s | 64.8 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.592 | 1843.7 samples/s | 28.8 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.593 | 4129.8 samples/s | 64.5 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.593 | 1844.8 samples/s | 28.8 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.593 | 4074.6 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step27200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=248.8] | Loss=0.02658 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 3804.4 samples/s | 59.4 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00144 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.586 | 3597.4 samples/s | 56.2 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00074 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.588 | 5450.6 samples/s | 85.2 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00050 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.590 | 1708.2 samples/s | 26.7 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00037 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.590 | 5025.8 samples/s | 78.5 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.591 | 1739.9 samples/s | 27.2 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.591 | 4442.9 samples/s | 69.4 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.591 | 1774.7 samples/s | 27.7 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00019 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.592 | 4108.0 samples/s | 64.2 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.592 | 1849.1 samples/s | 28.9 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00015 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.592 | 4067.2 samples/s | 63.5 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.592 | 1879.7 samples/s | 29.4 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.593 | 4212.9 samples/s | 65.8 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.593 | 1867.2 samples/s | 29.2 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.593 | 4015.7 samples/s | 62.7 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.593 | 2015.9 samples/s | 31.5 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.593 | 3656.0 samples/s | 57.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step27200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.6] | Loss=0.02178 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.254 | L2-Norm(final)=3.582 | 3793.1 samples/s | 59.3 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00221 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.588 | 3788.1 samples/s | 59.2 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00112 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.589 | 5689.4 samples/s | 88.9 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00075 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.589 | 1682.6 samples/s | 26.3 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00056 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.590 | 5371.9 samples/s | 83.9 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00045 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.590 | 1664.6 samples/s | 26.0 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.590 | 4743.8 samples/s | 74.1 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00033 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.590 | 1727.1 samples/s | 27.0 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.591 | 4503.8 samples/s | 70.4 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00025 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.591 | 1790.6 samples/s | 28.0 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00023 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.591 | 4274.8 samples/s | 66.8 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.591 | 1805.1 samples/s | 28.2 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.591 | 4115.0 samples/s | 64.3 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.592 | 1834.1 samples/s | 28.7 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.592 | 4060.9 samples/s | 63.5 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00015 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.592 | 1885.0 samples/s | 29.5 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00015 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.592 | 4111.9 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29512 | acc=0.8691 | tpr=0.8132 | fpr=0.0094 | 3776.2 samples/s | 14.8 steps/s
Avg test loss: 0.29349, Avg test acc: 0.86830, Avg tpr: 0.81343, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.34464 | acc=0.9110 | tpr=0.9513 | fpr=0.0897 | 3831.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.35164 | acc=0.9124 | tpr=0.9659 | fpr=0.0886 | 7099.8 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.35743 | acc=0.9115 | tpr=0.9669 | fpr=0.0895 | 7278.4 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.35736 | acc=0.9112 | tpr=0.9661 | fpr=0.0898 | 7111.5 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.35435 | acc=0.9117 | tpr=0.9651 | fpr=0.0893 | 7113.8 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.35611 | acc=0.9115 | tpr=0.9665 | fpr=0.0895 | 7116.5 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.35922 | acc=0.9110 | tpr=0.9662 | fpr=0.0900 | 7267.2 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.36096 | acc=0.9111 | tpr=0.9666 | fpr=0.0899 | 7295.0 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.36432 | acc=0.9111 | tpr=0.9684 | fpr=0.0900 | 6919.4 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.36412 | acc=0.9109 | tpr=0.9696 | fpr=0.0902 | 6984.8 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.36203 | acc=0.9112 | tpr=0.9686 | fpr=0.0899 | 13145.4 samples/s | 51.3 steps/s
Avg test loss: 0.36169, Avg test acc: 0.91116, Avg tpr: 0.96791, Avg fpr: 0.08987, total FA: 12478

server round 34/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.00972 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3975.7 samples/s | 62.1 steps/s
[Step=27250 Epoch=132.9] | Loss=0.03109 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.268 | L2-Norm(final)=3.600 | 4128.5 samples/s | 64.5 steps/s
[Step=27300 Epoch=133.1] | Loss=0.02050 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.598 | 4336.2 samples/s | 67.8 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01712 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.280 | L2-Norm(final)=3.598 | 4357.3 samples/s | 68.1 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01422 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.599 | 5849.5 samples/s | 91.4 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01233 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.601 | 1749.9 samples/s | 27.3 steps/s
[Step=27500 Epoch=134.1] | Loss=0.01070 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.603 | 4264.8 samples/s | 66.6 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00986 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.289 | L2-Norm(final)=3.605 | 4288.7 samples/s | 67.0 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00931 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.607 | 5391.4 samples/s | 84.2 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00883 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=3.609 | 1823.6 samples/s | 28.5 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00821 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.611 | 4426.0 samples/s | 69.2 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00769 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.613 | 4278.9 samples/s | 66.9 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00734 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.615 | 5022.6 samples/s | 78.5 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00698 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.297 | L2-Norm(final)=3.617 | 1839.4 samples/s | 28.7 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00672 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.299 | L2-Norm(final)=3.619 | 4157.1 samples/s | 65.0 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00646 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.621 | 4181.4 samples/s | 65.3 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00625 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=3.623 | 4630.2 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.7] | Loss=0.11065 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3948.2 samples/s | 61.7 steps/s
[Step=27250 Epoch=133.0] | Loss=0.02489 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.604 | 3989.8 samples/s | 62.3 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01741 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.273 | L2-Norm(final)=3.605 | 4385.8 samples/s | 68.5 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01400 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.606 | 4333.0 samples/s | 67.7 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01236 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.608 | 5897.5 samples/s | 92.1 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01056 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.284 | L2-Norm(final)=3.610 | 1732.6 samples/s | 27.1 steps/s
[Step=27500 Epoch=134.2] | Loss=0.00915 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.612 | 4154.7 samples/s | 64.9 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00825 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.614 | 4211.6 samples/s | 65.8 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00792 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.616 | 5327.6 samples/s | 83.2 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00740 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.618 | 1740.8 samples/s | 27.2 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00696 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.620 | 4157.5 samples/s | 65.0 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00652 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.622 | 4283.0 samples/s | 66.9 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00625 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.624 | 5296.4 samples/s | 82.8 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00590 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.295 | L2-Norm(final)=3.625 | 1844.7 samples/s | 28.8 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00559 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.627 | 4417.3 samples/s | 69.0 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00538 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.629 | 4238.8 samples/s | 66.2 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00525 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.631 | 4909.9 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.5] | Loss=0.14167 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3869.4 samples/s | 60.5 steps/s
[Step=27250 Epoch=132.8] | Loss=0.02026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.605 | 4029.8 samples/s | 63.0 steps/s
[Step=27300 Epoch=133.0] | Loss=0.01582 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.604 | 4312.4 samples/s | 67.4 steps/s
[Step=27350 Epoch=133.3] | Loss=0.01292 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.605 | 4270.7 samples/s | 66.7 steps/s
[Step=27400 Epoch=133.5] | Loss=0.01203 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=3.606 | 5968.9 samples/s | 93.3 steps/s
[Step=27450 Epoch=133.7] | Loss=0.01039 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=3.608 | 1768.7 samples/s | 27.6 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00926 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.610 | 4343.1 samples/s | 67.9 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00862 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.612 | 4395.4 samples/s | 68.7 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00795 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.290 | L2-Norm(final)=3.615 | 5455.1 samples/s | 85.2 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00735 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.617 | 1791.2 samples/s | 28.0 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00683 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.619 | 4310.9 samples/s | 67.4 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00651 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.622 | 4157.1 samples/s | 65.0 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00633 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.624 | 4971.4 samples/s | 77.7 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00610 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.626 | 1847.6 samples/s | 28.9 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00583 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.628 | 4258.5 samples/s | 66.5 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00568 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=3.630 | 4258.2 samples/s | 66.5 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00552 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=3.632 | 4739.1 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.08335 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3850.8 samples/s | 60.2 steps/s
[Step=27250 Epoch=132.9] | Loss=0.02231 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.604 | 4225.6 samples/s | 66.0 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01618 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.605 | 4355.7 samples/s | 68.1 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01305 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=3.606 | 4217.8 samples/s | 65.9 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01119 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=3.608 | 5770.0 samples/s | 90.2 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00951 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=3.610 | 1742.9 samples/s | 27.2 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00846 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.613 | 4220.6 samples/s | 65.9 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00777 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=3.615 | 4281.3 samples/s | 66.9 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00718 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.617 | 5357.5 samples/s | 83.7 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00679 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.619 | 1794.6 samples/s | 28.0 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00635 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.622 | 4297.7 samples/s | 67.2 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00604 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=3.624 | 4414.1 samples/s | 69.0 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00596 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.626 | 4934.5 samples/s | 77.1 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00573 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.628 | 1834.0 samples/s | 28.7 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00546 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.296 | L2-Norm(final)=3.630 | 4370.4 samples/s | 68.3 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00532 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=3.632 | 4378.5 samples/s | 68.4 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00512 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=3.633 | 4785.5 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=133.4] | Loss=0.44128 | Reg=0.00150 | acc=0.8594 | L2-Norm=12.239 | L2-Norm(final)=3.611 | 3656.8 samples/s | 57.1 steps/s
[Step=27250 Epoch=133.6] | Loss=0.03029 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.601 | 4298.0 samples/s | 67.2 steps/s
[Step=27300 Epoch=133.9] | Loss=0.01828 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.600 | 4369.9 samples/s | 68.3 steps/s
[Step=27350 Epoch=134.1] | Loss=0.01522 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.601 | 4268.9 samples/s | 66.7 steps/s
[Step=27400 Epoch=134.4] | Loss=0.01274 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.603 | 5890.4 samples/s | 92.0 steps/s
[Step=27450 Epoch=134.6] | Loss=0.01080 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.605 | 1731.9 samples/s | 27.1 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00964 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.607 | 4237.1 samples/s | 66.2 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00881 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.609 | 4129.2 samples/s | 64.5 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00814 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=3.611 | 5599.8 samples/s | 87.5 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00758 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=3.614 | 1770.0 samples/s | 27.7 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00714 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=3.616 | 4264.4 samples/s | 66.6 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00675 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=3.618 | 4401.1 samples/s | 68.8 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00646 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=3.620 | 5408.4 samples/s | 84.5 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00621 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=3.622 | 1790.9 samples/s | 28.0 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00587 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.623 | 4183.0 samples/s | 65.4 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00564 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=3.625 | 4161.8 samples/s | 65.0 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00540 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=3.627 | 5047.5 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=257.8] | Loss=0.00887 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3640.3 samples/s | 56.9 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00051 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.623 | 3821.3 samples/s | 59.7 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00027 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.626 | 5608.7 samples/s | 87.6 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.628 | 1681.2 samples/s | 26.3 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.628 | 5159.1 samples/s | 80.6 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.629 | 1729.3 samples/s | 27.0 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00009 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.630 | 4765.1 samples/s | 74.5 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.630 | 1753.1 samples/s | 27.4 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00007 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.630 | 4382.2 samples/s | 68.5 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.631 | 1843.0 samples/s | 28.8 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.631 | 4216.0 samples/s | 65.9 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00005 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.631 | 1878.6 samples/s | 29.4 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00005 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.631 | 4201.0 samples/s | 65.6 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00005 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.632 | 1892.6 samples/s | 29.6 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00004 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.632 | 4037.1 samples/s | 63.1 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00004 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.632 | 1877.1 samples/s | 29.3 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00004 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.632 | 4017.7 samples/s | 62.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=258.7] | Loss=0.03832 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3417.8 samples/s | 53.4 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00108 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.621 | 4129.2 samples/s | 64.5 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00056 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.623 | 5648.5 samples/s | 88.3 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00037 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.624 | 1692.5 samples/s | 26.4 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.625 | 5196.6 samples/s | 81.2 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00023 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.625 | 1732.6 samples/s | 27.1 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.626 | 4785.0 samples/s | 74.8 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00016 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.626 | 1778.4 samples/s | 27.8 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.626 | 4571.3 samples/s | 71.4 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.627 | 1876.2 samples/s | 29.3 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.627 | 4218.7 samples/s | 65.9 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.627 | 1870.7 samples/s | 29.2 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.627 | 3944.6 samples/s | 61.6 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00009 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.627 | 1885.9 samples/s | 29.5 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.628 | 4179.3 samples/s | 65.3 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.628 | 1918.8 samples/s | 30.0 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00007 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.628 | 4096.9 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.8] | Loss=0.02402 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3870.9 samples/s | 60.5 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00158 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.617 | 3735.6 samples/s | 58.4 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00081 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.618 | 5765.1 samples/s | 90.1 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00055 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.620 | 1668.0 samples/s | 26.1 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00041 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.620 | 5221.3 samples/s | 81.6 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00033 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.621 | 1740.7 samples/s | 27.2 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.621 | 5038.8 samples/s | 78.7 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00024 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.622 | 1755.3 samples/s | 27.4 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00021 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.622 | 4705.8 samples/s | 73.5 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.622 | 1800.2 samples/s | 28.1 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.623 | 4390.7 samples/s | 68.6 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00015 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.623 | 1833.0 samples/s | 28.6 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.623 | 4120.9 samples/s | 64.4 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.623 | 1850.6 samples/s | 28.9 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.624 | 4109.4 samples/s | 64.2 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.624 | 1890.2 samples/s | 29.5 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.624 | 4172.8 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=256.3] | Loss=0.05844 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3529.1 samples/s | 55.1 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00316 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.620 | 3995.0 samples/s | 62.4 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00159 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.621 | 5487.9 samples/s | 85.7 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00106 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=3.621 | 1648.1 samples/s | 25.8 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00080 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=3.622 | 4902.9 samples/s | 76.6 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00064 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=3.622 | 1728.7 samples/s | 27.0 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00054 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.622 | 4552.8 samples/s | 71.1 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00046 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.623 | 1806.8 samples/s | 28.2 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00040 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.623 | 4245.4 samples/s | 66.3 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.623 | 1825.5 samples/s | 28.5 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00032 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.623 | 4182.8 samples/s | 65.4 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00030 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.623 | 1868.8 samples/s | 29.2 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00027 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.624 | 4198.9 samples/s | 65.6 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00025 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.624 | 1906.7 samples/s | 29.8 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00023 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.624 | 4022.5 samples/s | 62.9 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.624 | 1992.1 samples/s | 31.1 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.624 | 3605.0 samples/s | 56.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.3] | Loss=0.02007 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.239 | L2-Norm(final)=3.612 | 3869.8 samples/s | 60.5 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00134 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.619 | 3757.8 samples/s | 58.7 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00068 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.620 | 5796.1 samples/s | 90.6 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00045 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.621 | 1686.1 samples/s | 26.3 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00034 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.621 | 5298.0 samples/s | 82.8 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.621 | 1723.0 samples/s | 26.9 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00023 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.622 | 4971.0 samples/s | 77.7 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.622 | 1731.4 samples/s | 27.1 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=3.622 | 4616.4 samples/s | 72.1 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00016 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.622 | 1815.0 samples/s | 28.4 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.622 | 4397.6 samples/s | 68.7 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.623 | 1844.0 samples/s | 28.8 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.623 | 4154.2 samples/s | 64.9 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.623 | 1884.1 samples/s | 29.4 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.623 | 3963.0 samples/s | 61.9 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00010 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.623 | 1882.1 samples/s | 29.4 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.623 | 4031.3 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26668 | acc=0.8805 | tpr=0.8300 | fpr=0.0099 | 3772.8 samples/s | 14.7 steps/s
Avg test loss: 0.26588, Avg test acc: 0.88040, Avg tpr: 0.83144, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.37530 | acc=0.8997 | tpr=0.9513 | fpr=0.1012 | 3784.9 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.38143 | acc=0.9014 | tpr=0.9659 | fpr=0.0998 | 7150.6 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.38770 | acc=0.9001 | tpr=0.9683 | fpr=0.1012 | 7177.6 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.38746 | acc=0.8999 | tpr=0.9672 | fpr=0.1013 | 7396.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.38425 | acc=0.9006 | tpr=0.9668 | fpr=0.1006 | 6877.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.38612 | acc=0.9003 | tpr=0.9695 | fpr=0.1010 | 7190.6 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.38930 | acc=0.8997 | tpr=0.9687 | fpr=0.1015 | 7117.7 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.39094 | acc=0.8999 | tpr=0.9688 | fpr=0.1014 | 7363.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.39426 | acc=0.8999 | tpr=0.9703 | fpr=0.1014 | 6933.7 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.39414 | acc=0.8995 | tpr=0.9718 | fpr=0.1018 | 7264.5 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.39191 | acc=0.8999 | tpr=0.9713 | fpr=0.1014 | 13034.7 samples/s | 50.9 steps/s
Avg test loss: 0.39154, Avg test acc: 0.89987, Avg tpr: 0.97068, Avg fpr: 0.10141, total FA: 14081

server round 35/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.05084 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3952.6 samples/s | 61.8 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02141 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.241 | L2-Norm(final)=3.641 | 3875.3 samples/s | 60.6 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01677 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.248 | L2-Norm(final)=3.640 | 4258.8 samples/s | 66.5 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01367 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.252 | L2-Norm(final)=3.640 | 4354.9 samples/s | 68.0 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01159 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.641 | 5786.9 samples/s | 90.4 steps/s
[Step=28250 Epoch=137.8] | Loss=0.01011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.643 | 1753.5 samples/s | 27.4 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00923 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.644 | 4277.2 samples/s | 66.8 steps/s
[Step=28350 Epoch=138.2] | Loss=0.00857 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=3.646 | 4163.1 samples/s | 65.0 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00794 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.647 | 5403.7 samples/s | 84.4 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00733 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.649 | 1789.9 samples/s | 28.0 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00682 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.265 | L2-Norm(final)=3.651 | 4310.1 samples/s | 67.3 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00646 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.653 | 4264.8 samples/s | 66.6 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00625 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.655 | 5083.2 samples/s | 79.4 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00611 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.656 | 1853.9 samples/s | 29.0 steps/s
[Step=28700 Epoch=139.9] | Loss=0.00595 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.658 | 4189.6 samples/s | 65.5 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00572 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.659 | 4273.9 samples/s | 66.8 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00557 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.661 | 4627.3 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.6] | Loss=0.10576 | Reg=0.00149 | acc=0.9375 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3880.7 samples/s | 60.6 steps/s
[Step=28050 Epoch=136.9] | Loss=0.02268 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.243 | L2-Norm(final)=3.639 | 4168.3 samples/s | 65.1 steps/s
[Step=28100 Epoch=137.1] | Loss=0.01577 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.250 | L2-Norm(final)=3.638 | 4248.1 samples/s | 66.4 steps/s
[Step=28150 Epoch=137.4] | Loss=0.01293 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.639 | 4286.4 samples/s | 67.0 steps/s
[Step=28200 Epoch=137.6] | Loss=0.01093 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.641 | 5883.6 samples/s | 91.9 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00929 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.643 | 1764.3 samples/s | 27.6 steps/s
[Step=28300 Epoch=138.1] | Loss=0.00830 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.645 | 4248.0 samples/s | 66.4 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00775 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.264 | L2-Norm(final)=3.647 | 4225.8 samples/s | 66.0 steps/s
[Step=28400 Epoch=138.6] | Loss=0.00710 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.649 | 5406.7 samples/s | 84.5 steps/s
[Step=28450 Epoch=138.8] | Loss=0.00670 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.651 | 1757.4 samples/s | 27.5 steps/s
[Step=28500 Epoch=139.1] | Loss=0.00617 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.653 | 4250.4 samples/s | 66.4 steps/s
[Step=28550 Epoch=139.3] | Loss=0.00590 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.655 | 4315.3 samples/s | 67.4 steps/s
[Step=28600 Epoch=139.6] | Loss=0.00563 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.657 | 5188.6 samples/s | 81.1 steps/s
[Step=28650 Epoch=139.8] | Loss=0.00548 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.272 | L2-Norm(final)=3.659 | 1810.1 samples/s | 28.3 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00527 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.273 | L2-Norm(final)=3.661 | 4249.0 samples/s | 66.4 steps/s
[Step=28750 Epoch=140.3] | Loss=0.00504 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.663 | 4202.1 samples/s | 65.7 steps/s
[Step=28800 Epoch=140.5] | Loss=0.00494 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.665 | 4846.5 samples/s | 75.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step28800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.4] | Loss=0.18867 | Reg=0.00149 | acc=0.9219 | L2-Norm=12.220 | L2-Norm(final)=3.643 | 3900.9 samples/s | 61.0 steps/s
[Step=28050 Epoch=136.7] | Loss=0.02254 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.633 | 3845.8 samples/s | 60.1 steps/s
[Step=28100 Epoch=136.9] | Loss=0.01515 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.633 | 4157.0 samples/s | 65.0 steps/s
[Step=28150 Epoch=137.2] | Loss=0.01266 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.251 | L2-Norm(final)=3.635 | 4316.4 samples/s | 67.4 steps/s
[Step=28200 Epoch=137.4] | Loss=0.01141 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=3.637 | 5818.8 samples/s | 90.9 steps/s
[Step=28250 Epoch=137.6] | Loss=0.00984 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.258 | L2-Norm(final)=3.640 | 1755.3 samples/s | 27.4 steps/s
[Step=28300 Epoch=137.9] | Loss=0.00885 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.642 | 4238.3 samples/s | 66.2 steps/s
[Step=28350 Epoch=138.1] | Loss=0.00812 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.263 | L2-Norm(final)=3.645 | 4310.5 samples/s | 67.4 steps/s
[Step=28400 Epoch=138.4] | Loss=0.00751 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.648 | 5420.1 samples/s | 84.7 steps/s
[Step=28450 Epoch=138.6] | Loss=0.00714 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.650 | 1788.9 samples/s | 28.0 steps/s
[Step=28500 Epoch=138.9] | Loss=0.00671 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.652 | 4168.4 samples/s | 65.1 steps/s
[Step=28550 Epoch=139.1] | Loss=0.00642 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=3.655 | 4086.9 samples/s | 63.9 steps/s
[Step=28600 Epoch=139.4] | Loss=0.00621 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=3.657 | 4959.6 samples/s | 77.5 steps/s
[Step=28650 Epoch=139.6] | Loss=0.00586 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.659 | 1838.9 samples/s | 28.7 steps/s
[Step=28700 Epoch=139.8] | Loss=0.00572 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.662 | 4233.7 samples/s | 66.2 steps/s
[Step=28750 Epoch=140.1] | Loss=0.00555 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.664 | 4185.7 samples/s | 65.4 steps/s
[Step=28800 Epoch=140.3] | Loss=0.00540 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.666 | 4556.0 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step28800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.08340 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3719.0 samples/s | 58.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02195 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.248 | L2-Norm(final)=3.638 | 4069.1 samples/s | 63.6 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01524 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.639 | 4217.1 samples/s | 65.9 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01228 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.640 | 4235.9 samples/s | 66.2 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01072 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.642 | 5673.8 samples/s | 88.7 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00916 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.643 | 1728.0 samples/s | 27.0 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00814 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.646 | 4242.4 samples/s | 66.3 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00738 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=3.648 | 4176.0 samples/s | 65.3 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00712 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.271 | L2-Norm(final)=3.650 | 5356.1 samples/s | 83.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00665 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.652 | 1779.0 samples/s | 27.8 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00625 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.654 | 4193.7 samples/s | 65.5 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00598 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.656 | 4184.7 samples/s | 65.4 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00582 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.277 | L2-Norm(final)=3.657 | 4939.4 samples/s | 77.2 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00554 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=3.659 | 1818.1 samples/s | 28.4 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00539 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=3.661 | 4247.9 samples/s | 66.4 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00524 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.280 | L2-Norm(final)=3.663 | 4132.1 samples/s | 64.6 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00504 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=3.665 | 4635.7 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step28800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=137.3] | Loss=0.04459 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3982.2 samples/s | 62.2 steps/s
[Step=28050 Epoch=137.6] | Loss=0.02042 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.238 | L2-Norm(final)=3.642 | 4083.7 samples/s | 63.8 steps/s
[Step=28100 Epoch=137.8] | Loss=0.01401 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.245 | L2-Norm(final)=3.642 | 4222.1 samples/s | 66.0 steps/s
[Step=28150 Epoch=138.0] | Loss=0.01170 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.644 | 4341.0 samples/s | 67.8 steps/s
[Step=28200 Epoch=138.3] | Loss=0.01020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.646 | 5929.6 samples/s | 92.7 steps/s
[Step=28250 Epoch=138.5] | Loss=0.00892 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.648 | 1710.2 samples/s | 26.7 steps/s
[Step=28300 Epoch=138.8] | Loss=0.00786 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.651 | 4381.0 samples/s | 68.5 steps/s
[Step=28350 Epoch=139.0] | Loss=0.00714 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.653 | 4272.4 samples/s | 66.8 steps/s
[Step=28400 Epoch=139.3] | Loss=0.00664 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.656 | 5507.4 samples/s | 86.1 steps/s
[Step=28450 Epoch=139.5] | Loss=0.00618 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.658 | 1755.4 samples/s | 27.4 steps/s
[Step=28500 Epoch=139.8] | Loss=0.00581 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.660 | 4342.7 samples/s | 67.9 steps/s
[Step=28550 Epoch=140.0] | Loss=0.00553 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.663 | 4275.9 samples/s | 66.8 steps/s
[Step=28600 Epoch=140.2] | Loss=0.00531 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.665 | 5390.8 samples/s | 84.2 steps/s
[Step=28650 Epoch=140.5] | Loss=0.00504 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.667 | 1796.2 samples/s | 28.1 steps/s
[Step=28700 Epoch=140.7] | Loss=0.00485 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.669 | 4312.3 samples/s | 67.4 steps/s
[Step=28750 Epoch=141.0] | Loss=0.00477 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.671 | 4155.8 samples/s | 64.9 steps/s
[Step=28800 Epoch=141.2] | Loss=0.00465 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.673 | 4955.4 samples/s | 77.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step28800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=265.3] | Loss=0.00921 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3657.3 samples/s | 57.1 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00144 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.652 | 3812.8 samples/s | 59.6 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.655 | 5607.8 samples/s | 87.6 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00052 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.656 | 1701.1 samples/s | 26.6 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00039 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.657 | 5141.9 samples/s | 80.3 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00031 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.658 | 1727.6 samples/s | 27.0 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.658 | 4722.6 samples/s | 73.8 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.659 | 1736.0 samples/s | 27.1 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.659 | 4364.6 samples/s | 68.2 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.659 | 1810.7 samples/s | 28.3 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00016 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.660 | 4056.0 samples/s | 63.4 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.660 | 1864.5 samples/s | 29.1 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.660 | 4167.0 samples/s | 65.1 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.660 | 1871.5 samples/s | 29.2 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.661 | 4119.5 samples/s | 64.4 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.661 | 1890.0 samples/s | 29.5 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.661 | 4033.6 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step28800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.09549 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3362.5 samples/s | 52.5 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00304 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.648 | 4078.8 samples/s | 63.7 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00153 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.648 | 5747.5 samples/s | 89.8 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00103 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.649 | 1695.4 samples/s | 26.5 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.649 | 5132.2 samples/s | 80.2 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00062 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.649 | 1723.4 samples/s | 26.9 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00052 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.650 | 4643.7 samples/s | 72.6 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00044 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.650 | 1725.9 samples/s | 27.0 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00039 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.650 | 4283.9 samples/s | 66.9 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00035 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.650 | 1808.1 samples/s | 28.3 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00031 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.650 | 4106.7 samples/s | 64.2 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.651 | 1853.1 samples/s | 29.0 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.651 | 4016.1 samples/s | 62.8 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.651 | 1849.2 samples/s | 28.9 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.651 | 4052.9 samples/s | 63.3 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00021 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.651 | 1880.3 samples/s | 29.4 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.651 | 4138.6 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step28800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=267.4] | Loss=0.02422 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3778.3 samples/s | 59.0 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00147 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.649 | 3738.2 samples/s | 58.4 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00075 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.650 | 5621.3 samples/s | 87.8 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00050 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.651 | 1682.4 samples/s | 26.3 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00038 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.652 | 5323.7 samples/s | 83.2 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00030 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.652 | 1665.2 samples/s | 26.0 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00025 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.652 | 4904.0 samples/s | 76.6 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.653 | 1746.3 samples/s | 27.3 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.653 | 4624.8 samples/s | 72.3 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00017 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.653 | 1808.2 samples/s | 28.3 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.654 | 4255.8 samples/s | 66.5 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00014 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.654 | 1818.6 samples/s | 28.4 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.654 | 4099.1 samples/s | 64.0 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.655 | 1887.9 samples/s | 29.5 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.655 | 3992.4 samples/s | 62.4 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.655 | 1864.9 samples/s | 29.1 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.655 | 4083.8 samples/s | 63.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step28800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=263.8] | Loss=0.03809 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3761.7 samples/s | 58.8 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00135 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.650 | 3783.0 samples/s | 59.1 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00068 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.652 | 5617.5 samples/s | 87.8 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00046 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.653 | 1676.2 samples/s | 26.2 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00035 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.653 | 5112.9 samples/s | 79.9 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.654 | 1732.7 samples/s | 27.1 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00024 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.654 | 4526.2 samples/s | 70.7 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.654 | 1805.8 samples/s | 28.2 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.655 | 4313.2 samples/s | 67.4 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00016 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.655 | 1836.2 samples/s | 28.7 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.655 | 4048.2 samples/s | 63.3 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.655 | 1875.0 samples/s | 29.3 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.656 | 4114.8 samples/s | 64.3 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.656 | 1885.9 samples/s | 29.5 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.656 | 4112.6 samples/s | 64.3 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.656 | 2050.9 samples/s | 32.0 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.656 | 3406.2 samples/s | 53.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step28800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.9] | Loss=0.02830 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.220 | L2-Norm(final)=3.644 | 3860.1 samples/s | 60.3 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00361 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.645 | 3594.8 samples/s | 56.2 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00190 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.646 | 5664.5 samples/s | 88.5 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00128 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.647 | 1676.8 samples/s | 26.2 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00096 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.648 | 5277.7 samples/s | 82.5 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.648 | 1703.2 samples/s | 26.6 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00065 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.649 | 4774.3 samples/s | 74.6 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00056 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.649 | 1751.8 samples/s | 27.4 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00049 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.649 | 4499.9 samples/s | 70.3 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00043 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.650 | 1789.5 samples/s | 28.0 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00039 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.650 | 4293.4 samples/s | 67.1 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00036 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.650 | 1823.0 samples/s | 28.5 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00033 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.650 | 4182.6 samples/s | 65.4 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00030 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.650 | 1840.8 samples/s | 28.8 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.651 | 4132.1 samples/s | 64.6 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.651 | 1876.5 samples/s | 29.3 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00025 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.651 | 4221.5 samples/s | 66.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29407 | acc=0.8699 | tpr=0.8142 | fpr=0.0092 | 3864.3 samples/s | 15.1 steps/s
Avg test loss: 0.29286, Avg test acc: 0.86938, Avg tpr: 0.81483, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.35629 | acc=0.9076 | tpr=0.9513 | fpr=0.0932 | 3819.1 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.36259 | acc=0.9089 | tpr=0.9659 | fpr=0.0922 | 7062.0 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.36872 | acc=0.9078 | tpr=0.9683 | fpr=0.0934 | 7217.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.36886 | acc=0.9077 | tpr=0.9672 | fpr=0.0934 | 7079.1 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.36600 | acc=0.9081 | tpr=0.9668 | fpr=0.0929 | 7336.8 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.36773 | acc=0.9080 | tpr=0.9687 | fpr=0.0931 | 7188.9 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.37098 | acc=0.9074 | tpr=0.9674 | fpr=0.0937 | 6987.9 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.37273 | acc=0.9074 | tpr=0.9677 | fpr=0.0937 | 7323.0 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.37623 | acc=0.9074 | tpr=0.9693 | fpr=0.0938 | 7044.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.37601 | acc=0.9070 | tpr=0.9709 | fpr=0.0942 | 6926.0 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.37386 | acc=0.9073 | tpr=0.9698 | fpr=0.0939 | 13354.3 samples/s | 52.2 steps/s
Avg test loss: 0.37353, Avg test acc: 0.90729, Avg tpr: 0.96910, Avg fpr: 0.09384, total FA: 13029

server round 36/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.25057 | Reg=0.00149 | acc=0.8906 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 3957.2 samples/s | 61.8 steps/s
[Step=28850 Epoch=140.7] | Loss=0.02977 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.237 | L2-Norm(final)=3.664 | 3964.0 samples/s | 61.9 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01835 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.244 | L2-Norm(final)=3.661 | 4421.4 samples/s | 69.1 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01493 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.248 | L2-Norm(final)=3.661 | 4431.9 samples/s | 69.2 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01301 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.662 | 5887.5 samples/s | 92.0 steps/s
[Step=29050 Epoch=141.7] | Loss=0.01115 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.664 | 1747.3 samples/s | 27.3 steps/s
[Step=29100 Epoch=141.9] | Loss=0.01016 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.666 | 4204.1 samples/s | 65.7 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00911 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.668 | 4240.0 samples/s | 66.2 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00844 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.258 | L2-Norm(final)=3.670 | 5222.4 samples/s | 81.6 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00780 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.672 | 1767.3 samples/s | 27.6 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00731 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=3.674 | 4127.6 samples/s | 64.5 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00688 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.676 | 4238.4 samples/s | 66.2 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00657 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.678 | 5021.6 samples/s | 78.5 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00636 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.680 | 1842.6 samples/s | 28.8 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00617 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.682 | 4231.5 samples/s | 66.1 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00601 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.684 | 4141.4 samples/s | 64.7 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00583 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.686 | 4595.3 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.5] | Loss=0.11638 | Reg=0.00149 | acc=0.9062 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 3702.8 samples/s | 57.9 steps/s
[Step=28850 Epoch=140.8] | Loss=0.02645 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.665 | 4007.0 samples/s | 62.6 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01732 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.664 | 4343.6 samples/s | 67.9 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01342 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.665 | 4218.7 samples/s | 65.9 steps/s
[Step=29000 Epoch=141.5] | Loss=0.01180 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.249 | L2-Norm(final)=3.668 | 5815.6 samples/s | 90.9 steps/s
[Step=29050 Epoch=141.8] | Loss=0.01002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.670 | 1732.1 samples/s | 27.1 steps/s
[Step=29100 Epoch=142.0] | Loss=0.00914 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.672 | 4251.1 samples/s | 66.4 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00819 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.674 | 4211.5 samples/s | 65.8 steps/s
[Step=29200 Epoch=142.5] | Loss=0.00762 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.677 | 5358.5 samples/s | 83.7 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00709 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.679 | 1790.0 samples/s | 28.0 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00670 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.681 | 4388.6 samples/s | 68.6 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00637 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.683 | 4241.9 samples/s | 66.3 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00601 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.685 | 5113.4 samples/s | 79.9 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00573 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.687 | 1818.6 samples/s | 28.4 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00549 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.690 | 4249.4 samples/s | 66.4 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00527 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.265 | L2-Norm(final)=3.692 | 4225.9 samples/s | 66.0 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00518 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.694 | 4784.1 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step29600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.3] | Loss=0.22758 | Reg=0.00149 | acc=0.8906 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 4089.5 samples/s | 63.9 steps/s
[Step=28850 Epoch=140.6] | Loss=0.02325 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.668 | 3787.9 samples/s | 59.2 steps/s
[Step=28900 Epoch=140.8] | Loss=0.01585 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.243 | L2-Norm(final)=3.668 | 4376.4 samples/s | 68.4 steps/s
[Step=28950 Epoch=141.1] | Loss=0.01325 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.669 | 4327.1 samples/s | 67.6 steps/s
[Step=29000 Epoch=141.3] | Loss=0.01150 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.671 | 5834.7 samples/s | 91.2 steps/s
[Step=29050 Epoch=141.5] | Loss=0.00982 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.673 | 1726.6 samples/s | 27.0 steps/s
[Step=29100 Epoch=141.8] | Loss=0.00892 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=3.676 | 4270.5 samples/s | 66.7 steps/s
[Step=29150 Epoch=142.0] | Loss=0.00824 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.678 | 4298.6 samples/s | 67.2 steps/s
[Step=29200 Epoch=142.3] | Loss=0.00792 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.680 | 5267.5 samples/s | 82.3 steps/s
[Step=29250 Epoch=142.5] | Loss=0.00733 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=3.681 | 1780.4 samples/s | 27.8 steps/s
[Step=29300 Epoch=142.8] | Loss=0.00688 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.683 | 4313.5 samples/s | 67.4 steps/s
[Step=29350 Epoch=143.0] | Loss=0.00651 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.685 | 4319.9 samples/s | 67.5 steps/s
[Step=29400 Epoch=143.3] | Loss=0.00624 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.687 | 5012.5 samples/s | 78.3 steps/s
[Step=29450 Epoch=143.5] | Loss=0.00602 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.689 | 1824.7 samples/s | 28.5 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00583 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.691 | 4285.7 samples/s | 67.0 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00572 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=3.693 | 4286.9 samples/s | 67.0 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00553 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=3.695 | 4692.4 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step29600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.20535 | Reg=0.00149 | acc=0.8906 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 3851.4 samples/s | 60.2 steps/s
[Step=28850 Epoch=140.7] | Loss=0.02447 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.240 | L2-Norm(final)=3.668 | 4027.4 samples/s | 62.9 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01566 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.250 | L2-Norm(final)=3.668 | 4254.8 samples/s | 66.5 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01285 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.669 | 4270.9 samples/s | 66.7 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01068 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.671 | 5830.8 samples/s | 91.1 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00919 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.674 | 1745.6 samples/s | 27.3 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00823 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=3.677 | 4181.3 samples/s | 65.3 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00750 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=3.680 | 4063.5 samples/s | 63.5 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00704 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.266 | L2-Norm(final)=3.682 | 5268.1 samples/s | 82.3 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00643 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=3.684 | 1805.1 samples/s | 28.2 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00612 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.270 | L2-Norm(final)=3.687 | 4384.4 samples/s | 68.5 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00578 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.271 | L2-Norm(final)=3.689 | 4276.6 samples/s | 66.8 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00558 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=3.691 | 5058.8 samples/s | 79.0 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00537 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=3.693 | 1826.4 samples/s | 28.5 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00521 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=3.695 | 4268.9 samples/s | 66.7 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00503 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.697 | 4293.8 samples/s | 67.1 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00490 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=3.699 | 4578.4 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step29600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=141.2] | Loss=0.17035 | Reg=0.00149 | acc=0.8750 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 3896.9 samples/s | 60.9 steps/s
[Step=28850 Epoch=141.5] | Loss=0.02725 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.665 | 3892.9 samples/s | 60.8 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01668 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.663 | 4237.8 samples/s | 66.2 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01255 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.664 | 4221.9 samples/s | 66.0 steps/s
[Step=29000 Epoch=142.2] | Loss=0.01134 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.666 | 5822.0 samples/s | 91.0 steps/s
[Step=29050 Epoch=142.5] | Loss=0.00956 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.669 | 1724.3 samples/s | 26.9 steps/s
[Step=29100 Epoch=142.7] | Loss=0.00867 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.671 | 4345.5 samples/s | 67.9 steps/s
[Step=29150 Epoch=142.9] | Loss=0.00787 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.673 | 4339.9 samples/s | 67.8 steps/s
[Step=29200 Epoch=143.2] | Loss=0.00751 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=3.676 | 5532.5 samples/s | 86.4 steps/s
[Step=29250 Epoch=143.4] | Loss=0.00695 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.677 | 1729.8 samples/s | 27.0 steps/s
[Step=29300 Epoch=143.7] | Loss=0.00658 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.679 | 4196.4 samples/s | 65.6 steps/s
[Step=29350 Epoch=143.9] | Loss=0.00620 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.681 | 4217.2 samples/s | 65.9 steps/s
[Step=29400 Epoch=144.2] | Loss=0.00592 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.259 | L2-Norm(final)=3.683 | 5201.2 samples/s | 81.3 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00565 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=3.685 | 1773.8 samples/s | 27.7 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00538 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=3.687 | 4281.4 samples/s | 66.9 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00517 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.689 | 4372.1 samples/s | 68.3 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00508 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=3.691 | 5111.2 samples/s | 79.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step29600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=272.9] | Loss=0.02542 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.208 | L2-Norm(final)=3.676 | 4038.7 samples/s | 63.1 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00231 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.682 | 3647.5 samples/s | 57.0 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00116 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=3.683 | 5607.0 samples/s | 87.6 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00078 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.684 | 1672.5 samples/s | 26.1 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00059 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.684 | 5185.2 samples/s | 81.0 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00047 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.684 | 1727.1 samples/s | 27.0 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00039 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.685 | 4806.2 samples/s | 75.1 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00034 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.685 | 1759.6 samples/s | 27.5 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00030 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.685 | 4433.0 samples/s | 69.3 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.685 | 1812.3 samples/s | 28.3 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00024 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.686 | 4184.5 samples/s | 65.4 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.686 | 1859.6 samples/s | 29.1 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.686 | 4150.0 samples/s | 64.8 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.686 | 1847.6 samples/s | 28.9 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.686 | 4174.8 samples/s | 65.2 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.687 | 1875.5 samples/s | 29.3 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.687 | 3922.9 samples/s | 61.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step29600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.0] | Loss=0.05252 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.208 | L2-Norm(final)=3.675 | 4094.4 samples/s | 64.0 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00276 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.682 | 3596.4 samples/s | 56.2 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00139 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.683 | 5626.3 samples/s | 87.9 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00094 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.684 | 1691.3 samples/s | 26.4 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00071 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.684 | 5146.5 samples/s | 80.4 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00057 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.685 | 1725.8 samples/s | 27.0 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00047 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.685 | 4905.0 samples/s | 76.6 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00041 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.685 | 1751.5 samples/s | 27.4 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00036 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.686 | 4293.2 samples/s | 67.1 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00032 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.686 | 1809.3 samples/s | 28.3 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00028 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.686 | 4128.3 samples/s | 64.5 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.686 | 1849.2 samples/s | 28.9 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.686 | 4152.2 samples/s | 64.9 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.686 | 1890.8 samples/s | 29.5 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.686 | 4070.5 samples/s | 63.6 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.687 | 1910.5 samples/s | 29.9 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.687 | 4102.8 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step29600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=275.0] | Loss=0.00567 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.676 | 3852.3 samples/s | 60.2 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00259 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.683 | 3816.2 samples/s | 59.6 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00131 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.684 | 5475.5 samples/s | 85.6 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00087 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.684 | 1663.5 samples/s | 26.0 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00066 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.685 | 5217.9 samples/s | 81.5 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00053 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.685 | 1667.2 samples/s | 26.0 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00044 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.685 | 4774.1 samples/s | 74.6 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00038 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.686 | 1744.5 samples/s | 27.3 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00033 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.686 | 4669.9 samples/s | 73.0 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00029 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.686 | 1789.8 samples/s | 28.0 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00027 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.686 | 4393.4 samples/s | 68.6 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00024 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.686 | 1833.7 samples/s | 28.7 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00022 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.687 | 4178.1 samples/s | 65.3 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00021 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.687 | 1874.2 samples/s | 29.3 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.687 | 4012.8 samples/s | 62.7 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.687 | 1870.2 samples/s | 29.2 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.687 | 4052.8 samples/s | 63.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step29600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=271.4] | Loss=0.00096 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.676 | 3626.4 samples/s | 56.7 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00153 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.684 | 3996.2 samples/s | 62.4 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.686 | 5558.0 samples/s | 86.8 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00052 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.687 | 1668.6 samples/s | 26.1 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00039 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.688 | 5070.8 samples/s | 79.2 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00032 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.688 | 1757.8 samples/s | 27.5 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.688 | 4579.1 samples/s | 71.5 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00023 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.689 | 1786.4 samples/s | 27.9 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00020 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.689 | 4249.2 samples/s | 66.4 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00018 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.689 | 1842.0 samples/s | 28.8 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.689 | 4024.4 samples/s | 62.9 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.689 | 1894.0 samples/s | 29.6 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.690 | 4174.4 samples/s | 65.2 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.690 | 1901.6 samples/s | 29.7 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.690 | 3933.4 samples/s | 61.5 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.690 | 2004.6 samples/s | 31.3 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.690 | 3605.7 samples/s | 56.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step29600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.5] | Loss=0.02989 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.208 | L2-Norm(final)=3.676 | 3635.1 samples/s | 56.8 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00113 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.681 | 3974.7 samples/s | 62.1 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00058 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.683 | 5576.7 samples/s | 87.1 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.683 | 1676.0 samples/s | 26.2 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00029 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.684 | 5288.0 samples/s | 82.6 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.684 | 1695.5 samples/s | 26.5 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.684 | 4826.1 samples/s | 75.4 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.685 | 1740.5 samples/s | 27.2 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.685 | 4594.7 samples/s | 71.8 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.685 | 1758.0 samples/s | 27.5 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.685 | 4273.1 samples/s | 66.8 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.686 | 1828.2 samples/s | 28.6 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.686 | 4045.6 samples/s | 63.2 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.686 | 1867.3 samples/s | 29.2 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.686 | 4034.8 samples/s | 63.0 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00008 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.687 | 1850.7 samples/s | 28.9 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00008 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.687 | 4032.0 samples/s | 63.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28829 | acc=0.8691 | tpr=0.8133 | fpr=0.0097 | 3072.3 samples/s | 12.0 steps/s
Avg test loss: 0.28719, Avg test acc: 0.86946, Avg tpr: 0.81512, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.34685 | acc=0.9112 | tpr=0.9513 | fpr=0.0895 | 3069.3 samples/s | 12.0 steps/s
[Step= 100] | Loss=0.35302 | acc=0.9128 | tpr=0.9659 | fpr=0.0882 | 7159.5 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.35889 | acc=0.9116 | tpr=0.9669 | fpr=0.0894 | 7054.2 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.35918 | acc=0.9115 | tpr=0.9661 | fpr=0.0895 | 7174.9 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.35620 | acc=0.9119 | tpr=0.9651 | fpr=0.0891 | 6222.0 samples/s | 24.3 steps/s
[Step= 300] | Loss=0.35832 | acc=0.9117 | tpr=0.9673 | fpr=0.0893 | 7038.2 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.36145 | acc=0.9111 | tpr=0.9662 | fpr=0.0899 | 7272.3 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.36315 | acc=0.9111 | tpr=0.9666 | fpr=0.0899 | 6848.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.36649 | acc=0.9112 | tpr=0.9684 | fpr=0.0899 | 7046.6 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.36629 | acc=0.9109 | tpr=0.9696 | fpr=0.0901 | 7187.3 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.36427 | acc=0.9113 | tpr=0.9686 | fpr=0.0897 | 13172.6 samples/s | 51.5 steps/s
Avg test loss: 0.36390, Avg test acc: 0.91134, Avg tpr: 0.96791, Avg fpr: 0.08969, total FA: 12453

server round 37/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.3] | Loss=0.08488 | Reg=0.00149 | acc=0.9375 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3886.8 samples/s | 60.7 steps/s
[Step=29650 Epoch=144.6] | Loss=0.01905 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.700 | 4032.7 samples/s | 63.0 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01365 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.701 | 4255.5 samples/s | 66.5 steps/s
[Step=29750 Epoch=145.1] | Loss=0.01209 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=3.702 | 4107.6 samples/s | 64.2 steps/s
[Step=29800 Epoch=145.3] | Loss=0.01083 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.703 | 5803.7 samples/s | 90.7 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00948 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.705 | 1749.7 samples/s | 27.3 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00866 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.707 | 4158.2 samples/s | 65.0 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00798 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.708 | 4156.0 samples/s | 64.9 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00749 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.710 | 5253.0 samples/s | 82.1 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00698 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.712 | 1773.1 samples/s | 27.7 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00659 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.714 | 4232.0 samples/s | 66.1 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00640 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.716 | 4348.2 samples/s | 67.9 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00614 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.718 | 4968.4 samples/s | 77.6 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00597 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.719 | 1839.1 samples/s | 28.7 steps/s
[Step=30300 Epoch=147.7] | Loss=0.00570 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.721 | 4337.2 samples/s | 67.8 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00557 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.723 | 4316.4 samples/s | 67.4 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00540 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.724 | 4619.5 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.05821 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3977.7 samples/s | 62.2 steps/s
[Step=29650 Epoch=144.7] | Loss=0.02512 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.226 | L2-Norm(final)=3.697 | 4181.0 samples/s | 65.3 steps/s
[Step=29700 Epoch=144.9] | Loss=0.01714 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.697 | 4227.7 samples/s | 66.1 steps/s
[Step=29750 Epoch=145.2] | Loss=0.01306 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.698 | 4317.0 samples/s | 67.5 steps/s
[Step=29800 Epoch=145.4] | Loss=0.01136 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.700 | 5934.9 samples/s | 92.7 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00977 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.702 | 1735.2 samples/s | 27.1 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00895 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.246 | L2-Norm(final)=3.704 | 4285.9 samples/s | 67.0 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00809 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.706 | 4345.5 samples/s | 67.9 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00739 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=3.708 | 5482.8 samples/s | 85.7 steps/s
[Step=30050 Epoch=146.6] | Loss=0.00671 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.711 | 1793.8 samples/s | 28.0 steps/s
[Step=30100 Epoch=146.9] | Loss=0.00630 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.252 | L2-Norm(final)=3.713 | 4279.1 samples/s | 66.9 steps/s
[Step=30150 Epoch=147.1] | Loss=0.00600 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.715 | 4342.9 samples/s | 67.9 steps/s
[Step=30200 Epoch=147.4] | Loss=0.00586 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=3.717 | 5184.4 samples/s | 81.0 steps/s
[Step=30250 Epoch=147.6] | Loss=0.00554 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.719 | 1793.1 samples/s | 28.0 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00530 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.721 | 4233.6 samples/s | 66.2 steps/s
[Step=30350 Epoch=148.1] | Loss=0.00513 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.723 | 4250.8 samples/s | 66.4 steps/s
[Step=30400 Epoch=148.3] | Loss=0.00497 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=3.725 | 4889.0 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step30400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.2] | Loss=0.15024 | Reg=0.00149 | acc=0.9375 | L2-Norm=12.196 | L2-Norm(final)=3.704 | 3927.1 samples/s | 61.4 steps/s
[Step=29650 Epoch=144.5] | Loss=0.02376 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.219 | L2-Norm(final)=3.695 | 4220.5 samples/s | 65.9 steps/s
[Step=29700 Epoch=144.7] | Loss=0.01572 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.694 | 4224.6 samples/s | 66.0 steps/s
[Step=29750 Epoch=145.0] | Loss=0.01254 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.232 | L2-Norm(final)=3.696 | 4335.1 samples/s | 67.7 steps/s
[Step=29800 Epoch=145.2] | Loss=0.01114 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.698 | 5867.7 samples/s | 91.7 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00951 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.237 | L2-Norm(final)=3.701 | 1727.6 samples/s | 27.0 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00839 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.704 | 4277.9 samples/s | 66.8 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00786 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.706 | 4176.7 samples/s | 65.3 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00765 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.708 | 5285.7 samples/s | 82.6 steps/s
[Step=30050 Epoch=146.4] | Loss=0.00705 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.710 | 1769.8 samples/s | 27.7 steps/s
[Step=30100 Epoch=146.7] | Loss=0.00665 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.712 | 4312.9 samples/s | 67.4 steps/s
[Step=30150 Epoch=146.9] | Loss=0.00622 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.714 | 4309.0 samples/s | 67.3 steps/s
[Step=30200 Epoch=147.1] | Loss=0.00612 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.248 | L2-Norm(final)=3.716 | 5004.0 samples/s | 78.2 steps/s
[Step=30250 Epoch=147.4] | Loss=0.00580 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.249 | L2-Norm(final)=3.718 | 1824.6 samples/s | 28.5 steps/s
[Step=30300 Epoch=147.6] | Loss=0.00558 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=3.720 | 4397.8 samples/s | 68.7 steps/s
[Step=30350 Epoch=147.9] | Loss=0.00543 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.722 | 4406.9 samples/s | 68.9 steps/s
[Step=30400 Epoch=148.1] | Loss=0.00533 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.724 | 4645.0 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step30400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.19824 | Reg=0.00149 | acc=0.8750 | L2-Norm=12.196 | L2-Norm(final)=3.704 | 3891.2 samples/s | 60.8 steps/s
[Step=29650 Epoch=144.6] | Loss=0.02275 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.698 | 4074.6 samples/s | 63.7 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01488 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.699 | 4224.5 samples/s | 66.0 steps/s
[Step=29750 Epoch=145.1] | Loss=0.01195 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.701 | 4292.7 samples/s | 67.1 steps/s
[Step=29800 Epoch=145.3] | Loss=0.01080 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.240 | L2-Norm(final)=3.703 | 5862.1 samples/s | 91.6 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00926 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.705 | 1734.4 samples/s | 27.1 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00826 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.245 | L2-Norm(final)=3.707 | 4244.2 samples/s | 66.3 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00763 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.247 | L2-Norm(final)=3.710 | 4272.4 samples/s | 66.8 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00725 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=3.712 | 5338.7 samples/s | 83.4 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00683 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=3.713 | 1231.8 samples/s | 19.2 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00635 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=3.715 | 3983.4 samples/s | 62.2 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00597 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=3.717 | 4159.8 samples/s | 65.0 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00571 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=3.719 | 4984.2 samples/s | 77.9 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00552 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=3.721 | 1827.7 samples/s | 28.6 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00526 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=3.722 | 4339.6 samples/s | 67.8 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00511 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=3.724 | 4286.3 samples/s | 67.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00500 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.258 | L2-Norm(final)=3.726 | 4729.1 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step30400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=145.2] | Loss=0.15200 | Reg=0.00149 | acc=0.8906 | L2-Norm=12.196 | L2-Norm(final)=3.704 | 4038.8 samples/s | 63.1 steps/s
[Step=29650 Epoch=145.4] | Loss=0.02127 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.699 | 3867.0 samples/s | 60.4 steps/s
[Step=29700 Epoch=145.6] | Loss=0.01493 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.699 | 4399.6 samples/s | 68.7 steps/s
[Step=29750 Epoch=145.9] | Loss=0.01203 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.232 | L2-Norm(final)=3.700 | 4313.2 samples/s | 67.4 steps/s
[Step=29800 Epoch=146.1] | Loss=0.01126 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.234 | L2-Norm(final)=3.700 | 5952.4 samples/s | 93.0 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00951 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.701 | 1765.0 samples/s | 27.6 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00857 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.703 | 4219.8 samples/s | 65.9 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00782 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.704 | 4279.5 samples/s | 66.9 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00733 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.706 | 5612.7 samples/s | 87.7 steps/s
[Step=30050 Epoch=147.4] | Loss=0.00695 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.708 | 1766.7 samples/s | 27.6 steps/s
[Step=30100 Epoch=147.6] | Loss=0.00647 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.710 | 4324.2 samples/s | 67.6 steps/s
[Step=30150 Epoch=147.9] | Loss=0.00613 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.711 | 4224.6 samples/s | 66.0 steps/s
[Step=30200 Epoch=148.1] | Loss=0.00580 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=3.713 | 5428.6 samples/s | 84.8 steps/s
[Step=30250 Epoch=148.3] | Loss=0.00546 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=3.715 | 1800.2 samples/s | 28.1 steps/s
[Step=30300 Epoch=148.6] | Loss=0.00522 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=3.717 | 4273.4 samples/s | 66.8 steps/s
[Step=30350 Epoch=148.8] | Loss=0.00503 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=3.719 | 4172.5 samples/s | 65.2 steps/s
[Step=30400 Epoch=149.1] | Loss=0.00486 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=3.721 | 5119.7 samples/s | 80.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step30400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=280.5] | Loss=0.00323 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3860.6 samples/s | 60.3 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00168 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.710 | 3661.1 samples/s | 57.2 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00090 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.711 | 5510.6 samples/s | 86.1 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00060 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.713 | 1708.1 samples/s | 26.7 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00046 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.714 | 5305.6 samples/s | 82.9 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00037 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.715 | 1728.8 samples/s | 27.0 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00031 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.716 | 4773.8 samples/s | 74.6 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.716 | 1766.9 samples/s | 27.6 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.717 | 4461.4 samples/s | 69.7 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00021 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.717 | 1789.9 samples/s | 28.0 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.717 | 4174.5 samples/s | 65.2 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=3.718 | 1884.1 samples/s | 29.4 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=3.718 | 4191.2 samples/s | 65.5 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00014 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.718 | 1885.7 samples/s | 29.5 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.718 | 3995.8 samples/s | 62.4 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.719 | 1879.2 samples/s | 29.4 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.719 | 4106.3 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step30400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=281.6] | Loss=0.02598 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3846.1 samples/s | 60.1 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00153 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.713 | 3686.8 samples/s | 57.6 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00078 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.713 | 5610.7 samples/s | 87.7 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00052 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.714 | 1672.0 samples/s | 26.1 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.714 | 5107.9 samples/s | 79.8 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.714 | 1708.5 samples/s | 26.7 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.715 | 4753.5 samples/s | 74.3 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.715 | 1739.7 samples/s | 27.2 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.715 | 4354.6 samples/s | 68.0 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.715 | 1780.2 samples/s | 27.8 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.715 | 4104.0 samples/s | 64.1 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.716 | 1847.7 samples/s | 28.9 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.716 | 3947.7 samples/s | 61.7 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.716 | 1888.3 samples/s | 29.5 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.716 | 4120.9 samples/s | 64.4 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.716 | 1899.4 samples/s | 29.7 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.717 | 4140.8 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step30400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.7] | Loss=0.05800 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 4018.4 samples/s | 62.8 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00150 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.713 | 3538.4 samples/s | 55.3 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00076 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.715 | 5622.0 samples/s | 87.8 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00051 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.715 | 1651.8 samples/s | 25.8 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00038 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.716 | 5271.9 samples/s | 82.4 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00031 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.716 | 1709.7 samples/s | 26.7 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.716 | 4983.8 samples/s | 77.9 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.716 | 1747.5 samples/s | 27.3 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.717 | 4577.2 samples/s | 71.5 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.717 | 1782.4 samples/s | 27.8 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.717 | 4389.2 samples/s | 68.6 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00014 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.717 | 1839.1 samples/s | 28.7 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.717 | 4127.6 samples/s | 64.5 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.718 | 1858.3 samples/s | 29.0 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=3.718 | 4203.5 samples/s | 65.7 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=3.718 | 1874.9 samples/s | 29.3 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00010 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=3.718 | 4091.3 samples/s | 63.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step30400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=278.9] | Loss=0.00207 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3976.8 samples/s | 62.1 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00279 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.708 | 3575.9 samples/s | 55.9 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00141 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.709 | 5546.5 samples/s | 86.7 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00094 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.709 | 1659.3 samples/s | 25.9 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00071 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.710 | 5102.4 samples/s | 79.7 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00057 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.710 | 1724.0 samples/s | 26.9 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00048 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.710 | 4591.9 samples/s | 71.7 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00041 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.711 | 1807.3 samples/s | 28.2 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00036 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.711 | 4150.8 samples/s | 64.9 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.711 | 1865.6 samples/s | 29.2 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00029 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.711 | 3996.7 samples/s | 62.4 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.712 | 1876.7 samples/s | 29.3 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.712 | 4050.0 samples/s | 63.3 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.712 | 1890.4 samples/s | 29.5 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00021 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.712 | 4085.7 samples/s | 63.8 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.713 | 1941.5 samples/s | 30.3 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.713 | 3803.7 samples/s | 59.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step30400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.1] | Loss=0.01143 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.196 | L2-Norm(final)=3.705 | 3654.2 samples/s | 57.1 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00129 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.711 | 3968.4 samples/s | 62.0 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00066 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.713 | 5674.0 samples/s | 88.7 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00044 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.714 | 1690.0 samples/s | 26.4 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00033 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.714 | 5349.6 samples/s | 83.6 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00027 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.715 | 1706.3 samples/s | 26.7 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.715 | 4907.7 samples/s | 76.7 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.715 | 1745.7 samples/s | 27.3 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.716 | 4561.8 samples/s | 71.3 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.716 | 1782.0 samples/s | 27.8 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00014 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.716 | 4390.8 samples/s | 68.6 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.716 | 1848.8 samples/s | 28.9 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.716 | 4159.4 samples/s | 65.0 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.717 | 1882.2 samples/s | 29.4 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.717 | 3981.8 samples/s | 62.2 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.717 | 1864.0 samples/s | 29.1 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=3.717 | 3888.2 samples/s | 60.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26339 | acc=0.8816 | tpr=0.8320 | fpr=0.0107 | 3765.7 samples/s | 14.7 steps/s
Avg test loss: 0.26292, Avg test acc: 0.88156, Avg tpr: 0.83307, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.38035 | acc=0.9019 | tpr=0.9469 | fpr=0.0989 | 3766.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.38709 | acc=0.9031 | tpr=0.9638 | fpr=0.0980 | 7165.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.39255 | acc=0.9021 | tpr=0.9654 | fpr=0.0991 | 7118.0 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.39301 | acc=0.9018 | tpr=0.9650 | fpr=0.0994 | 7421.1 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.39001 | acc=0.9022 | tpr=0.9651 | fpr=0.0989 | 6983.1 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.39204 | acc=0.9021 | tpr=0.9673 | fpr=0.0991 | 6984.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.39544 | acc=0.9016 | tpr=0.9668 | fpr=0.0996 | 7321.4 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.39715 | acc=0.9017 | tpr=0.9672 | fpr=0.0995 | 7035.0 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.40058 | acc=0.9017 | tpr=0.9688 | fpr=0.0995 | 7240.7 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.40063 | acc=0.9013 | tpr=0.9700 | fpr=0.1000 | 6896.6 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.39841 | acc=0.9016 | tpr=0.9694 | fpr=0.0997 | 12842.5 samples/s | 50.2 steps/s
Avg test loss: 0.39804, Avg test acc: 0.90156, Avg tpr: 0.96870, Avg fpr: 0.09966, total FA: 13837

server round 38/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.2] | Loss=0.18080 | Reg=0.00148 | acc=0.8906 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 4327.8 samples/s | 67.6 steps/s
[Step=30450 Epoch=148.5] | Loss=0.02318 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.729 | 3660.6 samples/s | 57.2 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01681 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.220 | L2-Norm(final)=3.728 | 4391.5 samples/s | 68.6 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01275 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.729 | 4289.6 samples/s | 67.0 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01127 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.731 | 5902.1 samples/s | 92.2 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01019 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.230 | L2-Norm(final)=3.733 | 1793.7 samples/s | 28.0 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00907 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.734 | 4424.6 samples/s | 69.1 steps/s
[Step=30750 Epoch=149.9] | Loss=0.00826 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.736 | 4349.7 samples/s | 68.0 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00788 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.738 | 5278.0 samples/s | 82.5 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00744 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.236 | L2-Norm(final)=3.740 | 1803.3 samples/s | 28.2 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00707 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.742 | 4259.1 samples/s | 66.5 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00668 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.743 | 4298.2 samples/s | 67.2 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00632 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.745 | 5104.6 samples/s | 79.8 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00606 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.747 | 1844.7 samples/s | 28.8 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00573 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.749 | 4388.5 samples/s | 68.6 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00563 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.751 | 4226.9 samples/s | 66.0 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00555 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.752 | 4688.6 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.10277 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3896.7 samples/s | 60.9 steps/s
[Step=30450 Epoch=148.6] | Loss=0.01749 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.732 | 3956.6 samples/s | 61.8 steps/s
[Step=30500 Epoch=148.8] | Loss=0.01320 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.215 | L2-Norm(final)=3.732 | 4257.6 samples/s | 66.5 steps/s
[Step=30550 Epoch=149.1] | Loss=0.01190 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.220 | L2-Norm(final)=3.733 | 4319.4 samples/s | 67.5 steps/s
[Step=30600 Epoch=149.3] | Loss=0.01069 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.223 | L2-Norm(final)=3.735 | 5847.7 samples/s | 91.4 steps/s
[Step=30650 Epoch=149.6] | Loss=0.00926 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.737 | 1738.5 samples/s | 27.2 steps/s
[Step=30700 Epoch=149.8] | Loss=0.00813 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.739 | 4329.1 samples/s | 67.6 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00739 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=3.741 | 4392.4 samples/s | 68.6 steps/s
[Step=30800 Epoch=150.3] | Loss=0.00716 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.743 | 5576.5 samples/s | 87.1 steps/s
[Step=30850 Epoch=150.5] | Loss=0.00658 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.745 | 1804.9 samples/s | 28.2 steps/s
[Step=30900 Epoch=150.8] | Loss=0.00623 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.747 | 4250.8 samples/s | 66.4 steps/s
[Step=30950 Epoch=151.0] | Loss=0.00585 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.749 | 4186.8 samples/s | 65.4 steps/s
[Step=31000 Epoch=151.3] | Loss=0.00556 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.751 | 5114.5 samples/s | 79.9 steps/s
[Step=31050 Epoch=151.5] | Loss=0.00531 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.753 | 1817.3 samples/s | 28.4 steps/s
[Step=31100 Epoch=151.8] | Loss=0.00513 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.755 | 4273.6 samples/s | 66.8 steps/s
[Step=31150 Epoch=152.0] | Loss=0.00499 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.238 | L2-Norm(final)=3.757 | 4232.6 samples/s | 66.1 steps/s
[Step=31200 Epoch=152.2] | Loss=0.00484 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.759 | 4916.0 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step31200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.1] | Loss=0.06298 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3727.6 samples/s | 58.2 steps/s
[Step=30450 Epoch=148.4] | Loss=0.02667 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.726 | 4266.9 samples/s | 66.7 steps/s
[Step=30500 Epoch=148.6] | Loss=0.01820 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.724 | 4280.9 samples/s | 66.9 steps/s
[Step=30550 Epoch=148.9] | Loss=0.01468 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.724 | 4199.0 samples/s | 65.6 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01217 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.726 | 5714.2 samples/s | 89.3 steps/s
[Step=30650 Epoch=149.3] | Loss=0.01072 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.728 | 1745.8 samples/s | 27.3 steps/s
[Step=30700 Epoch=149.6] | Loss=0.00941 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.231 | L2-Norm(final)=3.730 | 4303.7 samples/s | 67.2 steps/s
[Step=30750 Epoch=149.8] | Loss=0.00859 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=3.732 | 4275.4 samples/s | 66.8 steps/s
[Step=30800 Epoch=150.1] | Loss=0.00812 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.734 | 5312.2 samples/s | 83.0 steps/s
[Step=30850 Epoch=150.3] | Loss=0.00767 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=3.736 | 1787.6 samples/s | 27.9 steps/s
[Step=30900 Epoch=150.6] | Loss=0.00716 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.738 | 4329.0 samples/s | 67.6 steps/s
[Step=30950 Epoch=150.8] | Loss=0.00691 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.740 | 4388.7 samples/s | 68.6 steps/s
[Step=31000 Epoch=151.0] | Loss=0.00663 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=3.742 | 4970.8 samples/s | 77.7 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00628 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=3.744 | 1802.7 samples/s | 28.2 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00596 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=3.745 | 4382.4 samples/s | 68.5 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00587 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=3.747 | 4327.5 samples/s | 67.6 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00574 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=3.749 | 4699.3 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step31200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.16663 | Reg=0.00148 | acc=0.9062 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3767.9 samples/s | 58.9 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01900 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.730 | 4210.5 samples/s | 65.8 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01351 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.730 | 4256.7 samples/s | 66.5 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01106 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.217 | L2-Norm(final)=3.732 | 4367.9 samples/s | 68.2 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00959 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.734 | 5966.1 samples/s | 93.2 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00853 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.736 | 1743.6 samples/s | 27.2 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00771 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.224 | L2-Norm(final)=3.738 | 4131.5 samples/s | 64.6 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00695 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.740 | 4181.5 samples/s | 65.3 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00644 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.742 | 5436.5 samples/s | 84.9 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00620 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.744 | 1804.0 samples/s | 28.2 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00584 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.746 | 4330.7 samples/s | 67.7 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00561 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.748 | 4398.1 samples/s | 68.7 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00532 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=3.750 | 5018.0 samples/s | 78.4 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00516 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.752 | 1839.9 samples/s | 28.7 steps/s
[Step=31100 Epoch=151.7] | Loss=0.00493 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=3.754 | 4264.7 samples/s | 66.6 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00485 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=3.756 | 4187.5 samples/s | 65.4 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00469 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=3.758 | 4640.9 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step31200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=149.1] | Loss=0.07779 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3755.5 samples/s | 58.7 steps/s
[Step=30450 Epoch=149.3] | Loss=0.02440 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.727 | 4179.9 samples/s | 65.3 steps/s
[Step=30500 Epoch=149.6] | Loss=0.01640 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.215 | L2-Norm(final)=3.725 | 4320.3 samples/s | 67.5 steps/s
[Step=30550 Epoch=149.8] | Loss=0.01361 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.218 | L2-Norm(final)=3.725 | 4366.2 samples/s | 68.2 steps/s
[Step=30600 Epoch=150.1] | Loss=0.01176 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.726 | 5833.0 samples/s | 91.1 steps/s
[Step=30650 Epoch=150.3] | Loss=0.01033 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.727 | 1744.1 samples/s | 27.3 steps/s
[Step=30700 Epoch=150.5] | Loss=0.00929 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.728 | 4226.0 samples/s | 66.0 steps/s
[Step=30750 Epoch=150.8] | Loss=0.00837 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.729 | 4298.7 samples/s | 67.2 steps/s
[Step=30800 Epoch=151.0] | Loss=0.00780 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.731 | 5467.0 samples/s | 85.4 steps/s
[Step=30850 Epoch=151.3] | Loss=0.00720 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.733 | 1731.0 samples/s | 27.0 steps/s
[Step=30900 Epoch=151.5] | Loss=0.00674 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=3.734 | 4253.1 samples/s | 66.5 steps/s
[Step=30950 Epoch=151.8] | Loss=0.00634 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.736 | 4271.8 samples/s | 66.7 steps/s
[Step=31000 Epoch=152.0] | Loss=0.00613 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.737 | 5384.8 samples/s | 84.1 steps/s
[Step=31050 Epoch=152.3] | Loss=0.00606 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.739 | 1794.8 samples/s | 28.0 steps/s
[Step=31100 Epoch=152.5] | Loss=0.00576 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.740 | 4401.4 samples/s | 68.8 steps/s
[Step=31150 Epoch=152.8] | Loss=0.00558 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.741 | 4326.8 samples/s | 67.6 steps/s
[Step=31200 Epoch=153.0] | Loss=0.00546 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.743 | 5083.8 samples/s | 79.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step31200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=288.1] | Loss=0.12860 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3912.0 samples/s | 61.1 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00408 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.738 | 3517.5 samples/s | 55.0 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00208 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.739 | 5524.0 samples/s | 86.3 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00140 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.740 | 1661.3 samples/s | 26.0 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00105 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.740 | 5089.9 samples/s | 79.5 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00084 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.741 | 1731.9 samples/s | 27.1 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00070 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.741 | 4832.8 samples/s | 75.5 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00060 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.742 | 1761.5 samples/s | 27.5 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00053 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.742 | 4251.7 samples/s | 66.4 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00047 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.742 | 1804.9 samples/s | 28.2 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00042 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.742 | 4162.8 samples/s | 65.0 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.742 | 1857.5 samples/s | 29.0 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00035 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.743 | 4169.4 samples/s | 65.1 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00033 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.743 | 1894.5 samples/s | 29.6 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00030 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.743 | 4111.5 samples/s | 64.2 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00028 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.743 | 1851.2 samples/s | 28.9 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00027 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=3.743 | 3969.5 samples/s | 62.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step31200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.2] | Loss=0.11220 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3660.9 samples/s | 57.2 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00266 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.742 | 3857.1 samples/s | 60.3 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00134 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.743 | 5548.1 samples/s | 86.7 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00090 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.743 | 1688.3 samples/s | 26.4 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00068 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.744 | 5140.0 samples/s | 80.3 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00054 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.744 | 1746.1 samples/s | 27.3 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00045 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.744 | 4750.0 samples/s | 74.2 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.745 | 1748.5 samples/s | 27.3 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00034 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.745 | 4421.9 samples/s | 69.1 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00030 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.745 | 1819.2 samples/s | 28.4 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00028 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=3.745 | 4286.5 samples/s | 67.0 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00025 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.746 | 1873.8 samples/s | 29.3 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.746 | 4096.5 samples/s | 64.0 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.746 | 1861.6 samples/s | 29.1 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.746 | 3981.7 samples/s | 62.2 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.746 | 1906.2 samples/s | 29.8 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.747 | 4027.8 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step31200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=290.3] | Loss=0.01859 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3858.9 samples/s | 60.3 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00089 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.746 | 3661.3 samples/s | 57.2 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00045 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.748 | 5585.7 samples/s | 87.3 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00030 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.749 | 1689.2 samples/s | 26.4 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.750 | 5319.2 samples/s | 83.1 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.750 | 1686.7 samples/s | 26.4 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.751 | 4944.1 samples/s | 77.3 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.751 | 1733.9 samples/s | 27.1 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.751 | 4579.2 samples/s | 71.5 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.752 | 1772.2 samples/s | 27.7 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=3.752 | 4380.6 samples/s | 68.4 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.752 | 1808.5 samples/s | 28.3 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.752 | 4068.8 samples/s | 63.6 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.753 | 1872.2 samples/s | 29.3 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.753 | 4018.7 samples/s | 62.8 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.753 | 1875.3 samples/s | 29.3 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.753 | 4241.1 samples/s | 66.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step31200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=286.5] | Loss=0.10847 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 4069.4 samples/s | 63.6 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00309 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.740 | 3634.8 samples/s | 56.8 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00155 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.741 | 5534.8 samples/s | 86.5 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00104 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.741 | 1659.5 samples/s | 25.9 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00078 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.741 | 4982.2 samples/s | 77.8 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00063 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.742 | 1729.2 samples/s | 27.0 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00052 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.742 | 4625.2 samples/s | 72.3 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00045 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.742 | 1818.2 samples/s | 28.4 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.742 | 4275.3 samples/s | 66.8 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00035 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.742 | 1866.4 samples/s | 29.2 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.742 | 4136.4 samples/s | 64.6 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00029 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.743 | 1894.0 samples/s | 29.6 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.743 | 4049.7 samples/s | 63.3 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.743 | 1892.0 samples/s | 29.6 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.743 | 4209.5 samples/s | 65.8 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00021 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=3.743 | 1982.7 samples/s | 31.0 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=3.743 | 3824.5 samples/s | 59.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step31200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.7] | Loss=0.00465 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.735 | 3757.9 samples/s | 58.7 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00091 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.744 | 3710.6 samples/s | 58.0 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00047 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.745 | 5612.8 samples/s | 87.7 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.746 | 1677.3 samples/s | 26.2 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.747 | 5254.2 samples/s | 82.1 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.747 | 1710.9 samples/s | 26.7 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00016 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=3.748 | 4993.1 samples/s | 78.0 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00014 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.748 | 1768.3 samples/s | 27.6 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=3.748 | 4670.6 samples/s | 73.0 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.748 | 1757.4 samples/s | 27.5 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=3.749 | 4442.6 samples/s | 69.4 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.749 | 1827.1 samples/s | 28.5 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00008 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=3.749 | 4179.4 samples/s | 65.3 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00008 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.749 | 1874.2 samples/s | 29.3 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.750 | 4156.2 samples/s | 64.9 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.750 | 1864.0 samples/s | 29.1 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.750 | 4200.2 samples/s | 65.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27119 | acc=0.8780 | tpr=0.8266 | fpr=0.0104 | 3780.8 samples/s | 14.8 steps/s
Avg test loss: 0.26961, Avg test acc: 0.87812, Avg tpr: 0.82794, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.35674 | acc=0.9081 | tpr=0.9469 | fpr=0.0926 | 3820.1 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.36391 | acc=0.9090 | tpr=0.9638 | fpr=0.0920 | 7140.3 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.36944 | acc=0.9080 | tpr=0.9654 | fpr=0.0931 | 7132.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.36945 | acc=0.9072 | tpr=0.9650 | fpr=0.0938 | 7166.3 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.36641 | acc=0.9076 | tpr=0.9642 | fpr=0.0935 | 7315.1 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.36826 | acc=0.9076 | tpr=0.9665 | fpr=0.0935 | 7007.1 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.37140 | acc=0.9069 | tpr=0.9656 | fpr=0.0942 | 6968.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.37304 | acc=0.9069 | tpr=0.9650 | fpr=0.0942 | 7174.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.37650 | acc=0.9069 | tpr=0.9669 | fpr=0.0942 | 7163.6 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.37647 | acc=0.9065 | tpr=0.9683 | fpr=0.0946 | 7040.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.37437 | acc=0.9069 | tpr=0.9674 | fpr=0.0942 | 13337.8 samples/s | 52.1 steps/s
Avg test loss: 0.37402, Avg test acc: 0.90690, Avg tpr: 0.96672, Avg fpr: 0.09419, total FA: 13078

server round 39/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.1] | Loss=0.17305 | Reg=0.00148 | acc=0.8594 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3770.4 samples/s | 58.9 steps/s
[Step=31250 Epoch=152.4] | Loss=0.02262 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.193 | L2-Norm(final)=3.754 | 4017.1 samples/s | 62.8 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01476 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.754 | 4220.8 samples/s | 66.0 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01232 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=3.756 | 4244.6 samples/s | 66.3 steps/s
[Step=31400 Epoch=153.1] | Loss=0.01117 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.757 | 5849.1 samples/s | 91.4 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00969 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.759 | 1734.5 samples/s | 27.1 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00892 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.761 | 4343.6 samples/s | 67.9 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00806 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.763 | 4324.5 samples/s | 67.6 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00747 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.765 | 5429.7 samples/s | 84.8 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00696 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.218 | L2-Norm(final)=3.767 | 1788.6 samples/s | 27.9 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00662 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.769 | 4143.5 samples/s | 64.7 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00621 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.771 | 4343.1 samples/s | 67.9 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00591 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.773 | 4952.6 samples/s | 77.4 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00568 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.775 | 1831.2 samples/s | 28.6 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00551 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.777 | 4395.2 samples/s | 68.7 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00535 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.224 | L2-Norm(final)=3.779 | 4404.6 samples/s | 68.8 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00526 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.780 | 4818.3 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.14044 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 4077.8 samples/s | 63.7 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01992 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.757 | 3843.2 samples/s | 60.0 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01458 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.758 | 4233.2 samples/s | 66.1 steps/s
[Step=31350 Epoch=153.0] | Loss=0.01237 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.759 | 4187.6 samples/s | 65.4 steps/s
[Step=31400 Epoch=153.2] | Loss=0.01079 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.760 | 5856.3 samples/s | 91.5 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00923 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.762 | 1769.6 samples/s | 27.7 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00834 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.764 | 4367.6 samples/s | 68.2 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00761 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.766 | 4385.5 samples/s | 68.5 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00705 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.769 | 5540.2 samples/s | 86.6 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00652 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.771 | 1769.4 samples/s | 27.6 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00612 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=3.773 | 4292.1 samples/s | 67.1 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00583 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.775 | 4274.3 samples/s | 66.8 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00562 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=3.777 | 4982.9 samples/s | 77.9 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00529 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.779 | 1818.6 samples/s | 28.4 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00513 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.781 | 4271.9 samples/s | 66.7 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00489 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=3.783 | 4339.1 samples/s | 67.8 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00474 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=3.785 | 4935.4 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.0] | Loss=0.11877 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 4104.4 samples/s | 64.1 steps/s
[Step=31250 Epoch=152.3] | Loss=0.02104 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.756 | 3906.9 samples/s | 61.0 steps/s
[Step=31300 Epoch=152.5] | Loss=0.01526 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.208 | L2-Norm(final)=3.755 | 4247.3 samples/s | 66.4 steps/s
[Step=31350 Epoch=152.8] | Loss=0.01251 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.213 | L2-Norm(final)=3.757 | 4325.2 samples/s | 67.6 steps/s
[Step=31400 Epoch=153.0] | Loss=0.01078 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.759 | 5877.7 samples/s | 91.8 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00937 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.761 | 1743.5 samples/s | 27.2 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00833 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=3.764 | 4209.4 samples/s | 65.8 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00769 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.223 | L2-Norm(final)=3.766 | 4086.4 samples/s | 63.9 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00723 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.224 | L2-Norm(final)=3.768 | 5179.1 samples/s | 80.9 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00668 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.771 | 1799.1 samples/s | 28.1 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00624 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.773 | 4434.8 samples/s | 69.3 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00593 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.775 | 4286.3 samples/s | 67.0 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00586 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.777 | 5027.6 samples/s | 78.6 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00556 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.779 | 1854.8 samples/s | 29.0 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00535 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.781 | 4214.5 samples/s | 65.9 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00525 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.782 | 4191.8 samples/s | 65.5 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00513 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=3.784 | 4655.7 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.12285 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3840.4 samples/s | 60.0 steps/s
[Step=31250 Epoch=152.4] | Loss=0.02568 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.755 | 4094.7 samples/s | 64.0 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01696 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.755 | 4417.3 samples/s | 69.0 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01348 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=3.756 | 4265.5 samples/s | 66.6 steps/s
[Step=31400 Epoch=153.1] | Loss=0.01117 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.757 | 5882.8 samples/s | 91.9 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00966 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.760 | 1755.4 samples/s | 27.4 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00844 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.221 | L2-Norm(final)=3.762 | 4259.1 samples/s | 66.5 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00773 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=3.764 | 4294.8 samples/s | 67.1 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00725 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.224 | L2-Norm(final)=3.766 | 5382.9 samples/s | 84.1 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00673 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=3.768 | 1773.9 samples/s | 27.7 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00630 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=3.770 | 4325.6 samples/s | 67.6 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00608 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=3.772 | 4271.6 samples/s | 66.7 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00581 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=3.773 | 4970.2 samples/s | 77.7 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00574 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=3.775 | 1847.0 samples/s | 28.9 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00573 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=3.777 | 4315.3 samples/s | 67.4 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00555 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=3.778 | 4210.2 samples/s | 65.8 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00545 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=3.780 | 4699.1 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=153.0] | Loss=0.29465 | Reg=0.00148 | acc=0.8906 | L2-Norm=12.169 | L2-Norm(final)=3.762 | 3812.2 samples/s | 59.6 steps/s
[Step=31250 Epoch=153.2] | Loss=0.02299 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.752 | 4151.3 samples/s | 64.9 steps/s
[Step=31300 Epoch=153.5] | Loss=0.01522 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.200 | L2-Norm(final)=3.752 | 4397.1 samples/s | 68.7 steps/s
[Step=31350 Epoch=153.7] | Loss=0.01243 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=3.753 | 4310.5 samples/s | 67.4 steps/s
[Step=31400 Epoch=154.0] | Loss=0.01073 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.754 | 5857.5 samples/s | 91.5 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00916 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.207 | L2-Norm(final)=3.756 | 1750.2 samples/s | 27.3 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00834 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.758 | 4270.2 samples/s | 66.7 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00751 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.760 | 4359.4 samples/s | 68.1 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00702 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.762 | 5749.1 samples/s | 89.8 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00648 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=3.764 | 1742.1 samples/s | 27.2 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00607 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.214 | L2-Norm(final)=3.766 | 4258.2 samples/s | 66.5 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00589 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.768 | 4330.7 samples/s | 67.7 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00563 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=3.770 | 5227.6 samples/s | 81.7 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00542 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.771 | 1797.8 samples/s | 28.1 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00520 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.773 | 4344.4 samples/s | 67.9 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00501 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=3.775 | 4316.3 samples/s | 67.4 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00486 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.777 | 5113.3 samples/s | 79.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step32000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=295.7] | Loss=0.02132 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.169 | L2-Norm(final)=3.764 | 4016.9 samples/s | 62.8 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00169 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.776 | 3551.2 samples/s | 55.5 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00085 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=3.778 | 5476.6 samples/s | 85.6 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00057 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.778 | 1668.6 samples/s | 26.1 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00043 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.779 | 5075.8 samples/s | 79.3 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00034 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.779 | 1728.8 samples/s | 27.0 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00029 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.779 | 4758.1 samples/s | 74.3 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00025 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.780 | 1778.1 samples/s | 27.8 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00022 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=3.780 | 4342.3 samples/s | 67.8 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00019 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.780 | 1808.3 samples/s | 28.3 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=3.780 | 4172.0 samples/s | 65.2 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.780 | 1869.6 samples/s | 29.2 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.780 | 4209.6 samples/s | 65.8 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.780 | 1873.5 samples/s | 29.3 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.781 | 4130.7 samples/s | 64.5 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.781 | 1900.4 samples/s | 29.7 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.781 | 4220.4 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step32000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=296.8] | Loss=0.00368 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3651.1 samples/s | 57.0 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00157 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=3.772 | 3847.7 samples/s | 60.1 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00079 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.773 | 5515.3 samples/s | 86.2 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00053 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.773 | 1678.4 samples/s | 26.2 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00040 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.774 | 5153.7 samples/s | 80.5 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.774 | 1737.7 samples/s | 27.2 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00027 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=3.774 | 4759.8 samples/s | 74.4 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=3.774 | 1802.1 samples/s | 28.2 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.774 | 4397.3 samples/s | 68.7 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=3.775 | 1788.2 samples/s | 27.9 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.775 | 4029.9 samples/s | 63.0 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.775 | 1853.0 samples/s | 29.0 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.775 | 4056.3 samples/s | 63.4 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.775 | 1865.9 samples/s | 29.2 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.775 | 4208.8 samples/s | 65.8 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.776 | 1880.9 samples/s | 29.4 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00010 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.776 | 4114.7 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=298.0] | Loss=0.10650 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3823.7 samples/s | 59.7 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00321 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=3.772 | 3691.3 samples/s | 57.7 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00161 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.773 | 5721.0 samples/s | 89.4 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00107 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=3.773 | 1623.9 samples/s | 25.4 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00081 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=3.774 | 5202.2 samples/s | 81.3 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00064 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.774 | 1689.8 samples/s | 26.4 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00054 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=3.774 | 4792.5 samples/s | 74.9 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00046 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.774 | 1731.2 samples/s | 27.1 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00040 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=3.774 | 4600.1 samples/s | 71.9 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00036 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=3.774 | 1802.2 samples/s | 28.2 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00032 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=3.774 | 4319.7 samples/s | 67.5 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00029 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.774 | 1831.9 samples/s | 28.6 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00027 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.774 | 4163.5 samples/s | 65.1 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00025 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=3.775 | 1849.4 samples/s | 28.9 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00023 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.775 | 4130.9 samples/s | 64.5 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.775 | 1869.3 samples/s | 29.2 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.775 | 3979.5 samples/s | 62.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=294.0] | Loss=0.00211 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3811.9 samples/s | 59.6 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00102 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.778 | 3705.3 samples/s | 57.9 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00052 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.781 | 5535.4 samples/s | 86.5 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00035 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=3.782 | 1698.2 samples/s | 26.5 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00026 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=3.782 | 5035.2 samples/s | 78.7 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00021 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=3.782 | 1709.2 samples/s | 26.7 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00017 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=3.783 | 4449.4 samples/s | 69.5 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=3.783 | 1782.1 samples/s | 27.8 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00013 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=3.783 | 4229.5 samples/s | 66.1 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=3.783 | 1852.2 samples/s | 28.9 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00011 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=3.783 | 4230.7 samples/s | 66.1 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=3.783 | 1874.9 samples/s | 29.3 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=3.784 | 4151.2 samples/s | 64.9 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.784 | 1879.6 samples/s | 29.4 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.784 | 4059.3 samples/s | 63.4 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.784 | 2017.6 samples/s | 31.5 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.784 | 3737.1 samples/s | 58.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step32000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=297.4] | Loss=0.00661 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.763 | 3742.1 samples/s | 58.5 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00070 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.775 | 3825.4 samples/s | 59.8 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00036 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=3.777 | 5483.1 samples/s | 85.7 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00024 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=3.778 | 1655.7 samples/s | 25.9 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00018 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=3.778 | 5313.4 samples/s | 83.0 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=3.778 | 1720.3 samples/s | 26.9 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00012 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=3.779 | 4942.4 samples/s | 77.2 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00010 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=3.779 | 1755.9 samples/s | 27.4 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.779 | 4736.4 samples/s | 74.0 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.779 | 1778.0 samples/s | 27.8 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.779 | 4283.3 samples/s | 66.9 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.780 | 1821.8 samples/s | 28.5 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.780 | 4057.8 samples/s | 63.4 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.780 | 1867.3 samples/s | 29.2 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00005 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.780 | 4174.8 samples/s | 65.2 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00005 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.780 | 1873.3 samples/s | 29.3 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00005 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.780 | 4232.6 samples/s | 66.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28026 | acc=0.8734 | tpr=0.8199 | fpr=0.0107 | 3766.7 samples/s | 14.7 steps/s
Avg test loss: 0.27914, Avg test acc: 0.87395, Avg tpr: 0.82194, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.35226 | acc=0.9132 | tpr=0.9425 | fpr=0.0873 | 3784.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.35916 | acc=0.9139 | tpr=0.9616 | fpr=0.0870 | 7479.4 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.36536 | acc=0.9131 | tpr=0.9640 | fpr=0.0879 | 6786.4 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.36538 | acc=0.9129 | tpr=0.9639 | fpr=0.0880 | 7328.4 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.36246 | acc=0.9132 | tpr=0.9633 | fpr=0.0877 | 6932.5 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.36440 | acc=0.9131 | tpr=0.9651 | fpr=0.0879 | 7297.4 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.36758 | acc=0.9125 | tpr=0.9643 | fpr=0.0884 | 7107.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.36934 | acc=0.9124 | tpr=0.9639 | fpr=0.0885 | 7232.6 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.37296 | acc=0.9123 | tpr=0.9659 | fpr=0.0887 | 6988.6 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.37269 | acc=0.9121 | tpr=0.9674 | fpr=0.0889 | 6958.9 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.37056 | acc=0.9124 | tpr=0.9670 | fpr=0.0886 | 12964.7 samples/s | 50.6 steps/s
Avg test loss: 0.37021, Avg test acc: 0.91240, Avg tpr: 0.96632, Avg fpr: 0.08858, total FA: 12299

server round 40/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.10858 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.154 | L2-Norm(final)=3.793 | 3801.6 samples/s | 59.4 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02219 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.164 | L2-Norm(final)=3.791 | 4070.2 samples/s | 63.6 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01545 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.167 | L2-Norm(final)=3.790 | 4301.3 samples/s | 67.2 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01321 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.791 | 4315.0 samples/s | 67.4 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01174 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.792 | 5905.7 samples/s | 92.3 steps/s
[Step=32250 Epoch=157.3] | Loss=0.01007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.793 | 1761.8 samples/s | 27.5 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00914 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.794 | 4253.9 samples/s | 66.5 steps/s
[Step=32350 Epoch=157.7] | Loss=0.00830 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.795 | 4339.4 samples/s | 67.8 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00774 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.796 | 5510.1 samples/s | 86.1 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00719 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.797 | 1806.2 samples/s | 28.2 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00680 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.178 | L2-Norm(final)=3.799 | 4382.2 samples/s | 68.5 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00641 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.800 | 4179.7 samples/s | 65.3 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00616 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.179 | L2-Norm(final)=3.801 | 4894.9 samples/s | 76.5 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00589 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.802 | 1848.5 samples/s | 28.9 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00565 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.804 | 4241.8 samples/s | 66.3 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00546 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.805 | 4247.9 samples/s | 66.4 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00530 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.806 | 4648.5 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.2] | Loss=0.11043 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.154 | L2-Norm(final)=3.793 | 3708.8 samples/s | 57.9 steps/s
[Step=32050 Epoch=156.4] | Loss=0.02191 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.790 | 4204.4 samples/s | 65.7 steps/s
[Step=32100 Epoch=156.6] | Loss=0.01550 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.790 | 4229.3 samples/s | 66.1 steps/s
[Step=32150 Epoch=156.9] | Loss=0.01238 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.791 | 4275.6 samples/s | 66.8 steps/s
[Step=32200 Epoch=157.1] | Loss=0.01053 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.793 | 5656.3 samples/s | 88.4 steps/s
[Step=32250 Epoch=157.4] | Loss=0.00911 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=3.794 | 1711.7 samples/s | 26.7 steps/s
[Step=32300 Epoch=157.6] | Loss=0.00812 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.176 | L2-Norm(final)=3.795 | 4391.7 samples/s | 68.6 steps/s
[Step=32350 Epoch=157.9] | Loss=0.00740 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.797 | 4303.4 samples/s | 67.2 steps/s
[Step=32400 Epoch=158.1] | Loss=0.00672 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.798 | 5589.5 samples/s | 87.3 steps/s
[Step=32450 Epoch=158.3] | Loss=0.00623 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.799 | 1765.5 samples/s | 27.6 steps/s
[Step=32500 Epoch=158.6] | Loss=0.00597 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.180 | L2-Norm(final)=3.801 | 4280.2 samples/s | 66.9 steps/s
[Step=32550 Epoch=158.8] | Loss=0.00559 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.802 | 4348.7 samples/s | 67.9 steps/s
[Step=32600 Epoch=159.1] | Loss=0.00533 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.804 | 5187.1 samples/s | 81.0 steps/s
[Step=32650 Epoch=159.3] | Loss=0.00509 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.805 | 1751.7 samples/s | 27.4 steps/s
[Step=32700 Epoch=159.6] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.806 | 4272.4 samples/s | 66.8 steps/s
[Step=32750 Epoch=159.8] | Loss=0.00467 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.808 | 4292.4 samples/s | 67.1 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00453 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.809 | 4889.2 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step32800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=155.9] | Loss=0.07586 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.154 | L2-Norm(final)=3.793 | 4033.7 samples/s | 63.0 steps/s
[Step=32050 Epoch=156.2] | Loss=0.02126 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.790 | 3842.1 samples/s | 60.0 steps/s
[Step=32100 Epoch=156.4] | Loss=0.01553 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.790 | 4352.8 samples/s | 68.0 steps/s
[Step=32150 Epoch=156.7] | Loss=0.01262 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.791 | 4420.4 samples/s | 69.1 steps/s
[Step=32200 Epoch=156.9] | Loss=0.01066 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.792 | 5795.0 samples/s | 90.5 steps/s
[Step=32250 Epoch=157.1] | Loss=0.00903 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.794 | 1772.7 samples/s | 27.7 steps/s
[Step=32300 Epoch=157.4] | Loss=0.00812 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.795 | 4227.4 samples/s | 66.1 steps/s
[Step=32350 Epoch=157.6] | Loss=0.00733 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.797 | 4270.0 samples/s | 66.7 steps/s
[Step=32400 Epoch=157.9] | Loss=0.00701 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=3.798 | 5409.7 samples/s | 84.5 steps/s
[Step=32450 Epoch=158.1] | Loss=0.00658 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.800 | 1793.7 samples/s | 28.0 steps/s
[Step=32500 Epoch=158.4] | Loss=0.00619 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.801 | 4335.9 samples/s | 67.7 steps/s
[Step=32550 Epoch=158.6] | Loss=0.00591 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.803 | 4351.2 samples/s | 68.0 steps/s
[Step=32600 Epoch=158.8] | Loss=0.00563 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.804 | 5158.3 samples/s | 80.6 steps/s
[Step=32650 Epoch=159.1] | Loss=0.00536 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=3.806 | 1836.9 samples/s | 28.7 steps/s
[Step=32700 Epoch=159.3] | Loss=0.00513 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=3.807 | 4371.8 samples/s | 68.3 steps/s
[Step=32750 Epoch=159.6] | Loss=0.00498 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=3.809 | 4222.5 samples/s | 66.0 steps/s
[Step=32800 Epoch=159.8] | Loss=0.00480 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=3.810 | 4629.9 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step32800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.1] | Loss=0.15177 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.154 | L2-Norm(final)=3.793 | 4071.2 samples/s | 63.6 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02210 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=3.791 | 3811.7 samples/s | 59.6 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01419 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.170 | L2-Norm(final)=3.792 | 4322.3 samples/s | 67.5 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01170 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.793 | 4215.2 samples/s | 65.9 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.794 | 5832.8 samples/s | 91.1 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00877 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.795 | 1758.4 samples/s | 27.5 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00787 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.797 | 4227.8 samples/s | 66.1 steps/s
[Step=32350 Epoch=157.8] | Loss=0.00724 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.798 | 4319.7 samples/s | 67.5 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00667 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.799 | 5441.4 samples/s | 85.0 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00620 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.801 | 1726.2 samples/s | 27.0 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00581 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.802 | 4200.1 samples/s | 65.6 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00560 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.803 | 4168.0 samples/s | 65.1 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00534 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.804 | 5043.3 samples/s | 78.8 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00510 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.806 | 1834.1 samples/s | 28.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.807 | 4329.6 samples/s | 67.6 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00468 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.808 | 4343.2 samples/s | 67.9 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00460 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.185 | L2-Norm(final)=3.809 | 4712.9 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step32800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.9] | Loss=0.04984 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 4181.4 samples/s | 65.3 steps/s
[Step=32050 Epoch=157.2] | Loss=0.02198 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.791 | 3703.8 samples/s | 57.9 steps/s
[Step=32100 Epoch=157.4] | Loss=0.01398 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.791 | 4182.4 samples/s | 65.4 steps/s
[Step=32150 Epoch=157.7] | Loss=0.01208 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.792 | 4301.6 samples/s | 67.2 steps/s
[Step=32200 Epoch=157.9] | Loss=0.01036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.793 | 6043.6 samples/s | 94.4 steps/s
[Step=32250 Epoch=158.1] | Loss=0.00881 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.794 | 1745.6 samples/s | 27.3 steps/s
[Step=32300 Epoch=158.4] | Loss=0.00785 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.795 | 4385.0 samples/s | 68.5 steps/s
[Step=32350 Epoch=158.6] | Loss=0.00712 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.796 | 4366.5 samples/s | 68.2 steps/s
[Step=32400 Epoch=158.9] | Loss=0.00658 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.798 | 5555.2 samples/s | 86.8 steps/s
[Step=32450 Epoch=159.1] | Loss=0.00623 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.799 | 1770.9 samples/s | 27.7 steps/s
[Step=32500 Epoch=159.4] | Loss=0.00585 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.180 | L2-Norm(final)=3.800 | 4378.6 samples/s | 68.4 steps/s
[Step=32550 Epoch=159.6] | Loss=0.00550 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.802 | 4304.3 samples/s | 67.3 steps/s
[Step=32600 Epoch=159.9] | Loss=0.00525 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.803 | 5216.4 samples/s | 81.5 steps/s
[Step=32650 Epoch=160.1] | Loss=0.00501 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.804 | 1765.6 samples/s | 27.6 steps/s
[Step=32700 Epoch=160.4] | Loss=0.00483 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.806 | 4144.0 samples/s | 64.8 steps/s
[Step=32750 Epoch=160.6] | Loss=0.00467 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.807 | 4228.1 samples/s | 66.1 steps/s
[Step=32800 Epoch=160.8] | Loss=0.00447 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.808 | 5123.6 samples/s | 80.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step32800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.00645 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 3839.2 samples/s | 60.0 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00174 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.800 | 3788.0 samples/s | 59.2 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00090 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.802 | 5551.2 samples/s | 86.7 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.803 | 1656.2 samples/s | 25.9 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.804 | 5055.2 samples/s | 79.0 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00037 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.804 | 1721.5 samples/s | 26.9 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.805 | 4729.1 samples/s | 73.9 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.805 | 1747.5 samples/s | 27.3 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.806 | 4373.4 samples/s | 68.3 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.806 | 1792.3 samples/s | 28.0 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.806 | 4102.2 samples/s | 64.1 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.806 | 1870.1 samples/s | 29.2 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.807 | 4032.7 samples/s | 63.0 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.807 | 1883.1 samples/s | 29.4 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.807 | 4128.9 samples/s | 64.5 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.807 | 1909.0 samples/s | 29.8 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.807 | 4094.2 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step32800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=304.4] | Loss=0.02899 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 3720.2 samples/s | 58.1 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00238 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.797 | 3828.8 samples/s | 59.8 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00122 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.798 | 5538.8 samples/s | 86.5 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00082 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.798 | 1693.0 samples/s | 26.5 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.798 | 5235.2 samples/s | 81.8 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00049 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.799 | 1711.4 samples/s | 26.7 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.799 | 4748.3 samples/s | 74.2 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.799 | 1804.4 samples/s | 28.2 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.799 | 4406.0 samples/s | 68.8 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.799 | 1794.5 samples/s | 28.0 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.799 | 4316.7 samples/s | 67.4 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.799 | 1874.5 samples/s | 29.3 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.800 | 4127.5 samples/s | 64.5 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.800 | 1893.3 samples/s | 29.6 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.800 | 4172.6 samples/s | 65.2 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.800 | 1893.9 samples/s | 29.6 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.800 | 4005.5 samples/s | 62.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step32800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.6] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 3842.9 samples/s | 60.0 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00191 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.800 | 3709.4 samples/s | 58.0 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00097 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.801 | 5749.6 samples/s | 89.8 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00065 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.802 | 1671.0 samples/s | 26.1 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00049 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.802 | 5238.4 samples/s | 81.9 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.802 | 1713.7 samples/s | 26.8 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00033 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.802 | 5013.9 samples/s | 78.3 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.802 | 1729.4 samples/s | 27.0 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.803 | 4479.4 samples/s | 70.0 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.803 | 1764.8 samples/s | 27.6 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.803 | 4344.2 samples/s | 67.9 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.803 | 1807.5 samples/s | 28.2 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.803 | 4219.9 samples/s | 65.9 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.803 | 1867.0 samples/s | 29.2 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.803 | 4098.1 samples/s | 64.0 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.803 | 1863.6 samples/s | 29.1 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.803 | 4150.3 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step32800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=301.5] | Loss=0.00178 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 3850.9 samples/s | 60.2 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00236 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.800 | 3744.0 samples/s | 58.5 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00119 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.801 | 5590.5 samples/s | 87.4 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00080 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.802 | 1709.1 samples/s | 26.7 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00060 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.802 | 5073.6 samples/s | 79.3 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00049 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.803 | 1714.5 samples/s | 26.8 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.803 | 4465.9 samples/s | 69.8 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.803 | 1817.6 samples/s | 28.4 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.803 | 4448.5 samples/s | 69.5 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.803 | 1903.0 samples/s | 29.7 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.804 | 4138.6 samples/s | 64.7 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.804 | 1901.2 samples/s | 29.7 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.804 | 4067.3 samples/s | 63.6 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.804 | 1919.3 samples/s | 30.0 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.804 | 4171.1 samples/s | 65.2 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.804 | 2004.5 samples/s | 31.3 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.804 | 3779.5 samples/s | 59.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step32800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.0] | Loss=0.03768 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.154 | L2-Norm(final)=3.794 | 3637.3 samples/s | 56.8 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00115 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.798 | 3893.3 samples/s | 60.8 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00059 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.799 | 5682.2 samples/s | 88.8 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00040 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.800 | 1626.6 samples/s | 25.4 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.800 | 5243.2 samples/s | 81.9 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.801 | 1705.2 samples/s | 26.6 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.801 | 4918.2 samples/s | 76.8 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.801 | 1750.9 samples/s | 27.4 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.801 | 4667.6 samples/s | 72.9 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.802 | 1774.6 samples/s | 27.7 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.802 | 4379.0 samples/s | 68.4 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.802 | 1775.7 samples/s | 27.7 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.802 | 4150.9 samples/s | 64.9 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00010 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.802 | 1901.5 samples/s | 29.7 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.802 | 4038.0 samples/s | 63.1 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.803 | 1850.5 samples/s | 28.9 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.803 | 4102.0 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23773 | acc=0.8941 | tpr=0.8513 | fpr=0.0129 | 3805.6 samples/s | 14.9 steps/s
Avg test loss: 0.23651, Avg test acc: 0.89482, Avg tpr: 0.85341, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.38771 | acc=0.9003 | tpr=0.9425 | fpr=0.1004 | 3738.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.39415 | acc=0.9013 | tpr=0.9616 | fpr=0.0998 | 7281.0 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.40076 | acc=0.8999 | tpr=0.9625 | fpr=0.1013 | 7425.4 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.40065 | acc=0.8995 | tpr=0.9628 | fpr=0.1017 | 7019.3 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.39748 | acc=0.9001 | tpr=0.9624 | fpr=0.1011 | 7101.6 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.39947 | acc=0.8998 | tpr=0.9651 | fpr=0.1014 | 7163.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.40286 | acc=0.8991 | tpr=0.9643 | fpr=0.1020 | 7168.4 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.40454 | acc=0.8992 | tpr=0.9639 | fpr=0.1020 | 6985.1 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.40811 | acc=0.8990 | tpr=0.9659 | fpr=0.1022 | 7172.1 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.40809 | acc=0.8986 | tpr=0.9674 | fpr=0.1027 | 7034.3 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.40584 | acc=0.8990 | tpr=0.9670 | fpr=0.1022 | 13446.9 samples/s | 52.5 steps/s
Avg test loss: 0.40547, Avg test acc: 0.89901, Avg tpr: 0.96632, Avg fpr: 0.10221, total FA: 14192

server round 41/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.9] | Loss=0.05514 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 4112.2 samples/s | 64.3 steps/s
[Step=32850 Epoch=160.2] | Loss=0.02121 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.164 | L2-Norm(final)=3.814 | 3839.4 samples/s | 60.0 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01497 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.814 | 4287.3 samples/s | 67.0 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01223 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.814 | 4344.9 samples/s | 67.9 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01051 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.815 | 5642.1 samples/s | 88.2 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00895 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.816 | 1743.4 samples/s | 27.2 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00808 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=3.817 | 4331.0 samples/s | 67.7 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00734 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.818 | 4304.2 samples/s | 67.3 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00697 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.819 | 5512.5 samples/s | 86.1 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00652 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.821 | 1789.0 samples/s | 28.0 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00607 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.822 | 4293.0 samples/s | 67.1 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00588 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.823 | 4323.1 samples/s | 67.5 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00560 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.180 | L2-Norm(final)=3.824 | 5095.9 samples/s | 79.6 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00539 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.826 | 1820.0 samples/s | 28.4 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00515 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.827 | 4301.9 samples/s | 67.2 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00494 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.828 | 4287.0 samples/s | 67.0 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.829 | 4719.9 samples/s | 73.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.1] | Loss=0.04922 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3774.9 samples/s | 59.0 steps/s
[Step=32850 Epoch=160.3] | Loss=0.02097 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.813 | 4185.5 samples/s | 65.4 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01427 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.813 | 4408.9 samples/s | 68.9 steps/s
[Step=32950 Epoch=160.8] | Loss=0.01181 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.814 | 4353.6 samples/s | 68.0 steps/s
[Step=33000 Epoch=161.0] | Loss=0.01000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.815 | 5810.2 samples/s | 90.8 steps/s
[Step=33050 Epoch=161.3] | Loss=0.00865 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.816 | 1697.1 samples/s | 26.5 steps/s
[Step=33100 Epoch=161.5] | Loss=0.00769 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.817 | 4333.0 samples/s | 67.7 steps/s
[Step=33150 Epoch=161.8] | Loss=0.00699 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.819 | 4345.5 samples/s | 67.9 steps/s
[Step=33200 Epoch=162.0] | Loss=0.00650 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.820 | 5482.2 samples/s | 85.7 steps/s
[Step=33250 Epoch=162.2] | Loss=0.00609 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.821 | 1779.2 samples/s | 27.8 steps/s
[Step=33300 Epoch=162.5] | Loss=0.00565 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.823 | 4346.4 samples/s | 67.9 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00536 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.824 | 4307.4 samples/s | 67.3 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00509 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.825 | 5174.1 samples/s | 80.8 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00488 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.827 | 1810.8 samples/s | 28.3 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00475 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.828 | 4424.5 samples/s | 69.1 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00462 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.829 | 4356.0 samples/s | 68.1 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00444 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.830 | 4692.5 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step33600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.8] | Loss=0.01571 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3837.5 samples/s | 60.0 steps/s
[Step=32850 Epoch=160.1] | Loss=0.01755 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.815 | 3974.1 samples/s | 62.1 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01206 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.815 | 4298.1 samples/s | 67.2 steps/s
[Step=32950 Epoch=160.5] | Loss=0.01026 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.171 | L2-Norm(final)=3.816 | 4357.2 samples/s | 68.1 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00906 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.818 | 5871.6 samples/s | 91.7 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00784 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.819 | 1763.2 samples/s | 27.5 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00700 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.821 | 4302.2 samples/s | 67.2 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00645 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.822 | 4386.3 samples/s | 68.5 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00606 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.824 | 5484.0 samples/s | 85.7 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00574 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.825 | 1781.8 samples/s | 27.8 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00545 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.827 | 4310.2 samples/s | 67.3 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00517 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.181 | L2-Norm(final)=3.829 | 4286.2 samples/s | 67.0 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00502 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.830 | 5039.3 samples/s | 78.7 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00478 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.832 | 1865.1 samples/s | 29.1 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00459 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=3.833 | 4331.6 samples/s | 67.7 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00448 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=3.835 | 4227.3 samples/s | 66.1 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00439 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=3.836 | 4754.7 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step33600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.0] | Loss=0.16892 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3806.3 samples/s | 59.5 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01793 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.816 | 4114.8 samples/s | 64.3 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01270 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.816 | 4195.9 samples/s | 65.6 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01005 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.817 | 4356.1 samples/s | 68.1 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00863 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.819 | 5893.3 samples/s | 92.1 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00758 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.820 | 1790.5 samples/s | 28.0 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00674 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.822 | 4401.9 samples/s | 68.8 steps/s
[Step=33150 Epoch=161.7] | Loss=0.00623 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.823 | 4295.7 samples/s | 67.1 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00581 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.824 | 5412.3 samples/s | 84.6 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00540 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.826 | 1791.2 samples/s | 28.0 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00512 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.827 | 4347.9 samples/s | 67.9 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00488 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.179 | L2-Norm(final)=3.828 | 4248.5 samples/s | 66.4 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00471 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.830 | 5070.1 samples/s | 79.2 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00454 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=3.831 | 1864.7 samples/s | 29.1 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00431 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=3.832 | 4391.8 samples/s | 68.6 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00419 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.833 | 4336.8 samples/s | 67.8 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00409 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=3.834 | 4616.2 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step33600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.9] | Loss=0.18361 | Reg=0.00148 | acc=0.8906 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3621.0 samples/s | 56.6 steps/s
[Step=32850 Epoch=161.1] | Loss=0.02220 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.814 | 4277.2 samples/s | 66.8 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01405 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.814 | 4298.5 samples/s | 67.2 steps/s
[Step=32950 Epoch=161.6] | Loss=0.01145 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.814 | 4207.8 samples/s | 65.7 steps/s
[Step=33000 Epoch=161.8] | Loss=0.01005 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.169 | L2-Norm(final)=3.815 | 5797.5 samples/s | 90.6 steps/s
[Step=33050 Epoch=162.1] | Loss=0.00854 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.816 | 1735.7 samples/s | 27.1 steps/s
[Step=33100 Epoch=162.3] | Loss=0.00763 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.171 | L2-Norm(final)=3.817 | 4313.5 samples/s | 67.4 steps/s
[Step=33150 Epoch=162.6] | Loss=0.00697 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.818 | 4330.9 samples/s | 67.7 steps/s
[Step=33200 Epoch=162.8] | Loss=0.00652 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.820 | 5725.7 samples/s | 89.5 steps/s
[Step=33250 Epoch=163.1] | Loss=0.00604 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.821 | 1765.4 samples/s | 27.6 steps/s
[Step=33300 Epoch=163.3] | Loss=0.00564 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.822 | 4378.4 samples/s | 68.4 steps/s
[Step=33350 Epoch=163.5] | Loss=0.00535 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.823 | 4394.3 samples/s | 68.7 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00512 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.824 | 5511.8 samples/s | 86.1 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00489 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.176 | L2-Norm(final)=3.826 | 1778.9 samples/s | 27.8 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00471 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.827 | 4317.2 samples/s | 67.5 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00456 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.828 | 4361.4 samples/s | 68.1 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00442 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.829 | 5127.7 samples/s | 80.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step33600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=310.8] | Loss=0.02682 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3761.7 samples/s | 58.8 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00160 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.825 | 3694.0 samples/s | 57.7 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00081 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.827 | 5699.9 samples/s | 89.1 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00055 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.827 | 1678.5 samples/s | 26.2 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.828 | 5109.0 samples/s | 79.8 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00033 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.828 | 1705.6 samples/s | 26.6 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.828 | 4675.6 samples/s | 73.1 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.828 | 1771.3 samples/s | 27.7 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.829 | 4390.4 samples/s | 68.6 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.829 | 1842.1 samples/s | 28.8 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.829 | 4093.1 samples/s | 64.0 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.829 | 1886.0 samples/s | 29.5 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.829 | 4123.3 samples/s | 64.4 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.829 | 1854.1 samples/s | 29.0 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.829 | 4126.0 samples/s | 64.5 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.829 | 1903.1 samples/s | 29.7 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.829 | 4023.1 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step33600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.0] | Loss=0.07843 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3997.9 samples/s | 62.5 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00249 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.822 | 3576.8 samples/s | 55.9 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00127 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.824 | 5684.1 samples/s | 88.8 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00085 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.824 | 1644.9 samples/s | 25.7 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00064 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.825 | 5078.4 samples/s | 79.3 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.825 | 1720.6 samples/s | 26.9 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.826 | 4748.1 samples/s | 74.2 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00037 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.826 | 1779.0 samples/s | 27.8 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00033 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.826 | 4507.3 samples/s | 70.4 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.826 | 1836.3 samples/s | 28.7 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.826 | 4297.9 samples/s | 67.2 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.827 | 1874.6 samples/s | 29.3 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.827 | 4217.6 samples/s | 65.9 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.827 | 1905.1 samples/s | 29.8 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.827 | 4276.9 samples/s | 66.8 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.827 | 1899.1 samples/s | 29.7 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.827 | 4038.3 samples/s | 63.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step33600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=313.2] | Loss=0.01515 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3681.6 samples/s | 57.5 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00262 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.824 | 3782.4 samples/s | 59.1 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00132 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.826 | 5528.9 samples/s | 86.4 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00089 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.826 | 1655.7 samples/s | 25.9 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00067 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.827 | 5374.3 samples/s | 84.0 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00054 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.827 | 1712.2 samples/s | 26.8 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00045 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.827 | 4818.0 samples/s | 75.3 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.827 | 1781.9 samples/s | 27.8 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.828 | 4674.5 samples/s | 73.0 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.828 | 1762.6 samples/s | 27.5 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.828 | 4408.3 samples/s | 68.9 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.828 | 1828.3 samples/s | 28.6 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.828 | 4241.8 samples/s | 66.3 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.828 | 1879.9 samples/s | 29.4 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.828 | 4088.8 samples/s | 63.9 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.829 | 1890.4 samples/s | 29.5 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.829 | 4064.8 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step33600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=309.1] | Loss=0.03013 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3786.4 samples/s | 59.2 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00223 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.824 | 3806.2 samples/s | 59.5 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00113 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.826 | 5467.4 samples/s | 85.4 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00076 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.827 | 1667.3 samples/s | 26.1 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.827 | 4981.7 samples/s | 77.8 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.828 | 1749.4 samples/s | 27.3 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00038 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.828 | 4595.3 samples/s | 71.8 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00033 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.828 | 1773.4 samples/s | 27.7 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.828 | 4198.4 samples/s | 65.6 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.828 | 1827.2 samples/s | 28.5 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.828 | 4160.9 samples/s | 65.0 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.829 | 1879.2 samples/s | 29.4 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.829 | 4116.9 samples/s | 64.3 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.829 | 1890.6 samples/s | 29.5 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.829 | 3961.6 samples/s | 61.9 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.829 | 1941.9 samples/s | 30.3 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.829 | 3849.2 samples/s | 60.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step33600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.6] | Loss=0.02390 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.150 | L2-Norm(final)=3.817 | 3819.8 samples/s | 59.7 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00172 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.822 | 3746.3 samples/s | 58.5 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00087 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.823 | 5677.5 samples/s | 88.7 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00058 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.824 | 1690.7 samples/s | 26.4 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.824 | 5100.5 samples/s | 79.7 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.824 | 1697.2 samples/s | 26.5 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.824 | 4906.0 samples/s | 76.7 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.824 | 1729.7 samples/s | 27.0 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.825 | 4530.1 samples/s | 70.8 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.825 | 1786.2 samples/s | 27.9 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.825 | 4322.2 samples/s | 67.5 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.825 | 1815.0 samples/s | 28.4 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.825 | 4221.0 samples/s | 66.0 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.825 | 1829.7 samples/s | 28.6 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.825 | 4086.0 samples/s | 63.8 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.825 | 1872.3 samples/s | 29.3 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.826 | 4068.5 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24116 | acc=0.8923 | tpr=0.8489 | fpr=0.0134 | 3790.0 samples/s | 14.8 steps/s
Avg test loss: 0.24066, Avg test acc: 0.89334, Avg tpr: 0.85143, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.38439 | acc=0.9016 | tpr=0.9425 | fpr=0.0991 | 3812.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.39094 | acc=0.9029 | tpr=0.9616 | fpr=0.0982 | 7325.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.39746 | acc=0.9015 | tpr=0.9625 | fpr=0.0996 | 6799.8 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.39727 | acc=0.9011 | tpr=0.9628 | fpr=0.1001 | 7280.8 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.39421 | acc=0.9018 | tpr=0.9624 | fpr=0.0993 | 7082.6 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.39632 | acc=0.9016 | tpr=0.9644 | fpr=0.0995 | 7046.1 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.39963 | acc=0.9009 | tpr=0.9637 | fpr=0.1002 | 7101.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.40136 | acc=0.9010 | tpr=0.9633 | fpr=0.1002 | 7538.3 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.40491 | acc=0.9008 | tpr=0.9654 | fpr=0.1003 | 6607.2 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.40496 | acc=0.9004 | tpr=0.9670 | fpr=0.1008 | 7370.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.40275 | acc=0.9009 | tpr=0.9666 | fpr=0.1003 | 13213.7 samples/s | 51.6 steps/s
Avg test loss: 0.40241, Avg test acc: 0.90089, Avg tpr: 0.96593, Avg fpr: 0.10030, total FA: 13926

server round 42/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.8] | Loss=0.07461 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 4038.4 samples/s | 63.1 steps/s
[Step=33650 Epoch=164.1] | Loss=0.01782 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.839 | 3833.0 samples/s | 59.9 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01272 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.838 | 4273.3 samples/s | 66.8 steps/s
[Step=33750 Epoch=164.6] | Loss=0.01082 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.838 | 4228.8 samples/s | 66.1 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00974 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.839 | 5831.6 samples/s | 91.1 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00836 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.840 | 1718.6 samples/s | 26.9 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00763 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.841 | 4140.5 samples/s | 64.7 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00697 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.170 | L2-Norm(final)=3.842 | 4163.4 samples/s | 65.1 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00659 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.844 | 5473.6 samples/s | 85.5 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00617 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.845 | 1789.7 samples/s | 28.0 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00586 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.846 | 4231.0 samples/s | 66.1 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00566 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.173 | L2-Norm(final)=3.847 | 4371.9 samples/s | 68.3 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00537 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.849 | 5047.4 samples/s | 78.9 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00514 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.850 | 1839.8 samples/s | 28.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00502 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.851 | 4349.2 samples/s | 68.0 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00489 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.176 | L2-Norm(final)=3.853 | 4182.3 samples/s | 65.3 steps/s
[Step=34400 Epoch=167.7] | Loss=0.00471 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.854 | 4629.9 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.0] | Loss=0.01233 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 4062.7 samples/s | 63.5 steps/s
[Step=33650 Epoch=164.2] | Loss=0.02113 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.836 | 4259.5 samples/s | 66.6 steps/s
[Step=33700 Epoch=164.4] | Loss=0.01359 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.836 | 4373.5 samples/s | 68.3 steps/s
[Step=33750 Epoch=164.7] | Loss=0.01092 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.837 | 4400.0 samples/s | 68.7 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00932 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.168 | L2-Norm(final)=3.839 | 5961.9 samples/s | 93.2 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00797 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.840 | 1747.8 samples/s | 27.3 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00705 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.842 | 4423.6 samples/s | 69.1 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00656 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.843 | 4303.2 samples/s | 67.2 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00606 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.844 | 5584.1 samples/s | 87.3 steps/s
[Step=34050 Epoch=166.1] | Loss=0.00560 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.846 | 1786.6 samples/s | 27.9 steps/s
[Step=34100 Epoch=166.4] | Loss=0.00524 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.847 | 4237.8 samples/s | 66.2 steps/s
[Step=34150 Epoch=166.6] | Loss=0.00498 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.848 | 4335.8 samples/s | 67.7 steps/s
[Step=34200 Epoch=166.9] | Loss=0.00481 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.850 | 5240.5 samples/s | 81.9 steps/s
[Step=34250 Epoch=167.1] | Loss=0.00460 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.851 | 1833.8 samples/s | 28.7 steps/s
[Step=34300 Epoch=167.4] | Loss=0.00441 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.852 | 4509.1 samples/s | 70.5 steps/s
[Step=34350 Epoch=167.6] | Loss=0.00426 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.854 | 4284.5 samples/s | 66.9 steps/s
[Step=34400 Epoch=167.9] | Loss=0.00418 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.855 | 4927.0 samples/s | 77.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step34400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.7] | Loss=0.11269 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3817.2 samples/s | 59.6 steps/s
[Step=33650 Epoch=164.0] | Loss=0.01503 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.838 | 4120.7 samples/s | 64.4 steps/s
[Step=33700 Epoch=164.2] | Loss=0.01126 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.839 | 4395.0 samples/s | 68.7 steps/s
[Step=33750 Epoch=164.4] | Loss=0.00947 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.839 | 4297.7 samples/s | 67.2 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00861 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.840 | 5859.2 samples/s | 91.5 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00755 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.842 | 1791.8 samples/s | 28.0 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00675 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.843 | 4339.1 samples/s | 67.8 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00619 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.844 | 4339.5 samples/s | 67.8 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00589 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.846 | 5430.7 samples/s | 84.9 steps/s
[Step=34050 Epoch=165.9] | Loss=0.00549 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.847 | 1783.1 samples/s | 27.9 steps/s
[Step=34100 Epoch=166.2] | Loss=0.00519 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.849 | 4184.1 samples/s | 65.4 steps/s
[Step=34150 Epoch=166.4] | Loss=0.00494 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.850 | 4281.5 samples/s | 66.9 steps/s
[Step=34200 Epoch=166.6] | Loss=0.00481 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.851 | 5048.4 samples/s | 78.9 steps/s
[Step=34250 Epoch=166.9] | Loss=0.00463 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.177 | L2-Norm(final)=3.853 | 1834.3 samples/s | 28.7 steps/s
[Step=34300 Epoch=167.1] | Loss=0.00445 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.854 | 4315.3 samples/s | 67.4 steps/s
[Step=34350 Epoch=167.4] | Loss=0.00435 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.855 | 4321.5 samples/s | 67.5 steps/s
[Step=34400 Epoch=167.6] | Loss=0.00426 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.857 | 4742.4 samples/s | 74.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step34400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.9] | Loss=0.16745 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3834.8 samples/s | 59.9 steps/s
[Step=33650 Epoch=164.1] | Loss=0.02046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.837 | 4118.7 samples/s | 64.4 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01322 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.165 | L2-Norm(final)=3.837 | 4355.5 samples/s | 68.1 steps/s
[Step=33750 Epoch=164.6] | Loss=0.01029 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.168 | L2-Norm(final)=3.838 | 4243.5 samples/s | 66.3 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00927 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.839 | 5562.8 samples/s | 86.9 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00798 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.840 | 1744.4 samples/s | 27.3 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00702 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.842 | 4367.1 samples/s | 68.2 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00670 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.843 | 4294.5 samples/s | 67.1 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00611 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.844 | 5396.9 samples/s | 84.3 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00567 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.845 | 1785.3 samples/s | 27.9 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00530 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.847 | 4321.5 samples/s | 67.5 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00515 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.848 | 4419.8 samples/s | 69.1 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.849 | 5119.1 samples/s | 80.0 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00473 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.177 | L2-Norm(final)=3.850 | 1809.6 samples/s | 28.3 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00455 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=3.851 | 4274.7 samples/s | 66.8 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00436 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.852 | 4346.4 samples/s | 67.9 steps/s
[Step=34400 Epoch=167.8] | Loss=0.00427 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=3.854 | 4764.0 samples/s | 74.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step34400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.8] | Loss=0.04975 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3904.2 samples/s | 61.0 steps/s
[Step=33650 Epoch=165.0] | Loss=0.01990 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.837 | 3873.2 samples/s | 60.5 steps/s
[Step=33700 Epoch=165.3] | Loss=0.01327 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.838 | 4217.8 samples/s | 65.9 steps/s
[Step=33750 Epoch=165.5] | Loss=0.01070 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.839 | 4330.8 samples/s | 67.7 steps/s
[Step=33800 Epoch=165.7] | Loss=0.00941 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.840 | 5881.8 samples/s | 91.9 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00809 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.841 | 1727.7 samples/s | 27.0 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00733 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.842 | 4293.3 samples/s | 67.1 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00665 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.843 | 4262.3 samples/s | 66.6 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00617 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.844 | 5551.5 samples/s | 86.7 steps/s
[Step=34050 Epoch=167.0] | Loss=0.00573 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.845 | 1765.3 samples/s | 27.6 steps/s
[Step=34100 Epoch=167.2] | Loss=0.00547 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.174 | L2-Norm(final)=3.847 | 4251.3 samples/s | 66.4 steps/s
[Step=34150 Epoch=167.5] | Loss=0.00514 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.848 | 4298.8 samples/s | 67.2 steps/s
[Step=34200 Epoch=167.7] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.849 | 5486.7 samples/s | 85.7 steps/s
[Step=34250 Epoch=168.0] | Loss=0.00470 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.850 | 1777.6 samples/s | 27.8 steps/s
[Step=34300 Epoch=168.2] | Loss=0.00453 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.851 | 4235.5 samples/s | 66.2 steps/s
[Step=34350 Epoch=168.4] | Loss=0.00437 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.853 | 4135.8 samples/s | 64.6 steps/s
[Step=34400 Epoch=168.7] | Loss=0.00422 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.854 | 5115.6 samples/s | 79.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step34400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=318.4] | Loss=0.04883 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3600.5 samples/s | 56.3 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00364 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.846 | 3919.0 samples/s | 61.2 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00183 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.847 | 5530.9 samples/s | 86.4 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00123 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.848 | 1683.3 samples/s | 26.3 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00092 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.848 | 5151.3 samples/s | 80.5 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00074 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.848 | 1737.1 samples/s | 27.1 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00062 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.848 | 4905.9 samples/s | 76.7 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00053 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.849 | 1746.6 samples/s | 27.3 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.849 | 4410.0 samples/s | 68.9 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.849 | 1828.9 samples/s | 28.6 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00038 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.849 | 4193.1 samples/s | 65.5 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.849 | 1883.3 samples/s | 29.4 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.849 | 4036.9 samples/s | 63.1 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.849 | 1863.7 samples/s | 29.1 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.850 | 4066.9 samples/s | 63.5 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.850 | 1892.5 samples/s | 29.6 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.850 | 4065.7 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step34400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=319.6] | Loss=0.02199 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 4052.6 samples/s | 63.3 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00308 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.846 | 3584.2 samples/s | 56.0 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00155 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.847 | 5694.6 samples/s | 89.0 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00104 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.847 | 1701.4 samples/s | 26.6 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00078 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.848 | 5357.3 samples/s | 83.7 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.848 | 1726.7 samples/s | 27.0 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.848 | 4718.6 samples/s | 73.7 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00045 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.848 | 1780.5 samples/s | 27.8 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.848 | 4399.6 samples/s | 68.7 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.848 | 1820.0 samples/s | 28.4 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.848 | 4322.8 samples/s | 67.5 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.848 | 1877.8 samples/s | 29.3 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.849 | 4100.6 samples/s | 64.1 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.849 | 1847.1 samples/s | 28.9 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.849 | 4157.8 samples/s | 65.0 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.849 | 1908.2 samples/s | 29.8 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.849 | 4096.8 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step34400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.9] | Loss=0.02438 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3975.9 samples/s | 62.1 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00201 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.847 | 3628.5 samples/s | 56.7 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00102 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.848 | 5716.6 samples/s | 89.3 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00068 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.849 | 1658.0 samples/s | 25.9 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.849 | 5327.5 samples/s | 83.2 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.849 | 1688.2 samples/s | 26.4 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.849 | 4975.2 samples/s | 77.7 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.850 | 1767.9 samples/s | 27.6 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.850 | 4730.1 samples/s | 73.9 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.850 | 1810.0 samples/s | 28.3 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.850 | 4219.2 samples/s | 65.9 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.850 | 1825.9 samples/s | 28.5 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.850 | 4235.8 samples/s | 66.2 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.850 | 1883.3 samples/s | 29.4 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.850 | 4219.2 samples/s | 65.9 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.851 | 1893.7 samples/s | 29.6 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.851 | 4173.6 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step34400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=316.6] | Loss=0.10909 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3957.7 samples/s | 61.8 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00491 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.844 | 3665.9 samples/s | 57.3 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00247 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.845 | 5523.0 samples/s | 86.3 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00165 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.846 | 1709.2 samples/s | 26.7 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00124 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.846 | 5118.0 samples/s | 80.0 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00099 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.846 | 1732.9 samples/s | 27.1 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00083 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.846 | 4638.3 samples/s | 72.5 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00071 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.846 | 1798.0 samples/s | 28.1 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00062 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.846 | 4382.9 samples/s | 68.5 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.846 | 1844.6 samples/s | 28.8 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00050 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.846 | 4096.4 samples/s | 64.0 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.847 | 1880.2 samples/s | 29.4 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.847 | 4070.3 samples/s | 63.6 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.847 | 1944.0 samples/s | 30.4 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.847 | 4151.6 samples/s | 64.9 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.847 | 1978.1 samples/s | 30.9 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.847 | 3679.5 samples/s | 57.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step34400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.2] | Loss=0.04189 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.145 | L2-Norm(final)=3.840 | 3332.1 samples/s | 52.1 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00182 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.845 | 2009.6 samples/s | 31.4 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00093 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.846 | 5107.9 samples/s | 79.8 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00062 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.847 | 1664.7 samples/s | 26.0 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.847 | 5396.8 samples/s | 84.3 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00038 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.847 | 1738.3 samples/s | 27.2 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.847 | 4940.4 samples/s | 77.2 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.847 | 1704.9 samples/s | 26.6 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.848 | 4654.1 samples/s | 72.7 steps/s
[Step=34050 Epoch=324.5] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.848 | 1821.5 samples/s | 28.5 steps/s
[Step=34100 Epoch=325.0] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.848 | 4461.4 samples/s | 69.7 steps/s
[Step=34150 Epoch=325.5] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.848 | 1823.5 samples/s | 28.5 steps/s
[Step=34200 Epoch=326.0] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.848 | 4164.8 samples/s | 65.1 steps/s
[Step=34250 Epoch=326.4] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.848 | 1868.9 samples/s | 29.2 steps/s
[Step=34300 Epoch=326.9] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.848 | 4127.8 samples/s | 64.5 steps/s
[Step=34350 Epoch=327.4] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.848 | 1905.9 samples/s | 29.8 steps/s
[Step=34400 Epoch=327.9] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.848 | 4247.2 samples/s | 66.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24915 | acc=0.8907 | tpr=0.8463 | fpr=0.0129 | 3632.6 samples/s | 14.2 steps/s
Avg test loss: 0.24773, Avg test acc: 0.89190, Avg tpr: 0.84916, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.37722 | acc=0.9073 | tpr=0.9425 | fpr=0.0933 | 4229.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.38411 | acc=0.9079 | tpr=0.9616 | fpr=0.0932 | 7848.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.39058 | acc=0.9061 | tpr=0.9625 | fpr=0.0949 | 8180.2 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.39041 | acc=0.9058 | tpr=0.9628 | fpr=0.0952 | 7977.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.38732 | acc=0.9062 | tpr=0.9616 | fpr=0.0948 | 8242.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.38943 | acc=0.9063 | tpr=0.9636 | fpr=0.0947 | 8206.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.39291 | acc=0.9055 | tpr=0.9631 | fpr=0.0955 | 7884.3 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.39466 | acc=0.9056 | tpr=0.9633 | fpr=0.0955 | 8280.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.39825 | acc=0.9055 | tpr=0.9654 | fpr=0.0956 | 8030.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.39819 | acc=0.9051 | tpr=0.9670 | fpr=0.0960 | 7604.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.39608 | acc=0.9057 | tpr=0.9666 | fpr=0.0955 | 13900.9 samples/s | 54.3 steps/s
Avg test loss: 0.39572, Avg test acc: 0.90566, Avg tpr: 0.96593, Avg fpr: 0.09544, total FA: 13251

server round 43/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.7] | Loss=0.06386 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3897.6 samples/s | 60.9 steps/s
[Step=34450 Epoch=168.0] | Loss=0.02168 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.858 | 4427.7 samples/s | 69.2 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01439 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.858 | 4509.6 samples/s | 70.5 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01210 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.164 | L2-Norm(final)=3.858 | 4490.9 samples/s | 70.2 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01042 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.165 | L2-Norm(final)=3.858 | 6019.0 samples/s | 94.0 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00929 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.859 | 1821.3 samples/s | 28.5 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00822 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.860 | 4526.0 samples/s | 70.7 steps/s
[Step=34750 Epoch=169.4] | Loss=0.00743 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.861 | 4526.2 samples/s | 70.7 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00693 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.862 | 5664.6 samples/s | 88.5 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00639 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.170 | L2-Norm(final)=3.863 | 1842.5 samples/s | 28.8 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00607 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.864 | 4564.5 samples/s | 71.3 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00575 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.865 | 4524.9 samples/s | 70.7 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00563 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.172 | L2-Norm(final)=3.866 | 5275.5 samples/s | 82.4 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00542 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.867 | 1911.9 samples/s | 29.9 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00518 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.868 | 4616.5 samples/s | 72.1 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00499 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.870 | 4544.7 samples/s | 71.0 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00486 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.871 | 4761.3 samples/s | 74.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.9] | Loss=0.10546 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3906.4 samples/s | 61.0 steps/s
[Step=34450 Epoch=168.1] | Loss=0.02020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.856 | 4371.4 samples/s | 68.3 steps/s
[Step=34500 Epoch=168.3] | Loss=0.01417 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.856 | 4525.1 samples/s | 70.7 steps/s
[Step=34550 Epoch=168.6] | Loss=0.01129 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.857 | 4522.6 samples/s | 70.7 steps/s
[Step=34600 Epoch=168.8] | Loss=0.00976 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.858 | 6067.4 samples/s | 94.8 steps/s
[Step=34650 Epoch=169.1] | Loss=0.00832 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.859 | 1820.7 samples/s | 28.4 steps/s
[Step=34700 Epoch=169.3] | Loss=0.00732 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.861 | 4493.1 samples/s | 70.2 steps/s
[Step=34750 Epoch=169.6] | Loss=0.00671 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.862 | 4499.7 samples/s | 70.3 steps/s
[Step=34800 Epoch=169.8] | Loss=0.00620 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.863 | 5756.2 samples/s | 89.9 steps/s
[Step=34850 Epoch=170.1] | Loss=0.00575 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.865 | 1866.8 samples/s | 29.2 steps/s
[Step=34900 Epoch=170.3] | Loss=0.00535 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.866 | 4530.7 samples/s | 70.8 steps/s
[Step=34950 Epoch=170.5] | Loss=0.00507 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.867 | 4479.3 samples/s | 70.0 steps/s
[Step=35000 Epoch=170.8] | Loss=0.00499 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.868 | 5394.0 samples/s | 84.3 steps/s
[Step=35050 Epoch=171.0] | Loss=0.00479 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.870 | 1905.0 samples/s | 29.8 steps/s
[Step=35100 Epoch=171.3] | Loss=0.00466 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.871 | 4462.5 samples/s | 69.7 steps/s
[Step=35150 Epoch=171.5] | Loss=0.00448 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.872 | 4457.5 samples/s | 69.6 steps/s
[Step=35200 Epoch=171.8] | Loss=0.00433 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.873 | 5091.8 samples/s | 79.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step35200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.6] | Loss=0.11347 | Reg=0.00147 | acc=0.9219 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 4006.3 samples/s | 62.6 steps/s
[Step=34450 Epoch=167.9] | Loss=0.02078 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.856 | 3888.8 samples/s | 60.8 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01308 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.856 | 4342.6 samples/s | 67.9 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01083 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.856 | 4568.8 samples/s | 71.4 steps/s
[Step=34600 Epoch=168.6] | Loss=0.00966 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.858 | 6019.8 samples/s | 94.1 steps/s
[Step=34650 Epoch=168.8] | Loss=0.00825 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.859 | 1821.6 samples/s | 28.5 steps/s
[Step=34700 Epoch=169.1] | Loss=0.00742 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.860 | 4528.3 samples/s | 70.8 steps/s
[Step=34750 Epoch=169.3] | Loss=0.00693 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.862 | 4541.3 samples/s | 71.0 steps/s
[Step=34800 Epoch=169.6] | Loss=0.00640 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.170 | L2-Norm(final)=3.863 | 5603.4 samples/s | 87.6 steps/s
[Step=34850 Epoch=169.8] | Loss=0.00605 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.171 | L2-Norm(final)=3.865 | 1880.4 samples/s | 29.4 steps/s
[Step=34900 Epoch=170.0] | Loss=0.00566 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.866 | 4485.2 samples/s | 70.1 steps/s
[Step=34950 Epoch=170.3] | Loss=0.00540 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.867 | 4549.6 samples/s | 71.1 steps/s
[Step=35000 Epoch=170.5] | Loss=0.00514 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.869 | 5152.6 samples/s | 80.5 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00498 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.870 | 1920.7 samples/s | 30.0 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00476 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.872 | 4536.1 samples/s | 70.9 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00458 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.873 | 4457.8 samples/s | 69.7 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00444 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=3.874 | 4904.1 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step35200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.8] | Loss=0.07760 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3953.6 samples/s | 61.8 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01977 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=3.859 | 4130.4 samples/s | 64.5 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01220 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.161 | L2-Norm(final)=3.859 | 4508.6 samples/s | 70.4 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.860 | 4520.0 samples/s | 70.6 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00894 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.861 | 6131.7 samples/s | 95.8 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00778 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.862 | 1737.7 samples/s | 27.2 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00716 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.863 | 4457.7 samples/s | 69.7 steps/s
[Step=34750 Epoch=169.5] | Loss=0.00678 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.864 | 4581.4 samples/s | 71.6 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00619 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.170 | L2-Norm(final)=3.865 | 5599.2 samples/s | 87.5 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00570 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.866 | 1874.3 samples/s | 29.3 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00539 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.868 | 4464.3 samples/s | 69.8 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00520 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.869 | 4512.4 samples/s | 70.5 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00500 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.870 | 5147.7 samples/s | 80.4 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00477 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.871 | 1909.8 samples/s | 29.8 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00460 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.872 | 4459.2 samples/s | 69.7 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00442 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.873 | 4517.8 samples/s | 70.6 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00425 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=3.874 | 4823.7 samples/s | 75.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step35200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=168.7] | Loss=0.09486 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3876.9 samples/s | 60.6 steps/s
[Step=34450 Epoch=168.9] | Loss=0.02318 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.857 | 4445.2 samples/s | 69.5 steps/s
[Step=34500 Epoch=169.2] | Loss=0.01457 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.856 | 4518.6 samples/s | 70.6 steps/s
[Step=34550 Epoch=169.4] | Loss=0.01182 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.857 | 4595.1 samples/s | 71.8 steps/s
[Step=34600 Epoch=169.7] | Loss=0.01002 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=3.858 | 5990.3 samples/s | 93.6 steps/s
[Step=34650 Epoch=169.9] | Loss=0.00852 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.859 | 1813.1 samples/s | 28.3 steps/s
[Step=34700 Epoch=170.2] | Loss=0.00770 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.860 | 4580.5 samples/s | 71.6 steps/s
[Step=34750 Epoch=170.4] | Loss=0.00702 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.861 | 4504.8 samples/s | 70.4 steps/s
[Step=34800 Epoch=170.7] | Loss=0.00643 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.862 | 5592.1 samples/s | 87.4 steps/s
[Step=34850 Epoch=170.9] | Loss=0.00592 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.864 | 1817.9 samples/s | 28.4 steps/s
[Step=34900 Epoch=171.1] | Loss=0.00551 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.865 | 4577.0 samples/s | 71.5 steps/s
[Step=34950 Epoch=171.4] | Loss=0.00523 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.866 | 4431.1 samples/s | 69.2 steps/s
[Step=35000 Epoch=171.6] | Loss=0.00498 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.867 | 5578.7 samples/s | 87.2 steps/s
[Step=35050 Epoch=171.9] | Loss=0.00486 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.868 | 1864.5 samples/s | 29.1 steps/s
[Step=35100 Epoch=172.1] | Loss=0.00463 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=3.870 | 4556.8 samples/s | 71.2 steps/s
[Step=35150 Epoch=172.4] | Loss=0.00446 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.871 | 4508.4 samples/s | 70.4 steps/s
[Step=35200 Epoch=172.6] | Loss=0.00428 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.872 | 5273.8 samples/s | 82.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step35200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=326.0] | Loss=0.01932 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.143 | L2-Norm(final)=3.862 | 4054.6 samples/s | 63.4 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00164 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.867 | 3849.7 samples/s | 60.2 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00084 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.868 | 5714.1 samples/s | 89.3 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.869 | 1785.6 samples/s | 27.9 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.869 | 5263.5 samples/s | 82.2 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.870 | 1775.5 samples/s | 27.7 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.870 | 4990.2 samples/s | 78.0 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.870 | 1837.8 samples/s | 28.7 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.870 | 4662.4 samples/s | 72.9 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.871 | 1873.4 samples/s | 29.3 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.871 | 4377.7 samples/s | 68.4 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.871 | 1947.1 samples/s | 30.4 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.871 | 4292.4 samples/s | 67.1 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.871 | 1963.4 samples/s | 30.7 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.871 | 4363.7 samples/s | 68.2 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.872 | 1962.2 samples/s | 30.7 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.872 | 4382.5 samples/s | 68.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step35200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.2] | Loss=0.05633 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3833.1 samples/s | 59.9 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00301 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.865 | 4109.0 samples/s | 64.2 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00152 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.866 | 5812.4 samples/s | 90.8 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00102 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.867 | 1755.9 samples/s | 27.4 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00077 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.867 | 5360.5 samples/s | 83.8 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.867 | 1733.3 samples/s | 27.1 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00051 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.867 | 4847.8 samples/s | 75.7 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.867 | 1847.0 samples/s | 28.9 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.868 | 4638.1 samples/s | 72.5 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.868 | 1753.9 samples/s | 27.4 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.868 | 4169.2 samples/s | 65.1 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.868 | 1824.9 samples/s | 28.5 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.868 | 3952.8 samples/s | 61.8 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.868 | 1889.0 samples/s | 29.5 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.868 | 4128.8 samples/s | 64.5 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.868 | 1934.7 samples/s | 30.2 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.869 | 4118.1 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step35200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=328.5] | Loss=0.03487 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.143 | L2-Norm(final)=3.862 | 3724.1 samples/s | 58.2 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00246 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.866 | 3996.6 samples/s | 62.4 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00125 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.867 | 5739.6 samples/s | 89.7 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00083 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.867 | 1676.4 samples/s | 26.2 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.868 | 5485.8 samples/s | 85.7 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00050 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.868 | 1743.8 samples/s | 27.2 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.868 | 5070.9 samples/s | 79.2 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.868 | 1785.8 samples/s | 27.9 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.868 | 4674.9 samples/s | 73.0 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.869 | 1828.7 samples/s | 28.6 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.869 | 4259.8 samples/s | 66.6 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.869 | 1810.9 samples/s | 28.3 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.869 | 4275.2 samples/s | 66.8 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.869 | 1894.5 samples/s | 29.6 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.869 | 4151.5 samples/s | 64.9 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.869 | 1877.4 samples/s | 29.3 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.869 | 4142.9 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step35200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=324.2] | Loss=0.00092 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3890.0 samples/s | 60.8 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00276 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.867 | 3777.7 samples/s | 59.0 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00140 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.869 | 5763.0 samples/s | 90.0 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00094 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.870 | 1735.2 samples/s | 27.1 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00071 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.870 | 5226.7 samples/s | 81.7 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.870 | 1800.8 samples/s | 28.1 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.871 | 4735.7 samples/s | 74.0 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.871 | 1847.2 samples/s | 28.9 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.871 | 4335.3 samples/s | 67.7 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.871 | 1878.0 samples/s | 29.3 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.871 | 4117.9 samples/s | 64.3 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.871 | 1951.8 samples/s | 30.5 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.871 | 4288.2 samples/s | 67.0 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.872 | 1906.4 samples/s | 29.8 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.872 | 4159.1 samples/s | 65.0 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.872 | 2015.5 samples/s | 31.5 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.872 | 3884.5 samples/s | 60.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step35200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.9] | Loss=0.00174 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.861 | 3778.0 samples/s | 59.0 steps/s
[Step=34450 Epoch=328.3] | Loss=0.00171 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.866 | 3981.0 samples/s | 62.2 steps/s
[Step=34500 Epoch=328.8] | Loss=0.00086 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.867 | 5725.2 samples/s | 89.5 steps/s
[Step=34550 Epoch=329.3] | Loss=0.00058 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.867 | 1717.1 samples/s | 26.8 steps/s
[Step=34600 Epoch=329.8] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.867 | 5340.9 samples/s | 83.5 steps/s
[Step=34650 Epoch=330.2] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.868 | 1745.7 samples/s | 27.3 steps/s
[Step=34700 Epoch=330.7] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.868 | 4915.3 samples/s | 76.8 steps/s
[Step=34750 Epoch=331.2] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.868 | 1722.4 samples/s | 26.9 steps/s
[Step=34800 Epoch=331.7] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.868 | 4699.7 samples/s | 73.4 steps/s
[Step=34850 Epoch=332.2] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.868 | 1826.6 samples/s | 28.5 steps/s
[Step=34900 Epoch=332.6] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.868 | 4455.0 samples/s | 69.6 steps/s
[Step=34950 Epoch=333.1] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.868 | 1846.5 samples/s | 28.9 steps/s
[Step=35000 Epoch=333.6] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.868 | 4254.4 samples/s | 66.5 steps/s
[Step=35050 Epoch=334.1] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.868 | 1840.1 samples/s | 28.8 steps/s
[Step=35100 Epoch=334.5] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.869 | 4317.6 samples/s | 67.5 steps/s
[Step=35150 Epoch=335.0] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.869 | 1923.3 samples/s | 30.1 steps/s
[Step=35200 Epoch=335.5] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.869 | 4266.9 samples/s | 66.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23423 | acc=0.8986 | tpr=0.8581 | fpr=0.0134 | 3826.8 samples/s | 14.9 steps/s
Avg test loss: 0.23310, Avg test acc: 0.89951, Avg tpr: 0.86029, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.40103 | acc=0.9005 | tpr=0.9425 | fpr=0.1003 | 3845.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40776 | acc=0.9005 | tpr=0.9616 | fpr=0.1006 | 7349.1 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.41428 | acc=0.8992 | tpr=0.9625 | fpr=0.1019 | 7524.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.41399 | acc=0.8988 | tpr=0.9617 | fpr=0.1024 | 7119.4 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.41084 | acc=0.8995 | tpr=0.9616 | fpr=0.1016 | 7117.4 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.41306 | acc=0.8994 | tpr=0.9636 | fpr=0.1018 | 7291.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.41657 | acc=0.8986 | tpr=0.9631 | fpr=0.1025 | 7258.3 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.41839 | acc=0.8986 | tpr=0.9633 | fpr=0.1025 | 7277.2 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.42201 | acc=0.8986 | tpr=0.9654 | fpr=0.1026 | 7030.4 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.42211 | acc=0.8982 | tpr=0.9670 | fpr=0.1030 | 7165.6 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.41991 | acc=0.8987 | tpr=0.9666 | fpr=0.1025 | 13159.0 samples/s | 51.4 steps/s
Avg test loss: 0.41955, Avg test acc: 0.89867, Avg tpr: 0.96593, Avg fpr: 0.10255, total FA: 14239

server round 44/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.6] | Loss=0.17731 | Reg=0.00147 | acc=0.8906 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3908.8 samples/s | 61.1 steps/s
[Step=35250 Epoch=171.9] | Loss=0.02089 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.155 | L2-Norm(final)=3.879 | 4010.2 samples/s | 62.7 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01363 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.879 | 4285.4 samples/s | 67.0 steps/s
[Step=35350 Epoch=172.4] | Loss=0.01106 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.879 | 4258.0 samples/s | 66.5 steps/s
[Step=35400 Epoch=172.6] | Loss=0.01012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.879 | 5818.6 samples/s | 90.9 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00888 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.880 | 1753.1 samples/s | 27.4 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00799 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.165 | L2-Norm(final)=3.881 | 4258.9 samples/s | 66.5 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00730 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=3.882 | 4298.7 samples/s | 67.2 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00677 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.883 | 5475.2 samples/s | 85.6 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00631 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.884 | 1808.3 samples/s | 28.3 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00599 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.885 | 4307.6 samples/s | 67.3 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00574 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.886 | 4235.1 samples/s | 66.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00547 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.169 | L2-Norm(final)=3.887 | 5083.5 samples/s | 79.4 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00526 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.888 | 1844.0 samples/s | 28.8 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00505 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.889 | 4276.1 samples/s | 66.8 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00488 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.890 | 4313.6 samples/s | 67.4 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00477 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.891 | 4755.3 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.8] | Loss=0.15238 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3882.3 samples/s | 60.7 steps/s
[Step=35250 Epoch=172.0] | Loss=0.02147 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.878 | 4265.6 samples/s | 66.6 steps/s
[Step=35300 Epoch=172.2] | Loss=0.01465 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.878 | 4147.0 samples/s | 64.8 steps/s
[Step=35350 Epoch=172.5] | Loss=0.01173 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.878 | 4210.0 samples/s | 65.8 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00989 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.879 | 5914.3 samples/s | 92.4 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00826 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.880 | 1720.9 samples/s | 26.9 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00729 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.882 | 4223.1 samples/s | 66.0 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00673 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=3.883 | 4270.6 samples/s | 66.7 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00631 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.884 | 5415.0 samples/s | 84.6 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00596 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.885 | 1764.2 samples/s | 27.6 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00561 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.886 | 4237.7 samples/s | 66.2 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00528 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.888 | 4291.4 samples/s | 67.1 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00507 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.889 | 5075.8 samples/s | 79.3 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00486 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.890 | 1834.2 samples/s | 28.7 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00470 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.891 | 4204.8 samples/s | 65.7 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00449 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.171 | L2-Norm(final)=3.892 | 4266.8 samples/s | 66.7 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00438 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.893 | 4800.5 samples/s | 75.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.5] | Loss=0.04936 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 4290.1 samples/s | 67.0 steps/s
[Step=35250 Epoch=171.8] | Loss=0.01710 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.879 | 3916.8 samples/s | 61.2 steps/s
[Step=35300 Epoch=172.0] | Loss=0.01167 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.879 | 4143.8 samples/s | 64.7 steps/s
[Step=35350 Epoch=172.2] | Loss=0.00957 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.880 | 4210.2 samples/s | 65.8 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00841 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.882 | 5725.2 samples/s | 89.5 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00727 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.884 | 1729.8 samples/s | 27.0 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00663 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.885 | 4231.1 samples/s | 66.1 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00614 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.887 | 4332.2 samples/s | 67.7 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00577 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.888 | 5421.9 samples/s | 84.7 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00537 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.889 | 1787.1 samples/s | 27.9 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00507 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.891 | 4253.1 samples/s | 66.5 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.892 | 4319.8 samples/s | 67.5 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00472 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.894 | 4945.1 samples/s | 77.3 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00457 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.895 | 1819.9 samples/s | 28.4 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00445 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.897 | 4223.5 samples/s | 66.0 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00429 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=3.898 | 4247.0 samples/s | 66.4 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00415 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=3.899 | 4587.1 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.7] | Loss=0.07132 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3830.7 samples/s | 59.9 steps/s
[Step=35250 Epoch=171.9] | Loss=0.02120 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.878 | 4110.1 samples/s | 64.2 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01329 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.878 | 4270.2 samples/s | 66.7 steps/s
[Step=35350 Epoch=172.4] | Loss=0.01067 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.879 | 4224.3 samples/s | 66.0 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00905 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.880 | 5880.4 samples/s | 91.9 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00776 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.881 | 1760.3 samples/s | 27.5 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00687 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.882 | 4299.3 samples/s | 67.2 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00623 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.883 | 4386.3 samples/s | 68.5 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00590 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.884 | 5518.7 samples/s | 86.2 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00558 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.886 | 1791.1 samples/s | 28.0 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00524 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.887 | 4327.2 samples/s | 67.6 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00499 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.888 | 4266.0 samples/s | 66.7 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00474 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.889 | 4972.8 samples/s | 77.7 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00459 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.890 | 1814.0 samples/s | 28.3 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00444 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.891 | 4360.6 samples/s | 68.1 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00429 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.892 | 4302.4 samples/s | 67.2 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00417 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.894 | 4751.3 samples/s | 74.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step36000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=172.6] | Loss=0.11874 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3995.1 samples/s | 62.4 steps/s
[Step=35250 Epoch=172.9] | Loss=0.01689 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.879 | 4186.8 samples/s | 65.4 steps/s
[Step=35300 Epoch=173.1] | Loss=0.01230 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.879 | 4316.1 samples/s | 67.4 steps/s
[Step=35350 Epoch=173.4] | Loss=0.01064 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.880 | 4277.2 samples/s | 66.8 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00913 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.159 | L2-Norm(final)=3.880 | 5848.5 samples/s | 91.4 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00784 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.881 | 1703.6 samples/s | 26.6 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00693 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.882 | 4311.2 samples/s | 67.4 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00656 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.883 | 4346.1 samples/s | 67.9 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00599 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.884 | 5722.9 samples/s | 89.4 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00560 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.885 | 1724.8 samples/s | 26.9 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00523 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.886 | 4191.4 samples/s | 65.5 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00501 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.887 | 4266.3 samples/s | 66.7 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00479 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.888 | 5322.4 samples/s | 83.2 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00459 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.889 | 1802.7 samples/s | 28.2 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00439 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.890 | 4302.0 samples/s | 67.2 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00424 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.891 | 4218.5 samples/s | 65.9 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00413 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.892 | 5056.9 samples/s | 79.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step36000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=333.6] | Loss=0.02982 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3873.4 samples/s | 60.5 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00335 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.887 | 3641.5 samples/s | 56.9 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00169 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.888 | 5535.1 samples/s | 86.5 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00113 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.889 | 1686.3 samples/s | 26.3 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00085 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.889 | 5025.8 samples/s | 78.5 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00068 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.889 | 1710.9 samples/s | 26.7 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.889 | 4621.2 samples/s | 72.2 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00049 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.890 | 1761.9 samples/s | 27.5 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.890 | 4396.3 samples/s | 68.7 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00038 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.890 | 1819.3 samples/s | 28.4 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.890 | 4174.9 samples/s | 65.2 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.890 | 1862.3 samples/s | 29.1 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.890 | 4187.7 samples/s | 65.4 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.890 | 1883.7 samples/s | 29.4 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.890 | 4192.7 samples/s | 65.5 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.890 | 1919.9 samples/s | 30.0 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.890 | 3959.5 samples/s | 61.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=334.8] | Loss=0.03271 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3770.9 samples/s | 58.9 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00370 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.887 | 3799.9 samples/s | 59.4 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00186 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.888 | 5619.2 samples/s | 87.8 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00124 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.888 | 1697.3 samples/s | 26.5 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00093 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.888 | 5134.6 samples/s | 80.2 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00075 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.889 | 1709.8 samples/s | 26.7 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00062 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.889 | 4754.6 samples/s | 74.3 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00054 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.889 | 1773.4 samples/s | 27.7 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.889 | 4491.2 samples/s | 70.2 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.889 | 1832.6 samples/s | 28.6 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00038 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.889 | 4246.3 samples/s | 66.3 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.889 | 1889.3 samples/s | 29.5 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.889 | 4173.0 samples/s | 65.2 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.889 | 1918.5 samples/s | 30.0 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.889 | 4197.6 samples/s | 65.6 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.889 | 1877.0 samples/s | 29.3 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.890 | 4107.8 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=336.1] | Loss=0.03000 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3794.6 samples/s | 59.3 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00147 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.886 | 3796.9 samples/s | 59.3 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00076 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.887 | 5592.3 samples/s | 87.4 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00051 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.887 | 1656.9 samples/s | 25.9 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.888 | 5205.1 samples/s | 81.3 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.888 | 1710.8 samples/s | 26.7 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.888 | 4937.7 samples/s | 77.2 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.888 | 1755.7 samples/s | 27.4 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.888 | 4596.8 samples/s | 71.8 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.889 | 1769.0 samples/s | 27.6 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.889 | 4302.1 samples/s | 67.2 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.889 | 1818.3 samples/s | 28.4 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.889 | 4105.7 samples/s | 64.2 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.889 | 1873.5 samples/s | 29.3 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.889 | 4047.1 samples/s | 63.2 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.889 | 1887.8 samples/s | 29.5 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.889 | 4067.7 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=331.7] | Loss=0.00081 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3831.7 samples/s | 59.9 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00277 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.887 | 3806.6 samples/s | 59.5 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00140 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.888 | 5574.9 samples/s | 87.1 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00094 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.889 | 1704.5 samples/s | 26.6 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00070 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.889 | 4988.2 samples/s | 77.9 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.889 | 1738.1 samples/s | 27.2 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.889 | 4575.0 samples/s | 71.5 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.890 | 1799.7 samples/s | 28.1 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.890 | 4281.2 samples/s | 66.9 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.890 | 1855.1 samples/s | 29.0 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.890 | 4072.1 samples/s | 63.6 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.890 | 1896.9 samples/s | 29.6 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.890 | 4170.9 samples/s | 65.2 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.890 | 1908.2 samples/s | 29.8 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.890 | 4167.6 samples/s | 65.1 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.891 | 1981.9 samples/s | 31.0 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.891 | 3661.2 samples/s | 57.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=335.5] | Loss=0.03341 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.139 | L2-Norm(final)=3.881 | 3941.4 samples/s | 61.6 steps/s
[Step=35250 Epoch=336.0] | Loss=0.00144 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.886 | 3772.4 samples/s | 58.9 steps/s
[Step=35300 Epoch=336.4] | Loss=0.00073 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.887 | 5667.4 samples/s | 88.6 steps/s
[Step=35350 Epoch=336.9] | Loss=0.00049 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.887 | 1677.1 samples/s | 26.2 steps/s
[Step=35400 Epoch=337.4] | Loss=0.00037 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.888 | 5212.1 samples/s | 81.4 steps/s
[Step=35450 Epoch=337.9] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.888 | 1713.8 samples/s | 26.8 steps/s
[Step=35500 Epoch=338.3] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.888 | 4840.1 samples/s | 75.6 steps/s
[Step=35550 Epoch=338.8] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.888 | 1744.8 samples/s | 27.3 steps/s
[Step=35600 Epoch=339.3] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.888 | 4676.7 samples/s | 73.1 steps/s
[Step=35650 Epoch=339.8] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.888 | 1776.2 samples/s | 27.8 steps/s
[Step=35700 Epoch=340.3] | Loss=0.00015 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.889 | 4404.0 samples/s | 68.8 steps/s
[Step=35750 Epoch=340.7] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.889 | 1823.1 samples/s | 28.5 steps/s
[Step=35800 Epoch=341.2] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.889 | 4161.5 samples/s | 65.0 steps/s
[Step=35850 Epoch=341.7] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.889 | 1867.3 samples/s | 29.2 steps/s
[Step=35900 Epoch=342.2] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.889 | 4134.6 samples/s | 64.6 steps/s
[Step=35950 Epoch=342.6] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.889 | 1889.3 samples/s | 29.5 steps/s
[Step=36000 Epoch=343.1] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.889 | 4102.5 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24803 | acc=0.8932 | tpr=0.8498 | fpr=0.0126 | 3797.2 samples/s | 14.8 steps/s
Avg test loss: 0.24697, Avg test acc: 0.89374, Avg tpr: 0.85166, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.37991 | acc=0.9084 | tpr=0.9425 | fpr=0.0922 | 3809.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.38687 | acc=0.9083 | tpr=0.9616 | fpr=0.0927 | 7197.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.39324 | acc=0.9067 | tpr=0.9625 | fpr=0.0944 | 7354.8 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.39297 | acc=0.9059 | tpr=0.9617 | fpr=0.0951 | 7122.4 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.38991 | acc=0.9065 | tpr=0.9616 | fpr=0.0945 | 7260.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.39204 | acc=0.9063 | tpr=0.9636 | fpr=0.0947 | 7128.2 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.39538 | acc=0.9055 | tpr=0.9631 | fpr=0.0955 | 7159.1 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.39719 | acc=0.9055 | tpr=0.9633 | fpr=0.0956 | 7321.8 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40079 | acc=0.9054 | tpr=0.9654 | fpr=0.0957 | 7015.8 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.40085 | acc=0.9051 | tpr=0.9670 | fpr=0.0961 | 6963.9 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.39875 | acc=0.9055 | tpr=0.9666 | fpr=0.0956 | 13911.6 samples/s | 54.3 steps/s
Avg test loss: 0.39840, Avg test acc: 0.90551, Avg tpr: 0.96593, Avg fpr: 0.09559, total FA: 13272

server round 45/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.07978 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3887.1 samples/s | 60.7 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02098 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.897 | 4057.4 samples/s | 63.4 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01394 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.897 | 4322.2 samples/s | 67.5 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01186 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.897 | 4373.0 samples/s | 68.3 steps/s
[Step=36200 Epoch=176.5] | Loss=0.01017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.898 | 5745.9 samples/s | 89.8 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00862 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.899 | 1749.7 samples/s | 27.3 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00768 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.900 | 4290.7 samples/s | 67.0 steps/s
[Step=36350 Epoch=177.2] | Loss=0.00730 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.162 | L2-Norm(final)=3.901 | 4307.2 samples/s | 67.3 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00683 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.902 | 5373.6 samples/s | 84.0 steps/s
[Step=36450 Epoch=177.7] | Loss=0.00630 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.903 | 1797.6 samples/s | 28.1 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00599 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.904 | 4277.8 samples/s | 66.8 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00571 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.905 | 4272.7 samples/s | 66.8 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00547 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.906 | 4957.1 samples/s | 77.5 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00520 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.908 | 1856.7 samples/s | 29.0 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00504 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.909 | 4372.3 samples/s | 68.3 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00491 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.910 | 4333.1 samples/s | 67.7 steps/s
[Step=36800 Epoch=179.4] | Loss=0.00474 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.911 | 4647.6 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.7] | Loss=0.03986 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3697.9 samples/s | 57.8 steps/s
[Step=36050 Epoch=175.9] | Loss=0.02103 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=3.898 | 4353.3 samples/s | 68.0 steps/s
[Step=36100 Epoch=176.2] | Loss=0.01350 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=3.897 | 4371.2 samples/s | 68.3 steps/s
[Step=36150 Epoch=176.4] | Loss=0.01065 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.898 | 4389.7 samples/s | 68.6 steps/s
[Step=36200 Epoch=176.6] | Loss=0.00939 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.899 | 5988.2 samples/s | 93.6 steps/s
[Step=36250 Epoch=176.9] | Loss=0.00804 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.900 | 1764.3 samples/s | 27.6 steps/s
[Step=36300 Epoch=177.1] | Loss=0.00740 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.901 | 4315.9 samples/s | 67.4 steps/s
[Step=36350 Epoch=177.4] | Loss=0.00669 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.902 | 4237.3 samples/s | 66.2 steps/s
[Step=36400 Epoch=177.6] | Loss=0.00605 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.903 | 5531.3 samples/s | 86.4 steps/s
[Step=36450 Epoch=177.9] | Loss=0.00561 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.165 | L2-Norm(final)=3.905 | 1768.9 samples/s | 27.6 steps/s
[Step=36500 Epoch=178.1] | Loss=0.00528 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.906 | 4296.8 samples/s | 67.1 steps/s
[Step=36550 Epoch=178.3] | Loss=0.00500 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.907 | 4258.9 samples/s | 66.5 steps/s
[Step=36600 Epoch=178.6] | Loss=0.00475 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.908 | 5136.3 samples/s | 80.3 steps/s
[Step=36650 Epoch=178.8] | Loss=0.00455 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.909 | 1811.0 samples/s | 28.3 steps/s
[Step=36700 Epoch=179.1] | Loss=0.00437 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.168 | L2-Norm(final)=3.911 | 4196.2 samples/s | 65.6 steps/s
[Step=36750 Epoch=179.3] | Loss=0.00428 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.912 | 4262.5 samples/s | 66.6 steps/s
[Step=36800 Epoch=179.6] | Loss=0.00415 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.913 | 4761.2 samples/s | 74.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step36800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.4] | Loss=0.14496 | Reg=0.00147 | acc=0.9219 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 4009.3 samples/s | 62.6 steps/s
[Step=36050 Epoch=175.7] | Loss=0.01820 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.898 | 3961.3 samples/s | 61.9 steps/s
[Step=36100 Epoch=175.9] | Loss=0.01244 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.898 | 4328.4 samples/s | 67.6 steps/s
[Step=36150 Epoch=176.1] | Loss=0.01007 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=3.899 | 4306.7 samples/s | 67.3 steps/s
[Step=36200 Epoch=176.4] | Loss=0.00868 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.159 | L2-Norm(final)=3.901 | 5749.9 samples/s | 89.8 steps/s
[Step=36250 Epoch=176.6] | Loss=0.00784 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.161 | L2-Norm(final)=3.902 | 1742.6 samples/s | 27.2 steps/s
[Step=36300 Epoch=176.9] | Loss=0.00699 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.903 | 4341.3 samples/s | 67.8 steps/s
[Step=36350 Epoch=177.1] | Loss=0.00650 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.905 | 4238.2 samples/s | 66.2 steps/s
[Step=36400 Epoch=177.4] | Loss=0.00598 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.906 | 5445.3 samples/s | 85.1 steps/s
[Step=36450 Epoch=177.6] | Loss=0.00558 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.908 | 1789.7 samples/s | 28.0 steps/s
[Step=36500 Epoch=177.8] | Loss=0.00530 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.909 | 4260.5 samples/s | 66.6 steps/s
[Step=36550 Epoch=178.1] | Loss=0.00502 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.910 | 4240.7 samples/s | 66.3 steps/s
[Step=36600 Epoch=178.3] | Loss=0.00487 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.912 | 4983.0 samples/s | 77.9 steps/s
[Step=36650 Epoch=178.6] | Loss=0.00464 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.913 | 1834.9 samples/s | 28.7 steps/s
[Step=36700 Epoch=178.8] | Loss=0.00448 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.914 | 4338.4 samples/s | 67.8 steps/s
[Step=36750 Epoch=179.1] | Loss=0.00433 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.916 | 4227.4 samples/s | 66.1 steps/s
[Step=36800 Epoch=179.3] | Loss=0.00422 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.917 | 4685.6 samples/s | 73.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step36800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.6] | Loss=0.16721 | Reg=0.00147 | acc=0.8750 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3752.7 samples/s | 58.6 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01642 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.899 | 4147.1 samples/s | 64.8 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01132 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=3.899 | 4193.8 samples/s | 65.5 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00902 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.900 | 4218.1 samples/s | 65.9 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00795 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.901 | 5642.2 samples/s | 88.2 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00696 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.902 | 1760.3 samples/s | 27.5 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00626 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.903 | 4153.0 samples/s | 64.9 steps/s
[Step=36350 Epoch=177.3] | Loss=0.00576 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.904 | 4217.8 samples/s | 65.9 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00537 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.905 | 5323.9 samples/s | 83.2 steps/s
[Step=36450 Epoch=177.8] | Loss=0.00506 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.907 | 1795.6 samples/s | 28.1 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00481 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.908 | 4260.8 samples/s | 66.6 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00466 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.909 | 4265.0 samples/s | 66.6 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00442 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.910 | 4958.4 samples/s | 77.5 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00421 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.911 | 1839.4 samples/s | 28.7 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00407 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=3.912 | 4278.2 samples/s | 66.8 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00396 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=3.913 | 4180.7 samples/s | 65.3 steps/s
[Step=36800 Epoch=179.5] | Loss=0.00386 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=3.914 | 4638.1 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step36800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=176.5] | Loss=0.11090 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3960.7 samples/s | 61.9 steps/s
[Step=36050 Epoch=176.8] | Loss=0.02029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.897 | 3933.8 samples/s | 61.5 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01318 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.897 | 4242.9 samples/s | 66.3 steps/s
[Step=36150 Epoch=177.3] | Loss=0.01158 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=3.898 | 4226.0 samples/s | 66.0 steps/s
[Step=36200 Epoch=177.5] | Loss=0.00955 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.899 | 5910.3 samples/s | 92.3 steps/s
[Step=36250 Epoch=177.8] | Loss=0.00820 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.900 | 1715.9 samples/s | 26.8 steps/s
[Step=36300 Epoch=178.0] | Loss=0.00730 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.901 | 4343.4 samples/s | 67.9 steps/s
[Step=36350 Epoch=178.3] | Loss=0.00658 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.161 | L2-Norm(final)=3.902 | 4266.6 samples/s | 66.7 steps/s
[Step=36400 Epoch=178.5] | Loss=0.00611 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.903 | 5595.9 samples/s | 87.4 steps/s
[Step=36450 Epoch=178.7] | Loss=0.00582 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.904 | 1797.5 samples/s | 28.1 steps/s
[Step=36500 Epoch=179.0] | Loss=0.00546 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.905 | 4196.9 samples/s | 65.6 steps/s
[Step=36550 Epoch=179.2] | Loss=0.00518 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.163 | L2-Norm(final)=3.906 | 4285.1 samples/s | 67.0 steps/s
[Step=36600 Epoch=179.5] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.907 | 5246.4 samples/s | 82.0 steps/s
[Step=36650 Epoch=179.7] | Loss=0.00464 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.908 | 1797.0 samples/s | 28.1 steps/s
[Step=36700 Epoch=180.0] | Loss=0.00444 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.910 | 4317.9 samples/s | 67.5 steps/s
[Step=36750 Epoch=180.2] | Loss=0.00427 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.911 | 4361.0 samples/s | 68.1 steps/s
[Step=36800 Epoch=180.5] | Loss=0.00417 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.912 | 5101.7 samples/s | 79.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step36800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.00142 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3778.1 samples/s | 59.0 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00134 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.906 | 3931.1 samples/s | 61.4 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00070 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.908 | 5586.8 samples/s | 87.3 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00048 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.909 | 1713.7 samples/s | 26.8 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.909 | 5205.2 samples/s | 81.3 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.909 | 1720.6 samples/s | 26.9 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.910 | 4699.1 samples/s | 73.4 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.910 | 1816.4 samples/s | 28.4 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.910 | 4386.8 samples/s | 68.5 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.910 | 1828.7 samples/s | 28.6 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.910 | 4157.6 samples/s | 65.0 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.911 | 1872.0 samples/s | 29.2 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.911 | 4159.6 samples/s | 65.0 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.911 | 1904.7 samples/s | 29.8 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.911 | 4112.3 samples/s | 64.3 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.911 | 1915.5 samples/s | 29.9 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.911 | 4094.2 samples/s | 64.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step36800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=342.5] | Loss=0.03629 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3725.1 samples/s | 58.2 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00147 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.907 | 3857.4 samples/s | 60.3 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00082 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.908 | 5658.6 samples/s | 88.4 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.909 | 1704.3 samples/s | 26.6 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00042 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.910 | 5125.6 samples/s | 80.1 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.910 | 1729.1 samples/s | 27.0 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.911 | 4806.2 samples/s | 75.1 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.911 | 1785.4 samples/s | 27.9 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.911 | 4451.7 samples/s | 69.6 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.911 | 1852.0 samples/s | 28.9 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.911 | 4148.1 samples/s | 64.8 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00016 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.912 | 1896.6 samples/s | 29.6 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.912 | 4028.0 samples/s | 62.9 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.912 | 1914.8 samples/s | 29.9 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.912 | 4164.0 samples/s | 65.1 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.912 | 1909.1 samples/s | 29.8 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.912 | 4079.6 samples/s | 63.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step36800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.8] | Loss=0.02818 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 4039.5 samples/s | 63.1 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00156 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.905 | 3623.1 samples/s | 56.6 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00079 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.906 | 5705.6 samples/s | 89.1 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00053 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.906 | 1665.9 samples/s | 26.0 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00040 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.907 | 5312.8 samples/s | 83.0 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00032 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.907 | 1698.2 samples/s | 26.5 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.907 | 5010.0 samples/s | 78.3 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.907 | 1750.7 samples/s | 27.4 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.907 | 4555.2 samples/s | 71.2 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.907 | 1775.7 samples/s | 27.7 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.908 | 4221.7 samples/s | 66.0 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.908 | 1838.1 samples/s | 28.7 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.908 | 4328.3 samples/s | 67.6 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.908 | 1887.7 samples/s | 29.5 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.908 | 4162.1 samples/s | 65.0 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.908 | 1881.2 samples/s | 29.4 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.908 | 4070.0 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step36800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=339.2] | Loss=0.02299 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3952.8 samples/s | 61.8 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00300 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.907 | 3713.4 samples/s | 58.0 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00152 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.908 | 5665.4 samples/s | 88.5 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00102 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.908 | 1688.0 samples/s | 26.4 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00076 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.909 | 4970.9 samples/s | 77.7 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.909 | 1755.0 samples/s | 27.4 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00051 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.909 | 4462.0 samples/s | 69.7 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.909 | 1796.8 samples/s | 28.1 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00039 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.909 | 4196.5 samples/s | 65.6 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00034 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.909 | 1843.8 samples/s | 28.8 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.909 | 3992.1 samples/s | 62.4 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.910 | 1870.4 samples/s | 29.2 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.910 | 4105.2 samples/s | 64.1 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.910 | 1887.3 samples/s | 29.5 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.910 | 4042.0 samples/s | 63.2 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.910 | 2028.6 samples/s | 31.7 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.910 | 3584.7 samples/s | 56.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step36800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.1] | Loss=0.04237 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.137 | L2-Norm(final)=3.901 | 3753.9 samples/s | 58.7 steps/s
[Step=36050 Epoch=343.6] | Loss=0.00270 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.905 | 3793.1 samples/s | 59.3 steps/s
[Step=36100 Epoch=344.1] | Loss=0.00136 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.905 | 5514.9 samples/s | 86.2 steps/s
[Step=36150 Epoch=344.5] | Loss=0.00091 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.906 | 1685.4 samples/s | 26.3 steps/s
[Step=36200 Epoch=345.0] | Loss=0.00069 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.906 | 5270.3 samples/s | 82.3 steps/s
[Step=36250 Epoch=345.5] | Loss=0.00055 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.906 | 1723.6 samples/s | 26.9 steps/s
[Step=36300 Epoch=346.0] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.906 | 4919.2 samples/s | 76.9 steps/s
[Step=36350 Epoch=346.4] | Loss=0.00040 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.906 | 1756.1 samples/s | 27.4 steps/s
[Step=36400 Epoch=346.9] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.906 | 4639.5 samples/s | 72.5 steps/s
[Step=36450 Epoch=347.4] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.907 | 1768.7 samples/s | 27.6 steps/s
[Step=36500 Epoch=347.9] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.907 | 4326.8 samples/s | 67.6 steps/s
[Step=36550 Epoch=348.4] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.907 | 1842.4 samples/s | 28.8 steps/s
[Step=36600 Epoch=348.8] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.907 | 4081.1 samples/s | 63.8 steps/s
[Step=36650 Epoch=349.3] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.907 | 1883.2 samples/s | 29.4 steps/s
[Step=36700 Epoch=349.8] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.907 | 4086.8 samples/s | 63.9 steps/s
[Step=36750 Epoch=350.3] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.907 | 1893.1 samples/s | 29.6 steps/s
[Step=36800 Epoch=350.7] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.907 | 4072.2 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21950 | acc=0.9048 | tpr=0.8673 | fpr=0.0136 | 3806.9 samples/s | 14.9 steps/s
Avg test loss: 0.21907, Avg test acc: 0.90508, Avg tpr: 0.86880, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.40725 | acc=0.8984 | tpr=0.9425 | fpr=0.1024 | 3884.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.41383 | acc=0.8998 | tpr=0.9616 | fpr=0.1014 | 6971.7 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.42070 | acc=0.8982 | tpr=0.9625 | fpr=0.1030 | 7276.1 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.42059 | acc=0.8975 | tpr=0.9617 | fpr=0.1036 | 7341.2 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.41731 | acc=0.8983 | tpr=0.9616 | fpr=0.1029 | 7173.1 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.41962 | acc=0.8982 | tpr=0.9636 | fpr=0.1030 | 7032.9 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.42313 | acc=0.8976 | tpr=0.9631 | fpr=0.1036 | 7383.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.42489 | acc=0.8977 | tpr=0.9633 | fpr=0.1035 | 7094.7 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.42853 | acc=0.8975 | tpr=0.9654 | fpr=0.1037 | 7233.6 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.42868 | acc=0.8971 | tpr=0.9670 | fpr=0.1042 | 7119.0 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.42645 | acc=0.8975 | tpr=0.9666 | fpr=0.1037 | 12392.6 samples/s | 48.4 steps/s
Avg test loss: 0.42608, Avg test acc: 0.89754, Avg tpr: 0.96593, Avg fpr: 0.10370, total FA: 14399

server round 46/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.4] | Loss=0.16443 | Reg=0.00147 | acc=0.8906 | L2-Norm=12.134 | L2-Norm(final)=3.920 | 3758.6 samples/s | 58.7 steps/s
[Step=36850 Epoch=179.7] | Loss=0.02109 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.917 | 4112.0 samples/s | 64.3 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01459 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=3.916 | 4252.4 samples/s | 66.4 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01171 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.916 | 4239.1 samples/s | 66.2 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00983 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.159 | L2-Norm(final)=3.917 | 5775.6 samples/s | 90.2 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00857 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.918 | 1727.5 samples/s | 27.0 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00758 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.919 | 4219.9 samples/s | 65.9 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00694 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.920 | 4179.5 samples/s | 65.3 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00652 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.921 | 5339.6 samples/s | 83.4 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00609 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.164 | L2-Norm(final)=3.922 | 1788.2 samples/s | 27.9 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00582 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.922 | 4214.2 samples/s | 65.8 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00556 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.923 | 4293.0 samples/s | 67.1 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00531 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.924 | 4955.9 samples/s | 77.4 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00506 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.925 | 1841.3 samples/s | 28.8 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.926 | 4345.0 samples/s | 67.9 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00469 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=3.927 | 4311.1 samples/s | 67.4 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00458 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.928 | 4649.9 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.6] | Loss=0.10156 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.134 | L2-Norm(final)=3.920 | 3974.2 samples/s | 62.1 steps/s
[Step=36850 Epoch=179.8] | Loss=0.02148 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.915 | 4066.0 samples/s | 63.5 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01406 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.916 | 4229.3 samples/s | 66.1 steps/s
[Step=36950 Epoch=180.3] | Loss=0.01101 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.917 | 4244.9 samples/s | 66.3 steps/s
[Step=37000 Epoch=180.5] | Loss=0.00954 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.918 | 5812.2 samples/s | 90.8 steps/s
[Step=37050 Epoch=180.8] | Loss=0.00817 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.919 | 1738.9 samples/s | 27.2 steps/s
[Step=37100 Epoch=181.0] | Loss=0.00720 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.920 | 4193.0 samples/s | 65.5 steps/s
[Step=37150 Epoch=181.3] | Loss=0.00661 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.921 | 4213.0 samples/s | 65.8 steps/s
[Step=37200 Epoch=181.5] | Loss=0.00610 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.159 | L2-Norm(final)=3.922 | 5395.1 samples/s | 84.3 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00574 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.924 | 1763.8 samples/s | 27.6 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00541 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.925 | 4291.8 samples/s | 67.1 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00507 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.926 | 4211.4 samples/s | 65.8 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00485 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.927 | 5198.6 samples/s | 81.2 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00466 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.928 | 1834.9 samples/s | 28.7 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00451 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.930 | 4254.9 samples/s | 66.5 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00438 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.931 | 4372.7 samples/s | 68.3 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00422 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.932 | 4840.2 samples/s | 75.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step37600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.3] | Loss=0.05566 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 3975.0 samples/s | 62.1 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01499 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.149 | L2-Norm(final)=3.919 | 4050.0 samples/s | 63.3 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01090 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.153 | L2-Norm(final)=3.919 | 4249.0 samples/s | 66.4 steps/s
[Step=36950 Epoch=180.0] | Loss=0.00889 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=3.920 | 4320.3 samples/s | 67.5 steps/s
[Step=37000 Epoch=180.3] | Loss=0.00809 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.921 | 5905.1 samples/s | 92.3 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00734 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.159 | L2-Norm(final)=3.922 | 1757.9 samples/s | 27.5 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00657 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.923 | 4252.4 samples/s | 66.4 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00602 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.925 | 4317.7 samples/s | 67.5 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00573 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.162 | L2-Norm(final)=3.926 | 5451.8 samples/s | 85.2 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00529 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.928 | 1813.2 samples/s | 28.3 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00503 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.929 | 4302.8 samples/s | 67.2 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00477 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.930 | 4333.3 samples/s | 67.7 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00467 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.165 | L2-Norm(final)=3.931 | 4970.3 samples/s | 77.7 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00447 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.933 | 1850.8 samples/s | 28.9 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00430 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.167 | L2-Norm(final)=3.934 | 4363.9 samples/s | 68.2 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00420 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.935 | 4363.2 samples/s | 68.2 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00407 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=3.937 | 4772.3 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step37600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.5] | Loss=0.11608 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.134 | L2-Norm(final)=3.920 | 3952.8 samples/s | 61.8 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01761 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.149 | L2-Norm(final)=3.919 | 3918.5 samples/s | 61.2 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01212 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.153 | L2-Norm(final)=3.919 | 4237.7 samples/s | 66.2 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00961 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.919 | 4263.1 samples/s | 66.6 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00809 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.920 | 5847.3 samples/s | 91.4 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00703 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.922 | 1746.3 samples/s | 27.3 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00631 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.923 | 4258.3 samples/s | 66.5 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00566 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.924 | 4287.1 samples/s | 67.0 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00538 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.925 | 5301.5 samples/s | 82.8 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00500 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.926 | 1792.0 samples/s | 28.0 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00480 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.928 | 4251.9 samples/s | 66.4 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00450 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.929 | 4236.7 samples/s | 66.2 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00437 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.930 | 4978.9 samples/s | 77.8 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00425 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.931 | 1812.0 samples/s | 28.3 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00410 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=3.932 | 4294.7 samples/s | 67.1 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00407 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.933 | 4242.4 samples/s | 66.3 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00389 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=3.934 | 4587.4 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step37600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=180.5] | Loss=0.14775 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.134 | L2-Norm(final)=3.920 | 3947.8 samples/s | 61.7 steps/s
[Step=36850 Epoch=180.7] | Loss=0.01919 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.917 | 4036.1 samples/s | 63.1 steps/s
[Step=36900 Epoch=181.0] | Loss=0.01297 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=3.917 | 4271.6 samples/s | 66.7 steps/s
[Step=36950 Epoch=181.2] | Loss=0.01055 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.918 | 4177.5 samples/s | 65.3 steps/s
[Step=37000 Epoch=181.4] | Loss=0.00905 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.919 | 5891.5 samples/s | 92.1 steps/s
[Step=37050 Epoch=181.7] | Loss=0.00794 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.919 | 1726.5 samples/s | 27.0 steps/s
[Step=37100 Epoch=181.9] | Loss=0.00706 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.920 | 4394.4 samples/s | 68.7 steps/s
[Step=37150 Epoch=182.2] | Loss=0.00648 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.921 | 4215.5 samples/s | 65.9 steps/s
[Step=37200 Epoch=182.4] | Loss=0.00598 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.922 | 5583.8 samples/s | 87.2 steps/s
[Step=37250 Epoch=182.7] | Loss=0.00558 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.923 | 1740.2 samples/s | 27.2 steps/s
[Step=37300 Epoch=182.9] | Loss=0.00523 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.925 | 4222.1 samples/s | 66.0 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00496 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.160 | L2-Norm(final)=3.926 | 4175.5 samples/s | 65.2 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00471 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.927 | 5229.7 samples/s | 81.7 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00451 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.928 | 1771.2 samples/s | 27.7 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00431 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.929 | 4271.8 samples/s | 66.7 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00419 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.930 | 4263.2 samples/s | 66.6 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00408 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.932 | 5049.0 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step37600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=348.7] | Loss=0.00810 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 3788.8 samples/s | 59.2 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00366 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.925 | 3849.9 samples/s | 60.2 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00184 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.926 | 5625.9 samples/s | 87.9 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00123 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.926 | 1675.8 samples/s | 26.2 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00092 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.926 | 5125.5 samples/s | 80.1 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00074 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.926 | 1720.8 samples/s | 26.9 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00062 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.926 | 4810.5 samples/s | 75.2 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00053 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.926 | 1755.2 samples/s | 27.4 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.926 | 4456.6 samples/s | 69.6 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.926 | 1809.6 samples/s | 28.3 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00037 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.927 | 4112.3 samples/s | 64.3 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00034 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.927 | 1893.1 samples/s | 29.6 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00031 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.927 | 4045.4 samples/s | 63.2 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.927 | 1876.5 samples/s | 29.3 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.927 | 4120.6 samples/s | 64.4 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00025 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.927 | 1862.1 samples/s | 29.1 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.927 | 3992.8 samples/s | 62.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step37600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.1] | Loss=0.04523 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 3625.1 samples/s | 56.6 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00139 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.926 | 3828.6 samples/s | 59.8 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.927 | 5613.0 samples/s | 87.7 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00049 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.928 | 1672.0 samples/s | 26.1 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.928 | 5124.0 samples/s | 80.1 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.928 | 1720.0 samples/s | 26.9 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00025 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.929 | 4808.6 samples/s | 75.1 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.929 | 1773.7 samples/s | 27.7 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.929 | 4408.3 samples/s | 68.9 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.929 | 1824.1 samples/s | 28.5 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.929 | 4071.3 samples/s | 63.6 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.929 | 1866.5 samples/s | 29.2 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.929 | 4028.9 samples/s | 63.0 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.929 | 1867.1 samples/s | 29.2 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.930 | 4060.3 samples/s | 63.4 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.930 | 1887.4 samples/s | 29.5 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.930 | 3970.2 samples/s | 62.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step37600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=351.4] | Loss=0.00149 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 3826.1 samples/s | 59.8 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00212 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.925 | 3732.5 samples/s | 58.3 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00107 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.926 | 5642.3 samples/s | 88.2 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00072 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.927 | 1666.4 samples/s | 26.0 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00054 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.927 | 5175.8 samples/s | 80.9 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.927 | 1690.8 samples/s | 26.4 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00036 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.927 | 4887.5 samples/s | 76.4 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.927 | 1746.9 samples/s | 27.3 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00027 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.928 | 4566.3 samples/s | 71.3 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.928 | 1777.3 samples/s | 27.8 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.928 | 4274.1 samples/s | 66.8 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.928 | 1808.6 samples/s | 28.3 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.928 | 4169.5 samples/s | 65.1 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.928 | 1868.9 samples/s | 29.2 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.928 | 4114.3 samples/s | 64.3 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.928 | 1868.9 samples/s | 29.2 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.928 | 4067.0 samples/s | 63.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step37600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=346.8] | Loss=0.00452 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 4084.5 samples/s | 63.8 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00275 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.927 | 3396.0 samples/s | 53.1 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00138 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.928 | 5475.3 samples/s | 85.6 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00093 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.928 | 1676.4 samples/s | 26.2 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00070 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.929 | 5001.1 samples/s | 78.1 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.929 | 1722.5 samples/s | 26.9 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.929 | 4518.2 samples/s | 70.6 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00040 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.929 | 1782.6 samples/s | 27.9 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.929 | 4196.2 samples/s | 65.6 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00031 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.929 | 1839.1 samples/s | 28.7 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00028 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.929 | 3992.5 samples/s | 62.4 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00026 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.929 | 1888.7 samples/s | 29.5 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.929 | 4091.2 samples/s | 63.9 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.930 | 1894.6 samples/s | 29.6 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00020 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.930 | 4060.6 samples/s | 63.4 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00019 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.930 | 1977.2 samples/s | 30.9 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.930 | 3604.0 samples/s | 56.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step37600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.7] | Loss=0.02282 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.134 | L2-Norm(final)=3.921 | 4108.0 samples/s | 64.2 steps/s
[Step=36850 Epoch=351.2] | Loss=0.00272 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.925 | 3487.5 samples/s | 54.5 steps/s
[Step=36900 Epoch=351.7] | Loss=0.00137 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.926 | 5538.0 samples/s | 86.5 steps/s
[Step=36950 Epoch=352.2] | Loss=0.00092 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.926 | 1671.4 samples/s | 26.1 steps/s
[Step=37000 Epoch=352.6] | Loss=0.00069 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.927 | 5260.5 samples/s | 82.2 steps/s
[Step=37050 Epoch=353.1] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.927 | 1717.3 samples/s | 26.8 steps/s
[Step=37100 Epoch=353.6] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.927 | 4897.0 samples/s | 76.5 steps/s
[Step=37150 Epoch=354.1] | Loss=0.00040 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.927 | 1746.3 samples/s | 27.3 steps/s
[Step=37200 Epoch=354.5] | Loss=0.00035 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.927 | 4502.0 samples/s | 70.3 steps/s
[Step=37250 Epoch=355.0] | Loss=0.00031 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.927 | 1773.3 samples/s | 27.7 steps/s
[Step=37300 Epoch=355.5] | Loss=0.00028 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.927 | 4302.8 samples/s | 67.2 steps/s
[Step=37350 Epoch=356.0] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.928 | 1820.7 samples/s | 28.4 steps/s
[Step=37400 Epoch=356.5] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.928 | 3998.9 samples/s | 62.5 steps/s
[Step=37450 Epoch=356.9] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.928 | 1851.6 samples/s | 28.9 steps/s
[Step=37500 Epoch=357.4] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.928 | 4029.3 samples/s | 63.0 steps/s
[Step=37550 Epoch=357.9] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.928 | 1858.9 samples/s | 29.0 steps/s
[Step=37600 Epoch=358.4] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.928 | 4025.7 samples/s | 62.9 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23225 | acc=0.9006 | tpr=0.8609 | fpr=0.0131 | 3851.8 samples/s | 15.0 steps/s
Avg test loss: 0.23152, Avg test acc: 0.90055, Avg tpr: 0.86198, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.38968 | acc=0.9052 | tpr=0.9425 | fpr=0.0955 | 3839.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.39632 | acc=0.9061 | tpr=0.9616 | fpr=0.0950 | 7021.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.40299 | acc=0.9046 | tpr=0.9625 | fpr=0.0964 | 7253.0 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.40279 | acc=0.9040 | tpr=0.9617 | fpr=0.0970 | 7041.8 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.39968 | acc=0.9045 | tpr=0.9616 | fpr=0.0965 | 7050.3 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.40195 | acc=0.9044 | tpr=0.9629 | fpr=0.0967 | 7297.1 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.40546 | acc=0.9037 | tpr=0.9624 | fpr=0.0974 | 7189.0 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.40728 | acc=0.9037 | tpr=0.9623 | fpr=0.0973 | 7266.0 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.41093 | acc=0.9037 | tpr=0.9645 | fpr=0.0974 | 6992.5 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.41105 | acc=0.9032 | tpr=0.9661 | fpr=0.0979 | 7448.9 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.40893 | acc=0.9036 | tpr=0.9658 | fpr=0.0976 | 12435.0 samples/s | 48.6 steps/s
Avg test loss: 0.40858, Avg test acc: 0.90358, Avg tpr: 0.96513, Avg fpr: 0.09754, total FA: 13543

server round 47/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.3] | Loss=0.10714 | Reg=0.00147 | acc=0.9219 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3958.6 samples/s | 61.9 steps/s
[Step=37650 Epoch=183.6] | Loss=0.02188 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.935 | 4156.0 samples/s | 64.9 steps/s
[Step=37700 Epoch=183.8] | Loss=0.01459 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.935 | 4258.9 samples/s | 66.5 steps/s
[Step=37750 Epoch=184.1] | Loss=0.01200 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.935 | 4271.2 samples/s | 66.7 steps/s
[Step=37800 Epoch=184.3] | Loss=0.01013 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.936 | 5803.7 samples/s | 90.7 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00879 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.936 | 1736.6 samples/s | 27.1 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00785 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.937 | 4165.3 samples/s | 65.1 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00722 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=3.938 | 4220.7 samples/s | 65.9 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00676 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.939 | 5251.5 samples/s | 82.1 steps/s
[Step=38050 Epoch=185.5] | Loss=0.00620 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.940 | 1802.0 samples/s | 28.2 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00594 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.941 | 4248.4 samples/s | 66.4 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00573 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.159 | L2-Norm(final)=3.941 | 4144.5 samples/s | 64.8 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00544 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.942 | 4926.2 samples/s | 77.0 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00524 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.943 | 1843.6 samples/s | 28.8 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00508 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.944 | 4159.1 samples/s | 65.0 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00489 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.945 | 4212.9 samples/s | 65.8 steps/s
[Step=38400 Epoch=187.2] | Loss=0.00474 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.946 | 4574.9 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.5] | Loss=0.05261 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3976.9 samples/s | 62.1 steps/s
[Step=37650 Epoch=183.7] | Loss=0.01411 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.145 | L2-Norm(final)=3.937 | 3926.8 samples/s | 61.4 steps/s
[Step=37700 Epoch=184.0] | Loss=0.01068 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.937 | 4233.3 samples/s | 66.1 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00878 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.938 | 4196.8 samples/s | 65.6 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00802 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.939 | 5810.8 samples/s | 90.8 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00696 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.940 | 1732.1 samples/s | 27.1 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00619 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.942 | 4232.5 samples/s | 66.1 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00588 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=3.943 | 4216.8 samples/s | 65.9 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00546 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.944 | 5449.1 samples/s | 85.1 steps/s
[Step=38050 Epoch=185.7] | Loss=0.00509 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.945 | 1777.0 samples/s | 27.8 steps/s
[Step=38100 Epoch=185.9] | Loss=0.00476 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.946 | 4233.2 samples/s | 66.1 steps/s
[Step=38150 Epoch=186.2] | Loss=0.00456 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.947 | 4289.5 samples/s | 67.0 steps/s
[Step=38200 Epoch=186.4] | Loss=0.00437 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.949 | 5169.0 samples/s | 80.8 steps/s
[Step=38250 Epoch=186.6] | Loss=0.00422 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.950 | 1820.8 samples/s | 28.5 steps/s
[Step=38300 Epoch=186.9] | Loss=0.00403 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.951 | 4169.4 samples/s | 65.1 steps/s
[Step=38350 Epoch=187.1] | Loss=0.00388 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.952 | 4255.2 samples/s | 66.5 steps/s
[Step=38400 Epoch=187.4] | Loss=0.00382 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.953 | 4743.5 samples/s | 74.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step38400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.2] | Loss=0.08991 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3975.1 samples/s | 62.1 steps/s
[Step=37650 Epoch=183.4] | Loss=0.01803 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.934 | 4030.9 samples/s | 63.0 steps/s
[Step=37700 Epoch=183.7] | Loss=0.01210 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.935 | 4367.5 samples/s | 68.2 steps/s
[Step=37750 Epoch=183.9] | Loss=0.00962 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.936 | 4200.2 samples/s | 65.6 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00869 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.937 | 5775.4 samples/s | 90.2 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00761 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.938 | 1757.0 samples/s | 27.5 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00697 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.939 | 4286.5 samples/s | 67.0 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00632 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.940 | 4247.7 samples/s | 66.4 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00589 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=3.942 | 5356.0 samples/s | 83.7 steps/s
[Step=38050 Epoch=185.4] | Loss=0.00548 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.943 | 1791.9 samples/s | 28.0 steps/s
[Step=38100 Epoch=185.6] | Loss=0.00520 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.944 | 4188.6 samples/s | 65.4 steps/s
[Step=38150 Epoch=185.9] | Loss=0.00488 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.945 | 4231.5 samples/s | 66.1 steps/s
[Step=38200 Epoch=186.1] | Loss=0.00481 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.947 | 4934.3 samples/s | 77.1 steps/s
[Step=38250 Epoch=186.4] | Loss=0.00458 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.948 | 1829.5 samples/s | 28.6 steps/s
[Step=38300 Epoch=186.6] | Loss=0.00442 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.949 | 4403.7 samples/s | 68.8 steps/s
[Step=38350 Epoch=186.9] | Loss=0.00429 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.950 | 4246.3 samples/s | 66.3 steps/s
[Step=38400 Epoch=187.1] | Loss=0.00418 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.951 | 4623.6 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step38400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.4] | Loss=0.07869 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3929.5 samples/s | 61.4 steps/s
[Step=37650 Epoch=183.6] | Loss=0.01787 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.935 | 3939.5 samples/s | 61.6 steps/s
[Step=37700 Epoch=183.8] | Loss=0.01180 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.935 | 4278.0 samples/s | 66.8 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00983 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.936 | 4166.5 samples/s | 65.1 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00842 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.937 | 5797.0 samples/s | 90.6 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00731 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.939 | 1771.5 samples/s | 27.7 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00660 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.940 | 4382.5 samples/s | 68.5 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00601 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.941 | 4258.6 samples/s | 66.5 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00559 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.942 | 5519.6 samples/s | 86.2 steps/s
[Step=38050 Epoch=185.6] | Loss=0.00521 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.944 | 1789.8 samples/s | 28.0 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00491 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.160 | L2-Norm(final)=3.945 | 4243.0 samples/s | 66.3 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00466 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.161 | L2-Norm(final)=3.946 | 4287.3 samples/s | 67.0 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00450 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.161 | L2-Norm(final)=3.947 | 4981.2 samples/s | 77.8 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00429 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=3.949 | 1844.8 samples/s | 28.8 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00411 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.950 | 4259.6 samples/s | 66.6 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00401 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=3.951 | 4358.2 samples/s | 68.1 steps/s
[Step=38400 Epoch=187.3] | Loss=0.00389 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=3.952 | 4770.9 samples/s | 74.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step38400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=184.4] | Loss=0.08091 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3912.8 samples/s | 61.1 steps/s
[Step=37650 Epoch=184.6] | Loss=0.01217 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.939 | 3943.0 samples/s | 61.6 steps/s
[Step=37700 Epoch=184.9] | Loss=0.00905 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.940 | 4241.4 samples/s | 66.3 steps/s
[Step=37750 Epoch=185.1] | Loss=0.00840 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.151 | L2-Norm(final)=3.941 | 4372.0 samples/s | 68.3 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00776 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=3.942 | 5743.0 samples/s | 89.7 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00671 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.943 | 1723.9 samples/s | 26.9 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00607 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.944 | 4249.6 samples/s | 66.4 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00560 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.945 | 4263.5 samples/s | 66.6 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00525 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.946 | 5582.8 samples/s | 87.2 steps/s
[Step=38050 Epoch=186.6] | Loss=0.00498 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.948 | 1751.7 samples/s | 27.4 steps/s
[Step=38100 Epoch=186.8] | Loss=0.00463 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.949 | 4187.3 samples/s | 65.4 steps/s
[Step=38150 Epoch=187.1] | Loss=0.00443 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.950 | 4245.2 samples/s | 66.3 steps/s
[Step=38200 Epoch=187.3] | Loss=0.00423 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.951 | 5251.7 samples/s | 82.1 steps/s
[Step=38250 Epoch=187.6] | Loss=0.00414 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.952 | 1786.0 samples/s | 27.9 steps/s
[Step=38300 Epoch=187.8] | Loss=0.00397 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.953 | 4201.0 samples/s | 65.6 steps/s
[Step=38350 Epoch=188.1] | Loss=0.00386 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.954 | 4257.6 samples/s | 66.5 steps/s
[Step=38400 Epoch=188.3] | Loss=0.00371 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.956 | 5139.2 samples/s | 80.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step38400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=356.3] | Loss=0.01578 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3835.3 samples/s | 59.9 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00167 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.946 | 3990.8 samples/s | 62.4 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00085 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.947 | 5543.6 samples/s | 86.6 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00058 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.948 | 1685.3 samples/s | 26.3 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.948 | 5018.6 samples/s | 78.4 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00035 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.948 | 1730.3 samples/s | 27.0 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.948 | 4769.5 samples/s | 74.5 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.949 | 1786.4 samples/s | 27.9 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.949 | 4378.4 samples/s | 68.4 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.949 | 1808.0 samples/s | 28.3 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.949 | 4160.5 samples/s | 65.0 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.949 | 1873.1 samples/s | 29.3 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.949 | 3998.6 samples/s | 62.5 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.949 | 1876.9 samples/s | 29.3 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.950 | 4013.1 samples/s | 62.7 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.950 | 1877.7 samples/s | 29.3 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.950 | 4107.1 samples/s | 64.2 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step38400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=357.7] | Loss=0.05129 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3896.7 samples/s | 60.9 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00206 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.944 | 3736.8 samples/s | 58.4 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00104 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.946 | 5641.7 samples/s | 88.2 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00070 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.946 | 1691.5 samples/s | 26.4 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00052 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.946 | 5109.1 samples/s | 79.8 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00042 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.947 | 1727.4 samples/s | 27.0 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00035 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.947 | 4714.8 samples/s | 73.7 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00030 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.947 | 1786.2 samples/s | 27.9 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.947 | 4399.6 samples/s | 68.7 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.947 | 1822.2 samples/s | 28.5 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.947 | 4089.0 samples/s | 63.9 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.947 | 1859.5 samples/s | 29.1 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.948 | 3997.9 samples/s | 62.5 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.948 | 1891.8 samples/s | 29.6 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.948 | 4020.9 samples/s | 62.8 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.948 | 1895.2 samples/s | 29.6 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.948 | 3988.9 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step38400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=359.1] | Loss=0.04543 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 4023.0 samples/s | 62.9 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00219 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.943 | 3627.9 samples/s | 56.7 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00110 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.944 | 5642.2 samples/s | 88.2 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00074 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.944 | 1677.9 samples/s | 26.2 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00056 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.945 | 5245.6 samples/s | 82.0 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00045 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.945 | 1687.4 samples/s | 26.4 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.945 | 4902.4 samples/s | 76.6 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.945 | 1748.3 samples/s | 27.3 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00028 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.945 | 4631.8 samples/s | 72.4 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00025 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.945 | 1787.7 samples/s | 27.9 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.945 | 4391.8 samples/s | 68.6 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.945 | 1828.6 samples/s | 28.6 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.945 | 3980.0 samples/s | 62.2 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.945 | 1846.1 samples/s | 28.8 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.946 | 4009.4 samples/s | 62.6 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.946 | 1864.1 samples/s | 29.1 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.946 | 4115.5 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step38400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=354.3] | Loss=0.00863 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 4121.1 samples/s | 64.4 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00369 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.943 | 3612.0 samples/s | 56.4 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00186 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.944 | 5557.2 samples/s | 86.8 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00124 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.944 | 1681.1 samples/s | 26.3 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00094 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.944 | 5028.5 samples/s | 78.6 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00075 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.945 | 1747.2 samples/s | 27.3 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.945 | 4680.5 samples/s | 73.1 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00054 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.945 | 1793.4 samples/s | 28.0 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00047 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.945 | 4209.0 samples/s | 65.8 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00042 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.945 | 1866.6 samples/s | 29.2 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00038 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.945 | 4136.5 samples/s | 64.6 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00035 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.945 | 1869.2 samples/s | 29.2 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.945 | 4030.2 samples/s | 63.0 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.945 | 1883.9 samples/s | 29.4 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.946 | 4010.8 samples/s | 62.7 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.946 | 2025.7 samples/s | 31.7 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.946 | 3453.5 samples/s | 54.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step38400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=358.4] | Loss=0.00689 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.131 | L2-Norm(final)=3.939 | 3916.4 samples/s | 61.2 steps/s
[Step=37650 Epoch=358.8] | Loss=0.00105 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.945 | 3548.1 samples/s | 55.4 steps/s
[Step=37700 Epoch=359.3] | Loss=0.00053 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.946 | 5668.7 samples/s | 88.6 steps/s
[Step=37750 Epoch=359.8] | Loss=0.00036 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.947 | 1664.0 samples/s | 26.0 steps/s
[Step=37800 Epoch=360.3] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.947 | 5238.5 samples/s | 81.9 steps/s
[Step=37850 Epoch=360.7] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.948 | 1706.8 samples/s | 26.7 steps/s
[Step=37900 Epoch=361.2] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.948 | 4787.9 samples/s | 74.8 steps/s
[Step=37950 Epoch=361.7] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.948 | 1641.3 samples/s | 25.6 steps/s
[Step=38000 Epoch=362.2] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.948 | 4604.7 samples/s | 71.9 steps/s
[Step=38050 Epoch=362.7] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.949 | 1796.0 samples/s | 28.1 steps/s
[Step=38100 Epoch=363.1] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.949 | 4379.7 samples/s | 68.4 steps/s
[Step=38150 Epoch=363.6] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.949 | 1817.5 samples/s | 28.4 steps/s
[Step=38200 Epoch=364.1] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.949 | 4095.0 samples/s | 64.0 steps/s
[Step=38250 Epoch=364.6] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.949 | 1879.1 samples/s | 29.4 steps/s
[Step=38300 Epoch=365.0] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.949 | 4091.8 samples/s | 63.9 steps/s
[Step=38350 Epoch=365.5] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.949 | 1899.0 samples/s | 29.7 steps/s
[Step=38400 Epoch=366.0] | Loss=0.00007 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.950 | 4163.2 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22595 | acc=0.9037 | tpr=0.8656 | fpr=0.0136 | 3762.1 samples/s | 14.7 steps/s
Avg test loss: 0.22503, Avg test acc: 0.90388, Avg tpr: 0.86711, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.38912 | acc=0.9049 | tpr=0.9425 | fpr=0.0958 | 3785.2 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.39574 | acc=0.9063 | tpr=0.9616 | fpr=0.0947 | 7183.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.40243 | acc=0.9048 | tpr=0.9625 | fpr=0.0963 | 7099.4 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.40216 | acc=0.9043 | tpr=0.9617 | fpr=0.0967 | 7299.1 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.39898 | acc=0.9050 | tpr=0.9616 | fpr=0.0960 | 6691.7 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.40128 | acc=0.9050 | tpr=0.9629 | fpr=0.0960 | 4643.2 samples/s | 18.1 steps/s
[Step= 350] | Loss=0.40482 | acc=0.9044 | tpr=0.9624 | fpr=0.0967 | 7074.4 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.40661 | acc=0.9044 | tpr=0.9628 | fpr=0.0966 | 7040.3 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.41026 | acc=0.9042 | tpr=0.9649 | fpr=0.0969 | 6985.5 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.41037 | acc=0.9037 | tpr=0.9665 | fpr=0.0975 | 7012.8 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.40826 | acc=0.9040 | tpr=0.9658 | fpr=0.0971 | 13749.8 samples/s | 53.7 steps/s
Avg test loss: 0.40791, Avg test acc: 0.90405, Avg tpr: 0.96513, Avg fpr: 0.09706, total FA: 13477

server round 48/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.20503 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.128 | L2-Norm(final)=3.958 | 4188.9 samples/s | 65.5 steps/s
[Step=38450 Epoch=187.5] | Loss=0.02107 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.953 | 3729.4 samples/s | 58.3 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01367 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.953 | 4262.9 samples/s | 66.6 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01140 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.146 | L2-Norm(final)=3.954 | 4292.1 samples/s | 67.1 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00992 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.954 | 5842.2 samples/s | 91.3 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00845 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.955 | 1736.6 samples/s | 27.1 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00751 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.956 | 4296.9 samples/s | 67.1 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00679 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.957 | 4254.9 samples/s | 66.5 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00652 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=3.958 | 5337.5 samples/s | 83.4 steps/s
[Step=38850 Epoch=189.4] | Loss=0.00606 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.959 | 1781.1 samples/s | 27.8 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00578 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.153 | L2-Norm(final)=3.960 | 4304.3 samples/s | 67.3 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00556 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.154 | L2-Norm(final)=3.961 | 4322.3 samples/s | 67.5 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00529 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.962 | 5123.6 samples/s | 80.1 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00505 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.963 | 1828.7 samples/s | 28.6 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.964 | 4232.1 samples/s | 66.1 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00474 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.965 | 4187.4 samples/s | 65.4 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00460 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.966 | 4697.8 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.4] | Loss=0.14634 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.128 | L2-Norm(final)=3.958 | 3736.9 samples/s | 58.4 steps/s
[Step=38450 Epoch=187.6] | Loss=0.01744 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.955 | 4194.9 samples/s | 65.5 steps/s
[Step=38500 Epoch=187.9] | Loss=0.01235 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.955 | 4243.0 samples/s | 66.3 steps/s
[Step=38550 Epoch=188.1] | Loss=0.00978 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.956 | 4206.9 samples/s | 65.7 steps/s
[Step=38600 Epoch=188.4] | Loss=0.00846 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.957 | 5862.0 samples/s | 91.6 steps/s
[Step=38650 Epoch=188.6] | Loss=0.00733 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.958 | 1752.4 samples/s | 27.4 steps/s
[Step=38700 Epoch=188.8] | Loss=0.00660 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.959 | 4302.4 samples/s | 67.2 steps/s
[Step=38750 Epoch=189.1] | Loss=0.00603 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.960 | 4270.0 samples/s | 66.7 steps/s
[Step=38800 Epoch=189.3] | Loss=0.00554 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.962 | 5451.1 samples/s | 85.2 steps/s
[Step=38850 Epoch=189.6] | Loss=0.00508 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.963 | 1783.3 samples/s | 27.9 steps/s
[Step=38900 Epoch=189.8] | Loss=0.00482 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.964 | 4222.0 samples/s | 66.0 steps/s
[Step=38950 Epoch=190.1] | Loss=0.00464 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.965 | 4254.4 samples/s | 66.5 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00447 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.967 | 5187.7 samples/s | 81.1 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00427 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.968 | 1785.1 samples/s | 27.9 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00409 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.160 | L2-Norm(final)=3.969 | 4258.6 samples/s | 66.5 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00399 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.970 | 4272.8 samples/s | 66.8 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00384 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.971 | 4774.2 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step39200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.1] | Loss=0.00754 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 3899.5 samples/s | 60.9 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01568 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.140 | L2-Norm(final)=3.956 | 3951.5 samples/s | 61.7 steps/s
[Step=38500 Epoch=187.6] | Loss=0.01178 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.144 | L2-Norm(final)=3.956 | 4306.1 samples/s | 67.3 steps/s
[Step=38550 Epoch=187.8] | Loss=0.00976 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.147 | L2-Norm(final)=3.957 | 4209.7 samples/s | 65.8 steps/s
[Step=38600 Epoch=188.1] | Loss=0.00851 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.149 | L2-Norm(final)=3.958 | 5829.8 samples/s | 91.1 steps/s
[Step=38650 Epoch=188.3] | Loss=0.00738 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.959 | 1745.2 samples/s | 27.3 steps/s
[Step=38700 Epoch=188.6] | Loss=0.00661 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.961 | 4306.3 samples/s | 67.3 steps/s
[Step=38750 Epoch=188.8] | Loss=0.00605 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.962 | 4352.0 samples/s | 68.0 steps/s
[Step=38800 Epoch=189.1] | Loss=0.00572 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.153 | L2-Norm(final)=3.964 | 5255.3 samples/s | 82.1 steps/s
[Step=38850 Epoch=189.3] | Loss=0.00540 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.154 | L2-Norm(final)=3.965 | 1781.9 samples/s | 27.8 steps/s
[Step=38900 Epoch=189.5] | Loss=0.00507 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.966 | 4280.5 samples/s | 66.9 steps/s
[Step=38950 Epoch=189.8] | Loss=0.00481 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.968 | 4305.8 samples/s | 67.3 steps/s
[Step=39000 Epoch=190.0] | Loss=0.00466 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.969 | 5075.8 samples/s | 79.3 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00450 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.970 | 1835.4 samples/s | 28.7 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00432 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.972 | 4234.8 samples/s | 66.2 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00419 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.973 | 4234.1 samples/s | 66.2 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00408 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.974 | 4638.1 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step39200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.04124 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 4152.6 samples/s | 64.9 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01474 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.142 | L2-Norm(final)=3.957 | 3757.4 samples/s | 58.7 steps/s
[Step=38500 Epoch=187.7] | Loss=0.00946 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.957 | 4218.6 samples/s | 65.9 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00830 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.958 | 4315.5 samples/s | 67.4 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00717 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.959 | 5744.5 samples/s | 89.8 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00638 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.961 | 1739.1 samples/s | 27.2 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00569 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.962 | 4213.1 samples/s | 65.8 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00526 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.963 | 4180.7 samples/s | 65.3 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.964 | 5349.4 samples/s | 83.6 steps/s
[Step=38850 Epoch=189.5] | Loss=0.00467 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.966 | 1788.0 samples/s | 27.9 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00447 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.967 | 4331.3 samples/s | 67.7 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00433 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.968 | 4320.3 samples/s | 67.5 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00415 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.969 | 4954.7 samples/s | 77.4 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00399 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=3.970 | 1821.0 samples/s | 28.5 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00386 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=3.972 | 4222.9 samples/s | 66.0 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00374 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.160 | L2-Norm(final)=3.973 | 4270.4 samples/s | 66.7 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00366 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=3.974 | 4650.6 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step39200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=188.3] | Loss=0.15664 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.128 | L2-Norm(final)=3.958 | 3682.3 samples/s | 57.5 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01558 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.957 | 1976.4 samples/s | 30.9 steps/s
[Step=38500 Epoch=188.8] | Loss=0.01058 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.957 | 4061.4 samples/s | 63.5 steps/s
[Step=38550 Epoch=189.0] | Loss=0.00875 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.958 | 4252.3 samples/s | 66.4 steps/s
[Step=38600 Epoch=189.3] | Loss=0.00778 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.959 | 5813.8 samples/s | 90.8 steps/s
[Step=38650 Epoch=189.5] | Loss=0.00682 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.961 | 1722.2 samples/s | 26.9 steps/s
[Step=38700 Epoch=189.8] | Loss=0.00612 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.962 | 4385.7 samples/s | 68.5 steps/s
[Step=38750 Epoch=190.0] | Loss=0.00557 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.963 | 4385.0 samples/s | 68.5 steps/s
[Step=38800 Epoch=190.3] | Loss=0.00526 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.964 | 5723.1 samples/s | 89.4 steps/s
[Step=38850 Epoch=190.5] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.966 | 1764.7 samples/s | 27.6 steps/s
[Step=38900 Epoch=190.8] | Loss=0.00474 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.967 | 4288.6 samples/s | 67.0 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00448 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.968 | 4253.2 samples/s | 66.5 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00428 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.969 | 5395.0 samples/s | 84.3 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00408 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.970 | 1805.9 samples/s | 28.2 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00392 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.972 | 4407.7 samples/s | 68.9 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00377 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.973 | 4375.2 samples/s | 68.4 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00372 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.974 | 5171.7 samples/s | 80.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step39200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=363.9] | Loss=0.05075 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 3904.9 samples/s | 61.0 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00359 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.964 | 3698.6 samples/s | 57.8 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00180 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.965 | 5499.4 samples/s | 85.9 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00120 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.965 | 1715.8 samples/s | 26.8 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00091 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.965 | 5015.8 samples/s | 78.4 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00073 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.965 | 1745.7 samples/s | 27.3 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.965 | 4922.9 samples/s | 76.9 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.965 | 1765.8 samples/s | 27.6 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.965 | 4459.5 samples/s | 69.7 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.966 | 1829.9 samples/s | 28.6 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.966 | 4141.3 samples/s | 64.7 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00033 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.966 | 1858.2 samples/s | 29.0 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00031 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.966 | 4244.0 samples/s | 66.3 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00028 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=3.966 | 1902.5 samples/s | 29.7 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.966 | 4168.4 samples/s | 65.1 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.966 | 1889.2 samples/s | 29.5 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.966 | 4149.6 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step39200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=365.3] | Loss=0.00312 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 4031.8 samples/s | 63.0 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00112 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.964 | 3580.2 samples/s | 55.9 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00057 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.965 | 5708.3 samples/s | 89.2 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00039 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.966 | 1700.2 samples/s | 26.6 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.966 | 5166.0 samples/s | 80.7 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.967 | 1728.3 samples/s | 27.0 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.967 | 4777.5 samples/s | 74.6 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.967 | 1738.9 samples/s | 27.2 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.967 | 4377.0 samples/s | 68.4 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.967 | 1814.3 samples/s | 28.3 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.967 | 4135.4 samples/s | 64.6 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.967 | 1847.3 samples/s | 28.9 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.968 | 4089.5 samples/s | 63.9 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.968 | 1881.4 samples/s | 29.4 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.968 | 4180.8 samples/s | 65.3 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.968 | 1897.7 samples/s | 29.7 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=3.968 | 4016.7 samples/s | 62.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step39200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.7] | Loss=0.00087 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 3908.3 samples/s | 61.1 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00270 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.963 | 3725.9 samples/s | 58.2 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00140 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.964 | 5621.4 samples/s | 87.8 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00094 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.965 | 1684.1 samples/s | 26.3 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00070 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.965 | 5270.7 samples/s | 82.4 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00057 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.965 | 1692.5 samples/s | 26.4 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00047 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.965 | 4853.9 samples/s | 75.8 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00041 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.966 | 1745.8 samples/s | 27.3 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00036 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.966 | 4581.1 samples/s | 71.6 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.966 | 1772.5 samples/s | 27.7 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.966 | 4400.1 samples/s | 68.8 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.966 | 1822.1 samples/s | 28.5 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.966 | 4231.0 samples/s | 66.1 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.967 | 1884.4 samples/s | 29.4 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.967 | 4236.9 samples/s | 66.2 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.967 | 1881.2 samples/s | 29.4 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.967 | 4128.2 samples/s | 64.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step39200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=361.8] | Loss=0.00096 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 3965.2 samples/s | 62.0 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00144 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.964 | 3814.0 samples/s | 59.6 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00078 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.966 | 5469.6 samples/s | 85.5 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00052 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.967 | 1693.8 samples/s | 26.5 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00039 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.967 | 5097.4 samples/s | 79.6 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.968 | 1739.0 samples/s | 27.2 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.968 | 4641.8 samples/s | 72.5 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.968 | 1780.8 samples/s | 27.8 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.968 | 4331.5 samples/s | 67.7 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.969 | 1867.2 samples/s | 29.2 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.969 | 4108.0 samples/s | 64.2 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.969 | 1875.3 samples/s | 29.3 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.969 | 4205.4 samples/s | 65.7 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.969 | 1866.4 samples/s | 29.2 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.969 | 3912.5 samples/s | 61.1 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.969 | 2033.3 samples/s | 31.8 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.969 | 3569.4 samples/s | 55.8 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step39200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.0] | Loss=0.00235 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.959 | 3611.4 samples/s | 56.4 steps/s
[Step=38450 Epoch=366.5] | Loss=0.00084 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.965 | 3923.1 samples/s | 61.3 steps/s
[Step=38500 Epoch=366.9] | Loss=0.00043 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.967 | 5607.9 samples/s | 87.6 steps/s
[Step=38550 Epoch=367.4] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.967 | 1665.8 samples/s | 26.0 steps/s
[Step=38600 Epoch=367.9] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.968 | 5236.8 samples/s | 81.8 steps/s
[Step=38650 Epoch=368.4] | Loss=0.00018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.968 | 1708.8 samples/s | 26.7 steps/s
[Step=38700 Epoch=368.8] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.968 | 5012.7 samples/s | 78.3 steps/s
[Step=38750 Epoch=369.3] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.968 | 1761.9 samples/s | 27.5 steps/s
[Step=38800 Epoch=369.8] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.969 | 4524.1 samples/s | 70.7 steps/s
[Step=38850 Epoch=370.3] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.969 | 1786.6 samples/s | 27.9 steps/s
[Step=38900 Epoch=370.8] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.969 | 4355.5 samples/s | 68.1 steps/s
[Step=38950 Epoch=371.2] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.969 | 1806.6 samples/s | 28.2 steps/s
[Step=39000 Epoch=371.7] | Loss=0.00008 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.969 | 4207.0 samples/s | 65.7 steps/s
[Step=39050 Epoch=372.2] | Loss=0.00007 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.969 | 1867.7 samples/s | 29.2 steps/s
[Step=39100 Epoch=372.7] | Loss=0.00007 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.969 | 4059.7 samples/s | 63.4 steps/s
[Step=39150 Epoch=373.1] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=3.969 | 1879.9 samples/s | 29.4 steps/s
[Step=39200 Epoch=373.6] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=3.970 | 4114.2 samples/s | 64.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22648 | acc=0.9032 | tpr=0.8648 | fpr=0.0134 | 3800.9 samples/s | 14.8 steps/s
Avg test loss: 0.22648, Avg test acc: 0.90340, Avg tpr: 0.86612, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.40213 | acc=0.9024 | tpr=0.9425 | fpr=0.0983 | 3783.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.40868 | acc=0.9043 | tpr=0.9616 | fpr=0.0968 | 6885.5 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.41547 | acc=0.9026 | tpr=0.9625 | fpr=0.0985 | 7257.1 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.41516 | acc=0.9020 | tpr=0.9617 | fpr=0.0991 | 7181.1 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.41179 | acc=0.9026 | tpr=0.9607 | fpr=0.0985 | 7240.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.41412 | acc=0.9026 | tpr=0.9622 | fpr=0.0985 | 6993.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.41770 | acc=0.9018 | tpr=0.9618 | fpr=0.0993 | 7212.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.41961 | acc=0.9019 | tpr=0.9628 | fpr=0.0992 | 7383.6 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.42337 | acc=0.9017 | tpr=0.9649 | fpr=0.0994 | 6931.2 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.42345 | acc=0.9012 | tpr=0.9665 | fpr=0.0999 | 6998.5 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.42128 | acc=0.9016 | tpr=0.9658 | fpr=0.0995 | 13529.7 samples/s | 52.9 steps/s
Avg test loss: 0.42091, Avg test acc: 0.90163, Avg tpr: 0.96513, Avg fpr: 0.09953, total FA: 13819

server round 49/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.05328 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 4031.1 samples/s | 63.0 steps/s
[Step=39250 Epoch=191.4] | Loss=0.02060 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.976 | 3984.1 samples/s | 62.3 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01391 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.975 | 4336.6 samples/s | 67.8 steps/s
[Step=39350 Epoch=191.9] | Loss=0.01146 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.975 | 4309.2 samples/s | 67.3 steps/s
[Step=39400 Epoch=192.1] | Loss=0.01006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.976 | 5766.4 samples/s | 90.1 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00860 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.977 | 1747.2 samples/s | 27.3 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00774 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.978 | 4386.8 samples/s | 68.5 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00708 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.979 | 4320.9 samples/s | 67.5 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00671 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.979 | 5345.6 samples/s | 83.5 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00626 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.147 | L2-Norm(final)=3.980 | 1781.0 samples/s | 27.8 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00592 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.981 | 4340.6 samples/s | 67.8 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00564 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.149 | L2-Norm(final)=3.982 | 4340.7 samples/s | 67.8 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00535 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.983 | 5053.4 samples/s | 79.0 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00514 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.150 | L2-Norm(final)=3.984 | 1824.9 samples/s | 28.5 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00492 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.985 | 4231.6 samples/s | 66.1 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00476 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.151 | L2-Norm(final)=3.986 | 4301.5 samples/s | 67.2 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00465 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.987 | 4708.1 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.3] | Loss=0.21343 | Reg=0.00147 | acc=0.8594 | L2-Norm=12.124 | L2-Norm(final)=3.978 | 3875.1 samples/s | 60.5 steps/s
[Step=39250 Epoch=191.5] | Loss=0.01726 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.136 | L2-Norm(final)=3.977 | 4048.1 samples/s | 63.3 steps/s
[Step=39300 Epoch=191.8] | Loss=0.01195 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.977 | 4279.0 samples/s | 66.9 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00948 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=3.979 | 4335.7 samples/s | 67.7 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00807 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.980 | 5864.3 samples/s | 91.6 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00695 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.982 | 1736.5 samples/s | 27.1 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00622 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.983 | 4304.8 samples/s | 67.3 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00579 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.985 | 4316.8 samples/s | 67.4 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00536 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.149 | L2-Norm(final)=3.986 | 5425.2 samples/s | 84.8 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00499 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.987 | 1780.6 samples/s | 27.8 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00477 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.988 | 4350.9 samples/s | 68.0 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00448 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.990 | 4229.8 samples/s | 66.1 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00431 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=3.991 | 5090.3 samples/s | 79.5 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00418 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.992 | 1814.8 samples/s | 28.4 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00408 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.993 | 4138.2 samples/s | 64.7 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00395 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.994 | 4228.4 samples/s | 66.1 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00380 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.995 | 4738.2 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.0] | Loss=0.04679 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3802.3 samples/s | 59.4 steps/s
[Step=39250 Epoch=191.2] | Loss=0.01581 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.137 | L2-Norm(final)=3.977 | 4046.8 samples/s | 63.2 steps/s
[Step=39300 Epoch=191.5] | Loss=0.01086 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.142 | L2-Norm(final)=3.978 | 4261.9 samples/s | 66.6 steps/s
[Step=39350 Epoch=191.7] | Loss=0.00848 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=3.979 | 4233.4 samples/s | 66.1 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00753 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=3.981 | 5800.4 samples/s | 90.6 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00678 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.982 | 1743.1 samples/s | 27.2 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00616 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.984 | 4209.5 samples/s | 65.8 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00578 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.985 | 4166.5 samples/s | 65.1 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00540 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.986 | 5361.2 samples/s | 83.8 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00499 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.988 | 1779.6 samples/s | 27.8 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00472 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.989 | 4184.2 samples/s | 65.4 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00456 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.990 | 4218.2 samples/s | 65.9 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00446 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.992 | 4995.6 samples/s | 78.1 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00426 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.993 | 1833.4 samples/s | 28.6 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00411 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.994 | 4240.2 samples/s | 66.3 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00394 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.996 | 4201.8 samples/s | 65.7 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00387 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.997 | 4629.4 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.15244 | Reg=0.00147 | acc=0.9219 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 4016.9 samples/s | 62.8 steps/s
[Step=39250 Epoch=191.4] | Loss=0.02176 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.140 | L2-Norm(final)=3.974 | 3830.2 samples/s | 59.8 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01362 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.974 | 4244.9 samples/s | 66.3 steps/s
[Step=39350 Epoch=191.9] | Loss=0.01094 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.147 | L2-Norm(final)=3.975 | 4251.1 samples/s | 66.4 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00904 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.975 | 5690.0 samples/s | 88.9 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00761 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.976 | 1741.9 samples/s | 27.2 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00686 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.978 | 4315.1 samples/s | 67.4 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00626 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.979 | 4214.5 samples/s | 65.9 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00581 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.980 | 5382.5 samples/s | 84.1 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00542 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.981 | 1774.0 samples/s | 27.7 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00516 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.982 | 4308.6 samples/s | 67.3 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00492 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.155 | L2-Norm(final)=3.983 | 4184.4 samples/s | 65.4 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00476 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=3.984 | 4962.7 samples/s | 77.5 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00453 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.985 | 1818.3 samples/s | 28.4 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00440 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.986 | 4258.1 samples/s | 66.5 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00422 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.987 | 4262.0 samples/s | 66.6 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00408 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=3.988 | 4713.3 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_3/client_state-step40000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=192.2] | Loss=0.08245 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3914.7 samples/s | 61.2 steps/s
[Step=39250 Epoch=192.5] | Loss=0.01899 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.976 | 4005.9 samples/s | 62.6 steps/s
[Step=39300 Epoch=192.7] | Loss=0.01279 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=3.976 | 4312.6 samples/s | 67.4 steps/s
[Step=39350 Epoch=193.0] | Loss=0.01063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=3.976 | 4351.2 samples/s | 68.0 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00915 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=3.977 | 5926.3 samples/s | 92.6 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00786 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.149 | L2-Norm(final)=3.978 | 1705.1 samples/s | 26.6 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00700 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=3.979 | 4195.1 samples/s | 65.5 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00634 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=3.979 | 4293.4 samples/s | 67.1 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00595 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.981 | 5596.4 samples/s | 87.4 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00563 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.982 | 1757.7 samples/s | 27.5 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00528 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=3.983 | 4234.6 samples/s | 66.2 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00495 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.984 | 4221.5 samples/s | 66.0 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00470 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=3.985 | 5340.3 samples/s | 83.4 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00450 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=3.986 | 1802.6 samples/s | 28.2 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00430 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.987 | 4226.5 samples/s | 66.0 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00418 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=3.988 | 4294.5 samples/s | 67.1 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00405 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=3.989 | 5022.3 samples/s | 78.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_asml1_4/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=371.5] | Loss=0.03053 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3864.0 samples/s | 60.4 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00211 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.984 | 3653.5 samples/s | 57.1 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00108 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.985 | 5586.0 samples/s | 87.3 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00073 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.985 | 1671.5 samples/s | 26.1 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00055 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.985 | 5117.6 samples/s | 80.0 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00044 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.986 | 1701.7 samples/s | 26.6 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.986 | 4702.0 samples/s | 73.5 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.986 | 1760.2 samples/s | 27.5 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00028 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.986 | 4461.0 samples/s | 69.7 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00025 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.986 | 1809.1 samples/s | 28.3 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.987 | 4135.4 samples/s | 64.6 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.987 | 1844.3 samples/s | 28.8 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.987 | 4093.8 samples/s | 64.0 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.987 | 1855.6 samples/s | 29.0 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.987 | 4078.2 samples/s | 63.7 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=3.987 | 1881.1 samples/s | 29.4 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=3.987 | 3985.4 samples/s | 62.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_0/client_state-step40000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=372.9] | Loss=0.10191 | Reg=0.00147 | acc=0.9375 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3710.6 samples/s | 58.0 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00326 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.983 | 3965.3 samples/s | 62.0 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00164 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.983 | 5612.7 samples/s | 87.7 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.983 | 1660.7 samples/s | 25.9 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00082 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.984 | 5072.9 samples/s | 79.3 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00066 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.984 | 1711.9 samples/s | 26.7 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00055 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.984 | 4665.1 samples/s | 72.9 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00047 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.984 | 1761.8 samples/s | 27.5 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00041 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.984 | 4326.4 samples/s | 67.6 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.984 | 1795.1 samples/s | 28.0 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00033 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.984 | 4129.2 samples/s | 64.5 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00030 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.984 | 1866.6 samples/s | 29.2 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00028 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.984 | 4095.7 samples/s | 64.0 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.984 | 1895.4 samples/s | 29.6 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.984 | 4004.8 samples/s | 62.6 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=3.984 | 1883.4 samples/s | 29.4 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=3.984 | 4102.4 samples/s | 64.1 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_1/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=374.3] | Loss=0.01571 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3792.1 samples/s | 59.3 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00253 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.986 | 3647.6 samples/s | 57.0 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00127 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.987 | 5649.1 samples/s | 88.3 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00085 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.987 | 1658.5 samples/s | 25.9 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00064 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=3.988 | 5229.7 samples/s | 81.7 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00051 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.988 | 1697.3 samples/s | 26.5 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00043 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=3.988 | 4935.8 samples/s | 77.1 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=3.988 | 1734.9 samples/s | 27.1 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=3.988 | 4584.9 samples/s | 71.6 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00029 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.988 | 1768.4 samples/s | 27.6 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.988 | 4270.4 samples/s | 66.7 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.988 | 1800.3 samples/s | 28.1 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.988 | 4068.7 samples/s | 63.6 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.988 | 1866.1 samples/s | 29.2 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.988 | 4058.2 samples/s | 63.4 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.988 | 1846.9 samples/s | 28.9 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.989 | 4049.1 samples/s | 63.3 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_2/client_state-step40000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=369.4] | Loss=0.03062 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3802.2 samples/s | 59.4 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00201 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.983 | 3617.6 samples/s | 56.5 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00118 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.984 | 5396.8 samples/s | 84.3 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00079 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.985 | 1660.5 samples/s | 25.9 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00060 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.986 | 4979.0 samples/s | 77.8 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00048 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.986 | 1728.7 samples/s | 27.0 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00040 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.986 | 4461.0 samples/s | 69.7 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00034 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.986 | 1775.5 samples/s | 27.7 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00030 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.986 | 4148.0 samples/s | 64.8 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.986 | 1848.7 samples/s | 28.9 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.987 | 4141.1 samples/s | 64.7 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.987 | 1889.2 samples/s | 29.5 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.987 | 4134.3 samples/s | 64.6 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.987 | 1901.5 samples/s | 29.7 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.987 | 3991.1 samples/s | 62.4 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.987 | 1973.2 samples/s | 30.8 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=3.987 | 3741.7 samples/s | 58.5 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_3/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=373.6] | Loss=0.00869 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=3.979 | 3882.1 samples/s | 60.7 steps/s
[Step=39250 Epoch=374.1] | Loss=0.00125 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.985 | 3652.1 samples/s | 57.1 steps/s
[Step=39300 Epoch=374.6] | Loss=0.00064 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.986 | 5512.2 samples/s | 86.1 steps/s
[Step=39350 Epoch=375.0] | Loss=0.00043 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=3.986 | 1671.8 samples/s | 26.1 steps/s
[Step=39400 Epoch=375.5] | Loss=0.00033 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=3.987 | 5193.1 samples/s | 81.1 steps/s
[Step=39450 Epoch=376.0] | Loss=0.00026 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=3.987 | 1703.0 samples/s | 26.6 steps/s
[Step=39500 Epoch=376.5] | Loss=0.00022 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=3.987 | 4843.0 samples/s | 75.7 steps/s
[Step=39550 Epoch=376.9] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=3.987 | 1735.5 samples/s | 27.1 steps/s
[Step=39600 Epoch=377.4] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=3.988 | 4569.8 samples/s | 71.4 steps/s
[Step=39650 Epoch=377.9] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=3.988 | 1780.7 samples/s | 27.8 steps/s
[Step=39700 Epoch=378.4] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=3.988 | 4221.6 samples/s | 66.0 steps/s
[Step=39750 Epoch=378.9] | Loss=0.00012 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=3.988 | 1810.4 samples/s | 28.3 steps/s
[Step=39800 Epoch=379.3] | Loss=0.00011 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=3.988 | 4147.7 samples/s | 64.8 steps/s
[Step=39850 Epoch=379.8] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=3.988 | 1853.9 samples/s | 29.0 steps/s
[Step=39900 Epoch=380.3] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=3.988 | 4001.5 samples/s | 62.5 steps/s
[Step=39950 Epoch=380.8] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=3.988 | 1854.5 samples/s | 29.0 steps/s
[Step=40000 Epoch=381.2] | Loss=0.00009 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=3.988 | 3951.3 samples/s | 61.7 steps/s
Client model saved at models/model-a5i5_froma5i5_sr1.0/client_iccad2012_4/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22826 | acc=0.9023 | tpr=0.8634 | fpr=0.0134 | 3740.8 samples/s | 14.6 steps/s
Avg test loss: 0.22780, Avg test acc: 0.90264, Avg tpr: 0.86524, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.39084 | acc=0.9070 | tpr=0.9425 | fpr=0.0937 | 3761.3 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.39790 | acc=0.9077 | tpr=0.9616 | fpr=0.0933 | 7092.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.40474 | acc=0.9065 | tpr=0.9625 | fpr=0.0945 | 7197.1 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.40471 | acc=0.9059 | tpr=0.9617 | fpr=0.0951 | 7334.7 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.40143 | acc=0.9066 | tpr=0.9616 | fpr=0.0944 | 6770.0 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.40364 | acc=0.9065 | tpr=0.9622 | fpr=0.0945 | 7345.4 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.40726 | acc=0.9059 | tpr=0.9618 | fpr=0.0952 | 7184.6 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.40910 | acc=0.9060 | tpr=0.9628 | fpr=0.0950 | 7039.2 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.41284 | acc=0.9060 | tpr=0.9649 | fpr=0.0951 | 7024.1 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.41295 | acc=0.9056 | tpr=0.9665 | fpr=0.0955 | 7016.1 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.41085 | acc=0.9059 | tpr=0.9658 | fpr=0.0951 | 13014.7 samples/s | 50.8 steps/s
Avg test loss: 0.41050, Avg test acc: 0.90596, Avg tpr: 0.96513, Avg fpr: 0.09511, total FA: 13206
