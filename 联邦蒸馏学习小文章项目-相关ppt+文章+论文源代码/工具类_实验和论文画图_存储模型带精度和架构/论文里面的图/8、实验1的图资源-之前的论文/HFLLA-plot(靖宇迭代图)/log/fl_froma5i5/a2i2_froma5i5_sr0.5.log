#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-a2i2_froma5i5_sr0.5/client_asml1_0', 'models/model-a2i2_froma5i5_sr0.5/client_asml1_1', 'models/model-a2i2_froma5i5_sr0.5/client_asml1_2', 'models/model-a2i2_froma5i5_sr0.5/client_asml1_3', 'models/model-a2i2_froma5i5_sr0.5/client_asml1_4', 'models/model-a2i2_froma5i5_sr0.5/client_iccad2012_0', 'models/model-a2i2_froma5i5_sr0.5/client_iccad2012_1', 'models/model-a2i2_froma5i5_sr0.5/client_iccad2012_2', 'models/model-a2i2_froma5i5_sr0.5/client_iccad2012_3', 'models/model-a2i2_froma5i5_sr0.5/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35620 | Reg=0.00356 | acc=0.5156 | L2-Norm=18.862 | L2-Norm(final)=2.106 | 2606.5 samples/s | 40.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29503 | Reg=0.00339 | acc=0.7656 | L2-Norm=18.412 | L2-Norm(final)=2.099 | 4497.0 samples/s | 70.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24811 | Reg=0.00333 | acc=0.8125 | L2-Norm=18.241 | L2-Norm(final)=2.113 | 4266.7 samples/s | 66.7 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21998 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.137 | L2-Norm(final)=2.123 | 4324.9 samples/s | 67.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20108 | Reg=0.00326 | acc=0.8594 | L2-Norm=18.067 | L2-Norm(final)=2.134 | 5859.2 samples/s | 91.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18568 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.016 | L2-Norm(final)=2.143 | 1788.3 samples/s | 27.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16919 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.983 | L2-Norm(final)=2.153 | 4516.8 samples/s | 70.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15958 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.960 | L2-Norm(final)=2.163 | 4540.9 samples/s | 71.0 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15060 | Reg=0.00322 | acc=0.9219 | L2-Norm=17.942 | L2-Norm(final)=2.172 | 5601.0 samples/s | 87.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14133 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.929 | L2-Norm(final)=2.182 | 1823.9 samples/s | 28.5 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13293 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.920 | L2-Norm(final)=2.192 | 4245.4 samples/s | 66.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12723 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.912 | L2-Norm(final)=2.201 | 4486.4 samples/s | 70.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12185 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.908 | L2-Norm(final)=2.210 | 5229.6 samples/s | 81.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11624 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.906 | L2-Norm(final)=2.218 | 1835.0 samples/s | 28.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11061 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.906 | L2-Norm(final)=2.227 | 4474.0 samples/s | 69.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10627 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=2.236 | 4506.3 samples/s | 70.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10190 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.910 | L2-Norm(final)=2.244 | 4841.8 samples/s | 75.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35148 | Reg=0.00356 | acc=0.5156 | L2-Norm=18.862 | L2-Norm(final)=2.106 | 3600.4 samples/s | 56.3 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30317 | Reg=0.00338 | acc=0.8438 | L2-Norm=18.385 | L2-Norm(final)=2.098 | 4303.7 samples/s | 67.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25707 | Reg=0.00331 | acc=0.8438 | L2-Norm=18.199 | L2-Norm(final)=2.110 | 4444.6 samples/s | 69.4 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22832 | Reg=0.00327 | acc=0.8594 | L2-Norm=18.085 | L2-Norm(final)=2.120 | 4533.8 samples/s | 70.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20720 | Reg=0.00324 | acc=0.9062 | L2-Norm=18.004 | L2-Norm(final)=2.129 | 6033.3 samples/s | 94.3 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18646 | Reg=0.00322 | acc=0.9375 | L2-Norm=17.948 | L2-Norm(final)=2.139 | 1732.8 samples/s | 27.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17243 | Reg=0.00321 | acc=0.9219 | L2-Norm=17.908 | L2-Norm(final)=2.149 | 4473.0 samples/s | 69.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16170 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.879 | L2-Norm(final)=2.158 | 4458.5 samples/s | 69.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15269 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.858 | L2-Norm(final)=2.168 | 5698.0 samples/s | 89.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14240 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.844 | L2-Norm(final)=2.178 | 1788.7 samples/s | 27.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13387 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.834 | L2-Norm(final)=2.190 | 4520.7 samples/s | 70.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12728 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.826 | L2-Norm(final)=2.200 | 4520.9 samples/s | 70.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12212 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.822 | L2-Norm(final)=2.209 | 5399.4 samples/s | 84.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11633 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.820 | L2-Norm(final)=2.218 | 1802.6 samples/s | 28.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11050 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.820 | L2-Norm(final)=2.227 | 4468.3 samples/s | 69.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10582 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.820 | L2-Norm(final)=2.235 | 4470.9 samples/s | 69.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10157 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.243 | 5081.4 samples/s | 79.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18593 | acc=0.8629 | tpr=0.9040 | fpr=0.2265 | 3826.1 samples/s | 14.9 steps/s
Avg test loss: 0.18635, Avg test acc: 0.86101, Avg tpr: 0.90266, Avg fpr: 0.23061, total FA: 1799

Testing server on iccad2012
[Step=  50] | Loss=0.78801 | acc=0.0985 | tpr=0.8584 | fpr=0.9151 | 3820.5 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.78697 | acc=0.0974 | tpr=0.8465 | fpr=0.9166 | 7261.5 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.78782 | acc=0.0976 | tpr=0.8343 | fpr=0.9160 | 7141.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.78787 | acc=0.0986 | tpr=0.8350 | fpr=0.9148 | 7230.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.78905 | acc=0.0985 | tpr=0.8297 | fpr=0.9148 | 7258.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.78914 | acc=0.0987 | tpr=0.8255 | fpr=0.9146 | 7465.0 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.78921 | acc=0.0985 | tpr=0.8259 | fpr=0.9147 | 6975.5 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.78938 | acc=0.0986 | tpr=0.8293 | fpr=0.9146 | 7335.1 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.78932 | acc=0.0991 | tpr=0.8320 | fpr=0.9143 | 7017.3 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.78968 | acc=0.0989 | tpr=0.8326 | fpr=0.9144 | 7368.4 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.78947 | acc=0.0989 | tpr=0.8333 | fpr=0.9145 | 12955.0 samples/s | 50.6 steps/s
Avg test loss: 0.78948, Avg test acc: 0.09882, Avg tpr: 0.83360, Avg fpr: 0.91454, total FA: 126982

server round 1/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.17087 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.468 | L2-Norm(final)=2.219 | 3635.9 samples/s | 56.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.13957 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.535 | L2-Norm(final)=2.255 | 4441.0 samples/s | 69.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.12386 | Reg=0.00309 | acc=0.8750 | L2-Norm=17.568 | L2-Norm(final)=2.264 | 4497.1 samples/s | 70.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.11331 | Reg=0.00309 | acc=0.9062 | L2-Norm=17.587 | L2-Norm(final)=2.273 | 4614.4 samples/s | 72.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10737 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.606 | L2-Norm(final)=2.281 | 6002.5 samples/s | 93.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.09721 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.622 | L2-Norm(final)=2.290 | 1745.6 samples/s | 27.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09127 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.635 | L2-Norm(final)=2.299 | 4516.3 samples/s | 70.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08788 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.645 | L2-Norm(final)=2.305 | 4607.6 samples/s | 72.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08384 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.657 | L2-Norm(final)=2.312 | 5656.2 samples/s | 88.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07913 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=2.319 | 1756.0 samples/s | 27.4 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07514 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.680 | L2-Norm(final)=2.326 | 4479.7 samples/s | 70.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07241 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=2.332 | 4441.3 samples/s | 69.4 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07011 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.702 | L2-Norm(final)=2.337 | 5333.4 samples/s | 83.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06728 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.711 | L2-Norm(final)=2.342 | 1803.4 samples/s | 28.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06437 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.719 | L2-Norm(final)=2.347 | 4489.2 samples/s | 70.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06165 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.727 | L2-Norm(final)=2.351 | 4533.5 samples/s | 70.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06006 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.733 | L2-Norm(final)=2.356 | 5067.8 samples/s | 79.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.47125 | Reg=0.00305 | acc=0.5000 | L2-Norm=17.468 | L2-Norm(final)=2.213 | 3552.7 samples/s | 55.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13022 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.355 | L2-Norm(final)=2.222 | 4194.1 samples/s | 65.5 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.07172 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=2.251 | 5727.3 samples/s | 89.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.04863 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=2.269 | 1682.2 samples/s | 26.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.03665 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.266 | L2-Norm(final)=2.283 | 5346.5 samples/s | 83.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.02937 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=2.293 | 1761.0 samples/s | 27.5 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.02449 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=2.301 | 5023.8 samples/s | 78.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02100 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.086 | L2-Norm(final)=2.307 | 1785.1 samples/s | 27.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01839 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.022 | L2-Norm(final)=2.312 | 4645.7 samples/s | 72.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01635 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=2.316 | 1818.2 samples/s | 28.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01472 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.891 | L2-Norm(final)=2.320 | 4376.4 samples/s | 68.4 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01338 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=2.324 | 1882.8 samples/s | 29.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01227 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.760 | L2-Norm(final)=2.329 | 4256.4 samples/s | 66.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01133 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=2.334 | 1865.6 samples/s | 29.1 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01052 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=2.339 | 4338.1 samples/s | 67.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00982 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.567 | L2-Norm(final)=2.344 | 1905.2 samples/s | 29.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00921 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=2.349 | 4233.8 samples/s | 66.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20407 | acc=0.8103 | tpr=0.7452 | fpr=0.0483 | 3782.1 samples/s | 14.8 steps/s
Avg test loss: 0.20626, Avg test acc: 0.80768, Avg tpr: 0.74308, Avg fpr: 0.05025, total FA: 392

Testing server on iccad2012
[Step=  50] | Loss=0.54046 | acc=0.4284 | tpr=0.9027 | fpr=0.5801 | 3805.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.53824 | acc=0.4318 | tpr=0.8891 | fpr=0.5768 | 7429.1 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.53963 | acc=0.4306 | tpr=0.8833 | fpr=0.5777 | 7166.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.54029 | acc=0.4320 | tpr=0.8874 | fpr=0.5763 | 7218.0 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.54049 | acc=0.4317 | tpr=0.8812 | fpr=0.5765 | 7233.9 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.54061 | acc=0.4316 | tpr=0.8895 | fpr=0.5767 | 7531.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.54116 | acc=0.4318 | tpr=0.8898 | fpr=0.5765 | 7088.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.54232 | acc=0.4304 | tpr=0.8873 | fpr=0.5779 | 7282.9 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.54334 | acc=0.4301 | tpr=0.8870 | fpr=0.5782 | 7062.5 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.54316 | acc=0.4301 | tpr=0.8877 | fpr=0.5782 | 7443.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.54275 | acc=0.4305 | tpr=0.8906 | fpr=0.5779 | 12914.1 samples/s | 50.4 steps/s
Avg test loss: 0.54289, Avg test acc: 0.43050, Avg tpr: 0.89065, Avg fpr: 0.57786, total FA: 80235

server round 2/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.33442 | Reg=0.00277 | acc=0.5938 | L2-Norm=16.647 | L2-Norm(final)=2.302 | 3547.6 samples/s | 55.4 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.07314 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=2.257 | 4144.9 samples/s | 64.8 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.04127 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=2.261 | 5740.3 samples/s | 89.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02791 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=2.264 | 1688.5 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02124 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=2.268 | 5351.6 samples/s | 83.6 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01701 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=2.271 | 1736.6 samples/s | 27.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01420 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.017 | L2-Norm(final)=2.273 | 4817.9 samples/s | 75.3 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01217 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=2.276 | 1782.8 samples/s | 27.9 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01065 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.915 | L2-Norm(final)=2.277 | 4520.8 samples/s | 70.6 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00947 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=2.279 | 1800.1 samples/s | 28.1 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00853 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=2.280 | 4283.8 samples/s | 66.9 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00775 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=2.281 | 1866.9 samples/s | 29.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00711 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.708 | L2-Norm(final)=2.282 | 4294.8 samples/s | 67.1 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00656 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=2.283 | 1876.3 samples/s | 29.3 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00609 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.606 | L2-Norm(final)=2.284 | 4171.5 samples/s | 65.2 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00569 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=2.284 | 1877.5 samples/s | 29.3 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00533 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=2.285 | 4247.5 samples/s | 66.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.28220 | Reg=0.00277 | acc=0.7188 | L2-Norm=16.647 | L2-Norm(final)=2.304 | 3743.4 samples/s | 58.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.07773 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.627 | L2-Norm(final)=2.301 | 3889.2 samples/s | 60.8 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.04462 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.640 | L2-Norm(final)=2.323 | 5830.2 samples/s | 91.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.03045 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.637 | L2-Norm(final)=2.341 | 1709.0 samples/s | 26.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.02294 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.618 | L2-Norm(final)=2.355 | 5349.5 samples/s | 83.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.01837 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.587 | L2-Norm(final)=2.365 | 1741.9 samples/s | 27.2 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.01533 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.550 | L2-Norm(final)=2.373 | 4981.1 samples/s | 77.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01315 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.509 | L2-Norm(final)=2.379 | 1766.6 samples/s | 27.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01152 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.464 | L2-Norm(final)=2.385 | 4698.6 samples/s | 73.4 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01024 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=2.390 | 1835.4 samples/s | 28.7 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.00922 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.368 | L2-Norm(final)=2.394 | 4353.5 samples/s | 68.0 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00838 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=2.398 | 1888.4 samples/s | 29.5 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00769 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=2.402 | 4213.1 samples/s | 65.8 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00710 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=2.405 | 1886.0 samples/s | 29.5 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00659 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.161 | L2-Norm(final)=2.409 | 4202.2 samples/s | 65.7 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00615 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.108 | L2-Norm(final)=2.413 | 1898.6 samples/s | 29.7 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00577 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.055 | L2-Norm(final)=2.418 | 4278.2 samples/s | 66.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52195 | acc=0.5830 | tpr=0.4063 | fpr=0.0332 | 3792.9 samples/s | 14.8 steps/s
Avg test loss: 0.52764, Avg test acc: 0.58114, Avg tpr: 0.40572, Avg fpr: 0.03307, total FA: 258

Testing server on iccad2012
[Step=  50] | Loss=0.18825 | acc=0.8861 | tpr=0.9071 | fpr=0.1143 | 3782.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.19081 | acc=0.8863 | tpr=0.9275 | fpr=0.1144 | 7156.5 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.19344 | acc=0.8842 | tpr=0.9308 | fpr=0.1166 | 7267.9 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.19447 | acc=0.8850 | tpr=0.9344 | fpr=0.1159 | 7092.9 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.19367 | acc=0.8842 | tpr=0.9275 | fpr=0.1166 | 7385.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.19494 | acc=0.8835 | tpr=0.9302 | fpr=0.1174 | 7265.8 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.19583 | acc=0.8827 | tpr=0.9280 | fpr=0.1182 | 7149.3 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.19634 | acc=0.8822 | tpr=0.9261 | fpr=0.1186 | 7186.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.19852 | acc=0.8814 | tpr=0.9255 | fpr=0.1194 | 7290.1 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.19800 | acc=0.8810 | tpr=0.9278 | fpr=0.1199 | 7444.5 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.19737 | acc=0.8815 | tpr=0.9288 | fpr=0.1194 | 12439.0 samples/s | 48.6 steps/s
Avg test loss: 0.19735, Avg test acc: 0.88145, Avg tpr: 0.92868, Avg fpr: 0.11940, total FA: 16579

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.36556 | Reg=0.00257 | acc=0.7188 | L2-Norm=16.045 | L2-Norm(final)=2.370 | 3899.9 samples/s | 60.9 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.11526 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.198 | L2-Norm(final)=2.349 | 4008.3 samples/s | 62.6 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.09712 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.263 | L2-Norm(final)=2.354 | 4454.2 samples/s | 69.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.08952 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.303 | L2-Norm(final)=2.358 | 4463.5 samples/s | 69.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08263 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.338 | L2-Norm(final)=2.363 | 6022.3 samples/s | 94.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.07418 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.369 | L2-Norm(final)=2.371 | 1742.6 samples/s | 27.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.06815 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.394 | L2-Norm(final)=2.379 | 4536.1 samples/s | 70.9 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.06480 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.417 | L2-Norm(final)=2.386 | 4515.6 samples/s | 70.6 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06192 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.438 | L2-Norm(final)=2.392 | 5529.8 samples/s | 86.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05821 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=2.398 | 1788.4 samples/s | 27.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.05538 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.476 | L2-Norm(final)=2.405 | 4517.8 samples/s | 70.6 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05368 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.495 | L2-Norm(final)=2.411 | 4501.7 samples/s | 70.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05191 | Reg=0.00273 | acc=0.9531 | L2-Norm=16.513 | L2-Norm(final)=2.416 | 5232.2 samples/s | 81.8 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.04991 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=2.421 | 1836.5 samples/s | 28.7 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.04834 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=2.426 | 4475.5 samples/s | 69.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04684 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.562 | L2-Norm(final)=2.430 | 4446.9 samples/s | 69.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04558 | Reg=0.00275 | acc=0.9219 | L2-Norm=16.576 | L2-Norm(final)=2.435 | 4861.9 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.36074 | Reg=0.00257 | acc=0.7344 | L2-Norm=16.045 | L2-Norm(final)=2.370 | 3858.3 samples/s | 60.3 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12240 | Reg=0.00262 | acc=0.8594 | L2-Norm=16.185 | L2-Norm(final)=2.353 | 4067.8 samples/s | 63.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10148 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.246 | L2-Norm(final)=2.359 | 4433.3 samples/s | 69.3 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08709 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.281 | L2-Norm(final)=2.366 | 4390.2 samples/s | 68.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08026 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.312 | L2-Norm(final)=2.373 | 5993.6 samples/s | 93.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07191 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.341 | L2-Norm(final)=2.380 | 1738.4 samples/s | 27.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06597 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.366 | L2-Norm(final)=2.389 | 4463.8 samples/s | 69.7 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06296 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.390 | L2-Norm(final)=2.397 | 4475.2 samples/s | 69.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06023 | Reg=0.00269 | acc=0.9375 | L2-Norm=16.412 | L2-Norm(final)=2.404 | 5540.7 samples/s | 86.6 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05681 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.433 | L2-Norm(final)=2.411 | 1766.3 samples/s | 27.6 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05414 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.454 | L2-Norm(final)=2.417 | 4540.9 samples/s | 71.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05210 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=2.422 | 4474.8 samples/s | 69.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05025 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=2.427 | 5355.6 samples/s | 83.7 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04848 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.506 | L2-Norm(final)=2.431 | 1799.5 samples/s | 28.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04651 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.523 | L2-Norm(final)=2.436 | 4445.6 samples/s | 69.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04495 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.539 | L2-Norm(final)=2.440 | 4474.0 samples/s | 69.9 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04372 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.554 | L2-Norm(final)=2.444 | 5013.3 samples/s | 78.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50308 | acc=0.6230 | tpr=0.4621 | fpr=0.0278 | 3766.0 samples/s | 14.7 steps/s
Avg test loss: 0.50976, Avg test acc: 0.61936, Avg tpr: 0.45818, Avg fpr: 0.02615, total FA: 204

Testing server on iccad2012
[Step=  50] | Loss=0.24176 | acc=0.8686 | tpr=0.9248 | fpr=0.1324 | 3830.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.24528 | acc=0.8681 | tpr=0.9360 | fpr=0.1331 | 7073.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.24924 | acc=0.8657 | tpr=0.9424 | fpr=0.1357 | 7361.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.25122 | acc=0.8664 | tpr=0.9454 | fpr=0.1351 | 7120.1 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.25043 | acc=0.8651 | tpr=0.9424 | fpr=0.1363 | 7345.5 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.25240 | acc=0.8646 | tpr=0.9462 | fpr=0.1369 | 7296.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.25366 | acc=0.8635 | tpr=0.9449 | fpr=0.1379 | 7328.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.25443 | acc=0.8635 | tpr=0.9404 | fpr=0.1379 | 7213.1 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.25747 | acc=0.8627 | tpr=0.9406 | fpr=0.1387 | 7179.3 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.25693 | acc=0.8624 | tpr=0.9414 | fpr=0.1391 | 7234.6 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.25613 | acc=0.8625 | tpr=0.9415 | fpr=0.1390 | 12758.1 samples/s | 49.8 steps/s
Avg test loss: 0.25608, Avg test acc: 0.86239, Avg tpr: 0.94136, Avg fpr: 0.13904, total FA: 19306

server round 4/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.40261 | Reg=0.00244 | acc=0.6719 | L2-Norm=15.627 | L2-Norm(final)=2.426 | 3804.3 samples/s | 59.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.10755 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.792 | L2-Norm(final)=2.400 | 4114.5 samples/s | 64.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08430 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.866 | L2-Norm(final)=2.410 | 4495.8 samples/s | 70.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07609 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.914 | L2-Norm(final)=2.419 | 4440.0 samples/s | 69.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07130 | Reg=0.00255 | acc=0.9375 | L2-Norm=15.957 | L2-Norm(final)=2.427 | 6037.2 samples/s | 94.3 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06358 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.992 | L2-Norm(final)=2.432 | 1738.4 samples/s | 27.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05920 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.021 | L2-Norm(final)=2.438 | 4470.4 samples/s | 69.8 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05646 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.045 | L2-Norm(final)=2.443 | 4489.9 samples/s | 70.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05434 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.068 | L2-Norm(final)=2.447 | 5565.6 samples/s | 87.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05517 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.092 | L2-Norm(final)=2.450 | 1782.3 samples/s | 27.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05364 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.120 | L2-Norm(final)=2.453 | 4539.4 samples/s | 70.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05185 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.147 | L2-Norm(final)=2.456 | 4485.5 samples/s | 70.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05033 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=2.460 | 5303.8 samples/s | 82.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04799 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.193 | L2-Norm(final)=2.463 | 1843.1 samples/s | 28.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04653 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.213 | L2-Norm(final)=2.466 | 4611.9 samples/s | 72.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04465 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=2.470 | 4399.4 samples/s | 68.7 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04333 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.248 | L2-Norm(final)=2.473 | 4929.7 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.06093 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.627 | L2-Norm(final)=2.428 | 3851.8 samples/s | 60.2 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02799 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.850 | L2-Norm(final)=2.421 | 3702.2 samples/s | 57.8 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02103 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.980 | L2-Norm(final)=2.406 | 5684.7 samples/s | 88.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01409 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.024 | L2-Norm(final)=2.404 | 1689.1 samples/s | 26.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01061 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.021 | L2-Norm(final)=2.405 | 5338.8 samples/s | 83.4 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00851 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.000 | L2-Norm(final)=2.406 | 1715.1 samples/s | 26.8 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00710 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=2.407 | 4965.8 samples/s | 77.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00608 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.934 | L2-Norm(final)=2.409 | 1764.5 samples/s | 27.6 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00533 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.895 | L2-Norm(final)=2.410 | 4569.8 samples/s | 71.4 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00474 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.855 | L2-Norm(final)=2.411 | 1824.2 samples/s | 28.5 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00426 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.813 | L2-Norm(final)=2.412 | 4332.8 samples/s | 67.7 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00388 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.771 | L2-Norm(final)=2.413 | 1874.2 samples/s | 29.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00356 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=2.414 | 4287.6 samples/s | 67.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00328 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.685 | L2-Norm(final)=2.415 | 1880.3 samples/s | 29.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00305 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.641 | L2-Norm(final)=2.415 | 4273.6 samples/s | 66.8 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00285 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=2.416 | 1918.6 samples/s | 30.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00267 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.555 | L2-Norm(final)=2.417 | 4246.1 samples/s | 66.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57154 | acc=0.5731 | tpr=0.3857 | fpr=0.0198 | 3814.2 samples/s | 14.9 steps/s
Avg test loss: 0.58288, Avg test acc: 0.56843, Avg tpr: 0.38078, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.19574 | acc=0.8963 | tpr=0.9204 | fpr=0.1041 | 3847.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.19846 | acc=0.8952 | tpr=0.9275 | fpr=0.1054 | 7104.4 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.20139 | acc=0.8935 | tpr=0.9337 | fpr=0.1072 | 7058.4 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.20313 | acc=0.8940 | tpr=0.9355 | fpr=0.1068 | 7330.6 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.20228 | acc=0.8932 | tpr=0.9319 | fpr=0.1075 | 7229.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.20459 | acc=0.8929 | tpr=0.9375 | fpr=0.1079 | 7196.3 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.20572 | acc=0.8925 | tpr=0.9380 | fpr=0.1083 | 7176.4 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.20652 | acc=0.8924 | tpr=0.9338 | fpr=0.1083 | 7483.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.20901 | acc=0.8919 | tpr=0.9343 | fpr=0.1089 | 7067.0 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.20842 | acc=0.8915 | tpr=0.9361 | fpr=0.1093 | 7122.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.20765 | acc=0.8916 | tpr=0.9355 | fpr=0.1092 | 13534.2 samples/s | 52.9 steps/s
Avg test loss: 0.20755, Avg test acc: 0.89159, Avg tpr: 0.93502, Avg fpr: 0.10920, total FA: 15162

server round 5/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.05388 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.416 | L2-Norm(final)=2.425 | 3709.4 samples/s | 58.0 steps/s
[Step=1650 Epoch=15.6] | Loss=0.01621 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.565 | L2-Norm(final)=2.420 | 3914.7 samples/s | 61.2 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00959 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=2.419 | 5828.8 samples/s | 91.1 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00655 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=2.421 | 1673.1 samples/s | 26.1 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00493 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.646 | L2-Norm(final)=2.424 | 5376.4 samples/s | 84.0 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00395 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.626 | L2-Norm(final)=2.426 | 1739.2 samples/s | 27.2 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00329 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.599 | L2-Norm(final)=2.427 | 4878.7 samples/s | 76.2 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00282 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.570 | L2-Norm(final)=2.428 | 1794.6 samples/s | 28.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00247 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.538 | L2-Norm(final)=2.429 | 4537.5 samples/s | 70.9 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00220 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.505 | L2-Norm(final)=2.430 | 1807.3 samples/s | 28.2 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00198 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.472 | L2-Norm(final)=2.431 | 4254.5 samples/s | 66.5 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00180 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=2.432 | 1853.8 samples/s | 29.0 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00165 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.404 | L2-Norm(final)=2.433 | 4255.1 samples/s | 66.5 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00152 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.370 | L2-Norm(final)=2.434 | 1867.0 samples/s | 29.2 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00142 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.335 | L2-Norm(final)=2.434 | 4350.7 samples/s | 68.0 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00132 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.301 | L2-Norm(final)=2.435 | 1864.4 samples/s | 29.1 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00124 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=2.436 | 4251.8 samples/s | 66.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.08187 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.416 | L2-Norm(final)=2.424 | 3911.5 samples/s | 61.1 steps/s
[Step=1650 Epoch=15.7] | Loss=0.02690 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.615 | L2-Norm(final)=2.424 | 3714.9 samples/s | 58.0 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01582 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.719 | L2-Norm(final)=2.409 | 5699.7 samples/s | 89.1 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01097 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.743 | L2-Norm(final)=2.409 | 1686.4 samples/s | 26.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00833 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.735 | L2-Norm(final)=2.413 | 5249.1 samples/s | 82.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00667 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.712 | L2-Norm(final)=2.416 | 1719.1 samples/s | 26.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00556 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.682 | L2-Norm(final)=2.418 | 4942.3 samples/s | 77.2 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00477 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.647 | L2-Norm(final)=2.420 | 1776.2 samples/s | 27.8 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00418 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.609 | L2-Norm(final)=2.422 | 4658.6 samples/s | 72.8 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00371 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.570 | L2-Norm(final)=2.424 | 1835.0 samples/s | 28.7 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00334 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=2.425 | 4321.4 samples/s | 67.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00304 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=2.426 | 1887.9 samples/s | 29.5 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00279 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.449 | L2-Norm(final)=2.428 | 4224.8 samples/s | 66.0 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00257 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.408 | L2-Norm(final)=2.429 | 1879.4 samples/s | 29.4 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00239 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=2.430 | 4188.5 samples/s | 65.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00223 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.327 | L2-Norm(final)=2.430 | 1890.0 samples/s | 29.5 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00209 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.286 | L2-Norm(final)=2.431 | 4257.8 samples/s | 66.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.60777 | acc=0.5764 | tpr=0.3895 | fpr=0.0178 | 3795.2 samples/s | 14.8 steps/s
Avg test loss: 0.61736, Avg test acc: 0.57164, Avg tpr: 0.38427, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.22538 | acc=0.8805 | tpr=0.9204 | fpr=0.1202 | 3821.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.22824 | acc=0.8823 | tpr=0.9254 | fpr=0.1185 | 7240.8 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.23138 | acc=0.8819 | tpr=0.9337 | fpr=0.1191 | 7235.0 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.23286 | acc=0.8831 | tpr=0.9355 | fpr=0.1178 | 7514.1 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.23219 | acc=0.8828 | tpr=0.9362 | fpr=0.1181 | 6977.9 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.23396 | acc=0.8824 | tpr=0.9396 | fpr=0.1187 | 7244.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.23498 | acc=0.8824 | tpr=0.9411 | fpr=0.1187 | 7387.2 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.23591 | acc=0.8819 | tpr=0.9382 | fpr=0.1191 | 7131.6 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.23864 | acc=0.8808 | tpr=0.9367 | fpr=0.1202 | 7296.7 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.23815 | acc=0.8806 | tpr=0.9370 | fpr=0.1205 | 7105.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.23715 | acc=0.8807 | tpr=0.9387 | fpr=0.1204 | 13184.8 samples/s | 51.5 steps/s
Avg test loss: 0.23707, Avg test acc: 0.88065, Avg tpr: 0.93819, Avg fpr: 0.12040, total FA: 16717

server round 6/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.44025 | Reg=0.00231 | acc=0.7188 | L2-Norm=15.189 | L2-Norm(final)=2.472 | 3774.5 samples/s | 59.0 steps/s
[Step=2450 Epoch=11.9] | Loss=0.10107 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.306 | L2-Norm(final)=2.450 | 4218.9 samples/s | 65.9 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08080 | Reg=0.00237 | acc=0.8750 | L2-Norm=15.380 | L2-Norm(final)=2.457 | 4444.8 samples/s | 69.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07265 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.428 | L2-Norm(final)=2.459 | 4419.7 samples/s | 69.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06805 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.472 | L2-Norm(final)=2.463 | 6078.2 samples/s | 95.0 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06011 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.513 | L2-Norm(final)=2.467 | 1720.8 samples/s | 26.9 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05553 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.546 | L2-Norm(final)=2.473 | 4381.1 samples/s | 68.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05128 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.575 | L2-Norm(final)=2.479 | 4529.5 samples/s | 70.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04888 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.601 | L2-Norm(final)=2.484 | 5548.4 samples/s | 86.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04582 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.623 | L2-Norm(final)=2.489 | 1786.5 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04274 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.643 | L2-Norm(final)=2.494 | 4477.0 samples/s | 70.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04050 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.662 | L2-Norm(final)=2.500 | 4519.1 samples/s | 70.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.03929 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.679 | L2-Norm(final)=2.504 | 5227.5 samples/s | 81.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03747 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.695 | L2-Norm(final)=2.508 | 1823.1 samples/s | 28.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03599 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.710 | L2-Norm(final)=2.513 | 4490.7 samples/s | 70.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03542 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.725 | L2-Norm(final)=2.516 | 4509.8 samples/s | 70.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03489 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=2.518 | 4761.4 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.05648 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.189 | L2-Norm(final)=2.473 | 3709.0 samples/s | 58.0 steps/s
[Step=2450 Epoch=23.2] | Loss=0.01208 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=2.466 | 3886.9 samples/s | 60.7 steps/s
[Step=2500 Epoch=23.7] | Loss=0.00897 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.411 | L2-Norm(final)=2.458 | 5727.8 samples/s | 89.5 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00615 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.434 | L2-Norm(final)=2.459 | 1681.3 samples/s | 26.3 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00480 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.430 | L2-Norm(final)=2.461 | 5260.9 samples/s | 82.2 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00390 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=2.464 | 1740.6 samples/s | 27.2 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00327 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=2.466 | 4842.6 samples/s | 75.7 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00281 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.376 | L2-Norm(final)=2.468 | 1775.0 samples/s | 27.7 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00246 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.348 | L2-Norm(final)=2.470 | 4606.0 samples/s | 72.0 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00219 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.317 | L2-Norm(final)=2.471 | 1798.7 samples/s | 28.1 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00197 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.285 | L2-Norm(final)=2.472 | 4288.8 samples/s | 67.0 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00179 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.252 | L2-Norm(final)=2.473 | 1840.0 samples/s | 28.7 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00164 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=2.474 | 4242.2 samples/s | 66.3 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00151 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.183 | L2-Norm(final)=2.475 | 1882.2 samples/s | 29.4 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00141 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.148 | L2-Norm(final)=2.476 | 4211.6 samples/s | 65.8 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00131 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.113 | L2-Norm(final)=2.476 | 1867.1 samples/s | 29.2 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00123 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.078 | L2-Norm(final)=2.477 | 4243.2 samples/s | 66.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.70565 | acc=0.5397 | tpr=0.3344 | fpr=0.0146 | 3818.5 samples/s | 14.9 steps/s
Avg test loss: 0.71507, Avg test acc: 0.53622, Avg tpr: 0.33118, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.21251 | acc=0.9000 | tpr=0.9204 | fpr=0.1004 | 3803.1 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.21574 | acc=0.8991 | tpr=0.9275 | fpr=0.1015 | 7150.9 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.21992 | acc=0.8971 | tpr=0.9366 | fpr=0.1036 | 7293.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.22177 | acc=0.8986 | tpr=0.9399 | fpr=0.1021 | 7310.8 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.22128 | acc=0.8984 | tpr=0.9389 | fpr=0.1024 | 7182.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.22332 | acc=0.8971 | tpr=0.9433 | fpr=0.1037 | 7173.6 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.22399 | acc=0.8971 | tpr=0.9436 | fpr=0.1038 | 7194.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.22509 | acc=0.8964 | tpr=0.9420 | fpr=0.1044 | 7521.4 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.22777 | acc=0.8956 | tpr=0.9406 | fpr=0.1052 | 6892.5 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.22718 | acc=0.8951 | tpr=0.9423 | fpr=0.1058 | 7413.2 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.22585 | acc=0.8954 | tpr=0.9439 | fpr=0.1055 | 12603.5 samples/s | 49.2 steps/s
Avg test loss: 0.22572, Avg test acc: 0.89536, Avg tpr: 0.94334, Avg fpr: 0.10551, total FA: 14650

server round 7/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.57443 | Reg=0.00225 | acc=0.5938 | L2-Norm=15.000 | L2-Norm(final)=2.487 | 3613.9 samples/s | 56.5 steps/s
[Step=3250 Epoch=15.8] | Loss=0.10592 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.137 | L2-Norm(final)=2.449 | 4414.9 samples/s | 69.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.08117 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.222 | L2-Norm(final)=2.454 | 4454.0 samples/s | 69.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07047 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.280 | L2-Norm(final)=2.461 | 4466.1 samples/s | 69.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06434 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.323 | L2-Norm(final)=2.464 | 6105.6 samples/s | 95.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05602 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.356 | L2-Norm(final)=2.467 | 1766.9 samples/s | 27.6 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05093 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.385 | L2-Norm(final)=2.474 | 4551.4 samples/s | 71.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04781 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.408 | L2-Norm(final)=2.479 | 4498.0 samples/s | 70.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04619 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.430 | L2-Norm(final)=2.483 | 5577.3 samples/s | 87.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04475 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.452 | L2-Norm(final)=2.486 | 1790.7 samples/s | 28.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04224 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.477 | L2-Norm(final)=2.490 | 4424.2 samples/s | 69.1 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04062 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.501 | L2-Norm(final)=2.495 | 4395.0 samples/s | 68.7 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03996 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.525 | L2-Norm(final)=2.498 | 5250.9 samples/s | 82.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03833 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.549 | L2-Norm(final)=2.501 | 1826.0 samples/s | 28.5 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03666 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.572 | L2-Norm(final)=2.505 | 4494.3 samples/s | 70.2 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03547 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.592 | L2-Norm(final)=2.509 | 4451.3 samples/s | 69.6 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03482 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.612 | L2-Norm(final)=2.512 | 4967.1 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.05760 | Reg=0.00225 | acc=0.9531 | L2-Norm=15.000 | L2-Norm(final)=2.488 | 3783.6 samples/s | 59.1 steps/s
[Step=3250 Epoch=30.8] | Loss=0.01645 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.161 | L2-Norm(final)=2.485 | 3928.3 samples/s | 61.4 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01157 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.326 | L2-Norm(final)=2.469 | 5634.5 samples/s | 88.0 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00858 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.380 | L2-Norm(final)=2.467 | 1692.0 samples/s | 26.4 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00714 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.404 | L2-Norm(final)=2.464 | 5180.9 samples/s | 81.0 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00595 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=2.460 | 1707.7 samples/s | 26.7 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00501 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.423 | L2-Norm(final)=2.458 | 4952.6 samples/s | 77.4 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00430 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.415 | L2-Norm(final)=2.458 | 1785.2 samples/s | 27.9 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00377 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=2.458 | 4460.1 samples/s | 69.7 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00335 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.379 | L2-Norm(final)=2.458 | 1790.0 samples/s | 28.0 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00302 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.354 | L2-Norm(final)=2.458 | 4201.3 samples/s | 65.6 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00274 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.327 | L2-Norm(final)=2.459 | 1855.6 samples/s | 29.0 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00251 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.298 | L2-Norm(final)=2.459 | 4238.7 samples/s | 66.2 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00232 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.268 | L2-Norm(final)=2.459 | 1836.6 samples/s | 28.7 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00215 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.237 | L2-Norm(final)=2.459 | 4224.3 samples/s | 66.0 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00201 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.205 | L2-Norm(final)=2.459 | 1902.8 samples/s | 29.7 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00189 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=2.460 | 4198.8 samples/s | 65.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.68664 | acc=0.5507 | tpr=0.3506 | fpr=0.0149 | 3908.5 samples/s | 15.3 steps/s
Avg test loss: 0.69491, Avg test acc: 0.54592, Avg tpr: 0.34586, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.20354 | acc=0.9038 | tpr=0.9336 | fpr=0.0967 | 3803.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.20731 | acc=0.9024 | tpr=0.9339 | fpr=0.0982 | 7495.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.21172 | acc=0.9017 | tpr=0.9424 | fpr=0.0991 | 7379.2 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.21376 | acc=0.9022 | tpr=0.9432 | fpr=0.0986 | 7037.9 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.21343 | acc=0.9020 | tpr=0.9432 | fpr=0.0987 | 7226.4 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.21554 | acc=0.9010 | tpr=0.9447 | fpr=0.0998 | 7134.4 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.21644 | acc=0.9008 | tpr=0.9461 | fpr=0.1000 | 7326.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.21743 | acc=0.9003 | tpr=0.9447 | fpr=0.1005 | 7251.1 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.21994 | acc=0.8995 | tpr=0.9426 | fpr=0.1012 | 7232.8 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.21934 | acc=0.8992 | tpr=0.9441 | fpr=0.1016 | 7382.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.21848 | acc=0.8993 | tpr=0.9443 | fpr=0.1015 | 12810.7 samples/s | 50.0 steps/s
Avg test loss: 0.21826, Avg test acc: 0.89929, Avg tpr: 0.94414, Avg fpr: 0.10152, total FA: 14096

server round 8/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.42764 | Reg=0.00223 | acc=0.7031 | L2-Norm=14.946 | L2-Norm(final)=2.481 | 3973.7 samples/s | 62.1 steps/s
[Step=4050 Epoch=19.7] | Loss=0.10061 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.148 | L2-Norm(final)=2.453 | 4034.6 samples/s | 63.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.08146 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.226 | L2-Norm(final)=2.451 | 4561.9 samples/s | 71.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06943 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.270 | L2-Norm(final)=2.453 | 4537.2 samples/s | 70.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06401 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.305 | L2-Norm(final)=2.456 | 6019.6 samples/s | 94.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05758 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.338 | L2-Norm(final)=2.460 | 1751.5 samples/s | 27.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05282 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.368 | L2-Norm(final)=2.464 | 4478.0 samples/s | 70.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04886 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.396 | L2-Norm(final)=2.470 | 4498.9 samples/s | 70.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04637 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.420 | L2-Norm(final)=2.474 | 5637.8 samples/s | 88.1 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04387 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.442 | L2-Norm(final)=2.478 | 1764.1 samples/s | 27.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04144 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.463 | L2-Norm(final)=2.483 | 4531.6 samples/s | 70.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03981 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.481 | L2-Norm(final)=2.487 | 4546.8 samples/s | 71.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03847 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.499 | L2-Norm(final)=2.491 | 5201.3 samples/s | 81.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03668 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.516 | L2-Norm(final)=2.495 | 1826.2 samples/s | 28.5 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03520 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.532 | L2-Norm(final)=2.500 | 4591.4 samples/s | 71.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03396 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.546 | L2-Norm(final)=2.504 | 4441.0 samples/s | 69.4 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03306 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.561 | L2-Norm(final)=2.508 | 4824.6 samples/s | 75.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.01589 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=2.483 | 3480.5 samples/s | 54.4 steps/s
[Step=4050 Epoch=38.4] | Loss=0.01615 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=2.464 | 4234.5 samples/s | 66.2 steps/s
[Step=4100 Epoch=38.9] | Loss=0.01031 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.200 | L2-Norm(final)=2.456 | 5603.5 samples/s | 87.6 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00725 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.229 | L2-Norm(final)=2.455 | 1669.7 samples/s | 26.1 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00570 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.232 | L2-Norm(final)=2.457 | 5200.7 samples/s | 81.3 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00457 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.222 | L2-Norm(final)=2.459 | 1720.5 samples/s | 26.9 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00381 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.200 | L2-Norm(final)=2.460 | 4979.7 samples/s | 77.8 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00326 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.172 | L2-Norm(final)=2.462 | 1780.2 samples/s | 27.8 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00286 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.141 | L2-Norm(final)=2.463 | 4557.0 samples/s | 71.2 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00254 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=2.465 | 1827.1 samples/s | 28.5 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00229 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=2.466 | 4439.0 samples/s | 69.4 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00208 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.036 | L2-Norm(final)=2.467 | 1862.7 samples/s | 29.1 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00191 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.999 | L2-Norm(final)=2.468 | 4257.9 samples/s | 66.5 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00176 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=2.468 | 1865.3 samples/s | 29.1 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00163 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=2.469 | 4321.5 samples/s | 67.5 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00153 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.889 | L2-Norm(final)=2.470 | 1878.2 samples/s | 29.3 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00143 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.852 | L2-Norm(final)=2.471 | 4209.2 samples/s | 65.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.58764 | acc=0.6138 | tpr=0.4455 | fpr=0.0208 | 3841.1 samples/s | 15.0 steps/s
Avg test loss: 0.59564, Avg test acc: 0.61006, Avg tpr: 0.44180, Avg fpr: 0.01987, total FA: 155

Testing server on iccad2012
[Step=  50] | Loss=0.24289 | acc=0.8848 | tpr=0.9425 | fpr=0.1163 | 3841.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.24636 | acc=0.8847 | tpr=0.9424 | fpr=0.1164 | 7488.5 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.25123 | acc=0.8827 | tpr=0.9524 | fpr=0.1185 | 7395.9 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.25318 | acc=0.8834 | tpr=0.9541 | fpr=0.1179 | 6952.4 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.25351 | acc=0.8831 | tpr=0.9511 | fpr=0.1181 | 7315.5 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.25576 | acc=0.8824 | tpr=0.9542 | fpr=0.1189 | 7301.9 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.25679 | acc=0.8823 | tpr=0.9543 | fpr=0.1191 | 7397.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.25772 | acc=0.8818 | tpr=0.9508 | fpr=0.1195 | 7206.8 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.26063 | acc=0.8811 | tpr=0.9494 | fpr=0.1202 | 7065.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.25992 | acc=0.8808 | tpr=0.9515 | fpr=0.1205 | 7187.7 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.25861 | acc=0.8810 | tpr=0.9522 | fpr=0.1203 | 13652.7 samples/s | 53.3 steps/s
Avg test loss: 0.25838, Avg test acc: 0.88102, Avg tpr: 0.95206, Avg fpr: 0.12028, total FA: 16700

server round 9/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.34725 | Reg=0.00220 | acc=0.7500 | L2-Norm=14.819 | L2-Norm(final)=2.491 | 3743.9 samples/s | 58.5 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09483 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.926 | L2-Norm(final)=2.467 | 4238.1 samples/s | 66.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07562 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.002 | L2-Norm(final)=2.475 | 4494.6 samples/s | 70.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06504 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.049 | L2-Norm(final)=2.479 | 4476.5 samples/s | 69.9 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06031 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.086 | L2-Norm(final)=2.481 | 6033.3 samples/s | 94.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.05383 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.118 | L2-Norm(final)=2.483 | 1742.9 samples/s | 27.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05026 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.144 | L2-Norm(final)=2.485 | 4524.3 samples/s | 70.7 steps/s
[Step=2750 Epoch=13.4] | Loss=0.04622 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.168 | L2-Norm(final)=2.487 | 4530.5 samples/s | 70.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04370 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.189 | L2-Norm(final)=2.490 | 5716.2 samples/s | 89.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04094 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.209 | L2-Norm(final)=2.493 | 1783.7 samples/s | 27.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.03855 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.226 | L2-Norm(final)=2.496 | 4410.6 samples/s | 68.9 steps/s
[Step=2950 Epoch=14.4] | Loss=0.03701 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.243 | L2-Norm(final)=2.499 | 4487.6 samples/s | 70.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.03594 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.258 | L2-Norm(final)=2.501 | 5168.5 samples/s | 80.8 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03427 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.274 | L2-Norm(final)=2.505 | 1827.9 samples/s | 28.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03270 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=2.508 | 4465.5 samples/s | 69.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03165 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.303 | L2-Norm(final)=2.511 | 4494.0 samples/s | 70.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03105 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.317 | L2-Norm(final)=2.514 | 5098.5 samples/s | 79.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.09216 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.819 | L2-Norm(final)=2.488 | 3833.9 samples/s | 59.9 steps/s
[Step=4850 Epoch=46.0] | Loss=0.01321 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.981 | L2-Norm(final)=2.478 | 3997.3 samples/s | 62.5 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00864 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.074 | L2-Norm(final)=2.472 | 5787.0 samples/s | 90.4 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00595 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.102 | L2-Norm(final)=2.473 | 1699.2 samples/s | 26.5 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00501 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.100 | L2-Norm(final)=2.475 | 5228.5 samples/s | 81.7 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00410 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.094 | L2-Norm(final)=2.479 | 1749.2 samples/s | 27.3 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00342 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.075 | L2-Norm(final)=2.482 | 4872.2 samples/s | 76.1 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00293 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.047 | L2-Norm(final)=2.485 | 1772.6 samples/s | 27.7 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00257 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=2.487 | 4650.6 samples/s | 72.7 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00228 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.980 | L2-Norm(final)=2.489 | 1830.2 samples/s | 28.6 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00206 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.943 | L2-Norm(final)=2.490 | 4399.6 samples/s | 68.7 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00187 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=2.492 | 1848.7 samples/s | 28.9 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00172 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.865 | L2-Norm(final)=2.493 | 4336.4 samples/s | 67.8 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00158 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.826 | L2-Norm(final)=2.494 | 1875.0 samples/s | 29.3 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00147 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.787 | L2-Norm(final)=2.495 | 4247.9 samples/s | 66.4 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00137 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.747 | L2-Norm(final)=2.496 | 1892.9 samples/s | 29.6 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00129 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.708 | L2-Norm(final)=2.497 | 4175.7 samples/s | 65.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45127 | acc=0.6726 | tpr=0.5363 | fpr=0.0315 | 3817.1 samples/s | 14.9 steps/s
Avg test loss: 0.45876, Avg test acc: 0.67157, Avg tpr: 0.53605, Avg fpr: 0.03038, total FA: 237

Testing server on iccad2012
[Step=  50] | Loss=0.27851 | acc=0.8673 | tpr=0.9602 | fpr=0.1343 | 3899.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.28247 | acc=0.8656 | tpr=0.9638 | fpr=0.1362 | 6917.5 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.28692 | acc=0.8645 | tpr=0.9712 | fpr=0.1375 | 7494.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.28824 | acc=0.8651 | tpr=0.9727 | fpr=0.1368 | 7663.6 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.28806 | acc=0.8649 | tpr=0.9668 | fpr=0.1370 | 7125.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.28962 | acc=0.8645 | tpr=0.9687 | fpr=0.1374 | 7553.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.29085 | acc=0.8644 | tpr=0.9681 | fpr=0.1375 | 7658.6 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.29245 | acc=0.8638 | tpr=0.9661 | fpr=0.1381 | 7339.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.29527 | acc=0.8632 | tpr=0.9654 | fpr=0.1387 | 7260.5 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.29460 | acc=0.8629 | tpr=0.9665 | fpr=0.1390 | 7195.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.29331 | acc=0.8629 | tpr=0.9670 | fpr=0.1390 | 13572.2 samples/s | 53.0 steps/s
Avg test loss: 0.29308, Avg test acc: 0.86296, Avg tpr: 0.96712, Avg fpr: 0.13893, total FA: 19290

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.23814 | Reg=0.00212 | acc=0.7969 | L2-Norm=14.554 | L2-Norm(final)=2.511 | 3801.5 samples/s | 59.4 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08643 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.607 | L2-Norm(final)=2.495 | 4146.7 samples/s | 64.8 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06457 | Reg=0.00215 | acc=0.9219 | L2-Norm=14.646 | L2-Norm(final)=2.507 | 4494.7 samples/s | 70.2 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05318 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=2.519 | 4498.0 samples/s | 70.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04744 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.693 | L2-Norm(final)=2.529 | 6059.5 samples/s | 94.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03992 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.710 | L2-Norm(final)=2.538 | 1741.9 samples/s | 27.2 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03582 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.723 | L2-Norm(final)=2.548 | 4476.4 samples/s | 69.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03296 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.735 | L2-Norm(final)=2.556 | 4488.9 samples/s | 70.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03037 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.746 | L2-Norm(final)=2.565 | 5622.3 samples/s | 87.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03408 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.754 | L2-Norm(final)=2.568 | 1786.2 samples/s | 27.9 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03215 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=2.570 | 4422.5 samples/s | 69.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03050 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=2.574 | 4548.7 samples/s | 71.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02920 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.786 | L2-Norm(final)=2.578 | 5275.8 samples/s | 82.4 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02822 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=2.582 | 1856.0 samples/s | 29.0 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02710 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.804 | L2-Norm(final)=2.586 | 4548.9 samples/s | 71.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02601 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.811 | L2-Norm(final)=2.590 | 4509.4 samples/s | 70.5 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02491 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.818 | L2-Norm(final)=2.593 | 4943.8 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.33754 | Reg=0.00212 | acc=0.7656 | L2-Norm=14.554 | L2-Norm(final)=2.511 | 3879.9 samples/s | 60.6 steps/s
[Step=3250 Epoch=15.9] | Loss=0.08950 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.602 | L2-Norm(final)=2.501 | 4097.5 samples/s | 64.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06568 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.637 | L2-Norm(final)=2.508 | 4488.5 samples/s | 70.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.05359 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.660 | L2-Norm(final)=2.517 | 4519.1 samples/s | 70.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04615 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.676 | L2-Norm(final)=2.524 | 6138.2 samples/s | 95.9 steps/s
[Step=3450 Epoch=16.8] | Loss=0.03960 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.691 | L2-Norm(final)=2.532 | 1743.3 samples/s | 27.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03579 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.704 | L2-Norm(final)=2.539 | 4513.6 samples/s | 70.5 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03299 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.716 | L2-Norm(final)=2.545 | 4452.3 samples/s | 69.6 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03035 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.725 | L2-Norm(final)=2.550 | 5699.5 samples/s | 89.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.02855 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.734 | L2-Norm(final)=2.555 | 1775.8 samples/s | 27.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.02686 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.743 | L2-Norm(final)=2.560 | 4453.5 samples/s | 69.6 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02539 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=2.565 | 4541.2 samples/s | 71.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02451 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.758 | L2-Norm(final)=2.569 | 5398.0 samples/s | 84.3 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02366 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.765 | L2-Norm(final)=2.572 | 1841.1 samples/s | 28.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02247 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.771 | L2-Norm(final)=2.576 | 4443.9 samples/s | 69.4 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02141 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=2.580 | 4361.9 samples/s | 68.2 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02073 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.783 | L2-Norm(final)=2.584 | 5026.6 samples/s | 78.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.75298 | acc=0.5649 | tpr=0.3733 | fpr=0.0191 | 3786.4 samples/s | 14.8 steps/s
Avg test loss: 0.76297, Avg test acc: 0.56098, Avg tpr: 0.37011, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.22315 | acc=0.9174 | tpr=0.9558 | fpr=0.0833 | 3796.7 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.22865 | acc=0.9154 | tpr=0.9616 | fpr=0.0855 | 7187.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.23451 | acc=0.9132 | tpr=0.9640 | fpr=0.0878 | 7164.0 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.23688 | acc=0.9140 | tpr=0.9661 | fpr=0.0870 | 7612.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.23587 | acc=0.9140 | tpr=0.9607 | fpr=0.0868 | 7267.2 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.23735 | acc=0.9139 | tpr=0.9629 | fpr=0.0870 | 7132.0 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.23877 | acc=0.9138 | tpr=0.9618 | fpr=0.0871 | 7348.0 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.24041 | acc=0.9131 | tpr=0.9579 | fpr=0.0877 | 7109.1 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.24356 | acc=0.9124 | tpr=0.9557 | fpr=0.0884 | 7110.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.24262 | acc=0.9125 | tpr=0.9568 | fpr=0.0883 | 7139.7 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.24110 | acc=0.9129 | tpr=0.9586 | fpr=0.0879 | 13775.8 samples/s | 53.8 steps/s
Avg test loss: 0.24073, Avg test acc: 0.91297, Avg tpr: 0.95880, Avg fpr: 0.08787, total FA: 12200

server round 11/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.40262 | Reg=0.00205 | acc=0.7969 | L2-Norm=14.309 | L2-Norm(final)=2.554 | 3614.3 samples/s | 56.5 steps/s
[Step=5650 Epoch=27.6] | Loss=0.10568 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.396 | L2-Norm(final)=2.529 | 4500.4 samples/s | 70.3 steps/s
[Step=5700 Epoch=27.8] | Loss=0.07872 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.445 | L2-Norm(final)=2.535 | 4461.5 samples/s | 69.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.06331 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.478 | L2-Norm(final)=2.545 | 4435.1 samples/s | 69.3 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05527 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.503 | L2-Norm(final)=2.555 | 6013.4 samples/s | 94.0 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04866 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=2.565 | 1761.1 samples/s | 27.5 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04343 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.545 | L2-Norm(final)=2.574 | 4385.0 samples/s | 68.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03975 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.562 | L2-Norm(final)=2.582 | 4514.3 samples/s | 70.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03649 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=2.590 | 5526.4 samples/s | 86.3 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03388 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.592 | L2-Norm(final)=2.598 | 1785.0 samples/s | 27.9 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03137 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.605 | L2-Norm(final)=2.606 | 4526.0 samples/s | 70.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02997 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.617 | L2-Norm(final)=2.613 | 4546.2 samples/s | 71.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02868 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=2.619 | 5193.3 samples/s | 81.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02741 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=2.625 | 1814.1 samples/s | 28.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02613 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.650 | L2-Norm(final)=2.630 | 4463.0 samples/s | 69.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02497 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.658 | L2-Norm(final)=2.636 | 4485.3 samples/s | 70.1 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02395 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.666 | L2-Norm(final)=2.641 | 4869.9 samples/s | 76.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=22.8] | Loss=0.02904 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.309 | L2-Norm(final)=2.555 | 3693.9 samples/s | 57.7 steps/s
[Step=2450 Epoch=23.3] | Loss=0.00496 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.362 | L2-Norm(final)=2.550 | 3849.7 samples/s | 60.2 steps/s
[Step=2500 Epoch=23.8] | Loss=0.00268 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=2.554 | 5742.0 samples/s | 89.7 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00184 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.370 | L2-Norm(final)=2.558 | 1656.6 samples/s | 25.9 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00139 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=2.562 | 5275.2 samples/s | 82.4 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00112 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=2.564 | 1719.9 samples/s | 26.9 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00093 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=2.566 | 4954.1 samples/s | 77.4 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00080 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=2.567 | 1782.5 samples/s | 27.9 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00071 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=2.569 | 4584.6 samples/s | 71.6 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00063 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=2.570 | 1812.5 samples/s | 28.3 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00057 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.271 | L2-Norm(final)=2.571 | 4299.4 samples/s | 67.2 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00052 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=2.572 | 1851.0 samples/s | 28.9 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00048 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.573 | 4205.9 samples/s | 65.7 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00044 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.574 | 1890.0 samples/s | 29.5 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00041 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=2.575 | 4109.8 samples/s | 64.2 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00038 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=2.575 | 1895.9 samples/s | 29.6 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00036 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=2.576 | 4159.5 samples/s | 65.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.69105 | acc=0.6116 | tpr=0.4428 | fpr=0.0221 | 3755.1 samples/s | 14.7 steps/s
Avg test loss: 0.70257, Avg test acc: 0.60914, Avg tpr: 0.44180, Avg fpr: 0.02282, total FA: 178

Testing server on iccad2012
[Step=  50] | Loss=0.23056 | acc=0.9180 | tpr=0.9381 | fpr=0.0823 | 3795.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.23809 | acc=0.9150 | tpr=0.9488 | fpr=0.0856 | 7233.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.24359 | acc=0.9140 | tpr=0.9553 | fpr=0.0868 | 7225.2 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.24620 | acc=0.9142 | tpr=0.9585 | fpr=0.0866 | 7283.3 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.24463 | acc=0.9142 | tpr=0.9537 | fpr=0.0865 | 7126.9 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.24588 | acc=0.9143 | tpr=0.9549 | fpr=0.0865 | 7527.4 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.24789 | acc=0.9141 | tpr=0.9549 | fpr=0.0867 | 6956.2 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.24955 | acc=0.9135 | tpr=0.9524 | fpr=0.0872 | 7452.5 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.25247 | acc=0.9129 | tpr=0.9503 | fpr=0.0878 | 7092.7 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.25146 | acc=0.9129 | tpr=0.9515 | fpr=0.0878 | 7182.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.25006 | acc=0.9131 | tpr=0.9534 | fpr=0.0877 | 13326.3 samples/s | 52.1 steps/s
Avg test loss: 0.24967, Avg test acc: 0.91311, Avg tpr: 0.95365, Avg fpr: 0.08763, total FA: 12167

server round 12/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.35526 | Reg=0.00201 | acc=0.7656 | L2-Norm=14.190 | L2-Norm(final)=2.608 | 3732.4 samples/s | 58.3 steps/s
[Step=4050 Epoch=19.8] | Loss=0.09177 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=2.580 | 4169.4 samples/s | 65.1 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06539 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=2.586 | 4281.4 samples/s | 66.9 steps/s
[Step=4150 Epoch=20.3] | Loss=0.05331 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.340 | L2-Norm(final)=2.594 | 4540.0 samples/s | 70.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04703 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.361 | L2-Norm(final)=2.600 | 6084.3 samples/s | 95.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04137 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=2.606 | 1755.1 samples/s | 27.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03650 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=2.614 | 4559.7 samples/s | 71.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03361 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.418 | L2-Norm(final)=2.620 | 4489.2 samples/s | 70.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03159 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.432 | L2-Norm(final)=2.626 | 5676.4 samples/s | 88.7 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02959 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=2.630 | 1779.7 samples/s | 27.8 steps/s
[Step=4500 Epoch=22.0] | Loss=0.02776 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.457 | L2-Norm(final)=2.635 | 4451.5 samples/s | 69.6 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02593 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.467 | L2-Norm(final)=2.639 | 4362.7 samples/s | 68.2 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02458 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.475 | L2-Norm(final)=2.643 | 5313.7 samples/s | 83.0 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02363 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.483 | L2-Norm(final)=2.647 | 1794.2 samples/s | 28.0 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02263 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.489 | L2-Norm(final)=2.650 | 4342.4 samples/s | 67.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02171 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=2.653 | 4483.2 samples/s | 70.1 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02087 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.501 | L2-Norm(final)=2.656 | 4963.5 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.4] | Loss=0.02107 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.190 | L2-Norm(final)=2.609 | 3687.3 samples/s | 57.6 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00642 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.272 | L2-Norm(final)=2.596 | 3965.4 samples/s | 62.0 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00422 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=2.602 | 5690.7 samples/s | 88.9 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00292 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=2.605 | 1689.1 samples/s | 26.4 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00220 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=2.608 | 5215.9 samples/s | 81.5 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00177 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.280 | L2-Norm(final)=2.612 | 1723.7 samples/s | 26.9 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00147 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=2.615 | 4888.7 samples/s | 76.4 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00126 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=2.618 | 1786.5 samples/s | 27.9 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00111 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.620 | 4507.1 samples/s | 70.4 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00098 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.622 | 1795.7 samples/s | 28.1 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00089 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=2.624 | 4337.5 samples/s | 67.8 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00080 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=2.625 | 1868.1 samples/s | 29.2 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00074 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=2.626 | 4340.9 samples/s | 67.8 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00068 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.628 | 1873.8 samples/s | 29.3 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00063 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.629 | 4287.6 samples/s | 67.0 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00059 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=2.629 | 1895.2 samples/s | 29.6 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00055 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.086 | L2-Norm(final)=2.630 | 4186.1 samples/s | 65.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.59310 | acc=0.6481 | tpr=0.4974 | fpr=0.0245 | 3785.8 samples/s | 14.8 steps/s
Avg test loss: 0.60526, Avg test acc: 0.64845, Avg tpr: 0.49991, Avg fpr: 0.02487, total FA: 194

Testing server on iccad2012
[Step=  50] | Loss=0.25552 | acc=0.9037 | tpr=0.9425 | fpr=0.0970 | 3806.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.26446 | acc=0.9005 | tpr=0.9552 | fpr=0.1006 | 7246.9 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.26983 | acc=0.8992 | tpr=0.9611 | fpr=0.1019 | 7152.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.27234 | acc=0.8994 | tpr=0.9628 | fpr=0.1017 | 7305.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.27083 | acc=0.8992 | tpr=0.9581 | fpr=0.1019 | 7279.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.27180 | acc=0.8995 | tpr=0.9600 | fpr=0.1016 | 7344.9 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.27403 | acc=0.8990 | tpr=0.9606 | fpr=0.1022 | 7155.9 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.27572 | acc=0.8987 | tpr=0.9573 | fpr=0.1023 | 7389.4 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.27874 | acc=0.8983 | tpr=0.9562 | fpr=0.1028 | 7107.4 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.27769 | acc=0.8983 | tpr=0.9568 | fpr=0.1027 | 7182.8 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.27614 | acc=0.8986 | tpr=0.9586 | fpr=0.1025 | 12803.8 samples/s | 50.0 steps/s
Avg test loss: 0.27578, Avg test acc: 0.89868, Avg tpr: 0.95880, Avg fpr: 0.10241, total FA: 14220

server round 13/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.41489 | Reg=0.00199 | acc=0.7500 | L2-Norm=14.089 | L2-Norm(final)=2.637 | 4018.3 samples/s | 62.8 steps/s
[Step=4850 Epoch=23.7] | Loss=0.08092 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.149 | L2-Norm(final)=2.612 | 3970.8 samples/s | 62.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06060 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.192 | L2-Norm(final)=2.616 | 4462.0 samples/s | 69.7 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05033 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=2.620 | 4503.2 samples/s | 70.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04512 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.243 | L2-Norm(final)=2.623 | 6048.2 samples/s | 94.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03911 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.262 | L2-Norm(final)=2.627 | 1718.8 samples/s | 26.9 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03495 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=2.633 | 4488.6 samples/s | 70.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03183 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=2.639 | 4484.0 samples/s | 70.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02970 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=2.644 | 5675.4 samples/s | 88.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02751 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.318 | L2-Norm(final)=2.649 | 1748.5 samples/s | 27.3 steps/s
[Step=5300 Epoch=25.9] | Loss=0.02564 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=2.653 | 4530.6 samples/s | 70.8 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02424 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=2.658 | 4461.5 samples/s | 69.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02304 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=2.662 | 5284.8 samples/s | 82.6 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02208 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=2.665 | 1781.8 samples/s | 27.8 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02124 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.357 | L2-Norm(final)=2.669 | 4501.0 samples/s | 70.3 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02035 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.363 | L2-Norm(final)=2.672 | 4626.9 samples/s | 72.3 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01936 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.369 | L2-Norm(final)=2.676 | 5057.0 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.02533 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.089 | L2-Norm(final)=2.638 | 3704.4 samples/s | 57.9 steps/s
[Step=4050 Epoch=38.5] | Loss=0.00487 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=2.644 | 4045.7 samples/s | 63.2 steps/s
[Step=4100 Epoch=39.0] | Loss=0.00268 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=2.651 | 5907.2 samples/s | 92.3 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00180 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=2.657 | 1705.9 samples/s | 26.7 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00137 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.189 | L2-Norm(final)=2.660 | 5250.9 samples/s | 82.0 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00110 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=2.663 | 1749.9 samples/s | 27.3 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00092 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=2.665 | 5034.6 samples/s | 78.7 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00079 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=2.666 | 1813.4 samples/s | 28.3 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00069 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=2.668 | 4627.4 samples/s | 72.3 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00061 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=2.669 | 1857.6 samples/s | 29.0 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00055 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=2.670 | 4394.0 samples/s | 68.7 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00050 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=2.671 | 1874.7 samples/s | 29.3 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00046 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=2.672 | 4216.4 samples/s | 65.9 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00043 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=2.673 | 1888.1 samples/s | 29.5 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00040 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=2.673 | 4247.8 samples/s | 66.4 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00037 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=2.674 | 1917.9 samples/s | 30.0 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00035 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=2.675 | 4266.7 samples/s | 66.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.72640 | acc=0.6137 | tpr=0.4451 | fpr=0.0203 | 3808.6 samples/s | 14.9 steps/s
Avg test loss: 0.73925, Avg test acc: 0.60990, Avg tpr: 0.44169, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.22676 | acc=0.9236 | tpr=0.9381 | fpr=0.0767 | 3783.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.23493 | acc=0.9207 | tpr=0.9510 | fpr=0.0799 | 7382.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.24105 | acc=0.9195 | tpr=0.9553 | fpr=0.0812 | 7268.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.24391 | acc=0.9197 | tpr=0.9596 | fpr=0.0810 | 7358.2 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.24190 | acc=0.9195 | tpr=0.9537 | fpr=0.0811 | 7322.0 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.24313 | acc=0.9198 | tpr=0.9556 | fpr=0.0809 | 7387.1 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.24523 | acc=0.9196 | tpr=0.9562 | fpr=0.0810 | 7387.3 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.24698 | acc=0.9191 | tpr=0.9530 | fpr=0.0815 | 7155.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.25007 | acc=0.9186 | tpr=0.9508 | fpr=0.0820 | 7106.5 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.24904 | acc=0.9185 | tpr=0.9520 | fpr=0.0821 | 7156.9 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.24749 | acc=0.9187 | tpr=0.9534 | fpr=0.0819 | 13205.3 samples/s | 51.6 steps/s
Avg test loss: 0.24704, Avg test acc: 0.91880, Avg tpr: 0.95365, Avg fpr: 0.08184, total FA: 11363

server round 14/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.70902 | Reg=0.00196 | acc=0.5938 | L2-Norm=14.010 | L2-Norm(final)=2.655 | 3590.9 samples/s | 56.1 steps/s
[Step=5650 Epoch=27.6] | Loss=0.09253 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.094 | L2-Norm(final)=2.624 | 4474.4 samples/s | 69.9 steps/s
[Step=5700 Epoch=27.8] | Loss=0.06492 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.141 | L2-Norm(final)=2.634 | 4555.4 samples/s | 71.2 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05474 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.168 | L2-Norm(final)=2.640 | 4478.9 samples/s | 70.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04791 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.190 | L2-Norm(final)=2.645 | 6087.3 samples/s | 95.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04062 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.212 | L2-Norm(final)=2.652 | 1745.8 samples/s | 27.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03621 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.232 | L2-Norm(final)=2.660 | 4428.1 samples/s | 69.2 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03329 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=2.667 | 4603.1 samples/s | 71.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03179 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.261 | L2-Norm(final)=2.672 | 5660.2 samples/s | 88.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03024 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.274 | L2-Norm(final)=2.676 | 1772.0 samples/s | 27.7 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02857 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.285 | L2-Norm(final)=2.679 | 4411.8 samples/s | 68.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02714 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=2.683 | 4518.7 samples/s | 70.6 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02559 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=2.687 | 5392.9 samples/s | 84.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02428 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.316 | L2-Norm(final)=2.691 | 1838.3 samples/s | 28.7 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02312 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=2.695 | 4558.0 samples/s | 71.2 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02220 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=2.699 | 4538.8 samples/s | 70.9 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02151 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.340 | L2-Norm(final)=2.703 | 5091.8 samples/s | 79.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.7] | Loss=0.02685 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.010 | L2-Norm(final)=2.657 | 3890.0 samples/s | 60.8 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00757 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=2.653 | 3830.3 samples/s | 59.8 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00523 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=2.650 | 5804.2 samples/s | 90.7 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00368 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=2.654 | 1698.1 samples/s | 26.5 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00278 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.658 | 5289.7 samples/s | 82.7 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00223 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.660 | 1743.4 samples/s | 27.2 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00186 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=2.663 | 4974.7 samples/s | 77.7 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00160 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.664 | 1772.7 samples/s | 27.7 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00140 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=2.666 | 4450.5 samples/s | 69.5 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00124 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=2.667 | 1811.6 samples/s | 28.3 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00112 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=2.668 | 4255.9 samples/s | 66.5 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00102 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=2.669 | 1829.6 samples/s | 28.6 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00093 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=2.670 | 4143.1 samples/s | 64.7 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00086 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=2.671 | 1880.4 samples/s | 29.4 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00080 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=2.671 | 4116.6 samples/s | 64.3 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00075 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=2.672 | 1891.8 samples/s | 29.6 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00070 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=2.673 | 4079.4 samples/s | 63.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.63878 | acc=0.6399 | tpr=0.4844 | fpr=0.0223 | 3754.8 samples/s | 14.7 steps/s
Avg test loss: 0.65092, Avg test acc: 0.63715, Avg tpr: 0.48266, Avg fpr: 0.02307, total FA: 180

Testing server on iccad2012
[Step=  50] | Loss=0.24547 | acc=0.9122 | tpr=0.9381 | fpr=0.0883 | 3779.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.25383 | acc=0.9095 | tpr=0.9552 | fpr=0.0914 | 7125.9 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.26002 | acc=0.9087 | tpr=0.9611 | fpr=0.0922 | 7307.6 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.26304 | acc=0.9087 | tpr=0.9639 | fpr=0.0923 | 7230.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.26057 | acc=0.9090 | tpr=0.9590 | fpr=0.0920 | 7224.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.26187 | acc=0.9091 | tpr=0.9600 | fpr=0.0918 | 7216.7 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.26428 | acc=0.9089 | tpr=0.9612 | fpr=0.0920 | 7243.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.26577 | acc=0.9086 | tpr=0.9584 | fpr=0.0923 | 7052.2 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.26845 | acc=0.9084 | tpr=0.9572 | fpr=0.0925 | 7116.3 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.26723 | acc=0.9086 | tpr=0.9590 | fpr=0.0923 | 7214.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.26562 | acc=0.9089 | tpr=0.9598 | fpr=0.0920 | 12942.7 samples/s | 50.6 steps/s
Avg test loss: 0.26520, Avg test acc: 0.90895, Avg tpr: 0.95998, Avg fpr: 0.09198, total FA: 12771

server round 15/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.38606 | Reg=0.00196 | acc=0.7188 | L2-Norm=13.999 | L2-Norm(final)=2.660 | 3735.0 samples/s | 58.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.08548 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=2.632 | 4205.2 samples/s | 65.7 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05970 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.638 | 4528.2 samples/s | 70.8 steps/s
[Step=6550 Epoch=32.0] | Loss=0.05030 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.150 | L2-Norm(final)=2.646 | 4464.3 samples/s | 69.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04562 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.172 | L2-Norm(final)=2.650 | 6049.4 samples/s | 94.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03891 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.190 | L2-Norm(final)=2.655 | 1751.6 samples/s | 27.4 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03462 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.204 | L2-Norm(final)=2.660 | 4518.5 samples/s | 70.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03154 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.666 | 4508.2 samples/s | 70.4 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02989 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.227 | L2-Norm(final)=2.671 | 5699.5 samples/s | 89.1 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02784 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.676 | 1760.7 samples/s | 27.5 steps/s
[Step=6900 Epoch=33.7] | Loss=0.02580 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=2.681 | 4476.9 samples/s | 70.0 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02437 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=2.686 | 4455.6 samples/s | 69.6 steps/s
[Step=7000 Epoch=34.2] | Loss=0.02346 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=2.690 | 5304.0 samples/s | 82.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02253 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.272 | L2-Norm(final)=2.694 | 1822.4 samples/s | 28.5 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02148 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=2.698 | 4536.1 samples/s | 70.9 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02084 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.285 | L2-Norm(final)=2.701 | 4490.4 samples/s | 70.2 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02031 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.291 | L2-Norm(final)=2.704 | 5060.0 samples/s | 79.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.3] | Loss=0.06812 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.999 | L2-Norm(final)=2.659 | 3688.4 samples/s | 57.6 steps/s
[Step=5650 Epoch=53.7] | Loss=0.01118 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=2.638 | 3700.2 samples/s | 57.8 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00697 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=2.629 | 5787.6 samples/s | 90.4 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00477 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=2.631 | 1693.2 samples/s | 26.5 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00358 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=2.634 | 5332.0 samples/s | 83.3 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00288 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=2.637 | 1734.5 samples/s | 27.1 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00240 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.640 | 4985.1 samples/s | 77.9 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00206 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=2.642 | 1796.1 samples/s | 28.1 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00180 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=2.644 | 4599.6 samples/s | 71.9 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00161 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=2.645 | 1816.1 samples/s | 28.4 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00145 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=2.647 | 4372.2 samples/s | 68.3 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00132 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=2.648 | 1869.7 samples/s | 29.2 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00121 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.084 | L2-Norm(final)=2.649 | 4223.3 samples/s | 66.0 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00111 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=2.650 | 1912.4 samples/s | 29.9 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00104 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=2.652 | 4137.5 samples/s | 64.6 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00097 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=2.653 | 1900.6 samples/s | 29.7 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00091 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=2.654 | 4215.7 samples/s | 65.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.69574 | acc=0.6032 | tpr=0.4302 | fpr=0.0211 | 3791.2 samples/s | 14.8 steps/s
Avg test loss: 0.70865, Avg test acc: 0.60085, Avg tpr: 0.42869, Avg fpr: 0.02051, total FA: 160

Testing server on iccad2012
[Step=  50] | Loss=0.22025 | acc=0.9213 | tpr=0.9425 | fpr=0.0791 | 3799.8 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.22699 | acc=0.9189 | tpr=0.9552 | fpr=0.0818 | 7073.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.23265 | acc=0.9179 | tpr=0.9611 | fpr=0.0829 | 7431.5 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.23502 | acc=0.9186 | tpr=0.9639 | fpr=0.0823 | 7246.4 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.23302 | acc=0.9189 | tpr=0.9581 | fpr=0.0818 | 7059.9 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.23403 | acc=0.9191 | tpr=0.9578 | fpr=0.0816 | 7257.8 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.23601 | acc=0.9188 | tpr=0.9593 | fpr=0.0820 | 7120.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.23756 | acc=0.9183 | tpr=0.9568 | fpr=0.0824 | 7214.5 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.24020 | acc=0.9179 | tpr=0.9547 | fpr=0.0828 | 7116.0 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.23913 | acc=0.9179 | tpr=0.9573 | fpr=0.0828 | 5802.7 samples/s | 22.7 steps/s
[Step= 550] | Loss=0.23777 | acc=0.9182 | tpr=0.9582 | fpr=0.0826 | 13279.7 samples/s | 51.9 steps/s
Avg test loss: 0.23733, Avg test acc: 0.91822, Avg tpr: 0.95840, Avg fpr: 0.08251, total FA: 11457

server round 16/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.1] | Loss=0.07811 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.983 | L2-Norm(final)=2.654 | 3869.0 samples/s | 60.5 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00537 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=2.648 | 3621.4 samples/s | 56.6 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00286 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=2.652 | 5667.1 samples/s | 88.5 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00192 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=2.654 | 1650.1 samples/s | 25.8 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00144 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=2.656 | 5377.8 samples/s | 84.0 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00117 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.658 | 1728.0 samples/s | 27.0 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00097 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=2.659 | 4917.1 samples/s | 76.8 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00084 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.660 | 1764.8 samples/s | 27.6 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00073 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.661 | 4529.0 samples/s | 70.8 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00065 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=2.661 | 1811.6 samples/s | 28.3 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00059 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=2.662 | 4279.5 samples/s | 66.9 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00053 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=2.663 | 1868.9 samples/s | 29.2 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00049 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=2.663 | 4264.7 samples/s | 66.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00045 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=2.664 | 1859.4 samples/s | 29.1 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00042 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=2.664 | 4287.1 samples/s | 67.0 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00039 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=2.665 | 1853.8 samples/s | 29.0 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00037 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=2.665 | 4209.7 samples/s | 65.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.9] | Loss=0.02919 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.983 | L2-Norm(final)=2.654 | 3640.7 samples/s | 56.9 steps/s
[Step=6450 Epoch=61.4] | Loss=0.00547 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.652 | 3869.6 samples/s | 60.5 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00321 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=2.661 | 5685.1 samples/s | 88.8 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00215 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=2.668 | 1679.1 samples/s | 26.2 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00164 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.672 | 5289.7 samples/s | 82.7 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00131 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=2.675 | 1728.4 samples/s | 27.0 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00110 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=2.678 | 4945.5 samples/s | 77.3 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00094 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=2.680 | 1775.5 samples/s | 27.7 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00082 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=2.682 | 4547.0 samples/s | 71.0 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00073 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=2.684 | 1805.7 samples/s | 28.2 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00066 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=2.685 | 4278.1 samples/s | 66.8 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00060 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=2.686 | 1855.5 samples/s | 29.0 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00055 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=2.687 | 4194.4 samples/s | 65.5 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00051 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=2.689 | 1877.2 samples/s | 29.3 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00047 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=2.690 | 4326.1 samples/s | 67.6 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00044 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.691 | 1872.7 samples/s | 29.3 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00042 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=2.692 | 4190.2 samples/s | 65.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.60077 | acc=0.6635 | tpr=0.5164 | fpr=0.0171 | 3844.6 samples/s | 15.0 steps/s
Avg test loss: 0.61275, Avg test acc: 0.66235, Avg tpr: 0.51652, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.27447 | acc=0.8949 | tpr=0.9204 | fpr=0.1055 | 3775.9 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.28192 | acc=0.8938 | tpr=0.9318 | fpr=0.1069 | 7531.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.28614 | acc=0.8945 | tpr=0.9380 | fpr=0.1063 | 7072.5 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.28816 | acc=0.8953 | tpr=0.9443 | fpr=0.1056 | 4824.3 samples/s | 18.8 steps/s
[Step= 250] | Loss=0.28748 | acc=0.8950 | tpr=0.9424 | fpr=0.1058 | 7175.5 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.28840 | acc=0.8955 | tpr=0.9462 | fpr=0.1055 | 7400.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.28993 | acc=0.8955 | tpr=0.9487 | fpr=0.1055 | 6503.4 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.29129 | acc=0.8949 | tpr=0.9458 | fpr=0.1061 | 6783.5 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.29423 | acc=0.8942 | tpr=0.9430 | fpr=0.1067 | 7113.4 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.29337 | acc=0.8943 | tpr=0.9445 | fpr=0.1066 | 7486.0 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.29203 | acc=0.8946 | tpr=0.9467 | fpr=0.1063 | 13268.2 samples/s | 51.8 steps/s
Avg test loss: 0.29156, Avg test acc: 0.89469, Avg tpr: 0.94691, Avg fpr: 0.10626, total FA: 14754

server round 17/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.51065 | Reg=0.00192 | acc=0.7188 | L2-Norm=13.847 | L2-Norm(final)=2.707 | 3649.3 samples/s | 57.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.07801 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.932 | L2-Norm(final)=2.681 | 4395.0 samples/s | 68.7 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05303 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=2.685 | 4415.7 samples/s | 69.0 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04428 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.004 | L2-Norm(final)=2.690 | 4467.8 samples/s | 69.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03889 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.029 | L2-Norm(final)=2.697 | 6099.1 samples/s | 95.3 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03355 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.050 | L2-Norm(final)=2.705 | 1734.7 samples/s | 27.1 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03002 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.066 | L2-Norm(final)=2.711 | 4455.5 samples/s | 69.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02733 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=2.718 | 4495.3 samples/s | 70.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02566 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=2.723 | 5659.2 samples/s | 88.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02379 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.102 | L2-Norm(final)=2.729 | 1802.4 samples/s | 28.2 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02249 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=2.734 | 4425.0 samples/s | 69.1 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02099 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=2.739 | 4450.8 samples/s | 69.5 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02013 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=2.744 | 5263.0 samples/s | 82.2 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01924 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=2.749 | 1837.8 samples/s | 28.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01849 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.147 | L2-Norm(final)=2.753 | 4531.6 samples/s | 70.8 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01807 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=2.757 | 4455.9 samples/s | 69.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01759 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=2.761 | 4900.5 samples/s | 76.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.7] | Loss=0.04258 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.847 | L2-Norm(final)=2.707 | 3773.2 samples/s | 59.0 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00192 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=2.710 | 3855.2 samples/s | 60.2 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00111 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.955 | L2-Norm(final)=2.716 | 5813.8 samples/s | 90.8 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00091 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.950 | L2-Norm(final)=2.720 | 1675.2 samples/s | 26.2 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00125 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=2.720 | 5310.6 samples/s | 83.0 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00245 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.941 | L2-Norm(final)=2.718 | 1745.6 samples/s | 27.3 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00227 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=2.711 | 4973.3 samples/s | 77.7 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00197 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.948 | L2-Norm(final)=2.707 | 1792.7 samples/s | 28.0 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00172 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=2.705 | 4662.9 samples/s | 72.9 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00154 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=2.703 | 1842.9 samples/s | 28.8 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00138 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=2.702 | 4316.4 samples/s | 67.4 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00126 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=2.701 | 1882.4 samples/s | 29.4 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00115 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=2.700 | 4396.6 samples/s | 68.7 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00107 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=2.700 | 1877.9 samples/s | 29.3 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00099 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=2.700 | 4321.4 samples/s | 67.5 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00093 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.866 | L2-Norm(final)=2.700 | 1909.3 samples/s | 29.8 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00087 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.852 | L2-Norm(final)=2.700 | 4182.3 samples/s | 65.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.61752 | acc=0.6571 | tpr=0.5078 | fpr=0.0186 | 3810.3 samples/s | 14.9 steps/s
Avg test loss: 0.62950, Avg test acc: 0.65350, Avg tpr: 0.50405, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=0.24090 | acc=0.9100 | tpr=0.9248 | fpr=0.0903 | 3841.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.24740 | acc=0.9083 | tpr=0.9360 | fpr=0.0922 | 7323.8 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.25155 | acc=0.9083 | tpr=0.9409 | fpr=0.0923 | 4491.6 samples/s | 17.5 steps/s
[Step= 200] | Loss=0.25343 | acc=0.9093 | tpr=0.9443 | fpr=0.0913 | 7470.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.25224 | acc=0.9092 | tpr=0.9406 | fpr=0.0914 | 7428.8 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.25323 | acc=0.9095 | tpr=0.9425 | fpr=0.0911 | 7508.4 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.25489 | acc=0.9093 | tpr=0.9449 | fpr=0.0913 | 7219.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.25603 | acc=0.9090 | tpr=0.9420 | fpr=0.0916 | 7126.0 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.25877 | acc=0.9086 | tpr=0.9401 | fpr=0.0919 | 7255.0 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.25779 | acc=0.9085 | tpr=0.9423 | fpr=0.0921 | 7051.8 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.25633 | acc=0.9088 | tpr=0.9443 | fpr=0.0919 | 13265.1 samples/s | 51.8 steps/s
Avg test loss: 0.25588, Avg test acc: 0.90885, Avg tpr: 0.94453, Avg fpr: 0.09180, total FA: 12746

server round 18/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.2] | Loss=0.00819 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.739 | 3715.4 samples/s | 58.1 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00182 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=2.746 | 3983.6 samples/s | 62.2 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00094 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=2.751 | 5793.2 samples/s | 90.5 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00063 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=2.753 | 1697.3 samples/s | 26.5 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00048 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.755 | 5229.8 samples/s | 81.7 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00038 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=2.756 | 1741.7 samples/s | 27.2 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00032 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.757 | 4852.9 samples/s | 75.8 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00028 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=2.758 | 1785.1 samples/s | 27.9 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00024 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.759 | 4585.8 samples/s | 71.7 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00022 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=2.760 | 1808.2 samples/s | 28.3 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00020 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.761 | 4394.3 samples/s | 68.7 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00018 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=2.761 | 1863.4 samples/s | 29.1 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00016 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=2.762 | 4353.1 samples/s | 68.0 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00015 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=2.763 | 1871.9 samples/s | 29.2 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00014 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=2.763 | 4413.8 samples/s | 69.0 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00013 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=2.764 | 1883.4 samples/s | 29.4 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00012 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=2.764 | 4251.5 samples/s | 66.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.5] | Loss=0.02412 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.731 | L2-Norm(final)=2.738 | 3532.9 samples/s | 55.2 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00594 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.838 | L2-Norm(final)=2.732 | 2079.7 samples/s | 32.5 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00406 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=2.726 | 5240.2 samples/s | 81.9 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00274 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.726 | 1707.9 samples/s | 26.7 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00207 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=2.727 | 5283.6 samples/s | 82.6 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00172 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=2.729 | 1763.9 samples/s | 27.6 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00144 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=2.731 | 4979.4 samples/s | 77.8 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00124 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.863 | L2-Norm(final)=2.733 | 1795.6 samples/s | 28.1 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00108 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.846 | L2-Norm(final)=2.734 | 4634.8 samples/s | 72.4 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00096 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.828 | L2-Norm(final)=2.736 | 1841.7 samples/s | 28.8 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00087 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=2.737 | 4311.3 samples/s | 67.4 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00079 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=2.738 | 1893.5 samples/s | 29.6 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00072 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=2.738 | 4345.1 samples/s | 67.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00067 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=2.739 | 1891.6 samples/s | 29.6 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00062 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.740 | 4268.1 samples/s | 66.7 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00058 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=2.741 | 1873.0 samples/s | 29.3 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00054 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=2.741 | 4162.0 samples/s | 65.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57816 | acc=0.6895 | tpr=0.5551 | fpr=0.0186 | 3772.8 samples/s | 14.7 steps/s
Avg test loss: 0.59269, Avg test acc: 0.68427, Avg tpr: 0.54916, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.29138 | acc=0.8953 | tpr=0.9248 | fpr=0.1052 | 3745.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.29819 | acc=0.8948 | tpr=0.9360 | fpr=0.1060 | 7310.0 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.30330 | acc=0.8952 | tpr=0.9467 | fpr=0.1058 | 7127.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.30523 | acc=0.8964 | tpr=0.9497 | fpr=0.1045 | 7303.7 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.30455 | acc=0.8964 | tpr=0.9476 | fpr=0.1045 | 7128.6 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.30592 | acc=0.8964 | tpr=0.9491 | fpr=0.1045 | 7156.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.30811 | acc=0.8961 | tpr=0.9518 | fpr=0.1049 | 7151.5 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.30922 | acc=0.8959 | tpr=0.9486 | fpr=0.1050 | 7240.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.31271 | acc=0.8953 | tpr=0.9474 | fpr=0.1057 | 7015.6 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.31202 | acc=0.8949 | tpr=0.9485 | fpr=0.1060 | 7262.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.31027 | acc=0.8953 | tpr=0.9499 | fpr=0.1057 | 13297.9 samples/s | 51.9 steps/s
Avg test loss: 0.30977, Avg test acc: 0.89539, Avg tpr: 0.95008, Avg fpr: 0.10560, total FA: 14663

server round 19/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.35441 | Reg=0.00185 | acc=0.8594 | L2-Norm=13.616 | L2-Norm(final)=2.768 | 3792.3 samples/s | 59.3 steps/s
[Step=7250 Epoch=35.4] | Loss=0.06269 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=2.740 | 4220.2 samples/s | 65.9 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04379 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=2.745 | 4456.2 samples/s | 69.6 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03620 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.774 | L2-Norm(final)=2.753 | 4396.1 samples/s | 68.7 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03196 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.800 | L2-Norm(final)=2.761 | 6055.9 samples/s | 94.6 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02836 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.822 | L2-Norm(final)=2.768 | 1746.4 samples/s | 27.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02549 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.842 | L2-Norm(final)=2.775 | 4487.8 samples/s | 70.1 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02334 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=2.782 | 4423.5 samples/s | 69.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02180 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.874 | L2-Norm(final)=2.789 | 5636.4 samples/s | 88.1 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02040 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=2.794 | 1767.9 samples/s | 27.6 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01916 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=2.800 | 4482.3 samples/s | 70.0 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01860 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.908 | L2-Norm(final)=2.804 | 4433.1 samples/s | 69.3 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01783 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=2.808 | 5165.7 samples/s | 80.7 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01688 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.924 | L2-Norm(final)=2.813 | 1829.2 samples/s | 28.6 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01615 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=2.817 | 4479.0 samples/s | 70.0 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01562 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.821 | 4470.9 samples/s | 69.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01514 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=2.824 | 4865.0 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.00155 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=2.769 | 3683.3 samples/s | 57.6 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00365 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=2.767 | 4005.9 samples/s | 62.6 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00285 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=2.768 | 5627.7 samples/s | 87.9 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00213 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=2.765 | 1682.3 samples/s | 26.3 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00162 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=2.766 | 5196.9 samples/s | 81.2 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00130 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=2.768 | 1709.3 samples/s | 26.7 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00108 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=2.769 | 4906.6 samples/s | 76.7 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00093 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=2.771 | 1781.1 samples/s | 27.8 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00081 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.772 | 4611.8 samples/s | 72.1 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00072 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.773 | 1811.0 samples/s | 28.3 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00065 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.774 | 4355.8 samples/s | 68.1 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00059 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=2.775 | 1887.8 samples/s | 29.5 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00055 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=2.775 | 4179.4 samples/s | 65.3 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00050 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=2.776 | 1862.4 samples/s | 29.1 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00047 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=2.777 | 4204.2 samples/s | 65.7 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00044 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.778 | 1896.9 samples/s | 29.6 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00041 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=2.779 | 4244.7 samples/s | 66.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51687 | acc=0.7183 | tpr=0.5961 | fpr=0.0164 | 3845.3 samples/s | 15.0 steps/s
Avg test loss: 0.52927, Avg test acc: 0.71516, Avg tpr: 0.59311, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.32579 | acc=0.8805 | tpr=0.9425 | fpr=0.1206 | 3858.8 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.33221 | acc=0.8800 | tpr=0.9488 | fpr=0.1212 | 7424.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.33630 | acc=0.8807 | tpr=0.9582 | fpr=0.1208 | 7153.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.33890 | acc=0.8815 | tpr=0.9596 | fpr=0.1199 | 7298.7 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.33828 | acc=0.8821 | tpr=0.9563 | fpr=0.1193 | 7455.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.33918 | acc=0.8826 | tpr=0.9578 | fpr=0.1188 | 7021.5 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.34109 | acc=0.8824 | tpr=0.9599 | fpr=0.1190 | 7226.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.34262 | acc=0.8819 | tpr=0.9568 | fpr=0.1195 | 7305.2 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.34572 | acc=0.8812 | tpr=0.9557 | fpr=0.1201 | 6989.5 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.34517 | acc=0.8810 | tpr=0.9573 | fpr=0.1204 | 7093.3 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.34358 | acc=0.8812 | tpr=0.9582 | fpr=0.1202 | 13592.2 samples/s | 53.1 steps/s
Avg test loss: 0.34318, Avg test acc: 0.88129, Avg tpr: 0.95840, Avg fpr: 0.12011, total FA: 16677

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.25242 | Reg=0.00183 | acc=0.8438 | L2-Norm=13.519 | L2-Norm(final)=2.793 | 3837.3 samples/s | 60.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05011 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.565 | L2-Norm(final)=2.787 | 4149.5 samples/s | 64.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03452 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=2.791 | 4476.5 samples/s | 69.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02822 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.606 | L2-Norm(final)=2.799 | 4529.0 samples/s | 70.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02417 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.806 | 6074.5 samples/s | 94.9 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02048 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=2.813 | 1756.3 samples/s | 27.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01819 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=2.819 | 4506.6 samples/s | 70.4 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01655 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.825 | 4304.2 samples/s | 67.3 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01548 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=2.830 | 5584.3 samples/s | 87.3 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01426 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=2.834 | 1808.0 samples/s | 28.2 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01339 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=2.839 | 4469.6 samples/s | 69.8 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01274 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.843 | 4536.3 samples/s | 70.9 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01233 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=2.847 | 5219.1 samples/s | 81.5 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01180 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=2.851 | 1816.3 samples/s | 28.4 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01143 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.854 | 4521.8 samples/s | 70.7 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01109 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=2.857 | 4515.3 samples/s | 70.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01065 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.685 | L2-Norm(final)=2.860 | 4958.7 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.14601 | Reg=0.00183 | acc=0.9062 | L2-Norm=13.519 | L2-Norm(final)=2.794 | 3779.5 samples/s | 59.1 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05560 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=2.784 | 4184.6 samples/s | 65.4 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03640 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=2.788 | 4527.2 samples/s | 70.7 steps/s
[Step=7350 Epoch=35.9] | Loss=0.02899 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.590 | L2-Norm(final)=2.793 | 4529.4 samples/s | 70.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02463 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.799 | 6091.1 samples/s | 95.2 steps/s
[Step=7450 Epoch=36.4] | Loss=0.02087 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.805 | 1734.3 samples/s | 27.1 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01837 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.617 | L2-Norm(final)=2.811 | 4442.1 samples/s | 69.4 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01656 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.623 | L2-Norm(final)=2.816 | 4505.5 samples/s | 70.4 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01543 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=2.821 | 5670.8 samples/s | 88.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01439 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=2.825 | 1782.7 samples/s | 27.9 steps/s
[Step=7700 Epoch=37.6] | Loss=0.01341 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.829 | 4406.2 samples/s | 68.8 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01278 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=2.832 | 4446.1 samples/s | 69.5 steps/s
[Step=7800 Epoch=38.1] | Loss=0.01212 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=2.836 | 5310.9 samples/s | 83.0 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01163 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.648 | L2-Norm(final)=2.839 | 1782.6 samples/s | 27.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01105 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.651 | L2-Norm(final)=2.842 | 4472.2 samples/s | 69.9 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01066 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.654 | L2-Norm(final)=2.845 | 4397.0 samples/s | 68.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01026 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=2.847 | 5074.4 samples/s | 79.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.64850 | acc=0.6849 | tpr=0.5467 | fpr=0.0149 | 3875.6 samples/s | 15.1 steps/s
Avg test loss: 0.66386, Avg test acc: 0.68134, Avg tpr: 0.54316, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.31739 | acc=0.8996 | tpr=0.9381 | fpr=0.1011 | 3747.1 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.32542 | acc=0.8988 | tpr=0.9467 | fpr=0.1021 | 7074.6 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.32993 | acc=0.8992 | tpr=0.9553 | fpr=0.1018 | 7409.7 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.33324 | acc=0.9000 | tpr=0.9574 | fpr=0.1011 | 7095.9 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.33271 | acc=0.9001 | tpr=0.9537 | fpr=0.1008 | 7388.2 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.33407 | acc=0.9003 | tpr=0.9549 | fpr=0.1007 | 7277.6 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.33597 | acc=0.9001 | tpr=0.9574 | fpr=0.1009 | 7156.3 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.33766 | acc=0.8997 | tpr=0.9540 | fpr=0.1013 | 7082.9 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.34096 | acc=0.8995 | tpr=0.9528 | fpr=0.1014 | 7178.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.34017 | acc=0.8994 | tpr=0.9551 | fpr=0.1016 | 7158.2 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.33836 | acc=0.8999 | tpr=0.9562 | fpr=0.1011 | 13643.8 samples/s | 53.3 steps/s
Avg test loss: 0.33791, Avg test acc: 0.89992, Avg tpr: 0.95642, Avg fpr: 0.10110, total FA: 14038

server round 21/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.37197 | Reg=0.00178 | acc=0.7812 | L2-Norm=13.343 | L2-Norm(final)=2.837 | 3800.1 samples/s | 59.4 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05975 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.392 | L2-Norm(final)=2.818 | 4214.1 samples/s | 65.8 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04011 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=2.822 | 4482.8 samples/s | 70.0 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03181 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=2.828 | 4520.4 samples/s | 70.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02682 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=2.835 | 5866.0 samples/s | 91.7 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02258 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=2.841 | 1752.6 samples/s | 27.4 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02043 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=2.848 | 4429.9 samples/s | 69.2 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01883 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=2.853 | 4512.2 samples/s | 70.5 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01736 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=2.858 | 5664.2 samples/s | 88.5 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01614 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.863 | 1799.5 samples/s | 28.1 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01521 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.868 | 4499.2 samples/s | 70.3 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01433 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=2.872 | 4519.5 samples/s | 70.6 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01351 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=2.877 | 5274.9 samples/s | 82.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01281 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=2.880 | 1810.4 samples/s | 28.3 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01224 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.884 | 4406.5 samples/s | 68.9 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01176 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.519 | L2-Norm(final)=2.888 | 4383.9 samples/s | 68.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01129 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.891 | 4837.6 samples/s | 75.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=75.8] | Loss=0.00246 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=2.838 | 3689.9 samples/s | 57.7 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00321 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=2.835 | 3970.2 samples/s | 62.0 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00166 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=2.836 | 5691.1 samples/s | 88.9 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00112 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=2.838 | 1666.9 samples/s | 26.0 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00084 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=2.839 | 5193.1 samples/s | 81.1 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00068 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.840 | 1739.1 samples/s | 27.2 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00057 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.841 | 4807.8 samples/s | 75.1 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=2.842 | 1712.9 samples/s | 26.8 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=2.843 | 4424.1 samples/s | 69.1 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=2.844 | 1817.8 samples/s | 28.4 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.845 | 4304.2 samples/s | 67.3 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00032 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=2.846 | 1836.8 samples/s | 28.7 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00029 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=2.847 | 4247.3 samples/s | 66.4 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00027 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=2.847 | 1906.9 samples/s | 29.8 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00025 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=2.848 | 4315.6 samples/s | 67.4 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00024 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.849 | 1885.2 samples/s | 29.5 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00022 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.849 | 4255.1 samples/s | 66.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.59443 | acc=0.7052 | tpr=0.5767 | fpr=0.0159 | 3825.2 samples/s | 14.9 steps/s
Avg test loss: 0.60733, Avg test acc: 0.70246, Avg tpr: 0.57434, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.33568 | acc=0.8911 | tpr=0.9469 | fpr=0.1099 | 3807.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.34341 | acc=0.8901 | tpr=0.9467 | fpr=0.1110 | 7118.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.34701 | acc=0.8906 | tpr=0.9553 | fpr=0.1106 | 7139.3 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.34965 | acc=0.8915 | tpr=0.9563 | fpr=0.1097 | 7272.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.34909 | acc=0.8914 | tpr=0.9546 | fpr=0.1097 | 7095.5 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.35012 | acc=0.8916 | tpr=0.9556 | fpr=0.1095 | 7215.1 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.35203 | acc=0.8912 | tpr=0.9574 | fpr=0.1100 | 7417.3 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.35352 | acc=0.8909 | tpr=0.9557 | fpr=0.1102 | 6816.2 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.35721 | acc=0.8905 | tpr=0.9552 | fpr=0.1107 | 7160.8 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.35656 | acc=0.8904 | tpr=0.9568 | fpr=0.1108 | 6942.8 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.35462 | acc=0.8907 | tpr=0.9574 | fpr=0.1105 | 13498.4 samples/s | 52.7 steps/s
Avg test loss: 0.35422, Avg test acc: 0.89077, Avg tpr: 0.95761, Avg fpr: 0.11044, total FA: 15335

server round 22/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.60936 | Reg=0.00177 | acc=0.6719 | L2-Norm=13.304 | L2-Norm(final)=2.868 | 3923.4 samples/s | 61.3 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04904 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=2.856 | 4057.1 samples/s | 63.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03388 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=2.859 | 4409.5 samples/s | 68.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02751 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=2.864 | 4506.0 samples/s | 70.4 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02297 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.401 | L2-Norm(final)=2.870 | 5944.3 samples/s | 92.9 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01963 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=2.877 | 1746.0 samples/s | 27.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01742 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=2.883 | 4474.8 samples/s | 69.9 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01596 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=2.888 | 4441.2 samples/s | 69.4 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01473 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=2.893 | 5576.7 samples/s | 87.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01356 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=2.898 | 1776.9 samples/s | 27.8 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01269 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=2.903 | 4509.3 samples/s | 70.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01201 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=2.907 | 4437.8 samples/s | 69.3 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01154 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=2.911 | 5213.8 samples/s | 81.5 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01093 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=2.915 | 1810.2 samples/s | 28.3 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01044 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=2.918 | 4400.5 samples/s | 68.8 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01016 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.467 | L2-Norm(final)=2.922 | 4491.3 samples/s | 70.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00988 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=2.925 | 4860.2 samples/s | 75.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.7] | Loss=0.09212 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.304 | L2-Norm(final)=2.868 | 3542.4 samples/s | 55.3 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00416 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.859 | 4099.8 samples/s | 64.1 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00215 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=2.862 | 5677.9 samples/s | 88.7 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00145 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=2.865 | 1672.2 samples/s | 26.1 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00109 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.867 | 5415.3 samples/s | 84.6 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00088 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=2.868 | 1727.0 samples/s | 27.0 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00074 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=2.869 | 4947.3 samples/s | 77.3 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00063 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=2.871 | 1775.6 samples/s | 27.7 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00056 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=2.872 | 4573.8 samples/s | 71.5 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00050 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=2.873 | 1815.5 samples/s | 28.4 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=2.874 | 4282.2 samples/s | 66.9 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00041 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.875 | 1854.1 samples/s | 29.0 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00038 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=2.875 | 4264.6 samples/s | 66.6 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00035 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=2.876 | 1907.2 samples/s | 29.8 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00032 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=2.877 | 4144.2 samples/s | 64.8 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00030 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.878 | 1910.0 samples/s | 29.8 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.879 | 4127.5 samples/s | 64.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.64846 | acc=0.6891 | tpr=0.5516 | fpr=0.0124 | 3804.1 samples/s | 14.9 steps/s
Avg test loss: 0.66145, Avg test acc: 0.68567, Avg tpr: 0.54870, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.29989 | acc=0.9025 | tpr=0.9204 | fpr=0.0978 | 3785.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.30659 | acc=0.9029 | tpr=0.9296 | fpr=0.0976 | 7250.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.31061 | acc=0.9034 | tpr=0.9395 | fpr=0.0973 | 7233.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.31373 | acc=0.9045 | tpr=0.9432 | fpr=0.0962 | 7320.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.31276 | acc=0.9044 | tpr=0.9432 | fpr=0.0963 | 7654.4 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.31365 | acc=0.9047 | tpr=0.9440 | fpr=0.0961 | 6991.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.31594 | acc=0.9043 | tpr=0.9436 | fpr=0.0964 | 7197.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.31709 | acc=0.9042 | tpr=0.9415 | fpr=0.0965 | 7459.0 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.32068 | acc=0.9037 | tpr=0.9401 | fpr=0.0970 | 7296.0 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.31990 | acc=0.9036 | tpr=0.9419 | fpr=0.0971 | 7137.2 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.31808 | acc=0.9040 | tpr=0.9431 | fpr=0.0967 | 13239.7 samples/s | 51.7 steps/s
Avg test loss: 0.31763, Avg test acc: 0.90406, Avg tpr: 0.94334, Avg fpr: 0.09665, total FA: 13420

server round 23/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.40776 | Reg=0.00177 | acc=0.7656 | L2-Norm=13.288 | L2-Norm(final)=2.901 | 3946.1 samples/s | 61.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.05502 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.343 | L2-Norm(final)=2.882 | 4032.4 samples/s | 63.0 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03513 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=2.883 | 4416.4 samples/s | 69.0 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02832 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=2.888 | 4419.9 samples/s | 69.1 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02367 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=2.894 | 5825.2 samples/s | 91.0 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02036 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.403 | L2-Norm(final)=2.900 | 1749.4 samples/s | 27.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01786 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=2.906 | 4397.2 samples/s | 68.7 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01640 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=2.911 | 4505.8 samples/s | 70.4 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01512 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=2.916 | 5380.9 samples/s | 84.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01408 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=2.920 | 1774.1 samples/s | 27.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01324 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=2.924 | 4434.8 samples/s | 69.3 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01255 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.927 | 4422.5 samples/s | 69.1 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01190 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=2.931 | 5229.9 samples/s | 81.7 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01128 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=2.934 | 1822.4 samples/s | 28.5 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01075 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=2.938 | 4511.6 samples/s | 70.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01031 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=2.941 | 4379.0 samples/s | 68.4 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01019 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.455 | L2-Norm(final)=2.944 | 4865.4 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.4] | Loss=0.03831 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.288 | L2-Norm(final)=2.900 | 3456.8 samples/s | 54.0 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00345 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=2.896 | 4214.7 samples/s | 65.9 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00178 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=2.897 | 5617.4 samples/s | 87.8 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00120 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=2.899 | 1699.3 samples/s | 26.6 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00090 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=2.900 | 5190.5 samples/s | 81.1 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00072 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=2.901 | 1718.9 samples/s | 26.9 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00060 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=2.902 | 4883.5 samples/s | 76.3 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00052 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.309 | L2-Norm(final)=2.903 | 1777.8 samples/s | 27.8 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00046 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=2.903 | 4641.3 samples/s | 72.5 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00041 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.904 | 1807.0 samples/s | 28.2 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00037 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=2.905 | 4347.4 samples/s | 67.9 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00033 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.905 | 1847.5 samples/s | 28.9 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00031 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=2.906 | 4268.2 samples/s | 66.7 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=2.906 | 1861.5 samples/s | 29.1 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00026 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=2.907 | 4332.0 samples/s | 67.7 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00025 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=2.907 | 1868.9 samples/s | 29.2 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00023 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=2.908 | 4332.7 samples/s | 67.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.60324 | acc=0.7019 | tpr=0.5706 | fpr=0.0131 | 3786.1 samples/s | 14.8 steps/s
Avg test loss: 0.61584, Avg test acc: 0.69966, Avg tpr: 0.56921, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.31611 | acc=0.8966 | tpr=0.9248 | fpr=0.1039 | 3818.5 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.32245 | acc=0.8958 | tpr=0.9318 | fpr=0.1049 | 7007.4 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.32732 | acc=0.8962 | tpr=0.9438 | fpr=0.1047 | 7363.1 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.33123 | acc=0.8967 | tpr=0.9454 | fpr=0.1042 | 7292.6 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.33000 | acc=0.8968 | tpr=0.9450 | fpr=0.1041 | 6946.0 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.33118 | acc=0.8970 | tpr=0.9462 | fpr=0.1039 | 7227.5 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.33354 | acc=0.8967 | tpr=0.9455 | fpr=0.1042 | 7143.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.33459 | acc=0.8967 | tpr=0.9431 | fpr=0.1042 | 7123.6 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.33800 | acc=0.8962 | tpr=0.9411 | fpr=0.1047 | 7016.2 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.33727 | acc=0.8963 | tpr=0.9432 | fpr=0.1046 | 7061.2 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.33532 | acc=0.8966 | tpr=0.9451 | fpr=0.1043 | 13169.9 samples/s | 51.4 steps/s
Avg test loss: 0.33492, Avg test acc: 0.89663, Avg tpr: 0.94493, Avg fpr: 0.10424, total FA: 14474

server round 24/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.0] | Loss=0.04668 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.267 | L2-Norm(final)=2.917 | 3531.7 samples/s | 55.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00196 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.914 | 4147.8 samples/s | 64.8 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00105 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=2.918 | 5744.2 samples/s | 89.8 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00071 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=2.921 | 1686.2 samples/s | 26.3 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00053 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=2.923 | 5270.5 samples/s | 82.4 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00043 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.924 | 1745.3 samples/s | 27.3 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00036 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.926 | 4870.1 samples/s | 76.1 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00031 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=2.927 | 1773.7 samples/s | 27.7 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00027 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=2.927 | 4618.5 samples/s | 72.2 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00024 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=2.928 | 1822.4 samples/s | 28.5 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=2.929 | 4295.7 samples/s | 67.1 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00020 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=2.930 | 1845.5 samples/s | 28.8 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00018 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=2.930 | 4233.1 samples/s | 66.1 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00017 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=2.931 | 1866.4 samples/s | 29.2 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=2.932 | 4276.4 samples/s | 66.8 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00015 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=2.932 | 1885.1 samples/s | 29.5 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00014 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=2.933 | 4137.5 samples/s | 64.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.3] | Loss=0.01172 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.267 | L2-Norm(final)=2.919 | 4001.2 samples/s | 62.5 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00342 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=2.916 | 3518.4 samples/s | 55.0 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00177 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.917 | 5783.0 samples/s | 90.4 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00119 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=2.919 | 1656.1 samples/s | 25.9 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00090 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.920 | 5212.2 samples/s | 81.4 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00072 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=2.921 | 1709.9 samples/s | 26.7 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00060 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=2.922 | 4957.3 samples/s | 77.5 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00052 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=2.923 | 1787.7 samples/s | 27.9 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00045 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.923 | 4594.3 samples/s | 71.8 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00041 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=2.924 | 1821.6 samples/s | 28.5 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00037 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=2.924 | 4241.2 samples/s | 66.3 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00033 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.271 | L2-Norm(final)=2.925 | 1879.9 samples/s | 29.4 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00031 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=2.926 | 4206.9 samples/s | 65.7 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=2.926 | 1866.2 samples/s | 29.2 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00026 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.927 | 4257.9 samples/s | 66.5 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00025 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=2.927 | 1850.5 samples/s | 28.9 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00023 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=2.928 | 4127.1 samples/s | 64.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55057 | acc=0.7354 | tpr=0.6196 | fpr=0.0131 | 3872.0 samples/s | 15.1 steps/s
Avg test loss: 0.56358, Avg test acc: 0.72967, Avg tpr: 0.61369, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.34707 | acc=0.8860 | tpr=0.9204 | fpr=0.1146 | 3814.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.35339 | acc=0.8864 | tpr=0.9296 | fpr=0.1144 | 7157.0 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.35817 | acc=0.8868 | tpr=0.9395 | fpr=0.1141 | 7259.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.36263 | acc=0.8871 | tpr=0.9421 | fpr=0.1139 | 7127.5 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.36174 | acc=0.8868 | tpr=0.9424 | fpr=0.1142 | 7217.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.36269 | acc=0.8871 | tpr=0.9455 | fpr=0.1140 | 7175.8 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.36505 | acc=0.8869 | tpr=0.9461 | fpr=0.1141 | 7115.8 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.36651 | acc=0.8868 | tpr=0.9447 | fpr=0.1143 | 7246.6 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.37008 | acc=0.8862 | tpr=0.9440 | fpr=0.1148 | 7027.2 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.36911 | acc=0.8862 | tpr=0.9463 | fpr=0.1149 | 7307.3 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.36722 | acc=0.8864 | tpr=0.9479 | fpr=0.1147 | 12754.2 samples/s | 49.8 steps/s
Avg test loss: 0.36681, Avg test acc: 0.88646, Avg tpr: 0.94810, Avg fpr: 0.11466, total FA: 15920

server round 25/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.6] | Loss=0.04183 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.232 | L2-Norm(final)=2.936 | 3584.7 samples/s | 56.0 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00306 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=2.934 | 4069.3 samples/s | 63.6 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00219 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.931 | 5752.9 samples/s | 89.9 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00148 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=2.929 | 1673.8 samples/s | 26.2 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00114 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.928 | 5234.9 samples/s | 81.8 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00091 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=2.928 | 1712.4 samples/s | 26.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00076 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.929 | 4837.2 samples/s | 75.6 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00065 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=2.929 | 1744.4 samples/s | 27.3 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00057 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=2.929 | 4576.5 samples/s | 71.5 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00051 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=2.929 | 1827.1 samples/s | 28.5 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00046 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=2.930 | 4128.8 samples/s | 64.5 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00042 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=2.930 | 1865.7 samples/s | 29.2 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00038 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=2.930 | 4283.7 samples/s | 66.9 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00035 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=2.930 | 1888.4 samples/s | 29.5 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00033 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=2.931 | 4201.3 samples/s | 65.6 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.187 | L2-Norm(final)=2.931 | 1874.0 samples/s | 29.3 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00029 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=2.931 | 4302.6 samples/s | 67.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.9] | Loss=0.03992 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.232 | L2-Norm(final)=2.936 | 3692.2 samples/s | 57.7 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00404 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.930 | 3866.8 samples/s | 60.4 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00208 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=2.929 | 5814.8 samples/s | 90.9 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00140 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.930 | 1680.9 samples/s | 26.3 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00106 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=2.931 | 5149.1 samples/s | 80.5 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00085 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.932 | 1699.4 samples/s | 26.6 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00071 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.933 | 4877.5 samples/s | 76.2 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00061 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=2.933 | 1770.0 samples/s | 27.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00054 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.934 | 4511.1 samples/s | 70.5 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00048 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=2.935 | 1825.7 samples/s | 28.5 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00043 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=2.935 | 4260.3 samples/s | 66.6 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00039 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=2.936 | 1883.3 samples/s | 29.4 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00036 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=2.937 | 4167.1 samples/s | 65.1 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00033 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=2.937 | 1898.3 samples/s | 29.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00031 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=2.938 | 4305.0 samples/s | 67.3 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00029 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=2.938 | 1898.7 samples/s | 29.7 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00027 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=2.939 | 4265.0 samples/s | 66.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55805 | acc=0.7373 | tpr=0.6221 | fpr=0.0126 | 3809.0 samples/s | 14.9 steps/s
Avg test loss: 0.57367, Avg test acc: 0.73255, Avg tpr: 0.61730, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.34964 | acc=0.8860 | tpr=0.9248 | fpr=0.1147 | 3798.4 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.35572 | acc=0.8877 | tpr=0.9339 | fpr=0.1131 | 7176.1 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.36046 | acc=0.8879 | tpr=0.9424 | fpr=0.1131 | 7152.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.36393 | acc=0.8884 | tpr=0.9454 | fpr=0.1126 | 7311.5 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.36314 | acc=0.8887 | tpr=0.9450 | fpr=0.1124 | 7184.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.36376 | acc=0.8890 | tpr=0.9469 | fpr=0.1121 | 7388.0 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.36608 | acc=0.8887 | tpr=0.9493 | fpr=0.1124 | 7616.7 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.36766 | acc=0.8883 | tpr=0.9469 | fpr=0.1128 | 6654.2 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.37108 | acc=0.8879 | tpr=0.9460 | fpr=0.1131 | 7308.8 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.37032 | acc=0.8878 | tpr=0.9480 | fpr=0.1133 | 7070.2 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.36829 | acc=0.8881 | tpr=0.9487 | fpr=0.1130 | 12943.9 samples/s | 50.6 steps/s
Avg test loss: 0.36792, Avg test acc: 0.88820, Avg tpr: 0.94889, Avg fpr: 0.11290, total FA: 15676

server round 26/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.45748 | Reg=0.00175 | acc=0.7969 | L2-Norm=13.238 | L2-Norm(final)=2.937 | 3885.3 samples/s | 60.7 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04412 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.280 | L2-Norm(final)=2.923 | 4147.2 samples/s | 64.8 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02847 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=2.928 | 4548.1 samples/s | 71.1 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02279 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=2.933 | 4532.6 samples/s | 70.8 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01945 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.323 | L2-Norm(final)=2.938 | 6114.1 samples/s | 95.5 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01652 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.942 | 1762.9 samples/s | 27.5 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01481 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=2.947 | 4539.9 samples/s | 70.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01344 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=2.952 | 4525.3 samples/s | 70.7 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01257 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=2.956 | 5527.1 samples/s | 86.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01182 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=2.959 | 1767.6 samples/s | 27.6 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01107 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=2.963 | 4403.6 samples/s | 68.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01061 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.967 | 4471.1 samples/s | 69.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01027 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=2.970 | 5198.5 samples/s | 81.2 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00999 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=2.973 | 1808.2 samples/s | 28.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00977 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=2.975 | 4512.2 samples/s | 70.5 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00947 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=2.977 | 4516.1 samples/s | 70.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00922 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.979 | 4896.9 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.5] | Loss=0.02449 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.238 | L2-Norm(final)=2.938 | 3610.3 samples/s | 56.4 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00247 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=2.941 | 3948.9 samples/s | 61.7 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00127 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=2.945 | 5690.4 samples/s | 88.9 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00086 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=2.947 | 1667.5 samples/s | 26.1 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00065 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=2.949 | 5398.3 samples/s | 84.3 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00052 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.950 | 1712.3 samples/s | 26.8 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00044 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=2.951 | 4958.1 samples/s | 77.5 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00038 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.952 | 1764.4 samples/s | 27.6 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00033 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.953 | 4626.3 samples/s | 72.3 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00029 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=2.954 | 1800.3 samples/s | 28.1 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=2.955 | 4313.9 samples/s | 67.4 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00024 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=2.956 | 1834.5 samples/s | 28.7 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=2.957 | 4150.6 samples/s | 64.9 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00021 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=2.958 | 1883.1 samples/s | 29.4 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=2.959 | 4227.7 samples/s | 66.1 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00018 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=2.960 | 1875.4 samples/s | 29.3 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00017 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=2.960 | 4259.9 samples/s | 66.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54928 | acc=0.7448 | tpr=0.6332 | fpr=0.0129 | 3798.7 samples/s | 14.8 steps/s
Avg test loss: 0.56439, Avg test acc: 0.73944, Avg tpr: 0.62762, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.36423 | acc=0.8833 | tpr=0.9159 | fpr=0.1173 | 3837.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.37153 | acc=0.8852 | tpr=0.9296 | fpr=0.1156 | 7180.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.37628 | acc=0.8851 | tpr=0.9395 | fpr=0.1159 | 7530.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.38012 | acc=0.8860 | tpr=0.9421 | fpr=0.1150 | 7248.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.37938 | acc=0.8865 | tpr=0.9424 | fpr=0.1145 | 7513.9 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.38005 | acc=0.8870 | tpr=0.9440 | fpr=0.1141 | 7043.9 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.38261 | acc=0.8866 | tpr=0.9461 | fpr=0.1145 | 7481.1 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.38428 | acc=0.8863 | tpr=0.9442 | fpr=0.1147 | 6998.8 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.38785 | acc=0.8859 | tpr=0.9435 | fpr=0.1152 | 7157.4 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.38720 | acc=0.8857 | tpr=0.9454 | fpr=0.1153 | 7106.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.38509 | acc=0.8862 | tpr=0.9463 | fpr=0.1149 | 12993.2 samples/s | 50.8 steps/s
Avg test loss: 0.38471, Avg test acc: 0.88621, Avg tpr: 0.94651, Avg fpr: 0.11489, total FA: 15952

server round 27/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.34026 | Reg=0.00175 | acc=0.8125 | L2-Norm=13.216 | L2-Norm(final)=2.949 | 3705.4 samples/s | 57.9 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04047 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=2.938 | 4335.9 samples/s | 67.7 steps/s
[Step=8100 Epoch=39.5] | Loss=0.02719 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.285 | L2-Norm(final)=2.940 | 4492.2 samples/s | 70.2 steps/s
[Step=8150 Epoch=39.8] | Loss=0.02171 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=2.945 | 4540.7 samples/s | 70.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.01842 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.949 | 5982.8 samples/s | 93.5 steps/s
[Step=8250 Epoch=40.3] | Loss=0.01562 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=2.953 | 1736.9 samples/s | 27.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01366 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=2.958 | 4542.4 samples/s | 71.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01261 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.961 | 4537.1 samples/s | 70.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01145 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.329 | L2-Norm(final)=2.965 | 5800.5 samples/s | 90.6 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=2.969 | 1781.0 samples/s | 27.8 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01005 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.338 | L2-Norm(final)=2.972 | 4522.9 samples/s | 70.7 steps/s
[Step=8550 Epoch=41.7] | Loss=0.00960 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=2.975 | 4538.2 samples/s | 70.9 steps/s
[Step=8600 Epoch=42.0] | Loss=0.00924 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=2.978 | 5411.7 samples/s | 84.6 steps/s
[Step=8650 Epoch=42.2] | Loss=0.00905 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=2.980 | 1848.0 samples/s | 28.9 steps/s
[Step=8700 Epoch=42.5] | Loss=0.00870 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=2.982 | 4623.0 samples/s | 72.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.00840 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=2.985 | 4599.9 samples/s | 71.9 steps/s
[Step=8800 Epoch=42.9] | Loss=0.00812 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=2.987 | 5105.1 samples/s | 79.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.1] | Loss=0.00254 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.950 | 3968.5 samples/s | 62.0 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00232 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.951 | 3841.7 samples/s | 60.0 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00166 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.952 | 5844.5 samples/s | 91.3 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00111 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=2.953 | 1713.6 samples/s | 26.8 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00084 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.954 | 5390.3 samples/s | 84.2 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00068 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=2.955 | 1772.8 samples/s | 27.7 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00056 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=2.956 | 4972.5 samples/s | 77.7 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00049 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=2.957 | 1807.5 samples/s | 28.2 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00043 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=2.957 | 4754.9 samples/s | 74.3 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00038 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=2.958 | 1867.3 samples/s | 29.2 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00034 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=2.958 | 4455.8 samples/s | 69.6 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00031 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=2.959 | 1902.1 samples/s | 29.7 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00029 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=2.959 | 4387.1 samples/s | 68.5 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00026 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=2.959 | 1923.2 samples/s | 30.1 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00025 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=2.960 | 4452.6 samples/s | 69.6 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00023 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=2.960 | 1948.3 samples/s | 30.4 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00021 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=2.960 | 4348.5 samples/s | 67.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52636 | acc=0.7547 | tpr=0.6483 | fpr=0.0144 | 4036.1 samples/s | 15.8 steps/s
Avg test loss: 0.53883, Avg test acc: 0.75070, Avg tpr: 0.64434, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.41870 | acc=0.8727 | tpr=0.9204 | fpr=0.1281 | 4083.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.42536 | acc=0.8738 | tpr=0.9296 | fpr=0.1273 | 7900.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.43035 | acc=0.8741 | tpr=0.9380 | fpr=0.1271 | 7757.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.43390 | acc=0.8752 | tpr=0.9432 | fpr=0.1260 | 7725.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.43382 | acc=0.8756 | tpr=0.9424 | fpr=0.1256 | 7888.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.43523 | acc=0.8758 | tpr=0.9455 | fpr=0.1255 | 7382.2 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.43832 | acc=0.8757 | tpr=0.9480 | fpr=0.1256 | 7897.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.44000 | acc=0.8754 | tpr=0.9458 | fpr=0.1259 | 7740.1 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.44342 | acc=0.8750 | tpr=0.9469 | fpr=0.1263 | 7626.2 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.44272 | acc=0.8750 | tpr=0.9489 | fpr=0.1263 | 7557.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.44025 | acc=0.8755 | tpr=0.9499 | fpr=0.1259 | 14585.3 samples/s | 57.0 steps/s
Avg test loss: 0.43981, Avg test acc: 0.87552, Avg tpr: 0.95008, Avg fpr: 0.12584, total FA: 17472

server round 28/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.15958 | Reg=0.00173 | acc=0.8594 | L2-Norm=13.155 | L2-Norm(final)=2.991 | 3772.4 samples/s | 58.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03981 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=2.982 | 4487.9 samples/s | 70.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02571 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=2.982 | 4547.3 samples/s | 71.1 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02093 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.238 | L2-Norm(final)=2.985 | 4637.7 samples/s | 72.5 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01718 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=2.990 | 6134.8 samples/s | 95.9 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01461 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=2.995 | 1805.8 samples/s | 28.2 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01327 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=3.000 | 4583.9 samples/s | 71.6 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01210 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.266 | L2-Norm(final)=3.004 | 4510.9 samples/s | 70.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01134 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.271 | L2-Norm(final)=3.007 | 5654.5 samples/s | 88.4 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01097 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=3.011 | 1812.9 samples/s | 28.3 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01043 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=3.013 | 4587.9 samples/s | 71.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00997 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=3.015 | 4521.4 samples/s | 70.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.00972 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=3.018 | 5260.6 samples/s | 82.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00934 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=3.020 | 1856.7 samples/s | 29.0 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00915 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=3.022 | 4617.3 samples/s | 72.1 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00881 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=3.024 | 4590.3 samples/s | 71.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00842 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=3.026 | 4883.3 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=114.2] | Loss=0.03451 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.155 | L2-Norm(final)=2.990 | 3783.5 samples/s | 59.1 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00247 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=2.985 | 3966.4 samples/s | 62.0 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00130 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=2.987 | 5909.9 samples/s | 92.3 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00088 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=2.989 | 1688.9 samples/s | 26.4 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00066 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=2.990 | 5541.0 samples/s | 86.6 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00053 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=2.991 | 1758.6 samples/s | 27.5 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00044 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=2.992 | 5074.4 samples/s | 79.3 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00038 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=2.993 | 1794.8 samples/s | 28.0 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00034 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=2.993 | 4680.4 samples/s | 73.1 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00030 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=2.994 | 1856.3 samples/s | 29.0 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00027 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=2.994 | 4437.5 samples/s | 69.3 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00025 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=2.995 | 1885.9 samples/s | 29.5 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00023 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=2.996 | 4344.0 samples/s | 67.9 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00021 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=2.996 | 1921.9 samples/s | 30.0 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00019 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=2.996 | 4416.2 samples/s | 69.0 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00018 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.134 | L2-Norm(final)=2.997 | 1923.9 samples/s | 30.1 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00017 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=2.997 | 4289.9 samples/s | 67.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.58982 | acc=0.7328 | tpr=0.6156 | fpr=0.0126 | 3864.9 samples/s | 15.1 steps/s
Avg test loss: 0.60331, Avg test acc: 0.72750, Avg tpr: 0.61001, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.37247 | acc=0.8893 | tpr=0.9159 | fpr=0.1112 | 3837.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.37973 | acc=0.8900 | tpr=0.9275 | fpr=0.1107 | 7644.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.38550 | acc=0.8904 | tpr=0.9366 | fpr=0.1104 | 7295.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.38982 | acc=0.8905 | tpr=0.9399 | fpr=0.1104 | 7628.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.38951 | acc=0.8906 | tpr=0.9406 | fpr=0.1103 | 7882.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.39142 | acc=0.8907 | tpr=0.9433 | fpr=0.1103 | 7492.5 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.39428 | acc=0.8905 | tpr=0.9455 | fpr=0.1105 | 7534.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.39583 | acc=0.8905 | tpr=0.9426 | fpr=0.1105 | 7793.3 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.39907 | acc=0.8902 | tpr=0.9435 | fpr=0.1108 | 7857.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.39816 | acc=0.8901 | tpr=0.9458 | fpr=0.1109 | 7970.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.39567 | acc=0.8908 | tpr=0.9467 | fpr=0.1103 | 13675.2 samples/s | 53.4 steps/s
Avg test loss: 0.39521, Avg test acc: 0.89081, Avg tpr: 0.94691, Avg fpr: 0.11021, total FA: 15303

server round 29/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.4] | Loss=0.34437 | Reg=0.00172 | acc=0.8438 | L2-Norm=13.109 | L2-Norm(final)=3.010 | 3832.1 samples/s | 59.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04685 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.159 | L2-Norm(final)=2.990 | 4471.5 samples/s | 69.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03004 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.182 | L2-Norm(final)=2.993 | 4557.1 samples/s | 71.2 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02383 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.197 | L2-Norm(final)=2.999 | 4594.2 samples/s | 71.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=3.005 | 6192.8 samples/s | 96.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01879 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=3.010 | 1784.2 samples/s | 27.9 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01690 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=3.016 | 4574.7 samples/s | 71.5 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01518 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=3.021 | 4566.6 samples/s | 71.4 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01428 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=3.025 | 5641.5 samples/s | 88.1 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01347 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.257 | L2-Norm(final)=3.030 | 1831.8 samples/s | 28.6 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01260 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=3.034 | 4561.1 samples/s | 71.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01177 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=3.038 | 4579.7 samples/s | 71.6 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01124 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=3.041 | 5350.2 samples/s | 83.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01072 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=3.044 | 1872.8 samples/s | 29.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01036 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=3.047 | 4607.8 samples/s | 72.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00988 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=3.050 | 4608.8 samples/s | 72.0 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00959 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=3.053 | 4967.4 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=121.8] | Loss=0.05625 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.109 | L2-Norm(final)=3.011 | 3748.8 samples/s | 58.6 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00224 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=3.009 | 4258.9 samples/s | 66.5 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00117 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=3.011 | 5950.4 samples/s | 93.0 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00079 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=3.013 | 1723.6 samples/s | 26.9 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00059 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.170 | L2-Norm(final)=3.014 | 5389.8 samples/s | 84.2 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00048 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.162 | L2-Norm(final)=3.015 | 1772.3 samples/s | 27.7 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00040 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=3.016 | 5088.2 samples/s | 79.5 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00034 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=3.017 | 1814.1 samples/s | 28.3 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00030 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=3.017 | 4717.7 samples/s | 73.7 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00027 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=3.018 | 1850.8 samples/s | 28.9 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00024 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=3.018 | 4543.9 samples/s | 71.0 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=3.019 | 1888.3 samples/s | 29.5 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=3.020 | 4428.0 samples/s | 69.2 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00019 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=3.020 | 1933.2 samples/s | 30.2 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00017 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=3.021 | 4376.4 samples/s | 68.4 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00016 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=3.021 | 1948.2 samples/s | 30.4 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00015 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=3.022 | 4402.7 samples/s | 68.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55782 | acc=0.7467 | tpr=0.6359 | fpr=0.0126 | 3864.3 samples/s | 15.1 steps/s
Avg test loss: 0.56855, Avg test acc: 0.74249, Avg tpr: 0.63164, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.41244 | acc=0.8786 | tpr=0.9381 | fpr=0.1225 | 4053.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.42076 | acc=0.8790 | tpr=0.9360 | fpr=0.1221 | 7879.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.42647 | acc=0.8794 | tpr=0.9452 | fpr=0.1218 | 7632.4 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.43096 | acc=0.8801 | tpr=0.9475 | fpr=0.1211 | 8258.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.43076 | acc=0.8802 | tpr=0.9467 | fpr=0.1210 | 7532.8 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.43244 | acc=0.8802 | tpr=0.9484 | fpr=0.1210 | 7727.5 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.43544 | acc=0.8799 | tpr=0.9505 | fpr=0.1213 | 7615.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.43706 | acc=0.8796 | tpr=0.9480 | fpr=0.1217 | 7950.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.44065 | acc=0.8793 | tpr=0.9484 | fpr=0.1220 | 7662.5 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.43973 | acc=0.8793 | tpr=0.9502 | fpr=0.1220 | 7654.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.43712 | acc=0.8798 | tpr=0.9515 | fpr=0.1215 | 13919.7 samples/s | 54.4 steps/s
Avg test loss: 0.43664, Avg test acc: 0.87991, Avg tpr: 0.95166, Avg fpr: 0.12139, total FA: 16855

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.25398 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.095 | L2-Norm(final)=3.025 | 3734.2 samples/s | 58.3 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04099 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.119 | L2-Norm(final)=3.020 | 4461.8 samples/s | 69.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02538 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.129 | L2-Norm(final)=3.022 | 4645.2 samples/s | 72.6 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01926 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.136 | L2-Norm(final)=3.024 | 4599.3 samples/s | 71.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01608 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=3.028 | 6134.1 samples/s | 95.8 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01362 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.145 | L2-Norm(final)=3.031 | 1782.6 samples/s | 27.9 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01201 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=3.035 | 4524.0 samples/s | 70.7 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01097 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.152 | L2-Norm(final)=3.038 | 4517.0 samples/s | 70.6 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01012 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=3.041 | 5662.0 samples/s | 88.5 steps/s
[Step=14050 Epoch=68.5] | Loss=0.00941 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.044 | 1836.1 samples/s | 28.7 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00871 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.160 | L2-Norm(final)=3.047 | 4683.0 samples/s | 73.2 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00821 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.162 | L2-Norm(final)=3.050 | 4525.9 samples/s | 70.7 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00790 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=3.052 | 5315.3 samples/s | 83.1 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00760 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=3.055 | 1857.6 samples/s | 29.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00730 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=3.057 | 4676.5 samples/s | 73.1 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00704 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.170 | L2-Norm(final)=3.060 | 4573.1 samples/s | 71.5 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00675 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=3.062 | 4882.6 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8801 Epoch=42.9] | Loss=0.39585 | Reg=0.00171 | acc=0.8125 | L2-Norm=13.095 | L2-Norm(final)=3.025 | 3838.1 samples/s | 60.0 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04401 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.117 | L2-Norm(final)=3.020 | 4393.1 samples/s | 68.6 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02629 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=3.020 | 4468.9 samples/s | 69.8 steps/s
[Step=8950 Epoch=43.7] | Loss=0.02084 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=3.023 | 4477.8 samples/s | 70.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.01767 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=3.025 | 6119.7 samples/s | 95.6 steps/s
[Step=9050 Epoch=44.2] | Loss=0.01491 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=3.027 | 1799.9 samples/s | 28.1 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01296 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.030 | 4570.2 samples/s | 71.4 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01155 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=3.033 | 4608.4 samples/s | 72.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01071 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=3.035 | 5749.2 samples/s | 89.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.00996 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=3.037 | 1822.3 samples/s | 28.5 steps/s
[Step=9300 Epoch=45.4] | Loss=0.00933 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=3.040 | 4608.2 samples/s | 72.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.00862 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=3.042 | 4531.0 samples/s | 70.8 steps/s
[Step=9400 Epoch=45.9] | Loss=0.00820 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=3.044 | 5505.8 samples/s | 86.0 steps/s
[Step=9450 Epoch=46.1] | Loss=0.00779 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.046 | 1856.0 samples/s | 29.0 steps/s
[Step=9500 Epoch=46.4] | Loss=0.00740 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.160 | L2-Norm(final)=3.048 | 4617.8 samples/s | 72.2 steps/s
[Step=9550 Epoch=46.6] | Loss=0.00719 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.162 | L2-Norm(final)=3.050 | 4529.2 samples/s | 70.8 steps/s
[Step=9600 Epoch=46.8] | Loss=0.00692 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.163 | L2-Norm(final)=3.052 | 5223.3 samples/s | 81.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.65665 | acc=0.7187 | tpr=0.5946 | fpr=0.0119 | 4101.8 samples/s | 16.0 steps/s
Avg test loss: 0.66893, Avg test acc: 0.71484, Avg tpr: 0.59119, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.37623 | acc=0.8986 | tpr=0.9159 | fpr=0.1017 | 4011.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.38604 | acc=0.8987 | tpr=0.9254 | fpr=0.1018 | 7683.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.39277 | acc=0.8992 | tpr=0.9380 | fpr=0.1015 | 7878.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.39788 | acc=0.8997 | tpr=0.9421 | fpr=0.1011 | 7908.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.39734 | acc=0.8995 | tpr=0.9415 | fpr=0.1013 | 8176.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.39930 | acc=0.8993 | tpr=0.9440 | fpr=0.1015 | 7097.4 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.40217 | acc=0.8990 | tpr=0.9461 | fpr=0.1018 | 7585.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.40383 | acc=0.8989 | tpr=0.9437 | fpr=0.1019 | 7687.0 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.40748 | acc=0.8986 | tpr=0.9440 | fpr=0.1022 | 7736.3 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.40633 | acc=0.8986 | tpr=0.9458 | fpr=0.1022 | 7221.0 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.40368 | acc=0.8992 | tpr=0.9471 | fpr=0.1016 | 13696.9 samples/s | 53.5 steps/s
Avg test loss: 0.40314, Avg test acc: 0.89929, Avg tpr: 0.94731, Avg fpr: 0.10158, total FA: 14104

server round 31/50

clients selected: [2 3]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=113.7] | Loss=0.06800 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.033 | L2-Norm(final)=3.042 | 3679.4 samples/s | 57.5 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00183 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=3.043 | 4180.2 samples/s | 65.3 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00094 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=3.044 | 5744.3 samples/s | 89.8 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00063 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=3.045 | 1712.4 samples/s | 26.8 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00048 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=3.046 | 5367.7 samples/s | 83.9 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00038 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=3.046 | 1780.2 samples/s | 27.8 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00032 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.033 | L2-Norm(final)=3.047 | 5046.2 samples/s | 78.8 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00028 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.047 | 1809.5 samples/s | 28.3 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00024 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=3.048 | 4655.2 samples/s | 72.7 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00022 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=3.048 | 1861.4 samples/s | 29.1 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00020 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=3.049 | 4357.7 samples/s | 68.1 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00018 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=3.049 | 1897.0 samples/s | 29.6 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00017 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=3.049 | 4414.1 samples/s | 69.0 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00015 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=3.050 | 1927.9 samples/s | 30.1 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00014 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.050 | 4438.2 samples/s | 69.3 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00013 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.050 | 1909.9 samples/s | 29.8 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00013 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.051 | 4371.7 samples/s | 68.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=129.4] | Loss=0.08530 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.033 | L2-Norm(final)=3.042 | 3982.5 samples/s | 62.2 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00367 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=3.037 | 3847.4 samples/s | 60.1 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00188 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=3.037 | 5974.7 samples/s | 93.4 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00126 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=3.038 | 1741.6 samples/s | 27.2 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00095 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=3.038 | 5451.9 samples/s | 85.2 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00076 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.039 | 1775.4 samples/s | 27.7 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00064 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=3.039 | 5094.8 samples/s | 79.6 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00055 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.040 | 1832.4 samples/s | 28.6 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00048 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=3.040 | 4726.9 samples/s | 73.9 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00043 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.040 | 1872.6 samples/s | 29.3 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00039 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=3.041 | 4489.8 samples/s | 70.2 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00035 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=3.041 | 1897.0 samples/s | 29.6 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00032 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.014 | L2-Norm(final)=3.041 | 4438.5 samples/s | 69.4 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00030 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=3.042 | 1913.5 samples/s | 29.9 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00028 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.042 | 4444.3 samples/s | 69.4 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00026 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.042 | 1935.4 samples/s | 30.2 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00024 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.042 | 4382.4 samples/s | 68.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51998 | acc=0.7678 | tpr=0.6672 | fpr=0.0136 | 4028.1 samples/s | 15.7 steps/s
Avg test loss: 0.53002, Avg test acc: 0.76533, Avg tpr: 0.66544, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.42896 | acc=0.8773 | tpr=0.9115 | fpr=0.1233 | 4125.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.43794 | acc=0.8781 | tpr=0.9275 | fpr=0.1228 | 7655.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.44290 | acc=0.8783 | tpr=0.9395 | fpr=0.1229 | 7643.5 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.44764 | acc=0.8787 | tpr=0.9410 | fpr=0.1225 | 7510.1 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.44720 | acc=0.8788 | tpr=0.9415 | fpr=0.1224 | 7229.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.44862 | acc=0.8789 | tpr=0.9447 | fpr=0.1223 | 7978.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.45164 | acc=0.8787 | tpr=0.9474 | fpr=0.1226 | 7934.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.45310 | acc=0.8783 | tpr=0.9442 | fpr=0.1229 | 7954.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.45666 | acc=0.8781 | tpr=0.9440 | fpr=0.1231 | 6986.7 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.45578 | acc=0.8781 | tpr=0.9458 | fpr=0.1232 | 7946.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.45326 | acc=0.8785 | tpr=0.9463 | fpr=0.1228 | 13413.0 samples/s | 52.4 steps/s
Avg test loss: 0.45270, Avg test acc: 0.87853, Avg tpr: 0.94651, Avg fpr: 0.12270, total FA: 17037

server round 32/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.2] | Loss=0.32545 | Reg=0.00169 | acc=0.7812 | L2-Norm=13.016 | L2-Norm(final)=3.070 | 3792.0 samples/s | 59.3 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03455 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.066 | 4417.8 samples/s | 69.0 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02159 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=3.067 | 4645.2 samples/s | 72.6 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01679 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=3.070 | 4590.0 samples/s | 71.7 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01406 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=3.072 | 6201.1 samples/s | 96.9 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01195 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=3.075 | 1784.5 samples/s | 27.9 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01072 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=3.078 | 4588.5 samples/s | 71.7 steps/s
[Step=14750 Epoch=71.9] | Loss=0.00976 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=3.081 | 4573.7 samples/s | 71.5 steps/s
[Step=14800 Epoch=72.2] | Loss=0.00897 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=3.084 | 5705.8 samples/s | 89.2 steps/s
[Step=14850 Epoch=72.4] | Loss=0.00824 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.082 | L2-Norm(final)=3.086 | 1837.9 samples/s | 28.7 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00787 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.089 | 4590.7 samples/s | 71.7 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00741 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=3.091 | 4590.3 samples/s | 71.7 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00705 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.093 | 5345.9 samples/s | 83.5 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00675 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.095 | 1863.9 samples/s | 29.1 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00653 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=3.098 | 4684.9 samples/s | 73.2 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00624 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=3.100 | 4621.0 samples/s | 72.2 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00607 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=3.102 | 4927.5 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=137.0] | Loss=0.00120 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.016 | L2-Norm(final)=3.070 | 3701.2 samples/s | 57.8 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00450 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=3.068 | 4096.5 samples/s | 64.0 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00229 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=3.068 | 5913.1 samples/s | 92.4 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00153 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=3.069 | 1728.2 samples/s | 27.0 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00116 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=3.069 | 5419.0 samples/s | 84.7 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00093 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=3.070 | 1749.7 samples/s | 27.3 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00078 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.031 | L2-Norm(final)=3.071 | 5041.3 samples/s | 78.8 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00067 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=3.071 | 1804.1 samples/s | 28.2 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00059 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=3.072 | 4751.5 samples/s | 74.2 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00052 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=3.072 | 1834.4 samples/s | 28.7 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00047 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.014 | L2-Norm(final)=3.073 | 4503.6 samples/s | 70.4 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00043 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=3.074 | 1908.8 samples/s | 29.8 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=3.074 | 4404.1 samples/s | 68.8 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00036 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=3.075 | 1924.0 samples/s | 30.1 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00034 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=3.075 | 4391.3 samples/s | 68.6 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00032 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.076 | 1912.5 samples/s | 29.9 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00030 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.076 | 4409.9 samples/s | 68.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47699 | acc=0.7859 | tpr=0.6937 | fpr=0.0141 | 3996.7 samples/s | 15.6 steps/s
Avg test loss: 0.48713, Avg test acc: 0.78436, Avg tpr: 0.69354, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.44718 | acc=0.8684 | tpr=0.9115 | fpr=0.1323 | 4117.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.45624 | acc=0.8690 | tpr=0.9254 | fpr=0.1321 | 7874.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.46010 | acc=0.8693 | tpr=0.9366 | fpr=0.1319 | 7662.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.46456 | acc=0.8700 | tpr=0.9388 | fpr=0.1313 | 7533.1 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.46403 | acc=0.8700 | tpr=0.9406 | fpr=0.1313 | 7884.8 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.46471 | acc=0.8700 | tpr=0.9440 | fpr=0.1314 | 7535.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.46791 | acc=0.8697 | tpr=0.9461 | fpr=0.1317 | 7408.9 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.46917 | acc=0.8693 | tpr=0.9437 | fpr=0.1320 | 7573.8 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.47276 | acc=0.8692 | tpr=0.9426 | fpr=0.1321 | 7850.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.47206 | acc=0.8692 | tpr=0.9445 | fpr=0.1322 | 7811.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.46967 | acc=0.8696 | tpr=0.9447 | fpr=0.1318 | 13945.8 samples/s | 54.5 steps/s
Avg test loss: 0.46911, Avg test acc: 0.86961, Avg tpr: 0.94493, Avg fpr: 0.13176, total FA: 18294

server round 33/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=46.8] | Loss=0.37130 | Reg=0.00169 | acc=0.8125 | L2-Norm=12.997 | L2-Norm(final)=3.087 | 3715.9 samples/s | 58.1 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03299 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=3.083 | 4512.1 samples/s | 70.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.02015 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.084 | 4631.6 samples/s | 72.4 steps/s
[Step=9750 Epoch=47.6] | Loss=0.01582 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.032 | L2-Norm(final)=3.085 | 4573.4 samples/s | 71.5 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01340 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.035 | L2-Norm(final)=3.087 | 6077.8 samples/s | 95.0 steps/s
[Step=9850 Epoch=48.1] | Loss=0.01151 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.038 | L2-Norm(final)=3.089 | 1766.7 samples/s | 27.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01014 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=3.092 | 4593.2 samples/s | 71.8 steps/s
[Step=9950 Epoch=48.6] | Loss=0.00919 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=3.094 | 4563.3 samples/s | 71.3 steps/s
[Step=10000 Epoch=48.8] | Loss=0.00853 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.096 | 5853.4 samples/s | 91.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.00791 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=3.098 | 1814.0 samples/s | 28.3 steps/s
[Step=10100 Epoch=49.3] | Loss=0.00743 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.049 | L2-Norm(final)=3.100 | 4629.0 samples/s | 72.3 steps/s
[Step=10150 Epoch=49.5] | Loss=0.00706 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=3.102 | 4577.9 samples/s | 71.5 steps/s
[Step=10200 Epoch=49.8] | Loss=0.00676 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=3.104 | 5486.7 samples/s | 85.7 steps/s
[Step=10250 Epoch=50.0] | Loss=0.00648 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=3.105 | 1862.6 samples/s | 29.1 steps/s
[Step=10300 Epoch=50.3] | Loss=0.00622 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=3.107 | 4538.9 samples/s | 70.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.00597 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.057 | L2-Norm(final)=3.109 | 4618.0 samples/s | 72.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00584 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=3.110 | 5125.8 samples/s | 80.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=144.6] | Loss=0.09248 | Reg=0.00169 | acc=0.9375 | L2-Norm=12.997 | L2-Norm(final)=3.087 | 3785.4 samples/s | 59.1 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00487 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.086 | 4007.9 samples/s | 62.6 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00247 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=3.087 | 5913.4 samples/s | 92.4 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00166 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=3.087 | 1672.1 samples/s | 26.1 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00125 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=3.088 | 5390.0 samples/s | 84.2 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00100 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=3.088 | 1773.9 samples/s | 27.7 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00084 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.089 | 5045.6 samples/s | 78.8 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00072 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=3.089 | 1801.0 samples/s | 28.1 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00063 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=3.090 | 4729.8 samples/s | 73.9 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00056 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.090 | 1861.3 samples/s | 29.1 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00051 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=3.090 | 4448.6 samples/s | 69.5 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00046 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=3.091 | 1869.8 samples/s | 29.2 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00042 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=3.091 | 4402.3 samples/s | 68.8 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.091 | 1908.0 samples/s | 29.8 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00036 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=3.092 | 4446.6 samples/s | 69.5 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00034 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=3.092 | 1954.9 samples/s | 30.5 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00032 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.092 | 4407.7 samples/s | 68.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51738 | acc=0.7705 | tpr=0.6710 | fpr=0.0134 | 3952.7 samples/s | 15.4 steps/s
Avg test loss: 0.52737, Avg test acc: 0.76781, Avg tpr: 0.66888, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.42261 | acc=0.8820 | tpr=0.9071 | fpr=0.1184 | 4010.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.43103 | acc=0.8828 | tpr=0.9211 | fpr=0.1179 | 7518.7 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.43598 | acc=0.8832 | tpr=0.9323 | fpr=0.1178 | 7744.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.44072 | acc=0.8835 | tpr=0.9366 | fpr=0.1175 | 7123.3 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.43968 | acc=0.8836 | tpr=0.9380 | fpr=0.1174 | 7624.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.44068 | acc=0.8835 | tpr=0.9418 | fpr=0.1176 | 7473.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.44392 | acc=0.8830 | tpr=0.9449 | fpr=0.1181 | 7752.0 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.44535 | acc=0.8827 | tpr=0.9426 | fpr=0.1183 | 7779.4 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.44897 | acc=0.8828 | tpr=0.9421 | fpr=0.1183 | 7286.6 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.44808 | acc=0.8827 | tpr=0.9436 | fpr=0.1184 | 7621.4 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.44555 | acc=0.8832 | tpr=0.9443 | fpr=0.1180 | 14816.9 samples/s | 57.9 steps/s
Avg test loss: 0.44497, Avg test acc: 0.88322, Avg tpr: 0.94453, Avg fpr: 0.11790, total FA: 16370

server round 34/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.1] | Loss=0.15261 | Reg=0.00168 | acc=0.8750 | L2-Norm=12.976 | L2-Norm(final)=3.104 | 3933.9 samples/s | 61.5 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03552 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.000 | L2-Norm(final)=3.101 | 4382.1 samples/s | 68.5 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02251 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.009 | L2-Norm(final)=3.102 | 4570.3 samples/s | 71.4 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01691 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.105 | 4561.2 samples/s | 71.3 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01400 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=3.108 | 6074.6 samples/s | 94.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01204 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=3.111 | 1768.2 samples/s | 27.6 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01058 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.027 | L2-Norm(final)=3.114 | 4510.6 samples/s | 70.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.00966 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.116 | 4560.9 samples/s | 71.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00892 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.033 | L2-Norm(final)=3.119 | 5559.8 samples/s | 86.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00821 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.035 | L2-Norm(final)=3.121 | 1821.7 samples/s | 28.5 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00761 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=3.124 | 4570.3 samples/s | 71.4 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00723 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=3.126 | 4489.5 samples/s | 70.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00704 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=3.128 | 5284.8 samples/s | 82.6 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00677 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.044 | L2-Norm(final)=3.130 | 1870.4 samples/s | 29.2 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00649 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.132 | 4509.7 samples/s | 70.5 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00625 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.047 | L2-Norm(final)=3.134 | 4557.8 samples/s | 71.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00603 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=3.136 | 4942.4 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=152.2] | Loss=0.03252 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.976 | L2-Norm(final)=3.104 | 3742.6 samples/s | 58.5 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00325 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=3.102 | 3980.8 samples/s | 62.2 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00166 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=3.102 | 5843.0 samples/s | 91.3 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00111 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.103 | 1719.8 samples/s | 26.9 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00084 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=3.103 | 5518.1 samples/s | 86.2 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00067 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=3.104 | 1786.4 samples/s | 27.9 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00056 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=3.104 | 5026.6 samples/s | 78.5 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00049 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.104 | 1795.0 samples/s | 28.0 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00043 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.105 | 4778.2 samples/s | 74.7 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00038 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=3.105 | 1855.5 samples/s | 29.0 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00034 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.105 | 4512.3 samples/s | 70.5 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00031 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.106 | 1898.8 samples/s | 29.7 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00029 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.106 | 4410.1 samples/s | 68.9 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00027 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.106 | 1877.8 samples/s | 29.3 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00025 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=3.107 | 4322.2 samples/s | 67.5 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00023 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.107 | 1936.0 samples/s | 30.3 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00022 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.107 | 4255.5 samples/s | 66.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48980 | acc=0.7804 | tpr=0.6860 | fpr=0.0146 | 4003.5 samples/s | 15.6 steps/s
Avg test loss: 0.49943, Avg test acc: 0.77939, Avg tpr: 0.68654, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.44091 | acc=0.8739 | tpr=0.9115 | fpr=0.1268 | 3975.0 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.44939 | acc=0.8748 | tpr=0.9275 | fpr=0.1262 | 7768.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.45444 | acc=0.8752 | tpr=0.9380 | fpr=0.1259 | 7745.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.45913 | acc=0.8755 | tpr=0.9410 | fpr=0.1256 | 7744.0 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.45831 | acc=0.8755 | tpr=0.9415 | fpr=0.1257 | 7818.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.45904 | acc=0.8757 | tpr=0.9447 | fpr=0.1255 | 7871.7 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.46230 | acc=0.8754 | tpr=0.9474 | fpr=0.1259 | 8018.5 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.46371 | acc=0.8751 | tpr=0.9437 | fpr=0.1262 | 7093.0 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.46730 | acc=0.8748 | tpr=0.9430 | fpr=0.1264 | 7679.1 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.46656 | acc=0.8748 | tpr=0.9449 | fpr=0.1265 | 7488.0 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.46416 | acc=0.8751 | tpr=0.9451 | fpr=0.1262 | 13885.9 samples/s | 54.2 steps/s
Avg test loss: 0.46360, Avg test acc: 0.87517, Avg tpr: 0.94532, Avg fpr: 0.12610, total FA: 17509

server round 35/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.18491 | Reg=0.00168 | acc=0.8750 | L2-Norm=12.961 | L2-Norm(final)=3.117 | 3742.7 samples/s | 58.5 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03292 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.114 | 4479.8 samples/s | 70.0 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02025 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=3.115 | 4568.3 samples/s | 71.4 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01521 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.117 | 4566.9 samples/s | 71.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01271 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=3.120 | 6100.2 samples/s | 95.3 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01114 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=3.122 | 1770.0 samples/s | 27.7 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01000 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.016 | L2-Norm(final)=3.125 | 4610.6 samples/s | 72.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.00895 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=3.127 | 4504.5 samples/s | 70.4 steps/s
[Step=16400 Epoch=80.0] | Loss=0.00843 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.022 | L2-Norm(final)=3.129 | 5689.8 samples/s | 88.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00784 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=3.132 | 1808.4 samples/s | 28.3 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00734 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=3.134 | 4667.1 samples/s | 72.9 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00692 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.136 | 4558.7 samples/s | 71.2 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00667 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.138 | 5329.6 samples/s | 83.3 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00707 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=3.140 | 1873.2 samples/s | 29.3 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00677 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=3.141 | 4586.5 samples/s | 71.7 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00657 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=3.143 | 4411.5 samples/s | 68.9 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00640 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.144 | 4845.0 samples/s | 75.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=159.8] | Loss=0.01020 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.117 | 3945.6 samples/s | 61.6 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00303 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.115 | 3844.3 samples/s | 60.1 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00154 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.116 | 5856.5 samples/s | 91.5 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00103 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.116 | 1710.2 samples/s | 26.7 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00078 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.117 | 5465.8 samples/s | 85.4 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00063 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.117 | 1767.9 samples/s | 27.6 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00052 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=3.117 | 5035.9 samples/s | 78.7 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00045 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=3.118 | 1782.3 samples/s | 27.8 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00040 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=3.118 | 4767.5 samples/s | 74.5 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00035 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=3.118 | 1876.0 samples/s | 29.3 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00032 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=3.119 | 4356.2 samples/s | 68.1 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00029 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.119 | 1911.4 samples/s | 29.9 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00027 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=3.119 | 4319.8 samples/s | 67.5 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00025 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.120 | 1916.3 samples/s | 29.9 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00023 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=3.120 | 4393.2 samples/s | 68.6 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00021 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.121 | 1927.6 samples/s | 30.1 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00020 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.121 | 4379.2 samples/s | 68.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46013 | acc=0.7922 | tpr=0.7040 | fpr=0.0164 | 3858.5 samples/s | 15.1 steps/s
Avg test loss: 0.46912, Avg test acc: 0.79205, Avg tpr: 0.70548, Avg fpr: 0.01756, total FA: 137

Testing server on iccad2012
[Step=  50] | Loss=0.45843 | acc=0.8685 | tpr=0.9159 | fpr=0.1323 | 3937.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.46703 | acc=0.8692 | tpr=0.9275 | fpr=0.1319 | 7733.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.47139 | acc=0.8698 | tpr=0.9395 | fpr=0.1315 | 7629.0 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.47616 | acc=0.8704 | tpr=0.9421 | fpr=0.1309 | 7667.5 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.47594 | acc=0.8702 | tpr=0.9424 | fpr=0.1311 | 7781.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.47681 | acc=0.8703 | tpr=0.9455 | fpr=0.1311 | 7491.9 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.48018 | acc=0.8701 | tpr=0.9487 | fpr=0.1313 | 7527.5 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.48151 | acc=0.8701 | tpr=0.9447 | fpr=0.1312 | 7459.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.48503 | acc=0.8699 | tpr=0.9440 | fpr=0.1314 | 7584.1 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.48440 | acc=0.8699 | tpr=0.9458 | fpr=0.1315 | 7271.0 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.48203 | acc=0.8702 | tpr=0.9459 | fpr=0.1312 | 14027.6 samples/s | 54.8 steps/s
Avg test loss: 0.48147, Avg test acc: 0.87023, Avg tpr: 0.94612, Avg fpr: 0.13115, total FA: 18210

server round 36/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=81.9] | Loss=0.16512 | Reg=0.00168 | acc=0.8750 | L2-Norm=12.948 | L2-Norm(final)=3.120 | 4013.3 samples/s | 62.7 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03079 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.971 | L2-Norm(final)=3.115 | 4095.5 samples/s | 64.0 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01906 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.116 | 4587.0 samples/s | 71.7 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01453 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.985 | L2-Norm(final)=3.119 | 4542.5 samples/s | 71.0 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01250 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=3.122 | 6133.5 samples/s | 95.8 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01083 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=3.125 | 1762.1 samples/s | 27.5 steps/s
[Step=17100 Epoch=83.4] | Loss=0.00969 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=3.128 | 4558.6 samples/s | 71.2 steps/s
[Step=17150 Epoch=83.6] | Loss=0.00878 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.130 | 4557.5 samples/s | 71.2 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00805 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=3.133 | 5724.3 samples/s | 89.4 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00769 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.135 | 1807.3 samples/s | 28.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00717 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=3.137 | 4597.9 samples/s | 71.8 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00674 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=3.140 | 4613.7 samples/s | 72.1 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00642 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=3.142 | 5288.5 samples/s | 82.6 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00621 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=3.144 | 1866.1 samples/s | 29.2 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00586 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=3.146 | 4547.6 samples/s | 71.1 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00572 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.015 | L2-Norm(final)=3.148 | 4595.5 samples/s | 71.8 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00558 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.016 | L2-Norm(final)=3.150 | 4958.8 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=121.3] | Loss=0.02149 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.948 | L2-Norm(final)=3.120 | 3520.0 samples/s | 55.0 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00228 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.119 | 4397.5 samples/s | 68.7 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00115 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.120 | 5928.3 samples/s | 92.6 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00077 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.120 | 1736.4 samples/s | 27.1 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00059 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=3.121 | 5315.8 samples/s | 83.1 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00047 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=3.122 | 1772.8 samples/s | 27.7 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00040 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=3.122 | 5014.8 samples/s | 78.4 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00034 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=3.123 | 1832.0 samples/s | 28.6 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00030 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.123 | 4663.3 samples/s | 72.9 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00027 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.124 | 1881.3 samples/s | 29.4 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00024 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.124 | 4422.0 samples/s | 69.1 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00022 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=3.125 | 1926.4 samples/s | 30.1 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00020 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.125 | 4333.1 samples/s | 67.7 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00019 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.125 | 1933.3 samples/s | 30.2 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=3.126 | 4322.4 samples/s | 67.5 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00016 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.126 | 1941.2 samples/s | 30.3 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00015 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.127 | 4354.6 samples/s | 68.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48339 | acc=0.7848 | tpr=0.6926 | fpr=0.0149 | 4048.3 samples/s | 15.8 steps/s
Avg test loss: 0.49288, Avg test acc: 0.78288, Avg tpr: 0.69190, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.42684 | acc=0.8789 | tpr=0.9071 | fpr=0.1216 | 4017.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.43445 | acc=0.8803 | tpr=0.9232 | fpr=0.1205 | 7712.9 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.43950 | acc=0.8808 | tpr=0.9352 | fpr=0.1202 | 7692.1 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.44445 | acc=0.8811 | tpr=0.9388 | fpr=0.1199 | 7991.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.44417 | acc=0.8808 | tpr=0.9397 | fpr=0.1203 | 7550.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.44486 | acc=0.8808 | tpr=0.9433 | fpr=0.1203 | 8016.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.44823 | acc=0.8805 | tpr=0.9461 | fpr=0.1207 | 7715.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.44953 | acc=0.8804 | tpr=0.9426 | fpr=0.1208 | 7768.9 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.45318 | acc=0.8801 | tpr=0.9416 | fpr=0.1210 | 7718.7 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.45260 | acc=0.8800 | tpr=0.9441 | fpr=0.1211 | 7545.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.45028 | acc=0.8803 | tpr=0.9443 | fpr=0.1209 | 14377.4 samples/s | 56.2 steps/s
Avg test loss: 0.44969, Avg test acc: 0.88032, Avg tpr: 0.94453, Avg fpr: 0.12084, total FA: 16779

server round 37/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=85.8] | Loss=0.33470 | Reg=0.00167 | acc=0.7969 | L2-Norm=12.930 | L2-Norm(final)=3.143 | 3720.6 samples/s | 58.1 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02908 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=3.141 | 4603.2 samples/s | 71.9 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01794 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.963 | L2-Norm(final)=3.142 | 4675.8 samples/s | 73.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01385 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=3.145 | 4478.3 samples/s | 70.0 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01137 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.973 | L2-Norm(final)=3.148 | 6111.8 samples/s | 95.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00979 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.977 | L2-Norm(final)=3.151 | 1791.0 samples/s | 28.0 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00860 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.154 | 4541.2 samples/s | 71.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00786 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.156 | 4663.2 samples/s | 72.9 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00744 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.159 | 5626.2 samples/s | 87.9 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00686 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.161 | 1805.4 samples/s | 28.2 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00659 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.990 | L2-Norm(final)=3.163 | 4494.7 samples/s | 70.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00624 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.165 | 4557.3 samples/s | 71.2 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00607 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.993 | L2-Norm(final)=3.167 | 5322.8 samples/s | 83.2 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00584 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.169 | 1861.4 samples/s | 29.1 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00555 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=3.171 | 4627.7 samples/s | 72.3 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00540 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=3.173 | 4538.2 samples/s | 70.9 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00525 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.175 | 5004.8 samples/s | 78.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=167.4] | Loss=0.07105 | Reg=0.00167 | acc=0.9375 | L2-Norm=12.930 | L2-Norm(final)=3.143 | 3768.4 samples/s | 58.9 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00216 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.145 | 4046.9 samples/s | 63.2 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00111 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.145 | 5969.7 samples/s | 93.3 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00075 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.145 | 1736.7 samples/s | 27.1 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00056 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.146 | 5461.7 samples/s | 85.3 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00045 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=3.146 | 1758.5 samples/s | 27.5 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00038 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.147 | 4981.6 samples/s | 77.8 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00033 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=3.147 | 1822.6 samples/s | 28.5 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00029 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.147 | 4776.0 samples/s | 74.6 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00026 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=3.148 | 1860.0 samples/s | 29.1 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00023 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=3.148 | 4486.3 samples/s | 70.1 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00021 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.148 | 1861.9 samples/s | 29.1 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00020 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.149 | 4377.1 samples/s | 68.4 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00018 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.149 | 1914.2 samples/s | 29.9 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.149 | 4426.4 samples/s | 69.2 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00016 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.149 | 1892.0 samples/s | 29.6 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00015 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.150 | 4328.6 samples/s | 67.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48230 | acc=0.7852 | tpr=0.6931 | fpr=0.0146 | 3836.5 samples/s | 15.0 steps/s
Avg test loss: 0.49347, Avg test acc: 0.78300, Avg tpr: 0.69202, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.43508 | acc=0.8740 | tpr=0.9071 | fpr=0.1266 | 3904.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.44169 | acc=0.8761 | tpr=0.9254 | fpr=0.1248 | 7307.6 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.44636 | acc=0.8768 | tpr=0.9366 | fpr=0.1243 | 7539.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.45077 | acc=0.8769 | tpr=0.9388 | fpr=0.1242 | 7360.5 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.45044 | acc=0.8767 | tpr=0.9397 | fpr=0.1245 | 7434.4 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.45086 | acc=0.8768 | tpr=0.9433 | fpr=0.1244 | 7988.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.45432 | acc=0.8767 | tpr=0.9468 | fpr=0.1246 | 7238.5 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.45548 | acc=0.8767 | tpr=0.9437 | fpr=0.1245 | 7713.0 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.45933 | acc=0.8765 | tpr=0.9421 | fpr=0.1247 | 7697.5 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.45880 | acc=0.8767 | tpr=0.9441 | fpr=0.1246 | 8039.0 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.45639 | acc=0.8769 | tpr=0.9439 | fpr=0.1243 | 12568.0 samples/s | 49.1 steps/s
Avg test loss: 0.45580, Avg test acc: 0.87701, Avg tpr: 0.94414, Avg fpr: 0.12421, total FA: 17247

server round 38/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=89.7] | Loss=0.21026 | Reg=0.00167 | acc=0.8594 | L2-Norm=12.918 | L2-Norm(final)=3.156 | 3756.7 samples/s | 58.7 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02563 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=3.154 | 4286.4 samples/s | 67.0 steps/s
[Step=18500 Epoch=90.2] | Loss=0.01633 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.954 | L2-Norm(final)=3.157 | 4544.8 samples/s | 71.0 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01247 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=3.159 | 4552.7 samples/s | 71.1 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01074 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=3.162 | 6124.5 samples/s | 95.7 steps/s
[Step=18650 Epoch=90.9] | Loss=0.00912 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.165 | 1747.9 samples/s | 27.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.00826 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.168 | 4636.9 samples/s | 72.5 steps/s
[Step=18750 Epoch=91.4] | Loss=0.00763 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=3.170 | 4544.3 samples/s | 71.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.00715 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=3.172 | 5702.1 samples/s | 89.1 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00680 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.174 | 1822.6 samples/s | 28.5 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00643 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.177 | 4586.1 samples/s | 71.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00609 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.179 | 4575.0 samples/s | 71.5 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00578 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=3.181 | 5408.7 samples/s | 84.5 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00565 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.183 | 1850.4 samples/s | 28.9 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00543 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.185 | 4564.3 samples/s | 71.3 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00519 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.187 | 4491.5 samples/s | 70.2 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00515 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.189 | 4964.8 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=128.9] | Loss=0.15536 | Reg=0.00167 | acc=0.9062 | L2-Norm=12.918 | L2-Norm(final)=3.155 | 3801.1 samples/s | 59.4 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00477 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=3.153 | 3901.8 samples/s | 61.0 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00241 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=3.153 | 5887.0 samples/s | 92.0 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00161 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=3.153 | 1705.4 samples/s | 26.6 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00121 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=3.153 | 5491.8 samples/s | 85.8 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00097 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.154 | 1776.3 samples/s | 27.8 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00081 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=3.154 | 5021.6 samples/s | 78.5 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00070 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.154 | 1794.9 samples/s | 28.0 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00061 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.155 | 4750.7 samples/s | 74.2 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00055 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.155 | 1847.3 samples/s | 28.9 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00049 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.155 | 4512.1 samples/s | 70.5 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00045 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.155 | 1875.6 samples/s | 29.3 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00041 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.156 | 4405.9 samples/s | 68.8 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00038 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.156 | 1863.8 samples/s | 29.1 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00035 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.156 | 4285.5 samples/s | 67.0 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.156 | 1910.5 samples/s | 29.9 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00031 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.156 | 4308.9 samples/s | 67.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50531 | acc=0.7752 | tpr=0.6793 | fpr=0.0164 | 3839.0 samples/s | 15.0 steps/s
Avg test loss: 0.51608, Avg test acc: 0.77442, Avg tpr: 0.67996, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=0.41055 | acc=0.8820 | tpr=0.9071 | fpr=0.1184 | 4023.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.41832 | acc=0.8835 | tpr=0.9232 | fpr=0.1172 | 7364.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.42350 | acc=0.8840 | tpr=0.9366 | fpr=0.1169 | 7778.6 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.42778 | acc=0.8846 | tpr=0.9388 | fpr=0.1164 | 7844.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.42725 | acc=0.8845 | tpr=0.9380 | fpr=0.1165 | 7474.2 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.42788 | acc=0.8848 | tpr=0.9425 | fpr=0.1163 | 7638.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.43113 | acc=0.8843 | tpr=0.9455 | fpr=0.1168 | 7684.8 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.43240 | acc=0.8839 | tpr=0.9426 | fpr=0.1171 | 7927.2 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.43624 | acc=0.8837 | tpr=0.9411 | fpr=0.1174 | 7896.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.43589 | acc=0.8836 | tpr=0.9427 | fpr=0.1174 | 7399.2 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.43349 | acc=0.8840 | tpr=0.9435 | fpr=0.1170 | 14171.0 samples/s | 55.4 steps/s
Avg test loss: 0.43292, Avg test acc: 0.88409, Avg tpr: 0.94374, Avg fpr: 0.11699, total FA: 16244

server round 39/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=19201 Epoch=93.6] | Loss=0.15753 | Reg=0.00167 | acc=0.8438 | L2-Norm=12.916 | L2-Norm(final)=3.166 | 3880.0 samples/s | 60.6 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02470 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.163 | 4352.0 samples/s | 68.0 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01635 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.166 | 4637.5 samples/s | 72.5 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01246 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=3.169 | 4543.2 samples/s | 71.0 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01057 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=3.173 | 6179.7 samples/s | 96.6 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00916 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=3.176 | 1782.5 samples/s | 27.9 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00812 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=3.179 | 4609.1 samples/s | 72.0 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00796 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.974 | L2-Norm(final)=3.182 | 4551.3 samples/s | 71.1 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00741 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.977 | L2-Norm(final)=3.184 | 5668.6 samples/s | 88.6 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00701 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.979 | L2-Norm(final)=3.186 | 1815.3 samples/s | 28.4 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00664 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.188 | 4582.9 samples/s | 71.6 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00641 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=3.190 | 4661.6 samples/s | 72.8 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00610 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.192 | 5288.3 samples/s | 82.6 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00587 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.194 | 1854.9 samples/s | 29.0 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00560 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.195 | 4551.8 samples/s | 71.1 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00541 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.197 | 4378.0 samples/s | 68.4 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00530 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=3.199 | 4799.4 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=136.5] | Loss=0.05461 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.916 | L2-Norm(final)=3.166 | 3839.0 samples/s | 60.0 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00207 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.170 | 3923.6 samples/s | 61.3 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00105 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.171 | 5747.3 samples/s | 89.8 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00070 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.172 | 1715.1 samples/s | 26.8 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00053 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.172 | 5402.5 samples/s | 84.4 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00043 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.173 | 1774.0 samples/s | 27.7 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00036 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.173 | 5009.3 samples/s | 78.3 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00031 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.173 | 1779.9 samples/s | 27.8 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00027 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=3.174 | 4630.0 samples/s | 72.3 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00024 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.174 | 1856.5 samples/s | 29.0 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00022 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.174 | 4371.1 samples/s | 68.3 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00020 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.174 | 1908.2 samples/s | 29.8 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00018 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.175 | 4493.8 samples/s | 70.2 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.175 | 1944.6 samples/s | 30.4 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=3.175 | 4315.6 samples/s | 67.4 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00015 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.175 | 1915.3 samples/s | 29.9 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00014 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.176 | 4249.2 samples/s | 66.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45956 | acc=0.7951 | tpr=0.7085 | fpr=0.0168 | 3990.3 samples/s | 15.6 steps/s
Avg test loss: 0.46967, Avg test acc: 0.79445, Avg tpr: 0.70921, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.45632 | acc=0.8650 | tpr=0.9027 | fpr=0.1357 | 4044.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.46181 | acc=0.8689 | tpr=0.9190 | fpr=0.1320 | 7819.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.46579 | acc=0.8702 | tpr=0.9337 | fpr=0.1310 | 7502.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.47018 | acc=0.8702 | tpr=0.9366 | fpr=0.1310 | 7636.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.46956 | acc=0.8702 | tpr=0.9380 | fpr=0.1310 | 7716.2 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.47002 | acc=0.8703 | tpr=0.9418 | fpr=0.1310 | 7551.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.47321 | acc=0.8702 | tpr=0.9449 | fpr=0.1312 | 7731.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.47477 | acc=0.8697 | tpr=0.9420 | fpr=0.1317 | 8002.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.47847 | acc=0.8696 | tpr=0.9416 | fpr=0.1317 | 5308.2 samples/s | 20.7 steps/s
[Step= 500] | Loss=0.47802 | acc=0.8695 | tpr=0.9436 | fpr=0.1318 | 5921.5 samples/s | 23.1 steps/s
[Step= 550] | Loss=0.47546 | acc=0.8700 | tpr=0.9439 | fpr=0.1313 | 14419.9 samples/s | 56.3 steps/s
Avg test loss: 0.47490, Avg test acc: 0.87004, Avg tpr: 0.94414, Avg fpr: 0.13130, total FA: 18231

server round 40/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=97.5] | Loss=0.16009 | Reg=0.00167 | acc=0.9219 | L2-Norm=12.913 | L2-Norm(final)=3.173 | 3712.6 samples/s | 58.0 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02406 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.175 | 4510.9 samples/s | 70.5 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01476 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=3.177 | 4567.5 samples/s | 71.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01207 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.178 | 4592.6 samples/s | 71.8 steps/s
[Step=20200 Epoch=98.5] | Loss=0.00994 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.180 | 6110.5 samples/s | 95.5 steps/s
[Step=20250 Epoch=98.7] | Loss=0.00866 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.940 | L2-Norm(final)=3.182 | 1783.5 samples/s | 27.9 steps/s
[Step=20300 Epoch=99.0] | Loss=0.00775 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.184 | 4467.0 samples/s | 69.8 steps/s
[Step=20350 Epoch=99.2] | Loss=0.00703 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=3.186 | 4632.9 samples/s | 72.4 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00658 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=3.187 | 5623.5 samples/s | 87.9 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00631 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.189 | 1802.4 samples/s | 28.2 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00610 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=3.190 | 4567.3 samples/s | 71.4 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00573 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=3.192 | 4529.6 samples/s | 70.8 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00546 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=3.193 | 5219.2 samples/s | 81.5 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00523 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=3.194 | 1878.1 samples/s | 29.3 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00500 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.196 | 4539.4 samples/s | 70.9 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00483 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=3.197 | 4536.3 samples/s | 70.9 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00473 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.199 | 5003.2 samples/s | 78.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=144.0] | Loss=0.00813 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.173 | 3509.2 samples/s | 54.8 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00431 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.173 | 4109.3 samples/s | 64.2 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00219 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.173 | 5873.9 samples/s | 91.8 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00147 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.173 | 1735.7 samples/s | 27.1 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00111 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=3.173 | 5387.5 samples/s | 84.2 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00089 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.173 | 1761.1 samples/s | 27.5 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00074 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.174 | 4944.1 samples/s | 77.3 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00064 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.174 | 1824.8 samples/s | 28.5 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00056 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.174 | 4701.5 samples/s | 73.5 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00050 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.174 | 1835.5 samples/s | 28.7 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00045 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.174 | 4479.1 samples/s | 70.0 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00041 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.175 | 1910.9 samples/s | 29.9 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00038 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.175 | 4355.2 samples/s | 68.0 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00035 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.175 | 1912.2 samples/s | 29.9 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.175 | 4423.8 samples/s | 69.1 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00031 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.175 | 1873.6 samples/s | 29.3 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00029 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=3.175 | 4399.6 samples/s | 68.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44743 | acc=0.7992 | tpr=0.7141 | fpr=0.0159 | 3839.0 samples/s | 15.0 steps/s
Avg test loss: 0.45734, Avg test acc: 0.79806, Avg tpr: 0.71440, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.46543 | acc=0.8638 | tpr=0.9071 | fpr=0.1370 | 3766.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.47139 | acc=0.8664 | tpr=0.9232 | fpr=0.1347 | 7335.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.47572 | acc=0.8674 | tpr=0.9380 | fpr=0.1339 | 7521.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.47998 | acc=0.8675 | tpr=0.9399 | fpr=0.1338 | 7619.6 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.47947 | acc=0.8670 | tpr=0.9397 | fpr=0.1344 | 4930.4 samples/s | 19.3 steps/s
[Step= 300] | Loss=0.47974 | acc=0.8674 | tpr=0.9440 | fpr=0.1340 | 7691.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.48312 | acc=0.8672 | tpr=0.9461 | fpr=0.1342 | 7637.3 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.48462 | acc=0.8668 | tpr=0.9431 | fpr=0.1346 | 7436.2 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.48830 | acc=0.8666 | tpr=0.9421 | fpr=0.1348 | 7499.5 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.48788 | acc=0.8666 | tpr=0.9441 | fpr=0.1348 | 8344.3 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.48521 | acc=0.8670 | tpr=0.9447 | fpr=0.1344 | 12645.5 samples/s | 49.4 steps/s
Avg test loss: 0.48463, Avg test acc: 0.86708, Avg tpr: 0.94493, Avg fpr: 0.13433, total FA: 18652

server round 41/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=10401 Epoch=50.8] | Loss=0.27308 | Reg=0.00167 | acc=0.8438 | L2-Norm=12.921 | L2-Norm(final)=3.171 | 3875.1 samples/s | 60.5 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03731 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.170 | 4533.9 samples/s | 70.8 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02152 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.169 | 4595.2 samples/s | 71.8 steps/s
[Step=10550 Epoch=51.5] | Loss=0.01615 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.170 | 4605.9 samples/s | 72.0 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01284 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.944 | L2-Norm(final)=3.171 | 6087.6 samples/s | 95.1 steps/s
[Step=10650 Epoch=52.0] | Loss=0.01092 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=3.173 | 1776.9 samples/s | 27.8 steps/s
[Step=10700 Epoch=52.2] | Loss=0.00963 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=3.174 | 4622.6 samples/s | 72.2 steps/s
[Step=10750 Epoch=52.5] | Loss=0.00860 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.948 | L2-Norm(final)=3.175 | 4545.1 samples/s | 71.0 steps/s
[Step=10800 Epoch=52.7] | Loss=0.00786 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=3.176 | 5775.7 samples/s | 90.2 steps/s
[Step=10850 Epoch=52.9] | Loss=0.00726 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=3.178 | 1807.6 samples/s | 28.2 steps/s
[Step=10900 Epoch=53.2] | Loss=0.00678 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=3.179 | 4578.0 samples/s | 71.5 steps/s
[Step=10950 Epoch=53.4] | Loss=0.00640 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.180 | 4604.3 samples/s | 71.9 steps/s
[Step=11000 Epoch=53.7] | Loss=0.00608 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=3.181 | 5375.0 samples/s | 84.0 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00579 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.182 | 1848.4 samples/s | 28.9 steps/s
[Step=11100 Epoch=54.2] | Loss=0.00555 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=3.183 | 4544.4 samples/s | 71.0 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00534 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.184 | 4601.7 samples/s | 71.9 steps/s
[Step=11200 Epoch=54.7] | Loss=0.00515 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=3.185 | 5191.6 samples/s | 81.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=175.0] | Loss=0.10483 | Reg=0.00167 | acc=0.9375 | L2-Norm=12.921 | L2-Norm(final)=3.171 | 3863.2 samples/s | 60.4 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00361 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.173 | 4048.0 samples/s | 63.3 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00184 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=3.173 | 5890.6 samples/s | 92.0 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00124 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.174 | 1749.3 samples/s | 27.3 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00094 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.174 | 5467.4 samples/s | 85.4 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00075 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=3.174 | 1774.1 samples/s | 27.7 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00063 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=3.175 | 5106.1 samples/s | 79.8 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00054 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.175 | 1820.2 samples/s | 28.4 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.175 | 4709.7 samples/s | 73.6 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00043 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.175 | 1861.7 samples/s | 29.1 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00039 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=3.176 | 4493.2 samples/s | 70.2 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00035 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=3.176 | 1902.3 samples/s | 29.7 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00032 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.176 | 4396.7 samples/s | 68.7 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00030 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.176 | 1918.0 samples/s | 30.0 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00028 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.176 | 4353.0 samples/s | 68.0 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00026 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.177 | 1950.2 samples/s | 30.5 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00025 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.177 | 4316.5 samples/s | 67.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43710 | acc=0.8057 | tpr=0.7241 | fpr=0.0171 | 2924.3 samples/s | 11.4 steps/s
Avg test loss: 0.44810, Avg test acc: 0.80443, Avg tpr: 0.72396, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.46361 | acc=0.8665 | tpr=0.9027 | fpr=0.1342 | 2944.2 samples/s | 11.5 steps/s
[Step= 100] | Loss=0.46898 | acc=0.8683 | tpr=0.9190 | fpr=0.1326 | 7834.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.47313 | acc=0.8695 | tpr=0.9352 | fpr=0.1317 | 7648.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.47765 | acc=0.8696 | tpr=0.9377 | fpr=0.1316 | 7333.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.47685 | acc=0.8691 | tpr=0.9380 | fpr=0.1321 | 7486.1 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.47702 | acc=0.8693 | tpr=0.9418 | fpr=0.1320 | 7450.9 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.48032 | acc=0.8693 | tpr=0.9443 | fpr=0.1320 | 7312.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.48188 | acc=0.8690 | tpr=0.9420 | fpr=0.1323 | 7992.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.48538 | acc=0.8688 | tpr=0.9411 | fpr=0.1325 | 7343.7 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.48478 | acc=0.8688 | tpr=0.9427 | fpr=0.1325 | 7827.1 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.48209 | acc=0.8693 | tpr=0.9427 | fpr=0.1321 | 13761.1 samples/s | 53.8 steps/s
Avg test loss: 0.48150, Avg test acc: 0.86930, Avg tpr: 0.94295, Avg fpr: 0.13204, total FA: 18333

server round 42/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=11201 Epoch=54.7] | Loss=0.16716 | Reg=0.00167 | acc=0.9375 | L2-Norm=12.909 | L2-Norm(final)=3.194 | 3322.8 samples/s | 51.9 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02051 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.197 | 2136.5 samples/s | 33.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.01305 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.199 | 4229.8 samples/s | 66.1 steps/s
[Step=11350 Epoch=55.4] | Loss=0.01048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.200 | 4661.3 samples/s | 72.8 steps/s
[Step=11400 Epoch=55.6] | Loss=0.00891 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.201 | 6028.3 samples/s | 94.2 steps/s
[Step=11450 Epoch=55.9] | Loss=0.00785 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=3.203 | 1744.3 samples/s | 27.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.00718 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.934 | L2-Norm(final)=3.204 | 4618.0 samples/s | 72.2 steps/s
[Step=11550 Epoch=56.4] | Loss=0.00650 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.205 | 4646.2 samples/s | 72.6 steps/s
[Step=11600 Epoch=56.6] | Loss=0.00590 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.206 | 5670.8 samples/s | 88.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.00542 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.207 | 1792.0 samples/s | 28.0 steps/s
[Step=11700 Epoch=57.1] | Loss=0.00503 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.209 | 4500.7 samples/s | 70.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.00484 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.210 | 4542.4 samples/s | 71.0 steps/s
[Step=11800 Epoch=57.6] | Loss=0.00462 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.211 | 5424.1 samples/s | 84.8 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00455 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.212 | 1852.6 samples/s | 28.9 steps/s
[Step=11900 Epoch=58.1] | Loss=0.00436 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.213 | 4524.9 samples/s | 70.7 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00425 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.943 | L2-Norm(final)=3.214 | 4582.5 samples/s | 71.6 steps/s
[Step=12000 Epoch=58.6] | Loss=0.00410 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=3.215 | 5079.1 samples/s | 79.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=182.6] | Loss=0.03655 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.909 | L2-Norm(final)=3.194 | 3743.9 samples/s | 58.5 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00603 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.193 | 4088.5 samples/s | 63.9 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00304 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.193 | 5818.0 samples/s | 90.9 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00204 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.194 | 1744.6 samples/s | 27.3 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00153 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.194 | 5386.5 samples/s | 84.2 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00123 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.194 | 1755.0 samples/s | 27.4 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00103 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.194 | 5027.6 samples/s | 78.6 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00088 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.194 | 1802.5 samples/s | 28.2 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00078 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.194 | 4714.1 samples/s | 73.7 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00069 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=3.194 | 1864.8 samples/s | 29.1 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00062 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.194 | 4473.4 samples/s | 69.9 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00057 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.195 | 1889.7 samples/s | 29.5 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00052 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.195 | 4312.1 samples/s | 67.4 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.195 | 1906.0 samples/s | 29.8 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00045 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.195 | 4310.0 samples/s | 67.3 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00042 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.195 | 1934.1 samples/s | 30.2 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00039 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.195 | 4241.4 samples/s | 66.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47272 | acc=0.7938 | tpr=0.7061 | fpr=0.0156 | 3928.9 samples/s | 15.3 steps/s
Avg test loss: 0.48278, Avg test acc: 0.79269, Avg tpr: 0.70653, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=0.43497 | acc=0.8776 | tpr=0.9027 | fpr=0.1229 | 3874.8 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.44089 | acc=0.8792 | tpr=0.9190 | fpr=0.1215 | 7575.7 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.44525 | acc=0.8801 | tpr=0.9323 | fpr=0.1209 | 7522.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.45022 | acc=0.8799 | tpr=0.9355 | fpr=0.1211 | 7756.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.44924 | acc=0.8798 | tpr=0.9345 | fpr=0.1212 | 7785.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.44941 | acc=0.8801 | tpr=0.9382 | fpr=0.1210 | 7540.2 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.45267 | acc=0.8797 | tpr=0.9411 | fpr=0.1214 | 7700.1 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.45421 | acc=0.8794 | tpr=0.9387 | fpr=0.1216 | 7522.1 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.45770 | acc=0.8793 | tpr=0.9382 | fpr=0.1218 | 7223.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.45695 | acc=0.8792 | tpr=0.9401 | fpr=0.1219 | 7626.7 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.45427 | acc=0.8796 | tpr=0.9407 | fpr=0.1215 | 13646.3 samples/s | 53.3 steps/s
Avg test loss: 0.45368, Avg test acc: 0.87965, Avg tpr: 0.94097, Avg fpr: 0.12146, total FA: 16865

server round 43/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=101.4] | Loss=0.19987 | Reg=0.00167 | acc=0.7812 | L2-Norm=12.906 | L2-Norm(final)=3.206 | 3849.6 samples/s | 60.1 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02717 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.207 | 4362.7 samples/s | 68.2 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01573 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.208 | 4602.0 samples/s | 71.9 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01200 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.926 | L2-Norm(final)=3.209 | 4606.6 samples/s | 72.0 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01009 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.211 | 6092.1 samples/s | 95.2 steps/s
[Step=21050 Epoch=102.6] | Loss=0.00866 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.212 | 1796.3 samples/s | 28.1 steps/s
[Step=21100 Epoch=102.9] | Loss=0.00773 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.214 | 4604.3 samples/s | 71.9 steps/s
[Step=21150 Epoch=103.1] | Loss=0.00702 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.933 | L2-Norm(final)=3.215 | 4642.1 samples/s | 72.5 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00658 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.217 | 5571.9 samples/s | 87.1 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00614 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.218 | 1836.7 samples/s | 28.7 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00581 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=3.220 | 4535.7 samples/s | 70.9 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00552 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.221 | 4559.5 samples/s | 71.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00526 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.222 | 5345.9 samples/s | 83.5 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00505 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.223 | 1864.5 samples/s | 29.1 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00485 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.225 | 4589.4 samples/s | 71.7 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00468 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.226 | 4620.5 samples/s | 72.2 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00457 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.227 | 4957.7 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=190.3] | Loss=0.02310 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.906 | L2-Norm(final)=3.206 | 3737.7 samples/s | 58.4 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00368 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.207 | 4227.7 samples/s | 66.1 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00186 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.208 | 5828.6 samples/s | 91.1 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00125 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.208 | 1716.6 samples/s | 26.8 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00094 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.208 | 5530.1 samples/s | 86.4 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00076 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.208 | 1779.3 samples/s | 27.8 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00064 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.209 | 5040.0 samples/s | 78.8 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00055 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.209 | 1817.9 samples/s | 28.4 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.209 | 4675.2 samples/s | 73.0 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00043 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.209 | 1863.3 samples/s | 29.1 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00039 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.209 | 4367.7 samples/s | 68.2 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00035 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=3.210 | 1894.4 samples/s | 29.6 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00032 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.210 | 4376.8 samples/s | 68.4 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00030 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.210 | 1934.7 samples/s | 30.2 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00028 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=3.210 | 4402.0 samples/s | 68.8 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00026 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.210 | 1946.2 samples/s | 30.4 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00025 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.210 | 4277.1 samples/s | 66.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45229 | acc=0.8044 | tpr=0.7215 | fpr=0.0156 | 3868.7 samples/s | 15.1 steps/s
Avg test loss: 0.46297, Avg test acc: 0.80299, Avg tpr: 0.72157, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.44482 | acc=0.8760 | tpr=0.8938 | fpr=0.1243 | 3936.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.45161 | acc=0.8773 | tpr=0.9126 | fpr=0.1234 | 7685.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.45589 | acc=0.8783 | tpr=0.9280 | fpr=0.1226 | 7590.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.46085 | acc=0.8782 | tpr=0.9311 | fpr=0.1227 | 7672.5 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.46001 | acc=0.8782 | tpr=0.9319 | fpr=0.1228 | 7635.6 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.46027 | acc=0.8784 | tpr=0.9360 | fpr=0.1227 | 7778.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.46366 | acc=0.8781 | tpr=0.9393 | fpr=0.1230 | 7636.1 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.46527 | acc=0.8780 | tpr=0.9371 | fpr=0.1231 | 7718.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.46884 | acc=0.8779 | tpr=0.9367 | fpr=0.1231 | 7503.9 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.46813 | acc=0.8777 | tpr=0.9388 | fpr=0.1234 | 7386.6 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.46538 | acc=0.8782 | tpr=0.9391 | fpr=0.1229 | 13910.1 samples/s | 54.3 steps/s
Avg test loss: 0.46480, Avg test acc: 0.87821, Avg tpr: 0.93938, Avg fpr: 0.12290, total FA: 17064

server round 44/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=105.3] | Loss=0.21757 | Reg=0.00166 | acc=0.8594 | L2-Norm=12.901 | L2-Norm(final)=3.217 | 3579.0 samples/s | 55.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02437 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.218 | 4399.6 samples/s | 68.7 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01474 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.219 | 4629.1 samples/s | 72.3 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01167 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.221 | 4566.4 samples/s | 71.3 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00969 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=3.222 | 6075.9 samples/s | 94.9 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00817 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=3.223 | 1750.4 samples/s | 27.3 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00734 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.225 | 4624.5 samples/s | 72.3 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00675 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.226 | 4508.6 samples/s | 70.4 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00630 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.227 | 5710.1 samples/s | 89.2 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00590 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.229 | 1769.8 samples/s | 27.7 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00560 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=3.230 | 4564.3 samples/s | 71.3 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00529 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=3.231 | 4586.2 samples/s | 71.7 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00506 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.232 | 5347.7 samples/s | 83.6 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00482 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.234 | 1862.3 samples/s | 29.1 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00459 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=3.235 | 4582.5 samples/s | 71.6 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00449 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.236 | 4610.2 samples/s | 72.0 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00433 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.237 | 5006.3 samples/s | 78.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_0/client_state-step22400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=151.6] | Loss=0.02013 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.901 | L2-Norm(final)=3.217 | 3709.7 samples/s | 58.0 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00265 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.218 | 3766.1 samples/s | 58.8 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00136 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.219 | 5926.8 samples/s | 92.6 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00091 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.219 | 1723.4 samples/s | 26.9 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00069 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=3.220 | 5311.9 samples/s | 83.0 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00055 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.220 | 1749.3 samples/s | 27.3 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00046 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.220 | 4878.8 samples/s | 76.2 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00040 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.220 | 1790.7 samples/s | 28.0 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00035 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.220 | 4674.6 samples/s | 73.0 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00031 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.221 | 1821.9 samples/s | 28.5 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00028 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=3.221 | 4429.1 samples/s | 69.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.221 | 1903.5 samples/s | 29.7 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=3.221 | 4315.3 samples/s | 67.4 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00022 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=3.221 | 1913.5 samples/s | 29.9 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00020 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.221 | 4273.3 samples/s | 66.8 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.222 | 1918.5 samples/s | 30.0 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.222 | 4312.2 samples/s | 67.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45161 | acc=0.8080 | tpr=0.7273 | fpr=0.0166 | 4062.5 samples/s | 15.9 steps/s
Avg test loss: 0.46298, Avg test acc: 0.80764, Avg tpr: 0.72839, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.46058 | acc=0.8745 | tpr=0.8982 | fpr=0.1260 | 3979.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.46777 | acc=0.8749 | tpr=0.9147 | fpr=0.1259 | 7416.6 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.47162 | acc=0.8759 | tpr=0.9294 | fpr=0.1251 | 7809.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.47675 | acc=0.8761 | tpr=0.9322 | fpr=0.1249 | 8098.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.47613 | acc=0.8756 | tpr=0.9319 | fpr=0.1254 | 7379.2 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.47618 | acc=0.8759 | tpr=0.9360 | fpr=0.1252 | 7847.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.47968 | acc=0.8758 | tpr=0.9380 | fpr=0.1253 | 7889.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.48116 | acc=0.8757 | tpr=0.9349 | fpr=0.1254 | 7789.3 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.48475 | acc=0.8757 | tpr=0.9343 | fpr=0.1253 | 7661.9 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.48407 | acc=0.8756 | tpr=0.9366 | fpr=0.1255 | 7363.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.48130 | acc=0.8761 | tpr=0.9371 | fpr=0.1250 | 14140.5 samples/s | 55.2 steps/s
Avg test loss: 0.48072, Avg test acc: 0.87613, Avg tpr: 0.93740, Avg fpr: 0.12499, total FA: 17354

server round 45/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12001 Epoch=58.6] | Loss=0.32860 | Reg=0.00166 | acc=0.8594 | L2-Norm=12.896 | L2-Norm(final)=3.230 | 3621.6 samples/s | 56.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03081 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.230 | 4421.7 samples/s | 69.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.01732 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.230 | 4602.2 samples/s | 71.9 steps/s
[Step=12150 Epoch=59.3] | Loss=0.01319 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.918 | L2-Norm(final)=3.230 | 4608.6 samples/s | 72.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01060 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.232 | 6074.5 samples/s | 94.9 steps/s
[Step=12250 Epoch=59.8] | Loss=0.00898 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.233 | 1745.6 samples/s | 27.3 steps/s
[Step=12300 Epoch=60.0] | Loss=0.00805 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.234 | 4612.1 samples/s | 72.1 steps/s
[Step=12350 Epoch=60.3] | Loss=0.00725 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=3.235 | 4540.2 samples/s | 70.9 steps/s
[Step=12400 Epoch=60.5] | Loss=0.00661 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=3.236 | 5668.0 samples/s | 88.6 steps/s
[Step=12450 Epoch=60.8] | Loss=0.00607 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=3.237 | 1804.6 samples/s | 28.2 steps/s
[Step=12500 Epoch=61.0] | Loss=0.00563 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.238 | 4578.1 samples/s | 71.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00542 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.239 | 4611.3 samples/s | 72.1 steps/s
[Step=12600 Epoch=61.5] | Loss=0.00524 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.240 | 5418.5 samples/s | 84.7 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00497 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=3.241 | 1808.4 samples/s | 28.3 steps/s
[Step=12700 Epoch=62.0] | Loss=0.00479 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.242 | 4541.4 samples/s | 71.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00463 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.243 | 4495.3 samples/s | 70.2 steps/s
[Step=12800 Epoch=62.5] | Loss=0.00451 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=3.244 | 5146.0 samples/s | 80.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=159.2] | Loss=0.01226 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.896 | L2-Norm(final)=3.231 | 3670.3 samples/s | 57.3 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00269 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.231 | 4194.2 samples/s | 65.5 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00137 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.232 | 5699.1 samples/s | 89.0 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00092 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.232 | 1704.8 samples/s | 26.6 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00069 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.232 | 5295.7 samples/s | 82.7 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00056 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.232 | 1760.2 samples/s | 27.5 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00047 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.233 | 5036.9 samples/s | 78.7 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00040 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.233 | 1796.0 samples/s | 28.1 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00036 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.233 | 4773.9 samples/s | 74.6 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00032 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.233 | 1829.6 samples/s | 28.6 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00029 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.234 | 4398.0 samples/s | 68.7 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.234 | 1910.5 samples/s | 29.9 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.234 | 4297.3 samples/s | 67.1 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00022 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.234 | 1916.2 samples/s | 29.9 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=3.234 | 4357.9 samples/s | 68.1 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=3.235 | 1899.7 samples/s | 29.7 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=3.235 | 4305.1 samples/s | 67.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41480 | acc=0.8208 | tpr=0.7474 | fpr=0.0198 | 3877.9 samples/s | 15.1 steps/s
Avg test loss: 0.42578, Avg test acc: 0.82038, Avg tpr: 0.74821, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.48838 | acc=0.8665 | tpr=0.9027 | fpr=0.1342 | 3927.5 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.49683 | acc=0.8675 | tpr=0.9190 | fpr=0.1335 | 7857.0 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.50083 | acc=0.8683 | tpr=0.9337 | fpr=0.1329 | 7534.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.50591 | acc=0.8684 | tpr=0.9366 | fpr=0.1329 | 7486.9 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.50535 | acc=0.8680 | tpr=0.9362 | fpr=0.1333 | 7817.2 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.50533 | acc=0.8682 | tpr=0.9396 | fpr=0.1331 | 7028.9 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.50893 | acc=0.8683 | tpr=0.9430 | fpr=0.1330 | 7627.9 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.51050 | acc=0.8681 | tpr=0.9398 | fpr=0.1332 | 7561.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.51424 | acc=0.8681 | tpr=0.9391 | fpr=0.1332 | 7691.3 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.51360 | acc=0.8680 | tpr=0.9414 | fpr=0.1333 | 7601.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.51083 | acc=0.8683 | tpr=0.9415 | fpr=0.1330 | 13900.6 samples/s | 54.3 steps/s
Avg test loss: 0.51026, Avg test acc: 0.86838, Avg tpr: 0.94176, Avg fpr: 0.13296, total FA: 18461

server round 46/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12801 Epoch=62.5] | Loss=0.20531 | Reg=0.00166 | acc=0.8750 | L2-Norm=12.890 | L2-Norm(final)=3.241 | 3896.1 samples/s | 60.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03140 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.239 | 4283.9 samples/s | 66.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.01748 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.239 | 4522.3 samples/s | 70.7 steps/s
[Step=12950 Epoch=63.2] | Loss=0.01315 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.911 | L2-Norm(final)=3.240 | 4637.5 samples/s | 72.5 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01066 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.241 | 6136.9 samples/s | 95.9 steps/s
[Step=13050 Epoch=63.7] | Loss=0.00891 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.242 | 1778.2 samples/s | 27.8 steps/s
[Step=13100 Epoch=63.9] | Loss=0.00791 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.243 | 4577.2 samples/s | 71.5 steps/s
[Step=13150 Epoch=64.2] | Loss=0.00711 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.244 | 4687.8 samples/s | 73.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.00648 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.245 | 5723.3 samples/s | 89.4 steps/s
[Step=13250 Epoch=64.7] | Loss=0.00613 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.246 | 1815.2 samples/s | 28.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00573 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.247 | 4519.0 samples/s | 70.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00545 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.920 | L2-Norm(final)=3.248 | 4599.0 samples/s | 71.9 steps/s
[Step=13400 Epoch=65.4] | Loss=0.00516 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.249 | 5438.8 samples/s | 85.0 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00489 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=3.250 | 1836.2 samples/s | 28.7 steps/s
[Step=13500 Epoch=65.9] | Loss=0.00470 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.251 | 4538.1 samples/s | 70.9 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00446 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.252 | 4610.4 samples/s | 72.0 steps/s
[Step=13600 Epoch=66.4] | Loss=0.00439 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.253 | 5180.0 samples/s | 80.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=166.8] | Loss=0.04067 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.890 | L2-Norm(final)=3.241 | 3900.1 samples/s | 60.9 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00219 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.241 | 3999.0 samples/s | 62.5 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00111 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.242 | 5866.2 samples/s | 91.7 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00075 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.242 | 1728.4 samples/s | 27.0 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00056 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.242 | 5432.7 samples/s | 84.9 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00045 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.243 | 1756.9 samples/s | 27.5 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00038 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.243 | 5080.7 samples/s | 79.4 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00033 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=3.243 | 1810.0 samples/s | 28.3 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00029 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.243 | 4725.9 samples/s | 73.8 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.243 | 1846.0 samples/s | 28.8 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.243 | 4426.6 samples/s | 69.2 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=3.244 | 1889.3 samples/s | 29.5 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=3.244 | 4390.8 samples/s | 68.6 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=3.244 | 1860.1 samples/s | 29.1 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=3.244 | 4457.5 samples/s | 69.6 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=3.244 | 1917.9 samples/s | 30.0 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00015 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=3.244 | 4339.8 samples/s | 67.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44687 | acc=0.8091 | tpr=0.7295 | fpr=0.0181 | 3972.6 samples/s | 15.5 steps/s
Avg test loss: 0.45883, Avg test acc: 0.80828, Avg tpr: 0.72985, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.44858 | acc=0.8778 | tpr=0.8894 | fpr=0.1224 | 4038.6 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.45669 | acc=0.8788 | tpr=0.9104 | fpr=0.1218 | 7735.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.46080 | acc=0.8794 | tpr=0.9251 | fpr=0.1214 | 7818.7 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.46587 | acc=0.8800 | tpr=0.9290 | fpr=0.1209 | 7765.6 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.46493 | acc=0.8798 | tpr=0.9284 | fpr=0.1211 | 7713.7 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.46480 | acc=0.8801 | tpr=0.9324 | fpr=0.1208 | 7587.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.46838 | acc=0.8800 | tpr=0.9361 | fpr=0.1211 | 7949.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.46982 | acc=0.8799 | tpr=0.9338 | fpr=0.1211 | 7976.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.47330 | acc=0.8798 | tpr=0.9328 | fpr=0.1212 | 7394.2 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.47255 | acc=0.8797 | tpr=0.9357 | fpr=0.1214 | 7551.7 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.46991 | acc=0.8800 | tpr=0.9363 | fpr=0.1210 | 14112.5 samples/s | 55.1 steps/s
Avg test loss: 0.46933, Avg test acc: 0.88008, Avg tpr: 0.93661, Avg fpr: 0.12095, total FA: 16793

server round 47/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.4] | Loss=0.31682 | Reg=0.00166 | acc=0.8281 | L2-Norm=12.887 | L2-Norm(final)=3.245 | 3560.0 samples/s | 55.6 steps/s
[Step=13650 Epoch=66.6] | Loss=0.02719 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.245 | 4721.3 samples/s | 73.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01620 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.904 | L2-Norm(final)=3.245 | 4577.1 samples/s | 71.5 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01196 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.246 | 4589.7 samples/s | 71.7 steps/s
[Step=13800 Epoch=67.3] | Loss=0.00994 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=3.247 | 6175.9 samples/s | 96.5 steps/s
[Step=13850 Epoch=67.6] | Loss=0.00854 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.248 | 1786.8 samples/s | 27.9 steps/s
[Step=13900 Epoch=67.8] | Loss=0.00763 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.249 | 4651.4 samples/s | 72.7 steps/s
[Step=13950 Epoch=68.1] | Loss=0.00689 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.250 | 4558.0 samples/s | 71.2 steps/s
[Step=14000 Epoch=68.3] | Loss=0.00635 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=3.251 | 5880.3 samples/s | 91.9 steps/s
[Step=14050 Epoch=68.6] | Loss=0.00581 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.252 | 1819.4 samples/s | 28.4 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00564 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.253 | 4636.8 samples/s | 72.5 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00529 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.254 | 4602.3 samples/s | 71.9 steps/s
[Step=14200 Epoch=69.3] | Loss=0.00503 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.255 | 5298.8 samples/s | 82.8 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00479 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.256 | 1829.0 samples/s | 28.6 steps/s
[Step=14300 Epoch=69.8] | Loss=0.00465 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.257 | 4645.8 samples/s | 72.6 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00444 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.258 | 4501.4 samples/s | 70.3 steps/s
[Step=14400 Epoch=70.3] | Loss=0.00432 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.919 | L2-Norm(final)=3.259 | 5129.4 samples/s | 80.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=174.4] | Loss=0.05052 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.887 | L2-Norm(final)=3.245 | 3346.5 samples/s | 52.3 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00228 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.245 | 4498.6 samples/s | 70.3 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00117 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=3.246 | 5839.0 samples/s | 91.2 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00079 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=3.246 | 1722.7 samples/s | 26.9 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00060 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.246 | 5361.1 samples/s | 83.8 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00048 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.247 | 1763.3 samples/s | 27.6 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00041 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.247 | 5035.5 samples/s | 78.7 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00035 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.247 | 1812.9 samples/s | 28.3 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00031 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=3.247 | 4720.6 samples/s | 73.8 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00028 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=3.248 | 1855.9 samples/s | 29.0 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00025 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=3.248 | 4466.8 samples/s | 69.8 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=3.248 | 1910.7 samples/s | 29.9 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.248 | 4331.9 samples/s | 67.7 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=3.249 | 1923.6 samples/s | 30.1 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=3.249 | 4374.0 samples/s | 68.3 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=3.249 | 1960.2 samples/s | 30.6 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=3.249 | 4307.1 samples/s | 67.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_2/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42621 | acc=0.8178 | tpr=0.7424 | fpr=0.0183 | 3941.3 samples/s | 15.4 steps/s
Avg test loss: 0.43734, Avg test acc: 0.81753, Avg tpr: 0.74343, Avg fpr: 0.01948, total FA: 152

Testing server on iccad2012
[Step=  50] | Loss=0.47868 | acc=0.8712 | tpr=0.8938 | fpr=0.1292 | 3963.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.48591 | acc=0.8715 | tpr=0.9126 | fpr=0.1292 | 7736.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.48991 | acc=0.8718 | tpr=0.9265 | fpr=0.1292 | 7465.7 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.49496 | acc=0.8722 | tpr=0.9301 | fpr=0.1288 | 7448.1 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.49412 | acc=0.8720 | tpr=0.9310 | fpr=0.1290 | 8034.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.49403 | acc=0.8722 | tpr=0.9353 | fpr=0.1289 | 7879.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.49769 | acc=0.8721 | tpr=0.9393 | fpr=0.1291 | 7632.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.49926 | acc=0.8720 | tpr=0.9360 | fpr=0.1292 | 7652.4 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.50289 | acc=0.8719 | tpr=0.9352 | fpr=0.1292 | 7780.4 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.50217 | acc=0.8719 | tpr=0.9379 | fpr=0.1293 | 7555.1 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.49940 | acc=0.8723 | tpr=0.9383 | fpr=0.1289 | 13092.9 samples/s | 51.1 steps/s
Avg test loss: 0.49879, Avg test acc: 0.87237, Avg tpr: 0.93859, Avg fpr: 0.12884, total FA: 17889

server round 48/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.3] | Loss=0.12366 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.886 | L2-Norm(final)=3.248 | 3845.0 samples/s | 60.1 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02687 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.897 | L2-Norm(final)=3.249 | 4271.7 samples/s | 66.7 steps/s
[Step=14500 Epoch=70.8] | Loss=0.01562 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.249 | 4590.0 samples/s | 71.7 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01161 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.902 | L2-Norm(final)=3.250 | 4619.9 samples/s | 72.2 steps/s
[Step=14600 Epoch=71.2] | Loss=0.00974 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.251 | 6078.7 samples/s | 95.0 steps/s
[Step=14650 Epoch=71.5] | Loss=0.00816 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.253 | 1776.7 samples/s | 27.8 steps/s
[Step=14700 Epoch=71.7] | Loss=0.00715 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.254 | 4544.2 samples/s | 71.0 steps/s
[Step=14750 Epoch=72.0] | Loss=0.00658 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.255 | 4586.4 samples/s | 71.7 steps/s
[Step=14800 Epoch=72.2] | Loss=0.00611 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=3.256 | 5807.2 samples/s | 90.7 steps/s
[Step=14850 Epoch=72.5] | Loss=0.00564 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.257 | 1833.1 samples/s | 28.6 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00538 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.258 | 4589.3 samples/s | 71.7 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00505 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.259 | 4588.6 samples/s | 71.7 steps/s
[Step=15000 Epoch=73.2] | Loss=0.00483 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=3.260 | 5466.0 samples/s | 85.4 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00462 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=3.261 | 1812.9 samples/s | 28.3 steps/s
[Step=15100 Epoch=73.7] | Loss=0.00444 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.913 | L2-Norm(final)=3.262 | 4523.3 samples/s | 70.7 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00433 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.263 | 4584.0 samples/s | 71.6 steps/s
[Step=15200 Epoch=74.2] | Loss=0.00420 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.264 | 5132.0 samples/s | 80.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=197.9] | Loss=0.02550 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.886 | L2-Norm(final)=3.248 | 3894.3 samples/s | 60.8 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00247 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.250 | 4118.5 samples/s | 64.4 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00125 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.251 | 5965.0 samples/s | 93.2 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00084 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.251 | 1720.2 samples/s | 26.9 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00064 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.252 | 5514.7 samples/s | 86.2 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00051 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=3.252 | 1773.7 samples/s | 27.7 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00043 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.252 | 5092.7 samples/s | 79.6 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00037 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=3.252 | 1829.8 samples/s | 28.6 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00032 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.252 | 4667.3 samples/s | 72.9 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00029 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.253 | 1844.8 samples/s | 28.8 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=3.253 | 4487.3 samples/s | 70.1 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=3.253 | 1912.0 samples/s | 29.9 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00022 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=3.253 | 4329.0 samples/s | 67.6 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00020 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=3.253 | 1900.9 samples/s | 29.7 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=3.253 | 4323.0 samples/s | 67.5 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.253 | 1911.2 samples/s | 29.9 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=3.253 | 4400.0 samples/s | 68.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39915 | acc=0.8295 | tpr=0.7607 | fpr=0.0211 | 3972.2 samples/s | 15.5 steps/s
Avg test loss: 0.41032, Avg test acc: 0.82951, Avg tpr: 0.76190, Avg fpr: 0.02179, total FA: 170

Testing server on iccad2012
[Step=  50] | Loss=0.51636 | acc=0.8616 | tpr=0.8938 | fpr=0.1390 | 3971.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.52274 | acc=0.8616 | tpr=0.9126 | fpr=0.1394 | 7750.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.52661 | acc=0.8623 | tpr=0.9294 | fpr=0.1389 | 7864.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.53142 | acc=0.8625 | tpr=0.9333 | fpr=0.1388 | 7716.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.53068 | acc=0.8619 | tpr=0.9336 | fpr=0.1394 | 7687.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.53058 | acc=0.8622 | tpr=0.9375 | fpr=0.1392 | 7949.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.53419 | acc=0.8622 | tpr=0.9418 | fpr=0.1392 | 7764.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.53598 | acc=0.8621 | tpr=0.9387 | fpr=0.1393 | 7739.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.53946 | acc=0.8621 | tpr=0.9387 | fpr=0.1393 | 7745.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.53865 | acc=0.8622 | tpr=0.9410 | fpr=0.1392 | 7446.9 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.53574 | acc=0.8625 | tpr=0.9415 | fpr=0.1390 | 14320.7 samples/s | 55.9 steps/s
Avg test loss: 0.53510, Avg test acc: 0.86253, Avg tpr: 0.94176, Avg fpr: 0.13891, total FA: 19287

server round 49/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.2] | Loss=0.14038 | Reg=0.00166 | acc=0.9062 | L2-Norm=12.879 | L2-Norm(final)=3.260 | 3818.2 samples/s | 59.7 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02068 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.262 | 4410.4 samples/s | 68.9 steps/s
[Step=15300 Epoch=74.7] | Loss=0.01256 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.262 | 4592.5 samples/s | 71.8 steps/s
[Step=15350 Epoch=74.9] | Loss=0.00973 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.263 | 4594.5 samples/s | 71.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.00806 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.264 | 6184.0 samples/s | 96.6 steps/s
[Step=15450 Epoch=75.4] | Loss=0.00691 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.265 | 1783.1 samples/s | 27.9 steps/s
[Step=15500 Epoch=75.6] | Loss=0.00607 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=3.266 | 4607.2 samples/s | 72.0 steps/s
[Step=15550 Epoch=75.9] | Loss=0.00556 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.267 | 4622.8 samples/s | 72.2 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00521 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=3.269 | 5818.1 samples/s | 90.9 steps/s
[Step=15650 Epoch=76.4] | Loss=0.00487 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.270 | 1822.8 samples/s | 28.5 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00464 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.271 | 4589.7 samples/s | 71.7 steps/s
[Step=15750 Epoch=76.9] | Loss=0.00447 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.272 | 4615.9 samples/s | 72.1 steps/s
[Step=15800 Epoch=77.1] | Loss=0.00425 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.907 | L2-Norm(final)=3.273 | 5395.4 samples/s | 84.3 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00403 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=3.274 | 1834.6 samples/s | 28.7 steps/s
[Step=15900 Epoch=77.6] | Loss=0.00386 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.275 | 4583.1 samples/s | 71.6 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00377 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.910 | L2-Norm(final)=3.276 | 4604.3 samples/s | 71.9 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00375 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=3.277 | 5028.4 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_1/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=205.5] | Loss=0.13503 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.879 | L2-Norm(final)=3.260 | 3881.3 samples/s | 60.6 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00433 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.262 | 3884.3 samples/s | 60.7 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00218 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.262 | 5907.9 samples/s | 92.3 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00146 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.263 | 1721.2 samples/s | 26.9 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00110 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.263 | 5501.0 samples/s | 86.0 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00089 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.263 | 1785.1 samples/s | 27.9 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00074 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=3.263 | 5058.7 samples/s | 79.0 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00064 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.263 | 1796.8 samples/s | 28.1 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00056 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=3.263 | 4779.0 samples/s | 74.7 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00050 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=3.264 | 1849.1 samples/s | 28.9 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00045 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=3.264 | 4491.7 samples/s | 70.2 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00041 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=3.264 | 1899.6 samples/s | 29.7 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00038 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.264 | 4363.1 samples/s | 68.2 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00035 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=3.264 | 1935.8 samples/s | 30.2 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00032 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=3.264 | 4398.9 samples/s | 68.7 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00030 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=3.264 | 1928.8 samples/s | 30.1 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00028 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=3.264 | 4372.4 samples/s | 68.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr0.5/client_asml1_3/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41375 | acc=0.8256 | tpr=0.7543 | fpr=0.0196 | 4070.6 samples/s | 15.9 steps/s
Avg test loss: 0.42563, Avg test acc: 0.82503, Avg tpr: 0.75474, Avg fpr: 0.02038, total FA: 159

Testing server on iccad2012
[Step=  50] | Loss=0.50863 | acc=0.8644 | tpr=0.8938 | fpr=0.1362 | 4035.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.51510 | acc=0.8648 | tpr=0.9126 | fpr=0.1361 | 7562.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.51895 | acc=0.8652 | tpr=0.9294 | fpr=0.1359 | 7717.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.52391 | acc=0.8651 | tpr=0.9333 | fpr=0.1361 | 7483.2 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.52317 | acc=0.8647 | tpr=0.9336 | fpr=0.1365 | 7801.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.52312 | acc=0.8651 | tpr=0.9375 | fpr=0.1362 | 7712.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.52686 | acc=0.8650 | tpr=0.9411 | fpr=0.1364 | 7758.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.52851 | acc=0.8648 | tpr=0.9376 | fpr=0.1365 | 7400.0 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.53213 | acc=0.8646 | tpr=0.9367 | fpr=0.1367 | 7599.2 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.53146 | acc=0.8647 | tpr=0.9388 | fpr=0.1366 | 8172.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.52857 | acc=0.8652 | tpr=0.9391 | fpr=0.1362 | 12755.2 samples/s | 49.8 steps/s
Avg test loss: 0.52796, Avg test acc: 0.86519, Avg tpr: 0.93938, Avg fpr: 0.13616, total FA: 18905
