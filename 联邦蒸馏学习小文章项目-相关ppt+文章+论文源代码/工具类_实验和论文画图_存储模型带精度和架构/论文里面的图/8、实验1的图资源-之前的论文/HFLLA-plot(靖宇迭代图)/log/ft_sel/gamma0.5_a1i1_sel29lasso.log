Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 29)
Resampled dataset to size (65551, 144, 29)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 29)
Resampled dataset to size (33952, 144, 29)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 29)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 29)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34634 | Reg=0.00359 | L2-Norm=18.943 | L2-Norm(final)=1.926 | acc=0.5625 | 1688.9 samples/s | 26.4 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.27434 | Reg=0.00347 | L2-Norm=18.620 | L2-Norm(final)=1.929 | acc=0.7812 | 4651.3 samples/s | 72.7 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.24043 | Reg=0.00342 | L2-Norm=18.495 | L2-Norm(final)=1.937 | acc=0.8594 | 4683.9 samples/s | 73.2 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.21718 | Reg=0.00339 | L2-Norm=18.425 | L2-Norm(final)=1.944 | acc=0.8281 | 4901.6 samples/s | 76.6 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.19971 | Reg=0.00338 | L2-Norm=18.376 | L2-Norm(final)=1.949 | acc=0.8750 | 4888.6 samples/s | 76.4 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.18695 | Reg=0.00336 | L2-Norm=18.341 | L2-Norm(final)=1.954 | acc=0.9062 | 4852.6 samples/s | 75.8 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.17725 | Reg=0.00335 | L2-Norm=18.314 | L2-Norm(final)=1.958 | acc=0.8594 | 4844.8 samples/s | 75.7 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.16897 | Reg=0.00335 | L2-Norm=18.295 | L2-Norm(final)=1.961 | acc=0.9375 | 4574.1 samples/s | 71.5 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16240 | Reg=0.00334 | L2-Norm=18.278 | L2-Norm(final)=1.964 | acc=0.8906 | 4913.3 samples/s | 76.8 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.15566 | Reg=0.00334 | L2-Norm=18.265 | L2-Norm(final)=1.967 | acc=0.8125 | 4878.8 samples/s | 76.2 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.14990 | Reg=0.00333 | L2-Norm=18.252 | L2-Norm(final)=1.970 | acc=0.9688 | 5020.0 samples/s | 78.4 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14464 | Reg=0.00333 | L2-Norm=18.242 | L2-Norm(final)=1.973 | acc=0.9219 | 4735.6 samples/s | 74.0 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14037 | Reg=0.00332 | L2-Norm=18.234 | L2-Norm(final)=1.976 | acc=0.8750 | 3905.1 samples/s | 61.0 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.13600 | Reg=0.00332 | L2-Norm=18.227 | L2-Norm(final)=1.979 | acc=0.9688 | 3934.7 samples/s | 61.5 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13444 | Reg=0.00332 | L2-Norm=18.220 | L2-Norm(final)=1.981 | acc=0.8906 | 3909.7 samples/s | 61.1 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13193 | Reg=0.00332 | L2-Norm=18.216 | L2-Norm(final)=1.983 | acc=0.8750 | 3897.9 samples/s | 60.9 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12921 | Reg=0.00332 | L2-Norm=18.213 | L2-Norm(final)=1.985 | acc=0.9688 | 3863.2 samples/s | 60.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.29954 | Reg=0.00359 | L2-Norm=18.943 | L2-Norm(final)=1.927 | acc=0.5938 | 3348.4 samples/s | 52.3 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.18969 | Reg=0.00352 | L2-Norm=18.752 | L2-Norm(final)=1.929 | acc=0.9375 | 3956.5 samples/s | 61.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.12398 | Reg=0.00349 | L2-Norm=18.672 | L2-Norm(final)=1.945 | acc=0.9844 | 4738.7 samples/s | 74.0 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.09423 | Reg=0.00346 | L2-Norm=18.599 | L2-Norm(final)=1.953 | acc=1.0000 | 4585.0 samples/s | 71.6 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.07406 | Reg=0.00344 | L2-Norm=18.534 | L2-Norm(final)=1.961 | acc=0.9688 | 4665.8 samples/s | 72.9 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.06267 | Reg=0.00341 | L2-Norm=18.474 | L2-Norm(final)=1.968 | acc=1.0000 | 4673.9 samples/s | 73.0 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05385 | Reg=0.00339 | L2-Norm=18.419 | L2-Norm(final)=1.974 | acc=1.0000 | 4809.2 samples/s | 75.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04797 | Reg=0.00337 | L2-Norm=18.369 | L2-Norm(final)=1.980 | acc=1.0000 | 4534.2 samples/s | 70.8 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04310 | Reg=0.00336 | L2-Norm=18.324 | L2-Norm(final)=1.985 | acc=0.9844 | 4683.5 samples/s | 73.2 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03946 | Reg=0.00334 | L2-Norm=18.279 | L2-Norm(final)=1.989 | acc=1.0000 | 4740.3 samples/s | 74.1 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03579 | Reg=0.00333 | L2-Norm=18.236 | L2-Norm(final)=1.993 | acc=1.0000 | 4621.8 samples/s | 72.2 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03278 | Reg=0.00331 | L2-Norm=18.194 | L2-Norm(final)=1.997 | acc=1.0000 | 1489.6 samples/s | 23.3 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.03069 | Reg=0.00330 | L2-Norm=18.154 | L2-Norm(final)=2.001 | acc=1.0000 | 4791.8 samples/s | 74.9 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02853 | Reg=0.00328 | L2-Norm=18.116 | L2-Norm(final)=2.004 | acc=1.0000 | 4709.3 samples/s | 73.6 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02660 | Reg=0.00327 | L2-Norm=18.078 | L2-Norm(final)=2.008 | acc=1.0000 | 4679.0 samples/s | 73.1 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02509 | Reg=0.00326 | L2-Norm=18.040 | L2-Norm(final)=2.012 | acc=0.9688 | 4721.3 samples/s | 73.8 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02363 | Reg=0.00324 | L2-Norm=18.004 | L2-Norm(final)=2.015 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30041 | acc=0.6648 | tpr=0.6697 | fpr=0.3459 | 4430.8 samples/s | 17.3 steps/s
Avg test loss: 0.30370, Avg test acc: 0.66235, Avg tpr: 0.66795, Avg fpr: 0.34996, total FA: 2730

Testing server on iccad2012
[Step=  50] | Loss=0.32582 | acc=0.7078 | tpr=0.9646 | fpr=0.2968 | 4443.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.32397 | acc=0.7104 | tpr=0.9744 | fpr=0.2946 | 9043.2 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.32532 | acc=0.7079 | tpr=0.9813 | fpr=0.2972 | 8913.6 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.32483 | acc=0.7082 | tpr=0.9836 | fpr=0.2968 | 8712.3 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.32473 | acc=0.7078 | tpr=0.9860 | fpr=0.2972 | 8883.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.32486 | acc=0.7081 | tpr=0.9847 | fpr=0.2970 | 9375.9 samples/s | 36.6 steps/s
[Step= 350] | Loss=0.32493 | acc=0.7075 | tpr=0.9837 | fpr=0.2975 | 8413.8 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.32557 | acc=0.7072 | tpr=0.9836 | fpr=0.2978 | 8920.8 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.32609 | acc=0.7069 | tpr=0.9834 | fpr=0.2981 | 8688.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.32653 | acc=0.7061 | tpr=0.9828 | fpr=0.2989 | 8531.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.32642 | acc=0.7061 | tpr=0.9821 | fpr=0.2989 | 16717.2 samples/s | 65.3 steps/s
Avg test loss: 0.32636, Avg test acc: 0.70613, Avg tpr: 0.98217, Avg fpr: 0.29889, total FA: 41500

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.24026 | Reg=0.00293 | L2-Norm=17.110 | L2-Norm(final)=2.025 | acc=0.7031 | 3746.0 samples/s | 58.5 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.16234 | Reg=0.00298 | L2-Norm=17.248 | L2-Norm(final)=2.021 | acc=0.9375 | 4614.0 samples/s | 72.1 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.14007 | Reg=0.00300 | L2-Norm=17.308 | L2-Norm(final)=2.029 | acc=0.9688 | 4966.4 samples/s | 77.6 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12868 | Reg=0.00301 | L2-Norm=17.342 | L2-Norm(final)=2.036 | acc=0.9219 | 4728.7 samples/s | 73.9 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.12056 | Reg=0.00302 | L2-Norm=17.366 | L2-Norm(final)=2.042 | acc=0.9375 | 4800.4 samples/s | 75.0 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11490 | Reg=0.00302 | L2-Norm=17.384 | L2-Norm(final)=2.046 | acc=0.9219 | 4162.6 samples/s | 65.0 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.11064 | Reg=0.00303 | L2-Norm=17.397 | L2-Norm(final)=2.050 | acc=0.9375 | 3872.3 samples/s | 60.5 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10598 | Reg=0.00303 | L2-Norm=17.405 | L2-Norm(final)=2.052 | acc=0.9375 | 3875.1 samples/s | 60.5 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10293 | Reg=0.00303 | L2-Norm=17.412 | L2-Norm(final)=2.054 | acc=0.9375 | 3849.8 samples/s | 60.2 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.10132 | Reg=0.00303 | L2-Norm=17.420 | L2-Norm(final)=2.056 | acc=0.9531 | 3860.8 samples/s | 60.3 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09936 | Reg=0.00304 | L2-Norm=17.429 | L2-Norm(final)=2.057 | acc=0.9531 | 3882.8 samples/s | 60.7 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09720 | Reg=0.00304 | L2-Norm=17.438 | L2-Norm(final)=2.058 | acc=0.9844 | 3866.2 samples/s | 60.4 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09499 | Reg=0.00304 | L2-Norm=17.448 | L2-Norm(final)=2.060 | acc=0.9219 | 3869.9 samples/s | 60.5 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09293 | Reg=0.00305 | L2-Norm=17.456 | L2-Norm(final)=2.062 | acc=0.8906 | 3892.3 samples/s | 60.8 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09133 | Reg=0.00305 | L2-Norm=17.465 | L2-Norm(final)=2.063 | acc=0.9375 | 3900.6 samples/s | 60.9 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08982 | Reg=0.00305 | L2-Norm=17.472 | L2-Norm(final)=2.065 | acc=0.9219 | 3830.9 samples/s | 59.9 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08790 | Reg=0.00306 | L2-Norm=17.480 | L2-Norm(final)=2.066 | acc=0.9531 | 3899.5 samples/s | 60.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.13457 | Reg=0.00293 | L2-Norm=17.110 | L2-Norm(final)=2.026 | acc=0.9062 | 3610.6 samples/s | 56.4 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.03331 | Reg=0.00298 | L2-Norm=17.249 | L2-Norm(final)=2.033 | acc=1.0000 | 4575.4 samples/s | 71.5 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.02427 | Reg=0.00298 | L2-Norm=17.268 | L2-Norm(final)=2.034 | acc=1.0000 | 4560.2 samples/s | 71.3 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.01949 | Reg=0.00298 | L2-Norm=17.257 | L2-Norm(final)=2.033 | acc=1.0000 | 4742.9 samples/s | 74.1 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01662 | Reg=0.00297 | L2-Norm=17.236 | L2-Norm(final)=2.034 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01472 | Reg=0.00296 | L2-Norm=17.209 | L2-Norm(final)=2.034 | acc=1.0000 | 4669.0 samples/s | 73.0 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01283 | Reg=0.00295 | L2-Norm=17.182 | L2-Norm(final)=2.036 | acc=1.0000 | 4513.5 samples/s | 70.5 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01125 | Reg=0.00294 | L2-Norm=17.152 | L2-Norm(final)=2.038 | acc=1.0000 | 4633.8 samples/s | 72.4 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.00995 | Reg=0.00293 | L2-Norm=17.120 | L2-Norm(final)=2.041 | acc=1.0000 | 4824.2 samples/s | 75.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.00895 | Reg=0.00292 | L2-Norm=17.087 | L2-Norm(final)=2.043 | acc=1.0000 | 4586.3 samples/s | 71.7 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00841 | Reg=0.00291 | L2-Norm=17.054 | L2-Norm(final)=2.046 | acc=0.9844 | 4760.6 samples/s | 74.4 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00805 | Reg=0.00290 | L2-Norm=17.023 | L2-Norm(final)=2.048 | acc=1.0000 | 1481.5 samples/s | 23.1 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00746 | Reg=0.00289 | L2-Norm=16.994 | L2-Norm(final)=2.051 | acc=1.0000 | 4910.0 samples/s | 76.7 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00704 | Reg=0.00288 | L2-Norm=16.963 | L2-Norm(final)=2.053 | acc=1.0000 | 4496.9 samples/s | 70.3 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00671 | Reg=0.00287 | L2-Norm=16.934 | L2-Norm(final)=2.055 | acc=1.0000 | 4340.2 samples/s | 67.8 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00632 | Reg=0.00286 | L2-Norm=16.906 | L2-Norm(final)=2.057 | acc=1.0000 | 4712.8 samples/s | 73.6 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00594 | Reg=0.00285 | L2-Norm=16.878 | L2-Norm(final)=2.060 | acc=1.0000 | 4656.0 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40141 | acc=0.6390 | tpr=0.5096 | fpr=0.0800 | 4531.1 samples/s | 17.7 steps/s
Avg test loss: 0.40688, Avg test acc: 0.63663, Avg tpr: 0.50708, Avg fpr: 0.07845, total FA: 612

Testing server on iccad2012
[Step=  50] | Loss=0.22352 | acc=0.8376 | tpr=0.9292 | fpr=0.1641 | 4512.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.22103 | acc=0.8395 | tpr=0.9446 | fpr=0.1625 | 8463.5 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.22213 | acc=0.8382 | tpr=0.9496 | fpr=0.1638 | 8880.0 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.22147 | acc=0.8391 | tpr=0.9508 | fpr=0.1629 | 8931.3 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.22083 | acc=0.8391 | tpr=0.9546 | fpr=0.1630 | 8876.8 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.22111 | acc=0.8392 | tpr=0.9527 | fpr=0.1629 | 8613.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.22125 | acc=0.8390 | tpr=0.9537 | fpr=0.1630 | 8741.2 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.22202 | acc=0.8386 | tpr=0.9508 | fpr=0.1635 | 8557.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.22341 | acc=0.8375 | tpr=0.9537 | fpr=0.1646 | 8680.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.22396 | acc=0.8372 | tpr=0.9546 | fpr=0.1649 | 9072.7 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.22405 | acc=0.8372 | tpr=0.9534 | fpr=0.1649 | 16206.8 samples/s | 63.3 steps/s
Avg test loss: 0.22396, Avg test acc: 0.83717, Avg tpr: 0.95365, Avg fpr: 0.16494, total FA: 22902

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.29308 | Reg=0.00273 | L2-Norm=16.529 | L2-Norm(final)=2.083 | acc=0.7031 | 3930.4 samples/s | 61.4 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.12464 | Reg=0.00277 | L2-Norm=16.638 | L2-Norm(final)=2.069 | acc=0.9375 | 4548.2 samples/s | 71.1 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10712 | Reg=0.00279 | L2-Norm=16.689 | L2-Norm(final)=2.076 | acc=0.9688 | 4943.9 samples/s | 77.2 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09832 | Reg=0.00280 | L2-Norm=16.722 | L2-Norm(final)=2.080 | acc=0.9219 | 4903.7 samples/s | 76.6 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09460 | Reg=0.00281 | L2-Norm=16.748 | L2-Norm(final)=2.082 | acc=0.9375 | 4890.2 samples/s | 76.4 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.09019 | Reg=0.00281 | L2-Norm=16.771 | L2-Norm(final)=2.085 | acc=0.8906 | 4912.6 samples/s | 76.8 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08562 | Reg=0.00282 | L2-Norm=16.793 | L2-Norm(final)=2.089 | acc=0.9375 | 4872.1 samples/s | 76.1 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08394 | Reg=0.00283 | L2-Norm=16.810 | L2-Norm(final)=2.090 | acc=0.9844 | 4894.2 samples/s | 76.5 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.08124 | Reg=0.00283 | L2-Norm=16.826 | L2-Norm(final)=2.093 | acc=0.9531 | 4900.0 samples/s | 76.6 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07868 | Reg=0.00284 | L2-Norm=16.842 | L2-Norm(final)=2.096 | acc=0.9531 | 4879.3 samples/s | 76.2 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07784 | Reg=0.00284 | L2-Norm=16.855 | L2-Norm(final)=2.097 | acc=0.9688 | 4960.7 samples/s | 77.5 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07671 | Reg=0.00284 | L2-Norm=16.867 | L2-Norm(final)=2.097 | acc=0.9375 | 4826.6 samples/s | 75.4 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07524 | Reg=0.00285 | L2-Norm=16.879 | L2-Norm(final)=2.098 | acc=0.9531 | 4216.1 samples/s | 65.9 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07426 | Reg=0.00285 | L2-Norm=16.891 | L2-Norm(final)=2.100 | acc=0.9062 | 3847.0 samples/s | 60.1 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07329 | Reg=0.00286 | L2-Norm=16.902 | L2-Norm(final)=2.101 | acc=0.9688 | 3894.0 samples/s | 60.8 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07201 | Reg=0.00286 | L2-Norm=16.913 | L2-Norm(final)=2.102 | acc=0.9688 | 3884.6 samples/s | 60.7 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07162 | Reg=0.00286 | L2-Norm=16.924 | L2-Norm(final)=2.103 | acc=0.9531 | 3846.6 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.09026 | Reg=0.00273 | L2-Norm=16.529 | L2-Norm(final)=2.084 | acc=0.9375 | 3094.0 samples/s | 48.3 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.01820 | Reg=0.00276 | L2-Norm=16.604 | L2-Norm(final)=2.082 | acc=1.0000 | 4143.2 samples/s | 64.7 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01142 | Reg=0.00276 | L2-Norm=16.611 | L2-Norm(final)=2.080 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.00982 | Reg=0.00276 | L2-Norm=16.599 | L2-Norm(final)=2.080 | acc=1.0000 | 4771.3 samples/s | 74.6 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.00899 | Reg=0.00275 | L2-Norm=16.584 | L2-Norm(final)=2.080 | acc=1.0000 | 4610.7 samples/s | 72.0 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00848 | Reg=0.00275 | L2-Norm=16.573 | L2-Norm(final)=2.080 | acc=1.0000 | 4674.1 samples/s | 73.0 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00805 | Reg=0.00274 | L2-Norm=16.560 | L2-Norm(final)=2.081 | acc=1.0000 | 4111.5 samples/s | 64.2 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00771 | Reg=0.00274 | L2-Norm=16.544 | L2-Norm(final)=2.080 | acc=1.0000 | 3709.5 samples/s | 58.0 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00741 | Reg=0.00273 | L2-Norm=16.528 | L2-Norm(final)=2.079 | acc=1.0000 | 3668.1 samples/s | 57.3 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00681 | Reg=0.00273 | L2-Norm=16.512 | L2-Norm(final)=2.079 | acc=1.0000 | 3660.5 samples/s | 57.2 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00623 | Reg=0.00272 | L2-Norm=16.493 | L2-Norm(final)=2.080 | acc=1.0000 | 3745.4 samples/s | 58.5 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00571 | Reg=0.00271 | L2-Norm=16.473 | L2-Norm(final)=2.081 | acc=1.0000 | 1515.1 samples/s | 23.7 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00527 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.083 | acc=1.0000 | 4764.1 samples/s | 74.4 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00488 | Reg=0.00270 | L2-Norm=16.425 | L2-Norm(final)=2.085 | acc=1.0000 | 4720.6 samples/s | 73.8 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00454 | Reg=0.00269 | L2-Norm=16.398 | L2-Norm(final)=2.087 | acc=1.0000 | 4785.3 samples/s | 74.8 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00424 | Reg=0.00268 | L2-Norm=16.370 | L2-Norm(final)=2.088 | acc=1.0000 | 4550.2 samples/s | 71.1 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00398 | Reg=0.00267 | L2-Norm=16.341 | L2-Norm(final)=2.090 | acc=1.0000 | 4654.0 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39157 | acc=0.6702 | tpr=0.5565 | fpr=0.0828 | 4344.9 samples/s | 17.0 steps/s
Avg test loss: 0.39841, Avg test acc: 0.66864, Avg tpr: 0.55464, Avg fpr: 0.08063, total FA: 629

Testing server on iccad2012
[Step=  50] | Loss=0.24654 | acc=0.8436 | tpr=0.9646 | fpr=0.1586 | 4426.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.24408 | acc=0.8441 | tpr=0.9723 | fpr=0.1583 | 9211.6 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.24669 | acc=0.8434 | tpr=0.9755 | fpr=0.1590 | 8506.4 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.24543 | acc=0.8446 | tpr=0.9760 | fpr=0.1578 | 8901.5 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.24491 | acc=0.8445 | tpr=0.9755 | fpr=0.1579 | 8853.4 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.24567 | acc=0.8446 | tpr=0.9738 | fpr=0.1577 | 8644.6 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.24589 | acc=0.8440 | tpr=0.9731 | fpr=0.1584 | 9108.0 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.24649 | acc=0.8435 | tpr=0.9732 | fpr=0.1588 | 8496.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.24808 | acc=0.8429 | tpr=0.9732 | fpr=0.1595 | 8664.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.24893 | acc=0.8423 | tpr=0.9736 | fpr=0.1600 | 8958.7 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.24891 | acc=0.8424 | tpr=0.9733 | fpr=0.1599 | 15519.1 samples/s | 60.6 steps/s
Avg test loss: 0.24878, Avg test acc: 0.84247, Avg tpr: 0.97345, Avg fpr: 0.15992, total FA: 22204

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.30141 | Reg=0.00259 | L2-Norm=16.092 | L2-Norm(final)=2.104 | acc=0.7344 | 3606.8 samples/s | 56.4 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.10615 | Reg=0.00262 | L2-Norm=16.181 | L2-Norm(final)=2.092 | acc=0.9375 | 4881.4 samples/s | 76.3 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.08657 | Reg=0.00264 | L2-Norm=16.233 | L2-Norm(final)=2.102 | acc=0.9688 | 4757.3 samples/s | 74.3 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.07798 | Reg=0.00265 | L2-Norm=16.267 | L2-Norm(final)=2.110 | acc=0.9844 | 4991.6 samples/s | 78.0 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07492 | Reg=0.00265 | L2-Norm=16.292 | L2-Norm(final)=2.113 | acc=0.9688 | 5005.5 samples/s | 78.2 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07442 | Reg=0.00266 | L2-Norm=16.313 | L2-Norm(final)=2.112 | acc=0.9531 | 4783.9 samples/s | 74.7 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07272 | Reg=0.00267 | L2-Norm=16.334 | L2-Norm(final)=2.112 | acc=0.9219 | 4880.0 samples/s | 76.2 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06975 | Reg=0.00268 | L2-Norm=16.355 | L2-Norm(final)=2.114 | acc=0.9688 | 5025.9 samples/s | 78.5 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06865 | Reg=0.00268 | L2-Norm=16.374 | L2-Norm(final)=2.116 | acc=0.9531 | 4851.7 samples/s | 75.8 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06697 | Reg=0.00269 | L2-Norm=16.393 | L2-Norm(final)=2.118 | acc=0.9844 | 5065.8 samples/s | 79.2 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06668 | Reg=0.00269 | L2-Norm=16.413 | L2-Norm(final)=2.119 | acc=0.9375 | 4845.9 samples/s | 75.7 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06617 | Reg=0.00270 | L2-Norm=16.432 | L2-Norm(final)=2.120 | acc=1.0000 | 4823.7 samples/s | 75.4 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06614 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.121 | acc=0.9219 | 4835.1 samples/s | 75.5 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06540 | Reg=0.00271 | L2-Norm=16.468 | L2-Norm(final)=2.121 | acc=0.9375 | 4887.5 samples/s | 76.4 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06399 | Reg=0.00272 | L2-Norm=16.484 | L2-Norm(final)=2.122 | acc=0.9688 | 4733.5 samples/s | 74.0 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06308 | Reg=0.00272 | L2-Norm=16.500 | L2-Norm(final)=2.123 | acc=0.9688 | 4536.6 samples/s | 70.9 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06252 | Reg=0.00273 | L2-Norm=16.516 | L2-Norm(final)=2.124 | acc=0.9844 | 3854.4 samples/s | 60.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.07346 | Reg=0.00259 | L2-Norm=16.092 | L2-Norm(final)=2.105 | acc=0.9375 | 3758.3 samples/s | 58.7 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.00930 | Reg=0.00262 | L2-Norm=16.195 | L2-Norm(final)=2.121 | acc=1.0000 | 4343.6 samples/s | 67.9 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.00855 | Reg=0.00263 | L2-Norm=16.221 | L2-Norm(final)=2.126 | acc=0.9688 | 4832.0 samples/s | 75.5 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00765 | Reg=0.00264 | L2-Norm=16.237 | L2-Norm(final)=2.123 | acc=1.0000 | 4766.4 samples/s | 74.5 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00649 | Reg=0.00264 | L2-Norm=16.242 | L2-Norm(final)=2.122 | acc=1.0000 | 4679.5 samples/s | 73.1 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00590 | Reg=0.00264 | L2-Norm=16.241 | L2-Norm(final)=2.122 | acc=1.0000 | 4637.6 samples/s | 72.5 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00615 | Reg=0.00263 | L2-Norm=16.232 | L2-Norm(final)=2.120 | acc=1.0000 | 4664.4 samples/s | 72.9 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00570 | Reg=0.00263 | L2-Norm=16.220 | L2-Norm(final)=2.118 | acc=1.0000 | 4645.6 samples/s | 72.6 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00539 | Reg=0.00263 | L2-Norm=16.205 | L2-Norm(final)=2.118 | acc=1.0000 | 4653.5 samples/s | 72.7 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00538 | Reg=0.00262 | L2-Norm=16.188 | L2-Norm(final)=2.116 | acc=1.0000 | 4559.6 samples/s | 71.2 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00530 | Reg=0.00262 | L2-Norm=16.175 | L2-Norm(final)=2.115 | acc=0.9844 | 4691.6 samples/s | 73.3 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00514 | Reg=0.00261 | L2-Norm=16.161 | L2-Norm(final)=2.114 | acc=1.0000 | 1508.8 samples/s | 23.6 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00479 | Reg=0.00261 | L2-Norm=16.144 | L2-Norm(final)=2.112 | acc=1.0000 | 4948.6 samples/s | 77.3 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00444 | Reg=0.00260 | L2-Norm=16.125 | L2-Norm(final)=2.112 | acc=1.0000 | 4542.9 samples/s | 71.0 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00413 | Reg=0.00259 | L2-Norm=16.104 | L2-Norm(final)=2.111 | acc=1.0000 | 4604.5 samples/s | 71.9 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00387 | Reg=0.00259 | L2-Norm=16.081 | L2-Norm(final)=2.112 | acc=1.0000 | 4674.2 samples/s | 73.0 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00363 | Reg=0.00258 | L2-Norm=16.057 | L2-Norm(final)=2.112 | acc=1.0000 | 4616.4 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46290 | acc=0.6093 | tpr=0.4595 | fpr=0.0654 | 4441.3 samples/s | 17.3 steps/s
Avg test loss: 0.46564, Avg test acc: 0.60786, Avg tpr: 0.45818, Avg fpr: 0.06294, total FA: 491

Testing server on iccad2012
[Step=  50] | Loss=0.22528 | acc=0.8632 | tpr=0.9513 | fpr=0.1384 | 4404.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.22439 | acc=0.8650 | tpr=0.9616 | fpr=0.1368 | 9018.2 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.22715 | acc=0.8632 | tpr=0.9683 | fpr=0.1387 | 8538.1 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.22605 | acc=0.8653 | tpr=0.9672 | fpr=0.1366 | 8843.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.22506 | acc=0.8655 | tpr=0.9659 | fpr=0.1364 | 8813.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.22671 | acc=0.8650 | tpr=0.9658 | fpr=0.1369 | 8691.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.22682 | acc=0.8646 | tpr=0.9662 | fpr=0.1372 | 9098.1 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.22766 | acc=0.8645 | tpr=0.9655 | fpr=0.1373 | 8636.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.22909 | acc=0.8638 | tpr=0.9654 | fpr=0.1380 | 8776.3 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.22975 | acc=0.8636 | tpr=0.9656 | fpr=0.1383 | 8438.0 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.22967 | acc=0.8637 | tpr=0.9654 | fpr=0.1381 | 16107.1 samples/s | 62.9 steps/s
Avg test loss: 0.22952, Avg test acc: 0.86377, Avg tpr: 0.96553, Avg fpr: 0.13808, total FA: 19172

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.38658 | Reg=0.00251 | L2-Norm=15.832 | L2-Norm(final)=2.114 | acc=0.6562 | 3864.5 samples/s | 60.4 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.10947 | Reg=0.00253 | L2-Norm=15.910 | L2-Norm(final)=2.100 | acc=0.9219 | 4825.0 samples/s | 75.4 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.08648 | Reg=0.00255 | L2-Norm=15.961 | L2-Norm(final)=2.114 | acc=0.9531 | 4845.5 samples/s | 75.7 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07965 | Reg=0.00256 | L2-Norm=15.998 | L2-Norm(final)=2.117 | acc=1.0000 | 4890.6 samples/s | 76.4 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.07300 | Reg=0.00257 | L2-Norm=16.034 | L2-Norm(final)=2.121 | acc=0.9375 | 4896.9 samples/s | 76.5 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06935 | Reg=0.00258 | L2-Norm=16.066 | L2-Norm(final)=2.127 | acc=0.9219 | 5015.9 samples/s | 78.4 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06708 | Reg=0.00259 | L2-Norm=16.092 | L2-Norm(final)=2.129 | acc=0.9219 | 4864.5 samples/s | 76.0 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06594 | Reg=0.00260 | L2-Norm=16.114 | L2-Norm(final)=2.131 | acc=0.9531 | 4828.6 samples/s | 75.4 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06427 | Reg=0.00260 | L2-Norm=16.136 | L2-Norm(final)=2.132 | acc=0.9375 | 4828.9 samples/s | 75.5 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.06333 | Reg=0.00261 | L2-Norm=16.156 | L2-Norm(final)=2.132 | acc=0.9375 | 4501.0 samples/s | 70.3 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.06282 | Reg=0.00262 | L2-Norm=16.174 | L2-Norm(final)=2.130 | acc=0.9375 | 3824.5 samples/s | 59.8 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.06180 | Reg=0.00262 | L2-Norm=16.192 | L2-Norm(final)=2.129 | acc=0.9531 | 3853.6 samples/s | 60.2 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.06116 | Reg=0.00263 | L2-Norm=16.209 | L2-Norm(final)=2.128 | acc=0.9844 | 3901.8 samples/s | 61.0 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.06006 | Reg=0.00263 | L2-Norm=16.227 | L2-Norm(final)=2.127 | acc=0.9531 | 3832.4 samples/s | 59.9 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05933 | Reg=0.00264 | L2-Norm=16.243 | L2-Norm(final)=2.126 | acc=0.8906 | 3856.0 samples/s | 60.2 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05867 | Reg=0.00264 | L2-Norm=16.260 | L2-Norm(final)=2.126 | acc=0.9844 | 3844.8 samples/s | 60.1 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05761 | Reg=0.00265 | L2-Norm=16.277 | L2-Norm(final)=2.125 | acc=1.0000 | 3892.5 samples/s | 60.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.07090 | Reg=0.00251 | L2-Norm=15.832 | L2-Norm(final)=2.116 | acc=0.9531 | 3651.1 samples/s | 57.0 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.01103 | Reg=0.00254 | L2-Norm=15.930 | L2-Norm(final)=2.132 | acc=1.0000 | 4671.9 samples/s | 73.0 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00717 | Reg=0.00254 | L2-Norm=15.940 | L2-Norm(final)=2.136 | acc=1.0000 | 4642.7 samples/s | 72.5 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00523 | Reg=0.00254 | L2-Norm=15.933 | L2-Norm(final)=2.140 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00485 | Reg=0.00253 | L2-Norm=15.920 | L2-Norm(final)=2.143 | acc=1.0000 | 4628.3 samples/s | 72.3 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00398 | Reg=0.00253 | L2-Norm=15.905 | L2-Norm(final)=2.148 | acc=1.0000 | 4746.5 samples/s | 74.2 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00361 | Reg=0.00252 | L2-Norm=15.884 | L2-Norm(final)=2.151 | acc=1.0000 | 4602.1 samples/s | 71.9 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00381 | Reg=0.00252 | L2-Norm=15.864 | L2-Norm(final)=2.153 | acc=1.0000 | 4684.6 samples/s | 73.2 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00351 | Reg=0.00251 | L2-Norm=15.851 | L2-Norm(final)=2.152 | acc=1.0000 | 4763.5 samples/s | 74.4 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00361 | Reg=0.00251 | L2-Norm=15.837 | L2-Norm(final)=2.150 | acc=1.0000 | 4613.0 samples/s | 72.1 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00359 | Reg=0.00250 | L2-Norm=15.824 | L2-Norm(final)=2.147 | acc=1.0000 | 4751.5 samples/s | 74.2 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00348 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.145 | acc=1.0000 | 1495.2 samples/s | 23.4 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00331 | Reg=0.00250 | L2-Norm=15.797 | L2-Norm(final)=2.144 | acc=1.0000 | 4722.2 samples/s | 73.8 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00315 | Reg=0.00249 | L2-Norm=15.781 | L2-Norm(final)=2.142 | acc=1.0000 | 4632.6 samples/s | 72.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00298 | Reg=0.00248 | L2-Norm=15.763 | L2-Norm(final)=2.140 | acc=1.0000 | 4663.9 samples/s | 72.9 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00279 | Reg=0.00248 | L2-Norm=15.743 | L2-Norm(final)=2.140 | acc=1.0000 | 4657.9 samples/s | 72.8 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00264 | Reg=0.00247 | L2-Norm=15.723 | L2-Norm(final)=2.139 | acc=1.0000 | 4682.4 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46308 | acc=0.6391 | tpr=0.4896 | fpr=0.0362 | 4350.9 samples/s | 17.0 steps/s
Avg test loss: 0.46870, Avg test acc: 0.63547, Avg tpr: 0.48511, Avg fpr: 0.03384, total FA: 264

Testing server on iccad2012
[Step=  50] | Loss=0.18227 | acc=0.8926 | tpr=0.9381 | fpr=0.1082 | 3950.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.18307 | acc=0.8921 | tpr=0.9488 | fpr=0.1090 | 8840.9 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.18594 | acc=0.8907 | tpr=0.9539 | fpr=0.1104 | 8788.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.18602 | acc=0.8913 | tpr=0.9519 | fpr=0.1098 | 8527.6 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.18548 | acc=0.8914 | tpr=0.9520 | fpr=0.1097 | 9140.1 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.18641 | acc=0.8912 | tpr=0.9549 | fpr=0.1100 | 8739.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.18740 | acc=0.8909 | tpr=0.9562 | fpr=0.1103 | 9055.0 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.18835 | acc=0.8904 | tpr=0.9573 | fpr=0.1108 | 8409.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.19002 | acc=0.8899 | tpr=0.9567 | fpr=0.1113 | 8826.3 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.19072 | acc=0.8892 | tpr=0.9586 | fpr=0.1120 | 8687.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.19034 | acc=0.8893 | tpr=0.9582 | fpr=0.1120 | 16371.8 samples/s | 64.0 steps/s
Avg test loss: 0.19019, Avg test acc: 0.88932, Avg tpr: 0.95840, Avg fpr: 0.11194, total FA: 15542

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.24542 | Reg=0.00243 | L2-Norm=15.594 | L2-Norm(final)=2.122 | acc=0.7812 | 3423.6 samples/s | 53.5 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.09555 | Reg=0.00246 | L2-Norm=15.696 | L2-Norm(final)=2.105 | acc=0.9688 | 4881.7 samples/s | 76.3 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07581 | Reg=0.00248 | L2-Norm=15.752 | L2-Norm(final)=2.116 | acc=0.9375 | 4743.0 samples/s | 74.1 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.07388 | Reg=0.00250 | L2-Norm=15.796 | L2-Norm(final)=2.121 | acc=0.9375 | 4740.7 samples/s | 74.1 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06814 | Reg=0.00251 | L2-Norm=15.835 | L2-Norm(final)=2.126 | acc=0.9844 | 4771.7 samples/s | 74.6 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06692 | Reg=0.00252 | L2-Norm=15.867 | L2-Norm(final)=2.127 | acc=0.9375 | 3995.2 samples/s | 62.4 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06355 | Reg=0.00253 | L2-Norm=15.896 | L2-Norm(final)=2.128 | acc=0.9688 | 3846.4 samples/s | 60.1 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06190 | Reg=0.00254 | L2-Norm=15.922 | L2-Norm(final)=2.128 | acc=1.0000 | 3895.2 samples/s | 60.9 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05968 | Reg=0.00254 | L2-Norm=15.945 | L2-Norm(final)=2.128 | acc=0.9219 | 3929.3 samples/s | 61.4 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05817 | Reg=0.00255 | L2-Norm=15.967 | L2-Norm(final)=2.128 | acc=0.9844 | 3833.3 samples/s | 59.9 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05696 | Reg=0.00256 | L2-Norm=15.988 | L2-Norm(final)=2.129 | acc=0.9375 | 3873.6 samples/s | 60.5 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05647 | Reg=0.00256 | L2-Norm=16.009 | L2-Norm(final)=2.129 | acc=0.9062 | 3877.9 samples/s | 60.6 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05587 | Reg=0.00257 | L2-Norm=16.031 | L2-Norm(final)=2.129 | acc=0.9844 | 3827.7 samples/s | 59.8 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05509 | Reg=0.00258 | L2-Norm=16.052 | L2-Norm(final)=2.129 | acc=0.9375 | 3870.6 samples/s | 60.5 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05455 | Reg=0.00258 | L2-Norm=16.073 | L2-Norm(final)=2.128 | acc=0.9688 | 3888.5 samples/s | 60.8 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05366 | Reg=0.00259 | L2-Norm=16.093 | L2-Norm(final)=2.128 | acc=0.9844 | 3923.3 samples/s | 61.3 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05342 | Reg=0.00260 | L2-Norm=16.112 | L2-Norm(final)=2.128 | acc=0.9531 | 3828.8 samples/s | 59.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.04084 | Reg=0.00243 | L2-Norm=15.594 | L2-Norm(final)=2.124 | acc=0.9531 | 2878.8 samples/s | 45.0 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00560 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.141 | acc=1.0000 | 4438.6 samples/s | 69.4 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00352 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.149 | acc=0.9844 | 4839.2 samples/s | 75.6 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00358 | Reg=0.00245 | L2-Norm=15.662 | L2-Norm(final)=2.151 | acc=1.0000 | 4624.0 samples/s | 72.2 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00356 | Reg=0.00245 | L2-Norm=15.655 | L2-Norm(final)=2.151 | acc=1.0000 | 4734.2 samples/s | 74.0 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00389 | Reg=0.00245 | L2-Norm=15.643 | L2-Norm(final)=2.149 | acc=1.0000 | 4688.0 samples/s | 73.3 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00405 | Reg=0.00244 | L2-Norm=15.634 | L2-Norm(final)=2.145 | acc=1.0000 | 4600.2 samples/s | 71.9 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00379 | Reg=0.00244 | L2-Norm=15.626 | L2-Norm(final)=2.143 | acc=1.0000 | 4616.1 samples/s | 72.1 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00340 | Reg=0.00244 | L2-Norm=15.615 | L2-Norm(final)=2.142 | acc=1.0000 | 4768.6 samples/s | 74.5 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00308 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.142 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00278 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.143 | acc=1.0000 | 4725.7 samples/s | 73.8 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00253 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.144 | acc=1.0000 | 1470.7 samples/s | 23.0 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00233 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.145 | acc=1.0000 | 4719.9 samples/s | 73.7 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00215 | Reg=0.00241 | L2-Norm=15.511 | L2-Norm(final)=2.147 | acc=1.0000 | 4727.8 samples/s | 73.9 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00200 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.148 | acc=1.0000 | 4597.0 samples/s | 71.8 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00187 | Reg=0.00239 | L2-Norm=15.455 | L2-Norm(final)=2.150 | acc=1.0000 | 4581.7 samples/s | 71.6 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00176 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.151 | acc=1.0000 | 4663.5 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39390 | acc=0.6812 | tpr=0.5519 | fpr=0.0382 | 4393.6 samples/s | 17.2 steps/s
Avg test loss: 0.39779, Avg test acc: 0.68014, Avg tpr: 0.55249, Avg fpr: 0.03910, total FA: 305

Testing server on iccad2012
[Step=  50] | Loss=0.22107 | acc=0.8677 | tpr=0.9469 | fpr=0.1338 | 4422.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.22229 | acc=0.8675 | tpr=0.9531 | fpr=0.1341 | 8836.0 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.22457 | acc=0.8665 | tpr=0.9654 | fpr=0.1354 | 9070.9 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.22556 | acc=0.8668 | tpr=0.9661 | fpr=0.1351 | 8823.5 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.22488 | acc=0.8662 | tpr=0.9659 | fpr=0.1356 | 9062.0 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.22551 | acc=0.8665 | tpr=0.9658 | fpr=0.1354 | 8742.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.22645 | acc=0.8661 | tpr=0.9656 | fpr=0.1357 | 9155.9 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.22683 | acc=0.8662 | tpr=0.9666 | fpr=0.1356 | 8563.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.22837 | acc=0.8657 | tpr=0.9674 | fpr=0.1361 | 8773.2 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.22874 | acc=0.8653 | tpr=0.9683 | fpr=0.1366 | 8596.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.22821 | acc=0.8656 | tpr=0.9678 | fpr=0.1362 | 16830.5 samples/s | 65.7 steps/s
Avg test loss: 0.22806, Avg test acc: 0.86560, Avg tpr: 0.96791, Avg fpr: 0.13626, total FA: 18919

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.28466 | Reg=0.00235 | L2-Norm=15.346 | L2-Norm(final)=2.133 | acc=0.7656 | 3770.9 samples/s | 58.9 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.07953 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.125 | acc=0.9688 | 4787.8 samples/s | 74.8 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06594 | Reg=0.00241 | L2-Norm=15.539 | L2-Norm(final)=2.137 | acc=0.9688 | 4826.0 samples/s | 75.4 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06213 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.143 | acc=0.9531 | 4863.4 samples/s | 76.0 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05908 | Reg=0.00244 | L2-Norm=15.630 | L2-Norm(final)=2.145 | acc=0.9844 | 4838.5 samples/s | 75.6 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05759 | Reg=0.00245 | L2-Norm=15.660 | L2-Norm(final)=2.145 | acc=0.9531 | 4945.3 samples/s | 77.3 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05458 | Reg=0.00246 | L2-Norm=15.689 | L2-Norm(final)=2.146 | acc=0.9844 | 4726.4 samples/s | 73.9 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05378 | Reg=0.00247 | L2-Norm=15.716 | L2-Norm(final)=2.147 | acc=0.9688 | 3919.3 samples/s | 61.2 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05325 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.148 | acc=0.9531 | 3866.1 samples/s | 60.4 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05316 | Reg=0.00249 | L2-Norm=15.767 | L2-Norm(final)=2.148 | acc=0.9688 | 3881.4 samples/s | 60.6 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05238 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.147 | acc=0.9688 | 3829.3 samples/s | 59.8 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05113 | Reg=0.00250 | L2-Norm=15.814 | L2-Norm(final)=2.147 | acc=0.9688 | 3841.0 samples/s | 60.0 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05023 | Reg=0.00251 | L2-Norm=15.835 | L2-Norm(final)=2.147 | acc=0.9688 | 3847.4 samples/s | 60.1 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04986 | Reg=0.00251 | L2-Norm=15.857 | L2-Norm(final)=2.147 | acc=0.9688 | 3853.3 samples/s | 60.2 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04953 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.147 | acc=0.9844 | 3823.8 samples/s | 59.7 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04877 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.148 | acc=1.0000 | 3891.4 samples/s | 60.8 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04856 | Reg=0.00254 | L2-Norm=15.924 | L2-Norm(final)=2.149 | acc=0.9375 | 3811.8 samples/s | 59.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.05008 | Reg=0.00235 | L2-Norm=15.346 | L2-Norm(final)=2.136 | acc=0.9375 | 2970.5 samples/s | 46.4 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00481 | Reg=0.00239 | L2-Norm=15.445 | L2-Norm(final)=2.172 | acc=1.0000 | 4265.0 samples/s | 66.6 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00735 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.165 | acc=1.0000 | 4524.4 samples/s | 70.7 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00675 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.154 | acc=1.0000 | 4565.8 samples/s | 71.3 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00654 | Reg=0.00243 | L2-Norm=15.587 | L2-Norm(final)=2.143 | acc=1.0000 | 4593.9 samples/s | 71.8 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00551 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.137 | acc=1.0000 | 4716.3 samples/s | 73.7 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00481 | Reg=0.00243 | L2-Norm=15.596 | L2-Norm(final)=2.135 | acc=1.0000 | 4589.7 samples/s | 71.7 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00498 | Reg=0.00243 | L2-Norm=15.593 | L2-Norm(final)=2.133 | acc=1.0000 | 4707.3 samples/s | 73.6 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00451 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.130 | acc=1.0000 | 4780.4 samples/s | 74.7 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00410 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.129 | acc=1.0000 | 4729.0 samples/s | 73.9 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00377 | Reg=0.00243 | L2-Norm=15.575 | L2-Norm(final)=2.128 | acc=1.0000 | 4729.8 samples/s | 73.9 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00357 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.129 | acc=1.0000 | 1520.5 samples/s | 23.8 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00345 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.129 | acc=1.0000 | 4583.7 samples/s | 71.6 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00328 | Reg=0.00242 | L2-Norm=15.544 | L2-Norm(final)=2.129 | acc=1.0000 | 4742.4 samples/s | 74.1 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00340 | Reg=0.00241 | L2-Norm=15.538 | L2-Norm(final)=2.128 | acc=1.0000 | 4333.4 samples/s | 67.7 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00333 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.126 | acc=1.0000 | 3712.0 samples/s | 58.0 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00338 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.123 | acc=1.0000 | 3661.5 samples/s | 57.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43738 | acc=0.6471 | tpr=0.5105 | fpr=0.0562 | 4076.5 samples/s | 15.9 steps/s
Avg test loss: 0.43853, Avg test acc: 0.64476, Avg tpr: 0.50796, Avg fpr: 0.05435, total FA: 424

Testing server on iccad2012
[Step=  50] | Loss=0.19239 | acc=0.8841 | tpr=0.9646 | fpr=0.1174 | 4373.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.19593 | acc=0.8842 | tpr=0.9723 | fpr=0.1175 | 9014.1 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.19866 | acc=0.8830 | tpr=0.9755 | fpr=0.1187 | 8934.8 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.19883 | acc=0.8840 | tpr=0.9760 | fpr=0.1177 | 8768.6 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.19781 | acc=0.8838 | tpr=0.9755 | fpr=0.1178 | 8624.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.19904 | acc=0.8843 | tpr=0.9753 | fpr=0.1173 | 8800.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.20009 | acc=0.8834 | tpr=0.9762 | fpr=0.1182 | 8811.7 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.20059 | acc=0.8833 | tpr=0.9759 | fpr=0.1183 | 8870.4 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.20206 | acc=0.8828 | tpr=0.9752 | fpr=0.1189 | 8296.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.20286 | acc=0.8821 | tpr=0.9749 | fpr=0.1196 | 8693.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.20210 | acc=0.8825 | tpr=0.9741 | fpr=0.1191 | 16017.8 samples/s | 62.6 steps/s
Avg test loss: 0.20192, Avg test acc: 0.88257, Avg tpr: 0.97425, Avg fpr: 0.11910, total FA: 16537

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.30480 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.102 | acc=0.7500 | 3792.3 samples/s | 59.3 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.08774 | Reg=0.00241 | L2-Norm=15.533 | L2-Norm(final)=2.106 | acc=0.9844 | 4838.9 samples/s | 75.6 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.07158 | Reg=0.00244 | L2-Norm=15.607 | L2-Norm(final)=2.123 | acc=0.9531 | 4900.3 samples/s | 76.6 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.06555 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.128 | acc=0.9844 | 4956.1 samples/s | 77.4 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.06080 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.134 | acc=0.9531 | 4741.3 samples/s | 74.1 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05805 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.137 | acc=0.9844 | 4936.0 samples/s | 77.1 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05677 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.136 | acc=0.9688 | 4839.6 samples/s | 75.6 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05505 | Reg=0.00250 | L2-Norm=15.796 | L2-Norm(final)=2.135 | acc=0.9375 | 4891.3 samples/s | 76.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.05385 | Reg=0.00250 | L2-Norm=15.825 | L2-Norm(final)=2.136 | acc=0.9688 | 4877.2 samples/s | 76.2 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.05365 | Reg=0.00251 | L2-Norm=15.852 | L2-Norm(final)=2.135 | acc=0.9844 | 4853.1 samples/s | 75.8 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.05269 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.134 | acc=0.9844 | 3850.5 samples/s | 60.2 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.05127 | Reg=0.00253 | L2-Norm=15.905 | L2-Norm(final)=2.135 | acc=0.9531 | 3859.8 samples/s | 60.3 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.05008 | Reg=0.00254 | L2-Norm=15.930 | L2-Norm(final)=2.136 | acc=0.9688 | 3866.0 samples/s | 60.4 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04942 | Reg=0.00255 | L2-Norm=15.953 | L2-Norm(final)=2.137 | acc=0.9531 | 3900.6 samples/s | 60.9 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04881 | Reg=0.00255 | L2-Norm=15.976 | L2-Norm(final)=2.136 | acc=0.9688 | 3864.8 samples/s | 60.4 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04876 | Reg=0.00256 | L2-Norm=15.997 | L2-Norm(final)=2.135 | acc=0.9531 | 3853.3 samples/s | 60.2 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04840 | Reg=0.00257 | L2-Norm=16.019 | L2-Norm(final)=2.134 | acc=0.9375 | 3848.7 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.02033 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.104 | acc=0.9844 | 3006.4 samples/s | 47.0 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00423 | Reg=0.00239 | L2-Norm=15.465 | L2-Norm(final)=2.136 | acc=1.0000 | 4252.8 samples/s | 66.5 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00221 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.142 | acc=1.0000 | 4662.6 samples/s | 72.9 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00152 | Reg=0.00238 | L2-Norm=15.422 | L2-Norm(final)=2.147 | acc=1.0000 | 4729.4 samples/s | 73.9 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00115 | Reg=0.00237 | L2-Norm=15.388 | L2-Norm(final)=2.151 | acc=1.0000 | 4615.9 samples/s | 72.1 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00093 | Reg=0.00236 | L2-Norm=15.353 | L2-Norm(final)=2.155 | acc=1.0000 | 4571.5 samples/s | 71.4 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00092 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.157 | acc=1.0000 | 4620.2 samples/s | 72.2 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00143 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.155 | acc=1.0000 | 4728.6 samples/s | 73.9 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00132 | Reg=0.00233 | L2-Norm=15.264 | L2-Norm(final)=2.154 | acc=1.0000 | 4632.4 samples/s | 72.4 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00141 | Reg=0.00232 | L2-Norm=15.242 | L2-Norm(final)=2.154 | acc=1.0000 | 4617.1 samples/s | 72.1 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00144 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.153 | acc=1.0000 | 4543.0 samples/s | 71.0 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00152 | Reg=0.00231 | L2-Norm=15.205 | L2-Norm(final)=2.153 | acc=1.0000 | 1513.6 samples/s | 23.7 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00185 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.150 | acc=1.0000 | 4744.9 samples/s | 74.1 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00179 | Reg=0.00231 | L2-Norm=15.184 | L2-Norm(final)=2.148 | acc=1.0000 | 4644.7 samples/s | 72.6 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00167 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.147 | acc=1.0000 | 4623.5 samples/s | 72.2 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00161 | Reg=0.00230 | L2-Norm=15.159 | L2-Norm(final)=2.147 | acc=1.0000 | 4688.8 samples/s | 73.3 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00156 | Reg=0.00229 | L2-Norm=15.143 | L2-Norm(final)=2.146 | acc=1.0000 | 4695.6 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.61103 | acc=0.5758 | tpr=0.3865 | fpr=0.0131 | 4492.1 samples/s | 17.5 steps/s
Avg test loss: 0.61775, Avg test acc: 0.57300, Avg tpr: 0.38497, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.16232 | acc=0.9095 | tpr=0.9248 | fpr=0.0907 | 4410.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.16592 | acc=0.9086 | tpr=0.9424 | fpr=0.0921 | 8694.2 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.16792 | acc=0.9079 | tpr=0.9481 | fpr=0.0928 | 9005.3 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.16821 | acc=0.9085 | tpr=0.9486 | fpr=0.0923 | 8682.4 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.16683 | acc=0.9085 | tpr=0.9476 | fpr=0.0922 | 8923.0 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.16857 | acc=0.9081 | tpr=0.9476 | fpr=0.0926 | 8928.8 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.17003 | acc=0.9075 | tpr=0.9493 | fpr=0.0932 | 8646.8 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.17099 | acc=0.9071 | tpr=0.9486 | fpr=0.0937 | 8559.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.17257 | acc=0.9066 | tpr=0.9494 | fpr=0.0942 | 9104.9 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.17258 | acc=0.9063 | tpr=0.9498 | fpr=0.0945 | 8777.8 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.17183 | acc=0.9068 | tpr=0.9499 | fpr=0.0940 | 15861.9 samples/s | 62.0 steps/s
Avg test loss: 0.17169, Avg test acc: 0.90678, Avg tpr: 0.95008, Avg fpr: 0.09400, total FA: 13052

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.38030 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.119 | acc=0.7188 | 3642.7 samples/s | 56.9 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.07582 | Reg=0.00238 | L2-Norm=15.421 | L2-Norm(final)=2.116 | acc=0.9688 | 4849.8 samples/s | 75.8 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.06184 | Reg=0.00241 | L2-Norm=15.509 | L2-Norm(final)=2.130 | acc=0.9219 | 4813.1 samples/s | 75.2 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05633 | Reg=0.00242 | L2-Norm=15.558 | L2-Norm(final)=2.129 | acc=0.9844 | 4778.4 samples/s | 74.7 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05427 | Reg=0.00243 | L2-Norm=15.594 | L2-Norm(final)=2.132 | acc=0.9219 | 4944.2 samples/s | 77.3 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05247 | Reg=0.00244 | L2-Norm=15.625 | L2-Norm(final)=2.133 | acc=0.9688 | 4860.3 samples/s | 75.9 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.05070 | Reg=0.00245 | L2-Norm=15.652 | L2-Norm(final)=2.133 | acc=0.9062 | 4848.7 samples/s | 75.8 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04910 | Reg=0.00246 | L2-Norm=15.678 | L2-Norm(final)=2.134 | acc=0.9688 | 4920.0 samples/s | 76.9 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04823 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.135 | acc=0.9688 | 4939.3 samples/s | 77.2 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04702 | Reg=0.00247 | L2-Norm=15.726 | L2-Norm(final)=2.137 | acc=0.9844 | 4811.7 samples/s | 75.2 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04643 | Reg=0.00248 | L2-Norm=15.748 | L2-Norm(final)=2.138 | acc=0.9531 | 4779.4 samples/s | 74.7 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04542 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.138 | acc=0.9688 | 4890.8 samples/s | 76.4 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04548 | Reg=0.00249 | L2-Norm=15.789 | L2-Norm(final)=2.137 | acc=1.0000 | 4830.9 samples/s | 75.5 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04516 | Reg=0.00250 | L2-Norm=15.810 | L2-Norm(final)=2.136 | acc=0.9375 | 4924.3 samples/s | 76.9 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04486 | Reg=0.00251 | L2-Norm=15.830 | L2-Norm(final)=2.136 | acc=1.0000 | 4885.0 samples/s | 76.3 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04448 | Reg=0.00251 | L2-Norm=15.850 | L2-Norm(final)=2.135 | acc=0.9688 | 4884.0 samples/s | 76.3 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04423 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.134 | acc=0.9844 | 4871.0 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.05646 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.121 | acc=0.9531 | 3501.9 samples/s | 54.7 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00610 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.149 | acc=0.9844 | 4552.3 samples/s | 71.1 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00566 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.146 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00436 | Reg=0.00237 | L2-Norm=15.392 | L2-Norm(final)=2.139 | acc=1.0000 | 4779.4 samples/s | 74.7 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00340 | Reg=0.00236 | L2-Norm=15.375 | L2-Norm(final)=2.140 | acc=1.0000 | 4738.0 samples/s | 74.0 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00301 | Reg=0.00236 | L2-Norm=15.355 | L2-Norm(final)=2.142 | acc=1.0000 | 4616.9 samples/s | 72.1 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00259 | Reg=0.00235 | L2-Norm=15.336 | L2-Norm(final)=2.145 | acc=1.0000 | 4675.1 samples/s | 73.0 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00237 | Reg=0.00235 | L2-Norm=15.316 | L2-Norm(final)=2.148 | acc=1.0000 | 4653.7 samples/s | 72.7 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00209 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.151 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00187 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.154 | acc=1.0000 | 4690.7 samples/s | 73.3 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00168 | Reg=0.00232 | L2-Norm=15.246 | L2-Norm(final)=2.157 | acc=1.0000 | 4581.9 samples/s | 71.6 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00153 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.159 | acc=1.0000 | 1471.7 samples/s | 23.0 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00141 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.162 | acc=1.0000 | 4819.9 samples/s | 75.3 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00130 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.164 | acc=1.0000 | 4588.4 samples/s | 71.7 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00121 | Reg=0.00229 | L2-Norm=15.134 | L2-Norm(final)=2.166 | acc=1.0000 | 4389.5 samples/s | 68.6 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00116 | Reg=0.00228 | L2-Norm=15.106 | L2-Norm(final)=2.168 | acc=1.0000 | 3664.0 samples/s | 57.2 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00110 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.170 | acc=1.0000 | 3732.3 samples/s | 58.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44488 | acc=0.6795 | tpr=0.5420 | fpr=0.0221 | 4434.5 samples/s | 17.3 steps/s
Avg test loss: 0.45168, Avg test acc: 0.67630, Avg tpr: 0.53885, Avg fpr: 0.02141, total FA: 167

Testing server on iccad2012
[Step=  50] | Loss=0.24367 | acc=0.8652 | tpr=0.9646 | fpr=0.1366 | 4443.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.24673 | acc=0.8655 | tpr=0.9659 | fpr=0.1364 | 8660.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.25033 | acc=0.8646 | tpr=0.9683 | fpr=0.1373 | 8497.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.25064 | acc=0.8662 | tpr=0.9694 | fpr=0.1357 | 8702.3 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.24938 | acc=0.8662 | tpr=0.9703 | fpr=0.1357 | 8960.7 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.25048 | acc=0.8660 | tpr=0.9695 | fpr=0.1359 | 8509.7 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.25172 | acc=0.8653 | tpr=0.9693 | fpr=0.1366 | 8454.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.25261 | acc=0.8651 | tpr=0.9699 | fpr=0.1368 | 7827.9 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.25457 | acc=0.8645 | tpr=0.9708 | fpr=0.1374 | 8614.9 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.25493 | acc=0.8638 | tpr=0.9700 | fpr=0.1381 | 7969.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.25375 | acc=0.8644 | tpr=0.9706 | fpr=0.1376 | 16110.0 samples/s | 62.9 steps/s
Avg test loss: 0.25353, Avg test acc: 0.86435, Avg tpr: 0.97068, Avg fpr: 0.13758, total FA: 19103

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.34646 | Reg=0.00228 | L2-Norm=15.099 | L2-Norm(final)=2.154 | acc=0.7031 | 3648.3 samples/s | 57.0 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.07429 | Reg=0.00233 | L2-Norm=15.256 | L2-Norm(final)=2.140 | acc=0.9688 | 4910.4 samples/s | 76.7 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.05618 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.154 | acc=1.0000 | 4907.6 samples/s | 76.7 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.05136 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.155 | acc=0.9844 | 4936.3 samples/s | 77.1 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.04856 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.159 | acc=0.9375 | 4800.7 samples/s | 75.0 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04630 | Reg=0.00238 | L2-Norm=15.437 | L2-Norm(final)=2.160 | acc=0.9688 | 4709.0 samples/s | 73.6 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04580 | Reg=0.00239 | L2-Norm=15.467 | L2-Norm(final)=2.160 | acc=0.9531 | 4787.3 samples/s | 74.8 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04480 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.159 | acc=0.9375 | 4881.4 samples/s | 76.3 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04414 | Reg=0.00241 | L2-Norm=15.522 | L2-Norm(final)=2.160 | acc=0.9688 | 4832.9 samples/s | 75.5 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04343 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.161 | acc=0.9844 | 4809.1 samples/s | 75.1 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04252 | Reg=0.00243 | L2-Norm=15.573 | L2-Norm(final)=2.162 | acc=0.9844 | 4929.2 samples/s | 77.0 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04236 | Reg=0.00243 | L2-Norm=15.598 | L2-Norm(final)=2.163 | acc=0.9531 | 4783.9 samples/s | 74.7 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04220 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.163 | acc=0.9844 | 4849.9 samples/s | 75.8 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04163 | Reg=0.00245 | L2-Norm=15.648 | L2-Norm(final)=2.163 | acc=1.0000 | 4896.2 samples/s | 76.5 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04186 | Reg=0.00246 | L2-Norm=15.673 | L2-Norm(final)=2.163 | acc=0.9688 | 4890.2 samples/s | 76.4 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04101 | Reg=0.00246 | L2-Norm=15.698 | L2-Norm(final)=2.163 | acc=0.9844 | 4833.4 samples/s | 75.5 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04053 | Reg=0.00247 | L2-Norm=15.722 | L2-Norm(final)=2.164 | acc=0.9844 | 4903.7 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.07819 | Reg=0.00228 | L2-Norm=15.099 | L2-Norm(final)=2.155 | acc=0.9375 | 3605.3 samples/s | 56.3 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00790 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.154 | acc=0.9688 | 4586.4 samples/s | 71.7 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00479 | Reg=0.00233 | L2-Norm=15.274 | L2-Norm(final)=2.154 | acc=1.0000 | 4687.9 samples/s | 73.2 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00336 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.160 | acc=1.0000 | 4652.3 samples/s | 72.7 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00410 | Reg=0.00233 | L2-Norm=15.279 | L2-Norm(final)=2.161 | acc=1.0000 | 4641.4 samples/s | 72.5 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00457 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.152 | acc=1.0000 | 4641.4 samples/s | 72.5 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00437 | Reg=0.00235 | L2-Norm=15.323 | L2-Norm(final)=2.146 | acc=1.0000 | 4698.5 samples/s | 73.4 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00416 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.139 | acc=1.0000 | 4643.0 samples/s | 72.5 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00370 | Reg=0.00235 | L2-Norm=15.335 | L2-Norm(final)=2.134 | acc=1.0000 | 4718.2 samples/s | 73.7 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00336 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.131 | acc=1.0000 | 4692.4 samples/s | 73.3 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00326 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.129 | acc=1.0000 | 4710.5 samples/s | 73.6 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00305 | Reg=0.00235 | L2-Norm=15.317 | L2-Norm(final)=2.127 | acc=1.0000 | 1498.2 samples/s | 23.4 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00281 | Reg=0.00234 | L2-Norm=15.307 | L2-Norm(final)=2.126 | acc=1.0000 | 4681.8 samples/s | 73.2 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00260 | Reg=0.00234 | L2-Norm=15.294 | L2-Norm(final)=2.125 | acc=1.0000 | 4638.8 samples/s | 72.5 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00241 | Reg=0.00233 | L2-Norm=15.279 | L2-Norm(final)=2.125 | acc=1.0000 | 4696.8 samples/s | 73.4 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00225 | Reg=0.00233 | L2-Norm=15.262 | L2-Norm(final)=2.125 | acc=1.0000 | 4614.3 samples/s | 72.1 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00211 | Reg=0.00232 | L2-Norm=15.244 | L2-Norm(final)=2.125 | acc=1.0000 | 4679.8 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54966 | acc=0.6143 | tpr=0.4451 | fpr=0.0183 | 4370.3 samples/s | 17.1 steps/s
Avg test loss: 0.56038, Avg test acc: 0.61243, Avg tpr: 0.44448, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.16679 | acc=0.9249 | tpr=0.9602 | fpr=0.0757 | 4438.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.17059 | acc=0.9235 | tpr=0.9638 | fpr=0.0772 | 9323.8 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.17300 | acc=0.9228 | tpr=0.9654 | fpr=0.0780 | 8529.6 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.17490 | acc=0.9224 | tpr=0.9628 | fpr=0.0784 | 8938.0 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.17306 | acc=0.9221 | tpr=0.9616 | fpr=0.0787 | 8708.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.17411 | acc=0.9220 | tpr=0.9636 | fpr=0.0787 | 8774.9 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.17552 | acc=0.9216 | tpr=0.9637 | fpr=0.0792 | 9169.9 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.17679 | acc=0.9212 | tpr=0.9628 | fpr=0.0796 | 8714.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.17909 | acc=0.9207 | tpr=0.9620 | fpr=0.0801 | 8444.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.17879 | acc=0.9202 | tpr=0.9621 | fpr=0.0806 | 8856.3 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.17812 | acc=0.9205 | tpr=0.9630 | fpr=0.0803 | 16119.1 samples/s | 63.0 steps/s
Avg test loss: 0.17785, Avg test acc: 0.92051, Avg tpr: 0.96315, Avg fpr: 0.08027, total FA: 11145

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.55668 | Reg=0.00228 | L2-Norm=15.115 | L2-Norm(final)=2.137 | acc=0.6719 | 3494.1 samples/s | 54.6 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.09269 | Reg=0.00231 | L2-Norm=15.188 | L2-Norm(final)=2.125 | acc=0.9688 | 4997.7 samples/s | 78.1 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.06744 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.138 | acc=1.0000 | 4932.8 samples/s | 77.1 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.05569 | Reg=0.00232 | L2-Norm=15.242 | L2-Norm(final)=2.150 | acc=0.9844 | 4827.1 samples/s | 75.4 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.05038 | Reg=0.00233 | L2-Norm=15.257 | L2-Norm(final)=2.157 | acc=0.9688 | 4747.9 samples/s | 74.2 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04702 | Reg=0.00233 | L2-Norm=15.270 | L2-Norm(final)=2.163 | acc=0.9844 | 3876.4 samples/s | 60.6 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.04299 | Reg=0.00234 | L2-Norm=15.282 | L2-Norm(final)=2.168 | acc=1.0000 | 3866.4 samples/s | 60.4 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.04019 | Reg=0.00234 | L2-Norm=15.293 | L2-Norm(final)=2.175 | acc=1.0000 | 3883.5 samples/s | 60.7 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03884 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.178 | acc=0.9844 | 3902.3 samples/s | 61.0 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03710 | Reg=0.00234 | L2-Norm=15.311 | L2-Norm(final)=2.181 | acc=0.9688 | 3897.5 samples/s | 60.9 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03641 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.183 | acc=0.9844 | 3884.8 samples/s | 60.7 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03572 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.185 | acc=0.9844 | 3811.4 samples/s | 59.6 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03499 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.187 | acc=0.9219 | 3890.5 samples/s | 60.8 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03425 | Reg=0.00235 | L2-Norm=15.339 | L2-Norm(final)=2.189 | acc=0.9531 | 3911.7 samples/s | 61.1 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03371 | Reg=0.00235 | L2-Norm=15.345 | L2-Norm(final)=2.190 | acc=1.0000 | 3830.1 samples/s | 59.8 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03338 | Reg=0.00236 | L2-Norm=15.351 | L2-Norm(final)=2.192 | acc=0.9844 | 3860.0 samples/s | 60.3 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03280 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.193 | acc=0.9688 | 3884.0 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.01765 | Reg=0.00228 | L2-Norm=15.115 | L2-Norm(final)=2.140 | acc=0.9844 | 3668.6 samples/s | 57.3 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00464 | Reg=0.00229 | L2-Norm=15.136 | L2-Norm(final)=2.146 | acc=1.0000 | 4433.2 samples/s | 69.3 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00280 | Reg=0.00229 | L2-Norm=15.133 | L2-Norm(final)=2.151 | acc=1.0000 | 4699.1 samples/s | 73.4 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00191 | Reg=0.00229 | L2-Norm=15.122 | L2-Norm(final)=2.155 | acc=1.0000 | 4730.0 samples/s | 73.9 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00149 | Reg=0.00228 | L2-Norm=15.107 | L2-Norm(final)=2.158 | acc=1.0000 | 4688.2 samples/s | 73.3 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00121 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.161 | acc=1.0000 | 4499.8 samples/s | 70.3 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00102 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.163 | acc=1.0000 | 4687.9 samples/s | 73.2 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00088 | Reg=0.00227 | L2-Norm=15.057 | L2-Norm(final)=2.165 | acc=1.0000 | 4712.2 samples/s | 73.6 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00078 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.167 | acc=1.0000 | 4722.7 samples/s | 73.8 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00069 | Reg=0.00226 | L2-Norm=15.022 | L2-Norm(final)=2.169 | acc=1.0000 | 4791.1 samples/s | 74.9 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00062 | Reg=0.00225 | L2-Norm=15.004 | L2-Norm(final)=2.171 | acc=1.0000 | 4771.1 samples/s | 74.5 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00057 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.172 | acc=1.0000 | 1477.0 samples/s | 23.1 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00052 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.173 | acc=1.0000 | 4800.5 samples/s | 75.0 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00048 | Reg=0.00224 | L2-Norm=14.950 | L2-Norm(final)=2.174 | acc=1.0000 | 4737.9 samples/s | 74.0 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00045 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.175 | acc=1.0000 | 4632.2 samples/s | 72.4 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00042 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.176 | acc=1.0000 | 4717.9 samples/s | 73.7 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00039 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.177 | acc=1.0000 | 4808.5 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29962 | acc=0.7839 | tpr=0.6945 | fpr=0.0221 | 4396.2 samples/s | 17.2 steps/s
Avg test loss: 0.30678, Avg test acc: 0.78195, Avg tpr: 0.69214, Avg fpr: 0.02051, total FA: 160

Testing server on iccad2012
[Step=  50] | Loss=0.37930 | acc=0.8202 | tpr=0.9558 | fpr=0.1822 | 4421.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.37934 | acc=0.8227 | tpr=0.9638 | fpr=0.1799 | 8733.8 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.38276 | acc=0.8221 | tpr=0.9697 | fpr=0.1806 | 8752.1 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.38447 | acc=0.8227 | tpr=0.9694 | fpr=0.1800 | 8786.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.38236 | acc=0.8224 | tpr=0.9694 | fpr=0.1803 | 8987.5 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.38254 | acc=0.8227 | tpr=0.9695 | fpr=0.1800 | 8620.4 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.38448 | acc=0.8226 | tpr=0.9712 | fpr=0.1801 | 8876.7 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.38544 | acc=0.8224 | tpr=0.9716 | fpr=0.1803 | 8903.8 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.38827 | acc=0.8221 | tpr=0.9732 | fpr=0.1806 | 8598.7 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.38880 | acc=0.8213 | tpr=0.9731 | fpr=0.1814 | 9260.8 samples/s | 36.2 steps/s
[Step= 550] | Loss=0.38752 | acc=0.8219 | tpr=0.9733 | fpr=0.1809 | 15377.7 samples/s | 60.1 steps/s
Avg test loss: 0.38707, Avg test acc: 0.82188, Avg tpr: 0.97345, Avg fpr: 0.18087, total FA: 25114

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.20301 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.197 | acc=0.8438 | 3577.4 samples/s | 55.9 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04847 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.192 | acc=0.9844 | 4935.1 samples/s | 77.1 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03542 | Reg=0.00224 | L2-Norm=14.975 | L2-Norm(final)=2.207 | acc=0.9844 | 4786.2 samples/s | 74.8 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03270 | Reg=0.00225 | L2-Norm=14.990 | L2-Norm(final)=2.216 | acc=1.0000 | 4895.9 samples/s | 76.5 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03144 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.221 | acc=1.0000 | 4863.1 samples/s | 76.0 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.02957 | Reg=0.00225 | L2-Norm=15.016 | L2-Norm(final)=2.225 | acc=0.9531 | 4879.2 samples/s | 76.2 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02898 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.229 | acc=0.9531 | 4914.5 samples/s | 76.8 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02863 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.232 | acc=0.9844 | 4897.8 samples/s | 76.5 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02835 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.234 | acc=0.9688 | 4836.2 samples/s | 75.6 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02846 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.236 | acc=0.9688 | 4960.9 samples/s | 77.5 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02840 | Reg=0.00227 | L2-Norm=15.061 | L2-Norm(final)=2.238 | acc=0.9844 | 4962.7 samples/s | 77.5 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02794 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.240 | acc=0.9844 | 4905.3 samples/s | 76.6 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02795 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.241 | acc=1.0000 | 4822.6 samples/s | 75.4 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02779 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.242 | acc=1.0000 | 5034.6 samples/s | 78.7 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02748 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.244 | acc=0.9688 | 4753.3 samples/s | 74.3 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02698 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.245 | acc=0.9844 | 4910.2 samples/s | 76.7 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02700 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.247 | acc=1.0000 | 4969.3 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.03790 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.198 | acc=0.9688 | 3872.4 samples/s | 60.5 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00237 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.210 | acc=1.0000 | 4428.5 samples/s | 69.2 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00126 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.217 | acc=1.0000 | 4510.3 samples/s | 70.5 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00087 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.221 | acc=1.0000 | 4621.1 samples/s | 72.2 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00066 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.225 | acc=1.0000 | 4553.5 samples/s | 71.1 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00056 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.227 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00047 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.229 | acc=1.0000 | 4605.1 samples/s | 72.0 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00040 | Reg=0.00221 | L2-Norm=14.873 | L2-Norm(final)=2.231 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00036 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.233 | acc=1.0000 | 4665.4 samples/s | 72.9 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00032 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.234 | acc=1.0000 | 4723.1 samples/s | 73.8 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00029 | Reg=0.00220 | L2-Norm=14.815 | L2-Norm(final)=2.235 | acc=1.0000 | 4774.5 samples/s | 74.6 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00026 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.237 | acc=1.0000 | 1485.1 samples/s | 23.2 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00024 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.238 | acc=1.0000 | 4833.7 samples/s | 75.5 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00022 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.239 | acc=1.0000 | 4772.7 samples/s | 74.6 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00021 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.240 | acc=1.0000 | 4652.6 samples/s | 72.7 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00019 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.241 | acc=1.0000 | 4696.6 samples/s | 73.4 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00018 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.241 | acc=1.0000 | 4742.2 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43696 | acc=0.7324 | tpr=0.6154 | fpr=0.0134 | 4395.4 samples/s | 17.2 steps/s
Avg test loss: 0.44767, Avg test acc: 0.72955, Avg tpr: 0.61264, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.30091 | acc=0.8772 | tpr=0.9558 | fpr=0.1242 | 4468.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.30204 | acc=0.8780 | tpr=0.9552 | fpr=0.1235 | 8654.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.30474 | acc=0.8778 | tpr=0.9611 | fpr=0.1237 | 8798.9 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.30665 | acc=0.8779 | tpr=0.9617 | fpr=0.1236 | 9258.1 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.30410 | acc=0.8777 | tpr=0.9598 | fpr=0.1238 | 8828.6 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.30497 | acc=0.8782 | tpr=0.9607 | fpr=0.1233 | 8472.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.30723 | acc=0.8781 | tpr=0.9612 | fpr=0.1234 | 8839.2 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.30795 | acc=0.8777 | tpr=0.9623 | fpr=0.1239 | 8608.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.31054 | acc=0.8774 | tpr=0.9640 | fpr=0.1242 | 8877.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.31055 | acc=0.8769 | tpr=0.9630 | fpr=0.1246 | 9026.6 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.30938 | acc=0.8772 | tpr=0.9638 | fpr=0.1243 | 15572.4 samples/s | 60.8 steps/s
Avg test loss: 0.30896, Avg test acc: 0.87728, Avg tpr: 0.96395, Avg fpr: 0.12429, total FA: 17258

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.33331 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.256 | acc=0.7812 | 3780.0 samples/s | 59.1 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.04970 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.238 | acc=1.0000 | 4821.9 samples/s | 75.3 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03630 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.247 | acc=0.9688 | 4939.7 samples/s | 77.2 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03049 | Reg=0.00219 | L2-Norm=14.801 | L2-Norm(final)=2.256 | acc=1.0000 | 4824.4 samples/s | 75.4 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03014 | Reg=0.00219 | L2-Norm=14.815 | L2-Norm(final)=2.262 | acc=0.9844 | 4932.4 samples/s | 77.1 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02852 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.266 | acc=0.9844 | 5023.2 samples/s | 78.5 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02774 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.270 | acc=0.9688 | 4894.5 samples/s | 76.5 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02729 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.274 | acc=1.0000 | 4954.8 samples/s | 77.4 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02713 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.276 | acc=1.0000 | 4861.5 samples/s | 76.0 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02635 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.279 | acc=0.9844 | 4768.7 samples/s | 74.5 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02644 | Reg=0.00221 | L2-Norm=14.875 | L2-Norm(final)=2.282 | acc=0.9688 | 4841.8 samples/s | 75.7 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02644 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.285 | acc=0.9844 | 4891.0 samples/s | 76.4 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02632 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.287 | acc=0.9688 | 4829.5 samples/s | 75.5 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02634 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.289 | acc=0.9531 | 4438.6 samples/s | 69.4 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02578 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.291 | acc=1.0000 | 3830.2 samples/s | 59.8 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02578 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.293 | acc=0.9844 | 3863.3 samples/s | 60.4 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02591 | Reg=0.00223 | L2-Norm=14.925 | L2-Norm(final)=2.295 | acc=1.0000 | 3843.2 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.00693 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.257 | acc=1.0000 | 2914.2 samples/s | 45.5 steps/s
[Step=9650 Epoch=18.2] | Loss=0.01026 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.241 | acc=1.0000 | 4696.2 samples/s | 73.4 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00689 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.239 | acc=1.0000 | 4562.1 samples/s | 71.3 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00472 | Reg=0.00222 | L2-Norm=14.897 | L2-Norm(final)=2.238 | acc=1.0000 | 4724.1 samples/s | 73.8 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00367 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.240 | acc=1.0000 | 4716.2 samples/s | 73.7 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00294 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.242 | acc=1.0000 | 4643.4 samples/s | 72.6 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00248 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.244 | acc=1.0000 | 4672.2 samples/s | 73.0 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00243 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.246 | acc=0.9844 | 4683.2 samples/s | 73.2 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00227 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.247 | acc=1.0000 | 4735.4 samples/s | 74.0 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00209 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.248 | acc=1.0000 | 4535.5 samples/s | 70.9 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00191 | Reg=0.00221 | L2-Norm=14.865 | L2-Norm(final)=2.249 | acc=1.0000 | 4780.3 samples/s | 74.7 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00174 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.251 | acc=1.0000 | 1512.0 samples/s | 23.6 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00160 | Reg=0.00221 | L2-Norm=14.849 | L2-Norm(final)=2.252 | acc=1.0000 | 4838.4 samples/s | 75.6 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00148 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.253 | acc=1.0000 | 4778.3 samples/s | 74.7 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00137 | Reg=0.00220 | L2-Norm=14.829 | L2-Norm(final)=2.254 | acc=1.0000 | 4632.5 samples/s | 72.4 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00128 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.255 | acc=1.0000 | 4852.6 samples/s | 75.8 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00120 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.256 | acc=1.0000 | 4644.1 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49452 | acc=0.6808 | tpr=0.5405 | fpr=0.0146 | 4412.8 samples/s | 17.2 steps/s
Avg test loss: 0.50309, Avg test acc: 0.67722, Avg tpr: 0.53739, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.25336 | acc=0.9080 | tpr=0.9558 | fpr=0.0929 | 4420.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.25455 | acc=0.9069 | tpr=0.9595 | fpr=0.0941 | 9012.4 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.25761 | acc=0.9060 | tpr=0.9654 | fpr=0.0951 | 8758.6 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.25886 | acc=0.9063 | tpr=0.9683 | fpr=0.0948 | 8813.6 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.25591 | acc=0.9065 | tpr=0.9668 | fpr=0.0946 | 8764.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.25798 | acc=0.9066 | tpr=0.9651 | fpr=0.0944 | 8935.3 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.26014 | acc=0.9065 | tpr=0.9649 | fpr=0.0946 | 9327.4 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.26122 | acc=0.9065 | tpr=0.9655 | fpr=0.0946 | 8512.0 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.26380 | acc=0.9059 | tpr=0.9654 | fpr=0.0952 | 8417.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.26362 | acc=0.9056 | tpr=0.9656 | fpr=0.0954 | 8807.8 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.26245 | acc=0.9061 | tpr=0.9662 | fpr=0.0950 | 16285.6 samples/s | 63.6 steps/s
Avg test loss: 0.26203, Avg test acc: 0.90611, Avg tpr: 0.96593, Avg fpr: 0.09498, total FA: 13188

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.47104 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.287 | acc=0.7031 | 3502.1 samples/s | 54.7 steps/s
[Step=10450 Epoch=10.2] | Loss=0.06587 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.275 | acc=1.0000 | 4870.3 samples/s | 76.1 steps/s
[Step=10500 Epoch=10.3] | Loss=0.04465 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.291 | acc=0.9688 | 4892.8 samples/s | 76.4 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03873 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.300 | acc=0.9688 | 4796.1 samples/s | 74.9 steps/s
[Step=10600 Epoch=10.3] | Loss=0.03521 | Reg=0.00219 | L2-Norm=14.815 | L2-Norm(final)=2.306 | acc=0.9844 | 4810.3 samples/s | 75.2 steps/s
[Step=10650 Epoch=10.4] | Loss=0.03392 | Reg=0.00220 | L2-Norm=14.828 | L2-Norm(final)=2.310 | acc=0.9844 | 4871.7 samples/s | 76.1 steps/s
[Step=10700 Epoch=10.4] | Loss=0.03251 | Reg=0.00220 | L2-Norm=14.839 | L2-Norm(final)=2.312 | acc=0.9844 | 4775.9 samples/s | 74.6 steps/s
[Step=10750 Epoch=10.5] | Loss=0.03115 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.316 | acc=1.0000 | 4809.1 samples/s | 75.1 steps/s
[Step=10800 Epoch=10.5] | Loss=0.03029 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.319 | acc=1.0000 | 3939.8 samples/s | 61.6 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02966 | Reg=0.00221 | L2-Norm=14.867 | L2-Norm(final)=2.321 | acc=0.9844 | 3793.4 samples/s | 59.3 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02873 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.324 | acc=0.9844 | 3876.3 samples/s | 60.6 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02812 | Reg=0.00222 | L2-Norm=14.884 | L2-Norm(final)=2.326 | acc=0.9844 | 3841.3 samples/s | 60.0 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02769 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.329 | acc=1.0000 | 3845.2 samples/s | 60.1 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02724 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.331 | acc=0.9844 | 3871.3 samples/s | 60.5 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02698 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.333 | acc=0.9844 | 3817.0 samples/s | 59.6 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02690 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.335 | acc=0.9531 | 3907.2 samples/s | 61.0 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02653 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.336 | acc=1.0000 | 3850.9 samples/s | 60.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.01503 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.289 | acc=0.9844 | 2929.7 samples/s | 45.8 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00424 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.294 | acc=0.9844 | 4435.8 samples/s | 69.3 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00254 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.294 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00174 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=2.297 | acc=1.0000 | 4623.8 samples/s | 72.2 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00131 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.299 | acc=1.0000 | 4632.1 samples/s | 72.4 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00113 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.301 | acc=1.0000 | 4700.2 samples/s | 73.4 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00097 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.304 | acc=1.0000 | 4578.0 samples/s | 71.5 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00085 | Reg=0.00215 | L2-Norm=14.667 | L2-Norm(final)=2.307 | acc=1.0000 | 4610.1 samples/s | 72.0 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00075 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.309 | acc=1.0000 | 4656.1 samples/s | 72.8 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00067 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.311 | acc=1.0000 | 4759.3 samples/s | 74.4 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00060 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.313 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00055 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.315 | acc=1.0000 | 1521.6 samples/s | 23.8 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00050 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.316 | acc=1.0000 | 4649.0 samples/s | 72.6 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00047 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.317 | acc=1.0000 | 4713.1 samples/s | 73.6 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00043 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.318 | acc=1.0000 | 4684.3 samples/s | 73.2 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=2.319 | acc=1.0000 | 4643.2 samples/s | 72.5 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00038 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.320 | acc=1.0000 | 4651.5 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37838 | acc=0.7478 | tpr=0.6377 | fpr=0.0131 | 4453.9 samples/s | 17.4 steps/s
Avg test loss: 0.38750, Avg test acc: 0.74473, Avg tpr: 0.63502, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.30779 | acc=0.8798 | tpr=0.9646 | fpr=0.1217 | 4422.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.31022 | acc=0.8811 | tpr=0.9659 | fpr=0.1205 | 8953.5 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.31442 | acc=0.8796 | tpr=0.9712 | fpr=0.1221 | 8706.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.31474 | acc=0.8805 | tpr=0.9716 | fpr=0.1212 | 8920.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.31126 | acc=0.8805 | tpr=0.9694 | fpr=0.1211 | 9088.0 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.31262 | acc=0.8811 | tpr=0.9673 | fpr=0.1205 | 8330.7 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.31484 | acc=0.8805 | tpr=0.9674 | fpr=0.1211 | 8896.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.31587 | acc=0.8805 | tpr=0.9683 | fpr=0.1211 | 8786.1 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.31853 | acc=0.8801 | tpr=0.9679 | fpr=0.1215 | 8548.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.31850 | acc=0.8797 | tpr=0.9674 | fpr=0.1219 | 8926.0 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.31773 | acc=0.8799 | tpr=0.9678 | fpr=0.1217 | 15927.8 samples/s | 62.2 steps/s
Avg test loss: 0.31730, Avg test acc: 0.87988, Avg tpr: 0.96751, Avg fpr: 0.12172, total FA: 16900

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.32282 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=2.345 | acc=0.8750 | 3654.8 samples/s | 57.1 steps/s
[Step=11250 Epoch=11.0] | Loss=0.05429 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.326 | acc=1.0000 | 4815.8 samples/s | 75.2 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03767 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.336 | acc=0.9844 | 4880.3 samples/s | 76.3 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03259 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.344 | acc=1.0000 | 4910.0 samples/s | 76.7 steps/s
[Step=11400 Epoch=11.1] | Loss=0.03038 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.349 | acc=1.0000 | 4946.7 samples/s | 77.3 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02953 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.352 | acc=0.9844 | 4896.7 samples/s | 76.5 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02798 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.356 | acc=0.9844 | 4966.5 samples/s | 77.6 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02680 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.360 | acc=0.9688 | 4890.6 samples/s | 76.4 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02631 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.363 | acc=1.0000 | 4217.8 samples/s | 65.9 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02566 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.365 | acc=0.9844 | 3894.5 samples/s | 60.9 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02521 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.368 | acc=0.9844 | 3828.0 samples/s | 59.8 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02498 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.371 | acc=0.9375 | 3823.0 samples/s | 59.7 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02485 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.373 | acc=0.9688 | 3874.4 samples/s | 60.5 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02474 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.375 | acc=0.9688 | 3834.8 samples/s | 59.9 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02471 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.377 | acc=1.0000 | 3883.4 samples/s | 60.7 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02439 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.379 | acc=0.9531 | 3884.6 samples/s | 60.7 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02445 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.381 | acc=1.0000 | 3885.5 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.07186 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=2.345 | acc=0.9688 | 2911.4 samples/s | 45.5 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00701 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.328 | acc=1.0000 | 4371.2 samples/s | 68.3 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00390 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.329 | acc=1.0000 | 4626.7 samples/s | 72.3 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00285 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.333 | acc=1.0000 | 4776.0 samples/s | 74.6 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00215 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.336 | acc=1.0000 | 4558.9 samples/s | 71.2 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00172 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.339 | acc=1.0000 | 4805.2 samples/s | 75.1 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00146 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=2.341 | acc=1.0000 | 4568.9 samples/s | 71.4 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00125 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.343 | acc=1.0000 | 4689.1 samples/s | 73.3 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00110 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.345 | acc=1.0000 | 4721.6 samples/s | 73.8 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00097 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.346 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00088 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.348 | acc=1.0000 | 4590.5 samples/s | 71.7 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00082 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.349 | acc=1.0000 | 1493.6 samples/s | 23.3 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00075 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=2.350 | acc=1.0000 | 4817.8 samples/s | 75.3 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00069 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.351 | acc=1.0000 | 4589.4 samples/s | 71.7 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00065 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.352 | acc=1.0000 | 4635.4 samples/s | 72.4 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00060 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=2.353 | acc=1.0000 | 4645.0 samples/s | 72.6 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00057 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.354 | acc=1.0000 | 4788.8 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41808 | acc=0.7319 | tpr=0.6147 | fpr=0.0136 | 4426.9 samples/s | 17.3 steps/s
Avg test loss: 0.42568, Avg test acc: 0.73091, Avg tpr: 0.61491, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.25827 | acc=0.9108 | tpr=0.9558 | fpr=0.0900 | 4405.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.26146 | acc=0.9094 | tpr=0.9638 | fpr=0.0916 | 8852.0 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.26403 | acc=0.9092 | tpr=0.9697 | fpr=0.0919 | 8709.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.26613 | acc=0.9092 | tpr=0.9705 | fpr=0.0920 | 8924.4 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.26273 | acc=0.9092 | tpr=0.9694 | fpr=0.0919 | 8885.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.26479 | acc=0.9091 | tpr=0.9680 | fpr=0.0920 | 9042.3 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.26672 | acc=0.9091 | tpr=0.9687 | fpr=0.0920 | 8705.8 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.26764 | acc=0.9092 | tpr=0.9694 | fpr=0.0919 | 8609.1 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.27044 | acc=0.9087 | tpr=0.9688 | fpr=0.0924 | 8558.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.27034 | acc=0.9083 | tpr=0.9687 | fpr=0.0928 | 9012.9 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.26942 | acc=0.9085 | tpr=0.9686 | fpr=0.0926 | 15662.4 samples/s | 61.2 steps/s
Avg test loss: 0.26898, Avg test acc: 0.90857, Avg tpr: 0.96870, Avg fpr: 0.09253, total FA: 12847

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.50384 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.381 | acc=0.7031 | 3698.4 samples/s | 57.8 steps/s
[Step=12050 Epoch=11.8] | Loss=0.05902 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=2.360 | acc=0.9844 | 5178.6 samples/s | 80.9 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03930 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.374 | acc=0.9844 | 4988.7 samples/s | 77.9 steps/s
[Step=12150 Epoch=11.9] | Loss=0.03291 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.386 | acc=0.9844 | 4814.2 samples/s | 75.2 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02996 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.393 | acc=0.9688 | 4944.9 samples/s | 77.3 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02915 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.399 | acc=0.9844 | 4813.7 samples/s | 75.2 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02805 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.401 | acc=0.9688 | 4893.1 samples/s | 76.5 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02795 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.404 | acc=0.9531 | 4877.6 samples/s | 76.2 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02702 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.405 | acc=0.9844 | 4845.3 samples/s | 75.7 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02667 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=2.407 | acc=1.0000 | 4511.3 samples/s | 70.5 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02626 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.409 | acc=0.9844 | 3862.9 samples/s | 60.4 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02577 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.411 | acc=1.0000 | 3866.3 samples/s | 60.4 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02561 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.413 | acc=1.0000 | 3861.6 samples/s | 60.3 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02539 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.414 | acc=0.9531 | 3873.0 samples/s | 60.5 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02552 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.416 | acc=1.0000 | 3867.7 samples/s | 60.4 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02548 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.417 | acc=0.9844 | 3847.1 samples/s | 60.1 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02532 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.419 | acc=0.9688 | 3906.7 samples/s | 61.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.00832 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.384 | acc=1.0000 | 3661.5 samples/s | 57.2 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00389 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.383 | acc=1.0000 | 4619.4 samples/s | 72.2 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00351 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=2.378 | acc=1.0000 | 4694.3 samples/s | 73.3 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00265 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=2.374 | acc=1.0000 | 4600.3 samples/s | 71.9 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00214 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.375 | acc=1.0000 | 4729.7 samples/s | 73.9 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00173 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.376 | acc=1.0000 | 4723.5 samples/s | 73.8 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00160 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.377 | acc=1.0000 | 4807.7 samples/s | 75.1 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00161 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.377 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00155 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.375 | acc=1.0000 | 4707.5 samples/s | 73.6 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00146 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.374 | acc=1.0000 | 4584.7 samples/s | 71.6 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00137 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=2.374 | acc=1.0000 | 4789.5 samples/s | 74.8 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00148 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.374 | acc=1.0000 | 1477.2 samples/s | 23.1 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00177 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.371 | acc=1.0000 | 4802.1 samples/s | 75.0 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00164 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.368 | acc=1.0000 | 4592.9 samples/s | 71.8 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00152 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.366 | acc=1.0000 | 4524.3 samples/s | 70.7 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00143 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.364 | acc=1.0000 | 4740.0 samples/s | 74.1 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00135 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.362 | acc=1.0000 | 4743.9 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52554 | acc=0.6672 | tpr=0.5181 | fpr=0.0092 | 4293.1 samples/s | 16.8 steps/s
Avg test loss: 0.53957, Avg test acc: 0.66115, Avg tpr: 0.51081, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.24082 | acc=0.9198 | tpr=0.9513 | fpr=0.0808 | 4582.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24046 | acc=0.9200 | tpr=0.9659 | fpr=0.0809 | 8336.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.24474 | acc=0.9187 | tpr=0.9697 | fpr=0.0822 | 8815.5 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.24644 | acc=0.9192 | tpr=0.9716 | fpr=0.0818 | 8788.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.24295 | acc=0.9194 | tpr=0.9694 | fpr=0.0815 | 8991.9 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.24458 | acc=0.9197 | tpr=0.9673 | fpr=0.0812 | 8663.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.24725 | acc=0.9191 | tpr=0.9668 | fpr=0.0818 | 8920.3 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9191 | tpr=0.9672 | fpr=0.0818 | 8677.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.25114 | acc=0.9187 | tpr=0.9664 | fpr=0.0822 | 8670.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.25053 | acc=0.9184 | tpr=0.9665 | fpr=0.0824 | 8693.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.24955 | acc=0.9185 | tpr=0.9662 | fpr=0.0823 | 16774.2 samples/s | 65.5 steps/s
Avg test loss: 0.24927, Avg test acc: 0.91857, Avg tpr: 0.96632, Avg fpr: 0.08230, total FA: 11427

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.31619 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=2.388 | acc=0.7344 | 4100.2 samples/s | 64.1 steps/s
[Step=12850 Epoch=12.5] | Loss=0.06505 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.375 | acc=0.9844 | 4417.9 samples/s | 69.0 steps/s
[Step=12900 Epoch=12.6] | Loss=0.04460 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.387 | acc=0.9844 | 4730.2 samples/s | 73.9 steps/s
[Step=12950 Epoch=12.6] | Loss=0.03860 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.397 | acc=1.0000 | 4832.2 samples/s | 75.5 steps/s
[Step=13000 Epoch=12.7] | Loss=0.03534 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.403 | acc=1.0000 | 4809.9 samples/s | 75.2 steps/s
[Step=13050 Epoch=12.7] | Loss=0.03252 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=2.408 | acc=0.9688 | 4876.0 samples/s | 76.2 steps/s
[Step=13100 Epoch=12.8] | Loss=0.03085 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.413 | acc=0.9844 | 4993.1 samples/s | 78.0 steps/s
[Step=13150 Epoch=12.8] | Loss=0.03000 | Reg=0.00216 | L2-Norm=14.714 | L2-Norm(final)=2.417 | acc=0.9844 | 4731.5 samples/s | 73.9 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02910 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=2.420 | acc=0.9844 | 4857.2 samples/s | 75.9 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02813 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.424 | acc=1.0000 | 4827.0 samples/s | 75.4 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02762 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.427 | acc=0.9688 | 4835.3 samples/s | 75.6 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02703 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.430 | acc=1.0000 | 4773.7 samples/s | 74.6 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02645 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.433 | acc=0.9844 | 4995.8 samples/s | 78.1 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02622 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.435 | acc=0.9844 | 4862.4 samples/s | 76.0 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02584 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.437 | acc=0.9844 | 4829.5 samples/s | 75.5 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02563 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.439 | acc=0.9844 | 4855.2 samples/s | 75.9 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02533 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.440 | acc=0.9844 | 4812.8 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.01549 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=2.390 | acc=0.9844 | 3552.6 samples/s | 55.5 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00123 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=2.393 | acc=1.0000 | 4591.9 samples/s | 71.7 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00066 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.397 | acc=1.0000 | 4494.8 samples/s | 70.2 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00045 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=2.399 | acc=1.0000 | 4749.0 samples/s | 74.2 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00034 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.401 | acc=1.0000 | 4663.3 samples/s | 72.9 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00028 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.403 | acc=1.0000 | 4627.8 samples/s | 72.3 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00024 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=2.404 | acc=1.0000 | 4677.0 samples/s | 73.1 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00021 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=2.406 | acc=1.0000 | 4567.2 samples/s | 71.4 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00022 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.407 | acc=1.0000 | 4674.1 samples/s | 73.0 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00020 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.408 | acc=1.0000 | 4648.8 samples/s | 72.6 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00018 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=2.408 | acc=1.0000 | 4736.7 samples/s | 74.0 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00017 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.409 | acc=1.0000 | 1521.8 samples/s | 23.8 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00015 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.410 | acc=1.0000 | 4667.8 samples/s | 72.9 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00014 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=2.411 | acc=1.0000 | 4567.0 samples/s | 71.4 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00013 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=2.412 | acc=1.0000 | 4603.3 samples/s | 71.9 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00012 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=2.412 | acc=1.0000 | 4705.6 samples/s | 73.5 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00012 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=2.413 | acc=1.0000 | 4767.1 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27130 | acc=0.8180 | tpr=0.7397 | fpr=0.0121 | 4421.2 samples/s | 17.3 steps/s
Avg test loss: 0.27999, Avg test acc: 0.81545, Avg tpr: 0.73696, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.41599 | acc=0.8422 | tpr=0.9558 | fpr=0.1599 | 4504.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.41463 | acc=0.8429 | tpr=0.9680 | fpr=0.1594 | 8530.6 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.41757 | acc=0.8428 | tpr=0.9726 | fpr=0.1596 | 8800.5 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.41842 | acc=0.8427 | tpr=0.9716 | fpr=0.1596 | 8880.6 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.41543 | acc=0.8423 | tpr=0.9694 | fpr=0.1600 | 8847.9 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.41609 | acc=0.8431 | tpr=0.9680 | fpr=0.1592 | 8959.8 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.41822 | acc=0.8429 | tpr=0.9681 | fpr=0.1594 | 8596.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.41847 | acc=0.8429 | tpr=0.9688 | fpr=0.1594 | 8839.1 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.42181 | acc=0.8426 | tpr=0.9688 | fpr=0.1597 | 9015.8 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.42245 | acc=0.8417 | tpr=0.9687 | fpr=0.1606 | 8517.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.42136 | acc=0.8422 | tpr=0.9686 | fpr=0.1601 | 16591.5 samples/s | 64.8 steps/s
Avg test loss: 0.42095, Avg test acc: 0.84222, Avg tpr: 0.96870, Avg fpr: 0.16007, total FA: 22226

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.18433 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.440 | acc=0.8594 | 3927.8 samples/s | 61.4 steps/s
[Step=13650 Epoch=13.3] | Loss=0.03835 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=2.432 | acc=0.9688 | 4553.4 samples/s | 71.1 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02884 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.438 | acc=0.9688 | 4930.2 samples/s | 77.0 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02536 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=2.444 | acc=0.9844 | 4782.9 samples/s | 74.7 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02366 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.450 | acc=0.9688 | 4967.6 samples/s | 77.6 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02356 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=2.454 | acc=1.0000 | 4836.4 samples/s | 75.6 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02345 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.457 | acc=1.0000 | 4848.3 samples/s | 75.8 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02312 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.459 | acc=1.0000 | 4929.8 samples/s | 77.0 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02238 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.462 | acc=1.0000 | 4952.9 samples/s | 77.4 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02200 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.465 | acc=0.9844 | 4904.2 samples/s | 76.6 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02178 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.468 | acc=0.9688 | 4708.8 samples/s | 73.6 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02141 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.471 | acc=0.9531 | 4505.4 samples/s | 70.4 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02146 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.474 | acc=0.9688 | 4932.6 samples/s | 77.1 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02127 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.477 | acc=0.9844 | 4817.9 samples/s | 75.3 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02118 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.480 | acc=1.0000 | 4908.8 samples/s | 76.7 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02128 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.482 | acc=0.9844 | 4936.8 samples/s | 77.1 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02104 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.485 | acc=0.9844 | 4942.2 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.01856 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.440 | acc=0.9844 | 3845.6 samples/s | 60.1 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00603 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.430 | acc=1.0000 | 4413.2 samples/s | 69.0 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00322 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.428 | acc=1.0000 | 4627.8 samples/s | 72.3 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00224 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.429 | acc=1.0000 | 4636.6 samples/s | 72.4 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00170 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=2.431 | acc=1.0000 | 4779.7 samples/s | 74.7 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00137 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.433 | acc=1.0000 | 4733.8 samples/s | 74.0 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00114 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.434 | acc=1.0000 | 4692.3 samples/s | 73.3 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00098 | Reg=0.00213 | L2-Norm=14.584 | L2-Norm(final)=2.436 | acc=1.0000 | 4703.5 samples/s | 73.5 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00086 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.437 | acc=1.0000 | 4544.6 samples/s | 71.0 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00079 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.438 | acc=1.0000 | 4717.0 samples/s | 73.7 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00073 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.440 | acc=1.0000 | 4476.3 samples/s | 69.9 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00071 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.441 | acc=1.0000 | 1515.8 samples/s | 23.7 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00071 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=2.441 | acc=1.0000 | 4576.5 samples/s | 71.5 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00066 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=2.442 | acc=1.0000 | 4445.7 samples/s | 69.5 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00068 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.442 | acc=1.0000 | 4447.2 samples/s | 69.5 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00075 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.442 | acc=1.0000 | 4373.9 samples/s | 68.3 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00088 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=2.441 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51745 | acc=0.6884 | tpr=0.5494 | fpr=0.0097 | 4393.9 samples/s | 17.2 steps/s
Avg test loss: 0.53150, Avg test acc: 0.68171, Avg tpr: 0.54164, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.26106 | acc=0.9157 | tpr=0.9602 | fpr=0.0851 | 4455.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.26302 | acc=0.9168 | tpr=0.9701 | fpr=0.0842 | 8640.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.26616 | acc=0.9163 | tpr=0.9726 | fpr=0.0848 | 8910.2 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.26895 | acc=0.9165 | tpr=0.9738 | fpr=0.0846 | 8575.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.26499 | acc=0.9166 | tpr=0.9712 | fpr=0.0844 | 8971.9 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.26606 | acc=0.9167 | tpr=0.9695 | fpr=0.0842 | 8732.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.26994 | acc=0.9160 | tpr=0.9706 | fpr=0.0849 | 8617.0 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.27118 | acc=0.9160 | tpr=0.9710 | fpr=0.0850 | 9178.8 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.27455 | acc=0.9157 | tpr=0.9718 | fpr=0.0853 | 8503.2 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.27375 | acc=0.9156 | tpr=0.9714 | fpr=0.0854 | 8738.7 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.27248 | acc=0.9160 | tpr=0.9713 | fpr=0.0851 | 16359.7 samples/s | 63.9 steps/s
Avg test loss: 0.27208, Avg test acc: 0.91597, Avg tpr: 0.97147, Avg fpr: 0.08504, total FA: 11807

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.29109 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=2.470 | acc=0.7656 | 3725.6 samples/s | 58.2 steps/s
[Step=14450 Epoch=14.1] | Loss=0.05660 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=2.452 | acc=1.0000 | 4693.7 samples/s | 73.3 steps/s
[Step=14500 Epoch=14.2] | Loss=0.03738 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.466 | acc=0.9688 | 4842.6 samples/s | 75.7 steps/s
[Step=14550 Epoch=14.2] | Loss=0.03136 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.476 | acc=0.9844 | 4876.3 samples/s | 76.2 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02870 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.483 | acc=0.9688 | 4939.4 samples/s | 77.2 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02662 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.489 | acc=1.0000 | 4823.3 samples/s | 75.4 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02572 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.494 | acc=0.9844 | 5041.7 samples/s | 78.8 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02532 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.498 | acc=0.9844 | 4962.2 samples/s | 77.5 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02537 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.500 | acc=0.9844 | 4782.2 samples/s | 74.7 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02455 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.502 | acc=1.0000 | 4954.9 samples/s | 77.4 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02464 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=2.504 | acc=0.9844 | 4839.3 samples/s | 75.6 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02459 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.504 | acc=0.9844 | 4895.8 samples/s | 76.5 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02431 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=2.506 | acc=0.9688 | 4857.1 samples/s | 75.9 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02440 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.507 | acc=1.0000 | 4916.5 samples/s | 76.8 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02436 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.508 | acc=0.9688 | 4874.5 samples/s | 76.2 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02409 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.510 | acc=0.9844 | 4921.7 samples/s | 76.9 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02373 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.511 | acc=0.9844 | 4401.6 samples/s | 68.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.02089 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=2.471 | acc=0.9688 | 2855.0 samples/s | 44.6 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00316 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.469 | acc=1.0000 | 4434.0 samples/s | 69.3 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00172 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.472 | acc=1.0000 | 4681.0 samples/s | 73.1 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00116 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.475 | acc=1.0000 | 4651.9 samples/s | 72.7 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00089 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.478 | acc=1.0000 | 4705.3 samples/s | 73.5 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00072 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=2.480 | acc=1.0000 | 4671.7 samples/s | 73.0 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00061 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.482 | acc=1.0000 | 4684.8 samples/s | 73.2 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00054 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=2.484 | acc=1.0000 | 4657.0 samples/s | 72.8 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00047 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.486 | acc=1.0000 | 4742.8 samples/s | 74.1 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00043 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=2.488 | acc=1.0000 | 4656.4 samples/s | 72.8 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=2.490 | acc=1.0000 | 4755.0 samples/s | 74.3 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00036 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=2.491 | acc=1.0000 | 1508.7 samples/s | 23.6 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00033 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=2.493 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.442 | L2-Norm(final)=2.494 | acc=1.0000 | 4566.1 samples/s | 71.3 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=2.495 | acc=1.0000 | 4634.8 samples/s | 72.4 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00027 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=2.496 | acc=1.0000 | 4590.1 samples/s | 71.7 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00025 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.497 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33776 | acc=0.7866 | tpr=0.6937 | fpr=0.0119 | 4344.8 samples/s | 17.0 steps/s
Avg test loss: 0.34859, Avg test acc: 0.78292, Avg tpr: 0.69021, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.33594 | acc=0.8823 | tpr=0.9513 | fpr=0.1189 | 4472.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.33783 | acc=0.8829 | tpr=0.9616 | fpr=0.1186 | 8670.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.34253 | acc=0.8815 | tpr=0.9697 | fpr=0.1202 | 8828.9 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.34389 | acc=0.8820 | tpr=0.9694 | fpr=0.1196 | 9133.3 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.33945 | acc=0.8826 | tpr=0.9686 | fpr=0.1190 | 8574.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.33980 | acc=0.8831 | tpr=0.9680 | fpr=0.1184 | 9244.8 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.34300 | acc=0.8826 | tpr=0.9674 | fpr=0.1189 | 8530.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.34307 | acc=0.8827 | tpr=0.9683 | fpr=0.1189 | 8643.7 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.34670 | acc=0.8827 | tpr=0.9679 | fpr=0.1189 | 8692.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.34623 | acc=0.8822 | tpr=0.9674 | fpr=0.1193 | 8764.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.34514 | acc=0.8825 | tpr=0.9682 | fpr=0.1190 | 16800.6 samples/s | 65.6 steps/s
Avg test loss: 0.34475, Avg test acc: 0.88257, Avg tpr: 0.96830, Avg fpr: 0.11899, total FA: 16521

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.20661 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.524 | acc=0.8594 | 3631.8 samples/s | 56.7 steps/s
[Step=15250 Epoch=14.9] | Loss=0.03797 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=2.512 | acc=0.9844 | 4745.5 samples/s | 74.1 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02793 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.517 | acc=1.0000 | 4850.1 samples/s | 75.8 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02461 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.524 | acc=1.0000 | 4891.5 samples/s | 76.4 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02222 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=2.529 | acc=0.9844 | 5105.8 samples/s | 79.8 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02211 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.534 | acc=0.9844 | 4717.7 samples/s | 73.7 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02112 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.537 | acc=1.0000 | 3902.7 samples/s | 61.0 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02044 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.540 | acc=0.9844 | 3854.2 samples/s | 60.2 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02051 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.543 | acc=0.9844 | 3873.3 samples/s | 60.5 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02058 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.546 | acc=0.9688 | 3876.6 samples/s | 60.6 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02033 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.548 | acc=1.0000 | 3851.8 samples/s | 60.2 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02022 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.550 | acc=0.9844 | 3852.5 samples/s | 60.2 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02028 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.553 | acc=1.0000 | 3876.5 samples/s | 60.6 steps/s
[Step=15850 Epoch=15.5] | Loss=0.01991 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.556 | acc=1.0000 | 3816.0 samples/s | 59.6 steps/s
[Step=15900 Epoch=15.5] | Loss=0.01995 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=2.559 | acc=0.9844 | 3802.1 samples/s | 59.4 steps/s
[Step=15950 Epoch=15.6] | Loss=0.01981 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.561 | acc=1.0000 | 3862.4 samples/s | 60.3 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01990 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.563 | acc=0.9844 | 3829.8 samples/s | 59.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.04777 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.524 | acc=0.9688 | 2861.2 samples/s | 44.7 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00185 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=2.532 | acc=1.0000 | 4515.4 samples/s | 70.6 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00146 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.534 | acc=1.0000 | 4657.0 samples/s | 72.8 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00115 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=2.538 | acc=1.0000 | 4557.1 samples/s | 71.2 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00091 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=2.540 | acc=1.0000 | 4576.0 samples/s | 71.5 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00076 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=2.542 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00064 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=2.544 | acc=1.0000 | 4650.5 samples/s | 72.7 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00055 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.546 | acc=1.0000 | 4587.4 samples/s | 71.7 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00049 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=2.548 | acc=1.0000 | 4628.7 samples/s | 72.3 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00043 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=2.549 | acc=1.0000 | 4620.9 samples/s | 72.2 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=2.551 | acc=1.0000 | 4724.0 samples/s | 73.8 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00036 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.552 | acc=1.0000 | 1457.0 samples/s | 22.8 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00033 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=2.553 | acc=1.0000 | 4698.0 samples/s | 73.4 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00030 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.555 | acc=1.0000 | 4564.5 samples/s | 71.3 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=2.556 | acc=1.0000 | 4714.3 samples/s | 73.7 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00026 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=2.557 | acc=1.0000 | 4670.2 samples/s | 73.0 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00025 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.557 | acc=1.0000 | 4622.6 samples/s | 72.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41268 | acc=0.7671 | tpr=0.6628 | fpr=0.0064 | 4369.1 samples/s | 17.1 steps/s
Avg test loss: 0.42098, Avg test acc: 0.76404, Avg tpr: 0.65985, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.36929 | acc=0.8773 | tpr=0.9513 | fpr=0.1241 | 4469.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.37207 | acc=0.8791 | tpr=0.9552 | fpr=0.1223 | 8874.3 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.37708 | acc=0.8785 | tpr=0.9625 | fpr=0.1231 | 8783.6 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.37978 | acc=0.8789 | tpr=0.9661 | fpr=0.1227 | 8901.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.37569 | acc=0.8785 | tpr=0.9642 | fpr=0.1231 | 8837.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.37692 | acc=0.8792 | tpr=0.9636 | fpr=0.1223 | 8627.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.38077 | acc=0.8790 | tpr=0.9643 | fpr=0.1226 | 8533.9 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.38136 | acc=0.8792 | tpr=0.9650 | fpr=0.1224 | 8934.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.38526 | acc=0.8788 | tpr=0.9654 | fpr=0.1228 | 8564.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.38522 | acc=0.8784 | tpr=0.9652 | fpr=0.1232 | 8867.3 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.38396 | acc=0.8785 | tpr=0.9654 | fpr=0.1231 | 16615.8 samples/s | 64.9 steps/s
Avg test loss: 0.38356, Avg test acc: 0.87853, Avg tpr: 0.96553, Avg fpr: 0.12305, total FA: 17085

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.33108 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.578 | acc=0.8438 | 3528.8 samples/s | 55.1 steps/s
[Step=16050 Epoch=15.7] | Loss=0.04512 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.564 | acc=1.0000 | 4769.3 samples/s | 74.5 steps/s
[Step=16100 Epoch=15.7] | Loss=0.03110 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=2.569 | acc=1.0000 | 4832.9 samples/s | 75.5 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02691 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=2.574 | acc=1.0000 | 4971.6 samples/s | 77.7 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02412 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=2.578 | acc=0.9844 | 5025.6 samples/s | 78.5 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02172 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=2.582 | acc=0.9688 | 4873.4 samples/s | 76.1 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01973 | Reg=0.00209 | L2-Norm=14.442 | L2-Norm(final)=2.586 | acc=0.9688 | 4832.4 samples/s | 75.5 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01925 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=2.590 | acc=0.9844 | 3970.8 samples/s | 62.0 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01827 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=2.593 | acc=0.9844 | 3815.7 samples/s | 59.6 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01787 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=2.597 | acc=1.0000 | 3874.7 samples/s | 60.5 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01769 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=2.599 | acc=1.0000 | 3925.1 samples/s | 61.3 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01759 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.601 | acc=0.9844 | 3885.4 samples/s | 60.7 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01735 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=2.604 | acc=0.9844 | 3910.3 samples/s | 61.1 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01711 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.606 | acc=1.0000 | 3851.2 samples/s | 60.2 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01675 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=2.608 | acc=0.9844 | 3881.0 samples/s | 60.6 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01640 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=2.611 | acc=1.0000 | 3842.4 samples/s | 60.0 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01628 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.613 | acc=1.0000 | 3894.9 samples/s | 60.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.05021 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.578 | acc=0.9688 | 3570.9 samples/s | 55.8 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00274 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.572 | acc=1.0000 | 4241.9 samples/s | 66.3 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00147 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=2.573 | acc=1.0000 | 4613.6 samples/s | 72.1 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00100 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=2.576 | acc=1.0000 | 4594.8 samples/s | 71.8 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00076 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.577 | acc=1.0000 | 4648.1 samples/s | 72.6 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00062 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=2.579 | acc=1.0000 | 4792.6 samples/s | 74.9 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00052 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=2.580 | acc=1.0000 | 4644.0 samples/s | 72.6 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00044 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.581 | acc=1.0000 | 4706.6 samples/s | 73.5 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00039 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.582 | acc=1.0000 | 4737.2 samples/s | 74.0 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00035 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=2.583 | acc=1.0000 | 4848.8 samples/s | 75.8 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00032 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.584 | acc=1.0000 | 4639.5 samples/s | 72.5 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=2.585 | acc=1.0000 | 1494.1 samples/s | 23.3 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00026 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.586 | acc=1.0000 | 4597.6 samples/s | 71.8 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00024 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=2.586 | acc=1.0000 | 4781.4 samples/s | 74.7 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=2.587 | acc=1.0000 | 4697.2 samples/s | 73.4 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=2.587 | acc=1.0000 | 4749.3 samples/s | 74.2 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00020 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.588 | acc=1.0000 | 4735.4 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47226 | acc=0.7504 | tpr=0.6378 | fpr=0.0052 | 4385.7 samples/s | 17.1 steps/s
Avg test loss: 0.48366, Avg test acc: 0.74649, Avg tpr: 0.63379, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.35507 | acc=0.8890 | tpr=0.9558 | fpr=0.1122 | 4576.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.35843 | acc=0.8897 | tpr=0.9616 | fpr=0.1116 | 8015.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.36271 | acc=0.8895 | tpr=0.9669 | fpr=0.1120 | 9041.5 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.36490 | acc=0.8901 | tpr=0.9683 | fpr=0.1113 | 8741.2 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.36085 | acc=0.8898 | tpr=0.9651 | fpr=0.1116 | 8811.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.36231 | acc=0.8905 | tpr=0.9644 | fpr=0.1109 | 8975.8 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.36525 | acc=0.8904 | tpr=0.9643 | fpr=0.1110 | 8624.4 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.36597 | acc=0.8905 | tpr=0.9650 | fpr=0.1109 | 8712.6 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.37040 | acc=0.8901 | tpr=0.9664 | fpr=0.1113 | 8886.3 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.37023 | acc=0.8898 | tpr=0.9661 | fpr=0.1115 | 8528.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.36877 | acc=0.8901 | tpr=0.9670 | fpr=0.1113 | 16461.4 samples/s | 64.3 steps/s
Avg test loss: 0.36837, Avg test acc: 0.89013, Avg tpr: 0.96712, Avg fpr: 0.11127, total FA: 15450

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.35307 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=2.619 | acc=0.7500 | 3656.3 samples/s | 57.1 steps/s
[Step=16850 Epoch=16.5] | Loss=0.05237 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=2.597 | acc=0.9844 | 4704.3 samples/s | 73.5 steps/s
[Step=16900 Epoch=16.5] | Loss=0.03289 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.601 | acc=0.9844 | 4795.5 samples/s | 74.9 steps/s
[Step=16950 Epoch=16.5] | Loss=0.02624 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.607 | acc=1.0000 | 4910.2 samples/s | 76.7 steps/s
[Step=17000 Epoch=16.6] | Loss=0.02264 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=2.612 | acc=1.0000 | 4838.9 samples/s | 75.6 steps/s
[Step=17050 Epoch=16.6] | Loss=0.02081 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=2.616 | acc=1.0000 | 4856.8 samples/s | 75.9 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01944 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=2.619 | acc=0.9844 | 4887.7 samples/s | 76.4 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01860 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=2.623 | acc=1.0000 | 4968.1 samples/s | 77.6 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01770 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=2.626 | acc=0.9844 | 5003.0 samples/s | 78.2 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01775 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=2.629 | acc=0.9688 | 4988.7 samples/s | 77.9 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01717 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=2.632 | acc=0.9844 | 4852.9 samples/s | 75.8 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01635 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.634 | acc=1.0000 | 4792.4 samples/s | 74.9 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01602 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=2.637 | acc=1.0000 | 4842.9 samples/s | 75.7 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01578 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.640 | acc=1.0000 | 4836.5 samples/s | 75.6 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01577 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.642 | acc=1.0000 | 4906.8 samples/s | 76.7 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01546 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=2.644 | acc=1.0000 | 4183.9 samples/s | 65.4 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01530 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.647 | acc=1.0000 | 3905.7 samples/s | 61.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.00324 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=2.620 | acc=1.0000 | 3721.5 samples/s | 58.1 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00366 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=2.616 | acc=1.0000 | 4495.0 samples/s | 70.2 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00200 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.618 | acc=1.0000 | 4576.5 samples/s | 71.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00137 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.620 | acc=1.0000 | 4676.9 samples/s | 73.1 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00103 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.622 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00083 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.623 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00070 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=2.624 | acc=1.0000 | 4554.4 samples/s | 71.2 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00060 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.625 | acc=1.0000 | 4732.7 samples/s | 73.9 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00053 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=2.626 | acc=1.0000 | 4492.5 samples/s | 70.2 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00047 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=2.627 | acc=1.0000 | 4665.9 samples/s | 72.9 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00042 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=2.627 | acc=1.0000 | 4689.3 samples/s | 73.3 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00039 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=2.628 | acc=1.0000 | 1506.8 samples/s | 23.5 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=2.629 | acc=1.0000 | 4769.0 samples/s | 74.5 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00033 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.629 | acc=1.0000 | 4736.5 samples/s | 74.0 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00030 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=2.630 | acc=1.0000 | 4669.0 samples/s | 73.0 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00028 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=2.630 | acc=1.0000 | 4796.1 samples/s | 74.9 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00027 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=2.630 | acc=1.0000 | 4672.0 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49337 | acc=0.7481 | tpr=0.6353 | fpr=0.0069 | 4372.1 samples/s | 17.1 steps/s
Avg test loss: 0.50168, Avg test acc: 0.74481, Avg tpr: 0.63158, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.37424 | acc=0.8921 | tpr=0.9469 | fpr=0.1089 | 4455.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.37881 | acc=0.8937 | tpr=0.9616 | fpr=0.1076 | 9157.5 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.38349 | acc=0.8929 | tpr=0.9669 | fpr=0.1084 | 8222.6 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.38654 | acc=0.8936 | tpr=0.9694 | fpr=0.1078 | 8850.3 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.38116 | acc=0.8937 | tpr=0.9677 | fpr=0.1077 | 8872.0 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.38358 | acc=0.8939 | tpr=0.9658 | fpr=0.1074 | 8780.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.38639 | acc=0.8939 | tpr=0.9662 | fpr=0.1075 | 8869.9 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.38739 | acc=0.8940 | tpr=0.9666 | fpr=0.1073 | 8767.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.39216 | acc=0.8939 | tpr=0.9664 | fpr=0.1074 | 8718.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.39203 | acc=0.8937 | tpr=0.9656 | fpr=0.1076 | 8543.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.39014 | acc=0.8940 | tpr=0.9662 | fpr=0.1073 | 16856.0 samples/s | 65.8 steps/s
Avg test loss: 0.38969, Avg test acc: 0.89403, Avg tpr: 0.96632, Avg fpr: 0.10728, total FA: 14896

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.32438 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.658 | acc=0.7969 | 3918.6 samples/s | 61.2 steps/s
[Step=17650 Epoch=17.2] | Loss=0.04570 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=2.646 | acc=1.0000 | 4891.6 samples/s | 76.4 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02865 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=2.650 | acc=1.0000 | 4902.8 samples/s | 76.6 steps/s
[Step=17750 Epoch=17.3] | Loss=0.02321 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=2.655 | acc=0.9844 | 4897.6 samples/s | 76.5 steps/s
[Step=17800 Epoch=17.4] | Loss=0.02114 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=2.660 | acc=0.9688 | 4743.6 samples/s | 74.1 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01965 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=2.663 | acc=1.0000 | 4813.9 samples/s | 75.2 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01846 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=2.667 | acc=0.9844 | 3879.4 samples/s | 60.6 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01795 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.670 | acc=0.9844 | 3858.1 samples/s | 60.3 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01727 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=2.672 | acc=0.9844 | 3828.9 samples/s | 59.8 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01688 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.675 | acc=0.9688 | 3852.4 samples/s | 60.2 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01654 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.678 | acc=0.9844 | 3826.1 samples/s | 59.8 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01618 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.680 | acc=1.0000 | 3892.3 samples/s | 60.8 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01591 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.682 | acc=1.0000 | 3895.1 samples/s | 60.9 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01552 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.684 | acc=1.0000 | 3853.8 samples/s | 60.2 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01530 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=2.686 | acc=1.0000 | 3932.3 samples/s | 61.4 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01531 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=2.688 | acc=1.0000 | 3800.2 samples/s | 59.4 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01524 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=2.689 | acc=0.9844 | 3890.3 samples/s | 60.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.00705 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.659 | acc=1.0000 | 3493.2 samples/s | 54.6 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00220 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=2.660 | acc=1.0000 | 4545.9 samples/s | 71.0 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00115 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.663 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00110 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=2.664 | acc=1.0000 | 4669.5 samples/s | 73.0 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00090 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.665 | acc=1.0000 | 4737.6 samples/s | 74.0 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00072 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=2.667 | acc=1.0000 | 4703.3 samples/s | 73.5 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00061 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.669 | acc=1.0000 | 4678.9 samples/s | 73.1 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00052 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=2.670 | acc=1.0000 | 4636.9 samples/s | 72.5 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00046 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=2.671 | acc=1.0000 | 4675.5 samples/s | 73.1 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00041 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=2.672 | acc=1.0000 | 4599.7 samples/s | 71.9 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00037 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=2.673 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00034 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.674 | acc=1.0000 | 1495.4 samples/s | 23.4 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00031 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.675 | acc=1.0000 | 4716.2 samples/s | 73.7 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00029 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.676 | acc=1.0000 | 4609.2 samples/s | 72.0 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00027 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.677 | acc=1.0000 | 4564.8 samples/s | 71.3 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00025 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.678 | acc=1.0000 | 4639.5 samples/s | 72.5 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00024 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.679 | acc=1.0000 | 4577.7 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40586 | acc=0.7781 | tpr=0.6795 | fpr=0.0077 | 4336.4 samples/s | 16.9 steps/s
Avg test loss: 0.41196, Avg test acc: 0.77538, Avg tpr: 0.67692, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.38141 | acc=0.8891 | tpr=0.9558 | fpr=0.1121 | 4446.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.38613 | acc=0.8893 | tpr=0.9638 | fpr=0.1121 | 8600.2 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.39174 | acc=0.8886 | tpr=0.9683 | fpr=0.1129 | 9085.8 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.39493 | acc=0.8891 | tpr=0.9694 | fpr=0.1124 | 8665.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.39035 | acc=0.8891 | tpr=0.9686 | fpr=0.1124 | 8711.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.39281 | acc=0.8892 | tpr=0.9665 | fpr=0.1122 | 8804.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.39508 | acc=0.8893 | tpr=0.9668 | fpr=0.1121 | 8647.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.39601 | acc=0.8893 | tpr=0.9666 | fpr=0.1121 | 8898.6 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.40038 | acc=0.8889 | tpr=0.9664 | fpr=0.1125 | 8582.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.40068 | acc=0.8883 | tpr=0.9656 | fpr=0.1131 | 8695.8 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.39893 | acc=0.8886 | tpr=0.9662 | fpr=0.1128 | 16870.9 samples/s | 65.9 steps/s
Avg test loss: 0.39847, Avg test acc: 0.88861, Avg tpr: 0.96632, Avg fpr: 0.11280, total FA: 15662

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.13982 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.698 | acc=0.8750 | 3639.4 samples/s | 56.9 steps/s
[Step=18450 Epoch=18.0] | Loss=0.03474 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.692 | acc=0.9844 | 4762.9 samples/s | 74.4 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02311 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.696 | acc=1.0000 | 4745.2 samples/s | 74.1 steps/s
[Step=18550 Epoch=18.1] | Loss=0.02022 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=2.701 | acc=0.9844 | 4854.3 samples/s | 75.8 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01796 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=2.704 | acc=1.0000 | 5049.5 samples/s | 78.9 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01706 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=2.708 | acc=1.0000 | 4783.6 samples/s | 74.7 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01625 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=2.711 | acc=1.0000 | 4853.1 samples/s | 75.8 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01586 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.715 | acc=1.0000 | 3898.3 samples/s | 60.9 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01569 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.717 | acc=0.9844 | 3936.6 samples/s | 61.5 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01535 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.719 | acc=0.9844 | 3868.6 samples/s | 60.4 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01497 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.721 | acc=1.0000 | 3908.3 samples/s | 61.1 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01484 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=2.723 | acc=1.0000 | 3783.2 samples/s | 59.1 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01461 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=2.724 | acc=0.9844 | 3877.2 samples/s | 60.6 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01430 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.726 | acc=0.9531 | 3796.0 samples/s | 59.3 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01424 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=2.728 | acc=1.0000 | 3883.5 samples/s | 60.7 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01429 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=2.730 | acc=1.0000 | 3855.3 samples/s | 60.2 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01405 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.732 | acc=0.9844 | 3861.4 samples/s | 60.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.00163 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.699 | acc=1.0000 | 3609.1 samples/s | 56.4 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00398 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=2.694 | acc=1.0000 | 4453.1 samples/s | 69.6 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00217 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=2.697 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00146 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.699 | acc=1.0000 | 4756.7 samples/s | 74.3 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00112 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.701 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00090 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.702 | acc=1.0000 | 4786.8 samples/s | 74.8 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00076 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=2.704 | acc=1.0000 | 4667.2 samples/s | 72.9 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00065 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.705 | acc=1.0000 | 4760.3 samples/s | 74.4 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00057 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.706 | acc=1.0000 | 4651.2 samples/s | 72.7 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00051 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=2.707 | acc=1.0000 | 4756.0 samples/s | 74.3 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00046 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.708 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=2.709 | acc=1.0000 | 1494.0 samples/s | 23.3 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00038 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=2.709 | acc=1.0000 | 4838.5 samples/s | 75.6 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00035 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.710 | acc=1.0000 | 4551.5 samples/s | 71.1 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00033 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.710 | acc=1.0000 | 4649.8 samples/s | 72.7 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00031 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.711 | acc=1.0000 | 4680.7 samples/s | 73.1 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00029 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.711 | acc=1.0000 | 4627.3 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35140 | acc=0.8094 | tpr=0.7254 | fpr=0.0082 | 4383.3 samples/s | 17.1 steps/s
Avg test loss: 0.35629, Avg test acc: 0.80892, Avg tpr: 0.72577, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.45423 | acc=0.8639 | tpr=0.9513 | fpr=0.1377 | 4413.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.45607 | acc=0.8661 | tpr=0.9616 | fpr=0.1357 | 8879.8 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.46234 | acc=0.8654 | tpr=0.9669 | fpr=0.1364 | 8733.0 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.46552 | acc=0.8651 | tpr=0.9672 | fpr=0.1368 | 9109.5 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.46103 | acc=0.8650 | tpr=0.9651 | fpr=0.1369 | 8759.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.46240 | acc=0.8655 | tpr=0.9644 | fpr=0.1363 | 8694.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.46513 | acc=0.8656 | tpr=0.9643 | fpr=0.1362 | 8908.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.46547 | acc=0.8657 | tpr=0.9644 | fpr=0.1361 | 8469.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.47036 | acc=0.8654 | tpr=0.9640 | fpr=0.1364 | 8906.0 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.47070 | acc=0.8647 | tpr=0.9634 | fpr=0.1371 | 8871.8 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.46877 | acc=0.8651 | tpr=0.9642 | fpr=0.1367 | 16028.3 samples/s | 62.6 steps/s
Avg test loss: 0.46835, Avg test acc: 0.86511, Avg tpr: 0.96434, Avg fpr: 0.13670, total FA: 18980

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.21843 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.739 | acc=0.8750 | 3614.1 samples/s | 56.5 steps/s
[Step=19250 Epoch=18.8] | Loss=0.03476 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.728 | acc=1.0000 | 4942.7 samples/s | 77.2 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02337 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=2.732 | acc=0.9844 | 4929.3 samples/s | 77.0 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01974 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.738 | acc=1.0000 | 4891.3 samples/s | 76.4 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01849 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.742 | acc=0.9844 | 4890.5 samples/s | 76.4 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01660 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=2.745 | acc=1.0000 | 4819.0 samples/s | 75.3 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01602 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.748 | acc=1.0000 | 4752.9 samples/s | 74.3 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01605 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.751 | acc=1.0000 | 4903.9 samples/s | 76.6 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01549 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.754 | acc=1.0000 | 4958.9 samples/s | 77.5 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01535 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=2.756 | acc=1.0000 | 4964.5 samples/s | 77.6 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01528 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.758 | acc=1.0000 | 5045.1 samples/s | 78.8 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01469 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.761 | acc=1.0000 | 4900.1 samples/s | 76.6 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01449 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=2.763 | acc=0.9844 | 4951.6 samples/s | 77.4 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01462 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.765 | acc=1.0000 | 4879.5 samples/s | 76.2 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01442 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.767 | acc=1.0000 | 4912.7 samples/s | 76.8 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01430 | Reg=0.00204 | L2-Norm=14.265 | L2-Norm(final)=2.769 | acc=1.0000 | 4955.3 samples/s | 77.4 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01419 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=2.770 | acc=1.0000 | 4068.8 samples/s | 63.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.07265 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.739 | acc=0.9531 | 2951.3 samples/s | 46.1 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00255 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=2.739 | acc=1.0000 | 4574.3 samples/s | 71.5 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00205 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.741 | acc=1.0000 | 4728.9 samples/s | 73.9 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00146 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.740 | acc=1.0000 | 4620.1 samples/s | 72.2 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00115 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=2.741 | acc=1.0000 | 4643.7 samples/s | 72.6 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00092 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=2.741 | acc=1.0000 | 4660.5 samples/s | 72.8 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00077 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.742 | acc=1.0000 | 4668.6 samples/s | 72.9 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00071 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.743 | acc=1.0000 | 4871.8 samples/s | 76.1 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00062 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=2.744 | acc=1.0000 | 4716.5 samples/s | 73.7 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00056 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=2.744 | acc=1.0000 | 4668.1 samples/s | 72.9 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00050 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.745 | acc=1.0000 | 4834.7 samples/s | 75.5 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00046 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.746 | acc=1.0000 | 1475.7 samples/s | 23.1 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.746 | acc=1.0000 | 4769.8 samples/s | 74.5 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00039 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.747 | acc=1.0000 | 4712.0 samples/s | 73.6 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00036 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.747 | acc=1.0000 | 4600.7 samples/s | 71.9 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00034 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.748 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00032 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.748 | acc=1.0000 | 4571.2 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54510 | acc=0.7279 | tpr=0.6051 | fpr=0.0055 | 4408.4 samples/s | 17.2 steps/s
Avg test loss: 0.54997, Avg test acc: 0.72530, Avg tpr: 0.60279, Avg fpr: 0.00526, total FA: 41

Testing server on iccad2012
[Step=  50] | Loss=0.32054 | acc=0.9195 | tpr=0.9513 | fpr=0.0810 | 4427.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.32477 | acc=0.9196 | tpr=0.9638 | fpr=0.0812 | 8878.2 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.32989 | acc=0.9182 | tpr=0.9697 | fpr=0.0828 | 10025.3 samples/s | 39.2 steps/s
[Step= 200] | Loss=0.33336 | acc=0.9182 | tpr=0.9705 | fpr=0.0827 | 7862.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.32799 | acc=0.9183 | tpr=0.9677 | fpr=0.0826 | 8958.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.33062 | acc=0.9183 | tpr=0.9673 | fpr=0.0825 | 8713.9 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.33373 | acc=0.9180 | tpr=0.9674 | fpr=0.0829 | 8818.0 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.33509 | acc=0.9180 | tpr=0.9677 | fpr=0.0829 | 8760.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.33956 | acc=0.9178 | tpr=0.9674 | fpr=0.0831 | 8654.0 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.33888 | acc=0.9173 | tpr=0.9665 | fpr=0.0836 | 8723.6 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.33703 | acc=0.9176 | tpr=0.9674 | fpr=0.0833 | 16589.3 samples/s | 64.8 steps/s
Avg test loss: 0.33660, Avg test acc: 0.91760, Avg tpr: 0.96751, Avg fpr: 0.08331, total FA: 11567

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.31834 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.774 | acc=0.8750 | 3607.6 samples/s | 56.4 steps/s
[Step=20050 Epoch=19.6] | Loss=0.04348 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.761 | acc=0.9844 | 4809.0 samples/s | 75.1 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02761 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.766 | acc=0.9844 | 4871.8 samples/s | 76.1 steps/s
[Step=20150 Epoch=19.7] | Loss=0.02269 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.772 | acc=1.0000 | 4973.0 samples/s | 77.7 steps/s
[Step=20200 Epoch=19.7] | Loss=0.02074 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.777 | acc=1.0000 | 4701.3 samples/s | 73.5 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01889 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.780 | acc=1.0000 | 4915.6 samples/s | 76.8 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01792 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=2.784 | acc=0.9844 | 4821.7 samples/s | 75.3 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01720 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.788 | acc=1.0000 | 4986.0 samples/s | 77.9 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01674 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.791 | acc=1.0000 | 4402.8 samples/s | 68.8 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01645 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.793 | acc=0.9688 | 3912.4 samples/s | 61.1 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01616 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=2.795 | acc=1.0000 | 3904.1 samples/s | 61.0 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01570 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=2.797 | acc=1.0000 | 3858.1 samples/s | 60.3 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01537 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.799 | acc=0.9688 | 3922.0 samples/s | 61.3 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01519 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.801 | acc=0.9844 | 3850.3 samples/s | 60.2 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01506 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.803 | acc=1.0000 | 3847.3 samples/s | 60.1 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01497 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=2.805 | acc=1.0000 | 3878.3 samples/s | 60.6 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01474 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.806 | acc=0.9844 | 3856.8 samples/s | 60.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.02198 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.774 | acc=0.9844 | 3751.9 samples/s | 58.6 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00103 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.781 | acc=1.0000 | 4488.3 samples/s | 70.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00056 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.782 | acc=1.0000 | 4616.5 samples/s | 72.1 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00038 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=2.783 | acc=1.0000 | 4712.9 samples/s | 73.6 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00030 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.784 | acc=1.0000 | 4575.6 samples/s | 71.5 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00024 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.785 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00020 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=2.786 | acc=1.0000 | 4775.8 samples/s | 74.6 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00017 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=2.787 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00015 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.788 | acc=1.0000 | 4683.7 samples/s | 73.2 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00014 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=2.788 | acc=1.0000 | 4637.3 samples/s | 72.5 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00012 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=2.789 | acc=1.0000 | 4739.4 samples/s | 74.1 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00011 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.790 | acc=1.0000 | 1573.9 samples/s | 24.6 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00010 | Reg=0.00199 | L2-Norm=14.111 | L2-Norm(final)=2.790 | acc=1.0000 | 4810.3 samples/s | 75.2 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00010 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=2.791 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00009 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=2.791 | acc=1.0000 | 4627.2 samples/s | 72.3 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00008 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=2.792 | acc=1.0000 | 4637.1 samples/s | 72.5 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00008 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=2.792 | acc=1.0000 | 4606.6 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22938 | acc=0.8626 | tpr=0.8031 | fpr=0.0082 | 4413.4 samples/s | 17.2 steps/s
Avg test loss: 0.23463, Avg test acc: 0.85980, Avg tpr: 0.80020, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.58691 | acc=0.8159 | tpr=0.9602 | fpr=0.1867 | 4427.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.58844 | acc=0.8195 | tpr=0.9701 | fpr=0.1834 | 8911.2 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.59612 | acc=0.8182 | tpr=0.9769 | fpr=0.1847 | 8703.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.59906 | acc=0.8185 | tpr=0.9770 | fpr=0.1844 | 9148.9 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.59400 | acc=0.8185 | tpr=0.9738 | fpr=0.1843 | 8510.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.59508 | acc=0.8190 | tpr=0.9724 | fpr=0.1838 | 8961.2 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.59824 | acc=0.8189 | tpr=0.9718 | fpr=0.1839 | 8752.4 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.59884 | acc=0.8191 | tpr=0.9726 | fpr=0.1836 | 9222.5 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.60346 | acc=0.8188 | tpr=0.9713 | fpr=0.1839 | 8436.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.60394 | acc=0.8182 | tpr=0.9705 | fpr=0.1846 | 8922.6 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.60156 | acc=0.8185 | tpr=0.9713 | fpr=0.1843 | 15524.7 samples/s | 60.6 steps/s
Avg test loss: 0.60114, Avg test acc: 0.81858, Avg tpr: 0.97147, Avg fpr: 0.18420, total FA: 25576

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.12184 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.814 | acc=0.9062 | 3779.2 samples/s | 59.0 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02123 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=2.813 | acc=1.0000 | 4575.3 samples/s | 71.5 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01522 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.819 | acc=1.0000 | 4903.6 samples/s | 76.6 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01466 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=2.823 | acc=1.0000 | 4860.0 samples/s | 75.9 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01412 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.826 | acc=0.9844 | 4773.1 samples/s | 74.6 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01348 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.828 | acc=0.9844 | 4791.0 samples/s | 74.9 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01322 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.831 | acc=1.0000 | 3861.9 samples/s | 60.3 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01306 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.833 | acc=1.0000 | 3849.3 samples/s | 60.1 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01298 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.835 | acc=0.9844 | 3885.8 samples/s | 60.7 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01299 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=2.837 | acc=1.0000 | 3832.8 samples/s | 59.9 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01268 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.839 | acc=0.9844 | 3908.5 samples/s | 61.1 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01246 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=2.841 | acc=1.0000 | 3913.4 samples/s | 61.1 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01222 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=2.842 | acc=0.9844 | 3881.1 samples/s | 60.6 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01225 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.844 | acc=0.9688 | 3888.7 samples/s | 60.8 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01224 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=2.846 | acc=1.0000 | 3856.4 samples/s | 60.3 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01230 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=2.847 | acc=0.9844 | 3822.7 samples/s | 59.7 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01233 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=2.849 | acc=0.9531 | 3876.1 samples/s | 60.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.09590 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.812 | acc=0.9531 | 3865.1 samples/s | 60.4 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00505 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.805 | acc=1.0000 | 4274.2 samples/s | 66.8 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00259 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.809 | acc=1.0000 | 4722.3 samples/s | 73.8 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00174 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.811 | acc=1.0000 | 4634.4 samples/s | 72.4 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00132 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.813 | acc=1.0000 | 4807.3 samples/s | 75.1 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00107 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.815 | acc=1.0000 | 4628.1 samples/s | 72.3 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00090 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.817 | acc=1.0000 | 4561.7 samples/s | 71.3 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00078 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=2.819 | acc=1.0000 | 4718.0 samples/s | 73.7 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00068 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=2.821 | acc=1.0000 | 4737.8 samples/s | 74.0 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00061 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.822 | acc=1.0000 | 4785.7 samples/s | 74.8 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00055 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.823 | acc=1.0000 | 4486.6 samples/s | 70.1 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00050 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=2.824 | acc=1.0000 | 1496.1 samples/s | 23.4 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00046 | Reg=0.00200 | L2-Norm=14.126 | L2-Norm(final)=2.825 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00042 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.826 | acc=1.0000 | 4850.9 samples/s | 75.8 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00039 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.826 | acc=1.0000 | 4476.2 samples/s | 69.9 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00037 | Reg=0.00199 | L2-Norm=14.109 | L2-Norm(final)=2.827 | acc=1.0000 | 4642.3 samples/s | 72.5 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00034 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=2.827 | acc=1.0000 | 4644.1 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44337 | acc=0.7568 | tpr=0.6480 | fpr=0.0069 | 4366.2 samples/s | 17.1 steps/s
Avg test loss: 0.45331, Avg test acc: 0.75234, Avg tpr: 0.64324, Avg fpr: 0.00769, total FA: 60

Testing server on iccad2012
[Step=  50] | Loss=0.34869 | acc=0.9066 | tpr=0.9513 | fpr=0.0942 | 4460.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.35397 | acc=0.9065 | tpr=0.9659 | fpr=0.0946 | 8671.4 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.35963 | acc=0.9051 | tpr=0.9726 | fpr=0.0962 | 8693.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.36438 | acc=0.9048 | tpr=0.9727 | fpr=0.0964 | 9278.1 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.36035 | acc=0.9047 | tpr=0.9703 | fpr=0.0965 | 8841.0 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.36298 | acc=0.9051 | tpr=0.9680 | fpr=0.0961 | 8994.7 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.36512 | acc=0.9048 | tpr=0.9681 | fpr=0.0963 | 8826.4 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.36623 | acc=0.9051 | tpr=0.9694 | fpr=0.0961 | 8451.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.37079 | acc=0.9049 | tpr=0.9684 | fpr=0.0963 | 8744.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.37044 | acc=0.9045 | tpr=0.9670 | fpr=0.0966 | 9970.2 samples/s | 38.9 steps/s
[Step= 550] | Loss=0.36867 | acc=0.9050 | tpr=0.9682 | fpr=0.0962 | 13108.5 samples/s | 51.2 steps/s
Avg test loss: 0.36826, Avg test acc: 0.90499, Avg tpr: 0.96830, Avg fpr: 0.09616, total FA: 13352

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.20800 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=2.851 | acc=0.8438 | 3512.8 samples/s | 54.9 steps/s
[Step=21650 Epoch=21.1] | Loss=0.03812 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.839 | acc=0.9688 | 5020.8 samples/s | 78.5 steps/s
[Step=21700 Epoch=21.2] | Loss=0.02640 | Reg=0.00199 | L2-Norm=14.122 | L2-Norm(final)=2.844 | acc=1.0000 | 4948.8 samples/s | 77.3 steps/s
[Step=21750 Epoch=21.2] | Loss=0.02136 | Reg=0.00200 | L2-Norm=14.129 | L2-Norm(final)=2.850 | acc=1.0000 | 4897.0 samples/s | 76.5 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01850 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.855 | acc=0.9688 | 4885.4 samples/s | 76.3 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01680 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=2.860 | acc=0.9844 | 4864.0 samples/s | 76.0 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01567 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=2.864 | acc=1.0000 | 5017.1 samples/s | 78.4 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01500 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=2.867 | acc=1.0000 | 4795.5 samples/s | 74.9 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01468 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.871 | acc=0.9531 | 4840.9 samples/s | 75.6 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01417 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.874 | acc=1.0000 | 5016.3 samples/s | 78.4 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01384 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=2.877 | acc=0.9688 | 4952.6 samples/s | 77.4 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01366 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.879 | acc=1.0000 | 4712.8 samples/s | 73.6 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01348 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.882 | acc=0.9844 | 3870.6 samples/s | 60.5 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01323 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=2.884 | acc=0.9844 | 3854.3 samples/s | 60.2 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01306 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=2.886 | acc=1.0000 | 3857.4 samples/s | 60.3 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01297 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.889 | acc=0.9844 | 3844.5 samples/s | 60.1 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01301 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.890 | acc=0.9844 | 3922.2 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.01097 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=2.853 | acc=1.0000 | 3673.1 samples/s | 57.4 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00080 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.863 | acc=1.0000 | 4400.8 samples/s | 68.8 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00047 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=2.867 | acc=1.0000 | 4596.3 samples/s | 71.8 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00031 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=2.869 | acc=1.0000 | 4653.3 samples/s | 72.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00024 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=2.871 | acc=1.0000 | 4575.2 samples/s | 71.5 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00019 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.872 | acc=1.0000 | 4562.6 samples/s | 71.3 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00016 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=2.872 | acc=1.0000 | 4741.6 samples/s | 74.1 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00014 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.873 | acc=1.0000 | 4592.2 samples/s | 71.8 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00012 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.874 | acc=1.0000 | 4651.0 samples/s | 72.7 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00012 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=2.874 | acc=1.0000 | 4634.2 samples/s | 72.4 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00010 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.875 | acc=1.0000 | 4736.2 samples/s | 74.0 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00010 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.876 | acc=1.0000 | 1521.5 samples/s | 23.8 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00009 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.876 | acc=1.0000 | 4792.0 samples/s | 74.9 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00008 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.877 | acc=1.0000 | 4793.5 samples/s | 74.9 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00008 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=2.877 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00007 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.878 | acc=1.0000 | 4790.0 samples/s | 74.8 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00007 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.878 | acc=1.0000 | 4726.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29711 | acc=0.8298 | tpr=0.7557 | fpr=0.0094 | 4404.8 samples/s | 17.2 steps/s
Avg test loss: 0.30323, Avg test acc: 0.82899, Avg tpr: 0.75561, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.48118 | acc=0.8610 | tpr=0.9513 | fpr=0.1406 | 4378.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.48574 | acc=0.8647 | tpr=0.9659 | fpr=0.1372 | 9273.7 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.49197 | acc=0.8637 | tpr=0.9741 | fpr=0.1383 | 8674.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.49598 | acc=0.8637 | tpr=0.9738 | fpr=0.1383 | 8694.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.49171 | acc=0.8636 | tpr=0.9703 | fpr=0.1383 | 8793.4 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.49382 | acc=0.8641 | tpr=0.9687 | fpr=0.1378 | 8858.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.49634 | acc=0.8642 | tpr=0.9687 | fpr=0.1377 | 9017.3 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.49686 | acc=0.8647 | tpr=0.9705 | fpr=0.1372 | 8529.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.50092 | acc=0.8648 | tpr=0.9703 | fpr=0.1372 | 8876.8 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.50151 | acc=0.8641 | tpr=0.9687 | fpr=0.1378 | 8620.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.49927 | acc=0.8644 | tpr=0.9690 | fpr=0.1375 | 17478.7 samples/s | 68.3 steps/s
Avg test loss: 0.49879, Avg test acc: 0.86444, Avg tpr: 0.96910, Avg fpr: 0.13747, total FA: 19087

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.21280 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.898 | acc=0.8906 | 3879.6 samples/s | 60.6 steps/s
[Step=22450 Epoch=21.9] | Loss=0.02506 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=2.895 | acc=1.0000 | 4493.5 samples/s | 70.2 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01844 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.901 | acc=0.9688 | 4918.6 samples/s | 76.9 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01577 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=2.905 | acc=0.9844 | 4893.2 samples/s | 76.5 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01429 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=2.909 | acc=1.0000 | 4756.0 samples/s | 74.3 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01392 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.913 | acc=1.0000 | 4900.2 samples/s | 76.6 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01334 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=2.916 | acc=1.0000 | 4763.8 samples/s | 74.4 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01325 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.918 | acc=1.0000 | 4956.0 samples/s | 77.4 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01309 | Reg=0.00198 | L2-Norm=14.070 | L2-Norm(final)=2.920 | acc=0.9688 | 4849.2 samples/s | 75.8 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01303 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=2.923 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01272 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.925 | acc=1.0000 | 4971.4 samples/s | 77.7 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01254 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=2.927 | acc=1.0000 | 4882.3 samples/s | 76.3 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01224 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=2.930 | acc=0.9844 | 4870.2 samples/s | 76.1 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01226 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=2.932 | acc=0.9688 | 4863.9 samples/s | 76.0 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01238 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=2.934 | acc=1.0000 | 3916.8 samples/s | 61.2 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01265 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=2.935 | acc=1.0000 | 3884.0 samples/s | 60.7 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01259 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.936 | acc=1.0000 | 3921.8 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.08471 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.898 | acc=0.9375 | 3913.5 samples/s | 61.1 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00295 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.896 | acc=1.0000 | 4132.1 samples/s | 64.6 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00160 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.898 | acc=1.0000 | 4652.6 samples/s | 72.7 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00118 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.899 | acc=1.0000 | 4628.3 samples/s | 72.3 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00090 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=2.899 | acc=1.0000 | 4695.0 samples/s | 73.4 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00097 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.898 | acc=1.0000 | 4544.0 samples/s | 71.0 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00082 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.897 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00073 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.897 | acc=1.0000 | 4682.3 samples/s | 73.2 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00096 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=2.896 | acc=1.0000 | 4653.7 samples/s | 72.7 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00104 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=2.894 | acc=1.0000 | 4603.7 samples/s | 71.9 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00102 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.892 | acc=1.0000 | 4774.5 samples/s | 74.6 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00095 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.890 | acc=1.0000 | 1630.7 samples/s | 25.5 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00088 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.888 | acc=1.0000 | 4778.2 samples/s | 74.7 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00081 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.887 | acc=1.0000 | 4892.9 samples/s | 76.5 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00076 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.886 | acc=1.0000 | 4594.6 samples/s | 71.8 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00071 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=2.885 | acc=1.0000 | 4485.4 samples/s | 70.1 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00066 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=2.885 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45809 | acc=0.7584 | tpr=0.6514 | fpr=0.0094 | 4358.7 samples/s | 17.0 steps/s
Avg test loss: 0.46123, Avg test acc: 0.75803, Avg tpr: 0.65204, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.35847 | acc=0.9141 | tpr=0.9513 | fpr=0.0866 | 4387.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.36414 | acc=0.9138 | tpr=0.9638 | fpr=0.0871 | 8577.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.36880 | acc=0.9126 | tpr=0.9712 | fpr=0.0885 | 8864.6 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.37319 | acc=0.9125 | tpr=0.9716 | fpr=0.0886 | 8853.3 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.36925 | acc=0.9126 | tpr=0.9703 | fpr=0.0885 | 8822.8 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.37244 | acc=0.9124 | tpr=0.9695 | fpr=0.0886 | 8738.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.37543 | acc=0.9120 | tpr=0.9693 | fpr=0.0890 | 8762.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.37716 | acc=0.9120 | tpr=0.9699 | fpr=0.0891 | 8558.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.38141 | acc=0.9118 | tpr=0.9693 | fpr=0.0892 | 9056.9 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.38101 | acc=0.9113 | tpr=0.9678 | fpr=0.0897 | 8543.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.37976 | acc=0.9117 | tpr=0.9686 | fpr=0.0893 | 16295.7 samples/s | 63.7 steps/s
Avg test loss: 0.37929, Avg test acc: 0.91175, Avg tpr: 0.96870, Avg fpr: 0.08928, total FA: 12397

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.26208 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=2.915 | acc=0.8750 | 3596.1 samples/s | 56.2 steps/s
[Step=23250 Epoch=22.7] | Loss=0.04170 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.902 | acc=0.9688 | 4892.3 samples/s | 76.4 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02790 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=2.908 | acc=1.0000 | 4814.6 samples/s | 75.2 steps/s
[Step=23350 Epoch=22.8] | Loss=0.02271 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=2.912 | acc=1.0000 | 4876.5 samples/s | 76.2 steps/s
[Step=23400 Epoch=22.8] | Loss=0.02002 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=2.917 | acc=1.0000 | 4821.5 samples/s | 75.3 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01833 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.921 | acc=0.9688 | 4961.9 samples/s | 77.5 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01741 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=2.923 | acc=1.0000 | 4762.4 samples/s | 74.4 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01645 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.926 | acc=1.0000 | 4783.3 samples/s | 74.7 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01563 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=2.929 | acc=0.9844 | 4873.6 samples/s | 76.2 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01509 | Reg=0.00199 | L2-Norm=14.112 | L2-Norm(final)=2.932 | acc=0.9844 | 4916.3 samples/s | 76.8 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01458 | Reg=0.00199 | L2-Norm=14.115 | L2-Norm(final)=2.935 | acc=0.9844 | 4889.5 samples/s | 76.4 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01425 | Reg=0.00199 | L2-Norm=14.117 | L2-Norm(final)=2.937 | acc=1.0000 | 4843.9 samples/s | 75.7 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01416 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.939 | acc=1.0000 | 4756.5 samples/s | 74.3 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01404 | Reg=0.00199 | L2-Norm=14.122 | L2-Norm(final)=2.942 | acc=1.0000 | 4880.0 samples/s | 76.3 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01386 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.944 | acc=0.9844 | 4730.4 samples/s | 73.9 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01400 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=2.946 | acc=0.9688 | 3902.5 samples/s | 61.0 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01390 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.948 | acc=1.0000 | 3854.0 samples/s | 60.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.00754 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=2.916 | acc=0.9844 | 3651.1 samples/s | 57.0 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00153 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.916 | acc=1.0000 | 4393.3 samples/s | 68.6 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00081 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.917 | acc=1.0000 | 4655.0 samples/s | 72.7 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00074 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.918 | acc=1.0000 | 4637.2 samples/s | 72.5 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00056 | Reg=0.00197 | L2-Norm=14.038 | L2-Norm(final)=2.918 | acc=1.0000 | 4590.1 samples/s | 71.7 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00045 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=2.919 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00038 | Reg=0.00197 | L2-Norm=14.032 | L2-Norm(final)=2.919 | acc=1.0000 | 4676.8 samples/s | 73.1 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00033 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.919 | acc=1.0000 | 4681.6 samples/s | 73.2 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00029 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.920 | acc=1.0000 | 4582.4 samples/s | 71.6 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00026 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=2.920 | acc=1.0000 | 4731.2 samples/s | 73.9 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00023 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=2.920 | acc=1.0000 | 4758.5 samples/s | 74.4 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00021 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.921 | acc=1.0000 | 1471.6 samples/s | 23.0 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00019 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=2.921 | acc=1.0000 | 4734.8 samples/s | 74.0 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00018 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=2.921 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00017 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=2.922 | acc=1.0000 | 4651.1 samples/s | 72.7 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00016 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.922 | acc=1.0000 | 4637.6 samples/s | 72.5 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00015 | Reg=0.00196 | L2-Norm=13.991 | L2-Norm(final)=2.922 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29262 | acc=0.8272 | tpr=0.7518 | fpr=0.0092 | 4395.8 samples/s | 17.2 steps/s
Avg test loss: 0.29885, Avg test acc: 0.82539, Avg tpr: 0.75007, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.48261 | acc=0.8593 | tpr=0.9469 | fpr=0.1423 | 4392.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.48731 | acc=0.8605 | tpr=0.9595 | fpr=0.1414 | 7518.2 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.49441 | acc=0.8583 | tpr=0.9683 | fpr=0.1437 | 8195.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.49815 | acc=0.8584 | tpr=0.9683 | fpr=0.1436 | 9027.6 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.49395 | acc=0.8580 | tpr=0.9659 | fpr=0.1440 | 9255.5 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.49665 | acc=0.8581 | tpr=0.9651 | fpr=0.1439 | 8575.2 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.49996 | acc=0.8580 | tpr=0.9656 | fpr=0.1440 | 8638.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.50104 | acc=0.8580 | tpr=0.9661 | fpr=0.1440 | 8585.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.50500 | acc=0.8581 | tpr=0.9669 | fpr=0.1439 | 8673.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.50530 | acc=0.8576 | tpr=0.9661 | fpr=0.1444 | 8843.1 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.50370 | acc=0.8580 | tpr=0.9670 | fpr=0.1440 | 16014.6 samples/s | 62.6 steps/s
Avg test loss: 0.50334, Avg test acc: 0.85800, Avg tpr: 0.96712, Avg fpr: 0.14398, total FA: 19992

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.09123 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=2.950 | acc=0.9062 | 3586.5 samples/s | 56.0 steps/s
[Step=24050 Epoch=23.5] | Loss=0.02728 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.952 | acc=1.0000 | 4379.4 samples/s | 68.4 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01955 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.955 | acc=0.9844 | 4563.7 samples/s | 71.3 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01551 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=2.957 | acc=1.0000 | 4404.0 samples/s | 68.8 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01370 | Reg=0.00197 | L2-Norm=14.038 | L2-Norm(final)=2.960 | acc=0.9844 | 4419.2 samples/s | 69.1 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01216 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.963 | acc=1.0000 | 4795.4 samples/s | 74.9 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01188 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.965 | acc=1.0000 | 4900.1 samples/s | 76.6 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01122 | Reg=0.00197 | L2-Norm=14.041 | L2-Norm(final)=2.967 | acc=0.9844 | 4958.4 samples/s | 77.5 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01106 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=2.969 | acc=0.9688 | 4816.0 samples/s | 75.3 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01116 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.971 | acc=1.0000 | 4938.2 samples/s | 77.2 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01092 | Reg=0.00197 | L2-Norm=14.044 | L2-Norm(final)=2.972 | acc=1.0000 | 4823.3 samples/s | 75.4 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01065 | Reg=0.00197 | L2-Norm=14.045 | L2-Norm(final)=2.974 | acc=1.0000 | 4814.8 samples/s | 75.2 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01067 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=2.975 | acc=1.0000 | 4846.1 samples/s | 75.7 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01045 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.977 | acc=1.0000 | 4851.5 samples/s | 75.8 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01043 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.979 | acc=0.9844 | 4751.8 samples/s | 74.2 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01029 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=2.980 | acc=1.0000 | 4796.7 samples/s | 74.9 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01016 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=2.982 | acc=1.0000 | 4867.0 samples/s | 76.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.00199 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=2.950 | acc=1.0000 | 3324.7 samples/s | 51.9 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00478 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.949 | acc=1.0000 | 4722.6 samples/s | 73.8 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00246 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.949 | acc=1.0000 | 4678.1 samples/s | 73.1 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00165 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.950 | acc=1.0000 | 4619.4 samples/s | 72.2 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00128 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.950 | acc=1.0000 | 4689.5 samples/s | 73.3 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00103 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.951 | acc=1.0000 | 4757.3 samples/s | 74.3 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00086 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=2.952 | acc=1.0000 | 4616.6 samples/s | 72.1 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00074 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=2.952 | acc=1.0000 | 4620.9 samples/s | 72.2 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00065 | Reg=0.00196 | L2-Norm=14.018 | L2-Norm(final)=2.952 | acc=1.0000 | 4618.8 samples/s | 72.2 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00058 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.953 | acc=1.0000 | 4624.2 samples/s | 72.3 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00053 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.953 | acc=1.0000 | 4711.4 samples/s | 73.6 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00048 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.953 | acc=1.0000 | 1474.3 samples/s | 23.0 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00044 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.954 | acc=1.0000 | 4758.3 samples/s | 74.3 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00041 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=2.954 | acc=1.0000 | 4575.9 samples/s | 71.5 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00038 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.954 | acc=1.0000 | 4607.6 samples/s | 72.0 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00035 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=2.954 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00033 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=2.955 | acc=1.0000 | 4578.2 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30002 | acc=0.8326 | tpr=0.7591 | fpr=0.0079 | 4457.6 samples/s | 17.4 steps/s
Avg test loss: 0.30802, Avg test acc: 0.83072, Avg tpr: 0.75800, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.44297 | acc=0.8807 | tpr=0.9469 | fpr=0.1205 | 4414.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.44705 | acc=0.8803 | tpr=0.9595 | fpr=0.1212 | 8853.2 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.45349 | acc=0.8786 | tpr=0.9669 | fpr=0.1231 | 8691.6 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.45709 | acc=0.8786 | tpr=0.9672 | fpr=0.1230 | 8764.2 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.45294 | acc=0.8786 | tpr=0.9642 | fpr=0.1230 | 8899.8 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.45531 | acc=0.8789 | tpr=0.9644 | fpr=0.1227 | 8786.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.45770 | acc=0.8789 | tpr=0.9649 | fpr=0.1227 | 8766.9 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.45833 | acc=0.8793 | tpr=0.9661 | fpr=0.1223 | 8843.5 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.46239 | acc=0.8794 | tpr=0.9664 | fpr=0.1222 | 8692.0 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.46257 | acc=0.8789 | tpr=0.9652 | fpr=0.1227 | 8465.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.46135 | acc=0.8792 | tpr=0.9658 | fpr=0.1223 | 17221.9 samples/s | 67.3 steps/s
Avg test loss: 0.46100, Avg test acc: 0.87925, Avg tpr: 0.96593, Avg fpr: 0.12232, total FA: 16984

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.15145 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.981 | acc=0.9062 | 3737.1 samples/s | 58.4 steps/s
[Step=24850 Epoch=24.3] | Loss=0.03127 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.975 | acc=1.0000 | 5041.3 samples/s | 78.8 steps/s
[Step=24900 Epoch=24.3] | Loss=0.02041 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=2.977 | acc=0.9844 | 4834.4 samples/s | 75.5 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01673 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=2.979 | acc=1.0000 | 4735.9 samples/s | 74.0 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01464 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.981 | acc=0.9844 | 4372.4 samples/s | 68.3 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01357 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.984 | acc=0.9844 | 3827.9 samples/s | 59.8 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01257 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.987 | acc=0.9844 | 3854.4 samples/s | 60.2 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01210 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.989 | acc=0.9844 | 3947.3 samples/s | 61.7 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01185 | Reg=0.00197 | L2-Norm=14.030 | L2-Norm(final)=2.991 | acc=0.9844 | 3834.5 samples/s | 59.9 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01125 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=2.993 | acc=1.0000 | 3849.3 samples/s | 60.1 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01081 | Reg=0.00197 | L2-Norm=14.032 | L2-Norm(final)=2.995 | acc=1.0000 | 3839.8 samples/s | 60.0 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01049 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.997 | acc=1.0000 | 3923.8 samples/s | 61.3 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01034 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=2.999 | acc=1.0000 | 3875.6 samples/s | 60.6 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01007 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=3.001 | acc=1.0000 | 3866.9 samples/s | 60.4 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00998 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=3.003 | acc=0.9688 | 3849.3 samples/s | 60.1 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01001 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=3.004 | acc=0.9844 | 3879.5 samples/s | 60.6 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01003 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=3.005 | acc=0.9844 | 3891.2 samples/s | 60.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.05840 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.981 | acc=0.9688 | 2943.4 samples/s | 46.0 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00397 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.984 | acc=1.0000 | 4592.1 samples/s | 71.8 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00200 | Reg=0.00197 | L2-Norm=14.020 | L2-Norm(final)=2.985 | acc=1.0000 | 4581.6 samples/s | 71.6 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00135 | Reg=0.00197 | L2-Norm=14.020 | L2-Norm(final)=2.985 | acc=1.0000 | 4522.2 samples/s | 70.7 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00102 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=2.986 | acc=1.0000 | 4712.5 samples/s | 73.6 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00082 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=2.986 | acc=1.0000 | 4581.4 samples/s | 71.6 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00068 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.986 | acc=1.0000 | 4593.1 samples/s | 71.8 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00059 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.987 | acc=1.0000 | 4786.8 samples/s | 74.8 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00052 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.987 | acc=1.0000 | 4552.6 samples/s | 71.1 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00046 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=2.987 | acc=1.0000 | 4661.2 samples/s | 72.8 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00042 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=2.987 | acc=1.0000 | 4767.3 samples/s | 74.5 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00038 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.988 | acc=1.0000 | 1461.8 samples/s | 22.8 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00035 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=2.988 | acc=1.0000 | 4655.7 samples/s | 72.7 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00032 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=2.988 | acc=1.0000 | 4708.4 samples/s | 73.6 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00030 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.988 | acc=1.0000 | 4689.3 samples/s | 73.3 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00028 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=2.989 | acc=1.0000 | 4706.1 samples/s | 73.5 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00026 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=2.989 | acc=1.0000 | 4620.0 samples/s | 72.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32160 | acc=0.8247 | tpr=0.7469 | fpr=0.0064 | 4349.5 samples/s | 17.0 steps/s
Avg test loss: 0.33091, Avg test acc: 0.82130, Avg tpr: 0.74384, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.42575 | acc=0.8839 | tpr=0.9469 | fpr=0.1172 | 4378.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.43017 | acc=0.8846 | tpr=0.9616 | fpr=0.1169 | 8922.3 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.43677 | acc=0.8832 | tpr=0.9697 | fpr=0.1184 | 8887.5 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.44108 | acc=0.8831 | tpr=0.9705 | fpr=0.1185 | 8837.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.43732 | acc=0.8832 | tpr=0.9668 | fpr=0.1183 | 8817.5 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.43977 | acc=0.8837 | tpr=0.9665 | fpr=0.1179 | 8841.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.44187 | acc=0.8839 | tpr=0.9668 | fpr=0.1176 | 8595.8 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.44269 | acc=0.8842 | tpr=0.9677 | fpr=0.1173 | 8778.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.44681 | acc=0.8841 | tpr=0.9669 | fpr=0.1174 | 8592.7 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.44703 | acc=0.8837 | tpr=0.9665 | fpr=0.1178 | 8552.3 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.44550 | acc=0.8841 | tpr=0.9670 | fpr=0.1174 | 17292.7 samples/s | 67.5 steps/s
Avg test loss: 0.44516, Avg test acc: 0.88407, Avg tpr: 0.96712, Avg fpr: 0.11744, total FA: 16306

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.27373 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=3.007 | acc=0.7969 | 3780.6 samples/s | 59.1 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02838 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=3.003 | acc=1.0000 | 4902.5 samples/s | 76.6 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01838 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=3.005 | acc=1.0000 | 4756.4 samples/s | 74.3 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01489 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=3.008 | acc=0.9688 | 4878.4 samples/s | 76.2 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01314 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=3.010 | acc=0.9844 | 4983.9 samples/s | 77.9 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01200 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=3.012 | acc=1.0000 | 4872.3 samples/s | 76.1 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01146 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=3.014 | acc=0.9688 | 4894.1 samples/s | 76.5 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01090 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=3.016 | acc=1.0000 | 5000.7 samples/s | 78.1 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01040 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=3.018 | acc=1.0000 | 4896.1 samples/s | 76.5 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01017 | Reg=0.00196 | L2-Norm=14.018 | L2-Norm(final)=3.020 | acc=0.9844 | 4894.3 samples/s | 76.5 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01006 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=3.022 | acc=1.0000 | 4878.8 samples/s | 76.2 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01007 | Reg=0.00197 | L2-Norm=14.020 | L2-Norm(final)=3.024 | acc=1.0000 | 4707.4 samples/s | 73.6 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01002 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=3.026 | acc=1.0000 | 3889.2 samples/s | 60.8 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00995 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=3.027 | acc=1.0000 | 3899.8 samples/s | 60.9 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00970 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=3.029 | acc=1.0000 | 3869.5 samples/s | 60.5 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00967 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=3.030 | acc=0.9844 | 3886.1 samples/s | 60.7 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00954 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=3.032 | acc=0.9844 | 3886.0 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.02857 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=3.007 | acc=0.9844 | 3639.4 samples/s | 56.9 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00543 | Reg=0.00196 | L2-Norm=13.999 | L2-Norm(final)=3.005 | acc=1.0000 | 4464.4 samples/s | 69.8 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00282 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=3.005 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00188 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=3.005 | acc=1.0000 | 4643.7 samples/s | 72.6 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00142 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=3.005 | acc=1.0000 | 4608.6 samples/s | 72.0 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00114 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=3.005 | acc=1.0000 | 4634.3 samples/s | 72.4 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00095 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=3.005 | acc=1.0000 | 4678.5 samples/s | 73.1 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00081 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=3.006 | acc=1.0000 | 4660.1 samples/s | 72.8 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00072 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=3.006 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00064 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=3.006 | acc=1.0000 | 4603.4 samples/s | 71.9 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00057 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=3.007 | acc=1.0000 | 4630.9 samples/s | 72.4 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00052 | Reg=0.00196 | L2-Norm=13.992 | L2-Norm(final)=3.007 | acc=1.0000 | 1456.0 samples/s | 22.7 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00048 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=3.007 | acc=1.0000 | 4838.5 samples/s | 75.6 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00044 | Reg=0.00196 | L2-Norm=13.988 | L2-Norm(final)=3.008 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00041 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=3.008 | acc=1.0000 | 4718.8 samples/s | 73.7 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00039 | Reg=0.00196 | L2-Norm=13.984 | L2-Norm(final)=3.008 | acc=1.0000 | 4555.4 samples/s | 71.2 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00036 | Reg=0.00195 | L2-Norm=13.982 | L2-Norm(final)=3.008 | acc=1.0000 | 4645.7 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35842 | acc=0.8077 | tpr=0.7224 | fpr=0.0072 | 4348.4 samples/s | 17.0 steps/s
Avg test loss: 0.36711, Avg test acc: 0.80668, Avg tpr: 0.72233, Avg fpr: 0.00782, total FA: 61

Testing server on iccad2012
[Step=  50] | Loss=0.40975 | acc=0.8920 | tpr=0.9425 | fpr=0.1090 | 4403.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.41223 | acc=0.8926 | tpr=0.9552 | fpr=0.1086 | 8713.2 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.41869 | acc=0.8916 | tpr=0.9625 | fpr=0.1097 | 8856.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.42277 | acc=0.8916 | tpr=0.9650 | fpr=0.1098 | 8779.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.41887 | acc=0.8916 | tpr=0.9624 | fpr=0.1097 | 8860.8 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.42132 | acc=0.8919 | tpr=0.9600 | fpr=0.1094 | 8723.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.42365 | acc=0.8918 | tpr=0.9612 | fpr=0.1095 | 8753.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.42448 | acc=0.8920 | tpr=0.9623 | fpr=0.1092 | 8894.8 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.42884 | acc=0.8917 | tpr=0.9620 | fpr=0.1095 | 8456.2 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.42892 | acc=0.8912 | tpr=0.9617 | fpr=0.1100 | 8556.5 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.42727 | acc=0.8916 | tpr=0.9626 | fpr=0.1097 | 17229.4 samples/s | 67.3 steps/s
Avg test loss: 0.42687, Avg test acc: 0.89163, Avg tpr: 0.96276, Avg fpr: 0.10967, total FA: 15227

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.33380 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.032 | acc=0.8125 | 3774.5 samples/s | 59.0 steps/s
[Step=26450 Epoch=25.8] | Loss=0.03222 | Reg=0.00196 | L2-Norm=13.989 | L2-Norm(final)=3.028 | acc=1.0000 | 4778.0 samples/s | 74.7 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01976 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=3.030 | acc=1.0000 | 4920.5 samples/s | 76.9 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01601 | Reg=0.00196 | L2-Norm=13.999 | L2-Norm(final)=3.033 | acc=1.0000 | 4848.3 samples/s | 75.8 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01353 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=3.036 | acc=0.9844 | 4944.5 samples/s | 77.3 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01254 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=3.039 | acc=1.0000 | 4812.0 samples/s | 75.2 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01176 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=3.042 | acc=0.9844 | 4852.5 samples/s | 75.8 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01113 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=3.044 | acc=1.0000 | 4895.5 samples/s | 76.5 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01075 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=3.047 | acc=1.0000 | 4766.5 samples/s | 74.5 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01068 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=3.049 | acc=1.0000 | 4901.3 samples/s | 76.6 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01035 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=3.050 | acc=1.0000 | 4865.5 samples/s | 76.0 steps/s
[Step=26950 Epoch=26.3] | Loss=0.01020 | Reg=0.00196 | L2-Norm=14.011 | L2-Norm(final)=3.052 | acc=1.0000 | 3902.6 samples/s | 61.0 steps/s
[Step=27000 Epoch=26.4] | Loss=0.01014 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=3.054 | acc=1.0000 | 3860.8 samples/s | 60.3 steps/s
[Step=27050 Epoch=26.4] | Loss=0.01017 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=3.055 | acc=0.9844 | 3860.7 samples/s | 60.3 steps/s
[Step=27100 Epoch=26.5] | Loss=0.01001 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=3.057 | acc=0.9844 | 3874.2 samples/s | 60.5 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00985 | Reg=0.00196 | L2-Norm=14.015 | L2-Norm(final)=3.058 | acc=0.9844 | 3813.0 samples/s | 59.6 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00978 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=3.060 | acc=1.0000 | 3877.5 samples/s | 60.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.00296 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.032 | acc=1.0000 | 2911.1 samples/s | 45.5 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00612 | Reg=0.00196 | L2-Norm=13.992 | L2-Norm(final)=3.034 | acc=1.0000 | 4310.6 samples/s | 67.4 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00307 | Reg=0.00196 | L2-Norm=13.997 | L2-Norm(final)=3.034 | acc=1.0000 | 4595.7 samples/s | 71.8 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00205 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=3.034 | acc=1.0000 | 4778.7 samples/s | 74.7 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00154 | Reg=0.00196 | L2-Norm=13.997 | L2-Norm(final)=3.035 | acc=1.0000 | 4640.2 samples/s | 72.5 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00123 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=3.035 | acc=1.0000 | 4665.3 samples/s | 72.9 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00103 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=3.035 | acc=1.0000 | 4627.5 samples/s | 72.3 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00088 | Reg=0.00196 | L2-Norm=13.992 | L2-Norm(final)=3.036 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00077 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=3.036 | acc=1.0000 | 4672.7 samples/s | 73.0 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00069 | Reg=0.00196 | L2-Norm=13.988 | L2-Norm(final)=3.036 | acc=1.0000 | 4678.7 samples/s | 73.1 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00062 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=3.036 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00056 | Reg=0.00196 | L2-Norm=13.984 | L2-Norm(final)=3.037 | acc=1.0000 | 1501.6 samples/s | 23.5 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00052 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=3.037 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00048 | Reg=0.00195 | L2-Norm=13.979 | L2-Norm(final)=3.037 | acc=1.0000 | 4542.5 samples/s | 71.0 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00044 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=3.037 | acc=1.0000 | 4602.6 samples/s | 71.9 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00042 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=3.038 | acc=1.0000 | 4531.9 samples/s | 70.8 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00039 | Reg=0.00195 | L2-Norm=13.972 | L2-Norm(final)=3.038 | acc=1.0000 | 4756.8 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32490 | acc=0.8228 | tpr=0.7457 | fpr=0.0097 | 4399.7 samples/s | 17.2 steps/s
Avg test loss: 0.33184, Avg test acc: 0.82070, Avg tpr: 0.74372, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.39478 | acc=0.9012 | tpr=0.9469 | fpr=0.0996 | 4390.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.39826 | acc=0.9016 | tpr=0.9574 | fpr=0.0994 | 9002.5 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.40389 | acc=0.9012 | tpr=0.9640 | fpr=0.1000 | 8473.3 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.40802 | acc=0.9012 | tpr=0.9661 | fpr=0.1000 | 8981.2 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.40361 | acc=0.9013 | tpr=0.9633 | fpr=0.0998 | 7983.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.40677 | acc=0.9017 | tpr=0.9622 | fpr=0.0994 | 8800.1 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.40934 | acc=0.9017 | tpr=0.9631 | fpr=0.0995 | 8021.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.41023 | acc=0.9020 | tpr=0.9639 | fpr=0.0992 | 7910.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.41468 | acc=0.9019 | tpr=0.9630 | fpr=0.0992 | 8508.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.41468 | acc=0.9014 | tpr=0.9626 | fpr=0.0997 | 7311.6 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.41317 | acc=0.9018 | tpr=0.9630 | fpr=0.0993 | 15296.8 samples/s | 59.8 steps/s
Avg test loss: 0.41265, Avg test acc: 0.90182, Avg tpr: 0.96315, Avg fpr: 0.09930, total FA: 13787

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.18618 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=3.060 | acc=0.8906 | 3981.3 samples/s | 62.2 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02855 | Reg=0.00196 | L2-Norm=13.983 | L2-Norm(final)=3.059 | acc=0.9844 | 4490.5 samples/s | 70.2 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01868 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=3.061 | acc=0.9844 | 4806.2 samples/s | 75.1 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01526 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=3.064 | acc=1.0000 | 4854.3 samples/s | 75.8 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01323 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=3.067 | acc=0.9844 | 4800.0 samples/s | 75.0 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01237 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=3.070 | acc=1.0000 | 4962.7 samples/s | 77.5 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01162 | Reg=0.00196 | L2-Norm=13.999 | L2-Norm(final)=3.072 | acc=0.9844 | 4786.5 samples/s | 74.8 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01121 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=3.074 | acc=0.9844 | 4835.2 samples/s | 75.6 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01088 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=3.076 | acc=1.0000 | 4219.2 samples/s | 65.9 steps/s
[Step=27650 Epoch=27.0] | Loss=0.01045 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=3.078 | acc=0.9844 | 3825.5 samples/s | 59.8 steps/s
[Step=27700 Epoch=27.0] | Loss=0.01017 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=3.080 | acc=1.0000 | 3874.3 samples/s | 60.5 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00993 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=3.081 | acc=1.0000 | 3925.5 samples/s | 61.3 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00986 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=3.083 | acc=1.0000 | 3805.1 samples/s | 59.5 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00970 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=3.085 | acc=1.0000 | 3837.8 samples/s | 60.0 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00955 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=3.086 | acc=1.0000 | 3846.8 samples/s | 60.1 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00931 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=3.088 | acc=1.0000 | 3893.3 samples/s | 60.8 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00923 | Reg=0.00196 | L2-Norm=14.008 | L2-Norm(final)=3.090 | acc=0.9844 | 3857.4 samples/s | 60.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.00370 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=3.060 | acc=1.0000 | 3019.1 samples/s | 47.2 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00189 | Reg=0.00195 | L2-Norm=13.972 | L2-Norm(final)=3.067 | acc=1.0000 | 4263.0 samples/s | 66.6 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00096 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=3.068 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00065 | Reg=0.00195 | L2-Norm=13.973 | L2-Norm(final)=3.069 | acc=1.0000 | 4671.7 samples/s | 73.0 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00049 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=3.069 | acc=1.0000 | 4755.1 samples/s | 74.3 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00040 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=3.070 | acc=1.0000 | 4837.4 samples/s | 75.6 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00033 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.070 | acc=1.0000 | 4598.3 samples/s | 71.8 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00029 | Reg=0.00195 | L2-Norm=13.965 | L2-Norm(final)=3.071 | acc=1.0000 | 4710.9 samples/s | 73.6 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00025 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=3.071 | acc=1.0000 | 4637.8 samples/s | 72.5 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00023 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=3.071 | acc=1.0000 | 4630.7 samples/s | 72.4 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00020 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.071 | acc=1.0000 | 4767.1 samples/s | 74.5 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00019 | Reg=0.00195 | L2-Norm=13.955 | L2-Norm(final)=3.072 | acc=1.0000 | 1741.5 samples/s | 27.2 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00017 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=3.072 | acc=1.0000 | 4731.1 samples/s | 73.9 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00016 | Reg=0.00195 | L2-Norm=13.950 | L2-Norm(final)=3.072 | acc=1.0000 | 4675.1 samples/s | 73.0 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00015 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=3.073 | acc=1.0000 | 4701.0 samples/s | 73.5 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00014 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=3.073 | acc=1.0000 | 4744.4 samples/s | 74.1 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00013 | Reg=0.00194 | L2-Norm=13.941 | L2-Norm(final)=3.073 | acc=1.0000 | 4497.6 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25743 | acc=0.8615 | tpr=0.8023 | fpr=0.0099 | 4378.0 samples/s | 17.1 steps/s
Avg test loss: 0.26483, Avg test acc: 0.86133, Avg tpr: 0.80300, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.50801 | acc=0.8675 | tpr=0.9425 | fpr=0.1338 | 4474.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.50979 | acc=0.8691 | tpr=0.9595 | fpr=0.1326 | 8505.5 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.51663 | acc=0.8676 | tpr=0.9640 | fpr=0.1341 | 8968.9 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.52068 | acc=0.8671 | tpr=0.9650 | fpr=0.1346 | 9081.0 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.51653 | acc=0.8674 | tpr=0.9624 | fpr=0.1343 | 8748.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.51862 | acc=0.8677 | tpr=0.9615 | fpr=0.1340 | 8419.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.52143 | acc=0.8676 | tpr=0.9624 | fpr=0.1341 | 9121.5 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.52186 | acc=0.8680 | tpr=0.9639 | fpr=0.1338 | 8405.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.52643 | acc=0.8679 | tpr=0.9645 | fpr=0.1339 | 8596.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.52694 | acc=0.8674 | tpr=0.9639 | fpr=0.1344 | 8858.9 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.52534 | acc=0.8676 | tpr=0.9646 | fpr=0.1341 | 16303.6 samples/s | 63.7 steps/s
Avg test loss: 0.52491, Avg test acc: 0.86760, Avg tpr: 0.96474, Avg fpr: 0.13416, total FA: 18628

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.17960 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=3.095 | acc=0.8906 | 3484.7 samples/s | 54.4 steps/s
[Step=28050 Epoch=27.4] | Loss=0.02260 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=3.092 | acc=1.0000 | 4926.1 samples/s | 77.0 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01544 | Reg=0.00195 | L2-Norm=13.965 | L2-Norm(final)=3.094 | acc=1.0000 | 4577.8 samples/s | 71.5 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01249 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.096 | acc=1.0000 | 4835.2 samples/s | 75.6 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01089 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=3.099 | acc=0.9844 | 4873.1 samples/s | 76.1 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01018 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=3.101 | acc=1.0000 | 4829.1 samples/s | 75.5 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00953 | Reg=0.00195 | L2-Norm=13.972 | L2-Norm(final)=3.104 | acc=1.0000 | 4933.8 samples/s | 77.1 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00926 | Reg=0.00195 | L2-Norm=13.973 | L2-Norm(final)=3.106 | acc=0.9844 | 4857.2 samples/s | 75.9 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00916 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=3.108 | acc=1.0000 | 4847.1 samples/s | 75.7 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00906 | Reg=0.00195 | L2-Norm=13.975 | L2-Norm(final)=3.110 | acc=1.0000 | 4842.0 samples/s | 75.7 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00906 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=3.111 | acc=1.0000 | 4996.5 samples/s | 78.1 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00911 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=3.113 | acc=1.0000 | 4821.0 samples/s | 75.3 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00921 | Reg=0.00195 | L2-Norm=13.978 | L2-Norm(final)=3.114 | acc=1.0000 | 4844.4 samples/s | 75.7 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00902 | Reg=0.00195 | L2-Norm=13.978 | L2-Norm(final)=3.115 | acc=1.0000 | 4729.3 samples/s | 73.9 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00891 | Reg=0.00195 | L2-Norm=13.979 | L2-Norm(final)=3.117 | acc=1.0000 | 3920.3 samples/s | 61.3 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00897 | Reg=0.00195 | L2-Norm=13.980 | L2-Norm(final)=3.118 | acc=0.9844 | 3841.4 samples/s | 60.0 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00894 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=3.119 | acc=1.0000 | 3879.6 samples/s | 60.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.10657 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=3.095 | acc=0.9688 | 2843.1 samples/s | 44.4 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00340 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.101 | acc=1.0000 | 4437.0 samples/s | 69.3 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00172 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=3.103 | acc=1.0000 | 4697.6 samples/s | 73.4 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00115 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=3.103 | acc=1.0000 | 4756.3 samples/s | 74.3 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00087 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.104 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00070 | Reg=0.00195 | L2-Norm=13.955 | L2-Norm(final)=3.104 | acc=1.0000 | 4680.3 samples/s | 73.1 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00058 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=3.104 | acc=1.0000 | 4679.6 samples/s | 73.1 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00050 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=3.105 | acc=1.0000 | 4745.3 samples/s | 74.1 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00044 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=3.105 | acc=1.0000 | 4895.1 samples/s | 76.5 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00039 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=3.105 | acc=1.0000 | 4678.4 samples/s | 73.1 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00035 | Reg=0.00194 | L2-Norm=13.941 | L2-Norm(final)=3.105 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00032 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=3.105 | acc=1.0000 | 1480.4 samples/s | 23.1 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00029 | Reg=0.00194 | L2-Norm=13.935 | L2-Norm(final)=3.106 | acc=1.0000 | 4847.2 samples/s | 75.7 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00027 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=3.106 | acc=1.0000 | 4603.0 samples/s | 71.9 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00025 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=3.106 | acc=1.0000 | 4706.9 samples/s | 73.5 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00024 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=3.106 | acc=1.0000 | 4597.2 samples/s | 71.8 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00022 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=3.106 | acc=1.0000 | 4741.3 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27442 | acc=0.8535 | tpr=0.7910 | fpr=0.0107 | 4384.5 samples/s | 17.1 steps/s
Avg test loss: 0.28104, Avg test acc: 0.85347, Avg tpr: 0.79175, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.47051 | acc=0.8805 | tpr=0.9469 | fpr=0.1206 | 4394.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.47240 | acc=0.8820 | tpr=0.9595 | fpr=0.1195 | 8822.2 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.47902 | acc=0.8804 | tpr=0.9640 | fpr=0.1212 | 8965.9 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.48317 | acc=0.8798 | tpr=0.9639 | fpr=0.1217 | 9036.5 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.47809 | acc=0.8805 | tpr=0.9616 | fpr=0.1210 | 8574.5 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.48049 | acc=0.8806 | tpr=0.9607 | fpr=0.1208 | 8650.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.48319 | acc=0.8807 | tpr=0.9612 | fpr=0.1208 | 8973.4 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.48391 | acc=0.8809 | tpr=0.9623 | fpr=0.1206 | 8848.5 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.48879 | acc=0.8807 | tpr=0.9620 | fpr=0.1208 | 8689.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.48922 | acc=0.8802 | tpr=0.9617 | fpr=0.1213 | 8884.5 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.48768 | acc=0.8804 | tpr=0.9626 | fpr=0.1211 | 15888.3 samples/s | 62.1 steps/s
Avg test loss: 0.48723, Avg test acc: 0.88041, Avg tpr: 0.96276, Avg fpr: 0.12108, total FA: 16812

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.10524 | Reg=0.00194 | L2-Norm=13.911 | L2-Norm(final)=3.123 | acc=0.8906 | 3765.8 samples/s | 58.8 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02304 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=3.122 | acc=1.0000 | 4636.2 samples/s | 72.4 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01450 | Reg=0.00194 | L2-Norm=13.941 | L2-Norm(final)=3.124 | acc=1.0000 | 4919.4 samples/s | 76.9 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01156 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=3.126 | acc=1.0000 | 4914.8 samples/s | 76.8 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01033 | Reg=0.00194 | L2-Norm=13.946 | L2-Norm(final)=3.128 | acc=1.0000 | 4818.6 samples/s | 75.3 steps/s
[Step=29050 Epoch=28.4] | Loss=0.00970 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=3.131 | acc=1.0000 | 4895.6 samples/s | 76.5 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00918 | Reg=0.00195 | L2-Norm=13.948 | L2-Norm(final)=3.132 | acc=1.0000 | 4474.7 samples/s | 69.9 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00909 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=3.134 | acc=1.0000 | 3881.4 samples/s | 60.6 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00882 | Reg=0.00195 | L2-Norm=13.950 | L2-Norm(final)=3.136 | acc=1.0000 | 3871.8 samples/s | 60.5 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00870 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=3.137 | acc=1.0000 | 3926.0 samples/s | 61.3 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00893 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=3.139 | acc=0.9844 | 3837.3 samples/s | 60.0 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00891 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=3.140 | acc=0.9688 | 3860.0 samples/s | 60.3 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00906 | Reg=0.00195 | L2-Norm=13.953 | L2-Norm(final)=3.141 | acc=1.0000 | 3850.3 samples/s | 60.2 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00887 | Reg=0.00195 | L2-Norm=13.954 | L2-Norm(final)=3.142 | acc=0.9844 | 3893.5 samples/s | 60.8 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00880 | Reg=0.00195 | L2-Norm=13.954 | L2-Norm(final)=3.144 | acc=0.9844 | 3892.9 samples/s | 60.8 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00874 | Reg=0.00195 | L2-Norm=13.955 | L2-Norm(final)=3.145 | acc=1.0000 | 3866.2 samples/s | 60.4 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00877 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=3.146 | acc=1.0000 | 3891.5 samples/s | 60.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.05871 | Reg=0.00194 | L2-Norm=13.911 | L2-Norm(final)=3.123 | acc=0.9844 | 3159.5 samples/s | 49.4 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00274 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=3.127 | acc=1.0000 | 4180.5 samples/s | 65.3 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00138 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=3.128 | acc=1.0000 | 4662.4 samples/s | 72.9 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00093 | Reg=0.00194 | L2-Norm=13.937 | L2-Norm(final)=3.129 | acc=1.0000 | 4667.1 samples/s | 72.9 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00071 | Reg=0.00194 | L2-Norm=13.935 | L2-Norm(final)=3.130 | acc=1.0000 | 4760.1 samples/s | 74.4 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00057 | Reg=0.00194 | L2-Norm=13.933 | L2-Norm(final)=3.130 | acc=1.0000 | 4673.6 samples/s | 73.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00047 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=3.131 | acc=1.0000 | 4710.0 samples/s | 73.6 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00041 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=3.131 | acc=1.0000 | 4771.9 samples/s | 74.6 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00036 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=3.131 | acc=1.0000 | 4604.2 samples/s | 71.9 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00032 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=3.132 | acc=1.0000 | 4680.0 samples/s | 73.1 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00029 | Reg=0.00194 | L2-Norm=13.919 | L2-Norm(final)=3.132 | acc=1.0000 | 4711.1 samples/s | 73.6 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00026 | Reg=0.00194 | L2-Norm=13.916 | L2-Norm(final)=3.132 | acc=1.0000 | 1495.6 samples/s | 23.4 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00024 | Reg=0.00194 | L2-Norm=13.913 | L2-Norm(final)=3.132 | acc=1.0000 | 4722.9 samples/s | 73.8 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00022 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=3.133 | acc=1.0000 | 4755.8 samples/s | 74.3 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00021 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=3.133 | acc=1.0000 | 4682.2 samples/s | 73.2 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00019 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=3.133 | acc=1.0000 | 4680.7 samples/s | 73.1 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00018 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=3.133 | acc=1.0000 | 4691.0 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27500 | acc=0.8520 | tpr=0.7879 | fpr=0.0087 | 4391.7 samples/s | 17.2 steps/s
Avg test loss: 0.28139, Avg test acc: 0.85207, Avg tpr: 0.78936, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.43926 | acc=0.8903 | tpr=0.9469 | fpr=0.1107 | 4424.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.44014 | acc=0.8919 | tpr=0.9638 | fpr=0.1094 | 8874.8 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.44673 | acc=0.8904 | tpr=0.9669 | fpr=0.1110 | 8881.9 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.45049 | acc=0.8901 | tpr=0.9672 | fpr=0.1113 | 8505.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.44521 | acc=0.8905 | tpr=0.9642 | fpr=0.1109 | 9162.3 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.44729 | acc=0.8908 | tpr=0.9622 | fpr=0.1105 | 8555.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.44994 | acc=0.8909 | tpr=0.9624 | fpr=0.1104 | 8913.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.45122 | acc=0.8911 | tpr=0.9633 | fpr=0.1103 | 9055.9 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.45624 | acc=0.8908 | tpr=0.9630 | fpr=0.1105 | 8397.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.45649 | acc=0.8903 | tpr=0.9621 | fpr=0.1110 | 8356.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.45516 | acc=0.8904 | tpr=0.9630 | fpr=0.1109 | 16807.3 samples/s | 65.7 steps/s
Avg test loss: 0.45468, Avg test acc: 0.89039, Avg tpr: 0.96315, Avg fpr: 0.11093, total FA: 15403

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.24014 | Reg=0.00193 | L2-Norm=13.884 | L2-Norm(final)=3.150 | acc=0.8281 | 3592.9 samples/s | 56.1 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02333 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=3.144 | acc=1.0000 | 4796.4 samples/s | 74.9 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01503 | Reg=0.00194 | L2-Norm=13.919 | L2-Norm(final)=3.146 | acc=1.0000 | 4819.4 samples/s | 75.3 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01279 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=3.149 | acc=1.0000 | 4879.4 samples/s | 76.2 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01140 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=3.152 | acc=1.0000 | 4922.4 samples/s | 76.9 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01061 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=3.154 | acc=1.0000 | 4787.9 samples/s | 74.8 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01000 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=3.157 | acc=1.0000 | 4899.7 samples/s | 76.6 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00962 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=3.159 | acc=1.0000 | 4961.3 samples/s | 77.5 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00946 | Reg=0.00194 | L2-Norm=13.930 | L2-Norm(final)=3.160 | acc=0.9844 | 4891.3 samples/s | 76.4 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00909 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=3.162 | acc=1.0000 | 4874.1 samples/s | 76.2 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00909 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=3.164 | acc=1.0000 | 4834.0 samples/s | 75.5 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00909 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=3.165 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00893 | Reg=0.00194 | L2-Norm=13.933 | L2-Norm(final)=3.167 | acc=1.0000 | 4704.3 samples/s | 73.5 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00870 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=3.169 | acc=1.0000 | 3853.6 samples/s | 60.2 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00865 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=3.170 | acc=1.0000 | 3849.2 samples/s | 60.1 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00877 | Reg=0.00194 | L2-Norm=13.935 | L2-Norm(final)=3.172 | acc=1.0000 | 3809.2 samples/s | 59.5 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00868 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=3.173 | acc=0.9844 | 3864.8 samples/s | 60.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.11636 | Reg=0.00193 | L2-Norm=13.884 | L2-Norm(final)=3.150 | acc=0.9531 | 2957.5 samples/s | 46.2 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00505 | Reg=0.00193 | L2-Norm=13.905 | L2-Norm(final)=3.149 | acc=1.0000 | 4513.0 samples/s | 70.5 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00254 | Reg=0.00193 | L2-Norm=13.908 | L2-Norm(final)=3.148 | acc=1.0000 | 4609.0 samples/s | 72.0 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00170 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=3.149 | acc=1.0000 | 4653.6 samples/s | 72.7 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00128 | Reg=0.00193 | L2-Norm=13.905 | L2-Norm(final)=3.149 | acc=1.0000 | 4715.1 samples/s | 73.7 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00103 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=3.150 | acc=1.0000 | 4651.8 samples/s | 72.7 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00086 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=3.151 | acc=1.0000 | 4593.8 samples/s | 71.8 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00074 | Reg=0.00193 | L2-Norm=13.898 | L2-Norm(final)=3.151 | acc=1.0000 | 4840.0 samples/s | 75.6 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00065 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=3.151 | acc=1.0000 | 4615.1 samples/s | 72.1 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00058 | Reg=0.00193 | L2-Norm=13.893 | L2-Norm(final)=3.152 | acc=1.0000 | 4787.2 samples/s | 74.8 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00052 | Reg=0.00193 | L2-Norm=13.890 | L2-Norm(final)=3.152 | acc=1.0000 | 4775.9 samples/s | 74.6 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00047 | Reg=0.00193 | L2-Norm=13.887 | L2-Norm(final)=3.153 | acc=1.0000 | 1489.1 samples/s | 23.3 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00043 | Reg=0.00193 | L2-Norm=13.884 | L2-Norm(final)=3.153 | acc=1.0000 | 4705.4 samples/s | 73.5 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00040 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=3.153 | acc=1.0000 | 4670.9 samples/s | 73.0 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00037 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.153 | acc=1.0000 | 4685.6 samples/s | 73.2 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00035 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=3.153 | acc=1.0000 | 4573.5 samples/s | 71.5 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00033 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=3.154 | acc=1.0000 | 4570.6 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26209 | acc=0.8595 | tpr=0.7992 | fpr=0.0094 | 4409.0 samples/s | 17.2 steps/s
Avg test loss: 0.26969, Avg test acc: 0.85800, Avg tpr: 0.79862, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.44971 | acc=0.8898 | tpr=0.9513 | fpr=0.1113 | 4446.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.45015 | acc=0.8912 | tpr=0.9659 | fpr=0.1102 | 8628.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.45673 | acc=0.8901 | tpr=0.9697 | fpr=0.1113 | 8895.3 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.46064 | acc=0.8893 | tpr=0.9705 | fpr=0.1122 | 8575.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.45500 | acc=0.8897 | tpr=0.9677 | fpr=0.1117 | 8739.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.45745 | acc=0.8897 | tpr=0.9658 | fpr=0.1117 | 8854.9 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.46028 | acc=0.8895 | tpr=0.9662 | fpr=0.1119 | 8792.9 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.46155 | acc=0.8897 | tpr=0.9666 | fpr=0.1117 | 8952.2 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.46656 | acc=0.8896 | tpr=0.9654 | fpr=0.1118 | 8457.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.46692 | acc=0.8891 | tpr=0.9648 | fpr=0.1123 | 8608.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.46557 | acc=0.8892 | tpr=0.9658 | fpr=0.1122 | 17057.2 samples/s | 66.6 steps/s
Avg test loss: 0.46509, Avg test acc: 0.88926, Avg tpr: 0.96593, Avg fpr: 0.11213, total FA: 15569

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.21211 | Reg=0.00192 | L2-Norm=13.858 | L2-Norm(final)=3.174 | acc=0.8594 | 3759.7 samples/s | 58.7 steps/s
[Step=30450 Epoch=29.7] | Loss=0.02417 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.171 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01591 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=3.173 | acc=0.9844 | 4830.8 samples/s | 75.5 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01227 | Reg=0.00193 | L2-Norm=13.892 | L2-Norm(final)=3.176 | acc=0.9844 | 4869.7 samples/s | 76.1 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01117 | Reg=0.00193 | L2-Norm=13.894 | L2-Norm(final)=3.179 | acc=1.0000 | 4892.8 samples/s | 76.5 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01067 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=3.181 | acc=1.0000 | 4859.4 samples/s | 75.9 steps/s
[Step=30700 Epoch=30.0] | Loss=0.01000 | Reg=0.00193 | L2-Norm=13.897 | L2-Norm(final)=3.183 | acc=0.9844 | 4907.2 samples/s | 76.7 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00955 | Reg=0.00193 | L2-Norm=13.898 | L2-Norm(final)=3.185 | acc=1.0000 | 4893.4 samples/s | 76.5 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00918 | Reg=0.00193 | L2-Norm=13.899 | L2-Norm(final)=3.187 | acc=0.9688 | 4755.0 samples/s | 74.3 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00927 | Reg=0.00193 | L2-Norm=13.899 | L2-Norm(final)=3.188 | acc=1.0000 | 4893.3 samples/s | 76.5 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00936 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=3.190 | acc=1.0000 | 4883.5 samples/s | 76.3 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00906 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=3.191 | acc=0.9844 | 4766.3 samples/s | 74.5 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00879 | Reg=0.00193 | L2-Norm=13.902 | L2-Norm(final)=3.193 | acc=1.0000 | 4888.7 samples/s | 76.4 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00871 | Reg=0.00193 | L2-Norm=13.902 | L2-Norm(final)=3.194 | acc=1.0000 | 4892.8 samples/s | 76.5 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00867 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=3.196 | acc=1.0000 | 4843.3 samples/s | 75.7 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00853 | Reg=0.00193 | L2-Norm=13.904 | L2-Norm(final)=3.197 | acc=0.9844 | 4069.6 samples/s | 63.6 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00841 | Reg=0.00193 | L2-Norm=13.904 | L2-Norm(final)=3.198 | acc=1.0000 | 3831.9 samples/s | 59.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.02606 | Reg=0.00192 | L2-Norm=13.858 | L2-Norm(final)=3.175 | acc=0.9844 | 2919.9 samples/s | 45.6 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00294 | Reg=0.00193 | L2-Norm=13.879 | L2-Norm(final)=3.179 | acc=1.0000 | 4525.1 samples/s | 70.7 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00148 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.180 | acc=1.0000 | 4590.8 samples/s | 71.7 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00099 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.180 | acc=1.0000 | 4525.2 samples/s | 70.7 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00076 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=3.181 | acc=1.0000 | 4671.7 samples/s | 73.0 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00061 | Reg=0.00193 | L2-Norm=13.879 | L2-Norm(final)=3.181 | acc=1.0000 | 4640.7 samples/s | 72.5 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00051 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=3.182 | acc=1.0000 | 4720.4 samples/s | 73.8 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00044 | Reg=0.00193 | L2-Norm=13.875 | L2-Norm(final)=3.183 | acc=1.0000 | 4565.0 samples/s | 71.3 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00039 | Reg=0.00192 | L2-Norm=13.873 | L2-Norm(final)=3.183 | acc=1.0000 | 4601.8 samples/s | 71.9 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00035 | Reg=0.00192 | L2-Norm=13.870 | L2-Norm(final)=3.184 | acc=1.0000 | 4596.8 samples/s | 71.8 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00031 | Reg=0.00192 | L2-Norm=13.868 | L2-Norm(final)=3.184 | acc=1.0000 | 4817.1 samples/s | 75.3 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00029 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.185 | acc=1.0000 | 1491.1 samples/s | 23.3 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00026 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=3.185 | acc=1.0000 | 4664.6 samples/s | 72.9 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00024 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=3.185 | acc=1.0000 | 4519.2 samples/s | 70.6 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00023 | Reg=0.00192 | L2-Norm=13.857 | L2-Norm(final)=3.186 | acc=1.0000 | 4655.2 samples/s | 72.7 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00021 | Reg=0.00192 | L2-Norm=13.854 | L2-Norm(final)=3.186 | acc=1.0000 | 4729.8 samples/s | 73.9 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00020 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.186 | acc=1.0000 | 4532.6 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24969 | acc=0.8684 | tpr=0.8122 | fpr=0.0097 | 4490.5 samples/s | 17.5 steps/s
Avg test loss: 0.25748, Avg test acc: 0.86557, Avg tpr: 0.80999, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.49199 | acc=0.8784 | tpr=0.9513 | fpr=0.1229 | 4585.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.49128 | acc=0.8807 | tpr=0.9680 | fpr=0.1210 | 8333.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.49927 | acc=0.8792 | tpr=0.9726 | fpr=0.1225 | 8565.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.50457 | acc=0.8784 | tpr=0.9727 | fpr=0.1233 | 9098.4 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.49947 | acc=0.8788 | tpr=0.9694 | fpr=0.1229 | 8644.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.50173 | acc=0.8793 | tpr=0.9680 | fpr=0.1223 | 9167.5 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.50433 | acc=0.8791 | tpr=0.9674 | fpr=0.1225 | 8371.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.50556 | acc=0.8792 | tpr=0.9683 | fpr=0.1225 | 8850.9 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.51102 | acc=0.8789 | tpr=0.9674 | fpr=0.1227 | 8873.1 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.51133 | acc=0.8784 | tpr=0.9670 | fpr=0.1232 | 8968.8 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.50970 | acc=0.8786 | tpr=0.9678 | fpr=0.1230 | 15181.9 samples/s | 59.3 steps/s
Avg test loss: 0.50924, Avg test acc: 0.87860, Avg tpr: 0.96791, Avg fpr: 0.12302, total FA: 17081

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.21213 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.203 | acc=0.8750 | 3535.5 samples/s | 55.2 steps/s
[Step=31250 Epoch=30.5] | Loss=0.02326 | Reg=0.00192 | L2-Norm=13.856 | L2-Norm(final)=3.199 | acc=1.0000 | 4679.8 samples/s | 73.1 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01526 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=3.201 | acc=1.0000 | 4832.3 samples/s | 75.5 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01317 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.203 | acc=0.9844 | 4892.5 samples/s | 76.4 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01158 | Reg=0.00192 | L2-Norm=13.867 | L2-Norm(final)=3.205 | acc=1.0000 | 4860.8 samples/s | 76.0 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01068 | Reg=0.00192 | L2-Norm=13.868 | L2-Norm(final)=3.208 | acc=0.9844 | 4813.2 samples/s | 75.2 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01041 | Reg=0.00192 | L2-Norm=13.870 | L2-Norm(final)=3.210 | acc=0.9844 | 4847.6 samples/s | 75.7 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00988 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=3.212 | acc=1.0000 | 4797.0 samples/s | 75.0 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00974 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.213 | acc=1.0000 | 4051.9 samples/s | 63.3 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00954 | Reg=0.00192 | L2-Norm=13.873 | L2-Norm(final)=3.215 | acc=1.0000 | 3829.3 samples/s | 59.8 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00936 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=3.217 | acc=0.9844 | 3874.1 samples/s | 60.5 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00913 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=3.218 | acc=0.9688 | 3830.6 samples/s | 59.9 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00908 | Reg=0.00193 | L2-Norm=13.875 | L2-Norm(final)=3.220 | acc=1.0000 | 3858.6 samples/s | 60.3 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00904 | Reg=0.00193 | L2-Norm=13.876 | L2-Norm(final)=3.221 | acc=0.9844 | 3872.4 samples/s | 60.5 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00881 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=3.223 | acc=1.0000 | 3863.5 samples/s | 60.4 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00868 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=3.224 | acc=1.0000 | 3812.6 samples/s | 59.6 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00871 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.226 | acc=1.0000 | 3828.2 samples/s | 59.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.10457 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.204 | acc=0.9375 | 2826.4 samples/s | 44.2 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00355 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=3.209 | acc=1.0000 | 4452.1 samples/s | 69.6 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00178 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.209 | acc=1.0000 | 4533.6 samples/s | 70.8 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00122 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.209 | acc=1.0000 | 4692.6 samples/s | 73.3 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00092 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=3.210 | acc=1.0000 | 4731.2 samples/s | 73.9 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00073 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.210 | acc=1.0000 | 4522.3 samples/s | 70.7 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00061 | Reg=0.00192 | L2-Norm=13.868 | L2-Norm(final)=3.210 | acc=1.0000 | 4564.4 samples/s | 71.3 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00053 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=3.210 | acc=1.0000 | 4707.7 samples/s | 73.6 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00046 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=3.211 | acc=1.0000 | 4656.2 samples/s | 72.8 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00041 | Reg=0.00192 | L2-Norm=13.861 | L2-Norm(final)=3.211 | acc=1.0000 | 4556.4 samples/s | 71.2 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00037 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=3.211 | acc=1.0000 | 4607.8 samples/s | 72.0 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00034 | Reg=0.00192 | L2-Norm=13.857 | L2-Norm(final)=3.211 | acc=1.0000 | 1462.5 samples/s | 22.9 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00031 | Reg=0.00192 | L2-Norm=13.854 | L2-Norm(final)=3.211 | acc=1.0000 | 4758.0 samples/s | 74.3 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00029 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.211 | acc=1.0000 | 4634.7 samples/s | 72.4 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00027 | Reg=0.00192 | L2-Norm=13.849 | L2-Norm(final)=3.212 | acc=1.0000 | 4649.5 samples/s | 72.6 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00025 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.212 | acc=1.0000 | 4668.4 samples/s | 72.9 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00023 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.212 | acc=1.0000 | 4732.2 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29860 | acc=0.8497 | tpr=0.7838 | fpr=0.0072 | 4194.7 samples/s | 16.4 steps/s
Avg test loss: 0.30876, Avg test acc: 0.84538, Avg tpr: 0.77951, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.45103 | acc=0.8983 | tpr=0.9513 | fpr=0.1027 | 4474.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.45061 | acc=0.8997 | tpr=0.9680 | fpr=0.1016 | 8725.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.45753 | acc=0.8982 | tpr=0.9726 | fpr=0.1031 | 8930.1 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.46206 | acc=0.8973 | tpr=0.9716 | fpr=0.1041 | 9032.3 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.45698 | acc=0.8970 | tpr=0.9686 | fpr=0.1043 | 8324.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.45976 | acc=0.8975 | tpr=0.9673 | fpr=0.1037 | 8975.0 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.46288 | acc=0.8974 | tpr=0.9668 | fpr=0.1039 | 9084.2 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.46406 | acc=0.8974 | tpr=0.9683 | fpr=0.1038 | 8476.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.46926 | acc=0.8972 | tpr=0.9679 | fpr=0.1041 | 8871.2 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.46930 | acc=0.8968 | tpr=0.9674 | fpr=0.1044 | 8497.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.46759 | acc=0.8971 | tpr=0.9682 | fpr=0.1042 | 17214.5 samples/s | 67.2 steps/s
Avg test loss: 0.46717, Avg test acc: 0.89715, Avg tpr: 0.96830, Avg fpr: 0.10414, total FA: 14460

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.06860 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.230 | acc=0.9531 | 3432.0 samples/s | 53.6 steps/s
[Step=32050 Epoch=31.3] | Loss=0.02947 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=3.227 | acc=0.9844 | 4953.3 samples/s | 77.4 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01832 | Reg=0.00192 | L2-Norm=13.842 | L2-Norm(final)=3.228 | acc=1.0000 | 5110.8 samples/s | 79.9 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01428 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.229 | acc=0.9844 | 4934.4 samples/s | 77.1 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01250 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=3.230 | acc=1.0000 | 4814.9 samples/s | 75.2 steps/s
[Step=32250 Epoch=31.5] | Loss=0.01139 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=3.231 | acc=0.9844 | 4770.4 samples/s | 74.5 steps/s
[Step=32300 Epoch=31.5] | Loss=0.01077 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.232 | acc=0.9688 | 4907.3 samples/s | 76.7 steps/s
[Step=32350 Epoch=31.6] | Loss=0.01002 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.233 | acc=0.9844 | 4935.8 samples/s | 77.1 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00963 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=3.234 | acc=1.0000 | 4813.0 samples/s | 75.2 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00921 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=3.236 | acc=1.0000 | 4954.0 samples/s | 77.4 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00890 | Reg=0.00192 | L2-Norm=13.849 | L2-Norm(final)=3.237 | acc=1.0000 | 4767.7 samples/s | 74.5 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00869 | Reg=0.00192 | L2-Norm=13.849 | L2-Norm(final)=3.238 | acc=1.0000 | 4832.9 samples/s | 75.5 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00841 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.239 | acc=1.0000 | 4718.8 samples/s | 73.7 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00838 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.240 | acc=1.0000 | 4102.6 samples/s | 64.1 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00823 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.241 | acc=1.0000 | 3886.2 samples/s | 60.7 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00818 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.241 | acc=0.9844 | 3829.7 samples/s | 59.8 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00812 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.242 | acc=1.0000 | 3850.2 samples/s | 60.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.04566 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.230 | acc=0.9844 | 2906.6 samples/s | 45.4 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00467 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.233 | acc=1.0000 | 4422.7 samples/s | 69.1 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00245 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.234 | acc=1.0000 | 4624.6 samples/s | 72.3 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00164 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.234 | acc=1.0000 | 4647.3 samples/s | 72.6 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00124 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.235 | acc=1.0000 | 4642.6 samples/s | 72.5 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00099 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.235 | acc=1.0000 | 4662.9 samples/s | 72.9 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00083 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.235 | acc=1.0000 | 4684.9 samples/s | 73.2 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00071 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.235 | acc=1.0000 | 4630.7 samples/s | 72.4 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00063 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.235 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00056 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.235 | acc=1.0000 | 4657.0 samples/s | 72.8 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00050 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=3.236 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00046 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.236 | acc=1.0000 | 1487.6 samples/s | 23.2 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00042 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=3.236 | acc=1.0000 | 4670.1 samples/s | 73.0 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00039 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.236 | acc=1.0000 | 4635.8 samples/s | 72.4 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00036 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.236 | acc=1.0000 | 4672.4 samples/s | 73.0 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00034 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.236 | acc=1.0000 | 4611.2 samples/s | 72.1 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00032 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.236 | acc=1.0000 | 4680.0 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24261 | acc=0.8780 | tpr=0.8268 | fpr=0.0107 | 4368.2 samples/s | 17.1 steps/s
Avg test loss: 0.24948, Avg test acc: 0.87579, Avg tpr: 0.82456, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.49243 | acc=0.8812 | tpr=0.9469 | fpr=0.1200 | 4410.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.49133 | acc=0.8834 | tpr=0.9616 | fpr=0.1181 | 8979.4 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.49830 | acc=0.8821 | tpr=0.9697 | fpr=0.1195 | 8826.8 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.50245 | acc=0.8813 | tpr=0.9705 | fpr=0.1204 | 8920.4 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.49645 | acc=0.8815 | tpr=0.9668 | fpr=0.1201 | 8671.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.49881 | acc=0.8818 | tpr=0.9658 | fpr=0.1197 | 8888.3 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.50200 | acc=0.8814 | tpr=0.9649 | fpr=0.1201 | 8638.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.50305 | acc=0.8815 | tpr=0.9666 | fpr=0.1200 | 8559.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.50827 | acc=0.8816 | tpr=0.9669 | fpr=0.1200 | 8465.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.50856 | acc=0.8813 | tpr=0.9665 | fpr=0.1203 | 9035.8 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.50708 | acc=0.8815 | tpr=0.9678 | fpr=0.1201 | 16135.7 samples/s | 63.0 steps/s
Avg test loss: 0.50676, Avg test acc: 0.88150, Avg tpr: 0.96791, Avg fpr: 0.12007, total FA: 16672

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.10784 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.246 | acc=0.9219 | 3670.9 samples/s | 57.4 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02086 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.246 | acc=1.0000 | 4777.1 samples/s | 74.6 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01391 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.247 | acc=0.9844 | 4813.0 samples/s | 75.2 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01137 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.249 | acc=1.0000 | 4819.0 samples/s | 75.3 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01008 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.250 | acc=1.0000 | 4871.9 samples/s | 76.1 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00922 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.251 | acc=1.0000 | 4810.5 samples/s | 75.2 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00873 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.253 | acc=0.9688 | 4903.3 samples/s | 76.6 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00849 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.254 | acc=1.0000 | 4816.0 samples/s | 75.3 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00813 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.255 | acc=1.0000 | 4833.5 samples/s | 75.5 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00785 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.256 | acc=0.9844 | 5035.1 samples/s | 78.7 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00765 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.257 | acc=1.0000 | 4741.9 samples/s | 74.1 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00742 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.258 | acc=0.9844 | 4959.2 samples/s | 77.5 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00730 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.259 | acc=0.9844 | 4842.3 samples/s | 75.7 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00730 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.260 | acc=1.0000 | 4849.5 samples/s | 75.8 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00713 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.261 | acc=1.0000 | 4885.8 samples/s | 76.3 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00702 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.262 | acc=0.9844 | 4856.4 samples/s | 75.9 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00704 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=3.263 | acc=1.0000 | 4999.3 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.02501 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.246 | acc=0.9688 | 3970.0 samples/s | 62.0 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00552 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.252 | acc=1.0000 | 4266.7 samples/s | 66.7 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00277 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.253 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00185 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.253 | acc=1.0000 | 4655.7 samples/s | 72.7 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00139 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.253 | acc=1.0000 | 4652.7 samples/s | 72.7 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00111 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.253 | acc=1.0000 | 4616.0 samples/s | 72.1 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00093 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.253 | acc=1.0000 | 4514.3 samples/s | 70.5 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00080 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.253 | acc=1.0000 | 4638.1 samples/s | 72.5 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00070 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.253 | acc=1.0000 | 4797.2 samples/s | 75.0 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00062 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.253 | acc=1.0000 | 4647.6 samples/s | 72.6 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00056 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.254 | acc=1.0000 | 4653.8 samples/s | 72.7 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00051 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=3.254 | acc=1.0000 | 1480.3 samples/s | 23.1 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00047 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.254 | acc=1.0000 | 4733.2 samples/s | 74.0 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00043 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=3.254 | acc=1.0000 | 4715.7 samples/s | 73.7 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00040 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.254 | acc=1.0000 | 4629.8 samples/s | 72.3 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00037 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.254 | acc=1.0000 | 4584.0 samples/s | 71.6 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00035 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.254 | acc=1.0000 | 4800.6 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28801 | acc=0.8603 | tpr=0.8005 | fpr=0.0099 | 4397.4 samples/s | 17.2 steps/s
Avg test loss: 0.29475, Avg test acc: 0.85880, Avg tpr: 0.79932, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.45925 | acc=0.8980 | tpr=0.9469 | fpr=0.1028 | 4388.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.45860 | acc=0.8995 | tpr=0.9616 | fpr=0.1017 | 8692.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.46472 | acc=0.8983 | tpr=0.9669 | fpr=0.1030 | 9048.5 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.46863 | acc=0.8975 | tpr=0.9672 | fpr=0.1037 | 8781.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.46261 | acc=0.8978 | tpr=0.9642 | fpr=0.1035 | 8825.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.46543 | acc=0.8983 | tpr=0.9636 | fpr=0.1029 | 8588.0 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.46833 | acc=0.8981 | tpr=0.9631 | fpr=0.1031 | 8838.3 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.46962 | acc=0.8980 | tpr=0.9644 | fpr=0.1032 | 8674.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.47483 | acc=0.8977 | tpr=0.9649 | fpr=0.1035 | 8608.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.47514 | acc=0.8975 | tpr=0.9643 | fpr=0.1037 | 8737.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.47370 | acc=0.8977 | tpr=0.9650 | fpr=0.1035 | 16371.2 samples/s | 63.9 steps/s
Avg test loss: 0.47338, Avg test acc: 0.89774, Avg tpr: 0.96513, Avg fpr: 0.10349, total FA: 14369

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.19284 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.265 | acc=0.8750 | 3603.3 samples/s | 56.3 steps/s
[Step=33650 Epoch=32.9] | Loss=0.02915 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.262 | acc=1.0000 | 4777.5 samples/s | 74.6 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01874 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=3.262 | acc=0.9688 | 4898.7 samples/s | 76.5 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01458 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=3.263 | acc=1.0000 | 4859.0 samples/s | 75.9 steps/s
[Step=33800 Epoch=33.0] | Loss=0.01227 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.264 | acc=1.0000 | 4871.2 samples/s | 76.1 steps/s
[Step=33850 Epoch=33.0] | Loss=0.01085 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.265 | acc=0.9844 | 4822.1 samples/s | 75.3 steps/s
[Step=33900 Epoch=33.1] | Loss=0.01007 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.266 | acc=0.9688 | 4886.4 samples/s | 76.3 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00953 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.267 | acc=1.0000 | 4819.2 samples/s | 75.3 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00930 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.268 | acc=0.9844 | 4811.1 samples/s | 75.2 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00884 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.269 | acc=0.9844 | 4827.5 samples/s | 75.4 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00861 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.270 | acc=1.0000 | 4996.0 samples/s | 78.1 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00835 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.271 | acc=0.9531 | 4937.6 samples/s | 77.1 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00817 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.272 | acc=1.0000 | 4832.3 samples/s | 75.5 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00787 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.273 | acc=1.0000 | 4911.8 samples/s | 76.7 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00779 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.274 | acc=0.9688 | 4739.9 samples/s | 74.1 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00771 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.275 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00749 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.276 | acc=1.0000 | 4979.0 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.05838 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.265 | acc=0.9844 | 3673.2 samples/s | 57.4 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00482 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.268 | acc=1.0000 | 4293.6 samples/s | 67.1 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00242 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.269 | acc=1.0000 | 4621.0 samples/s | 72.2 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00162 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.269 | acc=1.0000 | 4541.0 samples/s | 71.0 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00122 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.270 | acc=1.0000 | 4597.4 samples/s | 71.8 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00098 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.270 | acc=1.0000 | 4688.5 samples/s | 73.3 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00082 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.270 | acc=1.0000 | 4608.1 samples/s | 72.0 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00070 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.270 | acc=1.0000 | 4602.7 samples/s | 71.9 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00062 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.270 | acc=1.0000 | 4627.3 samples/s | 72.3 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00055 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.270 | acc=1.0000 | 4673.9 samples/s | 73.0 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00050 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.271 | acc=1.0000 | 4807.5 samples/s | 75.1 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00045 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.271 | acc=1.0000 | 1470.1 samples/s | 23.0 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00041 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.271 | acc=1.0000 | 4821.6 samples/s | 75.3 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00038 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=3.271 | acc=1.0000 | 4593.7 samples/s | 71.8 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00036 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.271 | acc=1.0000 | 4634.7 samples/s | 72.4 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00033 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.271 | acc=1.0000 | 4588.0 samples/s | 71.7 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00031 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.271 | acc=1.0000 | 4634.6 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22574 | acc=0.8874 | tpr=0.8409 | fpr=0.0116 | 4307.6 samples/s | 16.8 steps/s
Avg test loss: 0.23375, Avg test acc: 0.88445, Avg tpr: 0.83750, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.53595 | acc=0.8751 | tpr=0.9469 | fpr=0.1262 | 4420.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.53508 | acc=0.8766 | tpr=0.9616 | fpr=0.1250 | 9182.1 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.54288 | acc=0.8749 | tpr=0.9683 | fpr=0.1268 | 8470.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.54705 | acc=0.8742 | tpr=0.9694 | fpr=0.1275 | 8878.0 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.54091 | acc=0.8748 | tpr=0.9659 | fpr=0.1268 | 8744.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.54313 | acc=0.8754 | tpr=0.9644 | fpr=0.1262 | 8842.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.54597 | acc=0.8752 | tpr=0.9631 | fpr=0.1264 | 9243.3 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.54694 | acc=0.8751 | tpr=0.9650 | fpr=0.1265 | 8574.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.55250 | acc=0.8750 | tpr=0.9659 | fpr=0.1267 | 9017.9 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.55303 | acc=0.8745 | tpr=0.9656 | fpr=0.1271 | 8648.9 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.55137 | acc=0.8748 | tpr=0.9662 | fpr=0.1268 | 15928.4 samples/s | 62.2 steps/s
Avg test loss: 0.55108, Avg test acc: 0.87485, Avg tpr: 0.96632, Avg fpr: 0.12681, total FA: 17608

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.09562 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.280 | acc=0.9531 | 3823.9 samples/s | 59.7 steps/s
[Step=34450 Epoch=33.6] | Loss=0.01804 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.280 | acc=1.0000 | 4790.3 samples/s | 74.8 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01306 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.281 | acc=1.0000 | 4922.5 samples/s | 76.9 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01065 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.282 | acc=1.0000 | 4830.7 samples/s | 75.5 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00977 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.283 | acc=1.0000 | 4923.0 samples/s | 76.9 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00905 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.284 | acc=1.0000 | 4831.4 samples/s | 75.5 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00823 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=3.285 | acc=0.9844 | 4783.1 samples/s | 74.7 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00792 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=3.286 | acc=1.0000 | 4921.7 samples/s | 76.9 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00774 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.288 | acc=0.9844 | 4981.2 samples/s | 77.8 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00743 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.289 | acc=1.0000 | 4968.2 samples/s | 77.6 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00737 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.290 | acc=1.0000 | 4903.9 samples/s | 76.6 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00711 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.291 | acc=1.0000 | 4800.0 samples/s | 75.0 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00721 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.292 | acc=1.0000 | 4979.8 samples/s | 77.8 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00720 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.292 | acc=1.0000 | 4883.3 samples/s | 76.3 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00721 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.293 | acc=1.0000 | 4356.6 samples/s | 68.1 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00719 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.294 | acc=0.9688 | 3867.7 samples/s | 60.4 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00705 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.295 | acc=1.0000 | 3872.8 samples/s | 60.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.08364 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.281 | acc=0.9531 | 3768.9 samples/s | 58.9 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00616 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.284 | acc=1.0000 | 4347.4 samples/s | 67.9 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00309 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.284 | acc=1.0000 | 4801.4 samples/s | 75.0 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00207 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.285 | acc=1.0000 | 4653.3 samples/s | 72.7 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00155 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.285 | acc=1.0000 | 4659.3 samples/s | 72.8 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00124 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.285 | acc=1.0000 | 4596.3 samples/s | 71.8 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00104 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.285 | acc=1.0000 | 4709.7 samples/s | 73.6 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00089 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.285 | acc=1.0000 | 4602.9 samples/s | 71.9 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00078 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.285 | acc=1.0000 | 4724.9 samples/s | 73.8 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00069 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.285 | acc=1.0000 | 4724.1 samples/s | 73.8 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00063 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.285 | acc=1.0000 | 4743.5 samples/s | 74.1 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00057 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.285 | acc=1.0000 | 1480.2 samples/s | 23.1 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00052 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=3.285 | acc=1.0000 | 4851.6 samples/s | 75.8 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00048 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.285 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00045 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.285 | acc=1.0000 | 4648.2 samples/s | 72.6 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00042 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.285 | acc=1.0000 | 4666.0 samples/s | 72.9 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00039 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.285 | acc=1.0000 | 4651.3 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24307 | acc=0.8784 | tpr=0.8276 | fpr=0.0111 | 4368.3 samples/s | 17.1 steps/s
Avg test loss: 0.25030, Avg test acc: 0.87635, Avg tpr: 0.82544, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.46748 | acc=0.8900 | tpr=0.9469 | fpr=0.1110 | 4404.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.46958 | acc=0.8915 | tpr=0.9638 | fpr=0.1098 | 9132.1 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.47686 | acc=0.8901 | tpr=0.9697 | fpr=0.1113 | 8499.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.48128 | acc=0.8895 | tpr=0.9683 | fpr=0.1120 | 8972.3 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.47499 | acc=0.8899 | tpr=0.9651 | fpr=0.1115 | 8578.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.47753 | acc=0.8904 | tpr=0.9644 | fpr=0.1110 | 8825.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.47963 | acc=0.8905 | tpr=0.9631 | fpr=0.1108 | 9086.0 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.48089 | acc=0.8904 | tpr=0.9650 | fpr=0.1110 | 8724.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.48595 | acc=0.8903 | tpr=0.9654 | fpr=0.1111 | 8797.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.48625 | acc=0.8900 | tpr=0.9652 | fpr=0.1114 | 8805.3 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.48465 | acc=0.8902 | tpr=0.9658 | fpr=0.1112 | 15486.6 samples/s | 60.5 steps/s
Avg test loss: 0.48438, Avg test acc: 0.89020, Avg tpr: 0.96593, Avg fpr: 0.11118, total FA: 15437

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.20168 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.296 | acc=0.8594 | 3541.9 samples/s | 55.3 steps/s
[Step=35250 Epoch=34.4] | Loss=0.02228 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.294 | acc=0.9844 | 4904.1 samples/s | 76.6 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01432 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.294 | acc=1.0000 | 4775.9 samples/s | 74.6 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01135 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.295 | acc=1.0000 | 4829.2 samples/s | 75.5 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00994 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.296 | acc=1.0000 | 4881.2 samples/s | 76.3 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00891 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.297 | acc=1.0000 | 4881.9 samples/s | 76.3 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00842 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.299 | acc=1.0000 | 4753.8 samples/s | 74.3 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00824 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.300 | acc=1.0000 | 5068.2 samples/s | 79.2 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00784 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.301 | acc=1.0000 | 4864.8 samples/s | 76.0 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00772 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=3.302 | acc=1.0000 | 4898.7 samples/s | 76.5 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00753 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=3.303 | acc=1.0000 | 4875.6 samples/s | 76.2 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00734 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.304 | acc=0.9688 | 4868.1 samples/s | 76.1 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00736 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.305 | acc=0.9688 | 4855.9 samples/s | 75.9 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00736 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.306 | acc=0.9844 | 4618.4 samples/s | 72.2 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00731 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.307 | acc=1.0000 | 3889.0 samples/s | 60.8 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00725 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.308 | acc=1.0000 | 3849.6 samples/s | 60.1 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00715 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.308 | acc=1.0000 | 3864.9 samples/s | 60.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.04866 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.297 | acc=0.9844 | 2879.3 samples/s | 45.0 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00523 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.300 | acc=1.0000 | 4402.4 samples/s | 68.8 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00264 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.300 | acc=1.0000 | 4714.2 samples/s | 73.7 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00177 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.301 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00133 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.301 | acc=1.0000 | 4736.5 samples/s | 74.0 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00107 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.301 | acc=1.0000 | 4722.0 samples/s | 73.8 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00090 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.302 | acc=1.0000 | 4635.8 samples/s | 72.4 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00077 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.302 | acc=1.0000 | 4839.0 samples/s | 75.6 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00067 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.302 | acc=1.0000 | 4687.5 samples/s | 73.2 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00060 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=3.302 | acc=1.0000 | 4621.1 samples/s | 72.2 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00054 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.302 | acc=1.0000 | 4705.8 samples/s | 73.5 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00049 | Reg=0.00191 | L2-Norm=13.802 | L2-Norm(final)=3.302 | acc=1.0000 | 1492.5 samples/s | 23.3 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00045 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=3.302 | acc=1.0000 | 4553.4 samples/s | 71.1 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00042 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.302 | acc=1.0000 | 4647.4 samples/s | 72.6 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00039 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.303 | acc=1.0000 | 4762.7 samples/s | 74.4 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00036 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.303 | acc=1.0000 | 4781.1 samples/s | 74.7 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00034 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.303 | acc=1.0000 | 4816.0 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23526 | acc=0.8850 | tpr=0.8372 | fpr=0.0111 | 4448.2 samples/s | 17.4 steps/s
Avg test loss: 0.24256, Avg test acc: 0.88300, Avg tpr: 0.83523, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.48893 | acc=0.8854 | tpr=0.9469 | fpr=0.1157 | 4473.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.48897 | acc=0.8878 | tpr=0.9638 | fpr=0.1136 | 8559.2 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.49540 | acc=0.8863 | tpr=0.9697 | fpr=0.1152 | 9162.6 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.49951 | acc=0.8858 | tpr=0.9705 | fpr=0.1157 | 8786.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.49291 | acc=0.8862 | tpr=0.9668 | fpr=0.1152 | 8915.0 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.49575 | acc=0.8866 | tpr=0.9658 | fpr=0.1148 | 9111.2 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.49833 | acc=0.8865 | tpr=0.9649 | fpr=0.1149 | 8819.6 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.49943 | acc=0.8867 | tpr=0.9672 | fpr=0.1147 | 8809.7 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.50469 | acc=0.8866 | tpr=0.9674 | fpr=0.1149 | 8856.3 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.50503 | acc=0.8862 | tpr=0.9670 | fpr=0.1152 | 8675.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.50360 | acc=0.8866 | tpr=0.9678 | fpr=0.1149 | 16674.3 samples/s | 65.1 steps/s
Avg test loss: 0.50337, Avg test acc: 0.88661, Avg tpr: 0.96791, Avg fpr: 0.11487, total FA: 15949

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.14580 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.311 | acc=0.9062 | 3849.7 samples/s | 60.2 steps/s
[Step=36050 Epoch=35.2] | Loss=0.02022 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.309 | acc=0.9844 | 4613.0 samples/s | 72.1 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01304 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.310 | acc=1.0000 | 4921.9 samples/s | 76.9 steps/s
[Step=36150 Epoch=35.3] | Loss=0.01043 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.311 | acc=1.0000 | 4828.1 samples/s | 75.4 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00914 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.312 | acc=1.0000 | 4987.4 samples/s | 77.9 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00863 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=3.313 | acc=1.0000 | 4868.9 samples/s | 76.1 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00819 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.314 | acc=0.9688 | 4962.3 samples/s | 77.5 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00783 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.315 | acc=1.0000 | 4857.0 samples/s | 75.9 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00769 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.316 | acc=1.0000 | 4921.2 samples/s | 76.9 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00751 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.317 | acc=1.0000 | 4901.7 samples/s | 76.6 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00722 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.318 | acc=1.0000 | 5109.1 samples/s | 79.8 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00701 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.319 | acc=1.0000 | 4962.5 samples/s | 77.5 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00689 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.320 | acc=1.0000 | 4923.3 samples/s | 76.9 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00692 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.321 | acc=1.0000 | 5033.5 samples/s | 78.6 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00707 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.322 | acc=0.9688 | 4871.9 samples/s | 76.1 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00700 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.323 | acc=1.0000 | 4942.4 samples/s | 77.2 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00697 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.323 | acc=1.0000 | 4964.3 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.08014 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.311 | acc=0.9688 | 3568.3 samples/s | 55.8 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00408 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.315 | acc=1.0000 | 4662.8 samples/s | 72.9 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00205 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.316 | acc=1.0000 | 4651.0 samples/s | 72.7 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00138 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.317 | acc=1.0000 | 4688.4 samples/s | 73.3 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00105 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.317 | acc=1.0000 | 4683.9 samples/s | 73.2 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00084 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.317 | acc=1.0000 | 4712.5 samples/s | 73.6 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00070 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.318 | acc=1.0000 | 4814.3 samples/s | 75.2 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00060 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.318 | acc=1.0000 | 4727.8 samples/s | 73.9 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00053 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.318 | acc=1.0000 | 4766.6 samples/s | 74.5 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00047 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.318 | acc=1.0000 | 4619.9 samples/s | 72.2 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00043 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.319 | acc=1.0000 | 4607.9 samples/s | 72.0 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00039 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.319 | acc=1.0000 | 1566.8 samples/s | 24.5 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00036 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.319 | acc=1.0000 | 4769.8 samples/s | 74.5 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00033 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.319 | acc=1.0000 | 4686.3 samples/s | 73.2 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00031 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.319 | acc=1.0000 | 4714.8 samples/s | 73.7 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00029 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.319 | acc=1.0000 | 4869.5 samples/s | 76.1 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00027 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.319 | acc=1.0000 | 4891.0 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21076 | acc=0.8970 | tpr=0.8555 | fpr=0.0131 | 4416.8 samples/s | 17.3 steps/s
Avg test loss: 0.21783, Avg test acc: 0.89458, Avg tpr: 0.85277, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.53694 | acc=0.8728 | tpr=0.9513 | fpr=0.1286 | 4475.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.53450 | acc=0.8760 | tpr=0.9638 | fpr=0.1256 | 8739.8 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.54093 | acc=0.8749 | tpr=0.9712 | fpr=0.1269 | 8757.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.54466 | acc=0.8744 | tpr=0.9716 | fpr=0.1274 | 9191.3 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.53808 | acc=0.8751 | tpr=0.9677 | fpr=0.1265 | 8622.9 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.54078 | acc=0.8755 | tpr=0.9651 | fpr=0.1262 | 9057.4 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.54371 | acc=0.8752 | tpr=0.9643 | fpr=0.1264 | 8885.9 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.54473 | acc=0.8754 | tpr=0.9666 | fpr=0.1262 | 8874.4 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.55028 | acc=0.8754 | tpr=0.9674 | fpr=0.1263 | 8803.4 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.55054 | acc=0.8751 | tpr=0.9670 | fpr=0.1266 | 9015.4 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.54887 | acc=0.8753 | tpr=0.9674 | fpr=0.1264 | 15830.6 samples/s | 61.8 steps/s
Avg test loss: 0.54858, Avg test acc: 0.87530, Avg tpr: 0.96751, Avg fpr: 0.12638, total FA: 17547

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.04186 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.328 | acc=0.9688 | 3667.4 samples/s | 57.3 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02299 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.325 | acc=1.0000 | 4913.1 samples/s | 76.8 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01482 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.325 | acc=0.9844 | 4876.1 samples/s | 76.2 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01191 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.326 | acc=1.0000 | 4768.6 samples/s | 74.5 steps/s
[Step=37000 Epoch=36.1] | Loss=0.01037 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=3.327 | acc=1.0000 | 3949.2 samples/s | 61.7 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00923 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.327 | acc=1.0000 | 3884.5 samples/s | 60.7 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00852 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.329 | acc=1.0000 | 3883.8 samples/s | 60.7 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00822 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.330 | acc=1.0000 | 3887.9 samples/s | 60.7 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00796 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.330 | acc=0.9844 | 3901.6 samples/s | 61.0 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00766 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.331 | acc=1.0000 | 3880.5 samples/s | 60.6 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00761 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.332 | acc=1.0000 | 3891.9 samples/s | 60.8 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00746 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.333 | acc=0.9844 | 3909.5 samples/s | 61.1 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00723 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.334 | acc=1.0000 | 3859.5 samples/s | 60.3 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00712 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.335 | acc=1.0000 | 3882.8 samples/s | 60.7 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00714 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.335 | acc=1.0000 | 3857.0 samples/s | 60.3 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00705 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.336 | acc=1.0000 | 3859.3 samples/s | 60.3 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00688 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.337 | acc=1.0000 | 3809.7 samples/s | 59.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.03350 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.328 | acc=0.9844 | 2886.6 samples/s | 45.1 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00631 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.333 | acc=1.0000 | 4306.9 samples/s | 67.3 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00316 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.334 | acc=1.0000 | 4733.0 samples/s | 74.0 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00211 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.334 | acc=1.0000 | 4760.8 samples/s | 74.4 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00158 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.335 | acc=1.0000 | 4632.7 samples/s | 72.4 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00127 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.335 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00106 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.335 | acc=1.0000 | 4641.7 samples/s | 72.5 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00091 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=3.335 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00079 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.335 | acc=1.0000 | 4797.8 samples/s | 75.0 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00071 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.335 | acc=1.0000 | 4593.6 samples/s | 71.8 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00064 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.335 | acc=1.0000 | 4751.3 samples/s | 74.2 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00058 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.335 | acc=1.0000 | 1477.4 samples/s | 23.1 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00053 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.335 | acc=1.0000 | 4797.1 samples/s | 75.0 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00049 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.335 | acc=1.0000 | 4665.2 samples/s | 72.9 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00046 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.335 | acc=1.0000 | 4716.1 samples/s | 73.7 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00043 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.335 | acc=1.0000 | 4643.5 samples/s | 72.6 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00040 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.335 | acc=1.0000 | 4840.8 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25045 | acc=0.8777 | tpr=0.8272 | fpr=0.0126 | 4432.3 samples/s | 17.3 steps/s
Avg test loss: 0.25819, Avg test acc: 0.87547, Avg tpr: 0.82479, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.44830 | acc=0.9028 | tpr=0.9513 | fpr=0.0981 | 4468.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.44842 | acc=0.9054 | tpr=0.9659 | fpr=0.0958 | 8759.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.45404 | acc=0.9037 | tpr=0.9712 | fpr=0.0975 | 8874.3 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.45839 | acc=0.9031 | tpr=0.9705 | fpr=0.0982 | 9075.7 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.45214 | acc=0.9031 | tpr=0.9668 | fpr=0.0980 | 9077.1 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.45551 | acc=0.9033 | tpr=0.9651 | fpr=0.0979 | 8853.0 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.45866 | acc=0.9030 | tpr=0.9637 | fpr=0.0981 | 8713.8 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.46035 | acc=0.9031 | tpr=0.9650 | fpr=0.0980 | 8676.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.46598 | acc=0.9029 | tpr=0.9654 | fpr=0.0982 | 9020.1 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.46586 | acc=0.9027 | tpr=0.9652 | fpr=0.0984 | 5442.5 samples/s | 21.3 steps/s
[Step= 550] | Loss=0.46444 | acc=0.9030 | tpr=0.9662 | fpr=0.0981 | 16561.5 samples/s | 64.7 steps/s
Avg test loss: 0.46408, Avg test acc: 0.90301, Avg tpr: 0.96632, Avg fpr: 0.09814, total FA: 13627

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.18116 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.341 | acc=0.8594 | 3590.6 samples/s | 56.1 steps/s
[Step=37650 Epoch=36.8] | Loss=0.02173 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.339 | acc=1.0000 | 4917.6 samples/s | 76.8 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01369 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.339 | acc=0.9844 | 4955.4 samples/s | 77.4 steps/s
[Step=37750 Epoch=36.9] | Loss=0.01081 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.340 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00938 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.341 | acc=1.0000 | 4897.8 samples/s | 76.5 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00872 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.342 | acc=1.0000 | 4910.1 samples/s | 76.7 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00807 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=3.343 | acc=1.0000 | 4942.9 samples/s | 77.2 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00789 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.344 | acc=0.9688 | 5021.5 samples/s | 78.5 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00775 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.345 | acc=0.9844 | 4948.3 samples/s | 77.3 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00755 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.346 | acc=1.0000 | 4996.9 samples/s | 78.1 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00736 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.347 | acc=0.9844 | 4607.5 samples/s | 72.0 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00741 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.347 | acc=1.0000 | 3857.5 samples/s | 60.3 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00731 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.348 | acc=1.0000 | 3904.9 samples/s | 61.0 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00723 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=3.349 | acc=1.0000 | 3817.4 samples/s | 59.6 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00707 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=3.350 | acc=1.0000 | 3869.7 samples/s | 60.5 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00699 | Reg=0.00191 | L2-Norm=13.802 | L2-Norm(final)=3.351 | acc=1.0000 | 3827.7 samples/s | 59.8 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00695 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.351 | acc=1.0000 | 3849.4 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00313 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.341 | acc=1.0000 | 2908.5 samples/s | 45.4 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00353 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.345 | acc=1.0000 | 4539.2 samples/s | 70.9 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00179 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.346 | acc=1.0000 | 4655.4 samples/s | 72.7 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00120 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.347 | acc=1.0000 | 4638.4 samples/s | 72.5 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00091 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.347 | acc=1.0000 | 4653.3 samples/s | 72.7 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00073 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.347 | acc=1.0000 | 4657.6 samples/s | 72.8 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00061 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.348 | acc=1.0000 | 4645.8 samples/s | 72.6 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00053 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.348 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00046 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=3.348 | acc=1.0000 | 4674.5 samples/s | 73.0 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00042 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.348 | acc=1.0000 | 4719.9 samples/s | 73.7 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00038 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.348 | acc=1.0000 | 4744.9 samples/s | 74.1 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00034 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.349 | acc=1.0000 | 1480.5 samples/s | 23.1 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00031 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.349 | acc=1.0000 | 4746.4 samples/s | 74.2 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00029 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.349 | acc=1.0000 | 4649.5 samples/s | 72.6 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00027 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=3.349 | acc=1.0000 | 4695.5 samples/s | 73.4 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00025 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.349 | acc=1.0000 | 4654.1 samples/s | 72.7 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00024 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=3.349 | acc=1.0000 | 4644.9 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23270 | acc=0.8878 | tpr=0.8413 | fpr=0.0111 | 4445.5 samples/s | 17.4 steps/s
Avg test loss: 0.24038, Avg test acc: 0.88565, Avg tpr: 0.83896, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.52589 | acc=0.8762 | tpr=0.9513 | fpr=0.1252 | 4430.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.52432 | acc=0.8786 | tpr=0.9638 | fpr=0.1230 | 8843.9 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.53024 | acc=0.8776 | tpr=0.9697 | fpr=0.1241 | 9483.7 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.53413 | acc=0.8772 | tpr=0.9683 | fpr=0.1245 | 8827.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.52748 | acc=0.8783 | tpr=0.9651 | fpr=0.1233 | 8429.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.52992 | acc=0.8784 | tpr=0.9629 | fpr=0.1231 | 9288.3 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.53321 | acc=0.8781 | tpr=0.9618 | fpr=0.1234 | 8744.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.53425 | acc=0.8784 | tpr=0.9633 | fpr=0.1231 | 8568.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.54020 | acc=0.8784 | tpr=0.9640 | fpr=0.1232 | 5994.8 samples/s | 23.4 steps/s
[Step= 500] | Loss=0.54046 | acc=0.8780 | tpr=0.9639 | fpr=0.1235 | 8990.5 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.53870 | acc=0.8784 | tpr=0.9646 | fpr=0.1232 | 16756.2 samples/s | 65.5 steps/s
Avg test loss: 0.53844, Avg test acc: 0.87841, Avg tpr: 0.96474, Avg fpr: 0.12316, total FA: 17101

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.09126 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.357 | acc=0.9062 | 3818.0 samples/s | 59.7 steps/s
[Step=38450 Epoch=37.5] | Loss=0.02106 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=3.356 | acc=0.9844 | 4452.7 samples/s | 69.6 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01371 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.356 | acc=1.0000 | 4927.8 samples/s | 77.0 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01077 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.357 | acc=1.0000 | 4817.1 samples/s | 75.3 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00941 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=3.358 | acc=0.9844 | 4914.5 samples/s | 76.8 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00841 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=3.359 | acc=0.9844 | 4841.0 samples/s | 75.6 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00796 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.360 | acc=0.9844 | 4834.0 samples/s | 75.5 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00750 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.361 | acc=1.0000 | 4329.1 samples/s | 67.6 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00720 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.362 | acc=1.0000 | 3857.6 samples/s | 60.3 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00708 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.362 | acc=1.0000 | 3863.8 samples/s | 60.4 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00698 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.363 | acc=1.0000 | 3924.9 samples/s | 61.3 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00701 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.364 | acc=0.9844 | 3820.5 samples/s | 59.7 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00697 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.365 | acc=0.9844 | 3838.6 samples/s | 60.0 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00692 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.365 | acc=0.9531 | 3848.3 samples/s | 60.1 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00688 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.366 | acc=1.0000 | 3878.9 samples/s | 60.6 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00676 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.367 | acc=0.9844 | 3797.1 samples/s | 59.3 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00678 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.367 | acc=1.0000 | 3845.2 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.00744 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.357 | acc=1.0000 | 3004.8 samples/s | 46.9 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00426 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.361 | acc=1.0000 | 4555.4 samples/s | 71.2 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00214 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.361 | acc=1.0000 | 4775.0 samples/s | 74.6 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00143 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.361 | acc=1.0000 | 4673.6 samples/s | 73.0 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00107 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.362 | acc=1.0000 | 4727.3 samples/s | 73.9 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00086 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.362 | acc=1.0000 | 4757.0 samples/s | 74.3 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00072 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=3.362 | acc=1.0000 | 4597.2 samples/s | 71.8 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00062 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=3.362 | acc=1.0000 | 4779.5 samples/s | 74.7 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00054 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.362 | acc=1.0000 | 4682.4 samples/s | 73.2 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00048 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.362 | acc=1.0000 | 4726.5 samples/s | 73.9 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00043 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.362 | acc=1.0000 | 4822.2 samples/s | 75.3 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00039 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=3.362 | acc=1.0000 | 1504.5 samples/s | 23.5 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00036 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=3.362 | acc=1.0000 | 4858.2 samples/s | 75.9 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00033 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.362 | acc=1.0000 | 4666.7 samples/s | 72.9 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00031 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.362 | acc=1.0000 | 4692.4 samples/s | 73.3 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00029 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.362 | acc=1.0000 | 4612.5 samples/s | 72.1 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00027 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=3.362 | acc=1.0000 | 4739.2 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26422 | acc=0.8741 | tpr=0.8207 | fpr=0.0102 | 4406.2 samples/s | 17.2 steps/s
Avg test loss: 0.27186, Avg test acc: 0.87198, Avg tpr: 0.81897, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.46329 | acc=0.8955 | tpr=0.9469 | fpr=0.1055 | 4425.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.46284 | acc=0.8983 | tpr=0.9638 | fpr=0.1029 | 9113.1 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.46888 | acc=0.8965 | tpr=0.9697 | fpr=0.1048 | 8398.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.47329 | acc=0.8960 | tpr=0.9683 | fpr=0.1053 | 8744.0 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.46725 | acc=0.8962 | tpr=0.9651 | fpr=0.1051 | 9035.3 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.47007 | acc=0.8963 | tpr=0.9629 | fpr=0.1049 | 8739.5 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.47301 | acc=0.8962 | tpr=0.9618 | fpr=0.1049 | 5559.2 samples/s | 21.7 steps/s
[Step= 400] | Loss=0.47435 | acc=0.8963 | tpr=0.9644 | fpr=0.1049 | 9114.2 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.48015 | acc=0.8962 | tpr=0.9645 | fpr=0.1051 | 8486.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.48032 | acc=0.8959 | tpr=0.9634 | fpr=0.1054 | 8640.4 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.47863 | acc=0.8962 | tpr=0.9642 | fpr=0.1050 | 16998.7 samples/s | 66.4 steps/s
Avg test loss: 0.47835, Avg test acc: 0.89622, Avg tpr: 0.96434, Avg fpr: 0.10501, total FA: 14581

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.10658 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=3.369 | acc=0.9062 | 3703.7 samples/s | 57.9 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01978 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.367 | acc=0.9844 | 4618.5 samples/s | 72.2 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01308 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.368 | acc=1.0000 | 4740.5 samples/s | 74.1 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01086 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=3.368 | acc=1.0000 | 5022.4 samples/s | 78.5 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00986 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.369 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00913 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=3.370 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00848 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=3.371 | acc=1.0000 | 4981.7 samples/s | 77.8 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00829 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.372 | acc=0.9844 | 4768.2 samples/s | 74.5 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00789 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.373 | acc=0.9844 | 3856.9 samples/s | 60.3 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00765 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.374 | acc=0.9688 | 3865.6 samples/s | 60.4 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00752 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.374 | acc=1.0000 | 3848.7 samples/s | 60.1 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00732 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.375 | acc=0.9844 | 3950.0 samples/s | 61.7 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00707 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.376 | acc=1.0000 | 3838.2 samples/s | 60.0 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00692 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.377 | acc=1.0000 | 3888.5 samples/s | 60.8 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00693 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.378 | acc=1.0000 | 3817.5 samples/s | 59.6 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00689 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.378 | acc=1.0000 | 3852.6 samples/s | 60.2 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00688 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.379 | acc=1.0000 | 3826.3 samples/s | 59.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.06461 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=3.370 | acc=0.9531 | 2936.1 samples/s | 45.9 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00524 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=3.373 | acc=1.0000 | 4461.9 samples/s | 69.7 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00267 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.373 | acc=1.0000 | 4634.4 samples/s | 72.4 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00178 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.373 | acc=1.0000 | 4716.6 samples/s | 73.7 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00134 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.373 | acc=1.0000 | 4722.3 samples/s | 73.8 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00107 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.373 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00089 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.373 | acc=1.0000 | 4716.8 samples/s | 73.7 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00077 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.373 | acc=1.0000 | 4679.7 samples/s | 73.1 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00067 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=3.373 | acc=1.0000 | 4626.7 samples/s | 72.3 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00060 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.373 | acc=1.0000 | 4619.2 samples/s | 72.2 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00054 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.373 | acc=1.0000 | 4691.4 samples/s | 73.3 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00049 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=3.373 | acc=1.0000 | 1507.2 samples/s | 23.6 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00045 | Reg=0.00190 | L2-Norm=13.775 | L2-Norm(final)=3.373 | acc=1.0000 | 4716.7 samples/s | 73.7 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00041 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=3.373 | acc=1.0000 | 4701.4 samples/s | 73.5 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00039 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=3.373 | acc=1.0000 | 4611.8 samples/s | 72.1 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00036 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.373 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00034 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.374 | acc=1.0000 | 4711.4 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23378 | acc=0.8858 | tpr=0.8388 | fpr=0.0121 | 4473.6 samples/s | 17.5 steps/s
Avg test loss: 0.24043, Avg test acc: 0.88268, Avg tpr: 0.83534, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.47616 | acc=0.8934 | tpr=0.9469 | fpr=0.1076 | 4464.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.47662 | acc=0.8958 | tpr=0.9638 | fpr=0.1054 | 8396.6 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.48358 | acc=0.8942 | tpr=0.9712 | fpr=0.1072 | 8776.1 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.48808 | acc=0.8941 | tpr=0.9694 | fpr=0.1072 | 9394.9 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.48195 | acc=0.8945 | tpr=0.9659 | fpr=0.1068 | 5681.2 samples/s | 22.2 steps/s
[Step= 300] | Loss=0.48470 | acc=0.8946 | tpr=0.9636 | fpr=0.1067 | 8616.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.48775 | acc=0.8944 | tpr=0.9631 | fpr=0.1068 | 8932.4 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.48898 | acc=0.8944 | tpr=0.9655 | fpr=0.1069 | 9034.9 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.49480 | acc=0.8942 | tpr=0.9664 | fpr=0.1072 | 8296.5 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.49500 | acc=0.8940 | tpr=0.9661 | fpr=0.1073 | 9092.2 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.49310 | acc=0.8944 | tpr=0.9666 | fpr=0.1069 | 15424.1 samples/s | 60.3 steps/s
Avg test loss: 0.49280, Avg test acc: 0.89443, Avg tpr: 0.96672, Avg fpr: 0.10688, total FA: 14840
