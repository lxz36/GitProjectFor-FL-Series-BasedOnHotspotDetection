Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37606 | Reg=0.00354 | L2-Norm=18.827 | L2-Norm(final)=1.989 | acc=0.4688 | 2795.0 samples/s | 43.7 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29887 | Reg=0.00342 | L2-Norm=18.501 | L2-Norm(final)=1.986 | acc=0.8281 | 5195.5 samples/s | 81.2 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25979 | Reg=0.00336 | L2-Norm=18.342 | L2-Norm(final)=2.000 | acc=0.7969 | 4780.5 samples/s | 74.7 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22823 | Reg=0.00332 | L2-Norm=18.229 | L2-Norm(final)=2.008 | acc=0.7656 | 4847.0 samples/s | 75.7 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20891 | Reg=0.00329 | L2-Norm=18.139 | L2-Norm(final)=2.015 | acc=0.8906 | 4942.4 samples/s | 77.2 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19330 | Reg=0.00326 | L2-Norm=18.065 | L2-Norm(final)=2.022 | acc=0.9375 | 4930.5 samples/s | 77.0 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18271 | Reg=0.00324 | L2-Norm=18.001 | L2-Norm(final)=2.028 | acc=0.9375 | 5026.9 samples/s | 78.5 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17444 | Reg=0.00322 | L2-Norm=17.947 | L2-Norm(final)=2.032 | acc=0.8750 | 5014.3 samples/s | 78.3 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16821 | Reg=0.00321 | L2-Norm=17.902 | L2-Norm(final)=2.036 | acc=0.8906 | 4942.8 samples/s | 77.2 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16255 | Reg=0.00319 | L2-Norm=17.863 | L2-Norm(final)=2.039 | acc=0.9219 | 4966.6 samples/s | 77.6 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15557 | Reg=0.00318 | L2-Norm=17.829 | L2-Norm(final)=2.043 | acc=0.9219 | 4970.7 samples/s | 77.7 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15017 | Reg=0.00317 | L2-Norm=17.799 | L2-Norm(final)=2.047 | acc=0.8906 | 5077.2 samples/s | 79.3 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14517 | Reg=0.00316 | L2-Norm=17.773 | L2-Norm(final)=2.050 | acc=0.9375 | 5020.9 samples/s | 78.5 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14094 | Reg=0.00315 | L2-Norm=17.750 | L2-Norm(final)=2.053 | acc=0.9219 | 4937.3 samples/s | 77.1 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13699 | Reg=0.00314 | L2-Norm=17.729 | L2-Norm(final)=2.056 | acc=0.9688 | 5012.5 samples/s | 78.3 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13370 | Reg=0.00314 | L2-Norm=17.711 | L2-Norm(final)=2.058 | acc=0.9688 | 4953.4 samples/s | 77.4 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13024 | Reg=0.00313 | L2-Norm=17.695 | L2-Norm(final)=2.061 | acc=0.9688 | 4983.7 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37524 | Reg=0.00354 | L2-Norm=18.827 | L2-Norm(final)=1.989 | acc=0.5469 | 3547.5 samples/s | 55.4 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.15735 | Reg=0.00347 | L2-Norm=18.631 | L2-Norm(final)=2.011 | acc=0.9375 | 4588.7 samples/s | 71.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.10496 | Reg=0.00344 | L2-Norm=18.549 | L2-Norm(final)=2.024 | acc=0.9531 | 4681.1 samples/s | 73.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.07803 | Reg=0.00341 | L2-Norm=18.476 | L2-Norm(final)=2.033 | acc=0.9844 | 4600.4 samples/s | 71.9 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06295 | Reg=0.00339 | L2-Norm=18.412 | L2-Norm(final)=2.042 | acc=1.0000 | 4593.7 samples/s | 71.8 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05300 | Reg=0.00337 | L2-Norm=18.350 | L2-Norm(final)=2.050 | acc=1.0000 | 4576.6 samples/s | 71.5 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.04519 | Reg=0.00335 | L2-Norm=18.289 | L2-Norm(final)=2.056 | acc=1.0000 | 4542.5 samples/s | 71.0 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04022 | Reg=0.00332 | L2-Norm=18.229 | L2-Norm(final)=2.062 | acc=0.9688 | 4745.6 samples/s | 74.2 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.03666 | Reg=0.00330 | L2-Norm=18.173 | L2-Norm(final)=2.066 | acc=1.0000 | 4678.2 samples/s | 73.1 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03323 | Reg=0.00328 | L2-Norm=18.121 | L2-Norm(final)=2.070 | acc=1.0000 | 4848.2 samples/s | 75.8 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03068 | Reg=0.00327 | L2-Norm=18.073 | L2-Norm(final)=2.075 | acc=1.0000 | 4942.1 samples/s | 77.2 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.02842 | Reg=0.00325 | L2-Norm=18.027 | L2-Norm(final)=2.078 | acc=0.9844 | 2031.1 samples/s | 31.7 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02621 | Reg=0.00323 | L2-Norm=17.982 | L2-Norm(final)=2.082 | acc=1.0000 | 4903.8 samples/s | 76.6 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02426 | Reg=0.00322 | L2-Norm=17.937 | L2-Norm(final)=2.086 | acc=1.0000 | 4827.1 samples/s | 75.4 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02264 | Reg=0.00320 | L2-Norm=17.891 | L2-Norm(final)=2.090 | acc=1.0000 | 4819.3 samples/s | 75.3 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02134 | Reg=0.00319 | L2-Norm=17.847 | L2-Norm(final)=2.094 | acc=1.0000 | 4673.5 samples/s | 73.0 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02055 | Reg=0.00317 | L2-Norm=17.807 | L2-Norm(final)=2.097 | acc=1.0000 | 4840.6 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30357 | acc=0.6664 | tpr=0.6409 | fpr=0.2782 | 4370.8 samples/s | 17.1 steps/s
Avg test loss: 0.30396, Avg test acc: 0.66504, Avg tpr: 0.63782, Avg fpr: 0.27509, total FA: 2146

Testing server on iccad2012
[Step=  50] | Loss=0.28469 | acc=0.7474 | tpr=0.9735 | fpr=0.2566 | 4424.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.28601 | acc=0.7456 | tpr=0.9808 | fpr=0.2588 | 8911.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.28632 | acc=0.7448 | tpr=0.9813 | fpr=0.2596 | 8714.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.28704 | acc=0.7457 | tpr=0.9847 | fpr=0.2586 | 8839.8 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.28731 | acc=0.7445 | tpr=0.9878 | fpr=0.2599 | 8782.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.28684 | acc=0.7457 | tpr=0.9862 | fpr=0.2587 | 8864.8 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.28715 | acc=0.7449 | tpr=0.9850 | fpr=0.2594 | 9199.9 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.28731 | acc=0.7445 | tpr=0.9830 | fpr=0.2599 | 8424.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.28742 | acc=0.7448 | tpr=0.9820 | fpr=0.2595 | 8833.9 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.28745 | acc=0.7449 | tpr=0.9819 | fpr=0.2594 | 8581.5 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.28704 | acc=0.7453 | tpr=0.9821 | fpr=0.2590 | 16296.0 samples/s | 63.7 steps/s
Avg test loss: 0.28702, Avg test acc: 0.74537, Avg tpr: 0.98217, Avg fpr: 0.25894, total FA: 35953

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.27350 | Reg=0.00272 | L2-Norm=16.505 | L2-Norm(final)=2.101 | acc=0.7344 | 3929.2 samples/s | 61.4 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15962 | Reg=0.00278 | L2-Norm=16.676 | L2-Norm(final)=2.099 | acc=0.9219 | 4644.2 samples/s | 72.6 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13568 | Reg=0.00280 | L2-Norm=16.728 | L2-Norm(final)=2.107 | acc=0.9688 | 5066.9 samples/s | 79.2 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12617 | Reg=0.00280 | L2-Norm=16.744 | L2-Norm(final)=2.112 | acc=0.8750 | 5081.5 samples/s | 79.4 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11964 | Reg=0.00281 | L2-Norm=16.749 | L2-Norm(final)=2.117 | acc=0.7812 | 5074.8 samples/s | 79.3 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11632 | Reg=0.00281 | L2-Norm=16.755 | L2-Norm(final)=2.118 | acc=0.8750 | 5112.6 samples/s | 79.9 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.11126 | Reg=0.00281 | L2-Norm=16.760 | L2-Norm(final)=2.121 | acc=0.9219 | 5105.3 samples/s | 79.8 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10784 | Reg=0.00281 | L2-Norm=16.765 | L2-Norm(final)=2.124 | acc=0.9062 | 5086.7 samples/s | 79.5 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10520 | Reg=0.00281 | L2-Norm=16.769 | L2-Norm(final)=2.126 | acc=0.9219 | 5081.9 samples/s | 79.4 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.10281 | Reg=0.00281 | L2-Norm=16.773 | L2-Norm(final)=2.128 | acc=0.9688 | 5071.4 samples/s | 79.2 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.10005 | Reg=0.00281 | L2-Norm=16.775 | L2-Norm(final)=2.129 | acc=0.9688 | 5124.8 samples/s | 80.1 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09695 | Reg=0.00281 | L2-Norm=16.775 | L2-Norm(final)=2.130 | acc=0.9531 | 5183.9 samples/s | 81.0 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09507 | Reg=0.00281 | L2-Norm=16.777 | L2-Norm(final)=2.132 | acc=0.9219 | 5015.5 samples/s | 78.4 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09286 | Reg=0.00282 | L2-Norm=16.779 | L2-Norm(final)=2.134 | acc=0.9531 | 5097.8 samples/s | 79.7 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09099 | Reg=0.00282 | L2-Norm=16.782 | L2-Norm(final)=2.135 | acc=0.9531 | 5040.6 samples/s | 78.8 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08954 | Reg=0.00282 | L2-Norm=16.784 | L2-Norm(final)=2.137 | acc=0.9062 | 4986.1 samples/s | 77.9 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08785 | Reg=0.00282 | L2-Norm=16.786 | L2-Norm(final)=2.138 | acc=0.9844 | 4963.1 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.16887 | Reg=0.00272 | L2-Norm=16.505 | L2-Norm(final)=2.102 | acc=0.8906 | 3666.6 samples/s | 57.3 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.04172 | Reg=0.00280 | L2-Norm=16.722 | L2-Norm(final)=2.115 | acc=1.0000 | 4474.0 samples/s | 69.9 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.02507 | Reg=0.00281 | L2-Norm=16.772 | L2-Norm(final)=2.115 | acc=1.0000 | 4747.2 samples/s | 74.2 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.01903 | Reg=0.00281 | L2-Norm=16.768 | L2-Norm(final)=2.119 | acc=0.9844 | 4735.1 samples/s | 74.0 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01544 | Reg=0.00281 | L2-Norm=16.752 | L2-Norm(final)=2.123 | acc=0.9688 | 4730.9 samples/s | 73.9 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01426 | Reg=0.00280 | L2-Norm=16.735 | L2-Norm(final)=2.126 | acc=1.0000 | 4635.0 samples/s | 72.4 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01309 | Reg=0.00279 | L2-Norm=16.718 | L2-Norm(final)=2.128 | acc=0.9844 | 4721.6 samples/s | 73.8 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01181 | Reg=0.00279 | L2-Norm=16.699 | L2-Norm(final)=2.129 | acc=1.0000 | 4723.3 samples/s | 73.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01047 | Reg=0.00278 | L2-Norm=16.678 | L2-Norm(final)=2.131 | acc=1.0000 | 4654.1 samples/s | 72.7 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.00962 | Reg=0.00277 | L2-Norm=16.655 | L2-Norm(final)=2.134 | acc=0.9844 | 4675.4 samples/s | 73.1 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00891 | Reg=0.00277 | L2-Norm=16.630 | L2-Norm(final)=2.136 | acc=1.0000 | 4758.2 samples/s | 74.3 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00838 | Reg=0.00276 | L2-Norm=16.604 | L2-Norm(final)=2.138 | acc=1.0000 | 1966.0 samples/s | 30.7 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00772 | Reg=0.00275 | L2-Norm=16.580 | L2-Norm(final)=2.140 | acc=1.0000 | 4708.0 samples/s | 73.6 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00721 | Reg=0.00274 | L2-Norm=16.554 | L2-Norm(final)=2.143 | acc=1.0000 | 4776.7 samples/s | 74.6 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00675 | Reg=0.00273 | L2-Norm=16.528 | L2-Norm(final)=2.145 | acc=1.0000 | 4792.3 samples/s | 74.9 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00636 | Reg=0.00272 | L2-Norm=16.502 | L2-Norm(final)=2.147 | acc=1.0000 | 4739.5 samples/s | 74.1 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00606 | Reg=0.00271 | L2-Norm=16.475 | L2-Norm(final)=2.150 | acc=1.0000 | 4681.6 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54311 | acc=0.4867 | tpr=0.2584 | fpr=0.0176 | 4344.4 samples/s | 17.0 steps/s
Avg test loss: 0.54731, Avg test acc: 0.48361, Avg tpr: 0.25750, Avg fpr: 0.01910, total FA: 149

Testing server on iccad2012
[Step=  50] | Loss=0.12231 | acc=0.9109 | tpr=0.9115 | fpr=0.0891 | 4493.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.12255 | acc=0.9112 | tpr=0.9190 | fpr=0.0889 | 8531.8 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.12274 | acc=0.9125 | tpr=0.9222 | fpr=0.0877 | 8943.1 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.12297 | acc=0.9129 | tpr=0.9290 | fpr=0.0874 | 8677.9 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.12250 | acc=0.9133 | tpr=0.9266 | fpr=0.0870 | 8754.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.12232 | acc=0.9137 | tpr=0.9280 | fpr=0.0865 | 8792.1 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.12249 | acc=0.9136 | tpr=0.9236 | fpr=0.0865 | 8770.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.12265 | acc=0.9138 | tpr=0.9207 | fpr=0.0863 | 9002.8 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.12287 | acc=0.9138 | tpr=0.9202 | fpr=0.0863 | 8715.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.12298 | acc=0.9137 | tpr=0.9225 | fpr=0.0864 | 8854.4 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.12256 | acc=0.9141 | tpr=0.9232 | fpr=0.0860 | 14728.6 samples/s | 57.5 steps/s
Avg test loss: 0.12256, Avg test acc: 0.91411, Avg tpr: 0.92353, Avg fpr: 0.08607, total FA: 11950

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.40714 | Reg=0.00252 | L2-Norm=15.886 | L2-Norm(final)=2.148 | acc=0.5938 | 3848.7 samples/s | 60.1 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.13075 | Reg=0.00259 | L2-Norm=16.079 | L2-Norm(final)=2.128 | acc=0.9375 | 4719.0 samples/s | 73.7 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10898 | Reg=0.00261 | L2-Norm=16.146 | L2-Norm(final)=2.137 | acc=0.9219 | 4995.0 samples/s | 78.0 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09761 | Reg=0.00262 | L2-Norm=16.178 | L2-Norm(final)=2.144 | acc=0.9375 | 5105.9 samples/s | 79.8 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09031 | Reg=0.00262 | L2-Norm=16.200 | L2-Norm(final)=2.152 | acc=0.9375 | 5025.3 samples/s | 78.5 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08657 | Reg=0.00263 | L2-Norm=16.216 | L2-Norm(final)=2.157 | acc=0.9062 | 4982.4 samples/s | 77.9 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08378 | Reg=0.00263 | L2-Norm=16.228 | L2-Norm(final)=2.161 | acc=0.8906 | 4966.4 samples/s | 77.6 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08222 | Reg=0.00264 | L2-Norm=16.240 | L2-Norm(final)=2.164 | acc=0.9531 | 5016.9 samples/s | 78.4 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.08055 | Reg=0.00264 | L2-Norm=16.252 | L2-Norm(final)=2.165 | acc=0.9844 | 4905.2 samples/s | 76.6 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07977 | Reg=0.00264 | L2-Norm=16.262 | L2-Norm(final)=2.166 | acc=0.9688 | 4989.2 samples/s | 78.0 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07796 | Reg=0.00265 | L2-Norm=16.273 | L2-Norm(final)=2.168 | acc=0.8750 | 5203.7 samples/s | 81.3 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07647 | Reg=0.00265 | L2-Norm=16.283 | L2-Norm(final)=2.170 | acc=0.9219 | 5122.3 samples/s | 80.0 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07494 | Reg=0.00265 | L2-Norm=16.291 | L2-Norm(final)=2.172 | acc=1.0000 | 4995.9 samples/s | 78.1 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07363 | Reg=0.00266 | L2-Norm=16.299 | L2-Norm(final)=2.174 | acc=0.9688 | 5124.1 samples/s | 80.1 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07261 | Reg=0.00266 | L2-Norm=16.307 | L2-Norm(final)=2.176 | acc=0.9219 | 5120.0 samples/s | 80.0 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07178 | Reg=0.00266 | L2-Norm=16.314 | L2-Norm(final)=2.177 | acc=0.9844 | 5044.1 samples/s | 78.8 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07066 | Reg=0.00266 | L2-Norm=16.322 | L2-Norm(final)=2.179 | acc=0.9062 | 5112.5 samples/s | 79.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.05681 | Reg=0.00252 | L2-Norm=15.886 | L2-Norm(final)=2.152 | acc=0.9688 | 3881.5 samples/s | 60.6 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02689 | Reg=0.00257 | L2-Norm=16.031 | L2-Norm(final)=2.165 | acc=0.9844 | 4070.8 samples/s | 63.6 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01765 | Reg=0.00259 | L2-Norm=16.095 | L2-Norm(final)=2.156 | acc=1.0000 | 4752.7 samples/s | 74.3 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01370 | Reg=0.00260 | L2-Norm=16.109 | L2-Norm(final)=2.157 | acc=1.0000 | 4561.7 samples/s | 71.3 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01288 | Reg=0.00260 | L2-Norm=16.110 | L2-Norm(final)=2.158 | acc=1.0000 | 4667.3 samples/s | 72.9 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01148 | Reg=0.00260 | L2-Norm=16.111 | L2-Norm(final)=2.159 | acc=1.0000 | 4681.0 samples/s | 73.1 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00991 | Reg=0.00259 | L2-Norm=16.105 | L2-Norm(final)=2.161 | acc=1.0000 | 4798.9 samples/s | 75.0 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00876 | Reg=0.00259 | L2-Norm=16.093 | L2-Norm(final)=2.163 | acc=1.0000 | 4717.8 samples/s | 73.7 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00778 | Reg=0.00259 | L2-Norm=16.078 | L2-Norm(final)=2.166 | acc=1.0000 | 4717.8 samples/s | 73.7 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00705 | Reg=0.00258 | L2-Norm=16.059 | L2-Norm(final)=2.169 | acc=1.0000 | 4729.5 samples/s | 73.9 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00641 | Reg=0.00257 | L2-Norm=16.038 | L2-Norm(final)=2.172 | acc=1.0000 | 4790.9 samples/s | 74.9 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00590 | Reg=0.00257 | L2-Norm=16.015 | L2-Norm(final)=2.175 | acc=1.0000 | 1939.8 samples/s | 30.3 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00548 | Reg=0.00256 | L2-Norm=15.992 | L2-Norm(final)=2.177 | acc=1.0000 | 4948.5 samples/s | 77.3 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00507 | Reg=0.00255 | L2-Norm=15.968 | L2-Norm(final)=2.180 | acc=1.0000 | 4784.5 samples/s | 74.8 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00472 | Reg=0.00254 | L2-Norm=15.943 | L2-Norm(final)=2.182 | acc=1.0000 | 4777.9 samples/s | 74.7 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00441 | Reg=0.00253 | L2-Norm=15.917 | L2-Norm(final)=2.184 | acc=1.0000 | 4784.6 samples/s | 74.8 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00416 | Reg=0.00253 | L2-Norm=15.889 | L2-Norm(final)=2.187 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39522 | acc=0.6470 | tpr=0.5066 | fpr=0.0483 | 4386.8 samples/s | 17.1 steps/s
Avg test loss: 0.39871, Avg test acc: 0.64352, Avg tpr: 0.50259, Avg fpr: 0.04653, total FA: 363

Testing server on iccad2012
[Step=  50] | Loss=0.25743 | acc=0.8105 | tpr=0.9735 | fpr=0.1924 | 4382.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.26023 | acc=0.8082 | tpr=0.9701 | fpr=0.1948 | 8964.1 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.26224 | acc=0.8075 | tpr=0.9741 | fpr=0.1956 | 8767.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.26134 | acc=0.8093 | tpr=0.9749 | fpr=0.1937 | 8742.7 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.26149 | acc=0.8083 | tpr=0.9755 | fpr=0.1948 | 8828.1 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.26110 | acc=0.8093 | tpr=0.9753 | fpr=0.1937 | 8523.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.26172 | acc=0.8092 | tpr=0.9737 | fpr=0.1938 | 8793.0 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.26226 | acc=0.8090 | tpr=0.9721 | fpr=0.1940 | 8843.5 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.26269 | acc=0.8088 | tpr=0.9718 | fpr=0.1942 | 8391.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.26318 | acc=0.8083 | tpr=0.9718 | fpr=0.1947 | 8790.9 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.26223 | acc=0.8089 | tpr=0.9706 | fpr=0.1940 | 15687.6 samples/s | 61.3 steps/s
Avg test loss: 0.26231, Avg test acc: 0.80887, Avg tpr: 0.97068, Avg fpr: 0.19407, total FA: 26946

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.30864 | Reg=0.00241 | L2-Norm=15.538 | L2-Norm(final)=2.206 | acc=0.7500 | 3882.8 samples/s | 60.7 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.09203 | Reg=0.00245 | L2-Norm=15.658 | L2-Norm(final)=2.211 | acc=0.9688 | 4623.7 samples/s | 72.2 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.08084 | Reg=0.00247 | L2-Norm=15.711 | L2-Norm(final)=2.216 | acc=0.9531 | 4922.7 samples/s | 76.9 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.07697 | Reg=0.00248 | L2-Norm=15.743 | L2-Norm(final)=2.219 | acc=0.9375 | 4959.6 samples/s | 77.5 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07441 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.219 | acc=0.9688 | 4935.7 samples/s | 77.1 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07153 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.221 | acc=0.9688 | 4944.2 samples/s | 77.3 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.06987 | Reg=0.00250 | L2-Norm=15.810 | L2-Norm(final)=2.224 | acc=1.0000 | 4965.0 samples/s | 77.6 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06810 | Reg=0.00251 | L2-Norm=15.827 | L2-Norm(final)=2.226 | acc=0.9062 | 4979.9 samples/s | 77.8 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06749 | Reg=0.00251 | L2-Norm=15.842 | L2-Norm(final)=2.226 | acc=0.9844 | 5025.7 samples/s | 78.5 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06625 | Reg=0.00251 | L2-Norm=15.856 | L2-Norm(final)=2.227 | acc=0.9688 | 4850.2 samples/s | 75.8 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06539 | Reg=0.00252 | L2-Norm=15.871 | L2-Norm(final)=2.228 | acc=0.9219 | 4939.9 samples/s | 77.2 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06574 | Reg=0.00252 | L2-Norm=15.887 | L2-Norm(final)=2.228 | acc=0.9219 | 4914.3 samples/s | 76.8 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06457 | Reg=0.00253 | L2-Norm=15.903 | L2-Norm(final)=2.228 | acc=0.9844 | 5005.2 samples/s | 78.2 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06376 | Reg=0.00254 | L2-Norm=15.921 | L2-Norm(final)=2.228 | acc=1.0000 | 4916.9 samples/s | 76.8 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06339 | Reg=0.00254 | L2-Norm=15.938 | L2-Norm(final)=2.228 | acc=0.8906 | 4957.7 samples/s | 77.5 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06295 | Reg=0.00255 | L2-Norm=15.954 | L2-Norm(final)=2.227 | acc=0.9531 | 5024.1 samples/s | 78.5 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06236 | Reg=0.00255 | L2-Norm=15.969 | L2-Norm(final)=2.227 | acc=0.9688 | 5017.9 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.12193 | Reg=0.00241 | L2-Norm=15.538 | L2-Norm(final)=2.207 | acc=0.9219 | 3536.7 samples/s | 55.3 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01613 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.210 | acc=1.0000 | 4510.5 samples/s | 70.5 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01317 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.204 | acc=1.0000 | 4812.0 samples/s | 75.2 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00965 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.204 | acc=1.0000 | 4812.1 samples/s | 75.2 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00767 | Reg=0.00249 | L2-Norm=15.782 | L2-Norm(final)=2.208 | acc=1.0000 | 4831.8 samples/s | 75.5 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00667 | Reg=0.00249 | L2-Norm=15.776 | L2-Norm(final)=2.213 | acc=1.0000 | 4791.4 samples/s | 74.9 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00629 | Reg=0.00249 | L2-Norm=15.764 | L2-Norm(final)=2.215 | acc=0.9688 | 4660.5 samples/s | 72.8 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00690 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.213 | acc=0.9844 | 4695.3 samples/s | 73.4 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00638 | Reg=0.00249 | L2-Norm=15.765 | L2-Norm(final)=2.212 | acc=1.0000 | 4761.3 samples/s | 74.4 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00586 | Reg=0.00249 | L2-Norm=15.765 | L2-Norm(final)=2.212 | acc=1.0000 | 4629.4 samples/s | 72.3 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00541 | Reg=0.00248 | L2-Norm=15.761 | L2-Norm(final)=2.212 | acc=1.0000 | 4844.3 samples/s | 75.7 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00525 | Reg=0.00248 | L2-Norm=15.754 | L2-Norm(final)=2.213 | acc=1.0000 | 2023.0 samples/s | 31.6 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00508 | Reg=0.00248 | L2-Norm=15.744 | L2-Norm(final)=2.213 | acc=1.0000 | 4891.9 samples/s | 76.4 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00474 | Reg=0.00248 | L2-Norm=15.734 | L2-Norm(final)=2.213 | acc=1.0000 | 4859.8 samples/s | 75.9 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00443 | Reg=0.00247 | L2-Norm=15.722 | L2-Norm(final)=2.213 | acc=1.0000 | 4614.9 samples/s | 72.1 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00414 | Reg=0.00247 | L2-Norm=15.709 | L2-Norm(final)=2.214 | acc=1.0000 | 4752.5 samples/s | 74.3 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00389 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.216 | acc=1.0000 | 4809.6 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47986 | acc=0.5794 | tpr=0.3990 | fpr=0.0290 | 4367.5 samples/s | 17.1 steps/s
Avg test loss: 0.48348, Avg test acc: 0.57677, Avg tpr: 0.39721, Avg fpr: 0.02833, total FA: 221

Testing server on iccad2012
[Step=  50] | Loss=0.20254 | acc=0.8650 | tpr=0.9602 | fpr=0.1367 | 4421.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.20472 | acc=0.8645 | tpr=0.9616 | fpr=0.1373 | 8843.1 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.20671 | acc=0.8636 | tpr=0.9683 | fpr=0.1384 | 9292.8 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.20694 | acc=0.8634 | tpr=0.9716 | fpr=0.1386 | 8105.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.20614 | acc=0.8636 | tpr=0.9738 | fpr=0.1384 | 8549.9 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.20645 | acc=0.8637 | tpr=0.9745 | fpr=0.1383 | 8429.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.20701 | acc=0.8630 | tpr=0.9743 | fpr=0.1390 | 8967.7 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.20770 | acc=0.8625 | tpr=0.9726 | fpr=0.1395 | 8733.4 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.20815 | acc=0.8627 | tpr=0.9722 | fpr=0.1393 | 8487.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.20868 | acc=0.8623 | tpr=0.9722 | fpr=0.1397 | 8609.6 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.20777 | acc=0.8631 | tpr=0.9717 | fpr=0.1388 | 15986.2 samples/s | 62.4 steps/s
Avg test loss: 0.20772, Avg test acc: 0.86316, Avg tpr: 0.97187, Avg fpr: 0.13881, total FA: 19274

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.41322 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.218 | acc=0.6250 | 3857.0 samples/s | 60.3 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.10772 | Reg=0.00241 | L2-Norm=15.513 | L2-Norm(final)=2.212 | acc=0.9375 | 4907.0 samples/s | 76.7 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.08430 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.222 | acc=0.9688 | 5108.5 samples/s | 79.8 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07532 | Reg=0.00244 | L2-Norm=15.629 | L2-Norm(final)=2.230 | acc=0.9219 | 5048.9 samples/s | 78.9 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.07075 | Reg=0.00245 | L2-Norm=15.659 | L2-Norm(final)=2.233 | acc=1.0000 | 5017.5 samples/s | 78.4 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06905 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.234 | acc=0.9062 | 4893.4 samples/s | 76.5 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06652 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.235 | acc=0.9375 | 4873.3 samples/s | 76.1 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06519 | Reg=0.00247 | L2-Norm=15.720 | L2-Norm(final)=2.237 | acc=0.9531 | 5013.3 samples/s | 78.3 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06392 | Reg=0.00248 | L2-Norm=15.737 | L2-Norm(final)=2.238 | acc=0.9062 | 5016.3 samples/s | 78.4 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.06216 | Reg=0.00248 | L2-Norm=15.752 | L2-Norm(final)=2.240 | acc=0.9688 | 5081.4 samples/s | 79.4 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.06118 | Reg=0.00249 | L2-Norm=15.766 | L2-Norm(final)=2.240 | acc=0.9688 | 5009.3 samples/s | 78.3 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.06007 | Reg=0.00249 | L2-Norm=15.780 | L2-Norm(final)=2.241 | acc=0.9531 | 5052.3 samples/s | 78.9 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05932 | Reg=0.00249 | L2-Norm=15.793 | L2-Norm(final)=2.241 | acc=0.9375 | 4889.2 samples/s | 76.4 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05873 | Reg=0.00250 | L2-Norm=15.807 | L2-Norm(final)=2.241 | acc=0.9688 | 4950.9 samples/s | 77.4 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05865 | Reg=0.00250 | L2-Norm=15.820 | L2-Norm(final)=2.241 | acc=0.9688 | 4996.9 samples/s | 78.1 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05825 | Reg=0.00251 | L2-Norm=15.834 | L2-Norm(final)=2.242 | acc=0.9531 | 4855.2 samples/s | 75.9 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05760 | Reg=0.00251 | L2-Norm=15.848 | L2-Norm(final)=2.241 | acc=0.9844 | 4972.5 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.05486 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.221 | acc=0.9375 | 3567.5 samples/s | 55.7 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00991 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.243 | acc=1.0000 | 4514.6 samples/s | 70.5 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00939 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.237 | acc=1.0000 | 4695.3 samples/s | 73.4 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00772 | Reg=0.00243 | L2-Norm=15.583 | L2-Norm(final)=2.233 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00700 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.231 | acc=0.9531 | 4614.8 samples/s | 72.1 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00612 | Reg=0.00244 | L2-Norm=15.607 | L2-Norm(final)=2.230 | acc=1.0000 | 4706.4 samples/s | 73.5 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00556 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.230 | acc=1.0000 | 4712.2 samples/s | 73.6 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00563 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.229 | acc=1.0000 | 4682.7 samples/s | 73.2 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00553 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.227 | acc=0.9844 | 4735.7 samples/s | 74.0 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00542 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.223 | acc=1.0000 | 4773.5 samples/s | 74.6 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00522 | Reg=0.00244 | L2-Norm=15.611 | L2-Norm(final)=2.220 | acc=1.0000 | 4714.8 samples/s | 73.7 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00506 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.217 | acc=1.0000 | 1964.7 samples/s | 30.7 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00477 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.215 | acc=1.0000 | 4892.1 samples/s | 76.4 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00442 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.213 | acc=1.0000 | 4732.5 samples/s | 73.9 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00412 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.213 | acc=1.0000 | 4842.0 samples/s | 75.7 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00385 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.212 | acc=1.0000 | 4788.2 samples/s | 74.8 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00362 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.212 | acc=1.0000 | 4770.2 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55940 | acc=0.5781 | tpr=0.3954 | fpr=0.0250 | 4479.9 samples/s | 17.5 steps/s
Avg test loss: 0.56022, Avg test acc: 0.57428, Avg tpr: 0.39203, Avg fpr: 0.02487, total FA: 194

Testing server on iccad2012
[Step=  50] | Loss=0.17504 | acc=0.9005 | tpr=0.9602 | fpr=0.1006 | 4484.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.17911 | acc=0.8981 | tpr=0.9701 | fpr=0.1032 | 8542.7 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.18257 | acc=0.8970 | tpr=0.9741 | fpr=0.1044 | 9000.8 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.18281 | acc=0.8973 | tpr=0.9760 | fpr=0.1042 | 9045.5 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.18303 | acc=0.8967 | tpr=0.9773 | fpr=0.1048 | 8138.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.18403 | acc=0.8961 | tpr=0.9731 | fpr=0.1053 | 9080.0 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.18473 | acc=0.8956 | tpr=0.9731 | fpr=0.1058 | 8651.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.18530 | acc=0.8952 | tpr=0.9721 | fpr=0.1062 | 8542.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.18613 | acc=0.8951 | tpr=0.9713 | fpr=0.1063 | 8871.1 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.18637 | acc=0.8950 | tpr=0.9714 | fpr=0.1064 | 8499.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.18537 | acc=0.8956 | tpr=0.9710 | fpr=0.1058 | 16102.0 samples/s | 62.9 steps/s
Avg test loss: 0.18535, Avg test acc: 0.89560, Avg tpr: 0.97108, Avg fpr: 0.10577, total FA: 14686

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.34643 | Reg=0.00234 | L2-Norm=15.284 | L2-Norm(final)=2.216 | acc=0.6875 | 3910.5 samples/s | 61.1 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.10182 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.205 | acc=0.9219 | 4696.7 samples/s | 73.4 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07884 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.217 | acc=0.9375 | 4799.4 samples/s | 75.0 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.07369 | Reg=0.00242 | L2-Norm=15.541 | L2-Norm(final)=2.219 | acc=0.9375 | 4856.6 samples/s | 75.9 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06858 | Reg=0.00242 | L2-Norm=15.569 | L2-Norm(final)=2.218 | acc=0.9688 | 5067.5 samples/s | 79.2 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06535 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.217 | acc=0.9844 | 5031.1 samples/s | 78.6 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06349 | Reg=0.00244 | L2-Norm=15.613 | L2-Norm(final)=2.215 | acc=0.9688 | 5056.8 samples/s | 79.0 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06129 | Reg=0.00245 | L2-Norm=15.636 | L2-Norm(final)=2.216 | acc=0.9531 | 5058.0 samples/s | 79.0 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05932 | Reg=0.00245 | L2-Norm=15.658 | L2-Norm(final)=2.217 | acc=0.9531 | 5195.3 samples/s | 81.2 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05848 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.216 | acc=0.9688 | 4977.9 samples/s | 77.8 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05753 | Reg=0.00246 | L2-Norm=15.696 | L2-Norm(final)=2.216 | acc=0.9375 | 4984.7 samples/s | 77.9 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05581 | Reg=0.00247 | L2-Norm=15.714 | L2-Norm(final)=2.217 | acc=0.9688 | 4929.4 samples/s | 77.0 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05481 | Reg=0.00248 | L2-Norm=15.732 | L2-Norm(final)=2.218 | acc=0.9531 | 4985.1 samples/s | 77.9 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05427 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.218 | acc=1.0000 | 4907.6 samples/s | 76.7 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05411 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.217 | acc=0.9219 | 5088.5 samples/s | 79.5 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05361 | Reg=0.00249 | L2-Norm=15.788 | L2-Norm(final)=2.215 | acc=0.9844 | 5100.7 samples/s | 79.7 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05400 | Reg=0.00250 | L2-Norm=15.805 | L2-Norm(final)=2.213 | acc=0.9844 | 5081.1 samples/s | 79.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.03547 | Reg=0.00234 | L2-Norm=15.284 | L2-Norm(final)=2.218 | acc=0.9844 | 3541.2 samples/s | 55.3 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00529 | Reg=0.00236 | L2-Norm=15.354 | L2-Norm(final)=2.242 | acc=1.0000 | 4729.4 samples/s | 73.9 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00353 | Reg=0.00236 | L2-Norm=15.374 | L2-Norm(final)=2.252 | acc=1.0000 | 4806.8 samples/s | 75.1 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00291 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.258 | acc=1.0000 | 4720.1 samples/s | 73.8 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00314 | Reg=0.00236 | L2-Norm=15.362 | L2-Norm(final)=2.260 | acc=1.0000 | 4632.7 samples/s | 72.4 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00300 | Reg=0.00236 | L2-Norm=15.361 | L2-Norm(final)=2.260 | acc=1.0000 | 4671.8 samples/s | 73.0 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00328 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.259 | acc=1.0000 | 4736.2 samples/s | 74.0 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00315 | Reg=0.00236 | L2-Norm=15.352 | L2-Norm(final)=2.255 | acc=1.0000 | 4664.7 samples/s | 72.9 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00286 | Reg=0.00235 | L2-Norm=15.346 | L2-Norm(final)=2.255 | acc=1.0000 | 4639.5 samples/s | 72.5 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00263 | Reg=0.00235 | L2-Norm=15.337 | L2-Norm(final)=2.255 | acc=1.0000 | 4613.6 samples/s | 72.1 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00312 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.254 | acc=1.0000 | 4734.8 samples/s | 74.0 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00309 | Reg=0.00235 | L2-Norm=15.326 | L2-Norm(final)=2.251 | acc=1.0000 | 1982.9 samples/s | 31.0 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00314 | Reg=0.00235 | L2-Norm=15.326 | L2-Norm(final)=2.248 | acc=1.0000 | 4812.4 samples/s | 75.2 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00299 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.246 | acc=1.0000 | 4668.0 samples/s | 72.9 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00293 | Reg=0.00235 | L2-Norm=15.322 | L2-Norm(final)=2.244 | acc=1.0000 | 4703.8 samples/s | 73.5 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00286 | Reg=0.00235 | L2-Norm=15.321 | L2-Norm(final)=2.242 | acc=1.0000 | 4648.3 samples/s | 72.6 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00280 | Reg=0.00235 | L2-Norm=15.319 | L2-Norm(final)=2.241 | acc=1.0000 | 4771.0 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50293 | acc=0.5876 | tpr=0.4060 | fpr=0.0181 | 4452.0 samples/s | 17.4 steps/s
Avg test loss: 0.50267, Avg test acc: 0.58578, Avg tpr: 0.40578, Avg fpr: 0.01833, total FA: 143

Testing server on iccad2012
[Step=  50] | Loss=0.17395 | acc=0.9001 | tpr=0.9513 | fpr=0.1008 | 4401.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.17814 | acc=0.8976 | tpr=0.9659 | fpr=0.1037 | 8643.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.18002 | acc=0.8968 | tpr=0.9712 | fpr=0.1045 | 9039.7 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.17951 | acc=0.8968 | tpr=0.9727 | fpr=0.1046 | 8477.2 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.17944 | acc=0.8963 | tpr=0.9755 | fpr=0.1051 | 8728.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.17995 | acc=0.8959 | tpr=0.9724 | fpr=0.1055 | 8628.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.18070 | acc=0.8955 | tpr=0.9724 | fpr=0.1059 | 9036.6 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.18150 | acc=0.8952 | tpr=0.9694 | fpr=0.1061 | 8371.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.18217 | acc=0.8952 | tpr=0.9669 | fpr=0.1061 | 8701.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.18250 | acc=0.8952 | tpr=0.9665 | fpr=0.1061 | 8748.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.18165 | acc=0.8958 | tpr=0.9658 | fpr=0.1055 | 15482.1 samples/s | 60.5 steps/s
Avg test loss: 0.18156, Avg test acc: 0.89581, Avg tpr: 0.96553, Avg fpr: 0.10545, total FA: 14642

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.43559 | Reg=0.00233 | L2-Norm=15.276 | L2-Norm(final)=2.187 | acc=0.6406 | 3733.3 samples/s | 58.3 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.09032 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.197 | acc=1.0000 | 4967.2 samples/s | 77.6 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06921 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.212 | acc=0.9688 | 5109.1 samples/s | 79.8 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06383 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.216 | acc=1.0000 | 5061.2 samples/s | 79.1 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05918 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.219 | acc=0.9688 | 5018.7 samples/s | 78.4 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05644 | Reg=0.00244 | L2-Norm=15.636 | L2-Norm(final)=2.220 | acc=0.9531 | 5108.8 samples/s | 79.8 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05511 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.218 | acc=0.9219 | 5173.8 samples/s | 80.8 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05405 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.215 | acc=1.0000 | 5021.4 samples/s | 78.5 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05237 | Reg=0.00246 | L2-Norm=15.698 | L2-Norm(final)=2.215 | acc=0.9531 | 5107.1 samples/s | 79.8 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05148 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.215 | acc=1.0000 | 5062.1 samples/s | 79.1 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05122 | Reg=0.00248 | L2-Norm=15.738 | L2-Norm(final)=2.215 | acc=0.8906 | 5093.0 samples/s | 79.6 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05120 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.212 | acc=0.9688 | 5076.6 samples/s | 79.3 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05036 | Reg=0.00249 | L2-Norm=15.776 | L2-Norm(final)=2.211 | acc=1.0000 | 5134.4 samples/s | 80.2 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04975 | Reg=0.00249 | L2-Norm=15.793 | L2-Norm(final)=2.209 | acc=0.9375 | 5127.7 samples/s | 80.1 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04933 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.208 | acc=1.0000 | 5055.4 samples/s | 79.0 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04902 | Reg=0.00251 | L2-Norm=15.829 | L2-Norm(final)=2.208 | acc=0.9375 | 4994.4 samples/s | 78.0 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04870 | Reg=0.00251 | L2-Norm=15.848 | L2-Norm(final)=2.207 | acc=0.9531 | 4998.7 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.01707 | Reg=0.00233 | L2-Norm=15.276 | L2-Norm(final)=2.189 | acc=1.0000 | 3461.6 samples/s | 54.1 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00389 | Reg=0.00236 | L2-Norm=15.353 | L2-Norm(final)=2.226 | acc=1.0000 | 4717.5 samples/s | 73.7 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00315 | Reg=0.00236 | L2-Norm=15.361 | L2-Norm(final)=2.236 | acc=0.9844 | 4734.6 samples/s | 74.0 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00376 | Reg=0.00236 | L2-Norm=15.361 | L2-Norm(final)=2.236 | acc=1.0000 | 4577.0 samples/s | 71.5 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00329 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.234 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00286 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.236 | acc=1.0000 | 4673.4 samples/s | 73.0 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00316 | Reg=0.00236 | L2-Norm=15.353 | L2-Norm(final)=2.238 | acc=0.9844 | 4770.6 samples/s | 74.5 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00297 | Reg=0.00236 | L2-Norm=15.352 | L2-Norm(final)=2.237 | acc=1.0000 | 4678.1 samples/s | 73.1 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00322 | Reg=0.00236 | L2-Norm=15.350 | L2-Norm(final)=2.235 | acc=1.0000 | 4772.7 samples/s | 74.6 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00299 | Reg=0.00236 | L2-Norm=15.347 | L2-Norm(final)=2.233 | acc=1.0000 | 4601.0 samples/s | 71.9 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00288 | Reg=0.00235 | L2-Norm=15.341 | L2-Norm(final)=2.231 | acc=1.0000 | 4731.2 samples/s | 73.9 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00266 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.230 | acc=1.0000 | 1965.9 samples/s | 30.7 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00245 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.231 | acc=1.0000 | 4870.6 samples/s | 76.1 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00226 | Reg=0.00234 | L2-Norm=15.306 | L2-Norm(final)=2.231 | acc=1.0000 | 4779.1 samples/s | 74.7 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00210 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.232 | acc=1.0000 | 4803.7 samples/s | 75.1 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00196 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.233 | acc=1.0000 | 4740.4 samples/s | 74.1 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00184 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.234 | acc=1.0000 | 4726.4 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38501 | acc=0.7109 | tpr=0.5874 | fpr=0.0211 | 4433.9 samples/s | 17.3 steps/s
Avg test loss: 0.38697, Avg test acc: 0.70683, Avg tpr: 0.58309, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.25095 | acc=0.8549 | tpr=0.9513 | fpr=0.1468 | 4441.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.25584 | acc=0.8528 | tpr=0.9659 | fpr=0.1493 | 8583.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.25968 | acc=0.8511 | tpr=0.9726 | fpr=0.1512 | 8842.8 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.26029 | acc=0.8512 | tpr=0.9749 | fpr=0.1510 | 8685.2 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.26045 | acc=0.8510 | tpr=0.9764 | fpr=0.1512 | 8751.1 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.26130 | acc=0.8511 | tpr=0.9738 | fpr=0.1511 | 8753.5 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.26220 | acc=0.8508 | tpr=0.9731 | fpr=0.1514 | 8996.7 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.26338 | acc=0.8508 | tpr=0.9716 | fpr=0.1514 | 8467.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.26446 | acc=0.8505 | tpr=0.9708 | fpr=0.1517 | 9310.7 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.26473 | acc=0.8502 | tpr=0.9714 | fpr=0.1519 | 8281.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.26389 | acc=0.8507 | tpr=0.9713 | fpr=0.1515 | 15838.8 samples/s | 61.9 steps/s
Avg test loss: 0.26401, Avg test acc: 0.85067, Avg tpr: 0.97147, Avg fpr: 0.15153, total FA: 21039

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.23649 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.213 | acc=0.8750 | 3820.2 samples/s | 59.7 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.06962 | Reg=0.00235 | L2-Norm=15.329 | L2-Norm(final)=2.198 | acc=0.9688 | 4731.5 samples/s | 73.9 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05714 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.210 | acc=0.9844 | 4896.2 samples/s | 76.5 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05330 | Reg=0.00238 | L2-Norm=15.440 | L2-Norm(final)=2.216 | acc=0.9844 | 4912.9 samples/s | 76.8 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.05117 | Reg=0.00239 | L2-Norm=15.471 | L2-Norm(final)=2.215 | acc=0.9688 | 4919.8 samples/s | 76.9 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05047 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.215 | acc=0.9531 | 4950.9 samples/s | 77.4 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.04996 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.213 | acc=0.9688 | 4958.1 samples/s | 77.5 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04888 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.212 | acc=0.9375 | 4934.3 samples/s | 77.1 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04880 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.211 | acc=0.9531 | 5091.7 samples/s | 79.6 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04837 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.210 | acc=0.9688 | 5022.9 samples/s | 78.5 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04803 | Reg=0.00244 | L2-Norm=15.613 | L2-Norm(final)=2.209 | acc=0.9688 | 5008.9 samples/s | 78.3 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04750 | Reg=0.00244 | L2-Norm=15.635 | L2-Norm(final)=2.208 | acc=0.9844 | 5007.4 samples/s | 78.2 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04718 | Reg=0.00245 | L2-Norm=15.655 | L2-Norm(final)=2.207 | acc=1.0000 | 5023.8 samples/s | 78.5 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04687 | Reg=0.00246 | L2-Norm=15.673 | L2-Norm(final)=2.205 | acc=0.9375 | 4989.9 samples/s | 78.0 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04644 | Reg=0.00246 | L2-Norm=15.691 | L2-Norm(final)=2.203 | acc=1.0000 | 4991.4 samples/s | 78.0 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04591 | Reg=0.00247 | L2-Norm=15.709 | L2-Norm(final)=2.202 | acc=1.0000 | 4967.0 samples/s | 77.6 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04555 | Reg=0.00247 | L2-Norm=15.728 | L2-Norm(final)=2.201 | acc=0.9844 | 4995.3 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.03344 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.213 | acc=0.9688 | 3547.2 samples/s | 55.4 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00642 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.231 | acc=1.0000 | 4717.7 samples/s | 73.7 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00423 | Reg=0.00238 | L2-Norm=15.419 | L2-Norm(final)=2.234 | acc=1.0000 | 4739.1 samples/s | 74.0 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00362 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.237 | acc=0.9688 | 4787.0 samples/s | 74.8 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00462 | Reg=0.00238 | L2-Norm=15.433 | L2-Norm(final)=2.234 | acc=0.9688 | 4783.2 samples/s | 74.7 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00429 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.229 | acc=1.0000 | 4839.0 samples/s | 75.6 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00405 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.225 | acc=1.0000 | 4796.5 samples/s | 74.9 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00354 | Reg=0.00239 | L2-Norm=15.458 | L2-Norm(final)=2.223 | acc=1.0000 | 4596.4 samples/s | 71.8 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00342 | Reg=0.00239 | L2-Norm=15.458 | L2-Norm(final)=2.223 | acc=0.9844 | 4648.5 samples/s | 72.6 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00327 | Reg=0.00239 | L2-Norm=15.457 | L2-Norm(final)=2.222 | acc=1.0000 | 4670.3 samples/s | 73.0 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00312 | Reg=0.00239 | L2-Norm=15.456 | L2-Norm(final)=2.221 | acc=1.0000 | 4765.3 samples/s | 74.5 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00294 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.220 | acc=1.0000 | 2003.9 samples/s | 31.3 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00282 | Reg=0.00239 | L2-Norm=15.448 | L2-Norm(final)=2.218 | acc=1.0000 | 4881.1 samples/s | 76.3 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00299 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.217 | acc=1.0000 | 4796.8 samples/s | 75.0 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00300 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.213 | acc=1.0000 | 4754.5 samples/s | 74.3 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00286 | Reg=0.00238 | L2-Norm=15.440 | L2-Norm(final)=2.211 | acc=1.0000 | 4844.6 samples/s | 75.7 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00275 | Reg=0.00238 | L2-Norm=15.438 | L2-Norm(final)=2.209 | acc=1.0000 | 4816.1 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48313 | acc=0.6256 | tpr=0.4699 | fpr=0.0362 | 4360.6 samples/s | 17.0 steps/s
Avg test loss: 0.48332, Avg test acc: 0.62497, Avg tpr: 0.46931, Avg fpr: 0.03269, total FA: 255

Testing server on iccad2012
[Step=  50] | Loss=0.23933 | acc=0.8778 | tpr=0.9646 | fpr=0.1237 | 4404.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.24056 | acc=0.8762 | tpr=0.9723 | fpr=0.1256 | 8718.6 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.24622 | acc=0.8747 | tpr=0.9741 | fpr=0.1272 | 8773.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.24695 | acc=0.8745 | tpr=0.9749 | fpr=0.1273 | 8857.4 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.24626 | acc=0.8739 | tpr=0.9764 | fpr=0.1280 | 8649.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.24740 | acc=0.8744 | tpr=0.9745 | fpr=0.1274 | 8771.2 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.24795 | acc=0.8740 | tpr=0.9718 | fpr=0.1278 | 8702.8 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.24874 | acc=0.8740 | tpr=0.9721 | fpr=0.1277 | 8517.1 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.25005 | acc=0.8738 | tpr=0.9718 | fpr=0.1280 | 9062.8 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.24985 | acc=0.8737 | tpr=0.9709 | fpr=0.1281 | 8554.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.24906 | acc=0.8740 | tpr=0.9698 | fpr=0.1278 | 15649.2 samples/s | 61.1 steps/s
Avg test loss: 0.24884, Avg test acc: 0.87401, Avg tpr: 0.96989, Avg fpr: 0.12773, total FA: 17735

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.36468 | Reg=0.00234 | L2-Norm=15.287 | L2-Norm(final)=2.169 | acc=0.7500 | 3836.9 samples/s | 60.0 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.08099 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.163 | acc=0.9844 | 4984.8 samples/s | 77.9 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.06336 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.172 | acc=0.9844 | 5009.6 samples/s | 78.3 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05653 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.175 | acc=0.9375 | 5022.8 samples/s | 78.5 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05332 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.179 | acc=0.9062 | 5111.2 samples/s | 79.9 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05077 | Reg=0.00244 | L2-Norm=15.618 | L2-Norm(final)=2.179 | acc=0.9844 | 5105.7 samples/s | 79.8 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.05048 | Reg=0.00245 | L2-Norm=15.648 | L2-Norm(final)=2.180 | acc=0.9688 | 5037.0 samples/s | 78.7 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04939 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.178 | acc=1.0000 | 5108.6 samples/s | 79.8 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04816 | Reg=0.00247 | L2-Norm=15.700 | L2-Norm(final)=2.177 | acc=0.9844 | 5060.7 samples/s | 79.1 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04774 | Reg=0.00247 | L2-Norm=15.725 | L2-Norm(final)=2.175 | acc=0.9844 | 4894.5 samples/s | 76.5 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04726 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.174 | acc=0.9844 | 5009.3 samples/s | 78.3 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04706 | Reg=0.00249 | L2-Norm=15.773 | L2-Norm(final)=2.172 | acc=0.9844 | 5091.5 samples/s | 79.6 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04624 | Reg=0.00250 | L2-Norm=15.795 | L2-Norm(final)=2.170 | acc=0.9844 | 4864.0 samples/s | 76.0 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04571 | Reg=0.00250 | L2-Norm=15.816 | L2-Norm(final)=2.168 | acc=0.9688 | 5096.6 samples/s | 79.6 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04522 | Reg=0.00251 | L2-Norm=15.836 | L2-Norm(final)=2.166 | acc=0.9531 | 5199.2 samples/s | 81.2 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04484 | Reg=0.00251 | L2-Norm=15.855 | L2-Norm(final)=2.165 | acc=0.9844 | 4996.3 samples/s | 78.1 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04470 | Reg=0.00252 | L2-Norm=15.874 | L2-Norm(final)=2.163 | acc=0.9531 | 5013.5 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.03180 | Reg=0.00234 | L2-Norm=15.287 | L2-Norm(final)=2.172 | acc=0.9688 | 3522.1 samples/s | 55.0 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00728 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.184 | acc=1.0000 | 4674.9 samples/s | 73.0 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00510 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.181 | acc=1.0000 | 4855.0 samples/s | 75.9 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00399 | Reg=0.00237 | L2-Norm=15.385 | L2-Norm(final)=2.181 | acc=1.0000 | 4823.9 samples/s | 75.4 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00322 | Reg=0.00236 | L2-Norm=15.378 | L2-Norm(final)=2.183 | acc=1.0000 | 4738.7 samples/s | 74.0 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00277 | Reg=0.00236 | L2-Norm=15.367 | L2-Norm(final)=2.187 | acc=1.0000 | 4936.3 samples/s | 77.1 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00245 | Reg=0.00236 | L2-Norm=15.355 | L2-Norm(final)=2.190 | acc=1.0000 | 4678.6 samples/s | 73.1 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00211 | Reg=0.00235 | L2-Norm=15.342 | L2-Norm(final)=2.194 | acc=1.0000 | 4714.1 samples/s | 73.7 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00191 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.197 | acc=1.0000 | 4517.6 samples/s | 70.6 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00170 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.200 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00154 | Reg=0.00234 | L2-Norm=15.289 | L2-Norm(final)=2.203 | acc=1.0000 | 4684.2 samples/s | 73.2 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00140 | Reg=0.00233 | L2-Norm=15.268 | L2-Norm(final)=2.206 | acc=1.0000 | 2003.8 samples/s | 31.3 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00129 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.208 | acc=1.0000 | 4850.6 samples/s | 75.8 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00119 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.210 | acc=1.0000 | 4821.2 samples/s | 75.3 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00110 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.212 | acc=1.0000 | 4820.1 samples/s | 75.3 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00103 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.214 | acc=1.0000 | 4813.4 samples/s | 75.2 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00097 | Reg=0.00229 | L2-Norm=15.147 | L2-Norm(final)=2.216 | acc=1.0000 | 4811.9 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32989 | acc=0.7436 | tpr=0.6326 | fpr=0.0154 | 4405.2 samples/s | 17.2 steps/s
Avg test loss: 0.33190, Avg test acc: 0.74133, Avg tpr: 0.63041, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.31722 | acc=0.8158 | tpr=0.9690 | fpr=0.1870 | 4427.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.32025 | acc=0.8154 | tpr=0.9765 | fpr=0.1876 | 8737.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.32549 | acc=0.8143 | tpr=0.9769 | fpr=0.1886 | 8887.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.32547 | acc=0.8158 | tpr=0.9781 | fpr=0.1871 | 8664.1 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.32466 | acc=0.8162 | tpr=0.9799 | fpr=0.1868 | 8780.9 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.32452 | acc=0.8169 | tpr=0.9789 | fpr=0.1861 | 8545.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.32577 | acc=0.8164 | tpr=0.9768 | fpr=0.1866 | 8729.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.32637 | acc=0.8162 | tpr=0.9776 | fpr=0.1867 | 8770.5 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.32722 | acc=0.8164 | tpr=0.9776 | fpr=0.1865 | 8652.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.32718 | acc=0.8162 | tpr=0.9767 | fpr=0.1867 | 8789.4 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.32580 | acc=0.8164 | tpr=0.9761 | fpr=0.1865 | 15684.4 samples/s | 61.3 steps/s
Avg test loss: 0.32587, Avg test acc: 0.81638, Avg tpr: 0.97623, Avg fpr: 0.18653, total FA: 25899

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.17866 | Reg=0.00230 | L2-Norm=15.162 | L2-Norm(final)=2.180 | acc=0.8125 | 4111.0 samples/s | 64.2 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.05482 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.181 | acc=0.9688 | 4482.9 samples/s | 70.0 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.04937 | Reg=0.00235 | L2-Norm=15.329 | L2-Norm(final)=2.190 | acc=0.9844 | 4918.4 samples/s | 76.9 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.04526 | Reg=0.00236 | L2-Norm=15.369 | L2-Norm(final)=2.195 | acc=0.9531 | 4930.1 samples/s | 77.0 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.04437 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.194 | acc=0.9844 | 4939.2 samples/s | 77.2 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04324 | Reg=0.00238 | L2-Norm=15.426 | L2-Norm(final)=2.194 | acc=0.9531 | 4994.1 samples/s | 78.0 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04251 | Reg=0.00239 | L2-Norm=15.450 | L2-Norm(final)=2.192 | acc=0.9844 | 4958.4 samples/s | 77.5 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04143 | Reg=0.00239 | L2-Norm=15.475 | L2-Norm(final)=2.191 | acc=1.0000 | 5005.7 samples/s | 78.2 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04095 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.190 | acc=0.9844 | 4894.7 samples/s | 76.5 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04101 | Reg=0.00241 | L2-Norm=15.522 | L2-Norm(final)=2.189 | acc=0.9219 | 5020.7 samples/s | 78.4 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04010 | Reg=0.00242 | L2-Norm=15.544 | L2-Norm(final)=2.188 | acc=0.9688 | 5021.6 samples/s | 78.5 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.03989 | Reg=0.00242 | L2-Norm=15.566 | L2-Norm(final)=2.188 | acc=0.9688 | 5114.8 samples/s | 79.9 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04007 | Reg=0.00243 | L2-Norm=15.587 | L2-Norm(final)=2.187 | acc=0.9844 | 4930.6 samples/s | 77.0 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04034 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.186 | acc=0.9531 | 5137.9 samples/s | 80.3 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.03981 | Reg=0.00244 | L2-Norm=15.629 | L2-Norm(final)=2.186 | acc=0.9844 | 5028.2 samples/s | 78.6 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04034 | Reg=0.00245 | L2-Norm=15.652 | L2-Norm(final)=2.186 | acc=0.9844 | 5087.2 samples/s | 79.5 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.03997 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.186 | acc=0.9531 | 5113.3 samples/s | 79.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.12695 | Reg=0.00230 | L2-Norm=15.162 | L2-Norm(final)=2.177 | acc=0.9375 | 3633.9 samples/s | 56.8 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00856 | Reg=0.00236 | L2-Norm=15.367 | L2-Norm(final)=2.176 | acc=1.0000 | 4600.3 samples/s | 71.9 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00576 | Reg=0.00238 | L2-Norm=15.413 | L2-Norm(final)=2.181 | acc=1.0000 | 4891.4 samples/s | 76.4 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00708 | Reg=0.00238 | L2-Norm=15.443 | L2-Norm(final)=2.177 | acc=1.0000 | 4731.5 samples/s | 73.9 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00691 | Reg=0.00240 | L2-Norm=15.494 | L2-Norm(final)=2.165 | acc=1.0000 | 4758.4 samples/s | 74.4 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00622 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.159 | acc=1.0000 | 4856.9 samples/s | 75.9 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00524 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.158 | acc=1.0000 | 4798.1 samples/s | 75.0 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00458 | Reg=0.00242 | L2-Norm=15.571 | L2-Norm(final)=2.159 | acc=1.0000 | 4813.1 samples/s | 75.2 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00402 | Reg=0.00243 | L2-Norm=15.573 | L2-Norm(final)=2.161 | acc=1.0000 | 4880.9 samples/s | 76.3 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00358 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.163 | acc=1.0000 | 4759.9 samples/s | 74.4 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00329 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.166 | acc=1.0000 | 4878.8 samples/s | 76.2 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00300 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.167 | acc=1.0000 | 1998.3 samples/s | 31.2 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00276 | Reg=0.00241 | L2-Norm=15.532 | L2-Norm(final)=2.169 | acc=1.0000 | 4717.9 samples/s | 73.7 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00255 | Reg=0.00241 | L2-Norm=15.516 | L2-Norm(final)=2.171 | acc=1.0000 | 4737.4 samples/s | 74.0 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00236 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.173 | acc=1.0000 | 4611.3 samples/s | 72.1 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00221 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.175 | acc=1.0000 | 4691.4 samples/s | 73.3 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00207 | Reg=0.00239 | L2-Norm=15.460 | L2-Norm(final)=2.176 | acc=1.0000 | 4736.0 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.65635 | acc=0.5603 | tpr=0.3625 | fpr=0.0102 | 4390.3 samples/s | 17.1 steps/s
Avg test loss: 0.65759, Avg test acc: 0.56010, Avg tpr: 0.36510, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.16937 | acc=0.9270 | tpr=0.9558 | fpr=0.0736 | 4440.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.17511 | acc=0.9246 | tpr=0.9723 | fpr=0.0762 | 8658.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.18010 | acc=0.9236 | tpr=0.9712 | fpr=0.0773 | 8777.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.18141 | acc=0.9232 | tpr=0.9727 | fpr=0.0777 | 8996.8 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.18052 | acc=0.9233 | tpr=0.9764 | fpr=0.0777 | 8509.0 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.18167 | acc=0.9229 | tpr=0.9745 | fpr=0.0780 | 9711.2 samples/s | 37.9 steps/s
[Step= 350] | Loss=0.18293 | acc=0.9226 | tpr=0.9743 | fpr=0.0783 | 7967.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.18346 | acc=0.9224 | tpr=0.9732 | fpr=0.0786 | 9231.2 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.18529 | acc=0.9220 | tpr=0.9737 | fpr=0.0790 | 8227.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.18493 | acc=0.9224 | tpr=0.9727 | fpr=0.0785 | 8992.4 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.18402 | acc=0.9227 | tpr=0.9729 | fpr=0.0783 | 14653.7 samples/s | 57.2 steps/s
Avg test loss: 0.18387, Avg test acc: 0.92271, Avg tpr: 0.97306, Avg fpr: 0.07820, total FA: 10858

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.60991 | Reg=0.00232 | L2-Norm=15.228 | L2-Norm(final)=2.181 | acc=0.5781 | 3785.1 samples/s | 59.1 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.08969 | Reg=0.00234 | L2-Norm=15.296 | L2-Norm(final)=2.167 | acc=0.9688 | 4806.2 samples/s | 75.1 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.06140 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.182 | acc=0.9688 | 5080.1 samples/s | 79.4 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.05279 | Reg=0.00236 | L2-Norm=15.349 | L2-Norm(final)=2.191 | acc=1.0000 | 5061.4 samples/s | 79.1 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04570 | Reg=0.00236 | L2-Norm=15.364 | L2-Norm(final)=2.199 | acc=0.9688 | 4896.6 samples/s | 76.5 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04245 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.206 | acc=1.0000 | 4851.9 samples/s | 75.8 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03962 | Reg=0.00237 | L2-Norm=15.387 | L2-Norm(final)=2.210 | acc=1.0000 | 5061.0 samples/s | 79.1 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03709 | Reg=0.00237 | L2-Norm=15.396 | L2-Norm(final)=2.214 | acc=1.0000 | 5055.4 samples/s | 79.0 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03588 | Reg=0.00237 | L2-Norm=15.405 | L2-Norm(final)=2.218 | acc=0.9688 | 5067.1 samples/s | 79.2 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03535 | Reg=0.00238 | L2-Norm=15.412 | L2-Norm(final)=2.220 | acc=0.9844 | 5082.5 samples/s | 79.4 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03445 | Reg=0.00238 | L2-Norm=15.418 | L2-Norm(final)=2.222 | acc=0.9844 | 5120.5 samples/s | 80.0 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03330 | Reg=0.00238 | L2-Norm=15.424 | L2-Norm(final)=2.224 | acc=0.9688 | 5066.0 samples/s | 79.2 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03243 | Reg=0.00238 | L2-Norm=15.430 | L2-Norm(final)=2.225 | acc=1.0000 | 4915.5 samples/s | 76.8 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03209 | Reg=0.00238 | L2-Norm=15.435 | L2-Norm(final)=2.227 | acc=1.0000 | 5026.9 samples/s | 78.5 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03156 | Reg=0.00238 | L2-Norm=15.441 | L2-Norm(final)=2.229 | acc=0.9844 | 4972.8 samples/s | 77.7 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03107 | Reg=0.00239 | L2-Norm=15.446 | L2-Norm(final)=2.230 | acc=0.9844 | 4942.3 samples/s | 77.2 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03078 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.232 | acc=0.9531 | 4943.2 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.00995 | Reg=0.00232 | L2-Norm=15.228 | L2-Norm(final)=2.183 | acc=1.0000 | 3819.6 samples/s | 59.7 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00309 | Reg=0.00233 | L2-Norm=15.256 | L2-Norm(final)=2.200 | acc=1.0000 | 4477.6 samples/s | 70.0 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00194 | Reg=0.00233 | L2-Norm=15.257 | L2-Norm(final)=2.208 | acc=1.0000 | 4775.9 samples/s | 74.6 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00136 | Reg=0.00233 | L2-Norm=15.250 | L2-Norm(final)=2.215 | acc=1.0000 | 4806.6 samples/s | 75.1 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00104 | Reg=0.00232 | L2-Norm=15.239 | L2-Norm(final)=2.219 | acc=1.0000 | 4772.5 samples/s | 74.6 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00086 | Reg=0.00232 | L2-Norm=15.226 | L2-Norm(final)=2.222 | acc=1.0000 | 4866.9 samples/s | 76.0 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00072 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.226 | acc=1.0000 | 4851.6 samples/s | 75.8 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00062 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.228 | acc=1.0000 | 4825.9 samples/s | 75.4 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00055 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.230 | acc=1.0000 | 4834.2 samples/s | 75.5 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00049 | Reg=0.00230 | L2-Norm=15.167 | L2-Norm(final)=2.232 | acc=1.0000 | 4679.0 samples/s | 73.1 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00045 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.234 | acc=1.0000 | 4835.6 samples/s | 75.6 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00041 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.235 | acc=1.0000 | 1976.1 samples/s | 30.9 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00037 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.237 | acc=1.0000 | 4762.5 samples/s | 74.4 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00035 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.238 | acc=1.0000 | 4731.1 samples/s | 73.9 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00032 | Reg=0.00228 | L2-Norm=15.087 | L2-Norm(final)=2.239 | acc=1.0000 | 4698.4 samples/s | 73.4 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00030 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.240 | acc=1.0000 | 4811.8 samples/s | 75.2 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00028 | Reg=0.00227 | L2-Norm=15.054 | L2-Norm(final)=2.241 | acc=1.0000 | 4637.9 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25372 | acc=0.8257 | tpr=0.7514 | fpr=0.0129 | 4413.9 samples/s | 17.2 steps/s
Avg test loss: 0.25389, Avg test acc: 0.82675, Avg tpr: 0.75386, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.47732 | acc=0.7741 | tpr=0.9735 | fpr=0.2294 | 4452.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.48615 | acc=0.7743 | tpr=0.9829 | fpr=0.2296 | 8623.8 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.49397 | acc=0.7732 | tpr=0.9827 | fpr=0.2306 | 8747.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.49553 | acc=0.7740 | tpr=0.9836 | fpr=0.2298 | 8798.5 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.49460 | acc=0.7747 | tpr=0.9852 | fpr=0.2291 | 8623.9 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.49524 | acc=0.7750 | tpr=0.9840 | fpr=0.2288 | 8854.3 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.49657 | acc=0.7751 | tpr=0.9831 | fpr=0.2287 | 8752.8 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.49776 | acc=0.7751 | tpr=0.9830 | fpr=0.2287 | 8677.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.49994 | acc=0.7750 | tpr=0.9834 | fpr=0.2287 | 8706.7 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.49918 | acc=0.7749 | tpr=0.9828 | fpr=0.2288 | 8747.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.49735 | acc=0.7754 | tpr=0.9825 | fpr=0.2283 | 15253.4 samples/s | 59.6 steps/s
Avg test loss: 0.49734, Avg test acc: 0.77541, Avg tpr: 0.98257, Avg fpr: 0.22836, total FA: 31707

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.20659 | Reg=0.00226 | L2-Norm=15.046 | L2-Norm(final)=2.251 | acc=0.8750 | 3740.4 samples/s | 58.4 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04219 | Reg=0.00227 | L2-Norm=15.080 | L2-Norm(final)=2.242 | acc=1.0000 | 4849.8 samples/s | 75.8 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03565 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.247 | acc=0.9844 | 5013.3 samples/s | 78.3 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03163 | Reg=0.00228 | L2-Norm=15.110 | L2-Norm(final)=2.253 | acc=0.9844 | 5009.6 samples/s | 78.3 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03012 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.257 | acc=0.9531 | 4990.4 samples/s | 78.0 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.02890 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.262 | acc=0.9375 | 4915.4 samples/s | 76.8 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02761 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.266 | acc=1.0000 | 5016.3 samples/s | 78.4 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02776 | Reg=0.00229 | L2-Norm=15.146 | L2-Norm(final)=2.269 | acc=0.9375 | 4894.5 samples/s | 76.5 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02752 | Reg=0.00230 | L2-Norm=15.153 | L2-Norm(final)=2.271 | acc=1.0000 | 4990.1 samples/s | 78.0 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02737 | Reg=0.00230 | L2-Norm=15.160 | L2-Norm(final)=2.271 | acc=0.9844 | 4970.5 samples/s | 77.7 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02715 | Reg=0.00230 | L2-Norm=15.166 | L2-Norm(final)=2.272 | acc=0.9688 | 5065.3 samples/s | 79.1 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02653 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.274 | acc=1.0000 | 4910.7 samples/s | 76.7 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02656 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.275 | acc=0.9844 | 4992.4 samples/s | 78.0 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02623 | Reg=0.00231 | L2-Norm=15.186 | L2-Norm(final)=2.276 | acc=1.0000 | 4988.5 samples/s | 77.9 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02659 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.277 | acc=0.9531 | 4948.5 samples/s | 77.3 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02617 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.277 | acc=0.9688 | 5038.5 samples/s | 78.7 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02594 | Reg=0.00231 | L2-Norm=15.203 | L2-Norm(final)=2.278 | acc=0.9688 | 4935.6 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.06781 | Reg=0.00226 | L2-Norm=15.046 | L2-Norm(final)=2.251 | acc=0.9531 | 3590.2 samples/s | 56.1 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00572 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.254 | acc=1.0000 | 4599.3 samples/s | 71.9 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00352 | Reg=0.00231 | L2-Norm=15.194 | L2-Norm(final)=2.258 | acc=1.0000 | 4759.4 samples/s | 74.4 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00247 | Reg=0.00231 | L2-Norm=15.198 | L2-Norm(final)=2.262 | acc=1.0000 | 4831.9 samples/s | 75.5 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00188 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.264 | acc=1.0000 | 4682.4 samples/s | 73.2 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00152 | Reg=0.00231 | L2-Norm=15.184 | L2-Norm(final)=2.266 | acc=1.0000 | 4583.8 samples/s | 71.6 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00130 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.269 | acc=1.0000 | 4660.5 samples/s | 72.8 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00130 | Reg=0.00230 | L2-Norm=15.162 | L2-Norm(final)=2.270 | acc=1.0000 | 4785.9 samples/s | 74.8 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00117 | Reg=0.00230 | L2-Norm=15.154 | L2-Norm(final)=2.272 | acc=1.0000 | 4688.0 samples/s | 73.3 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00111 | Reg=0.00229 | L2-Norm=15.146 | L2-Norm(final)=2.273 | acc=1.0000 | 4764.8 samples/s | 74.4 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00101 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.274 | acc=1.0000 | 4689.8 samples/s | 73.3 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00092 | Reg=0.00229 | L2-Norm=15.127 | L2-Norm(final)=2.275 | acc=1.0000 | 1957.8 samples/s | 30.6 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00084 | Reg=0.00229 | L2-Norm=15.116 | L2-Norm(final)=2.276 | acc=1.0000 | 4743.7 samples/s | 74.1 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00080 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.277 | acc=1.0000 | 4849.4 samples/s | 75.8 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00074 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.278 | acc=1.0000 | 4859.7 samples/s | 75.9 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00069 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.279 | acc=1.0000 | 4689.0 samples/s | 73.3 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00065 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.279 | acc=1.0000 | 4816.6 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.69281 | acc=0.6374 | tpr=0.4734 | fpr=0.0064 | 4487.1 samples/s | 17.5 steps/s
Avg test loss: 0.69050, Avg test acc: 0.63679, Avg tpr: 0.47456, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.27465 | acc=0.9062 | tpr=0.9602 | fpr=0.0948 | 4401.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.27964 | acc=0.9055 | tpr=0.9744 | fpr=0.0958 | 8797.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.28592 | acc=0.9045 | tpr=0.9769 | fpr=0.0968 | 8680.1 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.28737 | acc=0.9044 | tpr=0.9760 | fpr=0.0969 | 8657.0 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.28709 | acc=0.9044 | tpr=0.9773 | fpr=0.0970 | 8895.3 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.28888 | acc=0.9046 | tpr=0.9753 | fpr=0.0967 | 8578.2 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.29062 | acc=0.9043 | tpr=0.9743 | fpr=0.0970 | 8903.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.29229 | acc=0.9040 | tpr=0.9743 | fpr=0.0973 | 8746.9 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.29457 | acc=0.9039 | tpr=0.9747 | fpr=0.0974 | 8716.4 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.29370 | acc=0.9041 | tpr=0.9744 | fpr=0.0972 | 8795.9 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.29230 | acc=0.9046 | tpr=0.9737 | fpr=0.0967 | 15268.7 samples/s | 59.6 steps/s
Avg test loss: 0.29218, Avg test acc: 0.90459, Avg tpr: 0.97345, Avg fpr: 0.09667, total FA: 13422

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.34536 | Reg=0.00223 | L2-Norm=14.943 | L2-Norm(final)=2.290 | acc=0.8281 | 3953.6 samples/s | 61.8 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.05004 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.277 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03799 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.284 | acc=0.9844 | 5052.3 samples/s | 78.9 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03355 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.289 | acc=0.9844 | 5066.7 samples/s | 79.2 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03169 | Reg=0.00228 | L2-Norm=15.087 | L2-Norm(final)=2.291 | acc=0.9844 | 5123.1 samples/s | 80.0 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.03011 | Reg=0.00228 | L2-Norm=15.097 | L2-Norm(final)=2.293 | acc=1.0000 | 5041.5 samples/s | 78.8 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02949 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.295 | acc=1.0000 | 5063.1 samples/s | 79.1 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02834 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.296 | acc=0.9844 | 5047.9 samples/s | 78.9 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02785 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.296 | acc=0.9844 | 5081.2 samples/s | 79.4 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02752 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.297 | acc=1.0000 | 5163.3 samples/s | 80.7 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02687 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.299 | acc=0.9688 | 5063.6 samples/s | 79.1 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02672 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.301 | acc=1.0000 | 5103.0 samples/s | 79.7 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02673 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.302 | acc=0.9375 | 5057.3 samples/s | 79.0 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02675 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.303 | acc=0.9375 | 5139.7 samples/s | 80.3 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02650 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.304 | acc=1.0000 | 5157.0 samples/s | 80.6 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02618 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.305 | acc=0.9844 | 4890.0 samples/s | 76.4 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02622 | Reg=0.00230 | L2-Norm=15.171 | L2-Norm(final)=2.307 | acc=0.9531 | 5004.3 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.00756 | Reg=0.00223 | L2-Norm=14.943 | L2-Norm(final)=2.291 | acc=1.0000 | 3553.2 samples/s | 55.5 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00236 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.304 | acc=1.0000 | 4453.8 samples/s | 69.6 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00141 | Reg=0.00225 | L2-Norm=14.989 | L2-Norm(final)=2.308 | acc=1.0000 | 4726.7 samples/s | 73.9 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00139 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.312 | acc=1.0000 | 4706.7 samples/s | 73.5 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00113 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.313 | acc=1.0000 | 4774.3 samples/s | 74.6 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00092 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.314 | acc=1.0000 | 4732.6 samples/s | 73.9 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00095 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.316 | acc=1.0000 | 4648.2 samples/s | 72.6 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00103 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.316 | acc=1.0000 | 4716.3 samples/s | 73.7 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00092 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.315 | acc=1.0000 | 4784.1 samples/s | 74.8 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00083 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.315 | acc=1.0000 | 4724.0 samples/s | 73.8 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00077 | Reg=0.00224 | L2-Norm=14.955 | L2-Norm(final)=2.316 | acc=1.0000 | 4730.2 samples/s | 73.9 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00070 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.317 | acc=1.0000 | 1943.0 samples/s | 30.4 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00065 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.317 | acc=1.0000 | 4788.1 samples/s | 74.8 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00060 | Reg=0.00223 | L2-Norm=14.925 | L2-Norm(final)=2.318 | acc=1.0000 | 4745.5 samples/s | 74.1 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00056 | Reg=0.00222 | L2-Norm=14.913 | L2-Norm(final)=2.319 | acc=1.0000 | 4703.0 samples/s | 73.5 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00052 | Reg=0.00222 | L2-Norm=14.901 | L2-Norm(final)=2.320 | acc=1.0000 | 4726.7 samples/s | 73.9 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00049 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.321 | acc=1.0000 | 4678.3 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34169 | acc=0.7825 | tpr=0.6867 | fpr=0.0094 | 4366.0 samples/s | 17.1 steps/s
Avg test loss: 0.34156, Avg test acc: 0.78223, Avg tpr: 0.68800, Avg fpr: 0.01051, total FA: 82

Testing server on iccad2012
[Step=  50] | Loss=0.44017 | acc=0.8225 | tpr=0.9735 | fpr=0.1802 | 4419.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.44609 | acc=0.8216 | tpr=0.9829 | fpr=0.1814 | 8745.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.45362 | acc=0.8194 | tpr=0.9841 | fpr=0.1836 | 9221.2 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.45515 | acc=0.8202 | tpr=0.9836 | fpr=0.1828 | 8356.8 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.45436 | acc=0.8203 | tpr=0.9843 | fpr=0.1827 | 8460.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.45541 | acc=0.8203 | tpr=0.9833 | fpr=0.1827 | 8713.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.45729 | acc=0.8202 | tpr=0.9818 | fpr=0.1828 | 8749.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.45861 | acc=0.8201 | tpr=0.9819 | fpr=0.1828 | 8735.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.46081 | acc=0.8198 | tpr=0.9820 | fpr=0.1831 | 8775.6 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.46021 | acc=0.8198 | tpr=0.9824 | fpr=0.1831 | 8861.3 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.45826 | acc=0.8204 | tpr=0.9829 | fpr=0.1826 | 15318.4 samples/s | 59.8 steps/s
Avg test loss: 0.45819, Avg test acc: 0.82037, Avg tpr: 0.98257, Avg fpr: 0.18257, total FA: 25350

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.21142 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.323 | acc=0.8125 | 3819.4 samples/s | 59.7 steps/s
[Step=10450 Epoch=10.2] | Loss=0.04442 | Reg=0.00223 | L2-Norm=14.916 | L2-Norm(final)=2.311 | acc=0.9688 | 4806.6 samples/s | 75.1 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03395 | Reg=0.00223 | L2-Norm=14.945 | L2-Norm(final)=2.319 | acc=0.9844 | 5086.4 samples/s | 79.5 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03000 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.324 | acc=0.9688 | 5053.2 samples/s | 79.0 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02837 | Reg=0.00224 | L2-Norm=14.971 | L2-Norm(final)=2.327 | acc=0.9844 | 5051.4 samples/s | 78.9 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02712 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.330 | acc=0.9844 | 5081.4 samples/s | 79.4 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02631 | Reg=0.00225 | L2-Norm=14.990 | L2-Norm(final)=2.332 | acc=0.9531 | 5109.3 samples/s | 79.8 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02560 | Reg=0.00225 | L2-Norm=14.999 | L2-Norm(final)=2.335 | acc=1.0000 | 5073.8 samples/s | 79.3 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02534 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.338 | acc=1.0000 | 5118.1 samples/s | 80.0 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02544 | Reg=0.00225 | L2-Norm=15.016 | L2-Norm(final)=2.340 | acc=1.0000 | 5104.0 samples/s | 79.8 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02511 | Reg=0.00226 | L2-Norm=15.024 | L2-Norm(final)=2.342 | acc=0.9844 | 5145.5 samples/s | 80.4 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02489 | Reg=0.00226 | L2-Norm=15.032 | L2-Norm(final)=2.344 | acc=0.9844 | 5063.6 samples/s | 79.1 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02472 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.346 | acc=1.0000 | 5067.1 samples/s | 79.2 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02451 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.347 | acc=0.9688 | 5105.2 samples/s | 79.8 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02430 | Reg=0.00227 | L2-Norm=15.054 | L2-Norm(final)=2.349 | acc=0.9531 | 5104.2 samples/s | 79.8 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02406 | Reg=0.00227 | L2-Norm=15.061 | L2-Norm(final)=2.350 | acc=0.9688 | 5142.4 samples/s | 80.4 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02389 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.352 | acc=0.9844 | 5054.7 samples/s | 79.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.10023 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.322 | acc=0.9062 | 3680.1 samples/s | 57.5 steps/s
[Step=10450 Epoch=19.7] | Loss=0.01154 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.281 | acc=1.0000 | 4451.7 samples/s | 69.6 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00630 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.278 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00437 | Reg=0.00225 | L2-Norm=14.999 | L2-Norm(final)=2.280 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00334 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.283 | acc=1.0000 | 4679.6 samples/s | 73.1 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00271 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.287 | acc=1.0000 | 4737.3 samples/s | 74.0 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00229 | Reg=0.00224 | L2-Norm=14.983 | L2-Norm(final)=2.290 | acc=1.0000 | 4819.2 samples/s | 75.3 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00197 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.292 | acc=1.0000 | 4886.4 samples/s | 76.4 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00173 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.294 | acc=1.0000 | 4795.8 samples/s | 74.9 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00154 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.296 | acc=1.0000 | 4807.2 samples/s | 75.1 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00139 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.298 | acc=1.0000 | 4757.2 samples/s | 74.3 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00127 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.300 | acc=1.0000 | 1926.6 samples/s | 30.1 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00116 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.301 | acc=1.0000 | 4770.9 samples/s | 74.5 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00107 | Reg=0.00222 | L2-Norm=14.901 | L2-Norm(final)=2.303 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00100 | Reg=0.00222 | L2-Norm=14.887 | L2-Norm(final)=2.304 | acc=1.0000 | 4762.3 samples/s | 74.4 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00093 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.305 | acc=1.0000 | 4680.1 samples/s | 73.1 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00087 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.306 | acc=1.0000 | 4777.7 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48045 | acc=0.6937 | tpr=0.5568 | fpr=0.0092 | 4407.2 samples/s | 17.2 steps/s
Avg test loss: 0.47891, Avg test acc: 0.69389, Avg tpr: 0.55878, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.28725 | acc=0.8911 | tpr=0.9735 | fpr=0.1104 | 4404.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.29093 | acc=0.8918 | tpr=0.9829 | fpr=0.1099 | 9080.6 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.29767 | acc=0.8909 | tpr=0.9841 | fpr=0.1108 | 8455.1 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.29878 | acc=0.8911 | tpr=0.9847 | fpr=0.1106 | 9089.2 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.29957 | acc=0.8906 | tpr=0.9852 | fpr=0.1111 | 8403.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.30140 | acc=0.8906 | tpr=0.9833 | fpr=0.1111 | 8560.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.30384 | acc=0.8902 | tpr=0.9825 | fpr=0.1115 | 8866.0 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.30546 | acc=0.8895 | tpr=0.9814 | fpr=0.1121 | 8316.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.30741 | acc=0.8892 | tpr=0.9805 | fpr=0.1125 | 8992.5 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.30641 | acc=0.8896 | tpr=0.9802 | fpr=0.1121 | 8971.9 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.30484 | acc=0.8901 | tpr=0.9793 | fpr=0.1115 | 14296.3 samples/s | 55.8 steps/s
Avg test loss: 0.30469, Avg test acc: 0.89014, Avg tpr: 0.97900, Avg fpr: 0.11147, total FA: 15478

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.22757 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.343 | acc=0.8750 | 3658.2 samples/s | 57.2 steps/s
[Step=11250 Epoch=11.0] | Loss=0.05215 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.329 | acc=0.9688 | 5018.7 samples/s | 78.4 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03590 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.339 | acc=0.9688 | 5085.5 samples/s | 79.5 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03141 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.345 | acc=0.9844 | 4978.7 samples/s | 77.8 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02952 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.349 | acc=0.9844 | 4941.6 samples/s | 77.2 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02892 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.352 | acc=1.0000 | 4879.6 samples/s | 76.2 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02806 | Reg=0.00223 | L2-Norm=14.942 | L2-Norm(final)=2.356 | acc=0.9844 | 5035.8 samples/s | 78.7 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02680 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.359 | acc=0.9531 | 5118.8 samples/s | 80.0 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02580 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.363 | acc=1.0000 | 4885.4 samples/s | 76.3 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02494 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.367 | acc=0.9844 | 4993.2 samples/s | 78.0 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02505 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.370 | acc=0.9688 | 4884.3 samples/s | 76.3 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02475 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.372 | acc=1.0000 | 5000.8 samples/s | 78.1 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02455 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.374 | acc=0.9844 | 4876.5 samples/s | 76.2 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02431 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.376 | acc=0.9688 | 4965.7 samples/s | 77.6 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02405 | Reg=0.00225 | L2-Norm=15.006 | L2-Norm(final)=2.378 | acc=0.9688 | 4877.2 samples/s | 76.2 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02377 | Reg=0.00225 | L2-Norm=15.013 | L2-Norm(final)=2.379 | acc=0.9531 | 4959.0 samples/s | 77.5 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02383 | Reg=0.00226 | L2-Norm=15.019 | L2-Norm(final)=2.381 | acc=0.9844 | 4949.2 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.01670 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.344 | acc=0.9688 | 3392.4 samples/s | 53.0 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00785 | Reg=0.00221 | L2-Norm=14.873 | L2-Norm(final)=2.334 | acc=1.0000 | 4643.0 samples/s | 72.5 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00481 | Reg=0.00222 | L2-Norm=14.913 | L2-Norm(final)=2.333 | acc=1.0000 | 4703.3 samples/s | 73.5 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00336 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.334 | acc=1.0000 | 4646.8 samples/s | 72.6 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00274 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.336 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00281 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.336 | acc=1.0000 | 4656.3 samples/s | 72.8 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00254 | Reg=0.00223 | L2-Norm=14.942 | L2-Norm(final)=2.336 | acc=1.0000 | 4737.5 samples/s | 74.0 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00223 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.337 | acc=1.0000 | 4749.2 samples/s | 74.2 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00196 | Reg=0.00223 | L2-Norm=14.943 | L2-Norm(final)=2.338 | acc=1.0000 | 4724.5 samples/s | 73.8 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00175 | Reg=0.00223 | L2-Norm=14.940 | L2-Norm(final)=2.340 | acc=1.0000 | 4812.2 samples/s | 75.2 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00158 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.341 | acc=1.0000 | 4630.0 samples/s | 72.3 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00144 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.342 | acc=1.0000 | 1953.2 samples/s | 30.5 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00132 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.344 | acc=1.0000 | 4831.4 samples/s | 75.5 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00122 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.345 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00113 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.346 | acc=1.0000 | 4709.5 samples/s | 73.6 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00106 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.347 | acc=1.0000 | 4597.2 samples/s | 71.8 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00099 | Reg=0.00222 | L2-Norm=14.887 | L2-Norm(final)=2.348 | acc=1.0000 | 4711.7 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39632 | acc=0.7395 | tpr=0.6239 | fpr=0.0094 | 3714.2 samples/s | 14.5 steps/s
Avg test loss: 0.39555, Avg test acc: 0.73932, Avg tpr: 0.62499, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.26938 | acc=0.8954 | tpr=0.9735 | fpr=0.1060 | 4198.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.27531 | acc=0.8947 | tpr=0.9829 | fpr=0.1070 | 8447.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.28255 | acc=0.8935 | tpr=0.9841 | fpr=0.1082 | 8953.3 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.28401 | acc=0.8932 | tpr=0.9836 | fpr=0.1084 | 8701.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.28330 | acc=0.8934 | tpr=0.9852 | fpr=0.1083 | 8629.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.28456 | acc=0.8932 | tpr=0.9825 | fpr=0.1085 | 9296.5 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.28606 | acc=0.8934 | tpr=0.9812 | fpr=0.1082 | 8327.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.28775 | acc=0.8929 | tpr=0.9809 | fpr=0.1087 | 8789.0 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.28986 | acc=0.8927 | tpr=0.9810 | fpr=0.1089 | 8751.0 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.28910 | acc=0.8928 | tpr=0.9811 | fpr=0.1088 | 8714.3 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.28776 | acc=0.8933 | tpr=0.9809 | fpr=0.1083 | 15779.3 samples/s | 61.6 steps/s
Avg test loss: 0.28746, Avg test acc: 0.89332, Avg tpr: 0.98098, Avg fpr: 0.10827, total FA: 15033

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.24481 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.377 | acc=0.7969 | 3633.8 samples/s | 56.8 steps/s
[Step=12050 Epoch=11.8] | Loss=0.04531 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.373 | acc=0.9844 | 4938.9 samples/s | 77.2 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03290 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.384 | acc=0.9844 | 5016.2 samples/s | 78.4 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02901 | Reg=0.00222 | L2-Norm=14.887 | L2-Norm(final)=2.390 | acc=1.0000 | 4959.7 samples/s | 77.5 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02704 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.394 | acc=1.0000 | 4646.6 samples/s | 72.6 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02597 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.399 | acc=1.0000 | 4808.5 samples/s | 75.1 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02545 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.402 | acc=1.0000 | 4871.4 samples/s | 76.1 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02477 | Reg=0.00223 | L2-Norm=14.933 | L2-Norm(final)=2.405 | acc=0.9844 | 5080.9 samples/s | 79.4 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02467 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.407 | acc=1.0000 | 4925.7 samples/s | 77.0 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02401 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.408 | acc=0.9844 | 4939.0 samples/s | 77.2 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02425 | Reg=0.00224 | L2-Norm=14.955 | L2-Norm(final)=2.409 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02422 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.410 | acc=0.9531 | 4916.5 samples/s | 76.8 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02365 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.411 | acc=0.9688 | 4996.8 samples/s | 78.1 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02341 | Reg=0.00224 | L2-Norm=14.975 | L2-Norm(final)=2.412 | acc=0.9688 | 4867.7 samples/s | 76.1 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02302 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.414 | acc=0.9844 | 4912.9 samples/s | 76.8 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02282 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.415 | acc=1.0000 | 4966.2 samples/s | 77.6 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02258 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.417 | acc=1.0000 | 5054.9 samples/s | 79.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.01061 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.378 | acc=1.0000 | 3445.2 samples/s | 53.8 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00497 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.372 | acc=1.0000 | 4606.5 samples/s | 72.0 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00255 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.375 | acc=1.0000 | 4823.6 samples/s | 75.4 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00178 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.378 | acc=1.0000 | 4630.5 samples/s | 72.4 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00137 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.380 | acc=1.0000 | 4760.9 samples/s | 74.4 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00110 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.383 | acc=1.0000 | 4658.8 samples/s | 72.8 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00092 | Reg=0.00220 | L2-Norm=14.816 | L2-Norm(final)=2.385 | acc=1.0000 | 4782.1 samples/s | 74.7 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00079 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.387 | acc=1.0000 | 4693.7 samples/s | 73.3 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00070 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.389 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00063 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.390 | acc=1.0000 | 4727.3 samples/s | 73.9 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00057 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.392 | acc=1.0000 | 4676.3 samples/s | 73.1 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00052 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.394 | acc=1.0000 | 2004.1 samples/s | 31.3 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00047 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.395 | acc=1.0000 | 4863.1 samples/s | 76.0 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00044 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.396 | acc=1.0000 | 4766.4 samples/s | 74.5 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00041 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.397 | acc=1.0000 | 4832.0 samples/s | 75.5 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00038 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.398 | acc=1.0000 | 4735.5 samples/s | 74.0 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00036 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.399 | acc=1.0000 | 4686.0 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26882 | acc=0.8203 | tpr=0.7418 | fpr=0.0092 | 4403.8 samples/s | 17.2 steps/s
Avg test loss: 0.26864, Avg test acc: 0.82126, Avg tpr: 0.74407, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.42312 | acc=0.8408 | tpr=0.9779 | fpr=0.1617 | 4404.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.43381 | acc=0.8400 | tpr=0.9851 | fpr=0.1627 | 9160.0 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.44505 | acc=0.8377 | tpr=0.9856 | fpr=0.1651 | 8517.8 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.44763 | acc=0.8372 | tpr=0.9847 | fpr=0.1655 | 8649.4 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.44733 | acc=0.8376 | tpr=0.9860 | fpr=0.1651 | 9102.1 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.44937 | acc=0.8372 | tpr=0.9833 | fpr=0.1655 | 8612.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.45162 | acc=0.8368 | tpr=0.9825 | fpr=0.1658 | 9012.2 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.45284 | acc=0.8369 | tpr=0.9809 | fpr=0.1657 | 8860.3 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.45514 | acc=0.8370 | tpr=0.9810 | fpr=0.1656 | 8659.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.45502 | acc=0.8368 | tpr=0.9815 | fpr=0.1658 | 8386.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.45339 | acc=0.8370 | tpr=0.9805 | fpr=0.1656 | 16127.1 samples/s | 63.0 steps/s
Avg test loss: 0.45308, Avg test acc: 0.83693, Avg tpr: 0.98019, Avg fpr: 0.16568, total FA: 23004

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.22505 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.424 | acc=0.8125 | 4090.1 samples/s | 63.9 steps/s
[Step=12850 Epoch=12.5] | Loss=0.03593 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.418 | acc=0.9844 | 4513.1 samples/s | 70.5 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02812 | Reg=0.00218 | L2-Norm=14.762 | L2-Norm(final)=2.426 | acc=0.9844 | 5107.3 samples/s | 79.8 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02483 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.434 | acc=0.9688 | 5072.4 samples/s | 79.3 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02344 | Reg=0.00219 | L2-Norm=14.789 | L2-Norm(final)=2.439 | acc=0.9844 | 5055.9 samples/s | 79.0 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02175 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.444 | acc=1.0000 | 5082.9 samples/s | 79.4 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02177 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.448 | acc=0.9531 | 5048.3 samples/s | 78.9 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02174 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.450 | acc=0.9844 | 5093.8 samples/s | 79.6 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02165 | Reg=0.00220 | L2-Norm=14.825 | L2-Norm(final)=2.452 | acc=0.9688 | 5147.4 samples/s | 80.4 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02141 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.454 | acc=0.9844 | 5031.8 samples/s | 78.6 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02140 | Reg=0.00220 | L2-Norm=14.839 | L2-Norm(final)=2.456 | acc=0.9688 | 5059.5 samples/s | 79.1 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02127 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.459 | acc=1.0000 | 5077.0 samples/s | 79.3 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02109 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.461 | acc=0.9844 | 5090.6 samples/s | 79.5 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02106 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.463 | acc=0.9531 | 5083.2 samples/s | 79.4 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02106 | Reg=0.00221 | L2-Norm=14.867 | L2-Norm(final)=2.464 | acc=1.0000 | 5116.0 samples/s | 79.9 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02093 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.465 | acc=0.9844 | 5055.4 samples/s | 79.0 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02089 | Reg=0.00221 | L2-Norm=14.881 | L2-Norm(final)=2.467 | acc=1.0000 | 5079.4 samples/s | 79.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.07947 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.424 | acc=0.9375 | 3627.0 samples/s | 56.7 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00596 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.421 | acc=1.0000 | 4572.8 samples/s | 71.5 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00440 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.419 | acc=1.0000 | 4777.6 samples/s | 74.6 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00359 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.416 | acc=1.0000 | 4827.9 samples/s | 75.4 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00291 | Reg=0.00221 | L2-Norm=14.878 | L2-Norm(final)=2.413 | acc=1.0000 | 4746.0 samples/s | 74.2 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00237 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.413 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00206 | Reg=0.00222 | L2-Norm=14.884 | L2-Norm(final)=2.413 | acc=1.0000 | 4727.1 samples/s | 73.9 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00181 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.414 | acc=1.0000 | 4783.7 samples/s | 74.7 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00164 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.415 | acc=1.0000 | 4792.6 samples/s | 74.9 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00146 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.417 | acc=1.0000 | 4837.2 samples/s | 75.6 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00131 | Reg=0.00221 | L2-Norm=14.870 | L2-Norm(final)=2.418 | acc=1.0000 | 4827.8 samples/s | 75.4 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00140 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.418 | acc=1.0000 | 1976.0 samples/s | 30.9 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00135 | Reg=0.00221 | L2-Norm=14.861 | L2-Norm(final)=2.418 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00126 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.417 | acc=1.0000 | 4618.7 samples/s | 72.2 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00117 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.417 | acc=1.0000 | 4580.2 samples/s | 71.6 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00110 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.417 | acc=1.0000 | 4736.4 samples/s | 74.0 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00103 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.417 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39379 | acc=0.7493 | tpr=0.6383 | fpr=0.0097 | 4407.8 samples/s | 17.2 steps/s
Avg test loss: 0.39006, Avg test acc: 0.74854, Avg tpr: 0.63951, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.28709 | acc=0.9032 | tpr=0.9823 | fpr=0.0982 | 4540.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.29656 | acc=0.9016 | tpr=0.9893 | fpr=0.1001 | 8320.7 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.30497 | acc=0.8991 | tpr=0.9899 | fpr=0.1026 | 8619.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.30600 | acc=0.8982 | tpr=0.9880 | fpr=0.1034 | 8770.7 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.30575 | acc=0.8976 | tpr=0.9886 | fpr=0.1040 | 8771.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.30746 | acc=0.8974 | tpr=0.9869 | fpr=0.1043 | 8520.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.31009 | acc=0.8969 | tpr=0.9856 | fpr=0.1048 | 8706.0 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.31196 | acc=0.8968 | tpr=0.9847 | fpr=0.1048 | 8828.4 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.31466 | acc=0.8965 | tpr=0.9849 | fpr=0.1051 | 8739.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.31400 | acc=0.8965 | tpr=0.9837 | fpr=0.1050 | 8709.6 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.31273 | acc=0.8970 | tpr=0.9837 | fpr=0.1046 | 15833.3 samples/s | 61.8 steps/s
Avg test loss: 0.31237, Avg test acc: 0.89697, Avg tpr: 0.98336, Avg fpr: 0.10460, total FA: 14523

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.31772 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.448 | acc=0.7812 | 3629.3 samples/s | 56.7 steps/s
[Step=13650 Epoch=13.3] | Loss=0.04139 | Reg=0.00219 | L2-Norm=14.803 | L2-Norm(final)=2.440 | acc=0.9844 | 4940.1 samples/s | 77.2 steps/s
[Step=13700 Epoch=13.4] | Loss=0.03020 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.448 | acc=0.9844 | 5103.4 samples/s | 79.7 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02623 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.455 | acc=1.0000 | 5050.1 samples/s | 78.9 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02461 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.461 | acc=0.9844 | 5096.8 samples/s | 79.6 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02313 | Reg=0.00221 | L2-Norm=14.878 | L2-Norm(final)=2.466 | acc=1.0000 | 5074.8 samples/s | 79.3 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02237 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.469 | acc=0.9688 | 5107.7 samples/s | 79.8 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02218 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.471 | acc=0.9844 | 5043.5 samples/s | 78.8 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02183 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.473 | acc=1.0000 | 4904.1 samples/s | 76.6 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02158 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.475 | acc=1.0000 | 4992.2 samples/s | 78.0 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02177 | Reg=0.00222 | L2-Norm=14.913 | L2-Norm(final)=2.477 | acc=0.9844 | 4895.9 samples/s | 76.5 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02147 | Reg=0.00223 | L2-Norm=14.920 | L2-Norm(final)=2.479 | acc=1.0000 | 5132.5 samples/s | 80.2 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02155 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.481 | acc=1.0000 | 5076.1 samples/s | 79.3 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02184 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.482 | acc=1.0000 | 5030.1 samples/s | 78.6 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02180 | Reg=0.00223 | L2-Norm=14.942 | L2-Norm(final)=2.483 | acc=1.0000 | 5041.8 samples/s | 78.8 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02193 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.484 | acc=1.0000 | 5136.2 samples/s | 80.3 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02222 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.484 | acc=0.9844 | 4836.5 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.13685 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.448 | acc=0.9531 | 3628.5 samples/s | 56.7 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00683 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.438 | acc=1.0000 | 4784.6 samples/s | 74.8 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00381 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.438 | acc=1.0000 | 4815.6 samples/s | 75.2 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00267 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.439 | acc=1.0000 | 4735.6 samples/s | 74.0 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00203 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.441 | acc=1.0000 | 4832.9 samples/s | 75.5 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00163 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.444 | acc=1.0000 | 4670.2 samples/s | 73.0 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00136 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.447 | acc=1.0000 | 4713.5 samples/s | 73.6 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00117 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.450 | acc=1.0000 | 4682.4 samples/s | 73.2 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00102 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.452 | acc=1.0000 | 4707.5 samples/s | 73.6 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00091 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.454 | acc=1.0000 | 4719.8 samples/s | 73.7 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00082 | Reg=0.00217 | L2-Norm=14.748 | L2-Norm(final)=2.456 | acc=1.0000 | 4801.7 samples/s | 75.0 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00075 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.457 | acc=1.0000 | 1973.8 samples/s | 30.8 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00069 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.459 | acc=1.0000 | 4898.4 samples/s | 76.5 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00063 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.461 | acc=1.0000 | 4769.6 samples/s | 74.5 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00059 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=2.462 | acc=1.0000 | 4813.9 samples/s | 75.2 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00055 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.464 | acc=1.0000 | 4913.4 samples/s | 76.8 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00052 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.465 | acc=1.0000 | 4669.2 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25202 | acc=0.8188 | tpr=0.7400 | fpr=0.0099 | 4376.2 samples/s | 17.1 steps/s
Avg test loss: 0.25183, Avg test acc: 0.81970, Avg tpr: 0.74226, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.38402 | acc=0.8452 | tpr=0.9735 | fpr=0.1571 | 4448.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.39197 | acc=0.8453 | tpr=0.9829 | fpr=0.1573 | 8564.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.40138 | acc=0.8432 | tpr=0.9841 | fpr=0.1594 | 8911.6 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.40333 | acc=0.8431 | tpr=0.9836 | fpr=0.1594 | 9067.0 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.40289 | acc=0.8437 | tpr=0.9843 | fpr=0.1589 | 8204.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.40404 | acc=0.8440 | tpr=0.9833 | fpr=0.1586 | 8642.8 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.40649 | acc=0.8437 | tpr=0.9818 | fpr=0.1588 | 8992.6 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.40787 | acc=0.8438 | tpr=0.9819 | fpr=0.1587 | 8483.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.41001 | acc=0.8439 | tpr=0.9825 | fpr=0.1586 | 8687.4 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.40937 | acc=0.8436 | tpr=0.9828 | fpr=0.1590 | 8769.0 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.40784 | acc=0.8441 | tpr=0.9829 | fpr=0.1584 | 15970.7 samples/s | 62.4 steps/s
Avg test loss: 0.40763, Avg test acc: 0.84410, Avg tpr: 0.98296, Avg fpr: 0.15843, total FA: 21997

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.13196 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.478 | acc=0.8750 | 3818.8 samples/s | 59.7 steps/s
[Step=14450 Epoch=14.1] | Loss=0.03212 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.479 | acc=1.0000 | 4710.7 samples/s | 73.6 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02485 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.489 | acc=0.9844 | 4859.5 samples/s | 75.9 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02184 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.496 | acc=1.0000 | 4834.6 samples/s | 75.5 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02192 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.499 | acc=0.9844 | 4937.3 samples/s | 77.1 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02204 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.501 | acc=1.0000 | 5011.9 samples/s | 78.3 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02156 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.502 | acc=1.0000 | 5012.7 samples/s | 78.3 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02098 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.503 | acc=1.0000 | 5071.9 samples/s | 79.2 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02123 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.504 | acc=0.9844 | 4865.2 samples/s | 76.0 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02077 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.504 | acc=0.9531 | 4985.2 samples/s | 77.9 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02101 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.505 | acc=0.9688 | 4978.6 samples/s | 77.8 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02045 | Reg=0.00220 | L2-Norm=14.829 | L2-Norm(final)=2.507 | acc=1.0000 | 4913.2 samples/s | 76.8 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02054 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.508 | acc=1.0000 | 4953.5 samples/s | 77.4 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02047 | Reg=0.00220 | L2-Norm=14.841 | L2-Norm(final)=2.509 | acc=1.0000 | 4943.3 samples/s | 77.2 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02044 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.510 | acc=0.9375 | 4982.2 samples/s | 77.8 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02050 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.512 | acc=0.9844 | 4920.7 samples/s | 76.9 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02063 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.513 | acc=0.9844 | 4982.3 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.05544 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.478 | acc=0.9375 | 3545.3 samples/s | 55.4 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00678 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.473 | acc=1.0000 | 4412.6 samples/s | 68.9 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00411 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.471 | acc=1.0000 | 4702.6 samples/s | 73.5 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00283 | Reg=0.00220 | L2-Norm=14.839 | L2-Norm(final)=2.472 | acc=1.0000 | 4683.8 samples/s | 73.2 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00241 | Reg=0.00220 | L2-Norm=14.837 | L2-Norm(final)=2.473 | acc=1.0000 | 4684.6 samples/s | 73.2 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00219 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.474 | acc=0.9844 | 4723.6 samples/s | 73.8 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00190 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.474 | acc=1.0000 | 4681.2 samples/s | 73.1 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00163 | Reg=0.00220 | L2-Norm=14.830 | L2-Norm(final)=2.475 | acc=1.0000 | 4650.1 samples/s | 72.7 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00144 | Reg=0.00220 | L2-Norm=14.825 | L2-Norm(final)=2.476 | acc=1.0000 | 4701.3 samples/s | 73.5 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00128 | Reg=0.00220 | L2-Norm=14.819 | L2-Norm(final)=2.477 | acc=1.0000 | 4795.0 samples/s | 74.9 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00115 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.479 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00105 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.480 | acc=1.0000 | 1966.9 samples/s | 30.7 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00096 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.481 | acc=1.0000 | 4750.4 samples/s | 74.2 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00089 | Reg=0.00219 | L2-Norm=14.786 | L2-Norm(final)=2.482 | acc=1.0000 | 4819.7 samples/s | 75.3 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00083 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.483 | acc=1.0000 | 4665.3 samples/s | 72.9 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00077 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.484 | acc=1.0000 | 4800.5 samples/s | 75.0 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00073 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.486 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47615 | acc=0.7023 | tpr=0.5683 | fpr=0.0067 | 4401.6 samples/s | 17.2 steps/s
Avg test loss: 0.47644, Avg test acc: 0.70126, Avg tpr: 0.56857, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.26964 | acc=0.9136 | tpr=0.9823 | fpr=0.0876 | 4441.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.27816 | acc=0.9124 | tpr=0.9851 | fpr=0.0890 | 8631.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.28580 | acc=0.9113 | tpr=0.9856 | fpr=0.0901 | 9024.6 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.28751 | acc=0.9113 | tpr=0.9825 | fpr=0.0900 | 8474.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.28661 | acc=0.9113 | tpr=0.9843 | fpr=0.0900 | 9017.1 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.28884 | acc=0.9110 | tpr=0.9833 | fpr=0.0904 | 8398.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.29127 | acc=0.9105 | tpr=0.9825 | fpr=0.0908 | 9199.7 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.29287 | acc=0.9102 | tpr=0.9825 | fpr=0.0911 | 8421.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.29532 | acc=0.9098 | tpr=0.9830 | fpr=0.0915 | 8646.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.29498 | acc=0.9094 | tpr=0.9819 | fpr=0.0919 | 8520.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.29366 | acc=0.9095 | tpr=0.9825 | fpr=0.0918 | 15862.0 samples/s | 62.0 steps/s
Avg test loss: 0.29340, Avg test acc: 0.90956, Avg tpr: 0.98257, Avg fpr: 0.09176, total FA: 12741

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.14237 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.512 | acc=0.8594 | 3766.7 samples/s | 58.9 steps/s
[Step=15250 Epoch=14.9] | Loss=0.05162 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.495 | acc=0.9844 | 4753.3 samples/s | 74.3 steps/s
[Step=15300 Epoch=14.9] | Loss=0.03497 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.503 | acc=0.9844 | 4932.4 samples/s | 77.1 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02906 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.509 | acc=0.9688 | 5052.7 samples/s | 78.9 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02632 | Reg=0.00219 | L2-Norm=14.801 | L2-Norm(final)=2.513 | acc=0.9844 | 5066.7 samples/s | 79.2 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02459 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.516 | acc=0.9844 | 5005.5 samples/s | 78.2 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02365 | Reg=0.00220 | L2-Norm=14.816 | L2-Norm(final)=2.518 | acc=0.9844 | 4962.3 samples/s | 77.5 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02297 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.521 | acc=0.9688 | 4989.6 samples/s | 78.0 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02241 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.523 | acc=0.9844 | 4946.1 samples/s | 77.3 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02201 | Reg=0.00220 | L2-Norm=14.837 | L2-Norm(final)=2.525 | acc=0.9531 | 4981.7 samples/s | 77.8 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02185 | Reg=0.00220 | L2-Norm=14.843 | L2-Norm(final)=2.527 | acc=0.9688 | 5044.6 samples/s | 78.8 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02152 | Reg=0.00221 | L2-Norm=14.849 | L2-Norm(final)=2.529 | acc=0.9688 | 4950.9 samples/s | 77.4 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02129 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.530 | acc=0.9844 | 5067.8 samples/s | 79.2 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02142 | Reg=0.00221 | L2-Norm=14.863 | L2-Norm(final)=2.532 | acc=0.9531 | 4850.0 samples/s | 75.8 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02147 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.533 | acc=1.0000 | 5023.2 samples/s | 78.5 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02127 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.535 | acc=0.9531 | 5035.5 samples/s | 78.7 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02126 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.536 | acc=0.9688 | 4934.7 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.03388 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.512 | acc=0.9844 | 3597.8 samples/s | 56.2 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00594 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.512 | acc=1.0000 | 4559.2 samples/s | 71.2 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00396 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.506 | acc=1.0000 | 4770.2 samples/s | 74.5 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00386 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.496 | acc=1.0000 | 4788.1 samples/s | 74.8 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00297 | Reg=0.00220 | L2-Norm=14.816 | L2-Norm(final)=2.491 | acc=1.0000 | 4803.0 samples/s | 75.0 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00240 | Reg=0.00220 | L2-Norm=14.819 | L2-Norm(final)=2.489 | acc=1.0000 | 4889.5 samples/s | 76.4 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00211 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.488 | acc=1.0000 | 4759.4 samples/s | 74.4 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00183 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.489 | acc=1.0000 | 4896.7 samples/s | 76.5 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00161 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.490 | acc=1.0000 | 4718.7 samples/s | 73.7 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00144 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.492 | acc=1.0000 | 4726.4 samples/s | 73.9 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00130 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.493 | acc=1.0000 | 4842.6 samples/s | 75.7 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00118 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.494 | acc=1.0000 | 1897.4 samples/s | 29.6 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00108 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.495 | acc=1.0000 | 4858.5 samples/s | 75.9 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00100 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.496 | acc=1.0000 | 4868.6 samples/s | 76.1 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00093 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.497 | acc=1.0000 | 4812.3 samples/s | 75.2 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00087 | Reg=0.00218 | L2-Norm=14.764 | L2-Norm(final)=2.498 | acc=1.0000 | 4751.3 samples/s | 74.2 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00081 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.499 | acc=1.0000 | 4852.2 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30986 | acc=0.8021 | tpr=0.7165 | fpr=0.0119 | 4406.4 samples/s | 17.2 steps/s
Avg test loss: 0.30799, Avg test acc: 0.80191, Avg tpr: 0.71703, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.35976 | acc=0.8680 | tpr=0.9823 | fpr=0.1340 | 4440.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.37070 | acc=0.8673 | tpr=0.9872 | fpr=0.1350 | 8684.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.37938 | acc=0.8650 | tpr=0.9841 | fpr=0.1372 | 9000.5 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.38102 | acc=0.8653 | tpr=0.9825 | fpr=0.1369 | 8776.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.38114 | acc=0.8652 | tpr=0.9843 | fpr=0.1370 | 8461.5 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.38259 | acc=0.8648 | tpr=0.9825 | fpr=0.1374 | 8701.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.38498 | acc=0.8641 | tpr=0.9818 | fpr=0.1380 | 8918.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.38662 | acc=0.8642 | tpr=0.9814 | fpr=0.1380 | 8392.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.38917 | acc=0.8642 | tpr=0.9815 | fpr=0.1380 | 8820.0 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.38904 | acc=0.8640 | tpr=0.9811 | fpr=0.1382 | 8869.6 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.38703 | acc=0.8643 | tpr=0.9809 | fpr=0.1378 | 15895.1 samples/s | 62.1 steps/s
Avg test loss: 0.38685, Avg test acc: 0.86432, Avg tpr: 0.98098, Avg fpr: 0.13781, total FA: 19134

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.31205 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.529 | acc=0.8125 | 3806.7 samples/s | 59.5 steps/s
[Step=16050 Epoch=15.7] | Loss=0.03947 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.524 | acc=1.0000 | 5048.1 samples/s | 78.9 steps/s
[Step=16100 Epoch=15.7] | Loss=0.02886 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=2.529 | acc=1.0000 | 4935.9 samples/s | 77.1 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02361 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.534 | acc=0.9531 | 4994.9 samples/s | 78.0 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02122 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.540 | acc=1.0000 | 4957.9 samples/s | 77.5 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02022 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.543 | acc=0.9844 | 4877.6 samples/s | 76.2 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01950 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.546 | acc=0.9844 | 4995.9 samples/s | 78.1 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01885 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.548 | acc=0.9688 | 4939.8 samples/s | 77.2 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01795 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.551 | acc=1.0000 | 4899.9 samples/s | 76.6 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01728 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.553 | acc=1.0000 | 4769.4 samples/s | 74.5 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01696 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.555 | acc=1.0000 | 4877.1 samples/s | 76.2 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01667 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.557 | acc=1.0000 | 4922.2 samples/s | 76.9 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01678 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.559 | acc=0.9844 | 4978.0 samples/s | 77.8 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01651 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.561 | acc=1.0000 | 4959.5 samples/s | 77.5 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01637 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.562 | acc=0.9844 | 4942.8 samples/s | 77.2 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01611 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.564 | acc=0.9844 | 5008.6 samples/s | 78.3 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01600 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.566 | acc=0.9844 | 4979.2 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.07908 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.529 | acc=0.9688 | 4000.4 samples/s | 62.5 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00450 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.527 | acc=1.0000 | 4209.1 samples/s | 65.8 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00232 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.529 | acc=1.0000 | 4837.4 samples/s | 75.6 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00156 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.530 | acc=1.0000 | 4649.8 samples/s | 72.7 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00119 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=2.531 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00096 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=2.532 | acc=1.0000 | 4661.4 samples/s | 72.8 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00080 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=2.533 | acc=1.0000 | 4662.4 samples/s | 72.8 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00069 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.534 | acc=1.0000 | 4681.2 samples/s | 73.1 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00061 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.535 | acc=1.0000 | 4696.6 samples/s | 73.4 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00054 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.536 | acc=1.0000 | 4712.9 samples/s | 73.6 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00049 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.536 | acc=1.0000 | 4719.4 samples/s | 73.7 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00045 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.537 | acc=1.0000 | 1927.5 samples/s | 30.1 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00041 | Reg=0.00215 | L2-Norm=14.670 | L2-Norm(final)=2.538 | acc=1.0000 | 4688.7 samples/s | 73.3 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00038 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.538 | acc=1.0000 | 4621.5 samples/s | 72.2 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00035 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.539 | acc=1.0000 | 4691.6 samples/s | 73.3 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00033 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.539 | acc=1.0000 | 4638.3 samples/s | 72.5 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00031 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.540 | acc=1.0000 | 4658.5 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30015 | acc=0.8163 | tpr=0.7354 | fpr=0.0079 | 4350.9 samples/s | 17.0 steps/s
Avg test loss: 0.29733, Avg test acc: 0.81821, Avg tpr: 0.73917, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.41123 | acc=0.8659 | tpr=0.9823 | fpr=0.1362 | 4401.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.42124 | acc=0.8653 | tpr=0.9872 | fpr=0.1370 | 9436.6 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.43223 | acc=0.8628 | tpr=0.9841 | fpr=0.1394 | 8192.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.43297 | acc=0.8631 | tpr=0.9814 | fpr=0.1391 | 8816.8 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.43316 | acc=0.8626 | tpr=0.9834 | fpr=0.1396 | 8675.7 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.43481 | acc=0.8624 | tpr=0.9825 | fpr=0.1397 | 8708.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.43764 | acc=0.8622 | tpr=0.9818 | fpr=0.1400 | 8597.3 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.43884 | acc=0.8623 | tpr=0.9814 | fpr=0.1399 | 8907.8 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.44173 | acc=0.8620 | tpr=0.9815 | fpr=0.1402 | 8967.7 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.44168 | acc=0.8617 | tpr=0.9815 | fpr=0.1405 | 8441.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.43925 | acc=0.8619 | tpr=0.9817 | fpr=0.1402 | 15768.8 samples/s | 61.6 steps/s
Avg test loss: 0.43903, Avg test acc: 0.86195, Avg tpr: 0.98177, Avg fpr: 0.14023, total FA: 19471

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.27388 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=2.569 | acc=0.8281 | 3588.3 samples/s | 56.1 steps/s
[Step=16850 Epoch=16.5] | Loss=0.03247 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.565 | acc=0.9844 | 5014.3 samples/s | 78.3 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02336 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.570 | acc=1.0000 | 5058.7 samples/s | 79.0 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01962 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.575 | acc=1.0000 | 5045.4 samples/s | 78.8 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01769 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=2.578 | acc=0.9844 | 5108.8 samples/s | 79.8 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01610 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.582 | acc=0.9844 | 4889.9 samples/s | 76.4 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01514 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.585 | acc=0.9688 | 4882.3 samples/s | 76.3 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01509 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.587 | acc=1.0000 | 5079.2 samples/s | 79.4 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01490 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.589 | acc=1.0000 | 5009.0 samples/s | 78.3 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01464 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.591 | acc=0.9844 | 4972.2 samples/s | 77.7 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01463 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.593 | acc=1.0000 | 4984.4 samples/s | 77.9 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01442 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=2.595 | acc=0.9844 | 4986.5 samples/s | 77.9 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01432 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=2.596 | acc=0.9844 | 4871.1 samples/s | 76.1 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01426 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.598 | acc=1.0000 | 4986.2 samples/s | 77.9 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01416 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.600 | acc=0.9688 | 4886.6 samples/s | 76.4 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01409 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=2.601 | acc=0.9844 | 5109.4 samples/s | 79.8 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01420 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.603 | acc=1.0000 | 5014.2 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.06632 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=2.569 | acc=0.9688 | 3836.7 samples/s | 59.9 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00510 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.562 | acc=1.0000 | 4333.0 samples/s | 67.7 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00264 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.563 | acc=1.0000 | 4748.8 samples/s | 74.2 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00179 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.565 | acc=1.0000 | 4698.9 samples/s | 73.4 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00134 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.566 | acc=1.0000 | 4693.8 samples/s | 73.3 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00109 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.567 | acc=1.0000 | 4701.0 samples/s | 73.5 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00091 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.568 | acc=1.0000 | 4749.2 samples/s | 74.2 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00078 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.569 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00069 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.570 | acc=1.0000 | 4752.6 samples/s | 74.3 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00061 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.571 | acc=1.0000 | 4545.2 samples/s | 71.0 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00056 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=2.572 | acc=1.0000 | 4539.3 samples/s | 70.9 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00051 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.573 | acc=1.0000 | 2003.7 samples/s | 31.3 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00047 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.574 | acc=1.0000 | 4787.7 samples/s | 74.8 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00043 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.574 | acc=1.0000 | 4704.1 samples/s | 73.5 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00040 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.575 | acc=1.0000 | 4728.2 samples/s | 73.9 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00038 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.576 | acc=1.0000 | 4620.0 samples/s | 72.2 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00035 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.577 | acc=1.0000 | 4777.2 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32232 | acc=0.8088 | tpr=0.7246 | fpr=0.0082 | 4398.8 samples/s | 17.2 steps/s
Avg test loss: 0.32095, Avg test acc: 0.81200, Avg tpr: 0.73026, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.39243 | acc=0.8775 | tpr=0.9779 | fpr=0.1243 | 4433.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.40182 | acc=0.8788 | tpr=0.9829 | fpr=0.1232 | 8731.9 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.41270 | acc=0.8761 | tpr=0.9827 | fpr=0.1258 | 8841.2 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.41540 | acc=0.8765 | tpr=0.9814 | fpr=0.1254 | 8706.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.41594 | acc=0.8760 | tpr=0.9834 | fpr=0.1260 | 8776.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.41751 | acc=0.8759 | tpr=0.9825 | fpr=0.1261 | 8419.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.42014 | acc=0.8757 | tpr=0.9812 | fpr=0.1262 | 8866.1 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.42208 | acc=0.8753 | tpr=0.9803 | fpr=0.1266 | 8427.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.42497 | acc=0.8752 | tpr=0.9805 | fpr=0.1267 | 8833.6 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.42475 | acc=0.8751 | tpr=0.9806 | fpr=0.1268 | 8581.4 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.42230 | acc=0.8758 | tpr=0.9809 | fpr=0.1261 | 16216.1 samples/s | 63.3 steps/s
Avg test loss: 0.42205, Avg test acc: 0.87586, Avg tpr: 0.98098, Avg fpr: 0.12605, total FA: 17502

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.20693 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.604 | acc=0.8906 | 3829.2 samples/s | 59.8 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03199 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.601 | acc=1.0000 | 4804.0 samples/s | 75.1 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02257 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.606 | acc=0.9844 | 4926.3 samples/s | 77.0 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01907 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.610 | acc=1.0000 | 4962.8 samples/s | 77.5 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01816 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.613 | acc=0.9844 | 4897.3 samples/s | 76.5 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01733 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.617 | acc=0.9844 | 4980.6 samples/s | 77.8 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01653 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.619 | acc=0.9844 | 4981.7 samples/s | 77.8 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01563 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.622 | acc=1.0000 | 5146.7 samples/s | 80.4 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01527 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.624 | acc=0.9844 | 5053.4 samples/s | 79.0 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01516 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.626 | acc=1.0000 | 5058.2 samples/s | 79.0 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01470 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.627 | acc=1.0000 | 5143.0 samples/s | 80.4 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01452 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.629 | acc=1.0000 | 5006.9 samples/s | 78.2 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01435 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.631 | acc=1.0000 | 4818.4 samples/s | 75.3 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01430 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.633 | acc=0.9688 | 5054.9 samples/s | 79.0 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01438 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.635 | acc=0.9844 | 5135.9 samples/s | 80.2 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01433 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.636 | acc=0.9844 | 5097.2 samples/s | 79.6 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01409 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.637 | acc=0.9531 | 5075.5 samples/s | 79.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.00329 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.604 | acc=1.0000 | 3604.2 samples/s | 56.3 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00304 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.609 | acc=1.0000 | 4651.7 samples/s | 72.7 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00166 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.610 | acc=1.0000 | 4758.9 samples/s | 74.4 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00112 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.612 | acc=1.0000 | 4562.4 samples/s | 71.3 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00085 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.613 | acc=1.0000 | 4728.4 samples/s | 73.9 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00068 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=2.614 | acc=1.0000 | 4915.2 samples/s | 76.8 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00057 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.614 | acc=1.0000 | 4814.2 samples/s | 75.2 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00049 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=2.615 | acc=1.0000 | 4776.5 samples/s | 74.6 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00043 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.615 | acc=1.0000 | 4929.6 samples/s | 77.0 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00039 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.616 | acc=1.0000 | 4795.9 samples/s | 74.9 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00035 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=2.617 | acc=1.0000 | 4815.0 samples/s | 75.2 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00032 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=2.617 | acc=1.0000 | 1986.3 samples/s | 31.0 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00029 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.618 | acc=1.0000 | 4833.8 samples/s | 75.5 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00027 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.619 | acc=1.0000 | 4807.4 samples/s | 75.1 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00025 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.619 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00024 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.619 | acc=1.0000 | 4799.1 samples/s | 75.0 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00022 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=2.620 | acc=1.0000 | 4632.3 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40520 | acc=0.7749 | tpr=0.6742 | fpr=0.0064 | 4469.1 samples/s | 17.5 steps/s
Avg test loss: 0.40340, Avg test acc: 0.77683, Avg tpr: 0.67821, Avg fpr: 0.00628, total FA: 49

Testing server on iccad2012
[Step=  50] | Loss=0.37064 | acc=0.8964 | tpr=0.9735 | fpr=0.1050 | 4532.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.38054 | acc=0.8974 | tpr=0.9787 | fpr=0.1041 | 8355.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.39114 | acc=0.8956 | tpr=0.9769 | fpr=0.1059 | 8811.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.39393 | acc=0.8960 | tpr=0.9770 | fpr=0.1055 | 8528.7 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.39374 | acc=0.8958 | tpr=0.9799 | fpr=0.1057 | 8795.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.39551 | acc=0.8954 | tpr=0.9796 | fpr=0.1061 | 8717.4 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.39864 | acc=0.8952 | tpr=0.9787 | fpr=0.1063 | 8603.9 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.40011 | acc=0.8950 | tpr=0.9787 | fpr=0.1065 | 8765.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.40354 | acc=0.8949 | tpr=0.9791 | fpr=0.1066 | 8985.8 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.40297 | acc=0.8948 | tpr=0.9789 | fpr=0.1067 | 8670.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.40058 | acc=0.8951 | tpr=0.9793 | fpr=0.1064 | 15192.7 samples/s | 59.3 steps/s
Avg test loss: 0.40016, Avg test acc: 0.89510, Avg tpr: 0.97940, Avg fpr: 0.10643, total FA: 14778

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.32767 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.642 | acc=0.8438 | 4150.9 samples/s | 64.9 steps/s
[Step=18450 Epoch=18.0] | Loss=0.03273 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=2.634 | acc=0.9688 | 4315.5 samples/s | 67.4 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02416 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.638 | acc=0.9844 | 4894.4 samples/s | 76.5 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01961 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.643 | acc=0.9844 | 4872.0 samples/s | 76.1 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01774 | Reg=0.00213 | L2-Norm=14.583 | L2-Norm(final)=2.647 | acc=1.0000 | 4873.1 samples/s | 76.1 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01630 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.650 | acc=1.0000 | 5024.7 samples/s | 78.5 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01558 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.653 | acc=1.0000 | 5138.0 samples/s | 80.3 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01492 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=2.656 | acc=1.0000 | 4902.6 samples/s | 76.6 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01474 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.658 | acc=0.9844 | 4972.6 samples/s | 77.7 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01454 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.660 | acc=1.0000 | 4985.2 samples/s | 77.9 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01494 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.662 | acc=1.0000 | 5076.0 samples/s | 79.3 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01453 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.663 | acc=1.0000 | 5008.0 samples/s | 78.2 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01451 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.665 | acc=0.9844 | 4987.8 samples/s | 77.9 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01447 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.666 | acc=1.0000 | 5024.7 samples/s | 78.5 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01444 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.668 | acc=1.0000 | 4960.9 samples/s | 77.5 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01437 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=2.669 | acc=1.0000 | 4957.5 samples/s | 77.5 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01432 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.671 | acc=1.0000 | 5015.2 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.00468 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.643 | acc=1.0000 | 3528.0 samples/s | 55.1 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00199 | Reg=0.00212 | L2-Norm=14.543 | L2-Norm(final)=2.650 | acc=1.0000 | 4663.2 samples/s | 72.9 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00102 | Reg=0.00212 | L2-Norm=14.549 | L2-Norm(final)=2.653 | acc=1.0000 | 4824.1 samples/s | 75.4 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00069 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=2.656 | acc=1.0000 | 4765.9 samples/s | 74.5 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00056 | Reg=0.00212 | L2-Norm=14.543 | L2-Norm(final)=2.657 | acc=1.0000 | 4812.3 samples/s | 75.2 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00046 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=2.659 | acc=1.0000 | 4842.8 samples/s | 75.7 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00038 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.661 | acc=1.0000 | 4774.4 samples/s | 74.6 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.663 | acc=1.0000 | 4792.2 samples/s | 74.9 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00033 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.664 | acc=1.0000 | 4649.1 samples/s | 72.6 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00029 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=2.666 | acc=1.0000 | 4845.7 samples/s | 75.7 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00026 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.667 | acc=1.0000 | 4650.9 samples/s | 72.7 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00024 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=2.668 | acc=1.0000 | 1971.4 samples/s | 30.8 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00022 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=2.669 | acc=1.0000 | 4790.7 samples/s | 74.9 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00020 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=2.670 | acc=1.0000 | 4838.1 samples/s | 75.6 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00019 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.670 | acc=1.0000 | 4823.1 samples/s | 75.4 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00018 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=2.671 | acc=1.0000 | 4809.3 samples/s | 75.1 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00017 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=2.672 | acc=1.0000 | 4793.5 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28095 | acc=0.8362 | tpr=0.7648 | fpr=0.0089 | 4434.0 samples/s | 17.3 steps/s
Avg test loss: 0.28104, Avg test acc: 0.83665, Avg tpr: 0.76622, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.45496 | acc=0.8633 | tpr=0.9779 | fpr=0.1388 | 4427.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.46457 | acc=0.8628 | tpr=0.9851 | fpr=0.1395 | 8762.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.47791 | acc=0.8604 | tpr=0.9813 | fpr=0.1418 | 8729.0 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.48067 | acc=0.8609 | tpr=0.9792 | fpr=0.1413 | 9515.3 samples/s | 37.2 steps/s
[Step= 250] | Loss=0.48029 | acc=0.8614 | tpr=0.9817 | fpr=0.1408 | 8180.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.48189 | acc=0.8613 | tpr=0.9804 | fpr=0.1409 | 8646.5 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.48465 | acc=0.8613 | tpr=0.9800 | fpr=0.1409 | 8589.5 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.48563 | acc=0.8610 | tpr=0.9792 | fpr=0.1411 | 8766.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.48881 | acc=0.8610 | tpr=0.9796 | fpr=0.1411 | 8692.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.48860 | acc=0.8608 | tpr=0.9789 | fpr=0.1413 | 8595.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.48645 | acc=0.8609 | tpr=0.9793 | fpr=0.1412 | 15458.5 samples/s | 60.4 steps/s
Avg test loss: 0.48623, Avg test acc: 0.86092, Avg tpr: 0.97940, Avg fpr: 0.14123, total FA: 19610

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.23349 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.686 | acc=0.8281 | 3556.9 samples/s | 55.6 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02534 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=2.683 | acc=1.0000 | 4922.2 samples/s | 76.9 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02020 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=2.686 | acc=1.0000 | 5037.0 samples/s | 78.7 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01619 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=2.688 | acc=0.9844 | 5029.0 samples/s | 78.6 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01484 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=2.691 | acc=0.9844 | 5053.0 samples/s | 79.0 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01397 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=2.694 | acc=1.0000 | 5062.2 samples/s | 79.1 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01339 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=2.696 | acc=1.0000 | 4996.5 samples/s | 78.1 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01272 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.699 | acc=0.9844 | 4998.5 samples/s | 78.1 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01244 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=2.701 | acc=0.9844 | 5026.6 samples/s | 78.5 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01234 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.703 | acc=0.9844 | 4901.1 samples/s | 76.6 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01256 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.704 | acc=1.0000 | 4987.5 samples/s | 77.9 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01258 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=2.706 | acc=1.0000 | 5107.0 samples/s | 79.8 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01259 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=2.708 | acc=0.9844 | 5061.0 samples/s | 79.1 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01263 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=2.709 | acc=1.0000 | 5095.0 samples/s | 79.6 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01267 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.711 | acc=1.0000 | 5050.4 samples/s | 78.9 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01255 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=2.712 | acc=0.9688 | 4993.2 samples/s | 78.0 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01262 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.714 | acc=0.9688 | 5045.1 samples/s | 78.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.00863 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.687 | acc=0.9844 | 3527.4 samples/s | 55.1 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00246 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=2.692 | acc=1.0000 | 4420.5 samples/s | 69.1 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00124 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.694 | acc=1.0000 | 4554.3 samples/s | 71.2 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00087 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.695 | acc=1.0000 | 4632.5 samples/s | 72.4 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00066 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.696 | acc=1.0000 | 4646.2 samples/s | 72.6 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00053 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.697 | acc=1.0000 | 4614.8 samples/s | 72.1 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00044 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=2.698 | acc=1.0000 | 4827.2 samples/s | 75.4 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00038 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=2.698 | acc=1.0000 | 4603.2 samples/s | 71.9 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00033 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=2.699 | acc=1.0000 | 4704.2 samples/s | 73.5 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00030 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=2.699 | acc=1.0000 | 4649.3 samples/s | 72.6 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00027 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=2.700 | acc=1.0000 | 4754.8 samples/s | 74.3 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00025 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.700 | acc=1.0000 | 1969.0 samples/s | 30.8 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.701 | acc=1.0000 | 4788.5 samples/s | 74.8 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00021 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=2.701 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00019 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.701 | acc=1.0000 | 4817.6 samples/s | 75.3 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00018 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=2.702 | acc=1.0000 | 4848.3 samples/s | 75.8 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00017 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=2.702 | acc=1.0000 | 4807.9 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35713 | acc=0.8011 | tpr=0.7130 | fpr=0.0077 | 4412.4 samples/s | 17.2 steps/s
Avg test loss: 0.35557, Avg test acc: 0.80143, Avg tpr: 0.71458, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.40073 | acc=0.8903 | tpr=0.9779 | fpr=0.1113 | 4425.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.40839 | acc=0.8911 | tpr=0.9851 | fpr=0.1107 | 8792.6 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.42121 | acc=0.8893 | tpr=0.9827 | fpr=0.1124 | 8297.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.42388 | acc=0.8895 | tpr=0.9803 | fpr=0.1122 | 8964.0 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.42432 | acc=0.8895 | tpr=0.9825 | fpr=0.1122 | 8790.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.42588 | acc=0.8896 | tpr=0.9818 | fpr=0.1120 | 8727.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.42865 | acc=0.8895 | tpr=0.9806 | fpr=0.1121 | 8715.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.43003 | acc=0.8892 | tpr=0.9798 | fpr=0.1124 | 8679.5 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.43306 | acc=0.8891 | tpr=0.9800 | fpr=0.1125 | 8451.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.43242 | acc=0.8891 | tpr=0.9797 | fpr=0.1126 | 8671.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.42984 | acc=0.8892 | tpr=0.9801 | fpr=0.1124 | 15309.5 samples/s | 59.8 steps/s
Avg test loss: 0.42952, Avg test acc: 0.88922, Avg tpr: 0.98019, Avg fpr: 0.11243, total FA: 15611

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.24630 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=2.720 | acc=0.8125 | 3930.5 samples/s | 61.4 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02770 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.714 | acc=1.0000 | 4488.4 samples/s | 70.1 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01966 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=2.717 | acc=0.9844 | 5076.9 samples/s | 79.3 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01620 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=2.720 | acc=1.0000 | 5047.1 samples/s | 78.9 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01504 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=2.723 | acc=0.9844 | 5078.0 samples/s | 79.3 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01469 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=2.726 | acc=1.0000 | 5085.2 samples/s | 79.5 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01441 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=2.727 | acc=1.0000 | 5123.2 samples/s | 80.0 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01452 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=2.729 | acc=0.9844 | 5145.8 samples/s | 80.4 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01446 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.730 | acc=0.9844 | 5007.4 samples/s | 78.2 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01431 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=2.731 | acc=0.9844 | 5032.4 samples/s | 78.6 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01398 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=2.733 | acc=1.0000 | 5201.3 samples/s | 81.3 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01381 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=2.735 | acc=0.9844 | 5003.6 samples/s | 78.2 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01356 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=2.736 | acc=0.9688 | 5093.4 samples/s | 79.6 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01379 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=2.738 | acc=0.9688 | 5151.5 samples/s | 80.5 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01369 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=2.739 | acc=0.9844 | 4982.2 samples/s | 77.8 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01356 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=2.740 | acc=0.9844 | 4872.4 samples/s | 76.1 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01360 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=2.742 | acc=0.9844 | 4920.5 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.07939 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=2.720 | acc=0.9531 | 4035.8 samples/s | 63.1 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00296 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=2.723 | acc=1.0000 | 4103.9 samples/s | 64.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00150 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=2.725 | acc=1.0000 | 4755.6 samples/s | 74.3 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00101 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.727 | acc=1.0000 | 4762.9 samples/s | 74.4 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00077 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=2.728 | acc=1.0000 | 4670.9 samples/s | 73.0 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00061 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=2.728 | acc=1.0000 | 4719.0 samples/s | 73.7 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00051 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=2.729 | acc=1.0000 | 4666.8 samples/s | 72.9 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00044 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=2.730 | acc=1.0000 | 4679.1 samples/s | 73.1 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.440 | L2-Norm(final)=2.730 | acc=1.0000 | 4841.6 samples/s | 75.7 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00035 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=2.731 | acc=1.0000 | 4693.5 samples/s | 73.3 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=2.731 | acc=1.0000 | 4733.5 samples/s | 74.0 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=2.732 | acc=1.0000 | 1976.9 samples/s | 30.9 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00026 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.732 | acc=1.0000 | 4783.9 samples/s | 74.7 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00024 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=2.732 | acc=1.0000 | 4893.6 samples/s | 76.5 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00022 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=2.733 | acc=1.0000 | 4772.4 samples/s | 74.6 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00021 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=2.733 | acc=1.0000 | 4676.9 samples/s | 73.1 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00020 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.733 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33342 | acc=0.8145 | tpr=0.7323 | fpr=0.0072 | 4421.7 samples/s | 17.3 steps/s
Avg test loss: 0.33145, Avg test acc: 0.81465, Avg tpr: 0.73358, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.39233 | acc=0.8889 | tpr=0.9779 | fpr=0.1127 | 4514.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.40023 | acc=0.8905 | tpr=0.9829 | fpr=0.1112 | 8691.2 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.41224 | acc=0.8889 | tpr=0.9813 | fpr=0.1128 | 8563.4 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.41499 | acc=0.8896 | tpr=0.9792 | fpr=0.1120 | 8953.5 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.41561 | acc=0.8892 | tpr=0.9817 | fpr=0.1125 | 8557.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.41669 | acc=0.8890 | tpr=0.9804 | fpr=0.1126 | 8779.2 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.42017 | acc=0.8886 | tpr=0.9793 | fpr=0.1131 | 8860.1 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.42173 | acc=0.8884 | tpr=0.9787 | fpr=0.1132 | 8642.5 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.42455 | acc=0.8883 | tpr=0.9786 | fpr=0.1133 | 8942.8 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.42384 | acc=0.8883 | tpr=0.9784 | fpr=0.1133 | 8769.5 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.42128 | acc=0.8885 | tpr=0.9785 | fpr=0.1132 | 15706.3 samples/s | 61.4 steps/s
Avg test loss: 0.42097, Avg test acc: 0.88845, Avg tpr: 0.97861, Avg fpr: 0.11319, total FA: 15716

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.24995 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.749 | acc=0.8281 | 3624.7 samples/s | 56.6 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02649 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=2.745 | acc=0.9688 | 4777.3 samples/s | 74.6 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01943 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.748 | acc=0.9531 | 5031.8 samples/s | 78.6 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01670 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.752 | acc=1.0000 | 4905.0 samples/s | 76.6 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01517 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=2.754 | acc=1.0000 | 5100.2 samples/s | 79.7 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01454 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=2.757 | acc=1.0000 | 5118.8 samples/s | 80.0 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01423 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=2.759 | acc=0.9844 | 5097.9 samples/s | 79.7 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01432 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=2.762 | acc=1.0000 | 5087.4 samples/s | 79.5 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01412 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=2.763 | acc=1.0000 | 5038.8 samples/s | 78.7 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01371 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=2.764 | acc=1.0000 | 4937.5 samples/s | 77.1 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01368 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=2.766 | acc=0.9375 | 5050.2 samples/s | 78.9 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01340 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=2.767 | acc=0.9844 | 4950.9 samples/s | 77.4 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01328 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=2.769 | acc=1.0000 | 4996.2 samples/s | 78.1 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01326 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=2.771 | acc=0.9844 | 4971.0 samples/s | 77.7 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01327 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=2.772 | acc=0.9844 | 5080.3 samples/s | 79.4 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01307 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.774 | acc=1.0000 | 4940.5 samples/s | 77.2 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01267 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=2.776 | acc=1.0000 | 4973.1 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.09024 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.749 | acc=0.9844 | 3721.4 samples/s | 58.1 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00554 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=2.744 | acc=1.0000 | 4373.0 samples/s | 68.3 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00293 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=2.744 | acc=1.0000 | 4882.4 samples/s | 76.3 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00197 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=2.744 | acc=1.0000 | 4618.3 samples/s | 72.2 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00148 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=2.745 | acc=1.0000 | 4721.5 samples/s | 73.8 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00123 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.746 | acc=1.0000 | 4653.1 samples/s | 72.7 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00103 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.747 | acc=1.0000 | 4763.1 samples/s | 74.4 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00088 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=2.748 | acc=1.0000 | 4632.8 samples/s | 72.4 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00077 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=2.748 | acc=1.0000 | 4721.6 samples/s | 73.8 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00069 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.749 | acc=1.0000 | 4758.5 samples/s | 74.4 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00062 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.750 | acc=1.0000 | 4732.4 samples/s | 73.9 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00057 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=2.751 | acc=1.0000 | 1974.2 samples/s | 30.8 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00052 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=2.752 | acc=1.0000 | 4696.0 samples/s | 73.4 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00048 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.752 | acc=1.0000 | 4512.6 samples/s | 70.5 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00045 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=2.753 | acc=1.0000 | 4614.6 samples/s | 72.1 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00042 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=2.754 | acc=1.0000 | 4692.2 samples/s | 73.3 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=2.755 | acc=1.0000 | 4694.9 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37123 | acc=0.7930 | tpr=0.7013 | fpr=0.0079 | 4415.9 samples/s | 17.2 steps/s
Avg test loss: 0.37018, Avg test acc: 0.79486, Avg tpr: 0.70473, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.36603 | acc=0.9004 | tpr=0.9735 | fpr=0.1009 | 4451.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.37352 | acc=0.9010 | tpr=0.9808 | fpr=0.1005 | 8543.0 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.38510 | acc=0.8985 | tpr=0.9813 | fpr=0.1030 | 8863.2 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.38758 | acc=0.8986 | tpr=0.9792 | fpr=0.1029 | 8868.8 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.38790 | acc=0.8981 | tpr=0.9817 | fpr=0.1034 | 8572.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.38943 | acc=0.8978 | tpr=0.9804 | fpr=0.1037 | 8497.8 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.39214 | acc=0.8975 | tpr=0.9793 | fpr=0.1040 | 8865.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.39303 | acc=0.8972 | tpr=0.9781 | fpr=0.1043 | 8736.4 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.39549 | acc=0.8973 | tpr=0.9791 | fpr=0.1042 | 8591.1 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.39522 | acc=0.8970 | tpr=0.9784 | fpr=0.1044 | 8783.3 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.39310 | acc=0.8973 | tpr=0.9793 | fpr=0.1042 | 15276.1 samples/s | 59.7 steps/s
Avg test loss: 0.39276, Avg test acc: 0.89737, Avg tpr: 0.97940, Avg fpr: 0.10412, total FA: 14457

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.32799 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=2.783 | acc=0.8125 | 3560.1 samples/s | 55.6 steps/s
[Step=21650 Epoch=21.1] | Loss=0.03004 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=2.775 | acc=0.9844 | 5099.6 samples/s | 79.7 steps/s
[Step=21700 Epoch=21.2] | Loss=0.02183 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=2.778 | acc=0.9844 | 5004.5 samples/s | 78.2 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01872 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=2.780 | acc=1.0000 | 5130.1 samples/s | 80.2 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01645 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=2.783 | acc=1.0000 | 5019.1 samples/s | 78.4 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01485 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=2.787 | acc=0.9688 | 5009.9 samples/s | 78.3 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01451 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.790 | acc=0.9688 | 4957.8 samples/s | 77.5 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01383 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=2.792 | acc=1.0000 | 5004.8 samples/s | 78.2 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01387 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.795 | acc=1.0000 | 4924.1 samples/s | 76.9 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01350 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.796 | acc=0.9844 | 4955.3 samples/s | 77.4 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01357 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=2.798 | acc=0.9531 | 4967.7 samples/s | 77.6 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01346 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=2.799 | acc=0.9844 | 4933.6 samples/s | 77.1 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01325 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.801 | acc=0.9844 | 4961.4 samples/s | 77.5 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01297 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=2.803 | acc=1.0000 | 4973.3 samples/s | 77.7 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01293 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.805 | acc=0.9688 | 4949.7 samples/s | 77.3 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01285 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.806 | acc=0.9844 | 4935.3 samples/s | 77.1 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01271 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=2.808 | acc=0.9844 | 4956.0 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.00592 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=2.784 | acc=0.9844 | 3485.9 samples/s | 54.5 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00362 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=2.785 | acc=0.9844 | 4865.5 samples/s | 76.0 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00219 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.786 | acc=1.0000 | 4728.8 samples/s | 73.9 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00149 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.787 | acc=1.0000 | 4800.4 samples/s | 75.0 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00112 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=2.788 | acc=1.0000 | 4813.0 samples/s | 75.2 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00091 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.789 | acc=1.0000 | 4787.4 samples/s | 74.8 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00076 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.790 | acc=1.0000 | 4690.8 samples/s | 73.3 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00066 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.791 | acc=1.0000 | 4706.6 samples/s | 73.5 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00058 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=2.792 | acc=1.0000 | 4679.1 samples/s | 73.1 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00053 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=2.793 | acc=1.0000 | 4727.1 samples/s | 73.9 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00048 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.794 | acc=1.0000 | 4731.2 samples/s | 73.9 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00043 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.795 | acc=1.0000 | 1954.8 samples/s | 30.5 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00040 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=2.796 | acc=1.0000 | 4842.9 samples/s | 75.7 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00037 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=2.797 | acc=1.0000 | 4799.8 samples/s | 75.0 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00034 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=2.798 | acc=1.0000 | 4835.0 samples/s | 75.5 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00032 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=2.799 | acc=1.0000 | 4666.6 samples/s | 72.9 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00030 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.800 | acc=1.0000 | 4754.9 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32198 | acc=0.8145 | tpr=0.7331 | fpr=0.0089 | 4427.8 samples/s | 17.3 steps/s
Avg test loss: 0.32256, Avg test acc: 0.81525, Avg tpr: 0.73538, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.38501 | acc=0.8929 | tpr=0.9735 | fpr=0.1086 | 4450.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.39222 | acc=0.8935 | tpr=0.9829 | fpr=0.1082 | 8536.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.40482 | acc=0.8910 | tpr=0.9841 | fpr=0.1107 | 8731.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.40633 | acc=0.8915 | tpr=0.9814 | fpr=0.1101 | 8588.0 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.40657 | acc=0.8914 | tpr=0.9834 | fpr=0.1103 | 8447.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.40753 | acc=0.8914 | tpr=0.9833 | fpr=0.1103 | 8421.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.41035 | acc=0.8908 | tpr=0.9825 | fpr=0.1108 | 8774.4 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.41205 | acc=0.8905 | tpr=0.9814 | fpr=0.1112 | 8971.0 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.41471 | acc=0.8903 | tpr=0.9820 | fpr=0.1114 | 8296.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.41424 | acc=0.8904 | tpr=0.9819 | fpr=0.1112 | 9011.0 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.41225 | acc=0.8907 | tpr=0.9825 | fpr=0.1110 | 15121.3 samples/s | 59.1 steps/s
Avg test loss: 0.41187, Avg test acc: 0.89074, Avg tpr: 0.98257, Avg fpr: 0.11093, total FA: 15402

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.26538 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.822 | acc=0.8438 | 3976.8 samples/s | 62.1 steps/s
[Step=22450 Epoch=21.9] | Loss=0.02977 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.813 | acc=1.0000 | 4481.9 samples/s | 70.0 steps/s
[Step=22500 Epoch=22.0] | Loss=0.02171 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=2.816 | acc=1.0000 | 4962.9 samples/s | 77.5 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01819 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=2.819 | acc=0.9531 | 4862.4 samples/s | 76.0 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01683 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.822 | acc=0.9688 | 4861.9 samples/s | 76.0 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01586 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=2.824 | acc=0.9844 | 4867.5 samples/s | 76.1 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01533 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=2.826 | acc=0.9844 | 4992.9 samples/s | 78.0 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01471 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.828 | acc=0.9688 | 4992.4 samples/s | 78.0 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01422 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=2.830 | acc=0.9844 | 5003.3 samples/s | 78.2 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01425 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=2.832 | acc=0.9844 | 5013.6 samples/s | 78.3 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01394 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=2.834 | acc=0.9688 | 4935.9 samples/s | 77.1 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01351 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=2.836 | acc=0.9688 | 5005.0 samples/s | 78.2 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01323 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.838 | acc=1.0000 | 4949.6 samples/s | 77.3 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01298 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=2.840 | acc=1.0000 | 4983.0 samples/s | 77.9 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01285 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=2.842 | acc=0.9844 | 4856.0 samples/s | 75.9 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01276 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=2.844 | acc=1.0000 | 4879.8 samples/s | 76.2 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01259 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.846 | acc=0.9844 | 4976.5 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.01763 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.823 | acc=0.9844 | 3734.3 samples/s | 58.3 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00201 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=2.826 | acc=1.0000 | 4498.9 samples/s | 70.3 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00130 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=2.828 | acc=1.0000 | 4837.8 samples/s | 75.6 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00091 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.830 | acc=1.0000 | 4799.0 samples/s | 75.0 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00072 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.831 | acc=1.0000 | 4834.2 samples/s | 75.5 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00058 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=2.833 | acc=1.0000 | 4652.9 samples/s | 72.7 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00048 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.834 | acc=1.0000 | 4803.6 samples/s | 75.1 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00042 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.835 | acc=1.0000 | 4682.8 samples/s | 73.2 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=2.836 | acc=1.0000 | 4756.3 samples/s | 74.3 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=2.837 | acc=1.0000 | 4700.8 samples/s | 73.5 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=2.837 | acc=1.0000 | 4742.9 samples/s | 74.1 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00027 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.838 | acc=1.0000 | 1994.5 samples/s | 31.2 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=2.839 | acc=1.0000 | 4884.6 samples/s | 76.3 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=2.839 | acc=1.0000 | 4614.7 samples/s | 72.1 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=2.840 | acc=1.0000 | 4725.0 samples/s | 73.8 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00020 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.840 | acc=1.0000 | 4666.7 samples/s | 72.9 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00019 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=2.840 | acc=1.0000 | 4706.4 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33631 | acc=0.8125 | tpr=0.7292 | fpr=0.0067 | 4425.7 samples/s | 17.3 steps/s
Avg test loss: 0.33783, Avg test acc: 0.81321, Avg tpr: 0.73107, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.40382 | acc=0.8771 | tpr=0.9779 | fpr=0.1247 | 4395.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.41056 | acc=0.8782 | tpr=0.9829 | fpr=0.1237 | 8821.5 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.42398 | acc=0.8757 | tpr=0.9827 | fpr=0.1263 | 9202.4 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.42688 | acc=0.8763 | tpr=0.9803 | fpr=0.1256 | 8556.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.42726 | acc=0.8761 | tpr=0.9825 | fpr=0.1258 | 8799.3 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.42810 | acc=0.8765 | tpr=0.9818 | fpr=0.1254 | 8762.6 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.43037 | acc=0.8766 | tpr=0.9812 | fpr=0.1253 | 8843.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.43219 | acc=0.8761 | tpr=0.9803 | fpr=0.1258 | 8999.6 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.43458 | acc=0.8763 | tpr=0.9805 | fpr=0.1256 | 8349.0 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.43458 | acc=0.8761 | tpr=0.9797 | fpr=0.1258 | 8862.0 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.43232 | acc=0.8763 | tpr=0.9805 | fpr=0.1256 | 15220.0 samples/s | 59.5 steps/s
Avg test loss: 0.43206, Avg test acc: 0.87633, Avg tpr: 0.98059, Avg fpr: 0.12557, total FA: 17435

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.17431 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.858 | acc=0.8750 | 3734.3 samples/s | 58.3 steps/s
[Step=23250 Epoch=22.7] | Loss=0.03073 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=2.850 | acc=0.9688 | 4829.9 samples/s | 75.5 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02045 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=2.853 | acc=0.9844 | 5052.2 samples/s | 78.9 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01746 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=2.857 | acc=1.0000 | 5003.8 samples/s | 78.2 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01540 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.860 | acc=1.0000 | 5011.3 samples/s | 78.3 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01447 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=2.862 | acc=1.0000 | 4889.8 samples/s | 76.4 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01404 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=2.864 | acc=1.0000 | 4942.9 samples/s | 77.2 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01420 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.865 | acc=0.9531 | 4960.5 samples/s | 77.5 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01437 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.866 | acc=1.0000 | 4931.3 samples/s | 77.1 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01409 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=2.866 | acc=0.9844 | 5035.7 samples/s | 78.7 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01386 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.867 | acc=1.0000 | 4907.3 samples/s | 76.7 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01374 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.868 | acc=1.0000 | 5029.3 samples/s | 78.6 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01348 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.868 | acc=1.0000 | 4890.9 samples/s | 76.4 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01333 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.870 | acc=1.0000 | 4990.2 samples/s | 78.0 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01339 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.871 | acc=1.0000 | 4890.0 samples/s | 76.4 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01328 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.872 | acc=0.9688 | 4951.4 samples/s | 77.4 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01313 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=2.873 | acc=1.0000 | 4980.5 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.07107 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.858 | acc=0.9688 | 3532.6 samples/s | 55.2 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00284 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=2.859 | acc=1.0000 | 4422.4 samples/s | 69.1 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00185 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=2.859 | acc=1.0000 | 4702.0 samples/s | 73.5 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00127 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=2.858 | acc=1.0000 | 4580.2 samples/s | 71.6 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00095 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=2.858 | acc=1.0000 | 4673.1 samples/s | 73.0 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00077 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=2.859 | acc=1.0000 | 4764.2 samples/s | 74.4 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00064 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=2.859 | acc=1.0000 | 4756.1 samples/s | 74.3 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00055 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=2.859 | acc=1.0000 | 4802.8 samples/s | 75.0 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00049 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=2.859 | acc=1.0000 | 4858.6 samples/s | 75.9 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00043 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=2.860 | acc=1.0000 | 4795.2 samples/s | 74.9 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00039 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=2.860 | acc=1.0000 | 4896.4 samples/s | 76.5 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00036 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=2.860 | acc=1.0000 | 1964.0 samples/s | 30.7 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00033 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=2.861 | acc=1.0000 | 4908.7 samples/s | 76.7 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00030 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.861 | acc=1.0000 | 4801.1 samples/s | 75.0 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00028 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.861 | acc=1.0000 | 4703.0 samples/s | 73.5 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00026 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.862 | acc=1.0000 | 4810.0 samples/s | 75.2 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00025 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.862 | acc=1.0000 | 4608.8 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37204 | acc=0.8011 | tpr=0.7127 | fpr=0.0069 | 4413.0 samples/s | 17.2 steps/s
Avg test loss: 0.37003, Avg test acc: 0.80083, Avg tpr: 0.71329, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.37774 | acc=0.9080 | tpr=0.9735 | fpr=0.0931 | 4437.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.38985 | acc=0.9085 | tpr=0.9787 | fpr=0.0928 | 8705.7 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.40204 | acc=0.9061 | tpr=0.9798 | fpr=0.0952 | 8868.6 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.40558 | acc=0.9053 | tpr=0.9781 | fpr=0.0961 | 8428.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.40438 | acc=0.9046 | tpr=0.9808 | fpr=0.0967 | 9056.8 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.40561 | acc=0.9046 | tpr=0.9796 | fpr=0.0968 | 8233.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.40921 | acc=0.9044 | tpr=0.9787 | fpr=0.0970 | 9043.0 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.41086 | acc=0.9039 | tpr=0.9776 | fpr=0.0975 | 8218.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.41449 | acc=0.9037 | tpr=0.9791 | fpr=0.0976 | 8949.1 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.41390 | acc=0.9035 | tpr=0.9793 | fpr=0.0979 | 8612.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.41156 | acc=0.9039 | tpr=0.9797 | fpr=0.0975 | 16163.1 samples/s | 63.1 steps/s
Avg test loss: 0.41113, Avg test acc: 0.90392, Avg tpr: 0.97940, Avg fpr: 0.09745, total FA: 13531

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.28921 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=2.877 | acc=0.8125 | 3890.3 samples/s | 60.8 steps/s
[Step=24050 Epoch=23.5] | Loss=0.03381 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.871 | acc=1.0000 | 4644.1 samples/s | 72.6 steps/s
[Step=24100 Epoch=23.5] | Loss=0.02144 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=2.872 | acc=0.9844 | 4911.7 samples/s | 76.7 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01760 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=2.875 | acc=0.9688 | 4998.9 samples/s | 78.1 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01568 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.877 | acc=1.0000 | 4855.4 samples/s | 75.9 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01412 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=2.879 | acc=0.9844 | 4970.9 samples/s | 77.7 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01283 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.881 | acc=1.0000 | 4979.1 samples/s | 77.8 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01222 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.882 | acc=1.0000 | 5043.6 samples/s | 78.8 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01165 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.884 | acc=0.9688 | 4931.5 samples/s | 77.1 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01106 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=2.886 | acc=1.0000 | 5055.1 samples/s | 79.0 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01078 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.887 | acc=0.9844 | 5103.2 samples/s | 79.7 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01069 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=2.889 | acc=1.0000 | 4943.0 samples/s | 77.2 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01078 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=2.890 | acc=0.9688 | 5026.7 samples/s | 78.5 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01079 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.891 | acc=0.9844 | 4955.5 samples/s | 77.4 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01073 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=2.892 | acc=0.9844 | 5006.2 samples/s | 78.2 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01062 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=2.893 | acc=1.0000 | 4959.0 samples/s | 77.5 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01051 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=2.894 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.07421 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=2.877 | acc=0.9844 | 3436.3 samples/s | 53.7 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00258 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=2.879 | acc=1.0000 | 4639.6 samples/s | 72.5 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00133 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.880 | acc=1.0000 | 4842.0 samples/s | 75.7 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00090 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=2.882 | acc=1.0000 | 4699.8 samples/s | 73.4 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00068 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.882 | acc=1.0000 | 4746.0 samples/s | 74.2 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00055 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.883 | acc=1.0000 | 4662.1 samples/s | 72.8 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00046 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.884 | acc=1.0000 | 4646.9 samples/s | 72.6 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00040 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.885 | acc=1.0000 | 4838.8 samples/s | 75.6 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00035 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.886 | acc=1.0000 | 4607.1 samples/s | 72.0 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00032 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.887 | acc=1.0000 | 4599.0 samples/s | 71.9 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00029 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.887 | acc=1.0000 | 4612.3 samples/s | 72.1 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00026 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.888 | acc=1.0000 | 2022.3 samples/s | 31.6 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00024 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.889 | acc=1.0000 | 4886.5 samples/s | 76.4 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00022 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=2.889 | acc=1.0000 | 4799.6 samples/s | 75.0 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00021 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.889 | acc=1.0000 | 4768.5 samples/s | 74.5 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00019 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=2.890 | acc=1.0000 | 4611.7 samples/s | 72.1 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00018 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.890 | acc=1.0000 | 4718.4 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23811 | acc=0.8665 | tpr=0.8086 | fpr=0.0079 | 4403.8 samples/s | 17.2 steps/s
Avg test loss: 0.23687, Avg test acc: 0.86766, Avg tpr: 0.81121, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.50603 | acc=0.8614 | tpr=0.9779 | fpr=0.1407 | 4379.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.51735 | acc=0.8616 | tpr=0.9808 | fpr=0.1406 | 8938.4 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.53129 | acc=0.8595 | tpr=0.9813 | fpr=0.1428 | 8442.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.53510 | acc=0.8599 | tpr=0.9792 | fpr=0.1423 | 8732.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.53498 | acc=0.8600 | tpr=0.9817 | fpr=0.1422 | 9167.7 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.53654 | acc=0.8597 | tpr=0.9811 | fpr=0.1425 | 8782.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.53980 | acc=0.8597 | tpr=0.9793 | fpr=0.1425 | 8461.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.54169 | acc=0.8590 | tpr=0.9781 | fpr=0.1431 | 8808.3 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.54500 | acc=0.8592 | tpr=0.9796 | fpr=0.1430 | 9063.4 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.54422 | acc=0.8591 | tpr=0.9802 | fpr=0.1431 | 8356.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.54164 | acc=0.8591 | tpr=0.9805 | fpr=0.1431 | 15747.5 samples/s | 61.5 steps/s
Avg test loss: 0.54123, Avg test acc: 0.85910, Avg tpr: 0.98019, Avg fpr: 0.14310, total FA: 19869

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.14415 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.902 | acc=0.8750 | 3787.9 samples/s | 59.2 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02616 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.899 | acc=1.0000 | 4715.0 samples/s | 73.7 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01725 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.900 | acc=0.9844 | 4949.2 samples/s | 77.3 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01461 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.901 | acc=0.9844 | 4909.9 samples/s | 76.7 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01369 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=2.903 | acc=0.9844 | 4923.5 samples/s | 76.9 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01260 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.905 | acc=1.0000 | 4943.0 samples/s | 77.2 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01176 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=2.906 | acc=1.0000 | 4979.7 samples/s | 77.8 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01107 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.908 | acc=1.0000 | 4998.8 samples/s | 78.1 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01065 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=2.910 | acc=0.9844 | 5054.3 samples/s | 79.0 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01020 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.911 | acc=1.0000 | 4882.3 samples/s | 76.3 steps/s
[Step=25300 Epoch=24.7] | Loss=0.00993 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.913 | acc=1.0000 | 4976.2 samples/s | 77.8 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00968 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.914 | acc=0.9844 | 4984.0 samples/s | 77.9 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00972 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=2.916 | acc=0.9844 | 4964.4 samples/s | 77.6 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00971 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.917 | acc=1.0000 | 4943.4 samples/s | 77.2 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00977 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.918 | acc=1.0000 | 5008.2 samples/s | 78.3 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00980 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.919 | acc=1.0000 | 4949.3 samples/s | 77.3 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00977 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.920 | acc=1.0000 | 4998.8 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.03464 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.902 | acc=0.9844 | 3701.8 samples/s | 57.8 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00454 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.906 | acc=1.0000 | 4265.2 samples/s | 66.6 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00229 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.906 | acc=1.0000 | 4687.5 samples/s | 73.2 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00154 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.907 | acc=1.0000 | 4790.2 samples/s | 74.8 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00116 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.907 | acc=1.0000 | 4713.5 samples/s | 73.6 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00093 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.908 | acc=1.0000 | 4702.2 samples/s | 73.5 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00078 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.908 | acc=1.0000 | 4775.7 samples/s | 74.6 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00067 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.908 | acc=1.0000 | 4679.7 samples/s | 73.1 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00059 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.909 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00052 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.909 | acc=1.0000 | 4706.4 samples/s | 73.5 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00047 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.909 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00043 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.910 | acc=1.0000 | 1936.6 samples/s | 30.3 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00039 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.910 | acc=1.0000 | 4921.3 samples/s | 76.9 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00036 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.910 | acc=1.0000 | 4779.4 samples/s | 74.7 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00034 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=2.910 | acc=1.0000 | 4795.0 samples/s | 74.9 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00032 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=2.910 | acc=1.0000 | 4462.7 samples/s | 69.7 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00030 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.911 | acc=1.0000 | 4725.3 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33295 | acc=0.8255 | tpr=0.7479 | fpr=0.0059 | 4372.0 samples/s | 17.1 steps/s
Avg test loss: 0.33418, Avg test acc: 0.82635, Avg tpr: 0.75013, Avg fpr: 0.00602, total FA: 47

Testing server on iccad2012
[Step=  50] | Loss=0.39199 | acc=0.9003 | tpr=0.9779 | fpr=0.1011 | 4420.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.40369 | acc=0.9005 | tpr=0.9808 | fpr=0.1010 | 8611.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.41645 | acc=0.8985 | tpr=0.9813 | fpr=0.1030 | 9167.1 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.41910 | acc=0.8985 | tpr=0.9792 | fpr=0.1030 | 8699.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.41945 | acc=0.8977 | tpr=0.9817 | fpr=0.1038 | 8959.2 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.42076 | acc=0.8978 | tpr=0.9804 | fpr=0.1037 | 8795.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.42358 | acc=0.8977 | tpr=0.9781 | fpr=0.1037 | 8520.9 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.42532 | acc=0.8974 | tpr=0.9770 | fpr=0.1040 | 8599.3 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.42850 | acc=0.8975 | tpr=0.9771 | fpr=0.1040 | 8802.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.42808 | acc=0.8974 | tpr=0.9771 | fpr=0.1040 | 8767.5 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.42600 | acc=0.8978 | tpr=0.9781 | fpr=0.1037 | 15761.9 samples/s | 61.6 steps/s
Avg test loss: 0.42555, Avg test acc: 0.89785, Avg tpr: 0.97821, Avg fpr: 0.10361, total FA: 14386

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.15161 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.925 | acc=0.8906 | 3646.2 samples/s | 57.0 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02964 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.920 | acc=0.9844 | 4882.9 samples/s | 76.3 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01971 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.921 | acc=1.0000 | 5051.9 samples/s | 78.9 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01579 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=2.923 | acc=1.0000 | 5030.8 samples/s | 78.6 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01399 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=2.925 | acc=0.9688 | 4939.8 samples/s | 77.2 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01294 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.927 | acc=0.9844 | 5044.2 samples/s | 78.8 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01227 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.929 | acc=1.0000 | 4888.3 samples/s | 76.4 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01120 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.931 | acc=1.0000 | 4986.4 samples/s | 77.9 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01084 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.932 | acc=0.9844 | 4891.1 samples/s | 76.4 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01058 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=2.934 | acc=1.0000 | 4993.0 samples/s | 78.0 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01032 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.935 | acc=1.0000 | 4906.3 samples/s | 76.7 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01012 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.937 | acc=1.0000 | 4980.9 samples/s | 77.8 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00998 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.938 | acc=0.9844 | 5079.6 samples/s | 79.4 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00993 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.939 | acc=0.9688 | 5103.7 samples/s | 79.7 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00983 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.940 | acc=1.0000 | 5135.6 samples/s | 80.2 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00976 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.942 | acc=1.0000 | 5043.2 samples/s | 78.8 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00972 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=2.943 | acc=0.9844 | 5112.5 samples/s | 79.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.02040 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.925 | acc=0.9844 | 3698.7 samples/s | 57.8 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00371 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.931 | acc=1.0000 | 4457.8 samples/s | 69.7 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00186 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.932 | acc=1.0000 | 4774.3 samples/s | 74.6 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00125 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=2.932 | acc=1.0000 | 4791.3 samples/s | 74.9 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00094 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=2.933 | acc=1.0000 | 4841.3 samples/s | 75.6 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00076 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.933 | acc=1.0000 | 4845.8 samples/s | 75.7 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00063 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.933 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00054 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=2.934 | acc=1.0000 | 4821.3 samples/s | 75.3 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.934 | acc=1.0000 | 4605.6 samples/s | 72.0 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=2.935 | acc=1.0000 | 4734.9 samples/s | 74.0 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00038 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.935 | acc=1.0000 | 4925.6 samples/s | 77.0 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00036 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.935 | acc=1.0000 | 1988.5 samples/s | 31.1 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00033 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.936 | acc=1.0000 | 4893.4 samples/s | 76.5 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00031 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.936 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00028 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.936 | acc=1.0000 | 4663.2 samples/s | 72.9 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00027 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.937 | acc=1.0000 | 4687.0 samples/s | 73.2 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00025 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.937 | acc=1.0000 | 4688.0 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32404 | acc=0.8381 | tpr=0.7664 | fpr=0.0062 | 4399.4 samples/s | 17.2 steps/s
Avg test loss: 0.32484, Avg test acc: 0.83753, Avg tpr: 0.76674, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.45010 | acc=0.8827 | tpr=0.9779 | fpr=0.1191 | 4468.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.46121 | acc=0.8842 | tpr=0.9829 | fpr=0.1176 | 8568.5 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.47489 | acc=0.8821 | tpr=0.9813 | fpr=0.1197 | 9044.2 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.47753 | acc=0.8825 | tpr=0.9792 | fpr=0.1193 | 8280.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.47740 | acc=0.8824 | tpr=0.9817 | fpr=0.1194 | 8734.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.47907 | acc=0.8827 | tpr=0.9804 | fpr=0.1191 | 9071.4 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.48242 | acc=0.8823 | tpr=0.9787 | fpr=0.1195 | 8451.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.48383 | acc=0.8820 | tpr=0.9776 | fpr=0.1198 | 9245.7 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.48697 | acc=0.8820 | tpr=0.9781 | fpr=0.1197 | 8641.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.48641 | acc=0.8819 | tpr=0.9780 | fpr=0.1198 | 8154.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.48381 | acc=0.8822 | tpr=0.9785 | fpr=0.1196 | 15712.2 samples/s | 61.4 steps/s
Avg test loss: 0.48340, Avg test acc: 0.88220, Avg tpr: 0.97861, Avg fpr: 0.11955, total FA: 16599

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.15184 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.951 | acc=0.9219 | 3894.9 samples/s | 60.9 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02719 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.946 | acc=0.9844 | 4716.0 samples/s | 73.7 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01758 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.947 | acc=0.9688 | 4938.0 samples/s | 77.2 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01431 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=2.949 | acc=1.0000 | 4887.6 samples/s | 76.4 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01280 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=2.950 | acc=1.0000 | 4916.0 samples/s | 76.8 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01220 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.952 | acc=1.0000 | 4918.9 samples/s | 76.9 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01140 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=2.953 | acc=1.0000 | 4966.9 samples/s | 77.6 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01090 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=2.954 | acc=0.9844 | 4936.1 samples/s | 77.1 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01079 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=2.956 | acc=0.9844 | 4919.1 samples/s | 76.9 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01058 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.957 | acc=1.0000 | 4917.0 samples/s | 76.8 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01016 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.958 | acc=1.0000 | 5019.5 samples/s | 78.4 steps/s
[Step=26950 Epoch=26.3] | Loss=0.01011 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.959 | acc=0.9844 | 4972.9 samples/s | 77.7 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00993 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.961 | acc=0.9844 | 4980.1 samples/s | 77.8 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00967 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.962 | acc=0.9844 | 4999.6 samples/s | 78.1 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00959 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.963 | acc=0.9688 | 4960.8 samples/s | 77.5 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00964 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=2.964 | acc=0.9844 | 4993.0 samples/s | 78.0 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00952 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=2.965 | acc=1.0000 | 4988.3 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.05923 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.951 | acc=0.9844 | 3771.7 samples/s | 58.9 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00569 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.954 | acc=1.0000 | 4348.9 samples/s | 68.0 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00285 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=2.954 | acc=1.0000 | 4643.9 samples/s | 72.6 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00190 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.954 | acc=1.0000 | 4734.6 samples/s | 74.0 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00143 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=2.954 | acc=1.0000 | 4671.0 samples/s | 73.0 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00114 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.955 | acc=1.0000 | 4738.8 samples/s | 74.0 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00095 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.955 | acc=1.0000 | 4726.6 samples/s | 73.9 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00082 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.955 | acc=1.0000 | 4660.7 samples/s | 72.8 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00072 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.955 | acc=1.0000 | 4786.2 samples/s | 74.8 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00064 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.955 | acc=1.0000 | 4595.3 samples/s | 71.8 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00057 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.955 | acc=1.0000 | 4762.5 samples/s | 74.4 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00052 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.955 | acc=1.0000 | 1980.3 samples/s | 30.9 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.955 | acc=1.0000 | 4656.9 samples/s | 72.8 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00044 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.956 | acc=1.0000 | 4691.5 samples/s | 73.3 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00041 | Reg=0.00202 | L2-Norm=14.195 | L2-Norm(final)=2.956 | acc=1.0000 | 4738.1 samples/s | 74.0 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00038 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.956 | acc=1.0000 | 4607.1 samples/s | 72.0 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00036 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.956 | acc=1.0000 | 4668.6 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29683 | acc=0.8443 | tpr=0.7752 | fpr=0.0057 | 4429.6 samples/s | 17.3 steps/s
Avg test loss: 0.29818, Avg test acc: 0.84402, Avg tpr: 0.77589, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.44052 | acc=0.8822 | tpr=0.9779 | fpr=0.1195 | 4427.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.45104 | acc=0.8833 | tpr=0.9808 | fpr=0.1185 | 9170.4 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.46331 | acc=0.8814 | tpr=0.9798 | fpr=0.1204 | 8252.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.46569 | acc=0.8812 | tpr=0.9781 | fpr=0.1205 | 8830.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.46577 | acc=0.8812 | tpr=0.9808 | fpr=0.1206 | 8844.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.46718 | acc=0.8814 | tpr=0.9796 | fpr=0.1204 | 8948.9 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.47023 | acc=0.8809 | tpr=0.9781 | fpr=0.1208 | 8450.8 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.47175 | acc=0.8805 | tpr=0.9765 | fpr=0.1213 | 8931.3 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.47482 | acc=0.8804 | tpr=0.9761 | fpr=0.1213 | 8397.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.47436 | acc=0.8805 | tpr=0.9762 | fpr=0.1213 | 8710.6 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.47190 | acc=0.8808 | tpr=0.9769 | fpr=0.1209 | 15470.2 samples/s | 60.4 steps/s
Avg test loss: 0.47161, Avg test acc: 0.88085, Avg tpr: 0.97662, Avg fpr: 0.12089, total FA: 16785

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.11721 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=2.967 | acc=0.8906 | 3812.0 samples/s | 59.6 steps/s
[Step=27250 Epoch=26.6] | Loss=0.03034 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.961 | acc=0.9844 | 4555.8 samples/s | 71.2 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01936 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.961 | acc=1.0000 | 4994.6 samples/s | 78.0 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01580 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.963 | acc=1.0000 | 5062.6 samples/s | 79.1 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01383 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.965 | acc=1.0000 | 5072.4 samples/s | 79.3 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01270 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.967 | acc=1.0000 | 5081.2 samples/s | 79.4 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01197 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.968 | acc=1.0000 | 5129.2 samples/s | 80.1 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01161 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.970 | acc=1.0000 | 5061.1 samples/s | 79.1 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01083 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=2.971 | acc=1.0000 | 5059.6 samples/s | 79.1 steps/s
[Step=27650 Epoch=27.0] | Loss=0.01074 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.972 | acc=1.0000 | 5009.6 samples/s | 78.3 steps/s
[Step=27700 Epoch=27.0] | Loss=0.01055 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.974 | acc=1.0000 | 5071.2 samples/s | 79.2 steps/s
[Step=27750 Epoch=27.1] | Loss=0.01046 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.975 | acc=1.0000 | 4915.5 samples/s | 76.8 steps/s
[Step=27800 Epoch=27.1] | Loss=0.01017 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.976 | acc=0.9844 | 4974.9 samples/s | 77.7 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00996 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.977 | acc=1.0000 | 4928.9 samples/s | 77.0 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00985 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.978 | acc=1.0000 | 4967.2 samples/s | 77.6 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00983 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.980 | acc=1.0000 | 5004.2 samples/s | 78.2 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00967 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.981 | acc=0.9844 | 4938.1 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.11834 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=2.967 | acc=0.9688 | 3854.2 samples/s | 60.2 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00471 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.973 | acc=1.0000 | 4652.4 samples/s | 72.7 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00256 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.974 | acc=1.0000 | 4738.1 samples/s | 74.0 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00171 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.975 | acc=1.0000 | 4737.9 samples/s | 74.0 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00129 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.975 | acc=1.0000 | 4816.4 samples/s | 75.3 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00103 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=2.976 | acc=1.0000 | 4690.5 samples/s | 73.3 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00086 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.976 | acc=1.0000 | 4631.7 samples/s | 72.4 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=2.976 | acc=1.0000 | 4650.2 samples/s | 72.7 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00065 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.976 | acc=1.0000 | 4653.6 samples/s | 72.7 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00058 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.977 | acc=1.0000 | 4723.8 samples/s | 73.8 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00052 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=2.977 | acc=1.0000 | 4735.7 samples/s | 74.0 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00047 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.977 | acc=1.0000 | 1942.7 samples/s | 30.4 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00043 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=2.977 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.977 | acc=1.0000 | 4814.1 samples/s | 75.2 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00037 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.977 | acc=1.0000 | 4793.7 samples/s | 74.9 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00035 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.978 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00033 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=2.978 | acc=1.0000 | 4854.0 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30419 | acc=0.8416 | tpr=0.7715 | fpr=0.0059 | 4370.7 samples/s | 17.1 steps/s
Avg test loss: 0.30424, Avg test acc: 0.84225, Avg tpr: 0.77339, Avg fpr: 0.00628, total FA: 49

Testing server on iccad2012
[Step=  50] | Loss=0.43578 | acc=0.8859 | tpr=0.9779 | fpr=0.1158 | 4437.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.44371 | acc=0.8874 | tpr=0.9808 | fpr=0.1143 | 8665.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.45483 | acc=0.8858 | tpr=0.9798 | fpr=0.1160 | 8775.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.45757 | acc=0.8859 | tpr=0.9781 | fpr=0.1157 | 8684.0 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.45782 | acc=0.8855 | tpr=0.9808 | fpr=0.1162 | 8847.9 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.46007 | acc=0.8854 | tpr=0.9796 | fpr=0.1164 | 8690.8 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.46297 | acc=0.8849 | tpr=0.9781 | fpr=0.1168 | 8775.3 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.46417 | acc=0.8846 | tpr=0.9770 | fpr=0.1170 | 8485.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.46731 | acc=0.8846 | tpr=0.9771 | fpr=0.1171 | 8886.0 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.46682 | acc=0.8847 | tpr=0.9767 | fpr=0.1170 | 8963.6 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.46398 | acc=0.8849 | tpr=0.9765 | fpr=0.1167 | 14782.5 samples/s | 57.7 steps/s
Avg test loss: 0.46375, Avg test acc: 0.88491, Avg tpr: 0.97662, Avg fpr: 0.11675, total FA: 16211

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.18267 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.987 | acc=0.8750 | 3686.2 samples/s | 57.6 steps/s
[Step=28050 Epoch=27.4] | Loss=0.02251 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=2.986 | acc=1.0000 | 4904.6 samples/s | 76.6 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01503 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.987 | acc=0.9844 | 5066.2 samples/s | 79.2 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01279 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.989 | acc=1.0000 | 5048.2 samples/s | 78.9 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01127 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=2.990 | acc=1.0000 | 5018.1 samples/s | 78.4 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01084 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.992 | acc=1.0000 | 5059.5 samples/s | 79.1 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01011 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=2.993 | acc=0.9844 | 5032.4 samples/s | 78.6 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00980 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=2.995 | acc=0.9688 | 5037.9 samples/s | 78.7 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00966 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.996 | acc=0.9844 | 4951.3 samples/s | 77.4 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00954 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.997 | acc=0.9844 | 4950.1 samples/s | 77.3 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00949 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=2.998 | acc=1.0000 | 5035.9 samples/s | 78.7 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00959 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=2.999 | acc=1.0000 | 4870.0 samples/s | 76.1 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00943 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.000 | acc=1.0000 | 4946.3 samples/s | 77.3 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00925 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=3.001 | acc=1.0000 | 4981.4 samples/s | 77.8 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00908 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.002 | acc=1.0000 | 4978.5 samples/s | 77.8 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00912 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.003 | acc=0.9844 | 4989.6 samples/s | 78.0 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00903 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.004 | acc=0.9688 | 4943.8 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.18197 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.987 | acc=0.9688 | 3396.1 samples/s | 53.1 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00787 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.987 | acc=1.0000 | 4667.2 samples/s | 72.9 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00395 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.987 | acc=1.0000 | 4636.9 samples/s | 72.5 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00264 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.988 | acc=1.0000 | 4752.8 samples/s | 74.3 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00199 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=2.988 | acc=1.0000 | 4814.6 samples/s | 75.2 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00160 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=2.989 | acc=1.0000 | 4776.1 samples/s | 74.6 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00134 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.990 | acc=1.0000 | 4829.2 samples/s | 75.5 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00115 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=2.990 | acc=1.0000 | 4780.3 samples/s | 74.7 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00101 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=2.991 | acc=1.0000 | 4808.2 samples/s | 75.1 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00090 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.991 | acc=1.0000 | 4741.0 samples/s | 74.1 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00081 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.992 | acc=1.0000 | 4787.0 samples/s | 74.8 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.993 | acc=1.0000 | 1955.6 samples/s | 30.6 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00068 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.993 | acc=1.0000 | 4657.5 samples/s | 72.8 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00063 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.993 | acc=1.0000 | 4791.5 samples/s | 74.9 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00058 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.994 | acc=1.0000 | 4774.3 samples/s | 74.6 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00054 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.994 | acc=1.0000 | 4830.9 samples/s | 75.5 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00051 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.995 | acc=1.0000 | 4779.2 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26608 | acc=0.8562 | tpr=0.7932 | fpr=0.0069 | 4375.0 samples/s | 17.1 steps/s
Avg test loss: 0.26783, Avg test acc: 0.85708, Avg tpr: 0.79542, Avg fpr: 0.00731, total FA: 57

Testing server on iccad2012
[Step=  50] | Loss=0.40980 | acc=0.8936 | tpr=0.9779 | fpr=0.1079 | 4380.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.42091 | acc=0.8944 | tpr=0.9808 | fpr=0.1072 | 9251.5 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.43118 | acc=0.8926 | tpr=0.9798 | fpr=0.1090 | 8371.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.43375 | acc=0.8926 | tpr=0.9781 | fpr=0.1090 | 8527.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.43400 | acc=0.8923 | tpr=0.9808 | fpr=0.1093 | 9094.0 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.43598 | acc=0.8925 | tpr=0.9796 | fpr=0.1091 | 8863.1 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.43922 | acc=0.8923 | tpr=0.9775 | fpr=0.1093 | 8315.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.44069 | acc=0.8921 | tpr=0.9754 | fpr=0.1094 | 9380.0 samples/s | 36.6 steps/s
[Step= 450] | Loss=0.44393 | acc=0.8920 | tpr=0.9761 | fpr=0.1095 | 8109.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.44353 | acc=0.8920 | tpr=0.9762 | fpr=0.1095 | 9334.7 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.44099 | acc=0.8924 | tpr=0.9761 | fpr=0.1091 | 14195.2 samples/s | 55.4 steps/s
Avg test loss: 0.44067, Avg test acc: 0.89246, Avg tpr: 0.97623, Avg fpr: 0.10906, total FA: 15143

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.07453 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=3.008 | acc=0.9531 | 3731.6 samples/s | 58.3 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02182 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.004 | acc=1.0000 | 4826.9 samples/s | 75.4 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01473 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.005 | acc=1.0000 | 5004.3 samples/s | 78.2 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01227 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=3.007 | acc=1.0000 | 5014.9 samples/s | 78.4 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01116 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.009 | acc=1.0000 | 4901.4 samples/s | 76.6 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01029 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.011 | acc=1.0000 | 4961.5 samples/s | 77.5 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00963 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.013 | acc=1.0000 | 4974.7 samples/s | 77.7 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00959 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.015 | acc=0.9688 | 4979.3 samples/s | 77.8 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00939 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.016 | acc=1.0000 | 5032.0 samples/s | 78.6 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00907 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.018 | acc=0.9844 | 4943.6 samples/s | 77.2 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00902 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.019 | acc=0.9844 | 5005.7 samples/s | 78.2 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00887 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.021 | acc=1.0000 | 5036.2 samples/s | 78.7 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00875 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.022 | acc=1.0000 | 4953.7 samples/s | 77.4 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00876 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.023 | acc=1.0000 | 5014.8 samples/s | 78.4 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00877 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.024 | acc=1.0000 | 4943.4 samples/s | 77.2 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00869 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.025 | acc=1.0000 | 4971.1 samples/s | 77.7 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00864 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.026 | acc=0.9844 | 4961.3 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.03157 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=3.009 | acc=0.9844 | 3809.7 samples/s | 59.5 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00512 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.016 | acc=1.0000 | 4345.9 samples/s | 67.9 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00258 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.017 | acc=1.0000 | 4829.4 samples/s | 75.5 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00172 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.017 | acc=1.0000 | 4799.2 samples/s | 75.0 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00130 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.018 | acc=1.0000 | 4714.4 samples/s | 73.7 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00104 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.018 | acc=1.0000 | 4764.6 samples/s | 74.4 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00087 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.018 | acc=1.0000 | 4669.9 samples/s | 73.0 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00075 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.019 | acc=1.0000 | 4830.1 samples/s | 75.5 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00065 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.019 | acc=1.0000 | 4845.0 samples/s | 75.7 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00058 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.019 | acc=1.0000 | 4817.9 samples/s | 75.3 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00053 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.019 | acc=1.0000 | 4916.0 samples/s | 76.8 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00048 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.020 | acc=1.0000 | 1976.7 samples/s | 30.9 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00044 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=3.020 | acc=1.0000 | 4778.8 samples/s | 74.7 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00041 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.020 | acc=1.0000 | 4665.9 samples/s | 72.9 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00038 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=3.020 | acc=1.0000 | 4591.6 samples/s | 71.7 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00035 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.021 | acc=1.0000 | 4670.6 samples/s | 73.0 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00033 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=3.021 | acc=1.0000 | 4737.6 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27986 | acc=0.8534 | tpr=0.7890 | fpr=0.0067 | 4383.8 samples/s | 17.1 steps/s
Avg test loss: 0.28347, Avg test acc: 0.85319, Avg tpr: 0.78965, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.41744 | acc=0.8949 | tpr=0.9735 | fpr=0.1065 | 4407.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.42907 | acc=0.8964 | tpr=0.9808 | fpr=0.1052 | 9004.2 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.43959 | acc=0.8946 | tpr=0.9798 | fpr=0.1070 | 8770.5 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.44242 | acc=0.8950 | tpr=0.9781 | fpr=0.1065 | 8378.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.44244 | acc=0.8947 | tpr=0.9808 | fpr=0.1068 | 8799.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.44416 | acc=0.8947 | tpr=0.9796 | fpr=0.1068 | 8766.2 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.44696 | acc=0.8947 | tpr=0.9781 | fpr=0.1068 | 9181.9 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.44895 | acc=0.8945 | tpr=0.9770 | fpr=0.1070 | 8228.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.45233 | acc=0.8943 | tpr=0.9771 | fpr=0.1072 | 8477.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.45197 | acc=0.8943 | tpr=0.9771 | fpr=0.1072 | 8709.6 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.44956 | acc=0.8948 | tpr=0.9773 | fpr=0.1067 | 15980.5 samples/s | 62.4 steps/s
Avg test loss: 0.44917, Avg test acc: 0.89482, Avg tpr: 0.97742, Avg fpr: 0.10669, total FA: 14813

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.17459 | Reg=0.00200 | L2-Norm=14.129 | L2-Norm(final)=3.033 | acc=0.8438 | 3710.1 samples/s | 58.0 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02293 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.028 | acc=1.0000 | 4911.8 samples/s | 76.7 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01532 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=3.029 | acc=1.0000 | 5070.9 samples/s | 79.2 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01285 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.030 | acc=1.0000 | 4850.8 samples/s | 75.8 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01107 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=3.032 | acc=1.0000 | 4951.7 samples/s | 77.4 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01041 | Reg=0.00200 | L2-Norm=14.160 | L2-Norm(final)=3.034 | acc=0.9844 | 4978.1 samples/s | 77.8 steps/s
[Step=29900 Epoch=29.2] | Loss=0.00970 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.036 | acc=1.0000 | 4975.4 samples/s | 77.7 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00934 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.037 | acc=1.0000 | 4932.3 samples/s | 77.1 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00914 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.038 | acc=1.0000 | 4997.6 samples/s | 78.1 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00898 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=3.039 | acc=1.0000 | 4914.5 samples/s | 76.8 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00900 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.040 | acc=0.9844 | 4981.8 samples/s | 77.8 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00880 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=3.041 | acc=1.0000 | 5047.0 samples/s | 78.9 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00878 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=3.043 | acc=0.9844 | 4933.1 samples/s | 77.1 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00856 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.044 | acc=1.0000 | 4998.6 samples/s | 78.1 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00833 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.045 | acc=0.9844 | 4986.4 samples/s | 77.9 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00841 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.046 | acc=0.9844 | 4982.6 samples/s | 77.9 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00848 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.048 | acc=0.9844 | 4927.9 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.00328 | Reg=0.00200 | L2-Norm=14.129 | L2-Norm(final)=3.033 | acc=1.0000 | 3463.7 samples/s | 54.1 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00204 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=3.044 | acc=1.0000 | 4863.4 samples/s | 76.0 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00102 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.045 | acc=1.0000 | 4726.1 samples/s | 73.8 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00068 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.046 | acc=1.0000 | 4782.9 samples/s | 74.7 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00051 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.046 | acc=1.0000 | 4791.2 samples/s | 74.9 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00041 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=3.046 | acc=1.0000 | 4604.6 samples/s | 71.9 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00035 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.046 | acc=1.0000 | 4747.3 samples/s | 74.2 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00030 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=3.046 | acc=1.0000 | 4771.7 samples/s | 74.6 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00026 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=3.047 | acc=1.0000 | 4709.5 samples/s | 73.6 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00023 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.047 | acc=1.0000 | 4701.6 samples/s | 73.5 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00021 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.047 | acc=1.0000 | 4774.2 samples/s | 74.6 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00019 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=3.047 | acc=1.0000 | 1943.7 samples/s | 30.4 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00017 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.047 | acc=1.0000 | 4870.4 samples/s | 76.1 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00016 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=3.047 | acc=1.0000 | 4814.0 samples/s | 75.2 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00015 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=3.047 | acc=1.0000 | 4887.0 samples/s | 76.4 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00014 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=3.047 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00013 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=3.047 | acc=1.0000 | 4852.6 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29134 | acc=0.8513 | tpr=0.7858 | fpr=0.0064 | 4432.7 samples/s | 17.3 steps/s
Avg test loss: 0.29651, Avg test acc: 0.85187, Avg tpr: 0.78732, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.46605 | acc=0.8823 | tpr=0.9779 | fpr=0.1195 | 4420.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.47602 | acc=0.8854 | tpr=0.9829 | fpr=0.1164 | 8561.0 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.48818 | acc=0.8827 | tpr=0.9813 | fpr=0.1191 | 8824.9 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.49097 | acc=0.8830 | tpr=0.9792 | fpr=0.1187 | 8654.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.49123 | acc=0.8829 | tpr=0.9817 | fpr=0.1189 | 8609.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.49286 | acc=0.8829 | tpr=0.9804 | fpr=0.1189 | 8652.3 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.49595 | acc=0.8826 | tpr=0.9787 | fpr=0.1191 | 8914.5 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.49802 | acc=0.8824 | tpr=0.9770 | fpr=0.1193 | 8893.7 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.50148 | acc=0.8823 | tpr=0.9766 | fpr=0.1194 | 8742.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.50071 | acc=0.8825 | tpr=0.9771 | fpr=0.1192 | 8525.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.49784 | acc=0.8830 | tpr=0.9769 | fpr=0.1187 | 16073.7 samples/s | 62.8 steps/s
Avg test loss: 0.49750, Avg test acc: 0.88302, Avg tpr: 0.97702, Avg fpr: 0.11868, total FA: 16479

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.20951 | Reg=0.00199 | L2-Norm=14.116 | L2-Norm(final)=3.056 | acc=0.8906 | 3830.9 samples/s | 59.9 steps/s
[Step=30450 Epoch=29.7] | Loss=0.02151 | Reg=0.00200 | L2-Norm=14.133 | L2-Norm(final)=3.051 | acc=0.9844 | 4787.6 samples/s | 74.8 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01473 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=3.051 | acc=0.9844 | 4959.5 samples/s | 77.5 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01200 | Reg=0.00200 | L2-Norm=14.139 | L2-Norm(final)=3.053 | acc=1.0000 | 5013.2 samples/s | 78.3 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01067 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=3.054 | acc=1.0000 | 4957.7 samples/s | 77.5 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01021 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=3.055 | acc=1.0000 | 5101.5 samples/s | 79.7 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00978 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=3.057 | acc=0.9844 | 5063.9 samples/s | 79.1 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00955 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=3.058 | acc=0.9844 | 5076.4 samples/s | 79.3 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00921 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.059 | acc=1.0000 | 4880.3 samples/s | 76.3 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00917 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=3.060 | acc=1.0000 | 4891.0 samples/s | 76.4 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00903 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=3.062 | acc=0.9844 | 4925.4 samples/s | 77.0 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00893 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=3.063 | acc=1.0000 | 4948.7 samples/s | 77.3 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00890 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.064 | acc=0.9844 | 5094.1 samples/s | 79.6 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00880 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.065 | acc=1.0000 | 5081.2 samples/s | 79.4 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00875 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=3.066 | acc=0.9844 | 5072.5 samples/s | 79.3 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00873 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.067 | acc=0.9844 | 5170.9 samples/s | 80.8 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00877 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.068 | acc=1.0000 | 5008.8 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.01374 | Reg=0.00199 | L2-Norm=14.116 | L2-Norm(final)=3.057 | acc=0.9844 | 3676.1 samples/s | 57.4 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00298 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.065 | acc=1.0000 | 4579.0 samples/s | 71.5 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00149 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.066 | acc=1.0000 | 4797.9 samples/s | 75.0 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00102 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=3.067 | acc=1.0000 | 4671.8 samples/s | 73.0 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00077 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=3.068 | acc=1.0000 | 4651.0 samples/s | 72.7 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00061 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.068 | acc=1.0000 | 4673.4 samples/s | 73.0 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00051 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=3.068 | acc=1.0000 | 4747.1 samples/s | 74.2 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00044 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=3.069 | acc=1.0000 | 4746.2 samples/s | 74.2 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00039 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=3.069 | acc=1.0000 | 4635.6 samples/s | 72.4 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00034 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.069 | acc=1.0000 | 4624.6 samples/s | 72.3 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00031 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=3.069 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00028 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=3.069 | acc=1.0000 | 1976.0 samples/s | 30.9 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00026 | Reg=0.00200 | L2-Norm=14.139 | L2-Norm(final)=3.069 | acc=1.0000 | 4844.6 samples/s | 75.7 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00024 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=3.069 | acc=1.0000 | 4810.5 samples/s | 75.2 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00022 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=3.069 | acc=1.0000 | 4888.4 samples/s | 76.4 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00021 | Reg=0.00200 | L2-Norm=14.133 | L2-Norm(final)=3.070 | acc=1.0000 | 4743.1 samples/s | 74.1 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00019 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=3.070 | acc=1.0000 | 4795.2 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27746 | acc=0.8539 | tpr=0.7896 | fpr=0.0064 | 4454.5 samples/s | 17.4 steps/s
Avg test loss: 0.28236, Avg test acc: 0.85291, Avg tpr: 0.78907, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.44655 | acc=0.8915 | tpr=0.9779 | fpr=0.1101 | 4385.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.45661 | acc=0.8935 | tpr=0.9851 | fpr=0.1082 | 8792.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.46809 | acc=0.8909 | tpr=0.9827 | fpr=0.1108 | 9114.8 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.47038 | acc=0.8917 | tpr=0.9803 | fpr=0.1099 | 8358.6 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.47113 | acc=0.8908 | tpr=0.9825 | fpr=0.1108 | 8663.9 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.47291 | acc=0.8910 | tpr=0.9811 | fpr=0.1107 | 9263.7 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.47574 | acc=0.8907 | tpr=0.9793 | fpr=0.1109 | 8471.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.47766 | acc=0.8904 | tpr=0.9781 | fpr=0.1112 | 8503.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.48115 | acc=0.8902 | tpr=0.9781 | fpr=0.1114 | 9431.2 samples/s | 36.8 steps/s
[Step= 500] | Loss=0.48022 | acc=0.8903 | tpr=0.9771 | fpr=0.1113 | 8128.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.47776 | acc=0.8905 | tpr=0.9777 | fpr=0.1110 | 16355.4 samples/s | 63.9 steps/s
Avg test loss: 0.47736, Avg test acc: 0.89055, Avg tpr: 0.97781, Avg fpr: 0.11104, total FA: 15417

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.12058 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=3.075 | acc=0.9219 | 4063.3 samples/s | 63.5 steps/s
[Step=31250 Epoch=30.5] | Loss=0.01990 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=3.072 | acc=1.0000 | 4384.0 samples/s | 68.5 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01466 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=3.073 | acc=0.9844 | 4926.6 samples/s | 77.0 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01217 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=3.074 | acc=1.0000 | 4759.5 samples/s | 74.4 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01070 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=3.075 | acc=0.9844 | 4892.9 samples/s | 76.5 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00971 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=3.077 | acc=1.0000 | 5055.3 samples/s | 79.0 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00902 | Reg=0.00200 | L2-Norm=14.139 | L2-Norm(final)=3.079 | acc=0.9844 | 5215.5 samples/s | 81.5 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00893 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=3.080 | acc=0.9688 | 5005.6 samples/s | 78.2 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00884 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=3.082 | acc=1.0000 | 5090.3 samples/s | 79.5 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00876 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=3.083 | acc=1.0000 | 5014.6 samples/s | 78.4 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00883 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=3.085 | acc=1.0000 | 5067.6 samples/s | 79.2 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00865 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=3.086 | acc=1.0000 | 5106.3 samples/s | 79.8 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00869 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=3.087 | acc=0.9844 | 5098.5 samples/s | 79.7 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00875 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=3.088 | acc=0.9844 | 5144.9 samples/s | 80.4 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00862 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=3.089 | acc=1.0000 | 5131.1 samples/s | 80.2 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00859 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.091 | acc=1.0000 | 5067.0 samples/s | 79.2 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00862 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.092 | acc=0.9531 | 5032.1 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.02450 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=3.076 | acc=0.9844 | 3922.6 samples/s | 61.3 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00162 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=3.081 | acc=1.0000 | 4435.1 samples/s | 69.3 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00081 | Reg=0.00200 | L2-Norm=14.126 | L2-Norm(final)=3.082 | acc=1.0000 | 4822.1 samples/s | 75.3 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00055 | Reg=0.00200 | L2-Norm=14.126 | L2-Norm(final)=3.082 | acc=1.0000 | 4842.7 samples/s | 75.7 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00041 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=3.083 | acc=1.0000 | 4884.0 samples/s | 76.3 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00033 | Reg=0.00199 | L2-Norm=14.122 | L2-Norm(final)=3.083 | acc=1.0000 | 4754.1 samples/s | 74.3 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00028 | Reg=0.00199 | L2-Norm=14.121 | L2-Norm(final)=3.083 | acc=1.0000 | 4843.3 samples/s | 75.7 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00024 | Reg=0.00199 | L2-Norm=14.119 | L2-Norm(final)=3.084 | acc=1.0000 | 4801.1 samples/s | 75.0 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00021 | Reg=0.00199 | L2-Norm=14.117 | L2-Norm(final)=3.084 | acc=1.0000 | 4757.8 samples/s | 74.3 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00019 | Reg=0.00199 | L2-Norm=14.115 | L2-Norm(final)=3.084 | acc=1.0000 | 4805.6 samples/s | 75.1 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00017 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=3.085 | acc=1.0000 | 4835.3 samples/s | 75.6 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00016 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=3.085 | acc=1.0000 | 1979.8 samples/s | 30.9 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00014 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=3.085 | acc=1.0000 | 4793.4 samples/s | 74.9 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00013 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=3.085 | acc=1.0000 | 4680.9 samples/s | 73.1 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00012 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.086 | acc=1.0000 | 4691.9 samples/s | 73.3 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00012 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.086 | acc=1.0000 | 4729.8 samples/s | 73.9 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00011 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=3.086 | acc=1.0000 | 4646.5 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21131 | acc=0.8881 | tpr=0.8404 | fpr=0.0082 | 4422.3 samples/s | 17.3 steps/s
Avg test loss: 0.21475, Avg test acc: 0.88773, Avg tpr: 0.84094, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.51106 | acc=0.8698 | tpr=0.9779 | fpr=0.1322 | 4439.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.52050 | acc=0.8720 | tpr=0.9829 | fpr=0.1301 | 9012.0 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.53210 | acc=0.8700 | tpr=0.9813 | fpr=0.1321 | 9005.7 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.53519 | acc=0.8708 | tpr=0.9792 | fpr=0.1312 | 8232.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.53579 | acc=0.8708 | tpr=0.9817 | fpr=0.1313 | 8833.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.53742 | acc=0.8708 | tpr=0.9804 | fpr=0.1312 | 8734.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.54060 | acc=0.8706 | tpr=0.9781 | fpr=0.1314 | 8727.2 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.54240 | acc=0.8703 | tpr=0.9770 | fpr=0.1316 | 8793.6 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.54568 | acc=0.8704 | tpr=0.9781 | fpr=0.1315 | 8893.8 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.54506 | acc=0.8704 | tpr=0.9780 | fpr=0.1316 | 8563.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.54224 | acc=0.8708 | tpr=0.9785 | fpr=0.1312 | 15851.0 samples/s | 61.9 steps/s
Avg test loss: 0.54189, Avg test acc: 0.87079, Avg tpr: 0.97861, Avg fpr: 0.13117, total FA: 18212

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.18156 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.099 | acc=0.8906 | 3759.0 samples/s | 58.7 steps/s
[Step=32050 Epoch=31.3] | Loss=0.01798 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.099 | acc=1.0000 | 4876.8 samples/s | 76.2 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01223 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=3.100 | acc=1.0000 | 5048.2 samples/s | 78.9 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01010 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.101 | acc=1.0000 | 5021.4 samples/s | 78.5 steps/s
[Step=32200 Epoch=31.4] | Loss=0.00918 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=3.102 | acc=0.9844 | 5036.7 samples/s | 78.7 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00858 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.104 | acc=1.0000 | 5083.7 samples/s | 79.4 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00845 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.105 | acc=0.9844 | 5043.2 samples/s | 78.8 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00829 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.106 | acc=0.9844 | 5131.6 samples/s | 80.2 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00809 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.107 | acc=1.0000 | 5090.4 samples/s | 79.5 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00762 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.108 | acc=0.9688 | 5052.4 samples/s | 78.9 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00746 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.108 | acc=1.0000 | 5046.9 samples/s | 78.9 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00745 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.109 | acc=1.0000 | 5033.6 samples/s | 78.6 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00712 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.110 | acc=1.0000 | 4999.4 samples/s | 78.1 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00707 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.111 | acc=1.0000 | 4940.6 samples/s | 77.2 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00713 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.112 | acc=1.0000 | 4971.1 samples/s | 77.7 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00705 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.112 | acc=1.0000 | 4950.8 samples/s | 77.4 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00689 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=3.113 | acc=1.0000 | 5031.7 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.05033 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.099 | acc=0.9688 | 3470.1 samples/s | 54.2 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00543 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.102 | acc=1.0000 | 4781.7 samples/s | 74.7 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00272 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.103 | acc=1.0000 | 4713.5 samples/s | 73.6 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00182 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=3.104 | acc=1.0000 | 4501.1 samples/s | 70.3 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00137 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.104 | acc=1.0000 | 4630.8 samples/s | 72.4 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00110 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=3.104 | acc=1.0000 | 4802.9 samples/s | 75.0 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00092 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.104 | acc=1.0000 | 4849.3 samples/s | 75.8 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00079 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.104 | acc=1.0000 | 4782.7 samples/s | 74.7 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00070 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.105 | acc=1.0000 | 4757.2 samples/s | 74.3 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00062 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.105 | acc=1.0000 | 4679.6 samples/s | 73.1 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00056 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.105 | acc=1.0000 | 4726.2 samples/s | 73.8 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00051 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=3.105 | acc=1.0000 | 1964.1 samples/s | 30.7 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00047 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.105 | acc=1.0000 | 4762.3 samples/s | 74.4 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00043 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.106 | acc=1.0000 | 4724.4 samples/s | 73.8 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00040 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=3.106 | acc=1.0000 | 4723.5 samples/s | 73.8 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00038 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=3.106 | acc=1.0000 | 4718.7 samples/s | 73.7 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00035 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.106 | acc=1.0000 | 4771.2 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28577 | acc=0.8591 | tpr=0.7970 | fpr=0.0062 | 4447.3 samples/s | 17.4 steps/s
Avg test loss: 0.28810, Avg test acc: 0.85860, Avg tpr: 0.79734, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.44473 | acc=0.8938 | tpr=0.9779 | fpr=0.1078 | 4278.3 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.45594 | acc=0.8962 | tpr=0.9808 | fpr=0.1054 | 8652.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.46711 | acc=0.8943 | tpr=0.9798 | fpr=0.1073 | 7517.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.47031 | acc=0.8947 | tpr=0.9781 | fpr=0.1068 | 6921.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.47084 | acc=0.8946 | tpr=0.9808 | fpr=0.1070 | 6918.4 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.47260 | acc=0.8947 | tpr=0.9796 | fpr=0.1068 | 7016.2 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.47570 | acc=0.8944 | tpr=0.9775 | fpr=0.1071 | 7940.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.47732 | acc=0.8941 | tpr=0.9759 | fpr=0.1074 | 8898.7 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.48073 | acc=0.8938 | tpr=0.9757 | fpr=0.1077 | 8514.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.48011 | acc=0.8937 | tpr=0.9753 | fpr=0.1078 | 8476.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.47738 | acc=0.8940 | tpr=0.9757 | fpr=0.1075 | 15789.1 samples/s | 61.7 steps/s
Avg test loss: 0.47700, Avg test acc: 0.89402, Avg tpr: 0.97583, Avg fpr: 0.10746, total FA: 14921

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.19173 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=3.116 | acc=0.8750 | 4037.9 samples/s | 63.1 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02781 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=3.113 | acc=0.9844 | 4570.9 samples/s | 71.4 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01687 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.113 | acc=0.9844 | 4952.3 samples/s | 77.4 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01344 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=3.114 | acc=1.0000 | 5039.3 samples/s | 78.7 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01192 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.114 | acc=1.0000 | 5013.4 samples/s | 78.3 steps/s
[Step=33050 Epoch=32.3] | Loss=0.01037 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=3.115 | acc=1.0000 | 5038.6 samples/s | 78.7 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00973 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=3.116 | acc=1.0000 | 4934.7 samples/s | 77.1 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00927 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.117 | acc=0.9844 | 4972.6 samples/s | 77.7 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00893 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.118 | acc=0.9688 | 4957.6 samples/s | 77.5 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00854 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.118 | acc=1.0000 | 4905.9 samples/s | 76.7 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00834 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.119 | acc=0.9844 | 4976.6 samples/s | 77.8 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00804 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.120 | acc=0.9844 | 4936.4 samples/s | 77.1 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00785 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.121 | acc=1.0000 | 5023.6 samples/s | 78.5 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00770 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.121 | acc=0.9844 | 4921.5 samples/s | 76.9 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00756 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.122 | acc=1.0000 | 5001.4 samples/s | 78.1 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00740 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.123 | acc=1.0000 | 4922.6 samples/s | 76.9 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00742 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.124 | acc=1.0000 | 5071.8 samples/s | 79.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.00170 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=3.116 | acc=1.0000 | 3501.9 samples/s | 54.7 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00727 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.120 | acc=1.0000 | 4598.6 samples/s | 71.9 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00367 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.121 | acc=1.0000 | 4763.4 samples/s | 74.4 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00245 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.121 | acc=1.0000 | 4857.1 samples/s | 75.9 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00184 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.122 | acc=1.0000 | 4744.0 samples/s | 74.1 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00148 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=3.122 | acc=1.0000 | 4707.8 samples/s | 73.6 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00123 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.122 | acc=1.0000 | 4685.6 samples/s | 73.2 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00106 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.122 | acc=1.0000 | 4725.1 samples/s | 73.8 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00093 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.122 | acc=1.0000 | 4639.7 samples/s | 72.5 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00082 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=3.122 | acc=1.0000 | 4684.4 samples/s | 73.2 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00074 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=3.122 | acc=1.0000 | 4771.0 samples/s | 74.5 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00067 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=3.122 | acc=1.0000 | 2011.2 samples/s | 31.4 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00062 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=3.122 | acc=1.0000 | 4755.2 samples/s | 74.3 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00057 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.122 | acc=1.0000 | 4626.8 samples/s | 72.3 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00053 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.122 | acc=1.0000 | 4764.5 samples/s | 74.4 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00050 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.122 | acc=1.0000 | 4843.7 samples/s | 75.7 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00047 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=3.122 | acc=1.0000 | 4838.2 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24749 | acc=0.8741 | tpr=0.8201 | fpr=0.0084 | 4338.4 samples/s | 16.9 steps/s
Avg test loss: 0.25067, Avg test acc: 0.87519, Avg tpr: 0.82229, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.45317 | acc=0.8916 | tpr=0.9779 | fpr=0.1099 | 4459.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.46506 | acc=0.8929 | tpr=0.9808 | fpr=0.1088 | 8594.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.47672 | acc=0.8902 | tpr=0.9798 | fpr=0.1114 | 8816.1 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.48011 | acc=0.8907 | tpr=0.9781 | fpr=0.1109 | 8717.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.48095 | acc=0.8904 | tpr=0.9808 | fpr=0.1112 | 8984.2 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.48239 | acc=0.8905 | tpr=0.9796 | fpr=0.1111 | 8440.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.48557 | acc=0.8904 | tpr=0.9775 | fpr=0.1112 | 8759.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.48757 | acc=0.8901 | tpr=0.9759 | fpr=0.1115 | 8668.9 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.49096 | acc=0.8900 | tpr=0.9757 | fpr=0.1115 | 8831.3 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.49035 | acc=0.8899 | tpr=0.9758 | fpr=0.1117 | 8608.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.48766 | acc=0.8902 | tpr=0.9765 | fpr=0.1114 | 16349.0 samples/s | 63.9 steps/s
Avg test loss: 0.48730, Avg test acc: 0.89022, Avg tpr: 0.97662, Avg fpr: 0.11135, total FA: 15461

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.13251 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.128 | acc=0.8906 | 4044.0 samples/s | 63.2 steps/s
[Step=33650 Epoch=32.9] | Loss=0.02279 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.127 | acc=1.0000 | 4571.5 samples/s | 71.4 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01451 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=3.127 | acc=1.0000 | 4996.6 samples/s | 78.1 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01106 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.128 | acc=1.0000 | 5075.3 samples/s | 79.3 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00964 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=3.129 | acc=0.9844 | 5034.7 samples/s | 78.7 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00878 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.130 | acc=1.0000 | 5078.1 samples/s | 79.3 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00827 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=3.131 | acc=1.0000 | 5112.8 samples/s | 79.9 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00811 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=3.131 | acc=1.0000 | 5068.4 samples/s | 79.2 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00786 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=3.132 | acc=1.0000 | 5064.6 samples/s | 79.1 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00757 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=3.133 | acc=0.9844 | 5071.9 samples/s | 79.2 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00747 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.134 | acc=1.0000 | 4913.6 samples/s | 76.8 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00724 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.134 | acc=1.0000 | 4903.0 samples/s | 76.6 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00716 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=3.135 | acc=1.0000 | 5009.4 samples/s | 78.3 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00722 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.136 | acc=1.0000 | 4947.0 samples/s | 77.3 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00718 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.137 | acc=1.0000 | 4988.7 samples/s | 77.9 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00710 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=3.137 | acc=0.9844 | 4982.2 samples/s | 77.8 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00701 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=3.138 | acc=0.9531 | 4956.8 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.05539 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.128 | acc=0.9688 | 3536.9 samples/s | 55.3 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00507 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=3.132 | acc=1.0000 | 4545.9 samples/s | 71.0 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00256 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.133 | acc=1.0000 | 4786.3 samples/s | 74.8 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00171 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=3.133 | acc=1.0000 | 4687.3 samples/s | 73.2 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00130 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=3.133 | acc=1.0000 | 4692.2 samples/s | 73.3 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00105 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.133 | acc=1.0000 | 4708.8 samples/s | 73.6 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00088 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.134 | acc=1.0000 | 4712.1 samples/s | 73.6 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00075 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.134 | acc=1.0000 | 4709.7 samples/s | 73.6 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00066 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=3.134 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00059 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.134 | acc=1.0000 | 4785.3 samples/s | 74.8 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00053 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.134 | acc=1.0000 | 4735.9 samples/s | 74.0 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00048 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=3.135 | acc=1.0000 | 1924.8 samples/s | 30.1 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00044 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=3.135 | acc=1.0000 | 4886.0 samples/s | 76.3 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00041 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.135 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00038 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.135 | acc=1.0000 | 4654.8 samples/s | 72.7 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00035 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.135 | acc=1.0000 | 4767.1 samples/s | 74.5 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00033 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=3.135 | acc=1.0000 | 4675.0 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23228 | acc=0.8831 | tpr=0.8332 | fpr=0.0084 | 4380.3 samples/s | 17.1 steps/s
Avg test loss: 0.23520, Avg test acc: 0.88300, Avg tpr: 0.83389, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.46127 | acc=0.8877 | tpr=0.9779 | fpr=0.1139 | 4378.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.47366 | acc=0.8886 | tpr=0.9808 | fpr=0.1131 | 8848.5 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.48515 | acc=0.8865 | tpr=0.9798 | fpr=0.1153 | 8979.2 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.48830 | acc=0.8872 | tpr=0.9770 | fpr=0.1144 | 8960.3 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.48889 | acc=0.8870 | tpr=0.9799 | fpr=0.1147 | 8242.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.49056 | acc=0.8874 | tpr=0.9789 | fpr=0.1143 | 8620.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.49382 | acc=0.8871 | tpr=0.9768 | fpr=0.1145 | 8873.5 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.49553 | acc=0.8867 | tpr=0.9754 | fpr=0.1149 | 8533.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.49877 | acc=0.8867 | tpr=0.9757 | fpr=0.1149 | 8700.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.49830 | acc=0.8866 | tpr=0.9758 | fpr=0.1150 | 8594.9 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.49577 | acc=0.8870 | tpr=0.9765 | fpr=0.1147 | 16032.3 samples/s | 62.6 steps/s
Avg test loss: 0.49535, Avg test acc: 0.88699, Avg tpr: 0.97662, Avg fpr: 0.11464, total FA: 15918

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.16087 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.142 | acc=0.9062 | 3665.8 samples/s | 57.3 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02003 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=3.140 | acc=1.0000 | 5026.6 samples/s | 78.5 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01373 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.141 | acc=1.0000 | 5093.7 samples/s | 79.6 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01103 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.142 | acc=1.0000 | 4988.2 samples/s | 77.9 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00955 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=3.143 | acc=0.9844 | 5039.7 samples/s | 78.7 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00850 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.144 | acc=1.0000 | 5066.1 samples/s | 79.2 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00834 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.145 | acc=0.9688 | 5073.5 samples/s | 79.3 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00814 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.146 | acc=1.0000 | 5027.5 samples/s | 78.6 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00783 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=3.146 | acc=0.9844 | 5078.5 samples/s | 79.4 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00779 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=3.147 | acc=1.0000 | 4846.3 samples/s | 75.7 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00759 | Reg=0.00198 | L2-Norm=14.089 | L2-Norm(final)=3.148 | acc=1.0000 | 4959.2 samples/s | 77.5 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00737 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=3.149 | acc=0.9844 | 4950.3 samples/s | 77.3 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00735 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=3.149 | acc=0.9844 | 5071.6 samples/s | 79.2 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00719 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.150 | acc=1.0000 | 4902.7 samples/s | 76.6 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00697 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.151 | acc=1.0000 | 4973.8 samples/s | 77.7 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00698 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=3.151 | acc=0.9844 | 4942.2 samples/s | 77.2 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00694 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=3.152 | acc=0.9844 | 4996.4 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.03872 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.142 | acc=0.9844 | 3690.4 samples/s | 57.7 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00508 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.147 | acc=1.0000 | 4431.6 samples/s | 69.2 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00254 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.148 | acc=1.0000 | 4686.0 samples/s | 73.2 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00171 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.148 | acc=1.0000 | 4718.0 samples/s | 73.7 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00128 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.148 | acc=1.0000 | 4728.6 samples/s | 73.9 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00103 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.149 | acc=1.0000 | 4611.6 samples/s | 72.1 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00086 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.149 | acc=1.0000 | 4703.4 samples/s | 73.5 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00074 | Reg=0.00198 | L2-Norm=14.086 | L2-Norm(final)=3.149 | acc=1.0000 | 4764.9 samples/s | 74.5 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00065 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=3.149 | acc=1.0000 | 4742.2 samples/s | 74.1 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00058 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.149 | acc=1.0000 | 4693.1 samples/s | 73.3 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00052 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.149 | acc=1.0000 | 4780.1 samples/s | 74.7 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00047 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.149 | acc=1.0000 | 1953.4 samples/s | 30.5 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00043 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=3.150 | acc=1.0000 | 4802.0 samples/s | 75.0 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00040 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=3.150 | acc=1.0000 | 4675.0 samples/s | 73.0 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00037 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=3.150 | acc=1.0000 | 4672.4 samples/s | 73.0 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00035 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=3.150 | acc=1.0000 | 4682.5 samples/s | 73.2 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00033 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.150 | acc=1.0000 | 4712.3 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25179 | acc=0.8768 | tpr=0.8237 | fpr=0.0079 | 4373.0 samples/s | 17.1 steps/s
Avg test loss: 0.25471, Avg test acc: 0.87551, Avg tpr: 0.82275, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.45920 | acc=0.8917 | tpr=0.9779 | fpr=0.1098 | 4423.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.47254 | acc=0.8929 | tpr=0.9808 | fpr=0.1088 | 8949.5 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.48425 | acc=0.8904 | tpr=0.9798 | fpr=0.1113 | 8716.8 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.48807 | acc=0.8909 | tpr=0.9781 | fpr=0.1106 | 8740.3 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.48841 | acc=0.8907 | tpr=0.9808 | fpr=0.1109 | 8884.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.49000 | acc=0.8910 | tpr=0.9796 | fpr=0.1106 | 8603.8 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.49330 | acc=0.8908 | tpr=0.9775 | fpr=0.1108 | 8682.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.49516 | acc=0.8906 | tpr=0.9759 | fpr=0.1109 | 8930.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.49845 | acc=0.8906 | tpr=0.9761 | fpr=0.1110 | 8662.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.49786 | acc=0.8905 | tpr=0.9762 | fpr=0.1111 | 8644.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.49519 | acc=0.8908 | tpr=0.9769 | fpr=0.1107 | 15558.1 samples/s | 60.8 steps/s
Avg test loss: 0.49480, Avg test acc: 0.89090, Avg tpr: 0.97702, Avg fpr: 0.11066, total FA: 15365

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.06176 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.156 | acc=0.9688 | 3837.6 samples/s | 60.0 steps/s
[Step=35250 Epoch=34.4] | Loss=0.02270 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.153 | acc=0.9844 | 4624.1 samples/s | 72.3 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01360 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.153 | acc=1.0000 | 4907.3 samples/s | 76.7 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01070 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.153 | acc=1.0000 | 4976.3 samples/s | 77.8 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00950 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=3.154 | acc=1.0000 | 4759.1 samples/s | 74.4 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00904 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=3.155 | acc=1.0000 | 4865.6 samples/s | 76.0 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00845 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=3.156 | acc=1.0000 | 4941.7 samples/s | 77.2 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00835 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=3.156 | acc=1.0000 | 4913.3 samples/s | 76.8 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00798 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=3.157 | acc=0.9844 | 5020.0 samples/s | 78.4 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00774 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=3.158 | acc=1.0000 | 4898.8 samples/s | 76.5 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00755 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=3.158 | acc=0.9844 | 4980.9 samples/s | 77.8 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00743 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.159 | acc=1.0000 | 5029.7 samples/s | 78.6 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00729 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.160 | acc=1.0000 | 4887.8 samples/s | 76.4 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00712 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.160 | acc=0.9688 | 4942.4 samples/s | 77.2 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00706 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=3.161 | acc=0.9844 | 4970.4 samples/s | 77.7 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00705 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.162 | acc=1.0000 | 5000.5 samples/s | 78.1 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00696 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.162 | acc=1.0000 | 4975.3 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.05074 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.156 | acc=0.9531 | 3769.0 samples/s | 58.9 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00352 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.161 | acc=1.0000 | 4259.9 samples/s | 66.6 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00177 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.161 | acc=1.0000 | 4796.3 samples/s | 74.9 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00119 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=3.162 | acc=1.0000 | 4808.7 samples/s | 75.1 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00090 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=3.162 | acc=1.0000 | 4811.9 samples/s | 75.2 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00073 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.163 | acc=1.0000 | 4818.4 samples/s | 75.3 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00061 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.163 | acc=1.0000 | 4816.7 samples/s | 75.3 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00052 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=3.163 | acc=1.0000 | 4857.0 samples/s | 75.9 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00046 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.163 | acc=1.0000 | 4822.0 samples/s | 75.3 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00041 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.163 | acc=1.0000 | 4788.3 samples/s | 74.8 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00037 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.163 | acc=1.0000 | 4693.3 samples/s | 73.3 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00033 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.164 | acc=1.0000 | 1953.0 samples/s | 30.5 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00031 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.164 | acc=1.0000 | 4856.8 samples/s | 75.9 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00028 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.164 | acc=1.0000 | 4912.3 samples/s | 76.8 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00026 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.164 | acc=1.0000 | 4745.4 samples/s | 74.1 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00025 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.164 | acc=1.0000 | 4842.4 samples/s | 75.7 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00023 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.164 | acc=1.0000 | 4918.5 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23309 | acc=0.8859 | tpr=0.8375 | fpr=0.0092 | 4305.1 samples/s | 16.8 steps/s
Avg test loss: 0.23708, Avg test acc: 0.88457, Avg tpr: 0.83639, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.47250 | acc=0.8895 | tpr=0.9779 | fpr=0.1121 | 4416.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.48661 | acc=0.8899 | tpr=0.9808 | fpr=0.1118 | 8775.2 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.49865 | acc=0.8875 | tpr=0.9798 | fpr=0.1142 | 9208.6 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.50220 | acc=0.8882 | tpr=0.9781 | fpr=0.1135 | 8302.5 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.50251 | acc=0.8881 | tpr=0.9808 | fpr=0.1136 | 8531.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.50410 | acc=0.8883 | tpr=0.9796 | fpr=0.1134 | 8673.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.50747 | acc=0.8878 | tpr=0.9775 | fpr=0.1138 | 8745.6 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.50941 | acc=0.8875 | tpr=0.9759 | fpr=0.1141 | 8690.0 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.51267 | acc=0.8874 | tpr=0.9761 | fpr=0.1143 | 8828.3 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.51207 | acc=0.8872 | tpr=0.9762 | fpr=0.1144 | 8653.4 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.50946 | acc=0.8873 | tpr=0.9765 | fpr=0.1143 | 15730.2 samples/s | 61.4 steps/s
Avg test loss: 0.50905, Avg test acc: 0.88735, Avg tpr: 0.97662, Avg fpr: 0.11428, total FA: 15867

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.01424 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.168 | acc=1.0000 | 3767.2 samples/s | 58.9 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01582 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=3.168 | acc=1.0000 | 4803.4 samples/s | 75.1 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01013 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=3.168 | acc=1.0000 | 4995.0 samples/s | 78.0 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00883 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.169 | acc=1.0000 | 4977.1 samples/s | 77.8 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00827 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.170 | acc=0.9844 | 4927.9 samples/s | 77.0 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00758 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.171 | acc=0.9688 | 4895.9 samples/s | 76.5 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00770 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.171 | acc=0.9844 | 5007.9 samples/s | 78.2 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00729 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.172 | acc=1.0000 | 4946.2 samples/s | 77.3 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00736 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.173 | acc=1.0000 | 5050.6 samples/s | 78.9 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00730 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.173 | acc=0.9844 | 4937.1 samples/s | 77.1 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00724 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.174 | acc=0.9688 | 4929.3 samples/s | 77.0 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00718 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.175 | acc=1.0000 | 5009.4 samples/s | 78.3 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00708 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.175 | acc=0.9844 | 4920.1 samples/s | 76.9 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00698 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.176 | acc=1.0000 | 5027.0 samples/s | 78.5 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00695 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.177 | acc=1.0000 | 4910.4 samples/s | 76.7 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00692 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.177 | acc=1.0000 | 4995.6 samples/s | 78.1 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00690 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.178 | acc=1.0000 | 5090.8 samples/s | 79.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.00401 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.168 | acc=1.0000 | 3730.0 samples/s | 58.3 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00463 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.173 | acc=1.0000 | 4442.7 samples/s | 69.4 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00233 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.174 | acc=1.0000 | 4797.1 samples/s | 75.0 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00156 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.174 | acc=1.0000 | 4677.8 samples/s | 73.1 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00117 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.175 | acc=1.0000 | 4603.6 samples/s | 71.9 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00094 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.175 | acc=1.0000 | 4517.7 samples/s | 70.6 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00078 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.176 | acc=1.0000 | 4654.9 samples/s | 72.7 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00067 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.176 | acc=1.0000 | 4665.9 samples/s | 72.9 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00059 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.176 | acc=1.0000 | 4659.6 samples/s | 72.8 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00053 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.177 | acc=1.0000 | 4725.6 samples/s | 73.8 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00047 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.177 | acc=1.0000 | 4676.8 samples/s | 73.1 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00043 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.177 | acc=1.0000 | 1944.3 samples/s | 30.4 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00040 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.177 | acc=1.0000 | 4815.8 samples/s | 75.2 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00037 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.177 | acc=1.0000 | 4643.2 samples/s | 72.5 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00034 | Reg=0.00198 | L2-Norm=14.070 | L2-Norm(final)=3.177 | acc=1.0000 | 4731.5 samples/s | 73.9 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00032 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=3.178 | acc=1.0000 | 4633.6 samples/s | 72.4 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00030 | Reg=0.00198 | L2-Norm=14.068 | L2-Norm(final)=3.178 | acc=1.0000 | 4667.0 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26449 | acc=0.8745 | tpr=0.8203 | fpr=0.0079 | 4359.3 samples/s | 17.0 steps/s
Avg test loss: 0.26768, Avg test acc: 0.87375, Avg tpr: 0.82013, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.43558 | acc=0.9043 | tpr=0.9779 | fpr=0.0970 | 3676.8 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.44915 | acc=0.9053 | tpr=0.9808 | fpr=0.0961 | 7520.2 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.46068 | acc=0.9033 | tpr=0.9798 | fpr=0.0981 | 7661.1 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.46459 | acc=0.9033 | tpr=0.9770 | fpr=0.0980 | 7429.2 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.46513 | acc=0.9029 | tpr=0.9799 | fpr=0.0985 | 7533.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.46707 | acc=0.9032 | tpr=0.9789 | fpr=0.0982 | 7285.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.47063 | acc=0.9028 | tpr=0.9768 | fpr=0.0986 | 6940.3 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.47263 | acc=0.9025 | tpr=0.9754 | fpr=0.0988 | 7171.7 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.47615 | acc=0.9023 | tpr=0.9757 | fpr=0.0990 | 7025.6 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.47542 | acc=0.9021 | tpr=0.9753 | fpr=0.0992 | 7687.0 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.47267 | acc=0.9025 | tpr=0.9761 | fpr=0.0989 | 16024.4 samples/s | 62.6 steps/s
Avg test loss: 0.47224, Avg test acc: 0.90252, Avg tpr: 0.97623, Avg fpr: 0.09882, total FA: 13721

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.19486 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.182 | acc=0.8906 | 3753.3 samples/s | 58.6 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02221 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.179 | acc=1.0000 | 4657.8 samples/s | 72.8 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01392 | Reg=0.00198 | L2-Norm=14.070 | L2-Norm(final)=3.179 | acc=1.0000 | 4957.3 samples/s | 77.5 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01097 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.179 | acc=1.0000 | 5092.8 samples/s | 79.6 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00927 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=3.180 | acc=0.9844 | 5031.4 samples/s | 78.6 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00886 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.180 | acc=1.0000 | 5047.8 samples/s | 78.9 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00834 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.181 | acc=1.0000 | 5135.6 samples/s | 80.2 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00796 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.182 | acc=1.0000 | 4948.5 samples/s | 77.3 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00779 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.182 | acc=1.0000 | 4945.8 samples/s | 77.3 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00759 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.183 | acc=1.0000 | 4966.6 samples/s | 77.6 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00736 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.184 | acc=0.9531 | 4951.5 samples/s | 77.4 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00721 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=3.184 | acc=1.0000 | 5048.7 samples/s | 78.9 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00708 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.185 | acc=1.0000 | 4862.0 samples/s | 76.0 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00715 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.186 | acc=1.0000 | 4968.7 samples/s | 77.6 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00704 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.186 | acc=0.9844 | 5004.5 samples/s | 78.2 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00699 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=3.187 | acc=1.0000 | 5031.3 samples/s | 78.6 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00703 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=3.187 | acc=1.0000 | 5077.6 samples/s | 79.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.00174 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.182 | acc=1.0000 | 3997.5 samples/s | 62.5 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00675 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=3.184 | acc=1.0000 | 4098.9 samples/s | 64.0 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00342 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.184 | acc=1.0000 | 4865.3 samples/s | 76.0 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00228 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.184 | acc=1.0000 | 4710.0 samples/s | 73.6 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00172 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.184 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00138 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.184 | acc=1.0000 | 4718.6 samples/s | 73.7 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00115 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=3.185 | acc=1.0000 | 4717.6 samples/s | 73.7 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00099 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=3.185 | acc=1.0000 | 4869.0 samples/s | 76.1 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00087 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=3.185 | acc=1.0000 | 4829.8 samples/s | 75.5 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00077 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.185 | acc=1.0000 | 4801.3 samples/s | 75.0 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00069 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.185 | acc=1.0000 | 4738.9 samples/s | 74.0 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00063 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=3.185 | acc=1.0000 | 1956.2 samples/s | 30.6 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00058 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=3.185 | acc=1.0000 | 4918.5 samples/s | 76.9 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00054 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=3.185 | acc=1.0000 | 4738.8 samples/s | 74.0 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00050 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=3.185 | acc=1.0000 | 4818.2 samples/s | 75.3 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00047 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=3.185 | acc=1.0000 | 4805.7 samples/s | 75.1 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00044 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.185 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24538 | acc=0.8787 | tpr=0.8262 | fpr=0.0074 | 3916.5 samples/s | 15.3 steps/s
Avg test loss: 0.24862, Avg test acc: 0.87888, Avg tpr: 0.82742, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.46473 | acc=0.8920 | tpr=0.9779 | fpr=0.1095 | 4057.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.47710 | acc=0.8936 | tpr=0.9808 | fpr=0.1080 | 8226.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.48875 | acc=0.8920 | tpr=0.9798 | fpr=0.1096 | 8479.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.49269 | acc=0.8925 | tpr=0.9781 | fpr=0.1091 | 7837.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.49359 | acc=0.8922 | tpr=0.9808 | fpr=0.1094 | 8220.0 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.49541 | acc=0.8924 | tpr=0.9796 | fpr=0.1092 | 7841.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.49888 | acc=0.8921 | tpr=0.9775 | fpr=0.1095 | 8705.8 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.50087 | acc=0.8917 | tpr=0.9759 | fpr=0.1098 | 7598.9 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.50446 | acc=0.8917 | tpr=0.9757 | fpr=0.1098 | 8650.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.50372 | acc=0.8916 | tpr=0.9753 | fpr=0.1100 | 4739.3 samples/s | 18.5 steps/s
[Step= 550] | Loss=0.50106 | acc=0.8919 | tpr=0.9761 | fpr=0.1096 | 15013.6 samples/s | 58.6 steps/s
Avg test loss: 0.50067, Avg test acc: 0.89197, Avg tpr: 0.97623, Avg fpr: 0.10956, total FA: 15212

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.12918 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=3.190 | acc=0.9062 | 3543.7 samples/s | 55.4 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01798 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.190 | acc=0.9844 | 4458.6 samples/s | 69.7 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01202 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=3.190 | acc=1.0000 | 4632.7 samples/s | 72.4 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00935 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=3.191 | acc=1.0000 | 4730.7 samples/s | 73.9 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00855 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.192 | acc=1.0000 | 4659.3 samples/s | 72.8 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00784 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=3.192 | acc=0.9844 | 4796.6 samples/s | 74.9 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00750 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=3.193 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00724 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=3.194 | acc=0.9688 | 4755.3 samples/s | 74.3 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00690 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=3.194 | acc=0.9844 | 4740.5 samples/s | 74.1 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00672 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.195 | acc=0.9688 | 4755.7 samples/s | 74.3 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00659 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.196 | acc=1.0000 | 4740.7 samples/s | 74.1 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00666 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=3.197 | acc=0.9844 | 4682.4 samples/s | 73.2 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00658 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=3.197 | acc=0.9844 | 4769.6 samples/s | 74.5 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00651 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=3.198 | acc=1.0000 | 4655.8 samples/s | 72.7 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00644 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=3.198 | acc=0.9688 | 4773.0 samples/s | 74.6 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00647 | Reg=0.00198 | L2-Norm=14.068 | L2-Norm(final)=3.199 | acc=0.9844 | 4758.2 samples/s | 74.3 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00636 | Reg=0.00198 | L2-Norm=14.068 | L2-Norm(final)=3.199 | acc=1.0000 | 4698.6 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00122 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=3.190 | acc=1.0000 | 3765.7 samples/s | 58.8 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00489 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.194 | acc=1.0000 | 3941.1 samples/s | 61.6 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00245 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.195 | acc=1.0000 | 4452.2 samples/s | 69.6 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00164 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.195 | acc=1.0000 | 4507.1 samples/s | 70.4 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00123 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.196 | acc=1.0000 | 4487.0 samples/s | 70.1 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00099 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.196 | acc=1.0000 | 4481.1 samples/s | 70.0 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00082 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=3.196 | acc=1.0000 | 4535.5 samples/s | 70.9 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00071 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.196 | acc=1.0000 | 4556.7 samples/s | 71.2 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00062 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.196 | acc=1.0000 | 4497.8 samples/s | 70.3 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00055 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.196 | acc=1.0000 | 4481.6 samples/s | 70.0 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00050 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.196 | acc=1.0000 | 4510.8 samples/s | 70.5 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00045 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.197 | acc=1.0000 | 1880.0 samples/s | 29.4 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00042 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.197 | acc=1.0000 | 4577.4 samples/s | 71.5 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00038 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.197 | acc=1.0000 | 4458.8 samples/s | 69.7 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00036 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.197 | acc=1.0000 | 4542.6 samples/s | 71.0 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00033 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=3.197 | acc=1.0000 | 4477.7 samples/s | 70.0 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00031 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=3.197 | acc=1.0000 | 4528.8 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24943 | acc=0.8801 | tpr=0.8286 | fpr=0.0082 | 4180.0 samples/s | 16.3 steps/s
Avg test loss: 0.25211, Avg test acc: 0.87932, Avg tpr: 0.82829, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.44376 | acc=0.9036 | tpr=0.9779 | fpr=0.0977 | 4156.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.45699 | acc=0.9036 | tpr=0.9808 | fpr=0.0978 | 8227.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.46894 | acc=0.9014 | tpr=0.9798 | fpr=0.1000 | 8087.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.47276 | acc=0.9016 | tpr=0.9770 | fpr=0.0998 | 7968.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.47326 | acc=0.9016 | tpr=0.9799 | fpr=0.0998 | 8176.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.47533 | acc=0.9017 | tpr=0.9789 | fpr=0.0997 | 8161.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.47876 | acc=0.9012 | tpr=0.9762 | fpr=0.1001 | 8241.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.48068 | acc=0.9009 | tpr=0.9748 | fpr=0.1004 | 7055.2 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.48433 | acc=0.9006 | tpr=0.9747 | fpr=0.1007 | 5791.9 samples/s | 22.6 steps/s
[Step= 500] | Loss=0.48356 | acc=0.9006 | tpr=0.9749 | fpr=0.1007 | 7914.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.48079 | acc=0.9010 | tpr=0.9757 | fpr=0.1004 | 15172.7 samples/s | 59.3 steps/s
Avg test loss: 0.48031, Avg test acc: 0.90100, Avg tpr: 0.97583, Avg fpr: 0.10036, total FA: 13935

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.25238 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=3.202 | acc=0.8906 | 3661.2 samples/s | 57.2 steps/s
[Step=38450 Epoch=37.5] | Loss=0.01964 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.201 | acc=0.9688 | 4447.0 samples/s | 69.5 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01301 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.201 | acc=0.9844 | 4689.1 samples/s | 73.3 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01026 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.202 | acc=1.0000 | 4625.0 samples/s | 72.3 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00927 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.202 | acc=1.0000 | 4689.5 samples/s | 73.3 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00869 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=3.203 | acc=1.0000 | 4716.3 samples/s | 73.7 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00828 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=3.204 | acc=1.0000 | 4709.5 samples/s | 73.6 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00784 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=3.204 | acc=1.0000 | 4753.1 samples/s | 74.3 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00737 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.205 | acc=1.0000 | 4832.0 samples/s | 75.5 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00718 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=3.206 | acc=1.0000 | 4745.7 samples/s | 74.2 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00703 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=3.206 | acc=0.9844 | 4697.9 samples/s | 73.4 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00688 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=3.207 | acc=1.0000 | 4721.9 samples/s | 73.8 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00672 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=3.208 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00671 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=3.208 | acc=1.0000 | 4768.8 samples/s | 74.5 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00671 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=3.209 | acc=0.9844 | 4785.6 samples/s | 74.8 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00672 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=3.210 | acc=1.0000 | 4738.0 samples/s | 74.0 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00671 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=3.210 | acc=1.0000 | 4776.0 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.07165 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=3.203 | acc=0.9844 | 3807.3 samples/s | 59.5 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00405 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.207 | acc=1.0000 | 4042.9 samples/s | 63.2 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00205 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.208 | acc=1.0000 | 4473.9 samples/s | 69.9 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00137 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.208 | acc=1.0000 | 4491.7 samples/s | 70.2 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00103 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.208 | acc=1.0000 | 4501.2 samples/s | 70.3 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00083 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.209 | acc=1.0000 | 4487.3 samples/s | 70.1 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00069 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.209 | acc=1.0000 | 4508.1 samples/s | 70.4 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00060 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.209 | acc=1.0000 | 4509.6 samples/s | 70.5 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00052 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.209 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00047 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.209 | acc=1.0000 | 4507.7 samples/s | 70.4 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00042 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.209 | acc=1.0000 | 4507.5 samples/s | 70.4 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00038 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.209 | acc=1.0000 | 1876.5 samples/s | 29.3 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00035 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=3.209 | acc=1.0000 | 4519.9 samples/s | 70.6 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00032 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=3.210 | acc=1.0000 | 4516.4 samples/s | 70.6 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00030 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=3.210 | acc=1.0000 | 4486.3 samples/s | 70.1 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00028 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=3.210 | acc=1.0000 | 4449.6 samples/s | 69.5 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00026 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=3.210 | acc=1.0000 | 4549.4 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22597 | acc=0.8889 | tpr=0.8420 | fpr=0.0092 | 4134.1 samples/s | 16.1 steps/s
Avg test loss: 0.22982, Avg test acc: 0.88881, Avg tpr: 0.84251, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.46242 | acc=0.8972 | tpr=0.9779 | fpr=0.1043 | 4141.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.47436 | acc=0.8972 | tpr=0.9808 | fpr=0.1044 | 8343.7 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.48648 | acc=0.8954 | tpr=0.9798 | fpr=0.1061 | 6058.6 samples/s | 23.7 steps/s
[Step= 200] | Loss=0.49029 | acc=0.8957 | tpr=0.9770 | fpr=0.1058 | 8107.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.49076 | acc=0.8957 | tpr=0.9799 | fpr=0.1059 | 8710.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.49279 | acc=0.8959 | tpr=0.9789 | fpr=0.1056 | 7944.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.49646 | acc=0.8956 | tpr=0.9768 | fpr=0.1059 | 6025.9 samples/s | 23.5 steps/s
[Step= 400] | Loss=0.49846 | acc=0.8953 | tpr=0.9754 | fpr=0.1062 | 8305.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.50227 | acc=0.8953 | tpr=0.9757 | fpr=0.1062 | 7747.7 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.50165 | acc=0.8952 | tpr=0.9758 | fpr=0.1062 | 8056.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.49885 | acc=0.8954 | tpr=0.9765 | fpr=0.1060 | 15057.1 samples/s | 58.8 steps/s
Avg test loss: 0.49836, Avg test acc: 0.89547, Avg tpr: 0.97662, Avg fpr: 0.10600, total FA: 14718

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.12044 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=3.215 | acc=0.9219 | 3541.9 samples/s | 55.3 steps/s
[Step=39250 Epoch=38.3] | Loss=0.02059 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=3.213 | acc=0.9688 | 4279.6 samples/s | 66.9 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01310 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=3.213 | acc=1.0000 | 4687.3 samples/s | 73.2 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01085 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.213 | acc=1.0000 | 4730.5 samples/s | 73.9 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00965 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=3.214 | acc=1.0000 | 4703.9 samples/s | 73.5 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00877 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.215 | acc=1.0000 | 4705.0 samples/s | 73.5 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00823 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.215 | acc=0.9844 | 4736.7 samples/s | 74.0 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00794 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=3.216 | acc=1.0000 | 4746.5 samples/s | 74.2 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00756 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.217 | acc=1.0000 | 4745.5 samples/s | 74.1 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00743 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.217 | acc=1.0000 | 4651.2 samples/s | 72.7 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00723 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.218 | acc=1.0000 | 4705.5 samples/s | 73.5 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00710 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.219 | acc=0.9844 | 4759.2 samples/s | 74.4 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00699 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=3.219 | acc=1.0000 | 4695.7 samples/s | 73.4 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00686 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.220 | acc=1.0000 | 4731.7 samples/s | 73.9 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00671 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.221 | acc=1.0000 | 4764.9 samples/s | 74.5 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00667 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=3.221 | acc=1.0000 | 4727.7 samples/s | 73.9 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00662 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=3.222 | acc=0.9688 | 4712.0 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.01200 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=3.215 | acc=0.9844 | 3437.4 samples/s | 53.7 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00324 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=3.219 | acc=1.0000 | 4317.6 samples/s | 67.5 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00164 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.220 | acc=1.0000 | 4263.1 samples/s | 66.6 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00110 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.220 | acc=1.0000 | 4439.1 samples/s | 69.4 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00082 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.221 | acc=1.0000 | 4419.3 samples/s | 69.1 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00066 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.221 | acc=1.0000 | 4513.5 samples/s | 70.5 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00055 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=3.221 | acc=1.0000 | 4467.2 samples/s | 69.8 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00047 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=3.221 | acc=1.0000 | 4475.2 samples/s | 69.9 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00042 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=3.221 | acc=1.0000 | 4549.0 samples/s | 71.1 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00037 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=3.221 | acc=1.0000 | 4524.4 samples/s | 70.7 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00033 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=3.221 | acc=1.0000 | 4472.5 samples/s | 69.9 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00030 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=3.221 | acc=1.0000 | 1871.3 samples/s | 29.2 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00028 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=3.221 | acc=1.0000 | 4559.6 samples/s | 71.2 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00026 | Reg=0.00197 | L2-Norm=14.045 | L2-Norm(final)=3.222 | acc=1.0000 | 4469.4 samples/s | 69.8 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00024 | Reg=0.00197 | L2-Norm=14.044 | L2-Norm(final)=3.222 | acc=1.0000 | 4477.3 samples/s | 70.0 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00022 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=3.222 | acc=1.0000 | 4587.1 samples/s | 71.7 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00021 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=3.222 | acc=1.0000 | 4420.4 samples/s | 69.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23675 | acc=0.8857 | tpr=0.8374 | fpr=0.0094 | 4218.7 samples/s | 16.5 steps/s
Avg test loss: 0.24030, Avg test acc: 0.88625, Avg tpr: 0.83878, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.45525 | acc=0.9001 | tpr=0.9779 | fpr=0.1013 | 4082.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.46836 | acc=0.8998 | tpr=0.9808 | fpr=0.1017 | 6520.7 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.47984 | acc=0.8983 | tpr=0.9798 | fpr=0.1032 | 7941.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.48310 | acc=0.8987 | tpr=0.9770 | fpr=0.1027 | 8415.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.48344 | acc=0.8984 | tpr=0.9799 | fpr=0.1030 | 5963.9 samples/s | 23.3 steps/s
[Step= 300] | Loss=0.48543 | acc=0.8987 | tpr=0.9789 | fpr=0.1028 | 7845.7 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.48925 | acc=0.8983 | tpr=0.9768 | fpr=0.1032 | 8353.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.49118 | acc=0.8982 | tpr=0.9754 | fpr=0.1032 | 8089.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.49491 | acc=0.8983 | tpr=0.9757 | fpr=0.1031 | 7949.9 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.49422 | acc=0.8982 | tpr=0.9758 | fpr=0.1032 | 8180.9 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.49145 | acc=0.8985 | tpr=0.9765 | fpr=0.1029 | 14706.6 samples/s | 57.4 steps/s
Avg test loss: 0.49098, Avg test acc: 0.89853, Avg tpr: 0.97662, Avg fpr: 0.10289, total FA: 14286
