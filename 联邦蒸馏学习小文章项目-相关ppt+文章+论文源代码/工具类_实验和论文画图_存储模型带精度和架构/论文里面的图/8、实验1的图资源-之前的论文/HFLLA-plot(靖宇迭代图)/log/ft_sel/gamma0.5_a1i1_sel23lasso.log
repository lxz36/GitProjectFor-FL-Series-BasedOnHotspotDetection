Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 23)
Resampled dataset to size (65551, 144, 23)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 23)
Resampled dataset to size (33952, 144, 23)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 23)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 23)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33906 | Reg=0.00357 | L2-Norm=18.892 | L2-Norm(final)=1.933 | acc=0.5469 | 2359.4 samples/s | 36.9 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29151 | Reg=0.00331 | L2-Norm=18.200 | L2-Norm(final)=1.925 | acc=0.7500 | 4834.3 samples/s | 75.5 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25231 | Reg=0.00321 | L2-Norm=17.919 | L2-Norm(final)=1.933 | acc=0.7969 | 4954.0 samples/s | 77.4 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22807 | Reg=0.00315 | L2-Norm=17.756 | L2-Norm(final)=1.939 | acc=0.8750 | 4933.4 samples/s | 77.1 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.21344 | Reg=0.00312 | L2-Norm=17.647 | L2-Norm(final)=1.944 | acc=0.8750 | 4957.0 samples/s | 77.5 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19970 | Reg=0.00309 | L2-Norm=17.574 | L2-Norm(final)=1.952 | acc=0.8594 | 4093.8 samples/s | 64.0 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18892 | Reg=0.00307 | L2-Norm=17.520 | L2-Norm(final)=1.959 | acc=0.8125 | 3980.0 samples/s | 62.2 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17922 | Reg=0.00306 | L2-Norm=17.482 | L2-Norm(final)=1.965 | acc=0.9219 | 4007.0 samples/s | 62.6 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.17171 | Reg=0.00305 | L2-Norm=17.452 | L2-Norm(final)=1.969 | acc=0.8750 | 4012.0 samples/s | 62.7 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16498 | Reg=0.00304 | L2-Norm=17.428 | L2-Norm(final)=1.974 | acc=0.9531 | 3972.1 samples/s | 62.1 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15971 | Reg=0.00303 | L2-Norm=17.410 | L2-Norm(final)=1.979 | acc=0.8906 | 3962.3 samples/s | 61.9 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15383 | Reg=0.00303 | L2-Norm=17.395 | L2-Norm(final)=1.983 | acc=0.8438 | 3955.8 samples/s | 61.8 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14911 | Reg=0.00302 | L2-Norm=17.383 | L2-Norm(final)=1.988 | acc=1.0000 | 4034.2 samples/s | 63.0 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14516 | Reg=0.00302 | L2-Norm=17.371 | L2-Norm(final)=1.991 | acc=0.9375 | 3946.8 samples/s | 61.7 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.14175 | Reg=0.00302 | L2-Norm=17.364 | L2-Norm(final)=1.995 | acc=0.9062 | 4009.8 samples/s | 62.7 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13780 | Reg=0.00301 | L2-Norm=17.360 | L2-Norm(final)=1.999 | acc=0.9062 | 3975.2 samples/s | 62.1 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13430 | Reg=0.00301 | L2-Norm=17.357 | L2-Norm(final)=2.002 | acc=0.9375 | 3943.0 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37250 | Reg=0.00357 | L2-Norm=18.892 | L2-Norm(final)=1.932 | acc=0.3906 | 2925.5 samples/s | 45.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.15296 | Reg=0.00341 | L2-Norm=18.473 | L2-Norm(final)=1.954 | acc=0.9688 | 4585.4 samples/s | 71.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.11141 | Reg=0.00335 | L2-Norm=18.299 | L2-Norm(final)=1.964 | acc=0.9844 | 4731.8 samples/s | 73.9 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08580 | Reg=0.00331 | L2-Norm=18.179 | L2-Norm(final)=1.971 | acc=0.9531 | 4781.9 samples/s | 74.7 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06993 | Reg=0.00327 | L2-Norm=18.085 | L2-Norm(final)=1.976 | acc=0.9844 | 4835.6 samples/s | 75.6 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05929 | Reg=0.00324 | L2-Norm=18.007 | L2-Norm(final)=1.982 | acc=0.9844 | 4857.4 samples/s | 75.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05237 | Reg=0.00322 | L2-Norm=17.938 | L2-Norm(final)=1.987 | acc=1.0000 | 4758.2 samples/s | 74.3 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04595 | Reg=0.00320 | L2-Norm=17.876 | L2-Norm(final)=1.992 | acc=0.9844 | 4897.9 samples/s | 76.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04088 | Reg=0.00318 | L2-Norm=17.818 | L2-Norm(final)=1.996 | acc=0.9844 | 4821.0 samples/s | 75.3 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03747 | Reg=0.00316 | L2-Norm=17.763 | L2-Norm(final)=2.001 | acc=1.0000 | 4894.0 samples/s | 76.5 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03434 | Reg=0.00314 | L2-Norm=17.711 | L2-Norm(final)=2.005 | acc=1.0000 | 4837.5 samples/s | 75.6 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03156 | Reg=0.00312 | L2-Norm=17.662 | L2-Norm(final)=2.009 | acc=1.0000 | 1516.4 samples/s | 23.7 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02929 | Reg=0.00310 | L2-Norm=17.615 | L2-Norm(final)=2.014 | acc=1.0000 | 4853.2 samples/s | 75.8 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02729 | Reg=0.00309 | L2-Norm=17.571 | L2-Norm(final)=2.018 | acc=1.0000 | 4883.2 samples/s | 76.3 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02572 | Reg=0.00307 | L2-Norm=17.527 | L2-Norm(final)=2.022 | acc=1.0000 | 4782.5 samples/s | 74.7 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02415 | Reg=0.00306 | L2-Norm=17.486 | L2-Norm(final)=2.026 | acc=1.0000 | 4831.9 samples/s | 75.5 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02327 | Reg=0.00305 | L2-Norm=17.446 | L2-Norm(final)=2.029 | acc=0.9844 | 4810.2 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39816 | acc=0.5107 | tpr=0.3021 | fpr=0.0364 | 4537.8 samples/s | 17.7 steps/s
Avg test loss: 0.39910, Avg test acc: 0.50833, Avg tpr: 0.30291, Avg fpr: 0.03987, total FA: 311

Testing server on iccad2012
[Step=  50] | Loss=0.19130 | acc=0.8714 | tpr=0.6858 | fpr=0.1253 | 4532.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.19065 | acc=0.8730 | tpr=0.6652 | fpr=0.1231 | 9463.6 samples/s | 37.0 steps/s
[Step= 150] | Loss=0.19048 | acc=0.8735 | tpr=0.6527 | fpr=0.1224 | 9353.9 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.18992 | acc=0.8746 | tpr=0.6273 | fpr=0.1209 | 9353.5 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.19029 | acc=0.8738 | tpr=0.6332 | fpr=0.1218 | 9775.7 samples/s | 38.2 steps/s
[Step= 300] | Loss=0.19052 | acc=0.8736 | tpr=0.6320 | fpr=0.1219 | 8923.9 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.19075 | acc=0.8733 | tpr=0.6268 | fpr=0.1222 | 9555.6 samples/s | 37.3 steps/s
[Step= 400] | Loss=0.19060 | acc=0.8738 | tpr=0.6258 | fpr=0.1217 | 8728.7 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.19083 | acc=0.8731 | tpr=0.6183 | fpr=0.1223 | 9441.7 samples/s | 36.9 steps/s
[Step= 500] | Loss=0.19096 | acc=0.8731 | tpr=0.6211 | fpr=0.1223 | 8956.5 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.19099 | acc=0.8732 | tpr=0.6184 | fpr=0.1221 | 17697.5 samples/s | 69.1 steps/s
Avg test loss: 0.19095, Avg test acc: 0.87331, Avg tpr: 0.61886, Avg fpr: 0.12206, total FA: 16948

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.34228 | Reg=0.00262 | L2-Norm=16.199 | L2-Norm(final)=2.045 | acc=0.6250 | 3798.0 samples/s | 59.3 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.17632 | Reg=0.00267 | L2-Norm=16.344 | L2-Norm(final)=2.037 | acc=0.8438 | 4872.4 samples/s | 76.1 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.14591 | Reg=0.00269 | L2-Norm=16.392 | L2-Norm(final)=2.048 | acc=0.9375 | 4889.5 samples/s | 76.4 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.13301 | Reg=0.00270 | L2-Norm=16.417 | L2-Norm(final)=2.060 | acc=0.9062 | 4911.6 samples/s | 76.7 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.12545 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.068 | acc=0.9062 | 5108.0 samples/s | 79.8 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11874 | Reg=0.00271 | L2-Norm=16.447 | L2-Norm(final)=2.074 | acc=0.9688 | 4894.3 samples/s | 76.5 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.11297 | Reg=0.00271 | L2-Norm=16.458 | L2-Norm(final)=2.080 | acc=0.9688 | 5083.5 samples/s | 79.4 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10831 | Reg=0.00271 | L2-Norm=16.470 | L2-Norm(final)=2.086 | acc=0.9062 | 4577.1 samples/s | 71.5 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10554 | Reg=0.00272 | L2-Norm=16.481 | L2-Norm(final)=2.091 | acc=0.9531 | 4010.1 samples/s | 62.7 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.10186 | Reg=0.00272 | L2-Norm=16.492 | L2-Norm(final)=2.096 | acc=1.0000 | 3892.4 samples/s | 60.8 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09938 | Reg=0.00272 | L2-Norm=16.504 | L2-Norm(final)=2.100 | acc=0.9219 | 3990.3 samples/s | 62.3 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09685 | Reg=0.00273 | L2-Norm=16.514 | L2-Norm(final)=2.105 | acc=0.9375 | 3992.6 samples/s | 62.4 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09483 | Reg=0.00273 | L2-Norm=16.526 | L2-Norm(final)=2.109 | acc=0.9688 | 3950.1 samples/s | 61.7 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09319 | Reg=0.00274 | L2-Norm=16.538 | L2-Norm(final)=2.113 | acc=0.8906 | 4001.5 samples/s | 62.5 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09220 | Reg=0.00274 | L2-Norm=16.550 | L2-Norm(final)=2.116 | acc=0.9688 | 3965.5 samples/s | 62.0 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.09085 | Reg=0.00274 | L2-Norm=16.560 | L2-Norm(final)=2.118 | acc=0.9844 | 3978.8 samples/s | 62.2 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08983 | Reg=0.00275 | L2-Norm=16.570 | L2-Norm(final)=2.120 | acc=0.9375 | 3936.7 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.29235 | Reg=0.00262 | L2-Norm=16.199 | L2-Norm(final)=2.044 | acc=0.7188 | 3256.4 samples/s | 50.9 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.04397 | Reg=0.00271 | L2-Norm=16.456 | L2-Norm(final)=2.041 | acc=0.9844 | 4369.0 samples/s | 68.3 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.02620 | Reg=0.00272 | L2-Norm=16.493 | L2-Norm(final)=2.045 | acc=1.0000 | 4638.1 samples/s | 72.5 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02171 | Reg=0.00272 | L2-Norm=16.481 | L2-Norm(final)=2.048 | acc=0.9688 | 4642.9 samples/s | 72.5 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01779 | Reg=0.00271 | L2-Norm=16.465 | L2-Norm(final)=2.051 | acc=1.0000 | 3811.7 samples/s | 59.6 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01597 | Reg=0.00270 | L2-Norm=16.444 | L2-Norm(final)=2.055 | acc=0.9844 | 3771.7 samples/s | 58.9 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01448 | Reg=0.00270 | L2-Norm=16.418 | L2-Norm(final)=2.057 | acc=1.0000 | 3768.1 samples/s | 58.9 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01300 | Reg=0.00269 | L2-Norm=16.393 | L2-Norm(final)=2.060 | acc=1.0000 | 3773.1 samples/s | 59.0 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01202 | Reg=0.00268 | L2-Norm=16.370 | L2-Norm(final)=2.064 | acc=1.0000 | 3772.9 samples/s | 59.0 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01090 | Reg=0.00267 | L2-Norm=16.346 | L2-Norm(final)=2.067 | acc=1.0000 | 3714.1 samples/s | 58.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00990 | Reg=0.00266 | L2-Norm=16.322 | L2-Norm(final)=2.071 | acc=1.0000 | 3805.0 samples/s | 59.5 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00905 | Reg=0.00266 | L2-Norm=16.298 | L2-Norm(final)=2.074 | acc=1.0000 | 1456.4 samples/s | 22.8 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00845 | Reg=0.00265 | L2-Norm=16.272 | L2-Norm(final)=2.077 | acc=1.0000 | 4987.1 samples/s | 77.9 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00794 | Reg=0.00264 | L2-Norm=16.245 | L2-Norm(final)=2.080 | acc=1.0000 | 4701.1 samples/s | 73.5 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00747 | Reg=0.00263 | L2-Norm=16.218 | L2-Norm(final)=2.083 | acc=1.0000 | 4815.6 samples/s | 75.2 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00704 | Reg=0.00262 | L2-Norm=16.192 | L2-Norm(final)=2.085 | acc=1.0000 | 4743.5 samples/s | 74.1 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00687 | Reg=0.00261 | L2-Norm=16.167 | L2-Norm(final)=2.088 | acc=1.0000 | 4778.3 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28740 | acc=0.7023 | tpr=0.5938 | fpr=0.0619 | 4547.9 samples/s | 17.8 steps/s
Avg test loss: 0.28900, Avg test acc: 0.70062, Avg tpr: 0.59393, Avg fpr: 0.06474, total FA: 505

Testing server on iccad2012
[Step=  50] | Loss=0.24128 | acc=0.7940 | tpr=0.9381 | fpr=0.2086 | 4579.8 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24116 | acc=0.7972 | tpr=0.9446 | fpr=0.2056 | 9327.2 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.24204 | acc=0.7966 | tpr=0.9467 | fpr=0.2061 | 9649.8 samples/s | 37.7 steps/s
[Step= 200] | Loss=0.24156 | acc=0.7967 | tpr=0.9421 | fpr=0.2059 | 8886.9 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.24227 | acc=0.7955 | tpr=0.9432 | fpr=0.2072 | 9227.0 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.24250 | acc=0.7947 | tpr=0.9440 | fpr=0.2081 | 9525.9 samples/s | 37.2 steps/s
[Step= 350] | Loss=0.24307 | acc=0.7939 | tpr=0.9443 | fpr=0.2088 | 9835.4 samples/s | 38.4 steps/s
[Step= 400] | Loss=0.24270 | acc=0.7942 | tpr=0.9415 | fpr=0.2084 | 9227.2 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.24314 | acc=0.7938 | tpr=0.9406 | fpr=0.2088 | 9260.2 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.24291 | acc=0.7936 | tpr=0.9392 | fpr=0.2090 | 8727.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.24276 | acc=0.7939 | tpr=0.9387 | fpr=0.2088 | 17949.4 samples/s | 70.1 steps/s
Avg test loss: 0.24263, Avg test acc: 0.79396, Avg tpr: 0.93899, Avg fpr: 0.20867, total FA: 28974

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.30932 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.111 | acc=0.6562 | 3602.6 samples/s | 56.3 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.12788 | Reg=0.00251 | L2-Norm=15.835 | L2-Norm(final)=2.116 | acc=0.9219 | 4908.9 samples/s | 76.7 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10730 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.130 | acc=0.9844 | 5038.8 samples/s | 78.7 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09470 | Reg=0.00254 | L2-Norm=15.945 | L2-Norm(final)=2.141 | acc=0.9375 | 4858.5 samples/s | 75.9 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09010 | Reg=0.00256 | L2-Norm=15.987 | L2-Norm(final)=2.152 | acc=0.9688 | 5060.1 samples/s | 79.1 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08593 | Reg=0.00257 | L2-Norm=16.021 | L2-Norm(final)=2.160 | acc=0.9531 | 4398.1 samples/s | 68.7 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08448 | Reg=0.00258 | L2-Norm=16.049 | L2-Norm(final)=2.165 | acc=0.9375 | 3984.3 samples/s | 62.3 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08270 | Reg=0.00258 | L2-Norm=16.075 | L2-Norm(final)=2.169 | acc=0.9375 | 3959.2 samples/s | 61.9 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.08100 | Reg=0.00259 | L2-Norm=16.100 | L2-Norm(final)=2.173 | acc=0.9531 | 3959.3 samples/s | 61.9 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07939 | Reg=0.00260 | L2-Norm=16.123 | L2-Norm(final)=2.177 | acc=0.9375 | 3942.2 samples/s | 61.6 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07869 | Reg=0.00261 | L2-Norm=16.144 | L2-Norm(final)=2.180 | acc=0.9062 | 3923.6 samples/s | 61.3 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07670 | Reg=0.00261 | L2-Norm=16.164 | L2-Norm(final)=2.183 | acc=0.9375 | 3970.7 samples/s | 62.0 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07576 | Reg=0.00262 | L2-Norm=16.182 | L2-Norm(final)=2.186 | acc=0.9375 | 3977.2 samples/s | 62.1 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07594 | Reg=0.00262 | L2-Norm=16.199 | L2-Norm(final)=2.187 | acc=0.9844 | 3911.3 samples/s | 61.1 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07525 | Reg=0.00263 | L2-Norm=16.216 | L2-Norm(final)=2.188 | acc=0.9219 | 3947.4 samples/s | 61.7 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07447 | Reg=0.00264 | L2-Norm=16.234 | L2-Norm(final)=2.189 | acc=0.9375 | 3961.3 samples/s | 61.9 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07355 | Reg=0.00264 | L2-Norm=16.251 | L2-Norm(final)=2.190 | acc=0.9688 | 3932.6 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.10825 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.112 | acc=0.9375 | 2879.1 samples/s | 45.0 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02485 | Reg=0.00253 | L2-Norm=15.896 | L2-Norm(final)=2.132 | acc=1.0000 | 4631.2 samples/s | 72.4 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01565 | Reg=0.00254 | L2-Norm=15.942 | L2-Norm(final)=2.131 | acc=1.0000 | 4673.8 samples/s | 73.0 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01208 | Reg=0.00254 | L2-Norm=15.940 | L2-Norm(final)=2.133 | acc=0.9844 | 4827.0 samples/s | 75.4 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01023 | Reg=0.00254 | L2-Norm=15.929 | L2-Norm(final)=2.136 | acc=0.9844 | 4794.1 samples/s | 74.9 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00899 | Reg=0.00253 | L2-Norm=15.919 | L2-Norm(final)=2.139 | acc=1.0000 | 4804.3 samples/s | 75.1 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00882 | Reg=0.00253 | L2-Norm=15.905 | L2-Norm(final)=2.142 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00842 | Reg=0.00253 | L2-Norm=15.891 | L2-Norm(final)=2.141 | acc=1.0000 | 4642.4 samples/s | 72.5 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00755 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.141 | acc=1.0000 | 4790.8 samples/s | 74.9 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00678 | Reg=0.00252 | L2-Norm=15.866 | L2-Norm(final)=2.142 | acc=1.0000 | 4857.8 samples/s | 75.9 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00644 | Reg=0.00251 | L2-Norm=15.849 | L2-Norm(final)=2.144 | acc=1.0000 | 4825.1 samples/s | 75.4 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00604 | Reg=0.00251 | L2-Norm=15.832 | L2-Norm(final)=2.145 | acc=1.0000 | 1519.5 samples/s | 23.7 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00564 | Reg=0.00250 | L2-Norm=15.815 | L2-Norm(final)=2.146 | acc=1.0000 | 4849.1 samples/s | 75.8 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00522 | Reg=0.00250 | L2-Norm=15.797 | L2-Norm(final)=2.148 | acc=1.0000 | 4755.5 samples/s | 74.3 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00485 | Reg=0.00249 | L2-Norm=15.778 | L2-Norm(final)=2.150 | acc=1.0000 | 4745.9 samples/s | 74.2 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00453 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.152 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00426 | Reg=0.00248 | L2-Norm=15.736 | L2-Norm(final)=2.153 | acc=1.0000 | 4840.7 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47797 | acc=0.5991 | tpr=0.4281 | fpr=0.0297 | 4528.3 samples/s | 17.7 steps/s
Avg test loss: 0.48241, Avg test acc: 0.59885, Avg tpr: 0.42939, Avg fpr: 0.02846, total FA: 222

Testing server on iccad2012
[Step=  50] | Loss=0.14444 | acc=0.8950 | tpr=0.9027 | fpr=0.1051 | 4596.0 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.14491 | acc=0.8952 | tpr=0.9147 | fpr=0.1052 | 9025.3 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.14613 | acc=0.8946 | tpr=0.9135 | fpr=0.1058 | 9332.4 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.14524 | acc=0.8952 | tpr=0.9148 | fpr=0.1052 | 9276.8 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.14560 | acc=0.8949 | tpr=0.9135 | fpr=0.1054 | 9199.0 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.14562 | acc=0.8954 | tpr=0.9149 | fpr=0.1049 | 9691.4 samples/s | 37.9 steps/s
[Step= 350] | Loss=0.14608 | acc=0.8951 | tpr=0.9148 | fpr=0.1053 | 8878.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.14580 | acc=0.8954 | tpr=0.9158 | fpr=0.1050 | 9197.3 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.14644 | acc=0.8950 | tpr=0.9163 | fpr=0.1054 | 9212.6 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.14635 | acc=0.8949 | tpr=0.9141 | fpr=0.1054 | 9168.8 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.14615 | acc=0.8950 | tpr=0.9152 | fpr=0.1053 | 17274.0 samples/s | 67.5 steps/s
Avg test loss: 0.14610, Avg test acc: 0.89505, Avg tpr: 0.91521, Avg fpr: 0.10532, total FA: 14623

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.28367 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.184 | acc=0.7188 | 3872.6 samples/s | 60.5 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.11348 | Reg=0.00245 | L2-Norm=15.646 | L2-Norm(final)=2.170 | acc=0.8750 | 4980.2 samples/s | 77.8 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09097 | Reg=0.00247 | L2-Norm=15.724 | L2-Norm(final)=2.182 | acc=1.0000 | 4926.1 samples/s | 77.0 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.08199 | Reg=0.00249 | L2-Norm=15.765 | L2-Norm(final)=2.190 | acc=0.9219 | 4976.8 samples/s | 77.8 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07729 | Reg=0.00249 | L2-Norm=15.794 | L2-Norm(final)=2.194 | acc=0.9219 | 4512.3 samples/s | 70.5 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07525 | Reg=0.00250 | L2-Norm=15.820 | L2-Norm(final)=2.197 | acc=0.9844 | 3939.3 samples/s | 61.6 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07275 | Reg=0.00251 | L2-Norm=15.846 | L2-Norm(final)=2.202 | acc=0.9688 | 3979.6 samples/s | 62.2 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.07041 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.205 | acc=0.9844 | 3946.2 samples/s | 61.7 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06922 | Reg=0.00253 | L2-Norm=15.890 | L2-Norm(final)=2.208 | acc=0.9375 | 3924.6 samples/s | 61.3 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06829 | Reg=0.00253 | L2-Norm=15.910 | L2-Norm(final)=2.210 | acc=0.9375 | 3980.0 samples/s | 62.2 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06659 | Reg=0.00254 | L2-Norm=15.929 | L2-Norm(final)=2.212 | acc=0.9844 | 3964.3 samples/s | 61.9 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06556 | Reg=0.00254 | L2-Norm=15.948 | L2-Norm(final)=2.215 | acc=0.9531 | 3999.3 samples/s | 62.5 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06505 | Reg=0.00255 | L2-Norm=15.966 | L2-Norm(final)=2.217 | acc=0.9531 | 3966.9 samples/s | 62.0 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06438 | Reg=0.00255 | L2-Norm=15.983 | L2-Norm(final)=2.218 | acc=0.9375 | 3912.5 samples/s | 61.1 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06358 | Reg=0.00256 | L2-Norm=15.999 | L2-Norm(final)=2.220 | acc=0.9844 | 3956.5 samples/s | 61.8 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06269 | Reg=0.00256 | L2-Norm=16.015 | L2-Norm(final)=2.221 | acc=0.9219 | 3972.3 samples/s | 62.1 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06194 | Reg=0.00257 | L2-Norm=16.029 | L2-Norm(final)=2.222 | acc=0.9531 | 3982.5 samples/s | 62.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.05312 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.185 | acc=0.9688 | 3631.9 samples/s | 56.7 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01956 | Reg=0.00245 | L2-Norm=15.664 | L2-Norm(final)=2.182 | acc=1.0000 | 4659.2 samples/s | 72.8 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01164 | Reg=0.00247 | L2-Norm=15.708 | L2-Norm(final)=2.182 | acc=1.0000 | 4733.5 samples/s | 74.0 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00897 | Reg=0.00247 | L2-Norm=15.711 | L2-Norm(final)=2.184 | acc=1.0000 | 4823.6 samples/s | 75.4 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00772 | Reg=0.00247 | L2-Norm=15.704 | L2-Norm(final)=2.187 | acc=1.0000 | 4754.5 samples/s | 74.3 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00718 | Reg=0.00246 | L2-Norm=15.696 | L2-Norm(final)=2.189 | acc=0.9844 | 4814.3 samples/s | 75.2 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00747 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.187 | acc=0.9688 | 4809.8 samples/s | 75.2 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00699 | Reg=0.00246 | L2-Norm=15.694 | L2-Norm(final)=2.184 | acc=1.0000 | 4809.7 samples/s | 75.2 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00654 | Reg=0.00246 | L2-Norm=15.694 | L2-Norm(final)=2.183 | acc=1.0000 | 4763.6 samples/s | 74.4 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00591 | Reg=0.00246 | L2-Norm=15.689 | L2-Norm(final)=2.183 | acc=1.0000 | 4778.4 samples/s | 74.7 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00544 | Reg=0.00246 | L2-Norm=15.681 | L2-Norm(final)=2.183 | acc=1.0000 | 4958.8 samples/s | 77.5 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00502 | Reg=0.00246 | L2-Norm=15.670 | L2-Norm(final)=2.184 | acc=1.0000 | 1491.2 samples/s | 23.3 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00461 | Reg=0.00245 | L2-Norm=15.656 | L2-Norm(final)=2.184 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00426 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.185 | acc=1.0000 | 4750.1 samples/s | 74.2 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00397 | Reg=0.00244 | L2-Norm=15.621 | L2-Norm(final)=2.186 | acc=1.0000 | 4729.5 samples/s | 73.9 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00370 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.187 | acc=1.0000 | 4830.1 samples/s | 75.5 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00349 | Reg=0.00243 | L2-Norm=15.580 | L2-Norm(final)=2.189 | acc=1.0000 | 4801.6 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45181 | acc=0.6348 | tpr=0.4784 | fpr=0.0258 | 4515.5 samples/s | 17.6 steps/s
Avg test loss: 0.45844, Avg test acc: 0.63146, Avg tpr: 0.47578, Avg fpr: 0.02615, total FA: 204

Testing server on iccad2012
[Step=  50] | Loss=0.13898 | acc=0.9061 | tpr=0.9204 | fpr=0.0942 | 4595.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.13937 | acc=0.9057 | tpr=0.9446 | fpr=0.0951 | 9581.1 samples/s | 37.4 steps/s
[Step= 150] | Loss=0.14128 | acc=0.9044 | tpr=0.9438 | fpr=0.0964 | 9107.8 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.14088 | acc=0.9040 | tpr=0.9475 | fpr=0.0968 | 9367.8 samples/s | 36.6 steps/s
[Step= 250] | Loss=0.14130 | acc=0.9036 | tpr=0.9467 | fpr=0.0972 | 9251.1 samples/s | 36.1 steps/s
[Step= 300] | Loss=0.14149 | acc=0.9035 | tpr=0.9476 | fpr=0.0973 | 9356.6 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.14195 | acc=0.9031 | tpr=0.9480 | fpr=0.0977 | 9650.1 samples/s | 37.7 steps/s
[Step= 400] | Loss=0.14197 | acc=0.9030 | tpr=0.9491 | fpr=0.0979 | 9187.3 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.14268 | acc=0.9030 | tpr=0.9460 | fpr=0.0978 | 9258.8 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.14277 | acc=0.9028 | tpr=0.9454 | fpr=0.0979 | 9384.5 samples/s | 36.7 steps/s
[Step= 550] | Loss=0.14245 | acc=0.9029 | tpr=0.9431 | fpr=0.0978 | 17297.2 samples/s | 67.6 steps/s
Avg test loss: 0.14230, Avg test acc: 0.90292, Avg tpr: 0.94295, Avg fpr: 0.09780, total FA: 13580

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.40938 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.208 | acc=0.6719 | 3585.2 samples/s | 56.0 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.09589 | Reg=0.00239 | L2-Norm=15.473 | L2-Norm(final)=2.202 | acc=0.9688 | 4862.8 samples/s | 76.0 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.07795 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.214 | acc=0.9531 | 4870.6 samples/s | 76.1 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07461 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.219 | acc=0.9688 | 4940.5 samples/s | 77.2 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.07127 | Reg=0.00244 | L2-Norm=15.616 | L2-Norm(final)=2.222 | acc=0.9219 | 4973.6 samples/s | 77.7 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06804 | Reg=0.00245 | L2-Norm=15.645 | L2-Norm(final)=2.225 | acc=0.9531 | 4508.2 samples/s | 70.4 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06516 | Reg=0.00246 | L2-Norm=15.672 | L2-Norm(final)=2.229 | acc=0.9688 | 3942.1 samples/s | 61.6 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06425 | Reg=0.00246 | L2-Norm=15.696 | L2-Norm(final)=2.231 | acc=0.9531 | 4012.1 samples/s | 62.7 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06370 | Reg=0.00247 | L2-Norm=15.722 | L2-Norm(final)=2.232 | acc=0.9688 | 3942.4 samples/s | 61.6 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.06222 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.234 | acc=0.9375 | 4011.1 samples/s | 62.7 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.06173 | Reg=0.00249 | L2-Norm=15.770 | L2-Norm(final)=2.236 | acc=0.9844 | 3916.0 samples/s | 61.2 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.06125 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.236 | acc=1.0000 | 3993.3 samples/s | 62.4 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.06066 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.236 | acc=0.9688 | 3905.2 samples/s | 61.0 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.06029 | Reg=0.00251 | L2-Norm=15.830 | L2-Norm(final)=2.236 | acc=0.9688 | 3948.0 samples/s | 61.7 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05979 | Reg=0.00251 | L2-Norm=15.849 | L2-Norm(final)=2.237 | acc=0.9688 | 3999.5 samples/s | 62.5 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05909 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.238 | acc=1.0000 | 3958.4 samples/s | 61.8 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05865 | Reg=0.00252 | L2-Norm=15.887 | L2-Norm(final)=2.238 | acc=0.9844 | 3945.9 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.05502 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.210 | acc=0.9688 | 3703.0 samples/s | 57.9 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00897 | Reg=0.00238 | L2-Norm=15.435 | L2-Norm(final)=2.233 | acc=1.0000 | 4649.3 samples/s | 72.6 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00660 | Reg=0.00239 | L2-Norm=15.473 | L2-Norm(final)=2.234 | acc=1.0000 | 4823.6 samples/s | 75.4 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00694 | Reg=0.00240 | L2-Norm=15.488 | L2-Norm(final)=2.236 | acc=1.0000 | 4784.8 samples/s | 74.8 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00700 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.235 | acc=0.9844 | 4843.5 samples/s | 75.7 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00743 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.229 | acc=1.0000 | 4831.8 samples/s | 75.5 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00679 | Reg=0.00242 | L2-Norm=15.544 | L2-Norm(final)=2.224 | acc=1.0000 | 4904.1 samples/s | 76.6 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00611 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.223 | acc=1.0000 | 4833.3 samples/s | 75.5 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00539 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.222 | acc=1.0000 | 4720.8 samples/s | 73.8 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00509 | Reg=0.00241 | L2-Norm=15.538 | L2-Norm(final)=2.222 | acc=1.0000 | 4865.0 samples/s | 76.0 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00487 | Reg=0.00241 | L2-Norm=15.529 | L2-Norm(final)=2.222 | acc=1.0000 | 4813.6 samples/s | 75.2 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00479 | Reg=0.00241 | L2-Norm=15.522 | L2-Norm(final)=2.221 | acc=1.0000 | 1513.8 samples/s | 23.7 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00452 | Reg=0.00241 | L2-Norm=15.516 | L2-Norm(final)=2.219 | acc=1.0000 | 4939.9 samples/s | 77.2 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00421 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.218 | acc=1.0000 | 4724.0 samples/s | 73.8 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00404 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.218 | acc=1.0000 | 4837.3 samples/s | 75.6 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00414 | Reg=0.00240 | L2-Norm=15.487 | L2-Norm(final)=2.216 | acc=1.0000 | 4947.0 samples/s | 77.3 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00404 | Reg=0.00240 | L2-Norm=15.478 | L2-Norm(final)=2.214 | acc=1.0000 | 4898.9 samples/s | 76.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43311 | acc=0.6288 | tpr=0.4747 | fpr=0.0364 | 4526.5 samples/s | 17.7 steps/s
Avg test loss: 0.44154, Avg test acc: 0.62357, Avg tpr: 0.46949, Avg fpr: 0.03756, total FA: 293

Testing server on iccad2012
[Step=  50] | Loss=0.19503 | acc=0.8605 | tpr=0.9381 | fpr=0.1409 | 4552.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.19582 | acc=0.8613 | tpr=0.9574 | fpr=0.1405 | 9205.6 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.19997 | acc=0.8600 | tpr=0.9597 | fpr=0.1419 | 9128.4 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.19976 | acc=0.8600 | tpr=0.9617 | fpr=0.1419 | 9274.7 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.20029 | acc=0.8593 | tpr=0.9616 | fpr=0.1425 | 9422.9 samples/s | 36.8 steps/s
[Step= 300] | Loss=0.20000 | acc=0.8593 | tpr=0.9615 | fpr=0.1425 | 9813.8 samples/s | 38.3 steps/s
[Step= 350] | Loss=0.20073 | acc=0.8589 | tpr=0.9624 | fpr=0.1430 | 8955.7 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.20099 | acc=0.8590 | tpr=0.9628 | fpr=0.1429 | 9142.0 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.20163 | acc=0.8588 | tpr=0.9620 | fpr=0.1430 | 9263.8 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.20180 | acc=0.8585 | tpr=0.9612 | fpr=0.1433 | 8979.0 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.20126 | acc=0.8589 | tpr=0.9606 | fpr=0.1429 | 17256.9 samples/s | 67.4 steps/s
Avg test loss: 0.20109, Avg test acc: 0.85900, Avg tpr: 0.96078, Avg fpr: 0.14285, total FA: 19835

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.31390 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.203 | acc=0.6875 | 3707.5 samples/s | 57.9 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.08972 | Reg=0.00238 | L2-Norm=15.433 | L2-Norm(final)=2.202 | acc=0.9375 | 5103.2 samples/s | 79.7 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07602 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.215 | acc=1.0000 | 4909.2 samples/s | 76.7 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.06864 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.219 | acc=0.9688 | 4980.6 samples/s | 77.8 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06335 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.226 | acc=0.9688 | 5075.1 samples/s | 79.3 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06341 | Reg=0.00244 | L2-Norm=15.614 | L2-Norm(final)=2.230 | acc=1.0000 | 4969.3 samples/s | 77.6 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06158 | Reg=0.00245 | L2-Norm=15.644 | L2-Norm(final)=2.234 | acc=0.9688 | 3976.3 samples/s | 62.1 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06048 | Reg=0.00246 | L2-Norm=15.672 | L2-Norm(final)=2.234 | acc=0.9688 | 3961.5 samples/s | 61.9 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05903 | Reg=0.00246 | L2-Norm=15.697 | L2-Norm(final)=2.235 | acc=0.9688 | 3936.6 samples/s | 61.5 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05869 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.234 | acc=0.9219 | 3965.4 samples/s | 62.0 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05777 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.234 | acc=0.9531 | 4000.7 samples/s | 62.5 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05673 | Reg=0.00248 | L2-Norm=15.763 | L2-Norm(final)=2.234 | acc=1.0000 | 3960.5 samples/s | 61.9 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05573 | Reg=0.00249 | L2-Norm=15.783 | L2-Norm(final)=2.234 | acc=1.0000 | 3983.4 samples/s | 62.2 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05527 | Reg=0.00250 | L2-Norm=15.803 | L2-Norm(final)=2.235 | acc=0.9844 | 3930.2 samples/s | 61.4 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05429 | Reg=0.00250 | L2-Norm=15.822 | L2-Norm(final)=2.235 | acc=0.9688 | 3925.0 samples/s | 61.3 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05357 | Reg=0.00251 | L2-Norm=15.842 | L2-Norm(final)=2.236 | acc=1.0000 | 3998.2 samples/s | 62.5 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05314 | Reg=0.00252 | L2-Norm=15.862 | L2-Norm(final)=2.236 | acc=0.9844 | 3979.3 samples/s | 62.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.04578 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.205 | acc=0.9844 | 3751.4 samples/s | 58.6 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00911 | Reg=0.00239 | L2-Norm=15.461 | L2-Norm(final)=2.236 | acc=0.9688 | 4931.7 samples/s | 77.1 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00712 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.242 | acc=1.0000 | 4863.6 samples/s | 76.0 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00652 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.243 | acc=0.9844 | 4817.9 samples/s | 75.3 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00558 | Reg=0.00241 | L2-Norm=15.529 | L2-Norm(final)=2.239 | acc=1.0000 | 4779.1 samples/s | 74.7 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00474 | Reg=0.00241 | L2-Norm=15.526 | L2-Norm(final)=2.239 | acc=1.0000 | 4822.3 samples/s | 75.3 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00488 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.239 | acc=1.0000 | 4983.4 samples/s | 77.9 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00440 | Reg=0.00241 | L2-Norm=15.515 | L2-Norm(final)=2.238 | acc=1.0000 | 4714.9 samples/s | 73.7 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00395 | Reg=0.00240 | L2-Norm=15.508 | L2-Norm(final)=2.240 | acc=1.0000 | 4828.2 samples/s | 75.4 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00370 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.242 | acc=1.0000 | 4776.3 samples/s | 74.6 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00350 | Reg=0.00240 | L2-Norm=15.490 | L2-Norm(final)=2.244 | acc=1.0000 | 4862.2 samples/s | 76.0 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00328 | Reg=0.00240 | L2-Norm=15.481 | L2-Norm(final)=2.246 | acc=1.0000 | 1555.9 samples/s | 24.3 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00305 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.248 | acc=1.0000 | 4876.9 samples/s | 76.2 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00285 | Reg=0.00239 | L2-Norm=15.461 | L2-Norm(final)=2.251 | acc=1.0000 | 4828.9 samples/s | 75.5 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00267 | Reg=0.00239 | L2-Norm=15.449 | L2-Norm(final)=2.253 | acc=1.0000 | 4820.4 samples/s | 75.3 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00249 | Reg=0.00238 | L2-Norm=15.435 | L2-Norm(final)=2.256 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00234 | Reg=0.00238 | L2-Norm=15.420 | L2-Norm(final)=2.259 | acc=1.0000 | 4785.7 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40015 | acc=0.6941 | tpr=0.5664 | fpr=0.0285 | 4525.1 samples/s | 17.7 steps/s
Avg test loss: 0.41092, Avg test acc: 0.68760, Avg tpr: 0.55796, Avg fpr: 0.02730, total FA: 213

Testing server on iccad2012
[Step=  50] | Loss=0.18450 | acc=0.8821 | tpr=0.9336 | fpr=0.1188 | 4657.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.18451 | acc=0.8842 | tpr=0.9574 | fpr=0.1171 | 8880.8 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.18706 | acc=0.8837 | tpr=0.9597 | fpr=0.1177 | 9866.1 samples/s | 38.5 steps/s
[Step= 200] | Loss=0.18701 | acc=0.8838 | tpr=0.9552 | fpr=0.1175 | 8908.4 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.18728 | acc=0.8829 | tpr=0.9537 | fpr=0.1184 | 9433.8 samples/s | 36.9 steps/s
[Step= 300] | Loss=0.18784 | acc=0.8831 | tpr=0.9513 | fpr=0.1182 | 9091.8 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.18854 | acc=0.8829 | tpr=0.9512 | fpr=0.1184 | 9165.3 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.18884 | acc=0.8826 | tpr=0.9508 | fpr=0.1186 | 9273.0 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.19002 | acc=0.8821 | tpr=0.9513 | fpr=0.1192 | 9185.0 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.18979 | acc=0.8821 | tpr=0.9524 | fpr=0.1192 | 9139.7 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.18914 | acc=0.8822 | tpr=0.9507 | fpr=0.1190 | 17696.2 samples/s | 69.1 steps/s
Avg test loss: 0.18893, Avg test acc: 0.88231, Avg tpr: 0.95087, Avg fpr: 0.11894, total FA: 16514

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.20031 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.263 | acc=0.8281 | 3617.7 samples/s | 56.5 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.07823 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.250 | acc=0.9531 | 4929.5 samples/s | 77.0 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06697 | Reg=0.00238 | L2-Norm=15.418 | L2-Norm(final)=2.256 | acc=0.9531 | 5082.9 samples/s | 79.4 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06185 | Reg=0.00239 | L2-Norm=15.456 | L2-Norm(final)=2.259 | acc=0.9844 | 5082.6 samples/s | 79.4 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05944 | Reg=0.00240 | L2-Norm=15.491 | L2-Norm(final)=2.262 | acc=0.9688 | 4887.2 samples/s | 76.4 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05698 | Reg=0.00241 | L2-Norm=15.526 | L2-Norm(final)=2.264 | acc=0.9531 | 5073.6 samples/s | 79.3 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05525 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.266 | acc=0.9531 | 4906.6 samples/s | 76.7 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05402 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.267 | acc=0.9531 | 5121.3 samples/s | 80.0 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05312 | Reg=0.00244 | L2-Norm=15.618 | L2-Norm(final)=2.268 | acc=0.9375 | 5073.6 samples/s | 79.3 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05223 | Reg=0.00245 | L2-Norm=15.644 | L2-Norm(final)=2.268 | acc=1.0000 | 4201.0 samples/s | 65.6 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05179 | Reg=0.00246 | L2-Norm=15.668 | L2-Norm(final)=2.267 | acc=0.9688 | 3988.7 samples/s | 62.3 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05125 | Reg=0.00246 | L2-Norm=15.692 | L2-Norm(final)=2.267 | acc=0.9844 | 3978.4 samples/s | 62.2 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05088 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.267 | acc=0.9531 | 3980.1 samples/s | 62.2 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.05071 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.266 | acc=0.9844 | 3919.6 samples/s | 61.2 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04994 | Reg=0.00249 | L2-Norm=15.767 | L2-Norm(final)=2.265 | acc=0.9688 | 3923.2 samples/s | 61.3 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04948 | Reg=0.00249 | L2-Norm=15.790 | L2-Norm(final)=2.264 | acc=0.9375 | 3961.2 samples/s | 61.9 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04898 | Reg=0.00250 | L2-Norm=15.812 | L2-Norm(final)=2.264 | acc=0.9219 | 3937.7 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.02725 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.263 | acc=0.9844 | 2972.1 samples/s | 46.4 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.01070 | Reg=0.00237 | L2-Norm=15.407 | L2-Norm(final)=2.283 | acc=1.0000 | 4500.7 samples/s | 70.3 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00740 | Reg=0.00240 | L2-Norm=15.485 | L2-Norm(final)=2.281 | acc=1.0000 | 4919.9 samples/s | 76.9 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00770 | Reg=0.00242 | L2-Norm=15.542 | L2-Norm(final)=2.275 | acc=1.0000 | 4664.3 samples/s | 72.9 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00724 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.267 | acc=1.0000 | 4904.3 samples/s | 76.6 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00643 | Reg=0.00244 | L2-Norm=15.610 | L2-Norm(final)=2.261 | acc=1.0000 | 4777.5 samples/s | 74.6 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00583 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.257 | acc=1.0000 | 4855.4 samples/s | 75.9 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00526 | Reg=0.00245 | L2-Norm=15.637 | L2-Norm(final)=2.254 | acc=1.0000 | 4815.9 samples/s | 75.2 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00468 | Reg=0.00245 | L2-Norm=15.641 | L2-Norm(final)=2.253 | acc=1.0000 | 4767.1 samples/s | 74.5 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00426 | Reg=0.00245 | L2-Norm=15.638 | L2-Norm(final)=2.252 | acc=1.0000 | 4834.6 samples/s | 75.5 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00389 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.252 | acc=1.0000 | 4746.6 samples/s | 74.2 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00358 | Reg=0.00244 | L2-Norm=15.625 | L2-Norm(final)=2.253 | acc=1.0000 | 1496.6 samples/s | 23.4 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00332 | Reg=0.00244 | L2-Norm=15.616 | L2-Norm(final)=2.254 | acc=1.0000 | 4905.9 samples/s | 76.7 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00311 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.255 | acc=1.0000 | 4689.1 samples/s | 73.3 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00289 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.257 | acc=1.0000 | 4801.5 samples/s | 75.0 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00270 | Reg=0.00243 | L2-Norm=15.577 | L2-Norm(final)=2.258 | acc=1.0000 | 4763.1 samples/s | 74.4 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00254 | Reg=0.00242 | L2-Norm=15.561 | L2-Norm(final)=2.259 | acc=1.0000 | 4763.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49410 | acc=0.6392 | tpr=0.4868 | fpr=0.0297 | 4602.9 samples/s | 18.0 steps/s
Avg test loss: 0.50529, Avg test acc: 0.63539, Avg tpr: 0.48231, Avg fpr: 0.02795, total FA: 218

Testing server on iccad2012
[Step=  50] | Loss=0.16367 | acc=0.9044 | tpr=0.9513 | fpr=0.0965 | 4569.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.16782 | acc=0.9034 | tpr=0.9616 | fpr=0.0977 | 9248.0 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.17180 | acc=0.9009 | tpr=0.9597 | fpr=0.1001 | 9274.8 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.17162 | acc=0.9013 | tpr=0.9639 | fpr=0.0998 | 9245.2 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.17186 | acc=0.9007 | tpr=0.9642 | fpr=0.1005 | 9613.1 samples/s | 37.6 steps/s
[Step= 300] | Loss=0.17292 | acc=0.9007 | tpr=0.9644 | fpr=0.1004 | 9044.1 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.17311 | acc=0.9004 | tpr=0.9637 | fpr=0.1008 | 9467.3 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.17401 | acc=0.9001 | tpr=0.9623 | fpr=0.1010 | 8814.2 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.17541 | acc=0.8994 | tpr=0.9630 | fpr=0.1018 | 9223.4 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.17496 | acc=0.8995 | tpr=0.9621 | fpr=0.1017 | 9400.6 samples/s | 36.7 steps/s
[Step= 550] | Loss=0.17449 | acc=0.8994 | tpr=0.9598 | fpr=0.1017 | 16827.4 samples/s | 65.7 steps/s
Avg test loss: 0.17427, Avg test acc: 0.89945, Avg tpr: 0.95998, Avg fpr: 0.10165, total FA: 14114

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.48958 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.259 | acc=0.6406 | 3695.9 samples/s | 57.7 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.09639 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.227 | acc=0.9375 | 4800.9 samples/s | 75.0 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.07372 | Reg=0.00243 | L2-Norm=15.579 | L2-Norm(final)=2.239 | acc=0.9531 | 5024.7 samples/s | 78.5 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.06620 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.246 | acc=0.9688 | 4945.7 samples/s | 77.3 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.06227 | Reg=0.00245 | L2-Norm=15.658 | L2-Norm(final)=2.251 | acc=0.9531 | 4916.6 samples/s | 76.8 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05941 | Reg=0.00246 | L2-Norm=15.690 | L2-Norm(final)=2.256 | acc=0.9688 | 5007.8 samples/s | 78.2 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05682 | Reg=0.00247 | L2-Norm=15.722 | L2-Norm(final)=2.261 | acc=0.9844 | 5107.0 samples/s | 79.8 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05514 | Reg=0.00248 | L2-Norm=15.752 | L2-Norm(final)=2.266 | acc=0.9375 | 5057.7 samples/s | 79.0 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.05386 | Reg=0.00249 | L2-Norm=15.778 | L2-Norm(final)=2.267 | acc=0.9844 | 4993.0 samples/s | 78.0 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.05312 | Reg=0.00250 | L2-Norm=15.802 | L2-Norm(final)=2.268 | acc=1.0000 | 4917.8 samples/s | 76.8 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.05181 | Reg=0.00250 | L2-Norm=15.824 | L2-Norm(final)=2.269 | acc=0.9688 | 5076.4 samples/s | 79.3 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.05063 | Reg=0.00251 | L2-Norm=15.846 | L2-Norm(final)=2.270 | acc=0.9688 | 4970.5 samples/s | 77.7 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.05002 | Reg=0.00252 | L2-Norm=15.866 | L2-Norm(final)=2.270 | acc=0.9844 | 5065.2 samples/s | 79.1 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04980 | Reg=0.00252 | L2-Norm=15.887 | L2-Norm(final)=2.270 | acc=0.9844 | 4992.4 samples/s | 78.0 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04932 | Reg=0.00253 | L2-Norm=15.909 | L2-Norm(final)=2.270 | acc=0.9844 | 5011.0 samples/s | 78.3 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04890 | Reg=0.00254 | L2-Norm=15.931 | L2-Norm(final)=2.271 | acc=1.0000 | 5109.0 samples/s | 79.8 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04838 | Reg=0.00255 | L2-Norm=15.953 | L2-Norm(final)=2.271 | acc=0.9531 | 4932.6 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.01483 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.262 | acc=1.0000 | 3917.1 samples/s | 61.2 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00894 | Reg=0.00239 | L2-Norm=15.461 | L2-Norm(final)=2.266 | acc=1.0000 | 4565.5 samples/s | 71.3 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00648 | Reg=0.00241 | L2-Norm=15.521 | L2-Norm(final)=2.264 | acc=1.0000 | 4883.4 samples/s | 76.3 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00478 | Reg=0.00241 | L2-Norm=15.529 | L2-Norm(final)=2.264 | acc=1.0000 | 4986.1 samples/s | 77.9 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00429 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.265 | acc=1.0000 | 4701.2 samples/s | 73.5 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00445 | Reg=0.00241 | L2-Norm=15.529 | L2-Norm(final)=2.262 | acc=1.0000 | 4877.1 samples/s | 76.2 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00504 | Reg=0.00241 | L2-Norm=15.538 | L2-Norm(final)=2.255 | acc=1.0000 | 4763.2 samples/s | 74.4 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00444 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.249 | acc=1.0000 | 4879.9 samples/s | 76.2 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00405 | Reg=0.00242 | L2-Norm=15.551 | L2-Norm(final)=2.245 | acc=1.0000 | 4785.6 samples/s | 74.8 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00366 | Reg=0.00242 | L2-Norm=15.550 | L2-Norm(final)=2.243 | acc=1.0000 | 4794.3 samples/s | 74.9 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00332 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.243 | acc=1.0000 | 4965.3 samples/s | 77.6 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00312 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.242 | acc=1.0000 | 1471.6 samples/s | 23.0 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00287 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.242 | acc=1.0000 | 4951.7 samples/s | 77.4 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00265 | Reg=0.00241 | L2-Norm=15.515 | L2-Norm(final)=2.243 | acc=1.0000 | 4863.8 samples/s | 76.0 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00247 | Reg=0.00240 | L2-Norm=15.501 | L2-Norm(final)=2.244 | acc=1.0000 | 4806.0 samples/s | 75.1 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00230 | Reg=0.00240 | L2-Norm=15.485 | L2-Norm(final)=2.245 | acc=1.0000 | 4685.1 samples/s | 73.2 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00225 | Reg=0.00239 | L2-Norm=15.469 | L2-Norm(final)=2.246 | acc=1.0000 | 4748.5 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43190 | acc=0.6718 | tpr=0.5359 | fpr=0.0332 | 4562.9 samples/s | 17.8 steps/s
Avg test loss: 0.43862, Avg test acc: 0.67089, Avg tpr: 0.53541, Avg fpr: 0.03115, total FA: 243

Testing server on iccad2012
[Step=  50] | Loss=0.16053 | acc=0.9045 | tpr=0.9558 | fpr=0.0964 | 4559.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.16102 | acc=0.9070 | tpr=0.9659 | fpr=0.0941 | 9548.7 samples/s | 37.3 steps/s
[Step= 150] | Loss=0.16635 | acc=0.9048 | tpr=0.9669 | fpr=0.0964 | 9068.2 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.16553 | acc=0.9054 | tpr=0.9716 | fpr=0.0959 | 9550.9 samples/s | 37.3 steps/s
[Step= 250] | Loss=0.16503 | acc=0.9056 | tpr=0.9712 | fpr=0.0956 | 9104.1 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.16625 | acc=0.9059 | tpr=0.9702 | fpr=0.0953 | 9317.7 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.16648 | acc=0.9060 | tpr=0.9693 | fpr=0.0952 | 9011.7 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.16682 | acc=0.9055 | tpr=0.9683 | fpr=0.0956 | 9433.0 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.16833 | acc=0.9048 | tpr=0.9684 | fpr=0.0964 | 8751.4 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.16775 | acc=0.9048 | tpr=0.9692 | fpr=0.0964 | 9090.6 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.16721 | acc=0.9049 | tpr=0.9694 | fpr=0.0962 | 17009.3 samples/s | 66.4 steps/s
Avg test loss: 0.16708, Avg test acc: 0.90495, Avg tpr: 0.96910, Avg fpr: 0.09621, total FA: 13359

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.33570 | Reg=0.00236 | L2-Norm=15.372 | L2-Norm(final)=2.257 | acc=0.7031 | 3558.6 samples/s | 55.6 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.07903 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.250 | acc=0.9844 | 4992.5 samples/s | 78.0 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.06542 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.262 | acc=0.9375 | 4878.5 samples/s | 76.2 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05945 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.265 | acc=0.9844 | 4024.5 samples/s | 62.9 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05402 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.268 | acc=0.9688 | 3914.0 samples/s | 61.2 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05180 | Reg=0.00248 | L2-Norm=15.734 | L2-Norm(final)=2.271 | acc=0.9688 | 3927.0 samples/s | 61.4 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04982 | Reg=0.00249 | L2-Norm=15.766 | L2-Norm(final)=2.273 | acc=0.9844 | 3961.3 samples/s | 61.9 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04906 | Reg=0.00249 | L2-Norm=15.794 | L2-Norm(final)=2.275 | acc=0.9531 | 3905.3 samples/s | 61.0 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04848 | Reg=0.00250 | L2-Norm=15.820 | L2-Norm(final)=2.275 | acc=0.9844 | 3947.5 samples/s | 61.7 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04796 | Reg=0.00251 | L2-Norm=15.845 | L2-Norm(final)=2.275 | acc=0.9688 | 3932.7 samples/s | 61.4 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04725 | Reg=0.00252 | L2-Norm=15.870 | L2-Norm(final)=2.274 | acc=0.9531 | 3965.9 samples/s | 62.0 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04638 | Reg=0.00253 | L2-Norm=15.894 | L2-Norm(final)=2.274 | acc=0.9844 | 3912.5 samples/s | 61.1 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04567 | Reg=0.00253 | L2-Norm=15.917 | L2-Norm(final)=2.274 | acc=0.9688 | 3949.6 samples/s | 61.7 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04518 | Reg=0.00254 | L2-Norm=15.940 | L2-Norm(final)=2.275 | acc=0.9375 | 3999.0 samples/s | 62.5 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04522 | Reg=0.00255 | L2-Norm=15.962 | L2-Norm(final)=2.274 | acc=0.9844 | 3930.7 samples/s | 61.4 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04526 | Reg=0.00256 | L2-Norm=15.985 | L2-Norm(final)=2.273 | acc=0.9844 | 3985.5 samples/s | 62.3 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04498 | Reg=0.00256 | L2-Norm=16.009 | L2-Norm(final)=2.273 | acc=0.9688 | 3942.0 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.09546 | Reg=0.00236 | L2-Norm=15.372 | L2-Norm(final)=2.257 | acc=0.9219 | 3648.7 samples/s | 57.0 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00639 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.266 | acc=1.0000 | 4768.3 samples/s | 74.5 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00597 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.263 | acc=1.0000 | 4922.4 samples/s | 76.9 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00645 | Reg=0.00244 | L2-Norm=15.619 | L2-Norm(final)=2.257 | acc=1.0000 | 4828.0 samples/s | 75.4 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00501 | Reg=0.00244 | L2-Norm=15.636 | L2-Norm(final)=2.258 | acc=1.0000 | 4775.5 samples/s | 74.6 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00406 | Reg=0.00245 | L2-Norm=15.638 | L2-Norm(final)=2.262 | acc=1.0000 | 4868.7 samples/s | 76.1 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00354 | Reg=0.00244 | L2-Norm=15.630 | L2-Norm(final)=2.266 | acc=1.0000 | 4766.9 samples/s | 74.5 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00307 | Reg=0.00244 | L2-Norm=15.619 | L2-Norm(final)=2.270 | acc=1.0000 | 4853.1 samples/s | 75.8 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00270 | Reg=0.00243 | L2-Norm=15.604 | L2-Norm(final)=2.274 | acc=1.0000 | 4730.4 samples/s | 73.9 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00240 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.277 | acc=1.0000 | 4625.0 samples/s | 72.3 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00231 | Reg=0.00242 | L2-Norm=15.566 | L2-Norm(final)=2.280 | acc=1.0000 | 4801.7 samples/s | 75.0 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00232 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.283 | acc=1.0000 | 1490.3 samples/s | 23.3 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00245 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.284 | acc=1.0000 | 4780.7 samples/s | 74.7 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00240 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.284 | acc=1.0000 | 4737.3 samples/s | 74.0 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00248 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.283 | acc=1.0000 | 4908.6 samples/s | 76.7 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00239 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.281 | acc=1.0000 | 4861.9 samples/s | 76.0 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00229 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.281 | acc=1.0000 | 4831.9 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44408 | acc=0.6415 | tpr=0.4928 | fpr=0.0357 | 4205.9 samples/s | 16.4 steps/s
Avg test loss: 0.44929, Avg test acc: 0.63875, Avg tpr: 0.48983, Avg fpr: 0.03371, total FA: 263

Testing server on iccad2012
[Step=  50] | Loss=0.16405 | acc=0.9127 | tpr=0.9602 | fpr=0.0882 | 4531.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.16718 | acc=0.9133 | tpr=0.9723 | fpr=0.0878 | 9276.8 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.17170 | acc=0.9120 | tpr=0.9726 | fpr=0.0891 | 9324.9 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.17148 | acc=0.9125 | tpr=0.9749 | fpr=0.0887 | 9329.2 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.17068 | acc=0.9131 | tpr=0.9721 | fpr=0.0879 | 9464.7 samples/s | 37.0 steps/s
[Step= 300] | Loss=0.17254 | acc=0.9126 | tpr=0.9709 | fpr=0.0885 | 9445.3 samples/s | 36.9 steps/s
[Step= 350] | Loss=0.17349 | acc=0.9127 | tpr=0.9706 | fpr=0.0883 | 9335.7 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.17411 | acc=0.9126 | tpr=0.9683 | fpr=0.0884 | 9110.5 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.17570 | acc=0.9124 | tpr=0.9684 | fpr=0.0886 | 9199.2 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.17494 | acc=0.9123 | tpr=0.9696 | fpr=0.0888 | 9140.6 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.17420 | acc=0.9123 | tpr=0.9698 | fpr=0.0887 | 16679.3 samples/s | 65.2 steps/s
Avg test loss: 0.17405, Avg test acc: 0.91239, Avg tpr: 0.96989, Avg fpr: 0.08865, total FA: 12309

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.35290 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.265 | acc=0.7188 | 3869.5 samples/s | 60.5 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.07192 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.264 | acc=0.9375 | 4671.8 samples/s | 73.0 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.06309 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.271 | acc=0.9688 | 4993.6 samples/s | 78.0 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.05463 | Reg=0.00249 | L2-Norm=15.788 | L2-Norm(final)=2.278 | acc=0.9531 | 4987.8 samples/s | 77.9 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.05020 | Reg=0.00250 | L2-Norm=15.826 | L2-Norm(final)=2.285 | acc=0.9844 | 4937.6 samples/s | 77.1 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04960 | Reg=0.00251 | L2-Norm=15.856 | L2-Norm(final)=2.287 | acc=0.9844 | 4920.2 samples/s | 76.9 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04801 | Reg=0.00252 | L2-Norm=15.883 | L2-Norm(final)=2.289 | acc=1.0000 | 5055.2 samples/s | 79.0 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04710 | Reg=0.00253 | L2-Norm=15.911 | L2-Norm(final)=2.291 | acc=0.9531 | 5166.0 samples/s | 80.7 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04657 | Reg=0.00254 | L2-Norm=15.937 | L2-Norm(final)=2.293 | acc=0.9688 | 4937.0 samples/s | 77.1 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04542 | Reg=0.00255 | L2-Norm=15.963 | L2-Norm(final)=2.293 | acc=0.9688 | 5030.1 samples/s | 78.6 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04484 | Reg=0.00256 | L2-Norm=15.987 | L2-Norm(final)=2.293 | acc=0.9688 | 5027.7 samples/s | 78.6 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04429 | Reg=0.00256 | L2-Norm=16.012 | L2-Norm(final)=2.293 | acc=0.9688 | 4601.5 samples/s | 71.9 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04400 | Reg=0.00257 | L2-Norm=16.035 | L2-Norm(final)=2.293 | acc=0.9688 | 3927.4 samples/s | 61.4 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04305 | Reg=0.00258 | L2-Norm=16.058 | L2-Norm(final)=2.294 | acc=1.0000 | 4020.6 samples/s | 62.8 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04325 | Reg=0.00259 | L2-Norm=16.078 | L2-Norm(final)=2.295 | acc=0.9375 | 3942.2 samples/s | 61.6 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04303 | Reg=0.00259 | L2-Norm=16.099 | L2-Norm(final)=2.294 | acc=0.9688 | 3921.1 samples/s | 61.3 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04291 | Reg=0.00260 | L2-Norm=16.119 | L2-Norm(final)=2.294 | acc=0.9688 | 3926.3 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.01638 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.268 | acc=1.0000 | 2961.6 samples/s | 46.3 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00374 | Reg=0.00243 | L2-Norm=15.596 | L2-Norm(final)=2.295 | acc=1.0000 | 4470.4 samples/s | 69.9 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00270 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.303 | acc=1.0000 | 4872.6 samples/s | 76.1 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00327 | Reg=0.00244 | L2-Norm=15.613 | L2-Norm(final)=2.303 | acc=1.0000 | 4740.1 samples/s | 74.1 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00290 | Reg=0.00244 | L2-Norm=15.632 | L2-Norm(final)=2.301 | acc=0.9844 | 4844.6 samples/s | 75.7 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00258 | Reg=0.00245 | L2-Norm=15.641 | L2-Norm(final)=2.300 | acc=1.0000 | 4763.7 samples/s | 74.4 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00223 | Reg=0.00245 | L2-Norm=15.645 | L2-Norm(final)=2.303 | acc=1.0000 | 4746.0 samples/s | 74.2 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00193 | Reg=0.00245 | L2-Norm=15.643 | L2-Norm(final)=2.306 | acc=1.0000 | 4912.3 samples/s | 76.8 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00244 | Reg=0.00244 | L2-Norm=15.636 | L2-Norm(final)=2.306 | acc=1.0000 | 4958.2 samples/s | 77.5 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00239 | Reg=0.00244 | L2-Norm=15.635 | L2-Norm(final)=2.303 | acc=1.0000 | 4778.3 samples/s | 74.7 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00236 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.300 | acc=1.0000 | 4995.6 samples/s | 78.1 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00243 | Reg=0.00244 | L2-Norm=15.632 | L2-Norm(final)=2.297 | acc=1.0000 | 1613.4 samples/s | 25.2 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00261 | Reg=0.00244 | L2-Norm=15.635 | L2-Norm(final)=2.294 | acc=1.0000 | 4987.7 samples/s | 77.9 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00246 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.291 | acc=1.0000 | 4800.8 samples/s | 75.0 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00240 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.288 | acc=1.0000 | 4826.5 samples/s | 75.4 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00237 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.285 | acc=1.0000 | 4877.9 samples/s | 76.2 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00222 | Reg=0.00245 | L2-Norm=15.638 | L2-Norm(final)=2.282 | acc=1.0000 | 4886.7 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31660 | acc=0.7426 | tpr=0.6475 | fpr=0.0510 | 4391.1 samples/s | 17.2 steps/s
Avg test loss: 0.31974, Avg test acc: 0.74088, Avg tpr: 0.64528, Avg fpr: 0.04884, total FA: 381

Testing server on iccad2012
[Step=  50] | Loss=0.25211 | acc=0.8627 | tpr=0.9602 | fpr=0.1390 | 4549.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.25622 | acc=0.8637 | tpr=0.9787 | fpr=0.1385 | 9636.9 samples/s | 37.6 steps/s
[Step= 150] | Loss=0.26045 | acc=0.8639 | tpr=0.9841 | fpr=0.1383 | 8913.5 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.26030 | acc=0.8641 | tpr=0.9825 | fpr=0.1380 | 9276.7 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.25978 | acc=0.8638 | tpr=0.9817 | fpr=0.1383 | 9246.5 samples/s | 36.1 steps/s
[Step= 300] | Loss=0.26149 | acc=0.8636 | tpr=0.9811 | fpr=0.1385 | 9274.5 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.26270 | acc=0.8637 | tpr=0.9800 | fpr=0.1384 | 9316.5 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.26332 | acc=0.8638 | tpr=0.9792 | fpr=0.1383 | 9202.2 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.26517 | acc=0.8635 | tpr=0.9805 | fpr=0.1387 | 9023.2 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.26460 | acc=0.8633 | tpr=0.9811 | fpr=0.1389 | 9066.5 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.26339 | acc=0.8637 | tpr=0.9817 | fpr=0.1385 | 17636.4 samples/s | 68.9 steps/s
Avg test loss: 0.26324, Avg test acc: 0.86379, Avg tpr: 0.98177, Avg fpr: 0.13835, total FA: 19210

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.29788 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.255 | acc=0.7969 | 4042.3 samples/s | 63.2 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.08007 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.254 | acc=0.9062 | 4903.3 samples/s | 76.6 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.05956 | Reg=0.00246 | L2-Norm=15.684 | L2-Norm(final)=2.267 | acc=0.9688 | 4854.0 samples/s | 75.8 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.05078 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.277 | acc=0.9531 | 5009.0 samples/s | 78.3 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04634 | Reg=0.00247 | L2-Norm=15.718 | L2-Norm(final)=2.286 | acc=0.9688 | 5036.7 samples/s | 78.7 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04245 | Reg=0.00247 | L2-Norm=15.732 | L2-Norm(final)=2.294 | acc=1.0000 | 4437.7 samples/s | 69.3 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03993 | Reg=0.00248 | L2-Norm=15.744 | L2-Norm(final)=2.302 | acc=0.9688 | 3919.6 samples/s | 61.2 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03949 | Reg=0.00248 | L2-Norm=15.755 | L2-Norm(final)=2.306 | acc=1.0000 | 3979.5 samples/s | 62.2 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03836 | Reg=0.00249 | L2-Norm=15.764 | L2-Norm(final)=2.311 | acc=0.9844 | 3943.5 samples/s | 61.6 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03754 | Reg=0.00249 | L2-Norm=15.772 | L2-Norm(final)=2.313 | acc=0.9688 | 3957.0 samples/s | 61.8 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03689 | Reg=0.00249 | L2-Norm=15.780 | L2-Norm(final)=2.316 | acc=0.9375 | 3946.3 samples/s | 61.7 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03622 | Reg=0.00249 | L2-Norm=15.787 | L2-Norm(final)=2.319 | acc=1.0000 | 3965.8 samples/s | 62.0 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03545 | Reg=0.00249 | L2-Norm=15.794 | L2-Norm(final)=2.321 | acc=0.9844 | 3911.5 samples/s | 61.1 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03528 | Reg=0.00250 | L2-Norm=15.800 | L2-Norm(final)=2.323 | acc=0.9844 | 3950.6 samples/s | 61.7 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03465 | Reg=0.00250 | L2-Norm=15.807 | L2-Norm(final)=2.324 | acc=1.0000 | 3936.6 samples/s | 61.5 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03398 | Reg=0.00250 | L2-Norm=15.813 | L2-Norm(final)=2.327 | acc=0.9844 | 3996.9 samples/s | 62.5 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03369 | Reg=0.00250 | L2-Norm=15.819 | L2-Norm(final)=2.329 | acc=0.9375 | 3952.5 samples/s | 61.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.07796 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.255 | acc=0.9219 | 2900.4 samples/s | 45.3 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00616 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.259 | acc=1.0000 | 4732.9 samples/s | 74.0 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00330 | Reg=0.00246 | L2-Norm=15.682 | L2-Norm(final)=2.265 | acc=1.0000 | 4772.2 samples/s | 74.6 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00225 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.269 | acc=1.0000 | 4800.7 samples/s | 75.0 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00174 | Reg=0.00245 | L2-Norm=15.665 | L2-Norm(final)=2.272 | acc=1.0000 | 4912.9 samples/s | 76.8 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00141 | Reg=0.00245 | L2-Norm=15.653 | L2-Norm(final)=2.275 | acc=1.0000 | 4804.0 samples/s | 75.1 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00119 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.277 | acc=1.0000 | 4890.9 samples/s | 76.4 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00103 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.279 | acc=1.0000 | 4804.0 samples/s | 75.1 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00090 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.281 | acc=1.0000 | 4922.6 samples/s | 76.9 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00080 | Reg=0.00243 | L2-Norm=15.598 | L2-Norm(final)=2.283 | acc=1.0000 | 4739.9 samples/s | 74.1 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00073 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.284 | acc=1.0000 | 4847.0 samples/s | 75.7 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00067 | Reg=0.00242 | L2-Norm=15.569 | L2-Norm(final)=2.285 | acc=1.0000 | 1488.2 samples/s | 23.3 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00061 | Reg=0.00242 | L2-Norm=15.555 | L2-Norm(final)=2.287 | acc=1.0000 | 4902.4 samples/s | 76.6 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00057 | Reg=0.00241 | L2-Norm=15.540 | L2-Norm(final)=2.288 | acc=1.0000 | 4788.1 samples/s | 74.8 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00053 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.289 | acc=1.0000 | 4828.5 samples/s | 75.4 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00049 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.290 | acc=1.0000 | 4853.6 samples/s | 75.8 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00046 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.291 | acc=1.0000 | 4954.2 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34547 | acc=0.7526 | tpr=0.6476 | fpr=0.0196 | 4513.6 samples/s | 17.6 steps/s
Avg test loss: 0.35150, Avg test acc: 0.75034, Avg tpr: 0.64615, Avg fpr: 0.02051, total FA: 160

Testing server on iccad2012
[Step=  50] | Loss=0.25152 | acc=0.8798 | tpr=0.9558 | fpr=0.1215 | 4505.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.25326 | acc=0.8825 | tpr=0.9744 | fpr=0.1193 | 9633.0 samples/s | 37.6 steps/s
[Step= 150] | Loss=0.25763 | acc=0.8820 | tpr=0.9784 | fpr=0.1198 | 9219.1 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.25784 | acc=0.8824 | tpr=0.9792 | fpr=0.1194 | 9119.9 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.25722 | acc=0.8825 | tpr=0.9790 | fpr=0.1193 | 9988.0 samples/s | 39.0 steps/s
[Step= 300] | Loss=0.25892 | acc=0.8826 | tpr=0.9775 | fpr=0.1191 | 8910.2 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.26053 | acc=0.8823 | tpr=0.9762 | fpr=0.1194 | 9210.3 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.26134 | acc=0.8823 | tpr=0.9748 | fpr=0.1194 | 9166.8 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.26365 | acc=0.8819 | tpr=0.9761 | fpr=0.1198 | 9333.4 samples/s | 36.5 steps/s
[Step= 500] | Loss=0.26255 | acc=0.8819 | tpr=0.9762 | fpr=0.1198 | 9011.7 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.26110 | acc=0.8825 | tpr=0.9769 | fpr=0.1192 | 17794.4 samples/s | 69.5 steps/s
Avg test loss: 0.26081, Avg test acc: 0.88264, Avg tpr: 0.97702, Avg fpr: 0.11908, total FA: 16534

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.24150 | Reg=0.00239 | L2-Norm=15.452 | L2-Norm(final)=2.324 | acc=0.8125 | 3743.5 samples/s | 58.5 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04314 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.333 | acc=0.9844 | 4788.1 samples/s | 74.8 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03686 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.343 | acc=0.9688 | 5056.0 samples/s | 79.0 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03259 | Reg=0.00242 | L2-Norm=15.552 | L2-Norm(final)=2.351 | acc=1.0000 | 5095.4 samples/s | 79.6 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03070 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.358 | acc=0.9844 | 5073.9 samples/s | 79.3 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03042 | Reg=0.00243 | L2-Norm=15.575 | L2-Norm(final)=2.363 | acc=0.9688 | 4973.3 samples/s | 77.7 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02864 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.368 | acc=0.9688 | 4929.2 samples/s | 77.0 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02847 | Reg=0.00243 | L2-Norm=15.595 | L2-Norm(final)=2.373 | acc=0.9688 | 4914.4 samples/s | 76.8 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02783 | Reg=0.00243 | L2-Norm=15.604 | L2-Norm(final)=2.376 | acc=0.9688 | 3965.7 samples/s | 62.0 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02762 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.378 | acc=0.9844 | 3930.5 samples/s | 61.4 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02744 | Reg=0.00244 | L2-Norm=15.620 | L2-Norm(final)=2.381 | acc=0.9688 | 3941.1 samples/s | 61.6 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02698 | Reg=0.00244 | L2-Norm=15.629 | L2-Norm(final)=2.383 | acc=0.9844 | 3929.1 samples/s | 61.4 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02740 | Reg=0.00245 | L2-Norm=15.636 | L2-Norm(final)=2.385 | acc=0.9844 | 4003.0 samples/s | 62.5 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02711 | Reg=0.00245 | L2-Norm=15.644 | L2-Norm(final)=2.387 | acc=1.0000 | 3917.0 samples/s | 61.2 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02697 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.388 | acc=0.9844 | 3933.3 samples/s | 61.5 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02691 | Reg=0.00245 | L2-Norm=15.659 | L2-Norm(final)=2.390 | acc=1.0000 | 3965.5 samples/s | 62.0 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02695 | Reg=0.00245 | L2-Norm=15.667 | L2-Norm(final)=2.392 | acc=0.9844 | 3925.3 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.07621 | Reg=0.00239 | L2-Norm=15.452 | L2-Norm(final)=2.323 | acc=0.9219 | 2761.1 samples/s | 43.1 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00415 | Reg=0.00241 | L2-Norm=15.513 | L2-Norm(final)=2.331 | acc=1.0000 | 4847.4 samples/s | 75.7 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00262 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.336 | acc=1.0000 | 4755.4 samples/s | 74.3 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00205 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.340 | acc=1.0000 | 4687.4 samples/s | 73.2 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00166 | Reg=0.00241 | L2-Norm=15.533 | L2-Norm(final)=2.343 | acc=1.0000 | 4696.6 samples/s | 73.4 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00137 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.346 | acc=1.0000 | 4718.4 samples/s | 73.7 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00118 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.349 | acc=1.0000 | 4847.9 samples/s | 75.7 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00102 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.352 | acc=1.0000 | 4798.4 samples/s | 75.0 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00089 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.354 | acc=1.0000 | 4880.5 samples/s | 76.3 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00079 | Reg=0.00240 | L2-Norm=15.485 | L2-Norm(final)=2.355 | acc=1.0000 | 4829.9 samples/s | 75.5 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00073 | Reg=0.00239 | L2-Norm=15.471 | L2-Norm(final)=2.357 | acc=1.0000 | 4853.0 samples/s | 75.8 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00067 | Reg=0.00239 | L2-Norm=15.458 | L2-Norm(final)=2.359 | acc=1.0000 | 1503.0 samples/s | 23.5 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00061 | Reg=0.00239 | L2-Norm=15.443 | L2-Norm(final)=2.360 | acc=1.0000 | 4787.1 samples/s | 74.8 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00057 | Reg=0.00238 | L2-Norm=15.429 | L2-Norm(final)=2.361 | acc=1.0000 | 4706.3 samples/s | 73.5 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00053 | Reg=0.00238 | L2-Norm=15.413 | L2-Norm(final)=2.362 | acc=1.0000 | 4662.4 samples/s | 72.9 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00049 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.363 | acc=1.0000 | 4862.7 samples/s | 76.0 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00046 | Reg=0.00237 | L2-Norm=15.382 | L2-Norm(final)=2.364 | acc=1.0000 | 4775.8 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31227 | acc=0.7870 | tpr=0.6987 | fpr=0.0213 | 4547.5 samples/s | 17.8 steps/s
Avg test loss: 0.31840, Avg test acc: 0.78420, Avg tpr: 0.69517, Avg fpr: 0.02000, total FA: 156

Testing server on iccad2012
[Step=  50] | Loss=0.32455 | acc=0.8566 | tpr=0.9602 | fpr=0.1452 | 4519.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.32735 | acc=0.8570 | tpr=0.9765 | fpr=0.1452 | 9272.9 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.33373 | acc=0.8566 | tpr=0.9798 | fpr=0.1457 | 9276.2 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.33381 | acc=0.8568 | tpr=0.9814 | fpr=0.1454 | 9378.0 samples/s | 36.6 steps/s
[Step= 250] | Loss=0.33299 | acc=0.8563 | tpr=0.9799 | fpr=0.1459 | 9433.6 samples/s | 36.8 steps/s
[Step= 300] | Loss=0.33431 | acc=0.8569 | tpr=0.9775 | fpr=0.1453 | 9159.4 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.33619 | acc=0.8570 | tpr=0.9768 | fpr=0.1451 | 9247.1 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.33705 | acc=0.8570 | tpr=0.9754 | fpr=0.1451 | 9509.0 samples/s | 37.1 steps/s
[Step= 450] | Loss=0.33948 | acc=0.8571 | tpr=0.9771 | fpr=0.1451 | 8888.3 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.33817 | acc=0.8571 | tpr=0.9767 | fpr=0.1450 | 9219.3 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.33638 | acc=0.8576 | tpr=0.9765 | fpr=0.1446 | 16965.4 samples/s | 66.3 steps/s
Avg test loss: 0.33617, Avg test acc: 0.85767, Avg tpr: 0.97662, Avg fpr: 0.14450, total FA: 20063

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.22252 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.395 | acc=0.8281 | 3834.2 samples/s | 59.9 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.04971 | Reg=0.00237 | L2-Norm=15.410 | L2-Norm(final)=2.389 | acc=0.9844 | 4627.2 samples/s | 72.3 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03697 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.398 | acc=1.0000 | 5030.1 samples/s | 78.6 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03354 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.403 | acc=0.9531 | 5038.1 samples/s | 78.7 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03169 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.408 | acc=1.0000 | 4908.2 samples/s | 76.7 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.03095 | Reg=0.00240 | L2-Norm=15.483 | L2-Norm(final)=2.411 | acc=0.9844 | 4634.8 samples/s | 72.4 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02992 | Reg=0.00240 | L2-Norm=15.492 | L2-Norm(final)=2.413 | acc=1.0000 | 3956.0 samples/s | 61.8 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02866 | Reg=0.00240 | L2-Norm=15.500 | L2-Norm(final)=2.416 | acc=1.0000 | 3928.6 samples/s | 61.4 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02836 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.419 | acc=0.9688 | 3911.2 samples/s | 61.1 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02713 | Reg=0.00241 | L2-Norm=15.514 | L2-Norm(final)=2.421 | acc=0.9688 | 3923.1 samples/s | 61.3 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02693 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.423 | acc=1.0000 | 3924.8 samples/s | 61.3 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02694 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.425 | acc=0.9844 | 3981.6 samples/s | 62.2 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02647 | Reg=0.00241 | L2-Norm=15.533 | L2-Norm(final)=2.427 | acc=1.0000 | 3923.0 samples/s | 61.3 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02609 | Reg=0.00242 | L2-Norm=15.540 | L2-Norm(final)=2.430 | acc=1.0000 | 3898.8 samples/s | 60.9 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02554 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.433 | acc=0.9844 | 3945.5 samples/s | 61.6 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02548 | Reg=0.00242 | L2-Norm=15.554 | L2-Norm(final)=2.436 | acc=0.9688 | 3883.9 samples/s | 60.7 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02533 | Reg=0.00242 | L2-Norm=15.561 | L2-Norm(final)=2.438 | acc=1.0000 | 3996.4 samples/s | 62.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.02317 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.395 | acc=0.9688 | 3655.5 samples/s | 57.1 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00587 | Reg=0.00238 | L2-Norm=15.430 | L2-Norm(final)=2.378 | acc=1.0000 | 4510.5 samples/s | 70.5 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00423 | Reg=0.00239 | L2-Norm=15.456 | L2-Norm(final)=2.375 | acc=1.0000 | 4847.7 samples/s | 75.7 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00307 | Reg=0.00239 | L2-Norm=15.464 | L2-Norm(final)=2.373 | acc=1.0000 | 4726.0 samples/s | 73.8 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00238 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.374 | acc=1.0000 | 4819.2 samples/s | 75.3 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00192 | Reg=0.00239 | L2-Norm=15.456 | L2-Norm(final)=2.375 | acc=1.0000 | 4840.0 samples/s | 75.6 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00161 | Reg=0.00239 | L2-Norm=15.446 | L2-Norm(final)=2.377 | acc=1.0000 | 4923.0 samples/s | 76.9 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00139 | Reg=0.00238 | L2-Norm=15.434 | L2-Norm(final)=2.378 | acc=1.0000 | 4895.9 samples/s | 76.5 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00123 | Reg=0.00238 | L2-Norm=15.421 | L2-Norm(final)=2.380 | acc=1.0000 | 4773.2 samples/s | 74.6 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00110 | Reg=0.00237 | L2-Norm=15.408 | L2-Norm(final)=2.381 | acc=1.0000 | 4912.4 samples/s | 76.8 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00099 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.383 | acc=1.0000 | 4822.5 samples/s | 75.4 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00090 | Reg=0.00237 | L2-Norm=15.379 | L2-Norm(final)=2.384 | acc=1.0000 | 1494.3 samples/s | 23.3 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00083 | Reg=0.00236 | L2-Norm=15.364 | L2-Norm(final)=2.386 | acc=1.0000 | 4865.9 samples/s | 76.0 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00076 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.387 | acc=1.0000 | 4889.0 samples/s | 76.4 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00071 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.388 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00066 | Reg=0.00235 | L2-Norm=15.317 | L2-Norm(final)=2.389 | acc=1.0000 | 4753.9 samples/s | 74.3 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00062 | Reg=0.00234 | L2-Norm=15.301 | L2-Norm(final)=2.390 | acc=1.0000 | 4753.1 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38169 | acc=0.7364 | tpr=0.6233 | fpr=0.0181 | 4508.3 samples/s | 17.6 steps/s
Avg test loss: 0.38862, Avg test acc: 0.73475, Avg tpr: 0.62266, Avg fpr: 0.01872, total FA: 146

Testing server on iccad2012
[Step=  50] | Loss=0.25618 | acc=0.8917 | tpr=0.9602 | fpr=0.1095 | 4601.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.26208 | acc=0.8906 | tpr=0.9765 | fpr=0.1110 | 9041.5 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.26802 | acc=0.8899 | tpr=0.9798 | fpr=0.1117 | 9389.8 samples/s | 36.7 steps/s
[Step= 200] | Loss=0.26838 | acc=0.8900 | tpr=0.9836 | fpr=0.1117 | 9113.9 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.26670 | acc=0.8898 | tpr=0.9808 | fpr=0.1118 | 9106.4 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.26792 | acc=0.8898 | tpr=0.9789 | fpr=0.1118 | 9423.7 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.26971 | acc=0.8898 | tpr=0.9762 | fpr=0.1118 | 9625.2 samples/s | 37.6 steps/s
[Step= 400] | Loss=0.27040 | acc=0.8898 | tpr=0.9754 | fpr=0.1117 | 8275.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.27311 | acc=0.8893 | tpr=0.9757 | fpr=0.1122 | 8661.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.27240 | acc=0.8893 | tpr=0.9758 | fpr=0.1123 | 8528.4 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.27091 | acc=0.8898 | tpr=0.9757 | fpr=0.1118 | 15717.2 samples/s | 61.4 steps/s
Avg test loss: 0.27063, Avg test acc: 0.88991, Avg tpr: 0.97583, Avg fpr: 0.11165, total FA: 15502

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.16203 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.436 | acc=0.8906 | 3667.1 samples/s | 57.3 steps/s
[Step=10450 Epoch=10.2] | Loss=0.04871 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.431 | acc=0.9688 | 5039.9 samples/s | 78.7 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03643 | Reg=0.00235 | L2-Norm=15.321 | L2-Norm(final)=2.443 | acc=1.0000 | 4465.2 samples/s | 69.8 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03148 | Reg=0.00235 | L2-Norm=15.342 | L2-Norm(final)=2.453 | acc=1.0000 | 4755.4 samples/s | 74.3 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02853 | Reg=0.00236 | L2-Norm=15.356 | L2-Norm(final)=2.459 | acc=0.9844 | 5021.0 samples/s | 78.5 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02686 | Reg=0.00236 | L2-Norm=15.367 | L2-Norm(final)=2.464 | acc=1.0000 | 5013.2 samples/s | 78.3 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02609 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.468 | acc=1.0000 | 4920.0 samples/s | 76.9 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02592 | Reg=0.00237 | L2-Norm=15.384 | L2-Norm(final)=2.470 | acc=0.9844 | 4606.6 samples/s | 72.0 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02538 | Reg=0.00237 | L2-Norm=15.392 | L2-Norm(final)=2.473 | acc=1.0000 | 3975.7 samples/s | 62.1 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02534 | Reg=0.00237 | L2-Norm=15.400 | L2-Norm(final)=2.475 | acc=0.9688 | 3939.4 samples/s | 61.6 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02491 | Reg=0.00237 | L2-Norm=15.408 | L2-Norm(final)=2.479 | acc=0.9531 | 3973.3 samples/s | 62.1 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02515 | Reg=0.00238 | L2-Norm=15.416 | L2-Norm(final)=2.481 | acc=0.9688 | 3945.4 samples/s | 61.6 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02521 | Reg=0.00238 | L2-Norm=15.424 | L2-Norm(final)=2.482 | acc=0.9844 | 3955.9 samples/s | 61.8 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02479 | Reg=0.00238 | L2-Norm=15.431 | L2-Norm(final)=2.484 | acc=0.9688 | 3918.1 samples/s | 61.2 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02500 | Reg=0.00238 | L2-Norm=15.438 | L2-Norm(final)=2.485 | acc=1.0000 | 3919.0 samples/s | 61.2 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02511 | Reg=0.00239 | L2-Norm=15.445 | L2-Norm(final)=2.487 | acc=0.9688 | 3952.6 samples/s | 61.8 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02501 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.489 | acc=1.0000 | 3933.8 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.01352 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.437 | acc=1.0000 | 2915.4 samples/s | 45.6 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00421 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.439 | acc=1.0000 | 4696.2 samples/s | 73.4 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00461 | Reg=0.00236 | L2-Norm=15.358 | L2-Norm(final)=2.434 | acc=0.9688 | 4778.8 samples/s | 74.7 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00466 | Reg=0.00236 | L2-Norm=15.378 | L2-Norm(final)=2.422 | acc=1.0000 | 4840.5 samples/s | 75.6 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00390 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.412 | acc=1.0000 | 4816.3 samples/s | 75.3 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00319 | Reg=0.00237 | L2-Norm=15.396 | L2-Norm(final)=2.406 | acc=1.0000 | 4765.9 samples/s | 74.5 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00266 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.404 | acc=1.0000 | 4782.7 samples/s | 74.7 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00229 | Reg=0.00237 | L2-Norm=15.390 | L2-Norm(final)=2.402 | acc=1.0000 | 4901.4 samples/s | 76.6 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00201 | Reg=0.00237 | L2-Norm=15.383 | L2-Norm(final)=2.401 | acc=1.0000 | 4944.9 samples/s | 77.3 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00179 | Reg=0.00236 | L2-Norm=15.374 | L2-Norm(final)=2.401 | acc=1.0000 | 4743.4 samples/s | 74.1 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00163 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.401 | acc=1.0000 | 4812.5 samples/s | 75.2 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00148 | Reg=0.00236 | L2-Norm=15.355 | L2-Norm(final)=2.402 | acc=1.0000 | 1487.5 samples/s | 23.2 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00136 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.402 | acc=1.0000 | 4789.6 samples/s | 74.8 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00126 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.403 | acc=1.0000 | 4824.3 samples/s | 75.4 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00117 | Reg=0.00235 | L2-Norm=15.321 | L2-Norm(final)=2.403 | acc=1.0000 | 4944.4 samples/s | 77.3 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00109 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.404 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00102 | Reg=0.00234 | L2-Norm=15.297 | L2-Norm(final)=2.404 | acc=1.0000 | 4868.5 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46681 | acc=0.6981 | tpr=0.5648 | fpr=0.0124 | 4575.4 samples/s | 17.9 steps/s
Avg test loss: 0.47632, Avg test acc: 0.69477, Avg tpr: 0.56175, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.25144 | acc=0.9008 | tpr=0.9558 | fpr=0.1002 | 4525.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.25714 | acc=0.9010 | tpr=0.9723 | fpr=0.1003 | 9328.6 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.26245 | acc=0.9008 | tpr=0.9741 | fpr=0.1006 | 9216.2 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.26227 | acc=0.9013 | tpr=0.9760 | fpr=0.1001 | 9199.9 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.26138 | acc=0.9009 | tpr=0.9747 | fpr=0.1004 | 9222.9 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.26256 | acc=0.9007 | tpr=0.9731 | fpr=0.1006 | 9817.0 samples/s | 38.3 steps/s
[Step= 350] | Loss=0.26461 | acc=0.9001 | tpr=0.9699 | fpr=0.1012 | 9194.3 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.26588 | acc=0.9000 | tpr=0.9699 | fpr=0.1013 | 9025.0 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.26794 | acc=0.8998 | tpr=0.9708 | fpr=0.1015 | 9003.8 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.26694 | acc=0.8996 | tpr=0.9714 | fpr=0.1017 | 9169.3 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.26582 | acc=0.9000 | tpr=0.9721 | fpr=0.1013 | 17736.3 samples/s | 69.3 steps/s
Avg test loss: 0.26565, Avg test acc: 0.90006, Avg tpr: 0.97227, Avg fpr: 0.10125, total FA: 14059

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.40411 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.461 | acc=0.7500 | 3960.5 samples/s | 61.9 steps/s
[Step=11250 Epoch=11.0] | Loss=0.06710 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.441 | acc=0.9531 | 4607.6 samples/s | 72.0 steps/s
[Step=11300 Epoch=11.0] | Loss=0.04511 | Reg=0.00234 | L2-Norm=15.298 | L2-Norm(final)=2.451 | acc=0.9844 | 4993.8 samples/s | 78.0 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03900 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.460 | acc=0.9844 | 4991.0 samples/s | 78.0 steps/s
[Step=11400 Epoch=11.1] | Loss=0.03539 | Reg=0.00235 | L2-Norm=15.335 | L2-Norm(final)=2.466 | acc=0.9688 | 5000.1 samples/s | 78.1 steps/s
[Step=11450 Epoch=11.2] | Loss=0.03240 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.470 | acc=1.0000 | 4936.7 samples/s | 77.1 steps/s
[Step=11500 Epoch=11.2] | Loss=0.03053 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.476 | acc=0.9688 | 4348.4 samples/s | 67.9 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02896 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.480 | acc=0.9688 | 3945.6 samples/s | 61.6 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02805 | Reg=0.00237 | L2-Norm=15.380 | L2-Norm(final)=2.485 | acc=0.9844 | 3922.5 samples/s | 61.3 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02783 | Reg=0.00237 | L2-Norm=15.389 | L2-Norm(final)=2.488 | acc=0.9531 | 4005.6 samples/s | 62.6 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02746 | Reg=0.00237 | L2-Norm=15.397 | L2-Norm(final)=2.490 | acc=0.9844 | 3958.4 samples/s | 61.9 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02722 | Reg=0.00237 | L2-Norm=15.405 | L2-Norm(final)=2.492 | acc=1.0000 | 3917.4 samples/s | 61.2 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02710 | Reg=0.00238 | L2-Norm=15.413 | L2-Norm(final)=2.493 | acc=0.9219 | 3942.2 samples/s | 61.6 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02671 | Reg=0.00238 | L2-Norm=15.421 | L2-Norm(final)=2.495 | acc=0.9688 | 3981.4 samples/s | 62.2 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02632 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.496 | acc=1.0000 | 3940.9 samples/s | 61.6 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02599 | Reg=0.00238 | L2-Norm=15.434 | L2-Norm(final)=2.498 | acc=0.9844 | 3933.7 samples/s | 61.5 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02541 | Reg=0.00238 | L2-Norm=15.441 | L2-Norm(final)=2.500 | acc=0.9844 | 3913.5 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.06236 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.460 | acc=0.9688 | 2917.2 samples/s | 45.6 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00950 | Reg=0.00233 | L2-Norm=15.255 | L2-Norm(final)=2.420 | acc=1.0000 | 4788.0 samples/s | 74.8 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00532 | Reg=0.00234 | L2-Norm=15.289 | L2-Norm(final)=2.418 | acc=1.0000 | 4814.4 samples/s | 75.2 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00388 | Reg=0.00234 | L2-Norm=15.297 | L2-Norm(final)=2.419 | acc=1.0000 | 4865.7 samples/s | 76.0 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00302 | Reg=0.00234 | L2-Norm=15.299 | L2-Norm(final)=2.421 | acc=1.0000 | 4786.4 samples/s | 74.8 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00248 | Reg=0.00234 | L2-Norm=15.296 | L2-Norm(final)=2.424 | acc=1.0000 | 4777.7 samples/s | 74.7 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00219 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.427 | acc=1.0000 | 4578.5 samples/s | 71.5 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00195 | Reg=0.00234 | L2-Norm=15.283 | L2-Norm(final)=2.429 | acc=1.0000 | 4743.2 samples/s | 74.1 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00174 | Reg=0.00233 | L2-Norm=15.277 | L2-Norm(final)=2.431 | acc=1.0000 | 4858.7 samples/s | 75.9 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00155 | Reg=0.00233 | L2-Norm=15.269 | L2-Norm(final)=2.433 | acc=1.0000 | 4837.4 samples/s | 75.6 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00141 | Reg=0.00233 | L2-Norm=15.261 | L2-Norm(final)=2.435 | acc=1.0000 | 4790.4 samples/s | 74.9 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00129 | Reg=0.00233 | L2-Norm=15.251 | L2-Norm(final)=2.437 | acc=1.0000 | 1522.4 samples/s | 23.8 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00118 | Reg=0.00232 | L2-Norm=15.241 | L2-Norm(final)=2.438 | acc=1.0000 | 4817.2 samples/s | 75.3 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00109 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.440 | acc=1.0000 | 4791.2 samples/s | 74.9 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00102 | Reg=0.00232 | L2-Norm=15.220 | L2-Norm(final)=2.441 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00095 | Reg=0.00231 | L2-Norm=15.208 | L2-Norm(final)=2.442 | acc=1.0000 | 4812.9 samples/s | 75.2 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00089 | Reg=0.00231 | L2-Norm=15.196 | L2-Norm(final)=2.444 | acc=1.0000 | 4983.8 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36809 | acc=0.7413 | tpr=0.6320 | fpr=0.0213 | 4540.6 samples/s | 17.7 steps/s
Avg test loss: 0.37726, Avg test acc: 0.73792, Avg tpr: 0.62837, Avg fpr: 0.02115, total FA: 165

Testing server on iccad2012
[Step=  50] | Loss=0.24742 | acc=0.9023 | tpr=0.9646 | fpr=0.0988 | 4592.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.25101 | acc=0.9026 | tpr=0.9765 | fpr=0.0988 | 9327.6 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.25832 | acc=0.9016 | tpr=0.9784 | fpr=0.0998 | 9037.5 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.25845 | acc=0.9024 | tpr=0.9792 | fpr=0.0990 | 9248.1 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.25766 | acc=0.9022 | tpr=0.9799 | fpr=0.0992 | 9147.2 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.25927 | acc=0.9020 | tpr=0.9789 | fpr=0.0994 | 9037.3 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.26109 | acc=0.9016 | tpr=0.9762 | fpr=0.0997 | 9535.9 samples/s | 37.2 steps/s
[Step= 400] | Loss=0.26180 | acc=0.9014 | tpr=0.9737 | fpr=0.0999 | 9041.1 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.26420 | acc=0.9011 | tpr=0.9747 | fpr=0.1002 | 9307.6 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.26334 | acc=0.9010 | tpr=0.9749 | fpr=0.1004 | 9426.1 samples/s | 36.8 steps/s
[Step= 550] | Loss=0.26214 | acc=0.9012 | tpr=0.9753 | fpr=0.1001 | 16744.5 samples/s | 65.4 steps/s
Avg test loss: 0.26197, Avg test acc: 0.90128, Avg tpr: 0.97544, Avg fpr: 0.10007, total FA: 13894

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.22388 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.493 | acc=0.8750 | 3924.7 samples/s | 61.3 steps/s
[Step=12050 Epoch=11.8] | Loss=0.05062 | Reg=0.00231 | L2-Norm=15.191 | L2-Norm(final)=2.485 | acc=0.9844 | 4642.4 samples/s | 72.5 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03614 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.499 | acc=0.9844 | 4972.7 samples/s | 77.7 steps/s
[Step=12150 Epoch=11.9] | Loss=0.03164 | Reg=0.00232 | L2-Norm=15.237 | L2-Norm(final)=2.508 | acc=0.9531 | 4993.5 samples/s | 78.0 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02769 | Reg=0.00233 | L2-Norm=15.250 | L2-Norm(final)=2.514 | acc=1.0000 | 5101.8 samples/s | 79.7 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02671 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.519 | acc=0.9688 | 5034.2 samples/s | 78.7 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02593 | Reg=0.00233 | L2-Norm=15.269 | L2-Norm(final)=2.524 | acc=0.9844 | 5048.2 samples/s | 78.9 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02510 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.528 | acc=0.9844 | 4979.2 samples/s | 77.8 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02455 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.532 | acc=0.9844 | 4655.4 samples/s | 72.7 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02495 | Reg=0.00234 | L2-Norm=15.299 | L2-Norm(final)=2.535 | acc=0.9844 | 3921.0 samples/s | 61.3 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02466 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.538 | acc=0.9531 | 3992.6 samples/s | 62.4 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02461 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.541 | acc=1.0000 | 4007.5 samples/s | 62.6 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02459 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.543 | acc=0.9688 | 3954.5 samples/s | 61.8 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02430 | Reg=0.00235 | L2-Norm=15.335 | L2-Norm(final)=2.545 | acc=0.9844 | 3931.1 samples/s | 61.4 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02405 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.547 | acc=1.0000 | 3991.1 samples/s | 62.4 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02368 | Reg=0.00236 | L2-Norm=15.350 | L2-Norm(final)=2.548 | acc=0.9688 | 3962.9 samples/s | 61.9 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02384 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.550 | acc=0.9688 | 3997.2 samples/s | 62.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.00398 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.493 | acc=1.0000 | 3089.9 samples/s | 48.3 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00346 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.487 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00335 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.485 | acc=1.0000 | 4833.9 samples/s | 75.5 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00265 | Reg=0.00232 | L2-Norm=15.230 | L2-Norm(final)=2.484 | acc=1.0000 | 4693.8 samples/s | 73.3 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00213 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.485 | acc=1.0000 | 4770.1 samples/s | 74.5 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00171 | Reg=0.00232 | L2-Norm=15.247 | L2-Norm(final)=2.486 | acc=1.0000 | 4830.3 samples/s | 75.5 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00145 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.486 | acc=1.0000 | 4860.5 samples/s | 75.9 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00125 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.488 | acc=1.0000 | 4762.2 samples/s | 74.4 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00112 | Reg=0.00232 | L2-Norm=15.234 | L2-Norm(final)=2.489 | acc=1.0000 | 4775.5 samples/s | 74.6 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00102 | Reg=0.00232 | L2-Norm=15.226 | L2-Norm(final)=2.490 | acc=1.0000 | 4796.0 samples/s | 74.9 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00092 | Reg=0.00232 | L2-Norm=15.218 | L2-Norm(final)=2.492 | acc=1.0000 | 4869.6 samples/s | 76.1 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00084 | Reg=0.00231 | L2-Norm=15.208 | L2-Norm(final)=2.493 | acc=1.0000 | 1522.9 samples/s | 23.8 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00077 | Reg=0.00231 | L2-Norm=15.198 | L2-Norm(final)=2.495 | acc=1.0000 | 4862.1 samples/s | 76.0 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00071 | Reg=0.00231 | L2-Norm=15.188 | L2-Norm(final)=2.496 | acc=1.0000 | 4728.2 samples/s | 73.9 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00066 | Reg=0.00230 | L2-Norm=15.177 | L2-Norm(final)=2.497 | acc=1.0000 | 4866.9 samples/s | 76.0 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00062 | Reg=0.00230 | L2-Norm=15.165 | L2-Norm(final)=2.498 | acc=1.0000 | 4800.5 samples/s | 75.0 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00058 | Reg=0.00230 | L2-Norm=15.154 | L2-Norm(final)=2.500 | acc=1.0000 | 4801.5 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29425 | acc=0.8006 | tpr=0.7157 | fpr=0.0149 | 4591.2 samples/s | 17.9 steps/s
Avg test loss: 0.30514, Avg test acc: 0.79650, Avg tpr: 0.71091, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.28592 | acc=0.8903 | tpr=0.9646 | fpr=0.1110 | 4556.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.29420 | acc=0.8896 | tpr=0.9765 | fpr=0.1121 | 9210.8 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.30115 | acc=0.8900 | tpr=0.9784 | fpr=0.1117 | 9464.7 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.30267 | acc=0.8905 | tpr=0.9803 | fpr=0.1111 | 9383.1 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.30048 | acc=0.8910 | tpr=0.9799 | fpr=0.1106 | 8931.1 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.30236 | acc=0.8911 | tpr=0.9796 | fpr=0.1105 | 9307.1 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.30474 | acc=0.8907 | tpr=0.9775 | fpr=0.1109 | 9444.6 samples/s | 36.9 steps/s
[Step= 400] | Loss=0.30565 | acc=0.8906 | tpr=0.9754 | fpr=0.1109 | 9296.7 samples/s | 36.3 steps/s
[Step= 450] | Loss=0.30827 | acc=0.8904 | tpr=0.9771 | fpr=0.1112 | 8999.4 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.30718 | acc=0.8905 | tpr=0.9771 | fpr=0.1111 | 9433.7 samples/s | 36.9 steps/s
[Step= 550] | Loss=0.30604 | acc=0.8908 | tpr=0.9777 | fpr=0.1108 | 16748.4 samples/s | 65.4 steps/s
Avg test loss: 0.30588, Avg test acc: 0.89080, Avg tpr: 0.97781, Avg fpr: 0.11078, total FA: 15382

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.28578 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.536 | acc=0.8281 | 3797.7 samples/s | 59.3 steps/s
[Step=12850 Epoch=12.5] | Loss=0.04390 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.529 | acc=0.9688 | 4786.9 samples/s | 74.8 steps/s
[Step=12900 Epoch=12.6] | Loss=0.03314 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.538 | acc=1.0000 | 4964.1 samples/s | 77.6 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02835 | Reg=0.00230 | L2-Norm=15.181 | L2-Norm(final)=2.545 | acc=1.0000 | 4987.9 samples/s | 77.9 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02515 | Reg=0.00231 | L2-Norm=15.195 | L2-Norm(final)=2.554 | acc=0.9688 | 5014.3 samples/s | 78.3 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02538 | Reg=0.00231 | L2-Norm=15.207 | L2-Norm(final)=2.560 | acc=1.0000 | 4963.2 samples/s | 77.5 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02512 | Reg=0.00232 | L2-Norm=15.217 | L2-Norm(final)=2.565 | acc=0.9688 | 5083.3 samples/s | 79.4 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02459 | Reg=0.00232 | L2-Norm=15.226 | L2-Norm(final)=2.569 | acc=0.9688 | 4956.1 samples/s | 77.4 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02473 | Reg=0.00232 | L2-Norm=15.235 | L2-Norm(final)=2.571 | acc=0.9844 | 4959.9 samples/s | 77.5 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02464 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.573 | acc=1.0000 | 5014.6 samples/s | 78.4 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02415 | Reg=0.00233 | L2-Norm=15.251 | L2-Norm(final)=2.574 | acc=1.0000 | 5037.2 samples/s | 78.7 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02374 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.576 | acc=0.9844 | 5158.1 samples/s | 80.6 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02350 | Reg=0.00233 | L2-Norm=15.266 | L2-Norm(final)=2.578 | acc=0.9688 | 5079.1 samples/s | 79.4 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02331 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.580 | acc=1.0000 | 4999.9 samples/s | 78.1 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02301 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.581 | acc=1.0000 | 4988.0 samples/s | 77.9 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02302 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.583 | acc=0.9688 | 5158.6 samples/s | 80.6 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02278 | Reg=0.00234 | L2-Norm=15.293 | L2-Norm(final)=2.585 | acc=1.0000 | 4943.6 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.06814 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.535 | acc=0.9688 | 3762.8 samples/s | 58.8 steps/s
[Step=12850 Epoch=24.2] | Loss=0.01136 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.501 | acc=1.0000 | 4683.3 samples/s | 73.2 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00602 | Reg=0.00232 | L2-Norm=15.237 | L2-Norm(final)=2.491 | acc=1.0000 | 4738.8 samples/s | 74.0 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00419 | Reg=0.00233 | L2-Norm=15.249 | L2-Norm(final)=2.491 | acc=1.0000 | 4754.1 samples/s | 74.3 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00357 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.492 | acc=1.0000 | 4726.4 samples/s | 73.8 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00298 | Reg=0.00233 | L2-Norm=15.253 | L2-Norm(final)=2.492 | acc=1.0000 | 4794.0 samples/s | 74.9 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00251 | Reg=0.00233 | L2-Norm=15.251 | L2-Norm(final)=2.494 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00221 | Reg=0.00232 | L2-Norm=15.248 | L2-Norm(final)=2.495 | acc=1.0000 | 4793.7 samples/s | 74.9 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00242 | Reg=0.00232 | L2-Norm=15.244 | L2-Norm(final)=2.496 | acc=1.0000 | 4845.2 samples/s | 75.7 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00237 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.495 | acc=1.0000 | 4793.1 samples/s | 74.9 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00215 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.494 | acc=1.0000 | 4816.1 samples/s | 75.3 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00196 | Reg=0.00232 | L2-Norm=15.236 | L2-Norm(final)=2.494 | acc=1.0000 | 1494.8 samples/s | 23.4 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00180 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.495 | acc=1.0000 | 4950.2 samples/s | 77.3 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00167 | Reg=0.00232 | L2-Norm=15.225 | L2-Norm(final)=2.495 | acc=1.0000 | 4850.7 samples/s | 75.8 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00155 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.496 | acc=1.0000 | 4849.6 samples/s | 75.8 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00149 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.496 | acc=1.0000 | 4803.4 samples/s | 75.1 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00143 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.497 | acc=1.0000 | 4854.0 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42873 | acc=0.7255 | tpr=0.6075 | fpr=0.0183 | 4575.3 samples/s | 17.9 steps/s
Avg test loss: 0.43513, Avg test acc: 0.72161, Avg tpr: 0.60319, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.24964 | acc=0.9115 | tpr=0.9690 | fpr=0.0895 | 4749.1 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.25787 | acc=0.9102 | tpr=0.9787 | fpr=0.0911 | 8751.9 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.26478 | acc=0.9105 | tpr=0.9813 | fpr=0.0908 | 9092.8 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.26584 | acc=0.9112 | tpr=0.9836 | fpr=0.0901 | 9247.4 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.26436 | acc=0.9110 | tpr=0.9834 | fpr=0.0903 | 9665.9 samples/s | 37.8 steps/s
[Step= 300] | Loss=0.26573 | acc=0.9111 | tpr=0.9840 | fpr=0.0903 | 9200.4 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.26764 | acc=0.9107 | tpr=0.9806 | fpr=0.0906 | 9295.0 samples/s | 36.3 steps/s
[Step= 400] | Loss=0.26880 | acc=0.9106 | tpr=0.9792 | fpr=0.0907 | 9067.4 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.27160 | acc=0.9100 | tpr=0.9800 | fpr=0.0912 | 9223.1 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.27009 | acc=0.9102 | tpr=0.9802 | fpr=0.0911 | 9060.1 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.26839 | acc=0.9104 | tpr=0.9813 | fpr=0.0908 | 16945.0 samples/s | 66.2 steps/s
Avg test loss: 0.26819, Avg test acc: 0.91047, Avg tpr: 0.98138, Avg fpr: 0.09082, total FA: 12610

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.46049 | Reg=0.00228 | L2-Norm=15.108 | L2-Norm(final)=2.555 | acc=0.6719 | 3705.2 samples/s | 57.9 steps/s
[Step=13650 Epoch=13.3] | Loss=0.05724 | Reg=0.00230 | L2-Norm=15.174 | L2-Norm(final)=2.549 | acc=0.9844 | 4826.2 samples/s | 75.4 steps/s
[Step=13700 Epoch=13.4] | Loss=0.03723 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.563 | acc=1.0000 | 4916.7 samples/s | 76.8 steps/s
[Step=13750 Epoch=13.4] | Loss=0.03271 | Reg=0.00232 | L2-Norm=15.225 | L2-Norm(final)=2.575 | acc=1.0000 | 4603.4 samples/s | 71.9 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02993 | Reg=0.00232 | L2-Norm=15.239 | L2-Norm(final)=2.581 | acc=0.9688 | 3952.5 samples/s | 61.8 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02835 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.585 | acc=1.0000 | 3920.5 samples/s | 61.3 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02706 | Reg=0.00233 | L2-Norm=15.262 | L2-Norm(final)=2.589 | acc=0.9688 | 3945.9 samples/s | 61.7 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02573 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.593 | acc=1.0000 | 3924.3 samples/s | 61.3 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02561 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.596 | acc=0.9844 | 3998.8 samples/s | 62.5 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02521 | Reg=0.00234 | L2-Norm=15.288 | L2-Norm(final)=2.598 | acc=0.9844 | 3942.6 samples/s | 61.6 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02499 | Reg=0.00234 | L2-Norm=15.296 | L2-Norm(final)=2.601 | acc=0.9844 | 3962.9 samples/s | 61.9 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02495 | Reg=0.00234 | L2-Norm=15.304 | L2-Norm(final)=2.603 | acc=1.0000 | 3973.2 samples/s | 62.1 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02478 | Reg=0.00234 | L2-Norm=15.312 | L2-Norm(final)=2.605 | acc=0.9844 | 3942.7 samples/s | 61.6 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02450 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.607 | acc=0.9688 | 3948.4 samples/s | 61.7 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02429 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.609 | acc=0.9688 | 3965.2 samples/s | 62.0 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02397 | Reg=0.00235 | L2-Norm=15.336 | L2-Norm(final)=2.612 | acc=1.0000 | 3914.9 samples/s | 61.2 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02350 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.614 | acc=0.9844 | 3928.6 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.00264 | Reg=0.00228 | L2-Norm=15.108 | L2-Norm(final)=2.557 | acc=1.0000 | 3087.9 samples/s | 48.2 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00183 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.558 | acc=1.0000 | 4317.1 samples/s | 67.5 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00094 | Reg=0.00229 | L2-Norm=15.147 | L2-Norm(final)=2.561 | acc=1.0000 | 4869.6 samples/s | 76.1 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00076 | Reg=0.00229 | L2-Norm=15.143 | L2-Norm(final)=2.563 | acc=1.0000 | 4805.7 samples/s | 75.1 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00058 | Reg=0.00229 | L2-Norm=15.136 | L2-Norm(final)=2.565 | acc=1.0000 | 4816.4 samples/s | 75.3 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00047 | Reg=0.00229 | L2-Norm=15.127 | L2-Norm(final)=2.567 | acc=1.0000 | 4843.6 samples/s | 75.7 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00054 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.568 | acc=1.0000 | 4685.1 samples/s | 73.2 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00059 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.569 | acc=1.0000 | 4690.4 samples/s | 73.3 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00057 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.570 | acc=1.0000 | 4713.3 samples/s | 73.6 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00052 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.572 | acc=1.0000 | 4805.8 samples/s | 75.1 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00047 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.573 | acc=1.0000 | 4894.1 samples/s | 76.5 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00043 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.575 | acc=1.0000 | 1493.8 samples/s | 23.3 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00040 | Reg=0.00228 | L2-Norm=15.083 | L2-Norm(final)=2.576 | acc=1.0000 | 5033.5 samples/s | 78.6 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00037 | Reg=0.00227 | L2-Norm=15.075 | L2-Norm(final)=2.577 | acc=1.0000 | 4730.2 samples/s | 73.9 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00034 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.579 | acc=1.0000 | 4802.6 samples/s | 75.0 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00032 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.580 | acc=1.0000 | 4761.9 samples/s | 74.4 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00030 | Reg=0.00226 | L2-Norm=15.046 | L2-Norm(final)=2.581 | acc=1.0000 | 4743.4 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35299 | acc=0.7807 | tpr=0.6830 | fpr=0.0072 | 4739.1 samples/s | 18.5 steps/s
Avg test loss: 0.36301, Avg test acc: 0.77691, Avg tpr: 0.67943, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.29451 | acc=0.8841 | tpr=0.9602 | fpr=0.1173 | 4584.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.30215 | acc=0.8821 | tpr=0.9744 | fpr=0.1196 | 9440.4 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.30607 | acc=0.8820 | tpr=0.9769 | fpr=0.1197 | 9035.9 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.30606 | acc=0.8821 | tpr=0.9803 | fpr=0.1197 | 9359.7 samples/s | 36.6 steps/s
[Step= 250] | Loss=0.30428 | acc=0.8816 | tpr=0.9773 | fpr=0.1202 | 9106.0 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.30605 | acc=0.8817 | tpr=0.9767 | fpr=0.1201 | 9649.7 samples/s | 37.7 steps/s
[Step= 350] | Loss=0.30701 | acc=0.8817 | tpr=0.9750 | fpr=0.1200 | 9163.6 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.30761 | acc=0.8816 | tpr=0.9743 | fpr=0.1201 | 9272.7 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.31006 | acc=0.8811 | tpr=0.9742 | fpr=0.1206 | 9021.8 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.30908 | acc=0.8808 | tpr=0.9736 | fpr=0.1209 | 9351.0 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.30750 | acc=0.8812 | tpr=0.9741 | fpr=0.1205 | 16681.0 samples/s | 65.2 steps/s
Avg test loss: 0.30746, Avg test acc: 0.88124, Avg tpr: 0.97425, Avg fpr: 0.12045, total FA: 16724

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.26315 | Reg=0.00227 | L2-Norm=15.075 | L2-Norm(final)=2.623 | acc=0.7656 | 3558.8 samples/s | 55.6 steps/s
[Step=14450 Epoch=14.1] | Loss=0.03707 | Reg=0.00230 | L2-Norm=15.154 | L2-Norm(final)=2.623 | acc=1.0000 | 4947.6 samples/s | 77.3 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02770 | Reg=0.00230 | L2-Norm=15.178 | L2-Norm(final)=2.630 | acc=0.9844 | 4964.3 samples/s | 77.6 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02391 | Reg=0.00231 | L2-Norm=15.191 | L2-Norm(final)=2.637 | acc=0.9688 | 4967.2 samples/s | 77.6 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02367 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.641 | acc=1.0000 | 5017.7 samples/s | 78.4 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02290 | Reg=0.00231 | L2-Norm=15.211 | L2-Norm(final)=2.645 | acc=0.9844 | 4958.4 samples/s | 77.5 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02258 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.649 | acc=0.9844 | 5057.6 samples/s | 79.0 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02218 | Reg=0.00232 | L2-Norm=15.228 | L2-Norm(final)=2.653 | acc=0.9844 | 4908.0 samples/s | 76.7 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02215 | Reg=0.00232 | L2-Norm=15.236 | L2-Norm(final)=2.656 | acc=0.9688 | 4926.7 samples/s | 77.0 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02181 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.658 | acc=1.0000 | 3932.5 samples/s | 61.4 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02177 | Reg=0.00233 | L2-Norm=15.250 | L2-Norm(final)=2.661 | acc=0.9844 | 3959.9 samples/s | 61.9 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02141 | Reg=0.00233 | L2-Norm=15.257 | L2-Norm(final)=2.664 | acc=0.9844 | 3917.0 samples/s | 61.2 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02130 | Reg=0.00233 | L2-Norm=15.264 | L2-Norm(final)=2.667 | acc=0.9375 | 3976.0 samples/s | 62.1 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02151 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.669 | acc=1.0000 | 3992.0 samples/s | 62.4 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02167 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.671 | acc=0.9844 | 3995.4 samples/s | 62.4 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02134 | Reg=0.00234 | L2-Norm=15.285 | L2-Norm(final)=2.673 | acc=0.9844 | 3950.4 samples/s | 61.7 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02129 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.675 | acc=0.9688 | 3967.1 samples/s | 62.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.09184 | Reg=0.00227 | L2-Norm=15.075 | L2-Norm(final)=2.621 | acc=0.9531 | 3858.8 samples/s | 60.3 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00485 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.609 | acc=1.0000 | 4497.9 samples/s | 70.3 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00326 | Reg=0.00232 | L2-Norm=15.227 | L2-Norm(final)=2.608 | acc=1.0000 | 4861.8 samples/s | 76.0 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00277 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.608 | acc=1.0000 | 4772.0 samples/s | 74.6 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00263 | Reg=0.00233 | L2-Norm=15.258 | L2-Norm(final)=2.607 | acc=1.0000 | 4793.1 samples/s | 74.9 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00244 | Reg=0.00233 | L2-Norm=15.266 | L2-Norm(final)=2.604 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00216 | Reg=0.00233 | L2-Norm=15.270 | L2-Norm(final)=2.601 | acc=1.0000 | 4920.9 samples/s | 76.9 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00208 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.600 | acc=1.0000 | 4803.2 samples/s | 75.1 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00197 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.598 | acc=1.0000 | 4887.7 samples/s | 76.4 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00175 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.597 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00159 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.596 | acc=1.0000 | 4737.9 samples/s | 74.0 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00147 | Reg=0.00233 | L2-Norm=15.268 | L2-Norm(final)=2.596 | acc=1.0000 | 1478.9 samples/s | 23.1 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00135 | Reg=0.00233 | L2-Norm=15.264 | L2-Norm(final)=2.595 | acc=1.0000 | 4895.3 samples/s | 76.5 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00124 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.595 | acc=1.0000 | 4798.2 samples/s | 75.0 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00116 | Reg=0.00233 | L2-Norm=15.253 | L2-Norm(final)=2.595 | acc=1.0000 | 4763.5 samples/s | 74.4 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00108 | Reg=0.00232 | L2-Norm=15.247 | L2-Norm(final)=2.595 | acc=1.0000 | 4767.3 samples/s | 74.5 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00101 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.595 | acc=1.0000 | 4779.7 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42870 | acc=0.7412 | tpr=0.6287 | fpr=0.0146 | 4600.4 samples/s | 18.0 steps/s
Avg test loss: 0.43881, Avg test acc: 0.73712, Avg tpr: 0.62412, Avg fpr: 0.01436, total FA: 112

Testing server on iccad2012
[Step=  50] | Loss=0.26893 | acc=0.9067 | tpr=0.9558 | fpr=0.0942 | 4479.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.27885 | acc=0.9044 | tpr=0.9744 | fpr=0.0969 | 9452.7 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.28458 | acc=0.9050 | tpr=0.9784 | fpr=0.0964 | 9635.8 samples/s | 37.6 steps/s
[Step= 200] | Loss=0.28473 | acc=0.9058 | tpr=0.9814 | fpr=0.0956 | 8962.6 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.28302 | acc=0.9055 | tpr=0.9799 | fpr=0.0959 | 9356.1 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.28538 | acc=0.9052 | tpr=0.9796 | fpr=0.0962 | 9608.3 samples/s | 37.5 steps/s
[Step= 350] | Loss=0.28726 | acc=0.9051 | tpr=0.9775 | fpr=0.0962 | 8719.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.28821 | acc=0.9049 | tpr=0.9759 | fpr=0.0964 | 9138.9 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.29126 | acc=0.9044 | tpr=0.9766 | fpr=0.0969 | 9307.9 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.29054 | acc=0.9040 | tpr=0.9762 | fpr=0.0973 | 9186.9 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.28880 | acc=0.9042 | tpr=0.9765 | fpr=0.0971 | 17557.1 samples/s | 68.6 steps/s
Avg test loss: 0.28860, Avg test acc: 0.90423, Avg tpr: 0.97662, Avg fpr: 0.09708, total FA: 13480

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.31256 | Reg=0.00228 | L2-Norm=15.114 | L2-Norm(final)=2.643 | acc=0.7656 | 3641.8 samples/s | 56.9 steps/s
[Step=15250 Epoch=14.9] | Loss=0.04961 | Reg=0.00230 | L2-Norm=15.160 | L2-Norm(final)=2.626 | acc=0.9844 | 5037.4 samples/s | 78.7 steps/s
[Step=15300 Epoch=14.9] | Loss=0.03425 | Reg=0.00231 | L2-Norm=15.185 | L2-Norm(final)=2.636 | acc=0.9844 | 5084.6 samples/s | 79.4 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02934 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.645 | acc=1.0000 | 4927.3 samples/s | 77.0 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02821 | Reg=0.00231 | L2-Norm=15.213 | L2-Norm(final)=2.650 | acc=1.0000 | 5021.0 samples/s | 78.5 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02668 | Reg=0.00232 | L2-Norm=15.223 | L2-Norm(final)=2.654 | acc=1.0000 | 4904.8 samples/s | 76.6 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02682 | Reg=0.00232 | L2-Norm=15.232 | L2-Norm(final)=2.657 | acc=0.9844 | 4102.8 samples/s | 64.1 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02595 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.658 | acc=0.9688 | 3902.5 samples/s | 61.0 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02517 | Reg=0.00233 | L2-Norm=15.248 | L2-Norm(final)=2.661 | acc=0.9531 | 3941.9 samples/s | 61.6 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02459 | Reg=0.00233 | L2-Norm=15.256 | L2-Norm(final)=2.663 | acc=1.0000 | 3977.5 samples/s | 62.1 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02442 | Reg=0.00233 | L2-Norm=15.264 | L2-Norm(final)=2.666 | acc=1.0000 | 3961.8 samples/s | 61.9 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02384 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.667 | acc=1.0000 | 3939.5 samples/s | 61.6 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02339 | Reg=0.00233 | L2-Norm=15.279 | L2-Norm(final)=2.670 | acc=1.0000 | 3959.9 samples/s | 61.9 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02327 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.672 | acc=0.9844 | 3972.3 samples/s | 62.1 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02281 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.674 | acc=0.9844 | 3913.5 samples/s | 61.1 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02242 | Reg=0.00234 | L2-Norm=15.299 | L2-Norm(final)=2.676 | acc=1.0000 | 3980.9 samples/s | 62.2 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02215 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.678 | acc=0.9531 | 3903.3 samples/s | 61.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.01228 | Reg=0.00228 | L2-Norm=15.114 | L2-Norm(final)=2.645 | acc=0.9844 | 3104.9 samples/s | 48.5 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00291 | Reg=0.00230 | L2-Norm=15.158 | L2-Norm(final)=2.641 | acc=1.0000 | 4726.4 samples/s | 73.8 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00218 | Reg=0.00230 | L2-Norm=15.165 | L2-Norm(final)=2.641 | acc=1.0000 | 4816.2 samples/s | 75.3 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00206 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.640 | acc=1.0000 | 4737.0 samples/s | 74.0 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00166 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.638 | acc=1.0000 | 4839.6 samples/s | 75.6 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00143 | Reg=0.00230 | L2-Norm=15.166 | L2-Norm(final)=2.639 | acc=1.0000 | 4741.1 samples/s | 74.1 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00120 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.639 | acc=1.0000 | 4751.5 samples/s | 74.2 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00112 | Reg=0.00230 | L2-Norm=15.161 | L2-Norm(final)=2.639 | acc=1.0000 | 4861.9 samples/s | 76.0 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00099 | Reg=0.00230 | L2-Norm=15.156 | L2-Norm(final)=2.640 | acc=1.0000 | 4738.1 samples/s | 74.0 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00092 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.641 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00083 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.641 | acc=1.0000 | 4863.6 samples/s | 76.0 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00076 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.642 | acc=1.0000 | 1521.7 samples/s | 23.8 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00070 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.642 | acc=1.0000 | 4888.1 samples/s | 76.4 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00064 | Reg=0.00229 | L2-Norm=15.122 | L2-Norm(final)=2.643 | acc=1.0000 | 4974.9 samples/s | 77.7 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00060 | Reg=0.00228 | L2-Norm=15.114 | L2-Norm(final)=2.643 | acc=1.0000 | 4837.1 samples/s | 75.6 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00056 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.644 | acc=1.0000 | 4605.1 samples/s | 72.0 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00052 | Reg=0.00228 | L2-Norm=15.096 | L2-Norm(final)=2.644 | acc=1.0000 | 4791.9 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34678 | acc=0.7826 | tpr=0.6876 | fpr=0.0111 | 4511.0 samples/s | 17.6 steps/s
Avg test loss: 0.35792, Avg test acc: 0.77947, Avg tpr: 0.68491, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.35994 | acc=0.8720 | tpr=0.9602 | fpr=0.1296 | 4547.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.36764 | acc=0.8706 | tpr=0.9765 | fpr=0.1314 | 9296.0 samples/s | 36.3 steps/s
[Step= 150] | Loss=0.37499 | acc=0.8708 | tpr=0.9798 | fpr=0.1313 | 9078.2 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.37535 | acc=0.8712 | tpr=0.9836 | fpr=0.1309 | 9491.6 samples/s | 37.1 steps/s
[Step= 250] | Loss=0.37282 | acc=0.8712 | tpr=0.9825 | fpr=0.1309 | 8988.8 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.37548 | acc=0.8710 | tpr=0.9818 | fpr=0.1310 | 9415.8 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.37761 | acc=0.8713 | tpr=0.9806 | fpr=0.1307 | 9457.7 samples/s | 36.9 steps/s
[Step= 400] | Loss=0.37892 | acc=0.8710 | tpr=0.9787 | fpr=0.1310 | 8862.2 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.38266 | acc=0.8705 | tpr=0.9800 | fpr=0.1315 | 9080.0 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.38246 | acc=0.8700 | tpr=0.9797 | fpr=0.1319 | 9455.0 samples/s | 36.9 steps/s
[Step= 550] | Loss=0.38032 | acc=0.8708 | tpr=0.9801 | fpr=0.1312 | 17543.4 samples/s | 68.5 steps/s
Avg test loss: 0.38022, Avg test acc: 0.87078, Avg tpr: 0.98019, Avg fpr: 0.13121, total FA: 18218

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.27183 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.677 | acc=0.8125 | 3931.4 samples/s | 61.4 steps/s
[Step=16050 Epoch=15.7] | Loss=0.04870 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.669 | acc=0.9531 | 4530.2 samples/s | 70.8 steps/s
[Step=16100 Epoch=15.7] | Loss=0.03110 | Reg=0.00228 | L2-Norm=15.102 | L2-Norm(final)=2.676 | acc=0.9844 | 4919.8 samples/s | 76.9 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02582 | Reg=0.00228 | L2-Norm=15.108 | L2-Norm(final)=2.684 | acc=0.9375 | 4992.4 samples/s | 78.0 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02330 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.689 | acc=0.9844 | 4984.7 samples/s | 77.9 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02159 | Reg=0.00228 | L2-Norm=15.116 | L2-Norm(final)=2.694 | acc=1.0000 | 4907.5 samples/s | 76.7 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02101 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.698 | acc=0.9844 | 5027.2 samples/s | 78.5 steps/s
[Step=16350 Epoch=16.0] | Loss=0.02007 | Reg=0.00229 | L2-Norm=15.123 | L2-Norm(final)=2.702 | acc=1.0000 | 4909.7 samples/s | 76.7 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01934 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.705 | acc=0.9844 | 4978.4 samples/s | 77.8 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01845 | Reg=0.00229 | L2-Norm=15.128 | L2-Norm(final)=2.708 | acc=1.0000 | 4075.9 samples/s | 63.7 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01817 | Reg=0.00229 | L2-Norm=15.131 | L2-Norm(final)=2.711 | acc=0.9844 | 3978.7 samples/s | 62.2 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01793 | Reg=0.00229 | L2-Norm=15.133 | L2-Norm(final)=2.713 | acc=0.9844 | 3997.8 samples/s | 62.5 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01753 | Reg=0.00229 | L2-Norm=15.136 | L2-Norm(final)=2.716 | acc=0.9844 | 3945.4 samples/s | 61.6 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01746 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.718 | acc=1.0000 | 3973.8 samples/s | 62.1 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01738 | Reg=0.00229 | L2-Norm=15.140 | L2-Norm(final)=2.720 | acc=0.9844 | 3939.0 samples/s | 61.5 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01719 | Reg=0.00229 | L2-Norm=15.143 | L2-Norm(final)=2.722 | acc=0.9844 | 3965.4 samples/s | 62.0 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01699 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.724 | acc=0.9844 | 3975.0 samples/s | 62.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.01153 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.677 | acc=0.9844 | 2792.4 samples/s | 43.6 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00478 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.669 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00258 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.670 | acc=1.0000 | 4728.3 samples/s | 73.9 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00175 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.671 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00132 | Reg=0.00228 | L2-Norm=15.101 | L2-Norm(final)=2.672 | acc=1.0000 | 4784.2 samples/s | 74.8 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00106 | Reg=0.00228 | L2-Norm=15.097 | L2-Norm(final)=2.673 | acc=1.0000 | 4807.6 samples/s | 75.1 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00089 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.674 | acc=1.0000 | 4775.6 samples/s | 74.6 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00076 | Reg=0.00228 | L2-Norm=15.087 | L2-Norm(final)=2.675 | acc=1.0000 | 4843.2 samples/s | 75.7 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00067 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.675 | acc=1.0000 | 4875.7 samples/s | 76.2 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00060 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.676 | acc=1.0000 | 4842.1 samples/s | 75.7 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00054 | Reg=0.00227 | L2-Norm=15.072 | L2-Norm(final)=2.676 | acc=1.0000 | 4856.0 samples/s | 75.9 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00050 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.677 | acc=1.0000 | 1520.2 samples/s | 23.8 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00045 | Reg=0.00227 | L2-Norm=15.061 | L2-Norm(final)=2.677 | acc=1.0000 | 4773.4 samples/s | 74.6 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00042 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.678 | acc=1.0000 | 4742.3 samples/s | 74.1 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00039 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.678 | acc=1.0000 | 4827.1 samples/s | 75.4 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00037 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.679 | acc=1.0000 | 4837.4 samples/s | 75.6 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00034 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.679 | acc=1.0000 | 4849.6 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29669 | acc=0.8169 | tpr=0.7373 | fpr=0.0104 | 4527.8 samples/s | 17.7 steps/s
Avg test loss: 0.30752, Avg test acc: 0.81365, Avg tpr: 0.73416, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.37444 | acc=0.8742 | tpr=0.9646 | fpr=0.1274 | 4538.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.38064 | acc=0.8743 | tpr=0.9787 | fpr=0.1277 | 9248.7 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.38675 | acc=0.8750 | tpr=0.9813 | fpr=0.1269 | 9246.7 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.38736 | acc=0.8751 | tpr=0.9847 | fpr=0.1269 | 9336.8 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.38364 | acc=0.8756 | tpr=0.9834 | fpr=0.1264 | 9176.0 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.38596 | acc=0.8754 | tpr=0.9811 | fpr=0.1265 | 9104.7 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.38797 | acc=0.8750 | tpr=0.9793 | fpr=0.1269 | 9302.0 samples/s | 36.3 steps/s
[Step= 400] | Loss=0.38923 | acc=0.8744 | tpr=0.9765 | fpr=0.1275 | 9216.1 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.39287 | acc=0.8740 | tpr=0.9776 | fpr=0.1279 | 9119.6 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.39230 | acc=0.8737 | tpr=0.9775 | fpr=0.1281 | 8991.3 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.38995 | acc=0.8742 | tpr=0.9781 | fpr=0.1277 | 17491.3 samples/s | 68.3 steps/s
Avg test loss: 0.38984, Avg test acc: 0.87425, Avg tpr: 0.97821, Avg fpr: 0.12764, total FA: 17723

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.14148 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.720 | acc=0.9375 | 3797.1 samples/s | 59.3 steps/s
[Step=16850 Epoch=16.5] | Loss=0.04346 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.713 | acc=1.0000 | 4953.2 samples/s | 77.4 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02975 | Reg=0.00227 | L2-Norm=15.052 | L2-Norm(final)=2.717 | acc=0.9844 | 4907.2 samples/s | 76.7 steps/s
[Step=16950 Epoch=16.5] | Loss=0.02407 | Reg=0.00227 | L2-Norm=15.058 | L2-Norm(final)=2.721 | acc=0.9844 | 5034.7 samples/s | 78.7 steps/s
[Step=17000 Epoch=16.6] | Loss=0.02174 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.726 | acc=1.0000 | 5088.0 samples/s | 79.5 steps/s
[Step=17050 Epoch=16.6] | Loss=0.02038 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.730 | acc=0.9844 | 4847.0 samples/s | 75.7 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01911 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.734 | acc=0.9844 | 5144.6 samples/s | 80.4 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01829 | Reg=0.00227 | L2-Norm=15.071 | L2-Norm(final)=2.737 | acc=1.0000 | 5083.8 samples/s | 79.4 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01752 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.740 | acc=1.0000 | 4885.0 samples/s | 76.3 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01723 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.743 | acc=1.0000 | 4896.3 samples/s | 76.5 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01709 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.745 | acc=0.9688 | 4999.7 samples/s | 78.1 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01658 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.747 | acc=1.0000 | 4950.0 samples/s | 77.3 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01643 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.749 | acc=0.9844 | 5063.7 samples/s | 79.1 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01623 | Reg=0.00228 | L2-Norm=15.086 | L2-Norm(final)=2.751 | acc=0.9531 | 4472.7 samples/s | 69.9 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01604 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.753 | acc=0.9844 | 3944.6 samples/s | 61.6 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01572 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.755 | acc=1.0000 | 3953.9 samples/s | 61.8 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01550 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.758 | acc=1.0000 | 3945.4 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.06960 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.719 | acc=0.9531 | 3116.6 samples/s | 48.7 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00346 | Reg=0.00226 | L2-Norm=15.050 | L2-Norm(final)=2.713 | acc=1.0000 | 4773.7 samples/s | 74.6 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00183 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.715 | acc=1.0000 | 4842.6 samples/s | 75.7 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00128 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.716 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00097 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.718 | acc=1.0000 | 4755.0 samples/s | 74.3 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00078 | Reg=0.00226 | L2-Norm=15.046 | L2-Norm(final)=2.719 | acc=1.0000 | 5033.2 samples/s | 78.6 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00066 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.720 | acc=1.0000 | 4782.1 samples/s | 74.7 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00056 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.721 | acc=1.0000 | 4754.6 samples/s | 74.3 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00050 | Reg=0.00226 | L2-Norm=15.030 | L2-Norm(final)=2.721 | acc=1.0000 | 4425.2 samples/s | 69.1 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00044 | Reg=0.00226 | L2-Norm=15.024 | L2-Norm(final)=2.722 | acc=1.0000 | 4609.9 samples/s | 72.0 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00040 | Reg=0.00226 | L2-Norm=15.019 | L2-Norm(final)=2.723 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00036 | Reg=0.00225 | L2-Norm=15.013 | L2-Norm(final)=2.723 | acc=1.0000 | 1525.9 samples/s | 23.8 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00033 | Reg=0.00225 | L2-Norm=15.006 | L2-Norm(final)=2.724 | acc=1.0000 | 4977.6 samples/s | 77.8 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00031 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.724 | acc=1.0000 | 4739.1 samples/s | 74.0 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00029 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.725 | acc=1.0000 | 4758.9 samples/s | 74.4 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00027 | Reg=0.00225 | L2-Norm=14.988 | L2-Norm(final)=2.725 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00025 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.726 | acc=1.0000 | 4839.5 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33466 | acc=0.8003 | tpr=0.7123 | fpr=0.0087 | 4544.4 samples/s | 17.8 steps/s
Avg test loss: 0.34741, Avg test acc: 0.79530, Avg tpr: 0.70665, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.40141 | acc=0.8690 | tpr=0.9646 | fpr=0.1327 | 4551.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.40757 | acc=0.8702 | tpr=0.9723 | fpr=0.1317 | 9231.9 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.41442 | acc=0.8704 | tpr=0.9741 | fpr=0.1315 | 9323.5 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.41564 | acc=0.8712 | tpr=0.9781 | fpr=0.1308 | 8978.6 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.41184 | acc=0.8714 | tpr=0.9782 | fpr=0.1305 | 8190.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.41440 | acc=0.8715 | tpr=0.9760 | fpr=0.1304 | 9201.9 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.41651 | acc=0.8717 | tpr=0.9750 | fpr=0.1302 | 9414.8 samples/s | 36.8 steps/s
[Step= 400] | Loss=0.41802 | acc=0.8710 | tpr=0.9726 | fpr=0.1308 | 8758.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.42221 | acc=0.8705 | tpr=0.9737 | fpr=0.1314 | 9161.6 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.42165 | acc=0.8701 | tpr=0.9740 | fpr=0.1318 | 9138.4 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.41931 | acc=0.8707 | tpr=0.9741 | fpr=0.1312 | 17474.8 samples/s | 68.3 steps/s
Avg test loss: 0.41914, Avg test acc: 0.87070, Avg tpr: 0.97425, Avg fpr: 0.13118, total FA: 18214

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.15254 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.760 | acc=0.9062 | 3786.1 samples/s | 59.2 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03744 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.754 | acc=0.9844 | 4603.5 samples/s | 71.9 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02484 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.756 | acc=1.0000 | 5012.9 samples/s | 78.3 steps/s
[Step=17750 Epoch=17.3] | Loss=0.02092 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.761 | acc=0.9844 | 5028.9 samples/s | 78.6 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01908 | Reg=0.00225 | L2-Norm=15.004 | L2-Norm(final)=2.766 | acc=0.9844 | 5003.3 samples/s | 78.2 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01749 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.770 | acc=1.0000 | 4995.5 samples/s | 78.1 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01654 | Reg=0.00225 | L2-Norm=15.012 | L2-Norm(final)=2.774 | acc=1.0000 | 4515.6 samples/s | 70.6 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01650 | Reg=0.00225 | L2-Norm=15.015 | L2-Norm(final)=2.778 | acc=1.0000 | 3974.1 samples/s | 62.1 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01636 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.780 | acc=1.0000 | 3936.0 samples/s | 61.5 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01592 | Reg=0.00226 | L2-Norm=15.021 | L2-Norm(final)=2.783 | acc=0.9375 | 3944.3 samples/s | 61.6 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01545 | Reg=0.00226 | L2-Norm=15.023 | L2-Norm(final)=2.785 | acc=0.9844 | 4005.1 samples/s | 62.6 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01538 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.787 | acc=1.0000 | 3946.5 samples/s | 61.7 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01560 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.789 | acc=0.9844 | 3892.2 samples/s | 60.8 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01535 | Reg=0.00226 | L2-Norm=15.031 | L2-Norm(final)=2.791 | acc=0.9844 | 3990.2 samples/s | 62.3 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01537 | Reg=0.00226 | L2-Norm=15.033 | L2-Norm(final)=2.793 | acc=0.9844 | 3988.3 samples/s | 62.3 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01530 | Reg=0.00226 | L2-Norm=15.035 | L2-Norm(final)=2.795 | acc=0.9688 | 3921.2 samples/s | 61.3 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01514 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.797 | acc=1.0000 | 3945.7 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.04955 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.760 | acc=0.9219 | 3558.0 samples/s | 55.6 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00400 | Reg=0.00225 | L2-Norm=15.004 | L2-Norm(final)=2.751 | acc=1.0000 | 4723.8 samples/s | 73.8 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00206 | Reg=0.00225 | L2-Norm=15.012 | L2-Norm(final)=2.752 | acc=1.0000 | 4763.2 samples/s | 74.4 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00139 | Reg=0.00225 | L2-Norm=15.011 | L2-Norm(final)=2.753 | acc=1.0000 | 4815.9 samples/s | 75.2 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00105 | Reg=0.00225 | L2-Norm=15.009 | L2-Norm(final)=2.754 | acc=1.0000 | 4762.7 samples/s | 74.4 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00085 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.755 | acc=1.0000 | 4701.1 samples/s | 73.5 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00071 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.755 | acc=1.0000 | 4845.6 samples/s | 75.7 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00061 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.756 | acc=1.0000 | 4776.3 samples/s | 74.6 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00054 | Reg=0.00225 | L2-Norm=14.990 | L2-Norm(final)=2.757 | acc=1.0000 | 4724.5 samples/s | 73.8 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00048 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.758 | acc=1.0000 | 4816.9 samples/s | 75.3 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00044 | Reg=0.00224 | L2-Norm=14.980 | L2-Norm(final)=2.758 | acc=1.0000 | 4765.0 samples/s | 74.5 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00040 | Reg=0.00224 | L2-Norm=14.975 | L2-Norm(final)=2.759 | acc=1.0000 | 1519.2 samples/s | 23.7 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00037 | Reg=0.00224 | L2-Norm=14.969 | L2-Norm(final)=2.760 | acc=1.0000 | 4767.4 samples/s | 74.5 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00034 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.760 | acc=1.0000 | 4690.3 samples/s | 73.3 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00031 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.761 | acc=1.0000 | 4695.5 samples/s | 73.4 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00029 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.761 | acc=1.0000 | 4651.8 samples/s | 72.7 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00028 | Reg=0.00223 | L2-Norm=14.945 | L2-Norm(final)=2.762 | acc=1.0000 | 4811.0 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26724 | acc=0.8378 | tpr=0.7689 | fpr=0.0126 | 4530.1 samples/s | 17.7 steps/s
Avg test loss: 0.27649, Avg test acc: 0.83376, Avg tpr: 0.76429, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.45602 | acc=0.8585 | tpr=0.9690 | fpr=0.1435 | 4609.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.46254 | acc=0.8594 | tpr=0.9808 | fpr=0.1429 | 9128.9 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.46936 | acc=0.8592 | tpr=0.9813 | fpr=0.1431 | 9281.5 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.47167 | acc=0.8593 | tpr=0.9847 | fpr=0.1430 | 9529.8 samples/s | 37.2 steps/s
[Step= 250] | Loss=0.46761 | acc=0.8593 | tpr=0.9852 | fpr=0.1430 | 8864.4 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.47088 | acc=0.8590 | tpr=0.9833 | fpr=0.1433 | 9275.4 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.47288 | acc=0.8588 | tpr=0.9818 | fpr=0.1434 | 9330.2 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.47420 | acc=0.8587 | tpr=0.9798 | fpr=0.1435 | 9346.4 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.47865 | acc=0.8581 | tpr=0.9810 | fpr=0.1441 | 9151.0 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.47812 | acc=0.8577 | tpr=0.9811 | fpr=0.1445 | 9330.1 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.47592 | acc=0.8582 | tpr=0.9813 | fpr=0.1440 | 16935.0 samples/s | 66.2 steps/s
Avg test loss: 0.47570, Avg test acc: 0.85825, Avg tpr: 0.98138, Avg fpr: 0.14399, total FA: 19993

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.16726 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.797 | acc=0.8906 | 3646.1 samples/s | 57.0 steps/s
[Step=18450 Epoch=18.0] | Loss=0.02956 | Reg=0.00223 | L2-Norm=14.943 | L2-Norm(final)=2.795 | acc=1.0000 | 4878.8 samples/s | 76.2 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02237 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.800 | acc=0.9844 | 4955.1 samples/s | 77.4 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01934 | Reg=0.00224 | L2-Norm=14.958 | L2-Norm(final)=2.804 | acc=0.9844 | 5021.5 samples/s | 78.5 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01756 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.808 | acc=1.0000 | 5031.5 samples/s | 78.6 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01629 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.812 | acc=0.9844 | 5115.7 samples/s | 79.9 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01571 | Reg=0.00224 | L2-Norm=14.969 | L2-Norm(final)=2.815 | acc=1.0000 | 5020.2 samples/s | 78.4 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01558 | Reg=0.00224 | L2-Norm=14.972 | L2-Norm(final)=2.817 | acc=1.0000 | 4962.5 samples/s | 77.5 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01544 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.820 | acc=1.0000 | 4915.8 samples/s | 76.8 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01491 | Reg=0.00224 | L2-Norm=14.977 | L2-Norm(final)=2.822 | acc=0.9688 | 4345.0 samples/s | 67.9 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01503 | Reg=0.00224 | L2-Norm=14.980 | L2-Norm(final)=2.825 | acc=0.9844 | 3993.0 samples/s | 62.4 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01497 | Reg=0.00224 | L2-Norm=14.983 | L2-Norm(final)=2.826 | acc=0.9688 | 3958.7 samples/s | 61.9 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01481 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.828 | acc=1.0000 | 3959.1 samples/s | 61.9 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01451 | Reg=0.00225 | L2-Norm=14.988 | L2-Norm(final)=2.830 | acc=0.9844 | 3952.4 samples/s | 61.8 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01426 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.832 | acc=0.9844 | 3996.2 samples/s | 62.4 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01398 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.835 | acc=0.9844 | 3905.0 samples/s | 61.0 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01398 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.837 | acc=0.9844 | 4005.8 samples/s | 62.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.01557 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.797 | acc=0.9844 | 3355.9 samples/s | 52.4 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00450 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.786 | acc=1.0000 | 4811.1 samples/s | 75.2 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00231 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.786 | acc=1.0000 | 4814.2 samples/s | 75.2 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00157 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.787 | acc=1.0000 | 4839.2 samples/s | 75.6 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00118 | Reg=0.00224 | L2-Norm=14.950 | L2-Norm(final)=2.787 | acc=1.0000 | 4739.4 samples/s | 74.1 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00095 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.788 | acc=1.0000 | 4637.6 samples/s | 72.5 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00080 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.789 | acc=1.0000 | 4757.2 samples/s | 74.3 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00068 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.789 | acc=1.0000 | 4778.0 samples/s | 74.7 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00060 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.790 | acc=1.0000 | 4850.0 samples/s | 75.8 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00054 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.791 | acc=1.0000 | 4672.1 samples/s | 73.0 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00048 | Reg=0.00223 | L2-Norm=14.920 | L2-Norm(final)=2.791 | acc=1.0000 | 4867.7 samples/s | 76.1 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00044 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.792 | acc=1.0000 | 1518.3 samples/s | 23.7 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00041 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.793 | acc=1.0000 | 4764.5 samples/s | 74.4 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00038 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.794 | acc=1.0000 | 4857.8 samples/s | 75.9 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00035 | Reg=0.00222 | L2-Norm=14.897 | L2-Norm(final)=2.794 | acc=1.0000 | 4810.8 samples/s | 75.2 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00033 | Reg=0.00222 | L2-Norm=14.891 | L2-Norm(final)=2.795 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00031 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.796 | acc=1.0000 | 4843.8 samples/s | 75.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24777 | acc=0.8488 | tpr=0.7851 | fpr=0.0129 | 4511.9 samples/s | 17.6 steps/s
Avg test loss: 0.25887, Avg test acc: 0.84502, Avg tpr: 0.78126, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.46359 | acc=0.8591 | tpr=0.9690 | fpr=0.1429 | 4570.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.46933 | acc=0.8600 | tpr=0.9765 | fpr=0.1422 | 9373.5 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.47466 | acc=0.8607 | tpr=0.9769 | fpr=0.1414 | 9368.2 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.47800 | acc=0.8609 | tpr=0.9803 | fpr=0.1413 | 9174.4 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.47414 | acc=0.8607 | tpr=0.9808 | fpr=0.1415 | 9679.6 samples/s | 37.8 steps/s
[Step= 300] | Loss=0.47734 | acc=0.8604 | tpr=0.9811 | fpr=0.1418 | 8874.9 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.48027 | acc=0.8597 | tpr=0.9806 | fpr=0.1425 | 9314.2 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.48122 | acc=0.8597 | tpr=0.9787 | fpr=0.1425 | 9204.3 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.48577 | acc=0.8591 | tpr=0.9791 | fpr=0.1431 | 9465.5 samples/s | 37.0 steps/s
[Step= 500] | Loss=0.48458 | acc=0.8590 | tpr=0.9789 | fpr=0.1432 | 9204.2 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.48244 | acc=0.8594 | tpr=0.9789 | fpr=0.1428 | 16319.1 samples/s | 63.7 steps/s
Avg test loss: 0.48214, Avg test acc: 0.85943, Avg tpr: 0.97900, Avg fpr: 0.14275, total FA: 19820

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.08898 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.838 | acc=0.9375 | 3815.2 samples/s | 59.6 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02741 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.839 | acc=0.9688 | 4831.8 samples/s | 75.5 steps/s
[Step=19300 Epoch=18.8] | Loss=0.01918 | Reg=0.00222 | L2-Norm=14.904 | L2-Norm(final)=2.843 | acc=0.9844 | 4898.0 samples/s | 76.5 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01684 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.849 | acc=1.0000 | 5023.9 samples/s | 78.5 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01615 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.853 | acc=0.9844 | 4988.0 samples/s | 77.9 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01591 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.856 | acc=0.9844 | 5114.5 samples/s | 79.9 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01579 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.858 | acc=1.0000 | 4982.1 samples/s | 77.8 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01511 | Reg=0.00223 | L2-Norm=14.923 | L2-Norm(final)=2.860 | acc=1.0000 | 4997.0 samples/s | 78.1 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01487 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.862 | acc=0.9844 | 5018.3 samples/s | 78.4 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01477 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.864 | acc=1.0000 | 4486.3 samples/s | 70.1 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01451 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.866 | acc=0.9844 | 3943.5 samples/s | 61.6 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01436 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.867 | acc=0.9844 | 3933.3 samples/s | 61.5 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01417 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.869 | acc=1.0000 | 3913.8 samples/s | 61.2 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01393 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.872 | acc=1.0000 | 3956.9 samples/s | 61.8 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01405 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.873 | acc=1.0000 | 3971.0 samples/s | 62.0 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01404 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.875 | acc=0.9844 | 3951.6 samples/s | 61.7 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01393 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.877 | acc=0.9844 | 3991.2 samples/s | 62.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.01976 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.837 | acc=0.9844 | 3537.1 samples/s | 55.3 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00640 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.823 | acc=1.0000 | 4722.0 samples/s | 73.8 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00326 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.820 | acc=1.0000 | 4779.9 samples/s | 74.7 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00220 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.820 | acc=1.0000 | 4605.3 samples/s | 72.0 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00165 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.820 | acc=1.0000 | 4728.4 samples/s | 73.9 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00135 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.821 | acc=1.0000 | 4833.4 samples/s | 75.5 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00113 | Reg=0.00222 | L2-Norm=14.916 | L2-Norm(final)=2.821 | acc=1.0000 | 4866.3 samples/s | 76.0 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00097 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.822 | acc=1.0000 | 4642.3 samples/s | 72.5 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00085 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.822 | acc=1.0000 | 4912.0 samples/s | 76.7 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00077 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.823 | acc=1.0000 | 4826.0 samples/s | 75.4 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00069 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.823 | acc=1.0000 | 4824.8 samples/s | 75.4 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00063 | Reg=0.00222 | L2-Norm=14.894 | L2-Norm(final)=2.824 | acc=1.0000 | 1483.8 samples/s | 23.2 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00058 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.824 | acc=1.0000 | 4930.7 samples/s | 77.0 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00054 | Reg=0.00222 | L2-Norm=14.884 | L2-Norm(final)=2.825 | acc=1.0000 | 4843.8 samples/s | 75.7 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00050 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.825 | acc=1.0000 | 4746.1 samples/s | 74.2 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00047 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.825 | acc=1.0000 | 4867.6 samples/s | 76.1 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00044 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.826 | acc=1.0000 | 4782.4 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28055 | acc=0.8280 | tpr=0.7545 | fpr=0.0121 | 4526.9 samples/s | 17.7 steps/s
Avg test loss: 0.29151, Avg test acc: 0.82515, Avg tpr: 0.75188, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.38045 | acc=0.8905 | tpr=0.9735 | fpr=0.1110 | 4545.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.39128 | acc=0.8900 | tpr=0.9808 | fpr=0.1117 | 9412.0 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.39872 | acc=0.8911 | tpr=0.9813 | fpr=0.1106 | 9248.0 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.40233 | acc=0.8906 | tpr=0.9836 | fpr=0.1111 | 9114.4 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.39879 | acc=0.8912 | tpr=0.9843 | fpr=0.1105 | 9543.5 samples/s | 37.3 steps/s
[Step= 300] | Loss=0.40132 | acc=0.8907 | tpr=0.9818 | fpr=0.1109 | 9239.1 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.40373 | acc=0.8903 | tpr=0.9818 | fpr=0.1113 | 9461.3 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.40513 | acc=0.8900 | tpr=0.9809 | fpr=0.1117 | 9238.7 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.40977 | acc=0.8893 | tpr=0.9810 | fpr=0.1124 | 9301.6 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.40870 | acc=0.8891 | tpr=0.9806 | fpr=0.1125 | 8904.9 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.40684 | acc=0.8894 | tpr=0.9801 | fpr=0.1123 | 16809.7 samples/s | 65.7 steps/s
Avg test loss: 0.40644, Avg test acc: 0.88941, Avg tpr: 0.98019, Avg fpr: 0.11224, total FA: 15584

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.07749 | Reg=0.00220 | L2-Norm=14.834 | L2-Norm(final)=2.867 | acc=0.9531 | 3643.2 samples/s | 56.9 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02795 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.869 | acc=0.9844 | 5018.4 samples/s | 78.4 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02083 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.875 | acc=1.0000 | 5089.4 samples/s | 79.5 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01830 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.881 | acc=1.0000 | 4974.6 samples/s | 77.7 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01661 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.886 | acc=1.0000 | 4960.9 samples/s | 77.5 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01576 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.890 | acc=0.9688 | 5113.3 samples/s | 79.9 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01527 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.893 | acc=0.9844 | 4936.0 samples/s | 77.1 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01505 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.896 | acc=1.0000 | 4999.2 samples/s | 78.1 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01460 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.898 | acc=1.0000 | 5095.6 samples/s | 79.6 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01420 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.901 | acc=1.0000 | 4705.2 samples/s | 73.5 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01409 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.903 | acc=1.0000 | 3983.1 samples/s | 62.2 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01412 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.905 | acc=0.9688 | 3955.7 samples/s | 61.8 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01412 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.907 | acc=0.9688 | 3970.5 samples/s | 62.0 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01414 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.909 | acc=1.0000 | 3993.3 samples/s | 62.4 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01416 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.911 | acc=0.9844 | 3972.5 samples/s | 62.1 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01416 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.913 | acc=1.0000 | 3907.0 samples/s | 61.0 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01401 | Reg=0.00223 | L2-Norm=14.923 | L2-Norm(final)=2.914 | acc=0.9844 | 4017.8 samples/s | 62.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.07637 | Reg=0.00220 | L2-Norm=14.834 | L2-Norm(final)=2.867 | acc=0.9219 | 3670.1 samples/s | 57.3 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00333 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.865 | acc=1.0000 | 4842.4 samples/s | 75.7 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00211 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.864 | acc=1.0000 | 4764.5 samples/s | 74.4 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00145 | Reg=0.00221 | L2-Norm=14.881 | L2-Norm(final)=2.863 | acc=1.0000 | 4868.8 samples/s | 76.1 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00110 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.864 | acc=1.0000 | 4656.8 samples/s | 72.8 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00088 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.864 | acc=1.0000 | 4796.9 samples/s | 75.0 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00074 | Reg=0.00221 | L2-Norm=14.872 | L2-Norm(final)=2.864 | acc=1.0000 | 4728.0 samples/s | 73.9 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00064 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.865 | acc=1.0000 | 4959.4 samples/s | 77.5 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00056 | Reg=0.00221 | L2-Norm=14.863 | L2-Norm(final)=2.865 | acc=1.0000 | 4910.8 samples/s | 76.7 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00050 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.866 | acc=1.0000 | 4797.0 samples/s | 75.0 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00045 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.866 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00041 | Reg=0.00221 | L2-Norm=14.849 | L2-Norm(final)=2.866 | acc=1.0000 | 1476.0 samples/s | 23.1 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00038 | Reg=0.00220 | L2-Norm=14.845 | L2-Norm(final)=2.867 | acc=1.0000 | 4885.6 samples/s | 76.3 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00035 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.867 | acc=1.0000 | 4704.6 samples/s | 73.5 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00032 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.867 | acc=1.0000 | 4763.3 samples/s | 74.4 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00030 | Reg=0.00220 | L2-Norm=14.829 | L2-Norm(final)=2.868 | acc=1.0000 | 4777.3 samples/s | 74.6 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00028 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.868 | acc=1.0000 | 4877.2 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27789 | acc=0.8377 | tpr=0.7662 | fpr=0.0072 | 4477.7 samples/s | 17.5 steps/s
Avg test loss: 0.29047, Avg test acc: 0.83188, Avg tpr: 0.75992, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.41323 | acc=0.8745 | tpr=0.9690 | fpr=0.1272 | 4622.0 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.42230 | acc=0.8745 | tpr=0.9765 | fpr=0.1274 | 8791.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.42902 | acc=0.8752 | tpr=0.9784 | fpr=0.1267 | 9608.0 samples/s | 37.5 steps/s
[Step= 200] | Loss=0.43055 | acc=0.8760 | tpr=0.9814 | fpr=0.1259 | 8822.0 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.42645 | acc=0.8759 | tpr=0.9799 | fpr=0.1260 | 9634.6 samples/s | 37.6 steps/s
[Step= 300] | Loss=0.42919 | acc=0.8756 | tpr=0.9796 | fpr=0.1263 | 9120.4 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.43156 | acc=0.8756 | tpr=0.9787 | fpr=0.1263 | 9209.6 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.43355 | acc=0.8749 | tpr=0.9759 | fpr=0.1269 | 9063.4 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.43780 | acc=0.8745 | tpr=0.9771 | fpr=0.1274 | 9038.9 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.43704 | acc=0.8741 | tpr=0.9767 | fpr=0.1277 | 9009.3 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.43497 | acc=0.8746 | tpr=0.9769 | fpr=0.1273 | 17543.4 samples/s | 68.5 steps/s
Avg test loss: 0.43473, Avg test acc: 0.87461, Avg tpr: 0.97702, Avg fpr: 0.12725, total FA: 17669

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.10277 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.907 | acc=0.9375 | 3709.8 samples/s | 58.0 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02829 | Reg=0.00220 | L2-Norm=14.827 | L2-Norm(final)=2.904 | acc=1.0000 | 4940.1 samples/s | 77.2 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01938 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.909 | acc=1.0000 | 4894.9 samples/s | 76.5 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01685 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.914 | acc=1.0000 | 5031.7 samples/s | 78.6 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01644 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.918 | acc=1.0000 | 4983.2 samples/s | 77.9 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01519 | Reg=0.00221 | L2-Norm=14.852 | L2-Norm(final)=2.921 | acc=0.9844 | 5004.1 samples/s | 78.2 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01433 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.925 | acc=1.0000 | 4991.4 samples/s | 78.0 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01424 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.928 | acc=1.0000 | 4980.3 samples/s | 77.8 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01387 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.931 | acc=0.9844 | 5103.4 samples/s | 79.7 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01358 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.933 | acc=1.0000 | 5184.4 samples/s | 81.0 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01332 | Reg=0.00221 | L2-Norm=14.867 | L2-Norm(final)=2.935 | acc=1.0000 | 4963.6 samples/s | 77.6 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01351 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.937 | acc=0.9688 | 5048.5 samples/s | 78.9 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01343 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.939 | acc=0.9844 | 4967.2 samples/s | 77.6 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01343 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.941 | acc=1.0000 | 4962.2 samples/s | 77.5 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01333 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.943 | acc=0.9844 | 4939.4 samples/s | 77.2 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01333 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.945 | acc=1.0000 | 5014.4 samples/s | 78.3 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01338 | Reg=0.00221 | L2-Norm=14.881 | L2-Norm(final)=2.946 | acc=0.9688 | 4750.8 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.04663 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.906 | acc=0.9688 | 2858.7 samples/s | 44.7 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00275 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.899 | acc=1.0000 | 4551.9 samples/s | 71.1 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00146 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.899 | acc=1.0000 | 4737.2 samples/s | 74.0 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00098 | Reg=0.00221 | L2-Norm=14.850 | L2-Norm(final)=2.900 | acc=1.0000 | 4722.8 samples/s | 73.8 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00074 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.900 | acc=1.0000 | 4793.3 samples/s | 74.9 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00060 | Reg=0.00220 | L2-Norm=14.843 | L2-Norm(final)=2.901 | acc=1.0000 | 4796.7 samples/s | 74.9 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00050 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.901 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00044 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.902 | acc=1.0000 | 4710.3 samples/s | 73.6 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00038 | Reg=0.00220 | L2-Norm=14.828 | L2-Norm(final)=2.903 | acc=1.0000 | 4782.1 samples/s | 74.7 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00034 | Reg=0.00220 | L2-Norm=14.823 | L2-Norm(final)=2.903 | acc=1.0000 | 4723.7 samples/s | 73.8 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00031 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.904 | acc=1.0000 | 4877.6 samples/s | 76.2 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00028 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.904 | acc=1.0000 | 1479.7 samples/s | 23.1 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00026 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.905 | acc=1.0000 | 4896.8 samples/s | 76.5 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00024 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.905 | acc=1.0000 | 4840.0 samples/s | 75.6 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00022 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.906 | acc=1.0000 | 4897.6 samples/s | 76.5 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00021 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.906 | acc=1.0000 | 4738.3 samples/s | 74.0 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00020 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.907 | acc=1.0000 | 4837.5 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27675 | acc=0.8303 | tpr=0.7570 | fpr=0.0104 | 4459.6 samples/s | 17.4 steps/s
Avg test loss: 0.28703, Avg test acc: 0.82635, Avg tpr: 0.75270, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.37057 | acc=0.8887 | tpr=0.9646 | fpr=0.1127 | 4553.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.37884 | acc=0.8885 | tpr=0.9723 | fpr=0.1130 | 9080.4 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.38487 | acc=0.8900 | tpr=0.9741 | fpr=0.1116 | 9621.5 samples/s | 37.6 steps/s
[Step= 200] | Loss=0.38645 | acc=0.8903 | tpr=0.9781 | fpr=0.1113 | 8916.1 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.38302 | acc=0.8905 | tpr=0.9782 | fpr=0.1111 | 9350.7 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.38622 | acc=0.8899 | tpr=0.9767 | fpr=0.1117 | 8916.7 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.38834 | acc=0.8898 | tpr=0.9768 | fpr=0.1118 | 9936.6 samples/s | 38.8 steps/s
[Step= 400] | Loss=0.38958 | acc=0.8893 | tpr=0.9748 | fpr=0.1123 | 8829.6 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.39367 | acc=0.8886 | tpr=0.9747 | fpr=0.1129 | 9328.9 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.39281 | acc=0.8882 | tpr=0.9749 | fpr=0.1133 | 9155.5 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.39102 | acc=0.8886 | tpr=0.9757 | fpr=0.1129 | 16751.6 samples/s | 65.4 steps/s
Avg test loss: 0.39086, Avg test acc: 0.88868, Avg tpr: 0.97583, Avg fpr: 0.11290, total FA: 15676

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.14147 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.943 | acc=0.8594 | 3708.1 samples/s | 57.9 steps/s
[Step=21650 Epoch=21.1] | Loss=0.03040 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.944 | acc=0.9688 | 5085.6 samples/s | 79.5 steps/s
[Step=21700 Epoch=21.2] | Loss=0.02046 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.946 | acc=0.9844 | 5056.6 samples/s | 79.0 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01804 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.951 | acc=1.0000 | 5034.6 samples/s | 78.7 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01617 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.954 | acc=1.0000 | 4874.7 samples/s | 76.2 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01455 | Reg=0.00220 | L2-Norm=14.820 | L2-Norm(final)=2.958 | acc=0.9844 | 4725.3 samples/s | 73.8 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01390 | Reg=0.00220 | L2-Norm=14.823 | L2-Norm(final)=2.962 | acc=0.9844 | 3995.3 samples/s | 62.4 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01378 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.965 | acc=1.0000 | 4013.4 samples/s | 62.7 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01330 | Reg=0.00220 | L2-Norm=14.828 | L2-Norm(final)=2.968 | acc=0.9844 | 3909.9 samples/s | 61.1 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01318 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.970 | acc=1.0000 | 4006.0 samples/s | 62.6 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01306 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.973 | acc=1.0000 | 3963.7 samples/s | 61.9 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01294 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.976 | acc=1.0000 | 3968.7 samples/s | 62.0 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01280 | Reg=0.00220 | L2-Norm=14.839 | L2-Norm(final)=2.978 | acc=0.9844 | 3970.5 samples/s | 62.0 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01274 | Reg=0.00220 | L2-Norm=14.841 | L2-Norm(final)=2.981 | acc=1.0000 | 3954.0 samples/s | 61.8 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01290 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.983 | acc=0.9688 | 3960.8 samples/s | 61.9 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01292 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.985 | acc=0.9844 | 3859.4 samples/s | 60.3 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01301 | Reg=0.00220 | L2-Norm=14.849 | L2-Norm(final)=2.987 | acc=0.9844 | 3928.1 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.00327 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.943 | acc=1.0000 | 2908.8 samples/s | 45.5 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00166 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.938 | acc=1.0000 | 4421.1 samples/s | 69.1 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00086 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.939 | acc=1.0000 | 4705.7 samples/s | 73.5 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00060 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.940 | acc=1.0000 | 4793.0 samples/s | 74.9 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00046 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.941 | acc=1.0000 | 4710.3 samples/s | 73.6 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00037 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.942 | acc=1.0000 | 4795.5 samples/s | 74.9 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00031 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.943 | acc=1.0000 | 4841.2 samples/s | 75.6 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00027 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.944 | acc=1.0000 | 4795.0 samples/s | 74.9 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00024 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.944 | acc=1.0000 | 4816.5 samples/s | 75.3 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00021 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.945 | acc=1.0000 | 4825.6 samples/s | 75.4 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00019 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.946 | acc=1.0000 | 4806.1 samples/s | 75.1 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00018 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.946 | acc=1.0000 | 1514.8 samples/s | 23.7 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00016 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.947 | acc=1.0000 | 4871.4 samples/s | 76.1 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00015 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.947 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00014 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.948 | acc=1.0000 | 4732.0 samples/s | 73.9 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00013 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.948 | acc=1.0000 | 4819.7 samples/s | 75.3 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00012 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.948 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26469 | acc=0.8387 | tpr=0.7688 | fpr=0.0094 | 4536.5 samples/s | 17.7 steps/s
Avg test loss: 0.27465, Avg test acc: 0.83620, Avg tpr: 0.76628, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.42214 | acc=0.8774 | tpr=0.9646 | fpr=0.1241 | 4577.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.43293 | acc=0.8768 | tpr=0.9744 | fpr=0.1250 | 8940.8 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.44002 | acc=0.8770 | tpr=0.9784 | fpr=0.1249 | 9603.4 samples/s | 37.5 steps/s
[Step= 200] | Loss=0.44048 | acc=0.8774 | tpr=0.9814 | fpr=0.1245 | 9386.5 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.43696 | acc=0.8776 | tpr=0.9817 | fpr=0.1243 | 9037.2 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.44049 | acc=0.8771 | tpr=0.9804 | fpr=0.1248 | 9580.0 samples/s | 37.4 steps/s
[Step= 350] | Loss=0.44255 | acc=0.8767 | tpr=0.9793 | fpr=0.1252 | 8933.3 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.44357 | acc=0.8764 | tpr=0.9781 | fpr=0.1255 | 9276.7 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.44750 | acc=0.8760 | tpr=0.9776 | fpr=0.1258 | 9089.4 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.44667 | acc=0.8758 | tpr=0.9771 | fpr=0.1260 | 9449.7 samples/s | 36.9 steps/s
[Step= 550] | Loss=0.44441 | acc=0.8763 | tpr=0.9781 | fpr=0.1256 | 16736.4 samples/s | 65.4 steps/s
Avg test loss: 0.44407, Avg test acc: 0.87633, Avg tpr: 0.97821, Avg fpr: 0.12552, total FA: 17428

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.08384 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.983 | acc=0.9531 | 3815.3 samples/s | 59.6 steps/s
[Step=22450 Epoch=21.9] | Loss=0.02052 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.985 | acc=1.0000 | 4888.1 samples/s | 76.4 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01616 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.991 | acc=1.0000 | 4985.4 samples/s | 77.9 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01436 | Reg=0.00218 | L2-Norm=14.752 | L2-Norm(final)=2.995 | acc=1.0000 | 5007.9 samples/s | 78.2 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01332 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.999 | acc=1.0000 | 4949.5 samples/s | 77.3 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01328 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=3.002 | acc=1.0000 | 5091.5 samples/s | 79.6 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01309 | Reg=0.00218 | L2-Norm=14.764 | L2-Norm(final)=3.005 | acc=1.0000 | 4806.1 samples/s | 75.1 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01258 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=3.008 | acc=1.0000 | 5049.3 samples/s | 78.9 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01261 | Reg=0.00218 | L2-Norm=14.770 | L2-Norm(final)=3.012 | acc=0.9688 | 4820.8 samples/s | 75.3 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01233 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=3.015 | acc=1.0000 | 3903.8 samples/s | 61.0 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01232 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=3.018 | acc=0.9844 | 3962.5 samples/s | 61.9 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01200 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=3.021 | acc=1.0000 | 3954.1 samples/s | 61.8 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01229 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=3.023 | acc=0.9844 | 3971.7 samples/s | 62.1 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01247 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=3.025 | acc=0.9844 | 3954.3 samples/s | 61.8 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01262 | Reg=0.00219 | L2-Norm=14.786 | L2-Norm(final)=3.026 | acc=0.9688 | 3933.1 samples/s | 61.5 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01288 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=3.027 | acc=0.9688 | 3978.2 samples/s | 62.2 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01297 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=3.028 | acc=1.0000 | 3931.9 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.10793 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.982 | acc=0.9531 | 2899.1 samples/s | 45.3 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00393 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.973 | acc=1.0000 | 4650.1 samples/s | 72.7 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00207 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.973 | acc=1.0000 | 4688.3 samples/s | 73.3 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00143 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.974 | acc=1.0000 | 4699.6 samples/s | 73.4 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00108 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.975 | acc=1.0000 | 4696.5 samples/s | 73.4 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00088 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.976 | acc=1.0000 | 4960.1 samples/s | 77.5 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00074 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.977 | acc=1.0000 | 4942.7 samples/s | 77.2 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00081 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.978 | acc=1.0000 | 4792.1 samples/s | 74.9 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00080 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.978 | acc=1.0000 | 4867.7 samples/s | 76.1 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00072 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.978 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00068 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.978 | acc=1.0000 | 4796.3 samples/s | 74.9 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00062 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.979 | acc=1.0000 | 1465.9 samples/s | 22.9 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00057 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.979 | acc=1.0000 | 4888.6 samples/s | 76.4 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00053 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.980 | acc=1.0000 | 4733.6 samples/s | 74.0 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00049 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.980 | acc=1.0000 | 4840.3 samples/s | 75.6 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00046 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.981 | acc=1.0000 | 4758.3 samples/s | 74.3 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00044 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.981 | acc=1.0000 | 4683.2 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33745 | acc=0.8030 | tpr=0.7169 | fpr=0.0102 | 4513.0 samples/s | 17.6 steps/s
Avg test loss: 0.34723, Avg test acc: 0.79826, Avg tpr: 0.71166, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.37433 | acc=0.9025 | tpr=0.9646 | fpr=0.0986 | 4513.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.38211 | acc=0.9009 | tpr=0.9765 | fpr=0.1005 | 9669.2 samples/s | 37.8 steps/s
[Step= 150] | Loss=0.38985 | acc=0.9011 | tpr=0.9784 | fpr=0.1004 | 8858.0 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.39311 | acc=0.9014 | tpr=0.9814 | fpr=0.1001 | 9614.3 samples/s | 37.6 steps/s
[Step= 250] | Loss=0.38892 | acc=0.9019 | tpr=0.9817 | fpr=0.0995 | 9301.6 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.39256 | acc=0.9012 | tpr=0.9796 | fpr=0.1002 | 8861.3 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.39519 | acc=0.9010 | tpr=0.9781 | fpr=0.1004 | 9402.0 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.39650 | acc=0.9004 | tpr=0.9754 | fpr=0.1009 | 9255.0 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.40083 | acc=0.9001 | tpr=0.9757 | fpr=0.1012 | 9282.6 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.39964 | acc=0.8998 | tpr=0.9753 | fpr=0.1016 | 9062.3 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.39729 | acc=0.9000 | tpr=0.9761 | fpr=0.1014 | 16401.4 samples/s | 64.1 steps/s
Avg test loss: 0.39690, Avg test acc: 0.90002, Avg tpr: 0.97623, Avg fpr: 0.10136, total FA: 14074

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.19532 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=3.012 | acc=0.8750 | 3628.6 samples/s | 56.7 steps/s
[Step=23250 Epoch=22.7] | Loss=0.03390 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=3.006 | acc=1.0000 | 5006.2 samples/s | 78.2 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02223 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=3.011 | acc=0.9688 | 5113.4 samples/s | 79.9 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01840 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=3.015 | acc=1.0000 | 5047.2 samples/s | 78.9 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01661 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=3.020 | acc=0.9844 | 4942.1 samples/s | 77.2 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01563 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=3.024 | acc=1.0000 | 4982.3 samples/s | 77.8 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01471 | Reg=0.00218 | L2-Norm=14.766 | L2-Norm(final)=3.028 | acc=0.9844 | 5034.1 samples/s | 78.7 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01423 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=3.031 | acc=0.9844 | 4876.8 samples/s | 76.2 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01453 | Reg=0.00218 | L2-Norm=14.772 | L2-Norm(final)=3.034 | acc=0.9844 | 3943.5 samples/s | 61.6 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01426 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=3.036 | acc=0.9844 | 3969.8 samples/s | 62.0 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01394 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=3.038 | acc=1.0000 | 3963.9 samples/s | 61.9 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01380 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=3.040 | acc=1.0000 | 3971.9 samples/s | 62.1 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01374 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=3.042 | acc=1.0000 | 3960.6 samples/s | 61.9 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01366 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=3.044 | acc=0.9531 | 3908.4 samples/s | 61.1 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01363 | Reg=0.00219 | L2-Norm=14.786 | L2-Norm(final)=3.046 | acc=0.9844 | 3959.4 samples/s | 61.9 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01367 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=3.048 | acc=1.0000 | 3962.9 samples/s | 61.9 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01351 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=3.050 | acc=1.0000 | 3983.1 samples/s | 62.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.04544 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=3.012 | acc=0.9844 | 3203.8 samples/s | 50.1 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00770 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.996 | acc=1.0000 | 4475.3 samples/s | 69.9 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00402 | Reg=0.00218 | L2-Norm=14.760 | L2-Norm(final)=2.993 | acc=1.0000 | 4685.7 samples/s | 73.2 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00270 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.993 | acc=1.0000 | 4018.4 samples/s | 62.8 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00204 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.993 | acc=1.0000 | 3728.5 samples/s | 58.3 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00163 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.993 | acc=1.0000 | 3765.4 samples/s | 58.8 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00136 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.994 | acc=1.0000 | 3797.2 samples/s | 59.3 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00117 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.994 | acc=1.0000 | 3694.3 samples/s | 57.7 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00102 | Reg=0.00218 | L2-Norm=14.753 | L2-Norm(final)=2.995 | acc=1.0000 | 3748.1 samples/s | 58.6 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00091 | Reg=0.00218 | L2-Norm=14.749 | L2-Norm(final)=2.995 | acc=1.0000 | 3699.7 samples/s | 57.8 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00082 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.996 | acc=1.0000 | 3775.3 samples/s | 59.0 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00075 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.997 | acc=1.0000 | 1512.8 samples/s | 23.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00069 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.997 | acc=1.0000 | 4745.9 samples/s | 74.2 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00064 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.998 | acc=1.0000 | 4701.6 samples/s | 73.5 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00059 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.998 | acc=1.0000 | 4801.6 samples/s | 75.0 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00055 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.999 | acc=1.0000 | 4608.3 samples/s | 72.0 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00052 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.999 | acc=1.0000 | 4837.5 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27323 | acc=0.8270 | tpr=0.7521 | fpr=0.0102 | 4521.3 samples/s | 17.7 steps/s
Avg test loss: 0.28349, Avg test acc: 0.82042, Avg tpr: 0.74419, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.37457 | acc=0.8972 | tpr=0.9735 | fpr=0.1042 | 4590.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.38747 | acc=0.8957 | tpr=0.9808 | fpr=0.1059 | 9199.5 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.39651 | acc=0.8962 | tpr=0.9813 | fpr=0.1053 | 9345.5 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.39898 | acc=0.8964 | tpr=0.9836 | fpr=0.1052 | 8895.2 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.39429 | acc=0.8968 | tpr=0.9825 | fpr=0.1048 | 9350.0 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.39693 | acc=0.8961 | tpr=0.9804 | fpr=0.1054 | 9385.9 samples/s | 36.7 steps/s
[Step= 350] | Loss=0.39956 | acc=0.8956 | tpr=0.9787 | fpr=0.1059 | 9508.4 samples/s | 37.1 steps/s
[Step= 400] | Loss=0.40094 | acc=0.8952 | tpr=0.9781 | fpr=0.1063 | 8795.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.40503 | acc=0.8950 | tpr=0.9791 | fpr=0.1066 | 9141.6 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.40371 | acc=0.8947 | tpr=0.9784 | fpr=0.1068 | 9302.3 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.40129 | acc=0.8952 | tpr=0.9789 | fpr=0.1064 | 16888.2 samples/s | 66.0 steps/s
Avg test loss: 0.40094, Avg test acc: 0.89521, Avg tpr: 0.97900, Avg fpr: 0.10632, total FA: 14762

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.19743 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=3.042 | acc=0.8594 | 3599.3 samples/s | 56.2 steps/s
[Step=24050 Epoch=23.5] | Loss=0.03554 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=3.044 | acc=0.9844 | 4890.9 samples/s | 76.4 steps/s
[Step=24100 Epoch=23.5] | Loss=0.02241 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=3.048 | acc=0.9844 | 4968.1 samples/s | 77.6 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01842 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=3.052 | acc=1.0000 | 4943.2 samples/s | 77.2 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01611 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=3.056 | acc=0.9688 | 4977.2 samples/s | 77.8 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01484 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=3.059 | acc=1.0000 | 4899.0 samples/s | 76.5 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01378 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=3.061 | acc=0.9844 | 5043.2 samples/s | 78.8 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01344 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=3.064 | acc=1.0000 | 5015.6 samples/s | 78.4 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01271 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=3.067 | acc=1.0000 | 5010.7 samples/s | 78.3 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01233 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=3.069 | acc=1.0000 | 5017.9 samples/s | 78.4 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01191 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=3.071 | acc=0.9844 | 4982.1 samples/s | 77.8 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01170 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=3.073 | acc=0.9844 | 5080.6 samples/s | 79.4 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01158 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=3.075 | acc=0.9688 | 4887.3 samples/s | 76.4 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01137 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=3.077 | acc=1.0000 | 3962.7 samples/s | 61.9 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01127 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=3.079 | acc=1.0000 | 3954.9 samples/s | 61.8 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01113 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=3.081 | acc=1.0000 | 3927.8 samples/s | 61.4 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01109 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=3.083 | acc=1.0000 | 3975.3 samples/s | 62.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.02937 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=3.042 | acc=0.9844 | 3545.4 samples/s | 55.4 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00428 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=3.039 | acc=1.0000 | 4681.0 samples/s | 73.1 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00225 | Reg=0.00216 | L2-Norm=14.714 | L2-Norm(final)=3.039 | acc=1.0000 | 4914.0 samples/s | 76.8 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00151 | Reg=0.00217 | L2-Norm=14.714 | L2-Norm(final)=3.040 | acc=1.0000 | 4741.1 samples/s | 74.1 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00114 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=3.040 | acc=1.0000 | 4956.2 samples/s | 77.4 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00092 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=3.041 | acc=1.0000 | 4894.4 samples/s | 76.5 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00077 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=3.041 | acc=1.0000 | 4840.3 samples/s | 75.6 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00066 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=3.041 | acc=1.0000 | 4941.6 samples/s | 77.2 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00058 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=3.042 | acc=1.0000 | 4907.8 samples/s | 76.7 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00052 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=3.042 | acc=1.0000 | 4758.0 samples/s | 74.3 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00047 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=3.042 | acc=1.0000 | 4886.8 samples/s | 76.4 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00043 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=3.042 | acc=1.0000 | 1467.8 samples/s | 22.9 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00039 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=3.043 | acc=1.0000 | 4930.5 samples/s | 77.0 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00036 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=3.043 | acc=1.0000 | 4911.8 samples/s | 76.7 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00034 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=3.043 | acc=1.0000 | 4854.2 samples/s | 75.8 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00032 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=3.043 | acc=1.0000 | 4680.0 samples/s | 73.1 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00030 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=3.044 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29293 | acc=0.8257 | tpr=0.7487 | fpr=0.0072 | 4587.4 samples/s | 17.9 steps/s
Avg test loss: 0.30368, Avg test acc: 0.82126, Avg tpr: 0.74401, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.38372 | acc=0.8945 | tpr=0.9646 | fpr=0.1067 | 4555.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.39512 | acc=0.8920 | tpr=0.9744 | fpr=0.1096 | 9634.9 samples/s | 37.6 steps/s
[Step= 150] | Loss=0.40331 | acc=0.8924 | tpr=0.9741 | fpr=0.1091 | 9099.9 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.40578 | acc=0.8926 | tpr=0.9781 | fpr=0.1089 | 9224.4 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.40129 | acc=0.8930 | tpr=0.9782 | fpr=0.1085 | 9378.5 samples/s | 36.6 steps/s
[Step= 300] | Loss=0.40418 | acc=0.8923 | tpr=0.9760 | fpr=0.1093 | 9465.3 samples/s | 37.0 steps/s
[Step= 350] | Loss=0.40662 | acc=0.8922 | tpr=0.9750 | fpr=0.1093 | 8899.8 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.40784 | acc=0.8917 | tpr=0.9748 | fpr=0.1098 | 9114.8 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.41208 | acc=0.8916 | tpr=0.9752 | fpr=0.1099 | 9041.4 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.41057 | acc=0.8913 | tpr=0.9744 | fpr=0.1102 | 9140.6 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.40818 | acc=0.8917 | tpr=0.9749 | fpr=0.1098 | 17239.1 samples/s | 67.3 steps/s
Avg test loss: 0.40785, Avg test acc: 0.89173, Avg tpr: 0.97504, Avg fpr: 0.10979, total FA: 15244

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.29271 | Reg=0.00215 | L2-Norm=14.680 | L2-Norm(final)=3.077 | acc=0.8438 | 3930.4 samples/s | 61.4 steps/s
[Step=24850 Epoch=24.3] | Loss=0.03479 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=3.077 | acc=0.9844 | 4681.9 samples/s | 73.2 steps/s
[Step=24900 Epoch=24.3] | Loss=0.02284 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=3.080 | acc=1.0000 | 4883.4 samples/s | 76.3 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01798 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=3.083 | acc=0.9844 | 4977.8 samples/s | 77.8 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01589 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=3.086 | acc=1.0000 | 5022.7 samples/s | 78.5 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01435 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=3.088 | acc=1.0000 | 5016.0 samples/s | 78.4 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01332 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=3.090 | acc=0.9844 | 5080.1 samples/s | 79.4 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01251 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=3.093 | acc=0.9844 | 4950.1 samples/s | 77.3 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01229 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=3.095 | acc=1.0000 | 4925.8 samples/s | 77.0 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01184 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=3.097 | acc=1.0000 | 5005.7 samples/s | 78.2 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01139 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=3.099 | acc=1.0000 | 5087.0 samples/s | 79.5 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01116 | Reg=0.00216 | L2-Norm=14.714 | L2-Norm(final)=3.101 | acc=1.0000 | 4966.5 samples/s | 77.6 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01090 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=3.102 | acc=0.9844 | 5199.3 samples/s | 81.2 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01072 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=3.104 | acc=0.9844 | 4993.7 samples/s | 78.0 steps/s
[Step=25500 Epoch=24.9] | Loss=0.01062 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=3.106 | acc=1.0000 | 4934.1 samples/s | 77.1 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01055 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=3.107 | acc=1.0000 | 5080.4 samples/s | 79.4 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01037 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=3.109 | acc=1.0000 | 5030.4 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.09541 | Reg=0.00215 | L2-Norm=14.680 | L2-Norm(final)=3.077 | acc=0.9375 | 3938.8 samples/s | 61.5 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00499 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=3.073 | acc=1.0000 | 4466.5 samples/s | 69.8 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00254 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=3.072 | acc=1.0000 | 4822.4 samples/s | 75.4 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00170 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=3.072 | acc=1.0000 | 4780.4 samples/s | 74.7 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00128 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=3.072 | acc=1.0000 | 4851.4 samples/s | 75.8 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00103 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=3.072 | acc=1.0000 | 4745.4 samples/s | 74.1 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00086 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=3.072 | acc=1.0000 | 4040.2 samples/s | 63.1 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00074 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=3.072 | acc=1.0000 | 3756.5 samples/s | 58.7 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00065 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=3.073 | acc=1.0000 | 3754.3 samples/s | 58.7 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00058 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=3.073 | acc=1.0000 | 3847.0 samples/s | 60.1 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00052 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=3.073 | acc=1.0000 | 3744.4 samples/s | 58.5 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00047 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=3.073 | acc=1.0000 | 1506.8 samples/s | 23.5 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00044 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=3.073 | acc=1.0000 | 4924.0 samples/s | 76.9 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00040 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=3.073 | acc=1.0000 | 4858.7 samples/s | 75.9 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00037 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=3.074 | acc=1.0000 | 4919.4 samples/s | 76.9 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00035 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=3.074 | acc=1.0000 | 4698.9 samples/s | 73.4 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00033 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=3.074 | acc=1.0000 | 4819.2 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26410 | acc=0.8480 | tpr=0.7817 | fpr=0.0082 | 4515.3 samples/s | 17.6 steps/s
Avg test loss: 0.27516, Avg test acc: 0.84242, Avg tpr: 0.77502, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.44087 | acc=0.8793 | tpr=0.9646 | fpr=0.1222 | 4576.9 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.45159 | acc=0.8771 | tpr=0.9744 | fpr=0.1247 | 9412.1 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.46026 | acc=0.8770 | tpr=0.9741 | fpr=0.1248 | 8956.0 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.46261 | acc=0.8773 | tpr=0.9781 | fpr=0.1246 | 9286.7 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.45766 | acc=0.8778 | tpr=0.9782 | fpr=0.1240 | 9463.3 samples/s | 37.0 steps/s
[Step= 300] | Loss=0.46074 | acc=0.8774 | tpr=0.9767 | fpr=0.1244 | 9277.5 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.46321 | acc=0.8775 | tpr=0.9762 | fpr=0.1243 | 9287.7 samples/s | 36.3 steps/s
[Step= 400] | Loss=0.46478 | acc=0.8771 | tpr=0.9759 | fpr=0.1247 | 9192.1 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.46906 | acc=0.8769 | tpr=0.9766 | fpr=0.1249 | 9297.7 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.46761 | acc=0.8766 | tpr=0.9758 | fpr=0.1252 | 9157.3 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.46513 | acc=0.8771 | tpr=0.9761 | fpr=0.1247 | 17500.1 samples/s | 68.4 steps/s
Avg test loss: 0.46485, Avg test acc: 0.87707, Avg tpr: 0.97623, Avg fpr: 0.12473, total FA: 17319

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.31729 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=3.105 | acc=0.7969 | 3850.2 samples/s | 60.2 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02811 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=3.107 | acc=1.0000 | 4841.5 samples/s | 75.6 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01847 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=3.110 | acc=1.0000 | 5097.4 samples/s | 79.6 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01446 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=3.114 | acc=0.9844 | 5026.7 samples/s | 78.5 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01316 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=3.116 | acc=1.0000 | 5068.5 samples/s | 79.2 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01239 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=3.118 | acc=1.0000 | 4995.3 samples/s | 78.1 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01165 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=3.120 | acc=1.0000 | 4953.5 samples/s | 77.4 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01135 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=3.122 | acc=1.0000 | 4953.5 samples/s | 77.4 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01110 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=3.124 | acc=0.9844 | 5094.5 samples/s | 79.6 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01089 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=3.125 | acc=0.9688 | 4888.5 samples/s | 76.4 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01056 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=3.127 | acc=1.0000 | 5075.7 samples/s | 79.3 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01042 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=3.128 | acc=1.0000 | 5087.3 samples/s | 79.5 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01020 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=3.130 | acc=1.0000 | 4355.2 samples/s | 68.0 steps/s
[Step=26250 Epoch=25.6] | Loss=0.01014 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=3.132 | acc=1.0000 | 3937.0 samples/s | 61.5 steps/s
[Step=26300 Epoch=25.7] | Loss=0.01014 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=3.133 | acc=0.9688 | 3960.0 samples/s | 61.9 steps/s
[Step=26350 Epoch=25.7] | Loss=0.01009 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=3.134 | acc=0.9844 | 3944.7 samples/s | 61.6 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00998 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=3.136 | acc=1.0000 | 3930.4 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.04958 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=3.105 | acc=0.9844 | 3917.0 samples/s | 61.2 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00688 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=3.101 | acc=1.0000 | 4489.6 samples/s | 70.1 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00346 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=3.099 | acc=1.0000 | 4821.1 samples/s | 75.3 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00231 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=3.098 | acc=1.0000 | 4834.3 samples/s | 75.5 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00174 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=3.098 | acc=1.0000 | 4747.8 samples/s | 74.2 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00139 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=3.098 | acc=1.0000 | 4870.1 samples/s | 76.1 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00116 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=3.098 | acc=1.0000 | 4501.4 samples/s | 70.3 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00100 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=3.098 | acc=1.0000 | 3742.7 samples/s | 58.5 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00088 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=3.099 | acc=1.0000 | 3743.1 samples/s | 58.5 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00078 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=3.099 | acc=1.0000 | 3773.4 samples/s | 59.0 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00071 | Reg=0.00215 | L2-Norm=14.667 | L2-Norm(final)=3.099 | acc=1.0000 | 3826.2 samples/s | 59.8 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00064 | Reg=0.00215 | L2-Norm=14.665 | L2-Norm(final)=3.099 | acc=1.0000 | 1489.6 samples/s | 23.3 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00059 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=3.099 | acc=1.0000 | 4796.8 samples/s | 74.9 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00055 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=3.100 | acc=1.0000 | 4732.0 samples/s | 73.9 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00051 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=3.100 | acc=1.0000 | 4862.0 samples/s | 76.0 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00047 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=3.100 | acc=1.0000 | 4589.0 samples/s | 71.7 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00045 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=3.100 | acc=1.0000 | 4836.1 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24663 | acc=0.8573 | tpr=0.7956 | fpr=0.0087 | 4694.4 samples/s | 18.3 steps/s
Avg test loss: 0.25525, Avg test acc: 0.85444, Avg tpr: 0.79262, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.41854 | acc=0.8855 | tpr=0.9690 | fpr=0.1160 | 4643.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.42776 | acc=0.8838 | tpr=0.9744 | fpr=0.1179 | 9005.5 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.43526 | acc=0.8845 | tpr=0.9741 | fpr=0.1171 | 9540.4 samples/s | 37.3 steps/s
[Step= 200] | Loss=0.43728 | acc=0.8851 | tpr=0.9781 | fpr=0.1166 | 9248.3 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.43254 | acc=0.8849 | tpr=0.9782 | fpr=0.1168 | 9007.5 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.43592 | acc=0.8843 | tpr=0.9767 | fpr=0.1174 | 9369.9 samples/s | 36.6 steps/s
[Step= 350] | Loss=0.43830 | acc=0.8840 | tpr=0.9756 | fpr=0.1176 | 9715.9 samples/s | 38.0 steps/s
[Step= 400] | Loss=0.43975 | acc=0.8835 | tpr=0.9748 | fpr=0.1181 | 9408.9 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.44404 | acc=0.8833 | tpr=0.9747 | fpr=0.1184 | 8798.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.44248 | acc=0.8832 | tpr=0.9744 | fpr=0.1184 | 9212.6 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.44026 | acc=0.8833 | tpr=0.9749 | fpr=0.1183 | 17209.3 samples/s | 67.2 steps/s
Avg test loss: 0.43999, Avg test acc: 0.88334, Avg tpr: 0.97504, Avg fpr: 0.11832, total FA: 16429

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.05267 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=3.130 | acc=0.9531 | 3667.2 samples/s | 57.3 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02261 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=3.132 | acc=1.0000 | 4844.9 samples/s | 75.7 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01602 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=3.135 | acc=1.0000 | 4985.9 samples/s | 77.9 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01351 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=3.138 | acc=0.9844 | 4964.0 samples/s | 77.6 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01217 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=3.140 | acc=0.9844 | 4966.3 samples/s | 77.6 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01111 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=3.143 | acc=1.0000 | 5014.0 samples/s | 78.3 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01045 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=3.145 | acc=0.9844 | 5080.8 samples/s | 79.4 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01014 | Reg=0.00215 | L2-Norm=14.670 | L2-Norm(final)=3.147 | acc=1.0000 | 5163.7 samples/s | 80.7 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00980 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=3.149 | acc=1.0000 | 4879.1 samples/s | 76.2 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00968 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=3.151 | acc=1.0000 | 5092.6 samples/s | 79.6 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00972 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=3.153 | acc=1.0000 | 4976.6 samples/s | 77.8 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00957 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=3.154 | acc=0.9844 | 4848.6 samples/s | 75.8 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00939 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=3.156 | acc=0.9844 | 4158.7 samples/s | 65.0 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00924 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=3.157 | acc=1.0000 | 3967.8 samples/s | 62.0 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00928 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=3.159 | acc=1.0000 | 3969.1 samples/s | 62.0 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00938 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=3.160 | acc=0.9688 | 3916.7 samples/s | 61.2 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00930 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=3.162 | acc=1.0000 | 3951.6 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.06045 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=3.129 | acc=0.9375 | 3761.0 samples/s | 58.8 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00275 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=3.131 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00144 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=3.132 | acc=1.0000 | 4906.3 samples/s | 76.7 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00097 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=3.133 | acc=1.0000 | 4838.7 samples/s | 75.6 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00073 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=3.133 | acc=1.0000 | 4830.6 samples/s | 75.5 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00059 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=3.133 | acc=1.0000 | 4907.4 samples/s | 76.7 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00050 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=3.134 | acc=1.0000 | 4699.1 samples/s | 73.4 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00043 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=3.134 | acc=1.0000 | 4730.3 samples/s | 73.9 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00038 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=3.135 | acc=1.0000 | 4805.6 samples/s | 75.1 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00034 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=3.135 | acc=1.0000 | 4848.9 samples/s | 75.8 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00031 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=3.135 | acc=1.0000 | 4861.5 samples/s | 76.0 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00028 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=3.136 | acc=1.0000 | 1516.5 samples/s | 23.7 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00026 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=3.136 | acc=1.0000 | 4936.3 samples/s | 77.1 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00024 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=3.136 | acc=1.0000 | 4717.4 samples/s | 73.7 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00022 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=3.136 | acc=1.0000 | 4740.2 samples/s | 74.1 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00021 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=3.137 | acc=1.0000 | 4643.9 samples/s | 72.6 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00019 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=3.137 | acc=1.0000 | 4852.2 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22554 | acc=0.8751 | tpr=0.8221 | fpr=0.0099 | 4547.9 samples/s | 17.8 steps/s
Avg test loss: 0.23418, Avg test acc: 0.87215, Avg tpr: 0.81891, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.52317 | acc=0.8652 | tpr=0.9690 | fpr=0.1366 | 4523.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.53293 | acc=0.8641 | tpr=0.9787 | fpr=0.1380 | 9541.6 samples/s | 37.3 steps/s
[Step= 150] | Loss=0.54164 | acc=0.8651 | tpr=0.9769 | fpr=0.1370 | 9093.5 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.54373 | acc=0.8649 | tpr=0.9803 | fpr=0.1372 | 9918.9 samples/s | 38.7 steps/s
[Step= 250] | Loss=0.53899 | acc=0.8648 | tpr=0.9808 | fpr=0.1373 | 8929.8 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.54282 | acc=0.8644 | tpr=0.9789 | fpr=0.1377 | 9195.0 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.54559 | acc=0.8643 | tpr=0.9787 | fpr=0.1378 | 9080.6 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.54748 | acc=0.8639 | tpr=0.9776 | fpr=0.1382 | 9236.3 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.55212 | acc=0.8637 | tpr=0.9786 | fpr=0.1384 | 9054.0 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.55064 | acc=0.8634 | tpr=0.9780 | fpr=0.1387 | 9271.6 samples/s | 36.2 steps/s
[Step= 550] | Loss=0.54799 | acc=0.8638 | tpr=0.9781 | fpr=0.1383 | 17658.2 samples/s | 69.0 steps/s
Avg test loss: 0.54760, Avg test acc: 0.86377, Avg tpr: 0.97821, Avg fpr: 0.13831, total FA: 19204

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.11625 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.162 | acc=0.9219 | 3683.0 samples/s | 57.5 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02098 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=3.163 | acc=1.0000 | 4881.3 samples/s | 76.3 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01464 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=3.165 | acc=1.0000 | 4969.5 samples/s | 77.6 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01221 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=3.168 | acc=1.0000 | 4826.2 samples/s | 75.4 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01166 | Reg=0.00214 | L2-Norm=14.646 | L2-Norm(final)=3.170 | acc=0.9844 | 4113.9 samples/s | 64.3 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01094 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=3.172 | acc=0.9844 | 3951.2 samples/s | 61.7 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01063 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=3.174 | acc=1.0000 | 3978.1 samples/s | 62.2 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01033 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=3.176 | acc=1.0000 | 3959.5 samples/s | 61.9 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01014 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=3.178 | acc=1.0000 | 3935.0 samples/s | 61.5 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00991 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=3.179 | acc=1.0000 | 4008.8 samples/s | 62.6 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00960 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=3.181 | acc=1.0000 | 3945.1 samples/s | 61.6 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00935 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=3.183 | acc=0.9844 | 3940.4 samples/s | 61.6 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00922 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=3.184 | acc=1.0000 | 3948.2 samples/s | 61.7 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00906 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=3.186 | acc=1.0000 | 3934.3 samples/s | 61.5 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00897 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=3.188 | acc=1.0000 | 3948.1 samples/s | 61.7 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00894 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=3.189 | acc=1.0000 | 3955.5 samples/s | 61.8 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00896 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=3.190 | acc=1.0000 | 3971.3 samples/s | 62.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.00447 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.162 | acc=1.0000 | 3600.3 samples/s | 56.3 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00430 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=3.161 | acc=1.0000 | 4527.6 samples/s | 70.7 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00219 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=3.160 | acc=1.0000 | 4817.8 samples/s | 75.3 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00151 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=3.160 | acc=1.0000 | 4795.2 samples/s | 74.9 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00114 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=3.160 | acc=1.0000 | 4827.3 samples/s | 75.4 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00093 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=3.160 | acc=1.0000 | 4664.0 samples/s | 72.9 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00078 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=3.160 | acc=1.0000 | 4880.7 samples/s | 76.3 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00067 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=3.161 | acc=1.0000 | 4741.9 samples/s | 74.1 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00059 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=3.161 | acc=1.0000 | 4825.7 samples/s | 75.4 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00052 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=3.161 | acc=1.0000 | 4775.5 samples/s | 74.6 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00047 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=3.161 | acc=1.0000 | 4824.2 samples/s | 75.4 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00043 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=3.162 | acc=1.0000 | 1498.3 samples/s | 23.4 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00040 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=3.162 | acc=1.0000 | 4880.9 samples/s | 76.3 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00036 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=3.162 | acc=1.0000 | 4787.9 samples/s | 74.8 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00034 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=3.162 | acc=1.0000 | 4880.1 samples/s | 76.3 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00032 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.162 | acc=1.0000 | 4834.5 samples/s | 75.5 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00030 | Reg=0.00214 | L2-Norm=14.620 | L2-Norm(final)=3.163 | acc=1.0000 | 4868.7 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23257 | acc=0.8691 | tpr=0.8136 | fpr=0.0102 | 4330.5 samples/s | 16.9 steps/s
Avg test loss: 0.24347, Avg test acc: 0.86710, Avg tpr: 0.81168, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.49364 | acc=0.8788 | tpr=0.9690 | fpr=0.1229 | 4637.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.50518 | acc=0.8776 | tpr=0.9787 | fpr=0.1243 | 9000.1 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.51484 | acc=0.8779 | tpr=0.9769 | fpr=0.1239 | 9200.4 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.51723 | acc=0.8779 | tpr=0.9792 | fpr=0.1239 | 9427.3 samples/s | 36.8 steps/s
[Step= 250] | Loss=0.51253 | acc=0.8781 | tpr=0.9799 | fpr=0.1237 | 9356.6 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.51632 | acc=0.8775 | tpr=0.9775 | fpr=0.1244 | 8988.8 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.51910 | acc=0.8772 | tpr=0.9762 | fpr=0.1246 | 9719.1 samples/s | 38.0 steps/s
[Step= 400] | Loss=0.52065 | acc=0.8766 | tpr=0.9748 | fpr=0.1252 | 9089.4 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.52560 | acc=0.8764 | tpr=0.9752 | fpr=0.1254 | 9277.0 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.52413 | acc=0.8762 | tpr=0.9749 | fpr=0.1256 | 9127.4 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.52137 | acc=0.8766 | tpr=0.9749 | fpr=0.1252 | 17132.3 samples/s | 66.9 steps/s
Avg test loss: 0.52096, Avg test acc: 0.87660, Avg tpr: 0.97504, Avg fpr: 0.12519, total FA: 17383

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.11265 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=3.188 | acc=0.8906 | 3817.9 samples/s | 59.7 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01692 | Reg=0.00214 | L2-Norm=14.620 | L2-Norm(final)=3.188 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01318 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.191 | acc=0.9844 | 4874.6 samples/s | 76.2 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01155 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=3.194 | acc=0.9844 | 5011.5 samples/s | 78.3 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01051 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=3.196 | acc=0.9844 | 4961.2 samples/s | 77.5 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01003 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=3.198 | acc=1.0000 | 5151.5 samples/s | 80.5 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00994 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=3.200 | acc=1.0000 | 5143.1 samples/s | 80.4 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00968 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=3.202 | acc=0.9844 | 5203.3 samples/s | 81.3 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00956 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=3.203 | acc=1.0000 | 4970.5 samples/s | 77.7 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00941 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=3.205 | acc=1.0000 | 4912.7 samples/s | 76.8 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00915 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=3.207 | acc=0.9844 | 4097.3 samples/s | 64.0 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00897 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=3.208 | acc=0.9844 | 3898.9 samples/s | 60.9 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00897 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=3.210 | acc=1.0000 | 3954.0 samples/s | 61.8 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00909 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=3.212 | acc=0.9844 | 3996.5 samples/s | 62.4 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00909 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=3.213 | acc=1.0000 | 3918.8 samples/s | 61.2 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00914 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=3.215 | acc=1.0000 | 3968.9 samples/s | 62.0 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00897 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=3.216 | acc=1.0000 | 3948.0 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.06406 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=3.187 | acc=0.9688 | 2919.8 samples/s | 45.6 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00568 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=3.183 | acc=1.0000 | 4456.4 samples/s | 69.6 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00287 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=3.181 | acc=1.0000 | 4665.9 samples/s | 72.9 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00192 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=3.181 | acc=1.0000 | 4797.8 samples/s | 75.0 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00144 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=3.181 | acc=1.0000 | 4796.9 samples/s | 75.0 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00115 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=3.181 | acc=1.0000 | 4782.0 samples/s | 74.7 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00096 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=3.181 | acc=1.0000 | 4721.7 samples/s | 73.8 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00083 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=3.182 | acc=1.0000 | 4796.6 samples/s | 74.9 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00073 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=3.182 | acc=1.0000 | 4760.2 samples/s | 74.4 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00065 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=3.182 | acc=1.0000 | 4746.9 samples/s | 74.2 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00058 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.182 | acc=1.0000 | 4889.3 samples/s | 76.4 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00053 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=3.182 | acc=1.0000 | 1485.7 samples/s | 23.2 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00049 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=3.183 | acc=1.0000 | 4904.2 samples/s | 76.6 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00045 | Reg=0.00214 | L2-Norm=14.617 | L2-Norm(final)=3.183 | acc=1.0000 | 4825.1 samples/s | 75.4 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00042 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=3.183 | acc=1.0000 | 4758.4 samples/s | 74.3 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00039 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=3.183 | acc=1.0000 | 4683.5 samples/s | 73.2 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00037 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=3.183 | acc=1.0000 | 4839.9 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26005 | acc=0.8580 | tpr=0.7968 | fpr=0.0092 | 4553.4 samples/s | 17.8 steps/s
Avg test loss: 0.27107, Avg test acc: 0.85347, Avg tpr: 0.79134, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.46848 | acc=0.8848 | tpr=0.9690 | fpr=0.1167 | 4556.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.48007 | acc=0.8830 | tpr=0.9765 | fpr=0.1187 | 9428.0 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.48997 | acc=0.8838 | tpr=0.9769 | fpr=0.1179 | 9102.9 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.49248 | acc=0.8844 | tpr=0.9803 | fpr=0.1174 | 9002.0 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.48759 | acc=0.8849 | tpr=0.9808 | fpr=0.1168 | 9420.2 samples/s | 36.8 steps/s
[Step= 300] | Loss=0.49165 | acc=0.8843 | tpr=0.9782 | fpr=0.1174 | 9217.8 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.49476 | acc=0.8841 | tpr=0.9768 | fpr=0.1176 | 9508.7 samples/s | 37.1 steps/s
[Step= 400] | Loss=0.49633 | acc=0.8836 | tpr=0.9759 | fpr=0.1180 | 9012.8 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.50109 | acc=0.8835 | tpr=0.9766 | fpr=0.1182 | 9374.9 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.49959 | acc=0.8833 | tpr=0.9762 | fpr=0.1184 | 9301.6 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.49666 | acc=0.8837 | tpr=0.9769 | fpr=0.1180 | 18155.1 samples/s | 70.9 steps/s
Avg test loss: 0.49633, Avg test acc: 0.88368, Avg tpr: 0.97702, Avg fpr: 0.11801, total FA: 16386

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.09400 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=3.211 | acc=0.9219 | 3545.5 samples/s | 55.4 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02280 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=3.210 | acc=0.9844 | 5115.8 samples/s | 79.9 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01563 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=3.212 | acc=1.0000 | 4981.5 samples/s | 77.8 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01309 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=3.214 | acc=1.0000 | 4928.4 samples/s | 77.0 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01156 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.217 | acc=1.0000 | 5001.0 samples/s | 78.1 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01061 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=3.219 | acc=1.0000 | 5055.2 samples/s | 79.0 steps/s
[Step=29100 Epoch=28.4] | Loss=0.01058 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=3.221 | acc=1.0000 | 5092.4 samples/s | 79.6 steps/s
[Step=29150 Epoch=28.5] | Loss=0.01032 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=3.223 | acc=1.0000 | 5005.2 samples/s | 78.2 steps/s
[Step=29200 Epoch=28.5] | Loss=0.01006 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=3.224 | acc=1.0000 | 4963.6 samples/s | 77.6 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00970 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=3.226 | acc=1.0000 | 5126.0 samples/s | 80.1 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00944 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=3.228 | acc=0.9844 | 5008.9 samples/s | 78.3 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00917 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=3.230 | acc=1.0000 | 4955.6 samples/s | 77.4 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00906 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=3.231 | acc=1.0000 | 4946.7 samples/s | 77.3 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00888 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=3.233 | acc=0.9844 | 4892.8 samples/s | 76.5 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00890 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=3.234 | acc=1.0000 | 4081.2 samples/s | 63.8 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00896 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=3.236 | acc=1.0000 | 3942.2 samples/s | 61.6 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00886 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=3.237 | acc=1.0000 | 3953.0 samples/s | 61.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.04044 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=3.211 | acc=0.9844 | 3063.6 samples/s | 47.9 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00264 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=3.212 | acc=1.0000 | 4424.6 samples/s | 69.1 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00134 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=3.212 | acc=1.0000 | 4799.0 samples/s | 75.0 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00090 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=3.212 | acc=1.0000 | 4746.9 samples/s | 74.2 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00068 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=3.213 | acc=1.0000 | 4908.2 samples/s | 76.7 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00054 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=3.213 | acc=1.0000 | 4736.8 samples/s | 74.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00046 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=3.213 | acc=1.0000 | 4820.0 samples/s | 75.3 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00039 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=3.213 | acc=1.0000 | 4745.2 samples/s | 74.1 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00035 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=3.214 | acc=1.0000 | 4725.5 samples/s | 73.8 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00031 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=3.214 | acc=1.0000 | 4798.3 samples/s | 75.0 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00028 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=3.215 | acc=1.0000 | 4805.5 samples/s | 75.1 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00025 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=3.215 | acc=1.0000 | 1489.9 samples/s | 23.3 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00023 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=3.215 | acc=1.0000 | 4836.5 samples/s | 75.6 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00022 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=3.216 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00020 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=3.216 | acc=1.0000 | 4810.5 samples/s | 75.2 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00019 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=3.216 | acc=1.0000 | 4692.4 samples/s | 73.3 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00018 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=3.217 | acc=1.0000 | 4773.5 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22006 | acc=0.8805 | tpr=0.8302 | fpr=0.0102 | 4617.1 samples/s | 18.0 steps/s
Avg test loss: 0.22971, Avg test acc: 0.87659, Avg tpr: 0.82544, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.51343 | acc=0.8742 | tpr=0.9690 | fpr=0.1275 | 4539.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.52547 | acc=0.8729 | tpr=0.9765 | fpr=0.1290 | 9363.5 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.53517 | acc=0.8741 | tpr=0.9755 | fpr=0.1278 | 9573.5 samples/s | 37.4 steps/s
[Step= 200] | Loss=0.53693 | acc=0.8744 | tpr=0.9781 | fpr=0.1275 | 9019.7 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.53193 | acc=0.8745 | tpr=0.9782 | fpr=0.1274 | 9535.5 samples/s | 37.2 steps/s
[Step= 300] | Loss=0.53625 | acc=0.8738 | tpr=0.9767 | fpr=0.1281 | 9296.9 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.53952 | acc=0.8736 | tpr=0.9762 | fpr=0.1283 | 8741.9 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.54144 | acc=0.8733 | tpr=0.9754 | fpr=0.1286 | 9278.3 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.54617 | acc=0.8731 | tpr=0.9761 | fpr=0.1287 | 9089.9 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.54477 | acc=0.8728 | tpr=0.9758 | fpr=0.1290 | 9303.2 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.54194 | acc=0.8732 | tpr=0.9757 | fpr=0.1287 | 17242.9 samples/s | 67.4 steps/s
Avg test loss: 0.54170, Avg test acc: 0.87316, Avg tpr: 0.97583, Avg fpr: 0.12870, total FA: 17870

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.15285 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=3.240 | acc=0.9375 | 3654.6 samples/s | 57.1 steps/s
[Step=29650 Epoch=28.9] | Loss=0.01725 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=3.243 | acc=1.0000 | 4926.4 samples/s | 77.0 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01131 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=3.247 | acc=0.9844 | 5012.9 samples/s | 78.3 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01070 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=3.250 | acc=1.0000 | 5014.9 samples/s | 78.4 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01019 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=3.251 | acc=1.0000 | 4989.0 samples/s | 78.0 steps/s
[Step=29850 Epoch=29.1] | Loss=0.00998 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=3.253 | acc=1.0000 | 5058.7 samples/s | 79.0 steps/s
[Step=29900 Epoch=29.2] | Loss=0.00962 | Reg=0.00213 | L2-Norm=14.606 | L2-Norm(final)=3.254 | acc=1.0000 | 4987.8 samples/s | 77.9 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00957 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=3.256 | acc=0.9844 | 4966.9 samples/s | 77.6 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00946 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=3.257 | acc=1.0000 | 4855.2 samples/s | 75.9 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00940 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=3.258 | acc=1.0000 | 4941.9 samples/s | 77.2 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00916 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=3.259 | acc=1.0000 | 5001.7 samples/s | 78.2 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00900 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=3.261 | acc=0.9844 | 4979.0 samples/s | 77.8 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00886 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=3.262 | acc=1.0000 | 4950.0 samples/s | 77.3 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00882 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=3.264 | acc=0.9688 | 4368.3 samples/s | 68.3 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00900 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=3.265 | acc=1.0000 | 3963.0 samples/s | 61.9 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00899 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=3.266 | acc=1.0000 | 3884.1 samples/s | 60.7 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00897 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=3.268 | acc=1.0000 | 3977.8 samples/s | 62.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.00510 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=3.240 | acc=1.0000 | 2928.8 samples/s | 45.8 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00220 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=3.241 | acc=1.0000 | 4614.4 samples/s | 72.1 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00115 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=3.242 | acc=1.0000 | 4778.3 samples/s | 74.7 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00077 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=3.242 | acc=1.0000 | 4762.4 samples/s | 74.4 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00058 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=3.243 | acc=1.0000 | 4761.8 samples/s | 74.4 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00047 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=3.243 | acc=1.0000 | 4888.2 samples/s | 76.4 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00039 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=3.244 | acc=1.0000 | 4797.2 samples/s | 75.0 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00034 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=3.244 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00030 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=3.244 | acc=1.0000 | 4858.9 samples/s | 75.9 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00026 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=3.244 | acc=1.0000 | 4892.2 samples/s | 76.4 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00024 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=3.245 | acc=1.0000 | 4828.1 samples/s | 75.4 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00022 | Reg=0.00213 | L2-Norm=14.582 | L2-Norm(final)=3.245 | acc=1.0000 | 1482.2 samples/s | 23.2 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00020 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=3.245 | acc=1.0000 | 4934.9 samples/s | 77.1 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00018 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=3.245 | acc=1.0000 | 4790.4 samples/s | 74.8 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00017 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=3.245 | acc=1.0000 | 4811.6 samples/s | 75.2 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00016 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=3.246 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00015 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=3.246 | acc=1.0000 | 4852.9 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27459 | acc=0.8544 | tpr=0.7912 | fpr=0.0084 | 4510.1 samples/s | 17.6 steps/s
Avg test loss: 0.28574, Avg test acc: 0.85071, Avg tpr: 0.78697, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.43113 | acc=0.8954 | tpr=0.9690 | fpr=0.1059 | 4536.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.44330 | acc=0.8943 | tpr=0.9744 | fpr=0.1072 | 9372.3 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.45343 | acc=0.8951 | tpr=0.9726 | fpr=0.1064 | 9543.0 samples/s | 37.3 steps/s
[Step= 200] | Loss=0.45494 | acc=0.8958 | tpr=0.9760 | fpr=0.1057 | 8823.9 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.44965 | acc=0.8962 | tpr=0.9764 | fpr=0.1053 | 9661.0 samples/s | 37.7 steps/s
[Step= 300] | Loss=0.45360 | acc=0.8956 | tpr=0.9753 | fpr=0.1058 | 9202.4 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.45647 | acc=0.8956 | tpr=0.9737 | fpr=0.1058 | 9380.9 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.45817 | acc=0.8950 | tpr=0.9726 | fpr=0.1064 | 9368.8 samples/s | 36.6 steps/s
[Step= 450] | Loss=0.46302 | acc=0.8946 | tpr=0.9727 | fpr=0.1068 | 8816.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.46154 | acc=0.8945 | tpr=0.9727 | fpr=0.1069 | 9660.6 samples/s | 37.7 steps/s
[Step= 550] | Loss=0.45877 | acc=0.8947 | tpr=0.9725 | fpr=0.1067 | 15828.1 samples/s | 61.8 steps/s
Avg test loss: 0.45855, Avg test acc: 0.89465, Avg tpr: 0.97266, Avg fpr: 0.10676, total FA: 14824

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.15150 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.267 | acc=0.9375 | 3663.6 samples/s | 57.2 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01732 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=3.269 | acc=1.0000 | 4854.6 samples/s | 75.9 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01213 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=3.273 | acc=0.9688 | 5048.7 samples/s | 78.9 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01093 | Reg=0.00213 | L2-Norm=14.584 | L2-Norm(final)=3.275 | acc=1.0000 | 4932.6 samples/s | 77.1 steps/s
[Step=30600 Epoch=29.9] | Loss=0.00999 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=3.277 | acc=1.0000 | 5076.6 samples/s | 79.3 steps/s
[Step=30650 Epoch=29.9] | Loss=0.00987 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=3.279 | acc=1.0000 | 5109.5 samples/s | 79.8 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00934 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=3.282 | acc=1.0000 | 4886.9 samples/s | 76.4 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00893 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=3.284 | acc=0.9844 | 4997.6 samples/s | 78.1 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00872 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=3.286 | acc=0.9844 | 4990.9 samples/s | 78.0 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00861 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=3.288 | acc=0.9844 | 4656.2 samples/s | 72.8 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00846 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=3.289 | acc=1.0000 | 3928.8 samples/s | 61.4 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00842 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=3.291 | acc=0.9844 | 3928.5 samples/s | 61.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00829 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=3.293 | acc=0.9688 | 3940.7 samples/s | 61.6 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00832 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=3.294 | acc=1.0000 | 3929.8 samples/s | 61.4 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00850 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=3.296 | acc=0.9844 | 3885.9 samples/s | 60.7 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00855 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=3.297 | acc=0.9844 | 3906.2 samples/s | 61.0 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00849 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=3.298 | acc=0.9688 | 3958.7 samples/s | 61.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.08292 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.267 | acc=0.9688 | 3220.0 samples/s | 50.3 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00354 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=3.263 | acc=1.0000 | 3982.0 samples/s | 62.2 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00179 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=3.263 | acc=1.0000 | 4852.0 samples/s | 75.8 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00120 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=3.263 | acc=1.0000 | 4699.3 samples/s | 73.4 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00090 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=3.263 | acc=1.0000 | 4903.7 samples/s | 76.6 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00072 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=3.263 | acc=1.0000 | 4776.4 samples/s | 74.6 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00061 | Reg=0.00212 | L2-Norm=14.572 | L2-Norm(final)=3.263 | acc=1.0000 | 4798.9 samples/s | 75.0 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00052 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=3.264 | acc=1.0000 | 4670.0 samples/s | 73.0 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00046 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=3.264 | acc=1.0000 | 4780.4 samples/s | 74.7 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=3.264 | acc=1.0000 | 4762.9 samples/s | 74.4 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00037 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=3.264 | acc=1.0000 | 4175.0 samples/s | 65.2 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00034 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.265 | acc=1.0000 | 1480.2 samples/s | 23.1 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00031 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.265 | acc=1.0000 | 4851.1 samples/s | 75.8 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00029 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=3.265 | acc=1.0000 | 4119.4 samples/s | 64.4 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00027 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=3.265 | acc=1.0000 | 4341.5 samples/s | 67.8 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00025 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=3.266 | acc=1.0000 | 4649.2 samples/s | 72.6 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00023 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=3.266 | acc=1.0000 | 4748.0 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22622 | acc=0.8777 | tpr=0.8258 | fpr=0.0094 | 4495.5 samples/s | 17.6 steps/s
Avg test loss: 0.23672, Avg test acc: 0.87387, Avg tpr: 0.82112, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.47693 | acc=0.8839 | tpr=0.9646 | fpr=0.1175 | 4566.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.48809 | acc=0.8830 | tpr=0.9744 | fpr=0.1187 | 9735.4 samples/s | 38.0 steps/s
[Step= 150] | Loss=0.49856 | acc=0.8837 | tpr=0.9741 | fpr=0.1180 | 8565.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.50132 | acc=0.8839 | tpr=0.9770 | fpr=0.1178 | 9354.7 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.49617 | acc=0.8841 | tpr=0.9773 | fpr=0.1176 | 9142.4 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.50046 | acc=0.8834 | tpr=0.9760 | fpr=0.1183 | 9631.5 samples/s | 37.6 steps/s
[Step= 350] | Loss=0.50322 | acc=0.8832 | tpr=0.9750 | fpr=0.1185 | 9353.2 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.50492 | acc=0.8827 | tpr=0.9743 | fpr=0.1189 | 9133.0 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.50949 | acc=0.8825 | tpr=0.9742 | fpr=0.1191 | 9095.8 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.50771 | acc=0.8824 | tpr=0.9740 | fpr=0.1192 | 9193.9 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.50483 | acc=0.8827 | tpr=0.9745 | fpr=0.1189 | 17631.5 samples/s | 68.9 steps/s
Avg test loss: 0.50460, Avg test acc: 0.88270, Avg tpr: 0.97464, Avg fpr: 0.11897, total FA: 16519

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.18523 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.293 | acc=0.8906 | 3713.6 samples/s | 58.0 steps/s
[Step=31250 Epoch=30.5] | Loss=0.02084 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=3.291 | acc=1.0000 | 4692.0 samples/s | 73.3 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01348 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=3.294 | acc=1.0000 | 4970.1 samples/s | 77.7 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01131 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=3.297 | acc=1.0000 | 4887.3 samples/s | 76.4 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01067 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=3.300 | acc=0.9844 | 5019.7 samples/s | 78.4 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00992 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.302 | acc=0.9844 | 4936.1 samples/s | 77.1 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00944 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=3.304 | acc=1.0000 | 4928.4 samples/s | 77.0 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00933 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=3.306 | acc=1.0000 | 4972.7 samples/s | 77.7 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00939 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.308 | acc=1.0000 | 5032.0 samples/s | 78.6 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00932 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.310 | acc=1.0000 | 4843.2 samples/s | 75.7 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00935 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=3.311 | acc=1.0000 | 5010.4 samples/s | 78.3 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00942 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.312 | acc=1.0000 | 5127.3 samples/s | 80.1 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00938 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=3.313 | acc=0.9844 | 4684.6 samples/s | 73.2 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00915 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=3.314 | acc=0.9844 | 3918.8 samples/s | 61.2 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00898 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=3.316 | acc=1.0000 | 3955.6 samples/s | 61.8 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00903 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=3.317 | acc=0.9844 | 3944.7 samples/s | 61.6 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00899 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=3.318 | acc=1.0000 | 3987.4 samples/s | 62.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.09730 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.293 | acc=0.9531 | 3704.4 samples/s | 57.9 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00474 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=3.288 | acc=1.0000 | 4534.6 samples/s | 70.9 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00239 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.287 | acc=1.0000 | 4664.7 samples/s | 72.9 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00160 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.287 | acc=1.0000 | 4314.5 samples/s | 67.4 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00120 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=3.287 | acc=1.0000 | 3717.4 samples/s | 58.1 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00096 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.287 | acc=1.0000 | 3725.5 samples/s | 58.2 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00080 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.287 | acc=1.0000 | 3796.8 samples/s | 59.3 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00069 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.287 | acc=1.0000 | 3741.6 samples/s | 58.5 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00061 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=3.287 | acc=1.0000 | 3737.9 samples/s | 58.4 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00054 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=3.287 | acc=1.0000 | 3803.0 samples/s | 59.4 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00049 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=3.287 | acc=1.0000 | 3752.5 samples/s | 58.6 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00044 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=3.287 | acc=1.0000 | 1480.5 samples/s | 23.1 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=3.288 | acc=1.0000 | 4833.3 samples/s | 75.5 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00038 | Reg=0.00212 | L2-Norm=14.545 | L2-Norm(final)=3.288 | acc=1.0000 | 4684.4 samples/s | 73.2 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.543 | L2-Norm(final)=3.288 | acc=1.0000 | 4731.6 samples/s | 73.9 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00033 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=3.288 | acc=1.0000 | 4906.9 samples/s | 76.7 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00031 | Reg=0.00211 | L2-Norm=14.538 | L2-Norm(final)=3.288 | acc=1.0000 | 4683.1 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29996 | acc=0.8398 | tpr=0.7700 | fpr=0.0084 | 4564.4 samples/s | 17.8 steps/s
Avg test loss: 0.31029, Avg test acc: 0.83785, Avg tpr: 0.76849, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.42312 | acc=0.9078 | tpr=0.9690 | fpr=0.0933 | 4620.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.43408 | acc=0.9067 | tpr=0.9765 | fpr=0.0946 | 8819.4 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.44529 | acc=0.9064 | tpr=0.9769 | fpr=0.0949 | 9222.1 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.44805 | acc=0.9066 | tpr=0.9803 | fpr=0.0947 | 9284.5 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.44274 | acc=0.9074 | tpr=0.9799 | fpr=0.0939 | 9482.6 samples/s | 37.0 steps/s
[Step= 300] | Loss=0.44650 | acc=0.9066 | tpr=0.9789 | fpr=0.0947 | 9409.3 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.44900 | acc=0.9064 | tpr=0.9775 | fpr=0.0949 | 8856.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.45060 | acc=0.9060 | tpr=0.9765 | fpr=0.0953 | 8995.0 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.45499 | acc=0.9058 | tpr=0.9761 | fpr=0.0955 | 9463.1 samples/s | 37.0 steps/s
[Step= 500] | Loss=0.45335 | acc=0.9056 | tpr=0.9758 | fpr=0.0956 | 9063.1 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.45054 | acc=0.9058 | tpr=0.9761 | fpr=0.0954 | 18374.4 samples/s | 71.8 steps/s
Avg test loss: 0.45022, Avg test acc: 0.90583, Avg tpr: 0.97623, Avg fpr: 0.09545, total FA: 13253

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.17211 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.312 | acc=0.9375 | 3860.4 samples/s | 60.3 steps/s
[Step=32050 Epoch=31.3] | Loss=0.02790 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.311 | acc=1.0000 | 4605.0 samples/s | 72.0 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01763 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.312 | acc=0.9688 | 4953.3 samples/s | 77.4 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01419 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.314 | acc=1.0000 | 5112.3 samples/s | 79.9 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01270 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=3.316 | acc=0.9844 | 4850.9 samples/s | 75.8 steps/s
[Step=32250 Epoch=31.5] | Loss=0.01129 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.317 | acc=1.0000 | 5026.0 samples/s | 78.5 steps/s
[Step=32300 Epoch=31.5] | Loss=0.01032 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.318 | acc=1.0000 | 4943.1 samples/s | 77.2 steps/s
[Step=32350 Epoch=31.6] | Loss=0.01002 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=3.320 | acc=1.0000 | 5006.7 samples/s | 78.2 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00952 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=3.321 | acc=1.0000 | 4309.2 samples/s | 67.3 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00912 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.322 | acc=1.0000 | 3960.4 samples/s | 61.9 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00895 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.323 | acc=0.9844 | 3997.2 samples/s | 62.5 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00869 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.324 | acc=1.0000 | 3916.3 samples/s | 61.2 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00843 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.326 | acc=1.0000 | 3948.8 samples/s | 61.7 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00827 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.327 | acc=1.0000 | 4011.3 samples/s | 62.7 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00817 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.328 | acc=1.0000 | 3937.2 samples/s | 61.5 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00813 | Reg=0.00211 | L2-Norm=14.538 | L2-Norm(final)=3.329 | acc=1.0000 | 3937.0 samples/s | 61.5 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00809 | Reg=0.00211 | L2-Norm=14.538 | L2-Norm(final)=3.330 | acc=1.0000 | 3926.7 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.00180 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.312 | acc=1.0000 | 3681.3 samples/s | 57.5 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00488 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.314 | acc=1.0000 | 4646.3 samples/s | 72.6 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00247 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.314 | acc=1.0000 | 4731.9 samples/s | 73.9 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00166 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.315 | acc=1.0000 | 4732.9 samples/s | 74.0 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00125 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.315 | acc=1.0000 | 4787.6 samples/s | 74.8 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00101 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=3.315 | acc=1.0000 | 4700.2 samples/s | 73.4 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00084 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.315 | acc=1.0000 | 4841.7 samples/s | 75.7 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00072 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.315 | acc=1.0000 | 4866.2 samples/s | 76.0 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00063 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.315 | acc=1.0000 | 4817.2 samples/s | 75.3 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00057 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=3.316 | acc=1.0000 | 4586.0 samples/s | 71.7 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00051 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.316 | acc=1.0000 | 4835.7 samples/s | 75.6 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00047 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.316 | acc=1.0000 | 1474.8 samples/s | 23.0 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00043 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=3.316 | acc=1.0000 | 4814.8 samples/s | 75.2 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00040 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.316 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00037 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.316 | acc=1.0000 | 4843.7 samples/s | 75.7 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=3.317 | acc=1.0000 | 4683.2 samples/s | 73.2 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00032 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=3.317 | acc=1.0000 | 4744.3 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23361 | acc=0.8792 | tpr=0.8279 | fpr=0.0094 | 4582.6 samples/s | 17.9 steps/s
Avg test loss: 0.24391, Avg test acc: 0.87471, Avg tpr: 0.82240, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.47408 | acc=0.8905 | tpr=0.9646 | fpr=0.1108 | 4550.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.48444 | acc=0.8899 | tpr=0.9744 | fpr=0.1117 | 9375.1 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.49405 | acc=0.8908 | tpr=0.9741 | fpr=0.1108 | 9285.5 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.49682 | acc=0.8912 | tpr=0.9770 | fpr=0.1104 | 9412.2 samples/s | 36.8 steps/s
[Step= 250] | Loss=0.49126 | acc=0.8916 | tpr=0.9773 | fpr=0.1099 | 9124.6 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.49541 | acc=0.8908 | tpr=0.9760 | fpr=0.1108 | 9639.7 samples/s | 37.7 steps/s
[Step= 350] | Loss=0.49793 | acc=0.8907 | tpr=0.9750 | fpr=0.1109 | 8953.8 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.49977 | acc=0.8902 | tpr=0.9737 | fpr=0.1113 | 9244.2 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.50441 | acc=0.8900 | tpr=0.9732 | fpr=0.1115 | 9139.7 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.50260 | acc=0.8899 | tpr=0.9731 | fpr=0.1116 | 9742.9 samples/s | 38.1 steps/s
[Step= 550] | Loss=0.49981 | acc=0.8901 | tpr=0.9733 | fpr=0.1114 | 16228.0 samples/s | 63.4 steps/s
Avg test loss: 0.49961, Avg test acc: 0.89005, Avg tpr: 0.97345, Avg fpr: 0.11147, total FA: 15477

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.15504 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.331 | acc=0.9219 | 3698.1 samples/s | 57.8 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02247 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=3.331 | acc=0.9844 | 4658.9 samples/s | 72.8 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01445 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=3.333 | acc=1.0000 | 4929.9 samples/s | 77.0 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01152 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=3.334 | acc=1.0000 | 5038.2 samples/s | 78.7 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00996 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.336 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00952 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.337 | acc=1.0000 | 3947.8 samples/s | 61.7 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00887 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.339 | acc=1.0000 | 3969.5 samples/s | 62.0 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00861 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=3.340 | acc=1.0000 | 3964.8 samples/s | 61.9 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00837 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=3.341 | acc=0.9844 | 3940.1 samples/s | 61.6 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00799 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.343 | acc=1.0000 | 3986.0 samples/s | 62.3 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00774 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.344 | acc=1.0000 | 3997.8 samples/s | 62.5 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00783 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=3.345 | acc=1.0000 | 3879.4 samples/s | 60.6 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00801 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=3.346 | acc=0.9844 | 3978.9 samples/s | 62.2 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00792 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.347 | acc=1.0000 | 3967.2 samples/s | 62.0 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00784 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.348 | acc=1.0000 | 4003.0 samples/s | 62.5 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00764 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.349 | acc=0.9844 | 3975.4 samples/s | 62.1 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00757 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.350 | acc=1.0000 | 3936.8 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.00403 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.331 | acc=1.0000 | 3041.2 samples/s | 47.5 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00591 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.334 | acc=1.0000 | 4534.4 samples/s | 70.8 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00299 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.334 | acc=1.0000 | 4837.1 samples/s | 75.6 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00200 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.334 | acc=1.0000 | 4740.9 samples/s | 74.1 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00150 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.334 | acc=1.0000 | 4758.8 samples/s | 74.4 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00120 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.334 | acc=1.0000 | 4753.7 samples/s | 74.3 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00101 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=3.334 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00087 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.334 | acc=1.0000 | 4851.6 samples/s | 75.8 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00076 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.334 | acc=1.0000 | 4818.9 samples/s | 75.3 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00068 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.334 | acc=1.0000 | 4801.8 samples/s | 75.0 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00061 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.334 | acc=1.0000 | 4838.2 samples/s | 75.6 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00056 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.334 | acc=1.0000 | 1493.4 samples/s | 23.3 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00051 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=3.334 | acc=1.0000 | 4848.0 samples/s | 75.7 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00047 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=3.334 | acc=1.0000 | 4834.3 samples/s | 75.5 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00044 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.334 | acc=1.0000 | 4810.0 samples/s | 75.2 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00041 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=3.334 | acc=1.0000 | 4785.2 samples/s | 74.8 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00039 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.334 | acc=1.0000 | 4869.5 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27541 | acc=0.8623 | tpr=0.8024 | fpr=0.0074 | 4565.8 samples/s | 17.8 steps/s
Avg test loss: 0.28744, Avg test acc: 0.85836, Avg tpr: 0.79787, Avg fpr: 0.00859, total FA: 67

Testing server on iccad2012
[Step=  50] | Loss=0.44975 | acc=0.9020 | tpr=0.9646 | fpr=0.0991 | 4610.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.46111 | acc=0.9012 | tpr=0.9744 | fpr=0.1002 | 9360.7 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.47148 | acc=0.9017 | tpr=0.9741 | fpr=0.0996 | 9052.2 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.47366 | acc=0.9022 | tpr=0.9770 | fpr=0.0991 | 9686.4 samples/s | 37.8 steps/s
[Step= 250] | Loss=0.46807 | acc=0.9026 | tpr=0.9773 | fpr=0.0988 | 8923.9 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.47225 | acc=0.9018 | tpr=0.9753 | fpr=0.0995 | 9637.7 samples/s | 37.6 steps/s
[Step= 350] | Loss=0.47519 | acc=0.9017 | tpr=0.9743 | fpr=0.0997 | 8950.2 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.47690 | acc=0.9012 | tpr=0.9721 | fpr=0.1001 | 9006.6 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.48184 | acc=0.9009 | tpr=0.9713 | fpr=0.1003 | 9540.8 samples/s | 37.3 steps/s
[Step= 500] | Loss=0.47995 | acc=0.9009 | tpr=0.9714 | fpr=0.1003 | 8968.0 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.47711 | acc=0.9012 | tpr=0.9717 | fpr=0.1001 | 18162.0 samples/s | 70.9 steps/s
Avg test loss: 0.47682, Avg test acc: 0.90120, Avg tpr: 0.97187, Avg fpr: 0.10008, total FA: 13896

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.14265 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.349 | acc=0.8594 | 3609.3 samples/s | 56.4 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01881 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.349 | acc=1.0000 | 4844.1 samples/s | 75.7 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01260 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.351 | acc=1.0000 | 5014.4 samples/s | 78.3 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01033 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.352 | acc=1.0000 | 4873.4 samples/s | 76.1 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00904 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=3.353 | acc=1.0000 | 4355.3 samples/s | 68.1 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00878 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.355 | acc=1.0000 | 3888.2 samples/s | 60.8 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00832 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=3.356 | acc=1.0000 | 3963.7 samples/s | 61.9 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00798 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=3.357 | acc=1.0000 | 3897.7 samples/s | 60.9 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00781 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=3.358 | acc=1.0000 | 3968.1 samples/s | 62.0 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00764 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.359 | acc=1.0000 | 3953.0 samples/s | 61.8 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00749 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.360 | acc=0.9844 | 4031.5 samples/s | 63.0 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00748 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.361 | acc=1.0000 | 3914.3 samples/s | 61.2 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00740 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.362 | acc=1.0000 | 3964.0 samples/s | 61.9 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00745 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.363 | acc=1.0000 | 3917.8 samples/s | 61.2 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00762 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.363 | acc=0.9844 | 3947.6 samples/s | 61.7 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00765 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.364 | acc=1.0000 | 3975.0 samples/s | 62.1 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00753 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=3.365 | acc=1.0000 | 3926.1 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.07285 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.349 | acc=0.9375 | 3537.6 samples/s | 55.3 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00396 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.351 | acc=1.0000 | 4629.9 samples/s | 72.3 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00200 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.352 | acc=1.0000 | 4826.1 samples/s | 75.4 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00135 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.352 | acc=1.0000 | 4916.5 samples/s | 76.8 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00101 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.352 | acc=1.0000 | 4733.0 samples/s | 74.0 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00082 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.352 | acc=1.0000 | 4819.5 samples/s | 75.3 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00068 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=3.353 | acc=1.0000 | 4872.4 samples/s | 76.1 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00059 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.353 | acc=1.0000 | 4809.7 samples/s | 75.2 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00052 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.353 | acc=1.0000 | 4791.1 samples/s | 74.9 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00046 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.353 | acc=1.0000 | 4849.2 samples/s | 75.8 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00042 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=3.353 | acc=1.0000 | 4947.2 samples/s | 77.3 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00038 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.353 | acc=1.0000 | 1505.5 samples/s | 23.5 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.353 | acc=1.0000 | 4785.1 samples/s | 74.8 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00032 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=3.353 | acc=1.0000 | 4885.9 samples/s | 76.3 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00030 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.353 | acc=1.0000 | 4805.5 samples/s | 75.1 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00028 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.354 | acc=1.0000 | 4825.0 samples/s | 75.4 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00026 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.354 | acc=1.0000 | 4765.6 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22814 | acc=0.8862 | tpr=0.8382 | fpr=0.0094 | 4534.4 samples/s | 17.7 steps/s
Avg test loss: 0.23862, Avg test acc: 0.88220, Avg tpr: 0.83325, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.48679 | acc=0.8915 | tpr=0.9646 | fpr=0.1098 | 4494.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.49873 | acc=0.8911 | tpr=0.9723 | fpr=0.1105 | 9264.5 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.50903 | acc=0.8920 | tpr=0.9726 | fpr=0.1095 | 9359.8 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.51079 | acc=0.8922 | tpr=0.9760 | fpr=0.1093 | 9256.5 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.50540 | acc=0.8927 | tpr=0.9764 | fpr=0.1088 | 9109.6 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.50976 | acc=0.8922 | tpr=0.9760 | fpr=0.1094 | 9297.0 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.51254 | acc=0.8920 | tpr=0.9750 | fpr=0.1095 | 9725.5 samples/s | 38.0 steps/s
[Step= 400] | Loss=0.51423 | acc=0.8916 | tpr=0.9732 | fpr=0.1099 | 9175.0 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.51920 | acc=0.8913 | tpr=0.9722 | fpr=0.1101 | 8687.9 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.51734 | acc=0.8913 | tpr=0.9722 | fpr=0.1101 | 9355.9 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.51448 | acc=0.8914 | tpr=0.9725 | fpr=0.1100 | 16684.6 samples/s | 65.2 steps/s
Avg test loss: 0.51426, Avg test acc: 0.89146, Avg tpr: 0.97266, Avg fpr: 0.11002, total FA: 15276

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.18914 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.365 | acc=0.8906 | 3715.3 samples/s | 58.1 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02085 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.365 | acc=1.0000 | 5105.6 samples/s | 79.8 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01328 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.366 | acc=1.0000 | 4976.6 samples/s | 77.8 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01137 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=3.367 | acc=0.9844 | 4931.5 samples/s | 77.1 steps/s
[Step=34600 Epoch=33.8] | Loss=0.01064 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.368 | acc=1.0000 | 5080.9 samples/s | 79.4 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00983 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.369 | acc=1.0000 | 4067.3 samples/s | 63.6 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00912 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=3.371 | acc=0.9844 | 3919.6 samples/s | 61.2 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00908 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.372 | acc=1.0000 | 3946.3 samples/s | 61.7 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00854 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.373 | acc=1.0000 | 3879.8 samples/s | 60.6 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00814 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.374 | acc=0.9844 | 3975.7 samples/s | 62.1 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00789 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.375 | acc=0.9531 | 3972.8 samples/s | 62.1 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00777 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=3.376 | acc=0.9844 | 3932.8 samples/s | 61.5 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00764 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=3.377 | acc=1.0000 | 3932.1 samples/s | 61.4 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00764 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.378 | acc=1.0000 | 3949.3 samples/s | 61.7 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00746 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.379 | acc=1.0000 | 3963.3 samples/s | 61.9 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00736 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.380 | acc=1.0000 | 3958.3 samples/s | 61.8 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00733 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.381 | acc=1.0000 | 3949.8 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.05150 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.366 | acc=0.9844 | 2760.6 samples/s | 43.1 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00512 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.367 | acc=1.0000 | 4744.6 samples/s | 74.1 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00259 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.368 | acc=1.0000 | 4930.3 samples/s | 77.0 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00173 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.368 | acc=1.0000 | 4667.0 samples/s | 72.9 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00131 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.368 | acc=1.0000 | 4751.1 samples/s | 74.2 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00107 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.368 | acc=1.0000 | 4783.1 samples/s | 74.7 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00090 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.369 | acc=1.0000 | 4751.4 samples/s | 74.2 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00077 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.369 | acc=1.0000 | 4837.6 samples/s | 75.6 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00068 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.369 | acc=1.0000 | 4746.9 samples/s | 74.2 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00060 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.369 | acc=1.0000 | 4796.7 samples/s | 74.9 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00055 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.370 | acc=1.0000 | 4871.3 samples/s | 76.1 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00050 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.370 | acc=1.0000 | 1521.6 samples/s | 23.8 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00046 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.370 | acc=1.0000 | 4975.2 samples/s | 77.7 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00042 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=3.370 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=3.370 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00037 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.370 | acc=1.0000 | 3825.5 samples/s | 59.8 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00034 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.370 | acc=1.0000 | 3750.0 samples/s | 58.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24158 | acc=0.8812 | tpr=0.8304 | fpr=0.0087 | 4186.6 samples/s | 16.4 steps/s
Avg test loss: 0.25239, Avg test acc: 0.87687, Avg tpr: 0.82532, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.48130 | acc=0.8937 | tpr=0.9646 | fpr=0.1076 | 4657.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.49320 | acc=0.8925 | tpr=0.9723 | fpr=0.1090 | 8948.2 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.50426 | acc=0.8933 | tpr=0.9726 | fpr=0.1082 | 9106.4 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.50567 | acc=0.8939 | tpr=0.9760 | fpr=0.1076 | 9966.0 samples/s | 38.9 steps/s
[Step= 250] | Loss=0.50044 | acc=0.8942 | tpr=0.9764 | fpr=0.1073 | 8926.3 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.50452 | acc=0.8935 | tpr=0.9753 | fpr=0.1080 | 9085.2 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.50742 | acc=0.8933 | tpr=0.9737 | fpr=0.1082 | 9619.0 samples/s | 37.6 steps/s
[Step= 400] | Loss=0.50916 | acc=0.8929 | tpr=0.9721 | fpr=0.1086 | 9037.9 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.51409 | acc=0.8927 | tpr=0.9713 | fpr=0.1087 | 9230.4 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.51215 | acc=0.8927 | tpr=0.9709 | fpr=0.1087 | 9221.4 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.50925 | acc=0.8929 | tpr=0.9713 | fpr=0.1085 | 17228.0 samples/s | 67.3 steps/s
Avg test loss: 0.50904, Avg test acc: 0.89286, Avg tpr: 0.97147, Avg fpr: 0.10856, total FA: 15074

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.18291 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.382 | acc=0.8906 | 3792.4 samples/s | 59.3 steps/s
[Step=35250 Epoch=34.4] | Loss=0.01994 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.381 | acc=1.0000 | 4677.8 samples/s | 73.1 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01261 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.382 | acc=1.0000 | 4959.7 samples/s | 77.5 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01068 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.383 | acc=0.9688 | 4987.1 samples/s | 77.9 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00967 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.384 | acc=1.0000 | 5010.9 samples/s | 78.3 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00928 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.386 | acc=0.9844 | 5129.9 samples/s | 80.2 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00868 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.386 | acc=1.0000 | 5133.1 samples/s | 80.2 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00848 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=3.388 | acc=1.0000 | 4494.1 samples/s | 70.2 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00810 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.388 | acc=1.0000 | 3949.0 samples/s | 61.7 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00794 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.389 | acc=0.9844 | 3938.6 samples/s | 61.5 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00779 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=3.390 | acc=1.0000 | 3929.7 samples/s | 61.4 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00764 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=3.391 | acc=1.0000 | 3979.6 samples/s | 62.2 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00750 | Reg=0.00210 | L2-Norm=14.509 | L2-Norm(final)=3.392 | acc=1.0000 | 3951.9 samples/s | 61.7 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00740 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.393 | acc=0.9844 | 3955.3 samples/s | 61.8 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00725 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.394 | acc=1.0000 | 3950.7 samples/s | 61.7 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00710 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.395 | acc=1.0000 | 3927.1 samples/s | 61.4 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00704 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.396 | acc=1.0000 | 3942.1 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.03442 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.382 | acc=0.9844 | 2842.1 samples/s | 44.4 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00263 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.387 | acc=1.0000 | 4780.4 samples/s | 74.7 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00132 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.388 | acc=1.0000 | 4833.4 samples/s | 75.5 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00089 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.388 | acc=1.0000 | 4793.2 samples/s | 74.9 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00067 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.388 | acc=1.0000 | 4858.9 samples/s | 75.9 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00054 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.388 | acc=1.0000 | 4738.8 samples/s | 74.0 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00045 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.388 | acc=1.0000 | 4697.6 samples/s | 73.4 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.388 | acc=1.0000 | 4924.5 samples/s | 76.9 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00035 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.388 | acc=1.0000 | 4614.7 samples/s | 72.1 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00031 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=3.388 | acc=1.0000 | 4749.1 samples/s | 74.2 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00028 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=3.388 | acc=1.0000 | 4791.3 samples/s | 74.9 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00025 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.389 | acc=1.0000 | 1467.9 samples/s | 22.9 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00023 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.389 | acc=1.0000 | 4834.8 samples/s | 75.5 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00022 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.389 | acc=1.0000 | 4657.8 samples/s | 72.8 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00020 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.389 | acc=1.0000 | 4799.6 samples/s | 75.0 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00019 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.389 | acc=1.0000 | 4886.8 samples/s | 76.4 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00018 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.389 | acc=1.0000 | 4805.8 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23045 | acc=0.8891 | tpr=0.8428 | fpr=0.0102 | 4487.1 samples/s | 17.5 steps/s
Avg test loss: 0.24114, Avg test acc: 0.88617, Avg tpr: 0.83937, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.50719 | acc=0.8891 | tpr=0.9646 | fpr=0.1122 | 4527.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.51915 | acc=0.8890 | tpr=0.9723 | fpr=0.1125 | 9219.9 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.52978 | acc=0.8899 | tpr=0.9726 | fpr=0.1116 | 9675.4 samples/s | 37.8 steps/s
[Step= 200] | Loss=0.53099 | acc=0.8901 | tpr=0.9760 | fpr=0.1114 | 9211.8 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.52559 | acc=0.8906 | tpr=0.9764 | fpr=0.1109 | 9022.1 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.53012 | acc=0.8899 | tpr=0.9738 | fpr=0.1116 | 9347.8 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.53297 | acc=0.8898 | tpr=0.9724 | fpr=0.1117 | 9479.6 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.53466 | acc=0.8895 | tpr=0.9705 | fpr=0.1120 | 9012.5 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.54001 | acc=0.8892 | tpr=0.9708 | fpr=0.1123 | 9064.7 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.53801 | acc=0.8894 | tpr=0.9705 | fpr=0.1121 | 9359.0 samples/s | 36.6 steps/s
[Step= 550] | Loss=0.53509 | acc=0.8896 | tpr=0.9710 | fpr=0.1119 | 17823.9 samples/s | 69.6 steps/s
Avg test loss: 0.53486, Avg test acc: 0.88958, Avg tpr: 0.97108, Avg fpr: 0.11190, total FA: 15537

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.04081 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.399 | acc=0.9688 | 3704.9 samples/s | 57.9 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01625 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.399 | acc=0.9844 | 4887.3 samples/s | 76.4 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01095 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.399 | acc=0.9844 | 4977.1 samples/s | 77.8 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00990 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.400 | acc=0.9844 | 4975.5 samples/s | 77.7 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00901 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.401 | acc=1.0000 | 4991.1 samples/s | 78.0 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00852 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.402 | acc=1.0000 | 5042.0 samples/s | 78.8 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00836 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.403 | acc=1.0000 | 4924.8 samples/s | 77.0 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00806 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.404 | acc=0.9844 | 4946.0 samples/s | 77.3 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00784 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.405 | acc=1.0000 | 4320.1 samples/s | 67.5 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00758 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.406 | acc=1.0000 | 4023.0 samples/s | 62.9 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00740 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.406 | acc=1.0000 | 3942.7 samples/s | 61.6 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00732 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.407 | acc=0.9844 | 3933.5 samples/s | 61.5 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00721 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.408 | acc=1.0000 | 4001.8 samples/s | 62.5 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00711 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.409 | acc=1.0000 | 3974.2 samples/s | 62.1 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00701 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.410 | acc=1.0000 | 3960.7 samples/s | 61.9 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00701 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.411 | acc=1.0000 | 3922.8 samples/s | 61.3 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00696 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.412 | acc=0.9844 | 3937.2 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.00726 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.399 | acc=0.9844 | 2996.9 samples/s | 46.8 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00569 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.402 | acc=1.0000 | 4392.1 samples/s | 68.6 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00287 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.402 | acc=1.0000 | 4775.4 samples/s | 74.6 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00192 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.402 | acc=1.0000 | 4879.5 samples/s | 76.2 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00144 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.402 | acc=1.0000 | 4835.1 samples/s | 75.5 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00116 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.402 | acc=1.0000 | 4847.1 samples/s | 75.7 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00096 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.402 | acc=1.0000 | 4845.4 samples/s | 75.7 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00083 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.402 | acc=1.0000 | 4794.2 samples/s | 74.9 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00073 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.402 | acc=1.0000 | 4813.6 samples/s | 75.2 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00065 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.402 | acc=1.0000 | 4806.3 samples/s | 75.1 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00058 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.402 | acc=1.0000 | 4888.7 samples/s | 76.4 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00053 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.402 | acc=1.0000 | 1477.9 samples/s | 23.1 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00049 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.402 | acc=1.0000 | 4785.9 samples/s | 74.8 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00045 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.402 | acc=1.0000 | 4659.6 samples/s | 72.8 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00042 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.402 | acc=1.0000 | 4820.5 samples/s | 75.3 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.402 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00037 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.402 | acc=1.0000 | 4882.2 samples/s | 76.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26570 | acc=0.8722 | tpr=0.8174 | fpr=0.0089 | 4564.4 samples/s | 17.8 steps/s
Avg test loss: 0.27557, Avg test acc: 0.86970, Avg tpr: 0.81483, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.49299 | acc=0.8980 | tpr=0.9646 | fpr=0.1032 | 4693.2 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.50461 | acc=0.8974 | tpr=0.9744 | fpr=0.1041 | 8497.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.51603 | acc=0.8976 | tpr=0.9741 | fpr=0.1038 | 9739.6 samples/s | 38.0 steps/s
[Step= 200] | Loss=0.51700 | acc=0.8986 | tpr=0.9770 | fpr=0.1028 | 9231.0 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.51167 | acc=0.8990 | tpr=0.9773 | fpr=0.1025 | 9108.2 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.51632 | acc=0.8982 | tpr=0.9753 | fpr=0.1032 | 9186.6 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.51945 | acc=0.8979 | tpr=0.9737 | fpr=0.1034 | 9669.4 samples/s | 37.8 steps/s
[Step= 400] | Loss=0.52124 | acc=0.8975 | tpr=0.9716 | fpr=0.1038 | 8846.5 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.52656 | acc=0.8973 | tpr=0.9713 | fpr=0.1040 | 9570.2 samples/s | 37.4 steps/s
[Step= 500] | Loss=0.52459 | acc=0.8972 | tpr=0.9709 | fpr=0.1041 | 8819.6 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.52139 | acc=0.8975 | tpr=0.9713 | fpr=0.1039 | 17080.3 samples/s | 66.7 steps/s
Avg test loss: 0.52110, Avg test acc: 0.89751, Avg tpr: 0.97147, Avg fpr: 0.10383, total FA: 14417

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.07559 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.413 | acc=0.9219 | 3537.9 samples/s | 55.3 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02347 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.409 | acc=1.0000 | 5103.5 samples/s | 79.7 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01426 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.409 | acc=1.0000 | 5129.7 samples/s | 80.2 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01204 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.410 | acc=0.9688 | 4861.2 samples/s | 76.0 steps/s
[Step=37000 Epoch=36.1] | Loss=0.01062 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.411 | acc=1.0000 | 5064.4 samples/s | 79.1 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00989 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.412 | acc=1.0000 | 4960.1 samples/s | 77.5 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00921 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.413 | acc=1.0000 | 4978.0 samples/s | 77.8 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00879 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.414 | acc=1.0000 | 4962.6 samples/s | 77.5 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00836 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.415 | acc=1.0000 | 5122.9 samples/s | 80.0 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00810 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.416 | acc=1.0000 | 4911.1 samples/s | 76.7 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00789 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.416 | acc=1.0000 | 4975.9 samples/s | 77.7 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00773 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.417 | acc=1.0000 | 4414.6 samples/s | 69.0 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00762 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.418 | acc=1.0000 | 3921.3 samples/s | 61.3 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00741 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.419 | acc=0.9844 | 3944.7 samples/s | 61.6 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00737 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.420 | acc=1.0000 | 3913.8 samples/s | 61.2 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00733 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.421 | acc=1.0000 | 3914.6 samples/s | 61.2 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00718 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.422 | acc=1.0000 | 3965.0 samples/s | 62.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.02447 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.413 | acc=0.9688 | 2931.4 samples/s | 45.8 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00601 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.415 | acc=1.0000 | 4497.1 samples/s | 70.3 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00301 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.415 | acc=1.0000 | 4742.3 samples/s | 74.1 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00201 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.414 | acc=1.0000 | 4852.3 samples/s | 75.8 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00151 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.414 | acc=1.0000 | 4786.0 samples/s | 74.8 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00121 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.414 | acc=1.0000 | 4932.8 samples/s | 77.1 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00101 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.414 | acc=1.0000 | 4771.8 samples/s | 74.6 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00087 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.415 | acc=1.0000 | 4769.0 samples/s | 74.5 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00076 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.415 | acc=1.0000 | 4816.8 samples/s | 75.3 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00068 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.415 | acc=1.0000 | 4761.8 samples/s | 74.4 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00061 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.415 | acc=1.0000 | 4952.7 samples/s | 77.4 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00056 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.415 | acc=1.0000 | 1490.7 samples/s | 23.3 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00051 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.415 | acc=1.0000 | 4894.0 samples/s | 76.5 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00047 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.415 | acc=1.0000 | 4903.1 samples/s | 76.6 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00044 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.415 | acc=1.0000 | 4786.0 samples/s | 74.8 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00041 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.415 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.415 | acc=1.0000 | 4826.5 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26121 | acc=0.8761 | tpr=0.8235 | fpr=0.0097 | 4476.7 samples/s | 17.5 steps/s
Avg test loss: 0.27225, Avg test acc: 0.87383, Avg tpr: 0.82101, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.46511 | acc=0.9021 | tpr=0.9602 | fpr=0.0989 | 4510.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.47617 | acc=0.9014 | tpr=0.9701 | fpr=0.0999 | 9310.8 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.48722 | acc=0.9020 | tpr=0.9712 | fpr=0.0993 | 9243.0 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.48803 | acc=0.9029 | tpr=0.9749 | fpr=0.0984 | 9225.9 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.48287 | acc=0.9030 | tpr=0.9755 | fpr=0.0983 | 9218.5 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.48721 | acc=0.9025 | tpr=0.9731 | fpr=0.0988 | 9584.3 samples/s | 37.4 steps/s
[Step= 350] | Loss=0.49014 | acc=0.9025 | tpr=0.9718 | fpr=0.0988 | 9234.1 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.49195 | acc=0.9020 | tpr=0.9699 | fpr=0.0992 | 9043.5 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.49733 | acc=0.9019 | tpr=0.9693 | fpr=0.0993 | 9300.0 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.49522 | acc=0.9018 | tpr=0.9687 | fpr=0.0994 | 5481.2 samples/s | 21.4 steps/s
[Step= 550] | Loss=0.49213 | acc=0.9019 | tpr=0.9694 | fpr=0.0993 | 17498.0 samples/s | 68.4 steps/s
Avg test loss: 0.49185, Avg test acc: 0.90193, Avg tpr: 0.96949, Avg fpr: 0.09930, total FA: 13788

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.17354 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.425 | acc=0.8594 | 3673.1 samples/s | 57.4 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01972 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.423 | acc=1.0000 | 5106.8 samples/s | 79.8 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01256 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.424 | acc=1.0000 | 4948.2 samples/s | 77.3 steps/s
[Step=37750 Epoch=36.9] | Loss=0.01068 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.425 | acc=1.0000 | 5038.9 samples/s | 78.7 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00951 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.426 | acc=0.9844 | 4755.3 samples/s | 74.3 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00915 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.426 | acc=1.0000 | 3882.3 samples/s | 60.7 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00901 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.427 | acc=1.0000 | 3961.9 samples/s | 61.9 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00844 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.428 | acc=1.0000 | 3918.6 samples/s | 61.2 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00802 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.429 | acc=1.0000 | 3985.1 samples/s | 62.3 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00796 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.430 | acc=0.9844 | 3901.2 samples/s | 61.0 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00762 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.431 | acc=1.0000 | 3961.9 samples/s | 61.9 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00753 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.432 | acc=1.0000 | 3943.0 samples/s | 61.6 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00727 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.432 | acc=1.0000 | 3946.1 samples/s | 61.7 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00725 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.433 | acc=0.9844 | 3944.7 samples/s | 61.6 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00727 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.434 | acc=1.0000 | 3970.9 samples/s | 62.0 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00713 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.435 | acc=1.0000 | 3904.8 samples/s | 61.0 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00709 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.436 | acc=0.9844 | 3953.8 samples/s | 61.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.01247 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.425 | acc=1.0000 | 2865.2 samples/s | 44.8 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00341 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.429 | acc=1.0000 | 4933.0 samples/s | 77.1 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00172 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.429 | acc=1.0000 | 4493.8 samples/s | 70.2 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00115 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.430 | acc=1.0000 | 4657.3 samples/s | 72.8 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00088 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.430 | acc=1.0000 | 4784.2 samples/s | 74.8 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00070 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.430 | acc=1.0000 | 4802.8 samples/s | 75.0 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00059 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.430 | acc=1.0000 | 4664.5 samples/s | 72.9 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00051 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.430 | acc=1.0000 | 4701.3 samples/s | 73.5 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00045 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.431 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00040 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.431 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00036 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.431 | acc=1.0000 | 4708.0 samples/s | 73.6 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00033 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.431 | acc=1.0000 | 1513.1 samples/s | 23.6 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00030 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.431 | acc=1.0000 | 4926.2 samples/s | 77.0 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00028 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.431 | acc=1.0000 | 4853.8 samples/s | 75.8 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00026 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=3.431 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00024 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.431 | acc=1.0000 | 4765.1 samples/s | 74.5 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.431 | acc=1.0000 | 4830.8 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23659 | acc=0.8878 | tpr=0.8408 | fpr=0.0102 | 4496.5 samples/s | 17.6 steps/s
Avg test loss: 0.24730, Avg test acc: 0.88509, Avg tpr: 0.83768, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.48782 | acc=0.8969 | tpr=0.9646 | fpr=0.1043 | 4502.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.49969 | acc=0.8962 | tpr=0.9744 | fpr=0.1053 | 9249.0 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.51124 | acc=0.8971 | tpr=0.9741 | fpr=0.1043 | 9609.6 samples/s | 37.5 steps/s
[Step= 200] | Loss=0.51182 | acc=0.8980 | tpr=0.9770 | fpr=0.1035 | 9038.8 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.50651 | acc=0.8986 | tpr=0.9773 | fpr=0.1028 | 9302.8 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.51061 | acc=0.8982 | tpr=0.9753 | fpr=0.1032 | 9337.3 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.51368 | acc=0.8982 | tpr=0.9737 | fpr=0.1032 | 9688.7 samples/s | 37.8 steps/s
[Step= 400] | Loss=0.51543 | acc=0.8979 | tpr=0.9721 | fpr=0.1035 | 8493.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.52089 | acc=0.8976 | tpr=0.9713 | fpr=0.1037 | 6052.5 samples/s | 23.6 steps/s
[Step= 500] | Loss=0.51882 | acc=0.8975 | tpr=0.9709 | fpr=0.1038 | 9352.3 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.51554 | acc=0.8977 | tpr=0.9713 | fpr=0.1036 | 16302.0 samples/s | 63.7 steps/s
Avg test loss: 0.51527, Avg test acc: 0.89772, Avg tpr: 0.97147, Avg fpr: 0.10362, total FA: 14387

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.12017 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.439 | acc=0.8906 | 3747.2 samples/s | 58.5 steps/s
[Step=38450 Epoch=37.5] | Loss=0.02156 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.437 | acc=1.0000 | 4706.7 samples/s | 73.5 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01391 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.437 | acc=1.0000 | 5087.2 samples/s | 79.5 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01098 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=3.438 | acc=1.0000 | 4914.5 samples/s | 76.8 steps/s
[Step=38600 Epoch=37.7] | Loss=0.01007 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.439 | acc=0.9844 | 4973.2 samples/s | 77.7 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00927 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.440 | acc=0.9844 | 5040.5 samples/s | 78.8 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00859 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.441 | acc=1.0000 | 4993.2 samples/s | 78.0 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00823 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.442 | acc=1.0000 | 5013.4 samples/s | 78.3 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00796 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.443 | acc=1.0000 | 4849.4 samples/s | 75.8 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00772 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.444 | acc=1.0000 | 5088.0 samples/s | 79.5 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00745 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.445 | acc=1.0000 | 4051.2 samples/s | 63.3 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00739 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.446 | acc=1.0000 | 3914.6 samples/s | 61.2 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00725 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.447 | acc=1.0000 | 3985.6 samples/s | 62.3 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00714 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.448 | acc=0.9844 | 3972.1 samples/s | 62.1 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00710 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.448 | acc=0.9844 | 3943.4 samples/s | 61.6 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00706 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.449 | acc=1.0000 | 3965.9 samples/s | 62.0 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00702 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.450 | acc=0.9844 | 4002.0 samples/s | 62.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.03840 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.439 | acc=0.9688 | 3529.9 samples/s | 55.2 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00347 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.444 | acc=1.0000 | 4441.2 samples/s | 69.4 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00174 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.444 | acc=1.0000 | 4723.3 samples/s | 73.8 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00116 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.445 | acc=1.0000 | 4806.3 samples/s | 75.1 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00087 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.445 | acc=1.0000 | 4800.1 samples/s | 75.0 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00070 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.445 | acc=1.0000 | 4739.9 samples/s | 74.1 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00058 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.445 | acc=1.0000 | 4796.9 samples/s | 75.0 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00050 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.445 | acc=1.0000 | 4854.1 samples/s | 75.8 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00044 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.445 | acc=1.0000 | 4882.5 samples/s | 76.3 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.445 | acc=1.0000 | 4924.4 samples/s | 76.9 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00035 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.445 | acc=1.0000 | 4919.3 samples/s | 76.9 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00032 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.445 | acc=1.0000 | 1485.8 samples/s | 23.2 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00029 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=3.445 | acc=1.0000 | 4751.6 samples/s | 74.2 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00027 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.445 | acc=1.0000 | 4824.1 samples/s | 75.4 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00025 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.445 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00024 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.445 | acc=1.0000 | 4707.7 samples/s | 73.6 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00022 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.445 | acc=1.0000 | 4824.1 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24469 | acc=0.8854 | tpr=0.8372 | fpr=0.0099 | 4586.9 samples/s | 17.9 steps/s
Avg test loss: 0.25551, Avg test acc: 0.88252, Avg tpr: 0.83389, Avg fpr: 0.01051, total FA: 82

Testing server on iccad2012
[Step=  50] | Loss=0.47801 | acc=0.9020 | tpr=0.9646 | fpr=0.0991 | 4585.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.48898 | acc=0.9013 | tpr=0.9744 | fpr=0.1000 | 9458.8 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.50045 | acc=0.9020 | tpr=0.9741 | fpr=0.0993 | 8315.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.50221 | acc=0.9028 | tpr=0.9770 | fpr=0.0985 | 9398.2 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.49682 | acc=0.9032 | tpr=0.9773 | fpr=0.0981 | 9390.4 samples/s | 36.7 steps/s
[Step= 300] | Loss=0.50109 | acc=0.9029 | tpr=0.9745 | fpr=0.0984 | 9234.7 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.50416 | acc=0.9027 | tpr=0.9731 | fpr=0.0986 | 5903.1 samples/s | 23.1 steps/s
[Step= 400] | Loss=0.50566 | acc=0.9022 | tpr=0.9710 | fpr=0.0991 | 9227.8 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.51124 | acc=0.9020 | tpr=0.9703 | fpr=0.0993 | 9356.1 samples/s | 36.5 steps/s
[Step= 500] | Loss=0.50912 | acc=0.9019 | tpr=0.9700 | fpr=0.0993 | 9201.6 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.50593 | acc=0.9022 | tpr=0.9706 | fpr=0.0991 | 16891.3 samples/s | 66.0 steps/s
Avg test loss: 0.50564, Avg test acc: 0.90217, Avg tpr: 0.97068, Avg fpr: 0.09908, total FA: 13757

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.08591 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.453 | acc=0.9219 | 3847.6 samples/s | 60.1 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01883 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.451 | acc=0.9844 | 4573.2 samples/s | 71.5 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01231 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.451 | acc=0.9844 | 4996.5 samples/s | 78.1 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01014 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.452 | acc=1.0000 | 4852.4 samples/s | 75.8 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00888 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.453 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00819 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.454 | acc=1.0000 | 5027.7 samples/s | 78.6 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00780 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.455 | acc=0.9844 | 4997.4 samples/s | 78.1 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00745 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.456 | acc=1.0000 | 4932.5 samples/s | 77.1 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00717 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=3.457 | acc=1.0000 | 4992.0 samples/s | 78.0 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00702 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=3.457 | acc=1.0000 | 4914.9 samples/s | 76.8 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00697 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.458 | acc=1.0000 | 5108.9 samples/s | 79.8 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00685 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.459 | acc=1.0000 | 4811.1 samples/s | 75.2 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00698 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.460 | acc=1.0000 | 3909.5 samples/s | 61.1 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00701 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.460 | acc=1.0000 | 3919.5 samples/s | 61.2 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00690 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.461 | acc=1.0000 | 3947.5 samples/s | 61.7 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00684 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.462 | acc=1.0000 | 3959.6 samples/s | 61.9 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00688 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.463 | acc=1.0000 | 3970.5 samples/s | 62.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.02620 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.453 | acc=0.9688 | 2889.5 samples/s | 45.1 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00330 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.456 | acc=1.0000 | 4462.8 samples/s | 69.7 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00166 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.456 | acc=1.0000 | 4720.1 samples/s | 73.8 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00112 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.457 | acc=1.0000 | 4830.0 samples/s | 75.5 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00084 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.457 | acc=1.0000 | 4505.6 samples/s | 70.4 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00068 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.457 | acc=1.0000 | 4756.4 samples/s | 74.3 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00057 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.457 | acc=1.0000 | 4798.5 samples/s | 75.0 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00049 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.457 | acc=1.0000 | 4774.8 samples/s | 74.6 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00043 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.457 | acc=1.0000 | 4890.0 samples/s | 76.4 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00038 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.457 | acc=1.0000 | 4685.2 samples/s | 73.2 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00034 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.457 | acc=1.0000 | 4812.7 samples/s | 75.2 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=3.457 | acc=1.0000 | 1485.0 samples/s | 23.2 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00029 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=3.458 | acc=1.0000 | 4809.0 samples/s | 75.1 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00027 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.458 | acc=1.0000 | 4769.6 samples/s | 74.5 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00025 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.458 | acc=1.0000 | 4724.7 samples/s | 73.8 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.458 | acc=1.0000 | 4880.1 samples/s | 76.3 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00022 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.458 | acc=1.0000 | 4799.1 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22796 | acc=0.8929 | tpr=0.8487 | fpr=0.0111 | 4699.4 samples/s | 18.4 steps/s
Avg test loss: 0.23757, Avg test acc: 0.89070, Avg tpr: 0.84619, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.49190 | acc=0.8955 | tpr=0.9646 | fpr=0.1057 | 4577.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.50272 | acc=0.8948 | tpr=0.9744 | fpr=0.1067 | 8355.4 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.51333 | acc=0.8955 | tpr=0.9741 | fpr=0.1060 | 9523.9 samples/s | 37.2 steps/s
[Step= 200] | Loss=0.51432 | acc=0.8958 | tpr=0.9770 | fpr=0.1057 | 9302.4 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.50916 | acc=0.8962 | tpr=0.9773 | fpr=0.1052 | 5890.7 samples/s | 23.0 steps/s
[Step= 300] | Loss=0.51313 | acc=0.8959 | tpr=0.9753 | fpr=0.1055 | 9943.9 samples/s | 38.8 steps/s
[Step= 350] | Loss=0.51599 | acc=0.8957 | tpr=0.9731 | fpr=0.1057 | 8511.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.51770 | acc=0.8953 | tpr=0.9710 | fpr=0.1061 | 9209.1 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.52313 | acc=0.8951 | tpr=0.9703 | fpr=0.1062 | 9083.6 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.52106 | acc=0.8951 | tpr=0.9700 | fpr=0.1063 | 9564.8 samples/s | 37.4 steps/s
[Step= 550] | Loss=0.51803 | acc=0.8953 | tpr=0.9706 | fpr=0.1061 | 16420.7 samples/s | 64.1 steps/s
Avg test loss: 0.51781, Avg test acc: 0.89526, Avg tpr: 0.97068, Avg fpr: 0.10611, total FA: 14733
