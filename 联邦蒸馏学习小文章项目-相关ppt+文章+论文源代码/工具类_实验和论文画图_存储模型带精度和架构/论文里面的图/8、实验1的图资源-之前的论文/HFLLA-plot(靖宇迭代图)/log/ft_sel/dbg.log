Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38724 | Reg=0.00000 | L2-Norm=18.914 | L2-Norm(final)=1.976 | acc=0.4219 | 2893.2 samples/s | 45.2 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29851 | Reg=0.00000 | L2-Norm=18.963 | L2-Norm(final)=1.965 | acc=0.7500 | 5073.6 samples/s | 79.3 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25714 | Reg=0.00000 | L2-Norm=19.020 | L2-Norm(final)=1.973 | acc=0.7188 | 5008.2 samples/s | 78.3 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.23290 | Reg=0.00000 | L2-Norm=19.072 | L2-Norm(final)=1.978 | acc=0.8125 | 5008.7 samples/s | 78.3 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.21425 | Reg=0.00000 | L2-Norm=19.125 | L2-Norm(final)=1.986 | acc=0.8125 | 5056.6 samples/s | 79.0 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.20107 | Reg=0.00000 | L2-Norm=19.176 | L2-Norm(final)=1.993 | acc=0.9062 | 5085.3 samples/s | 79.5 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18813 | Reg=0.00000 | L2-Norm=19.227 | L2-Norm(final)=2.000 | acc=0.9219 | 4988.8 samples/s | 78.0 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17950 | Reg=0.00000 | L2-Norm=19.278 | L2-Norm(final)=2.007 | acc=0.9375 | 5047.0 samples/s | 78.9 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.17121 | Reg=0.00000 | L2-Norm=19.329 | L2-Norm(final)=2.013 | acc=0.9375 | 5024.2 samples/s | 78.5 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16417 | Reg=0.00000 | L2-Norm=19.377 | L2-Norm(final)=2.019 | acc=0.9375 | 4941.1 samples/s | 77.2 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15894 | Reg=0.00000 | L2-Norm=19.423 | L2-Norm(final)=2.023 | acc=0.9531 | 4964.7 samples/s | 77.6 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15432 | Reg=0.00000 | L2-Norm=19.469 | L2-Norm(final)=2.028 | acc=0.9219 | 4986.3 samples/s | 77.9 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14965 | Reg=0.00000 | L2-Norm=19.515 | L2-Norm(final)=2.031 | acc=0.9531 | 4946.3 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.44834 | Reg=0.00000 | L2-Norm=18.914 | L2-Norm(final)=1.977 | acc=0.5000 | 3763.1 samples/s | 58.8 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.18657 | Reg=0.00000 | L2-Norm=18.999 | L2-Norm(final)=1.991 | acc=0.9844 | 4540.2 samples/s | 70.9 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.12575 | Reg=0.00000 | L2-Norm=19.065 | L2-Norm(final)=2.007 | acc=0.9688 | 4598.9 samples/s | 71.9 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.09391 | Reg=0.00000 | L2-Norm=19.111 | L2-Norm(final)=2.018 | acc=0.9844 | 4576.9 samples/s | 71.5 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.07647 | Reg=0.00000 | L2-Norm=19.149 | L2-Norm(final)=2.027 | acc=1.0000 | 4628.3 samples/s | 72.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.06391 | Reg=0.00000 | L2-Norm=19.184 | L2-Norm(final)=2.034 | acc=0.9688 | 4583.6 samples/s | 71.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05545 | Reg=0.00000 | L2-Norm=19.217 | L2-Norm(final)=2.041 | acc=0.9688 | 4647.2 samples/s | 72.6 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04885 | Reg=0.00000 | L2-Norm=19.245 | L2-Norm(final)=2.046 | acc=1.0000 | 4571.9 samples/s | 71.4 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04374 | Reg=0.00000 | L2-Norm=19.271 | L2-Norm(final)=2.051 | acc=1.0000 | 4636.0 samples/s | 72.4 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03932 | Reg=0.00000 | L2-Norm=19.295 | L2-Norm(final)=2.056 | acc=1.0000 | 4529.0 samples/s | 70.8 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03670 | Reg=0.00000 | L2-Norm=19.318 | L2-Norm(final)=2.060 | acc=0.9688 | 4202.0 samples/s | 65.7 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03375 | Reg=0.00000 | L2-Norm=19.341 | L2-Norm(final)=2.064 | acc=1.0000 | 1823.8 samples/s | 28.5 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.03121 | Reg=0.00000 | L2-Norm=19.363 | L2-Norm(final)=2.068 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step600.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46859 | acc=0.4675 | tpr=0.2458 | fpr=0.0510 | 4200.2 samples/s | 16.4 steps/s
Avg test loss: 0.47066, Avg test acc: 0.46466, Avg tpr: 0.24410, Avg fpr: 0.05025, total FA: 392

Testing server on iccad2012
[Step=  50] | Loss=0.18779 | acc=0.8610 | tpr=0.9292 | fpr=0.1402 | 4221.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.18870 | acc=0.8601 | tpr=0.9318 | fpr=0.1412 | 8695.5 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.18907 | acc=0.8604 | tpr=0.9352 | fpr=0.1410 | 7959.5 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.18938 | acc=0.8604 | tpr=0.9311 | fpr=0.1408 | 8542.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.18941 | acc=0.8598 | tpr=0.9258 | fpr=0.1414 | 8395.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.18951 | acc=0.8599 | tpr=0.9258 | fpr=0.1413 | 8815.8 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.18968 | acc=0.8598 | tpr=0.9286 | fpr=0.1414 | 8255.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.18984 | acc=0.8599 | tpr=0.9300 | fpr=0.1413 | 8342.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.19016 | acc=0.8597 | tpr=0.9260 | fpr=0.1415 | 8541.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.19007 | acc=0.8597 | tpr=0.9282 | fpr=0.1416 | 8224.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.18970 | acc=0.8603 | tpr=0.9288 | fpr=0.1409 | 14975.8 samples/s | 58.5 steps/s
Avg test loss: 0.18966, Avg test acc: 0.86035, Avg tpr: 0.92908, Avg fpr: 0.14090, total FA: 19563

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 601 Epoch= 0.6] | Loss=0.41798 | Reg=0.00000 | L2-Norm=19.400 | L2-Norm(final)=2.080 | acc=0.4375 | 4119.6 samples/s | 64.4 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.16430 | Reg=0.00000 | L2-Norm=19.538 | L2-Norm(final)=2.064 | acc=0.9219 | 4228.9 samples/s | 66.1 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.14708 | Reg=0.00000 | L2-Norm=19.613 | L2-Norm(final)=2.068 | acc=0.9531 | 4948.3 samples/s | 77.3 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13380 | Reg=0.00000 | L2-Norm=19.674 | L2-Norm(final)=2.075 | acc=0.9375 | 5007.5 samples/s | 78.2 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12392 | Reg=0.00000 | L2-Norm=19.729 | L2-Norm(final)=2.084 | acc=0.9375 | 4947.9 samples/s | 77.3 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.11917 | Reg=0.00000 | L2-Norm=19.776 | L2-Norm(final)=2.090 | acc=0.8906 | 4942.0 samples/s | 77.2 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.11441 | Reg=0.00000 | L2-Norm=19.821 | L2-Norm(final)=2.096 | acc=0.9375 | 4987.0 samples/s | 77.9 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.11188 | Reg=0.00000 | L2-Norm=19.863 | L2-Norm(final)=2.100 | acc=0.9531 | 4987.1 samples/s | 77.9 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.10918 | Reg=0.00000 | L2-Norm=19.903 | L2-Norm(final)=2.103 | acc=0.9688 | 4852.1 samples/s | 75.8 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.10709 | Reg=0.00000 | L2-Norm=19.942 | L2-Norm(final)=2.107 | acc=0.9219 | 4828.0 samples/s | 75.4 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10497 | Reg=0.00000 | L2-Norm=19.980 | L2-Norm(final)=2.109 | acc=0.9531 | 4873.7 samples/s | 76.2 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10282 | Reg=0.00000 | L2-Norm=20.017 | L2-Norm(final)=2.112 | acc=0.9375 | 4824.9 samples/s | 75.4 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10053 | Reg=0.00000 | L2-Norm=20.052 | L2-Norm(final)=2.115 | acc=0.8594 | 4846.2 samples/s | 75.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 601 Epoch= 1.1] | Loss=0.13498 | Reg=0.00000 | L2-Norm=19.400 | L2-Norm(final)=2.082 | acc=0.9375 | 3830.3 samples/s | 59.8 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.04513 | Reg=0.00000 | L2-Norm=19.568 | L2-Norm(final)=2.101 | acc=1.0000 | 4273.0 samples/s | 66.8 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02905 | Reg=0.00000 | L2-Norm=19.643 | L2-Norm(final)=2.104 | acc=1.0000 | 4637.2 samples/s | 72.5 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02201 | Reg=0.00000 | L2-Norm=19.690 | L2-Norm(final)=2.110 | acc=0.9844 | 4671.0 samples/s | 73.0 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.01920 | Reg=0.00000 | L2-Norm=19.722 | L2-Norm(final)=2.113 | acc=1.0000 | 4675.3 samples/s | 73.1 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.01616 | Reg=0.00000 | L2-Norm=19.748 | L2-Norm(final)=2.116 | acc=1.0000 | 4574.8 samples/s | 71.5 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.01443 | Reg=0.00000 | L2-Norm=19.770 | L2-Norm(final)=2.119 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.01290 | Reg=0.00000 | L2-Norm=19.792 | L2-Norm(final)=2.123 | acc=1.0000 | 4572.5 samples/s | 71.4 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01172 | Reg=0.00000 | L2-Norm=19.813 | L2-Norm(final)=2.126 | acc=1.0000 | 4621.5 samples/s | 72.2 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01056 | Reg=0.00000 | L2-Norm=19.832 | L2-Norm(final)=2.129 | acc=1.0000 | 4626.3 samples/s | 72.3 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.00989 | Reg=0.00000 | L2-Norm=19.849 | L2-Norm(final)=2.133 | acc=1.0000 | 4645.9 samples/s | 72.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.00949 | Reg=0.00000 | L2-Norm=19.866 | L2-Norm(final)=2.135 | acc=1.0000 | 2012.4 samples/s | 31.4 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.00886 | Reg=0.00000 | L2-Norm=19.883 | L2-Norm(final)=2.137 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1200.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48970 | acc=0.5437 | tpr=0.3552 | fpr=0.0471 | 4278.6 samples/s | 16.7 steps/s
Avg test loss: 0.49325, Avg test acc: 0.54271, Avg tpr: 0.35496, Avg fpr: 0.04435, total FA: 346

Testing server on iccad2012
[Step=  50] | Loss=0.19432 | acc=0.8371 | tpr=0.9690 | fpr=0.1653 | 4042.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.19463 | acc=0.8398 | tpr=0.9808 | fpr=0.1629 | 8265.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.19567 | acc=0.8392 | tpr=0.9798 | fpr=0.1634 | 8332.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.19572 | acc=0.8397 | tpr=0.9727 | fpr=0.1627 | 8770.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.19556 | acc=0.8390 | tpr=0.9721 | fpr=0.1634 | 8274.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.19593 | acc=0.8391 | tpr=0.9687 | fpr=0.1632 | 8243.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.19663 | acc=0.8383 | tpr=0.9699 | fpr=0.1641 | 8586.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.19709 | acc=0.8379 | tpr=0.9666 | fpr=0.1645 | 8706.2 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.19782 | acc=0.8374 | tpr=0.9669 | fpr=0.1649 | 8198.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.19761 | acc=0.8377 | tpr=0.9692 | fpr=0.1647 | 8269.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.19701 | acc=0.8386 | tpr=0.9690 | fpr=0.1638 | 15395.2 samples/s | 60.1 steps/s
Avg test loss: 0.19689, Avg test acc: 0.83862, Avg tpr: 0.96910, Avg fpr: 0.16375, total FA: 22736

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1201 Epoch= 1.2] | Loss=0.32055 | Reg=0.00000 | L2-Norm=19.929 | L2-Norm(final)=2.141 | acc=0.7812 | 3773.0 samples/s | 59.0 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.14003 | Reg=0.00000 | L2-Norm=20.027 | L2-Norm(final)=2.132 | acc=0.9219 | 4706.9 samples/s | 73.5 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.11365 | Reg=0.00000 | L2-Norm=20.097 | L2-Norm(final)=2.143 | acc=0.9531 | 4850.2 samples/s | 75.8 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.10560 | Reg=0.00000 | L2-Norm=20.151 | L2-Norm(final)=2.154 | acc=0.8906 | 4837.6 samples/s | 75.6 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09917 | Reg=0.00000 | L2-Norm=20.196 | L2-Norm(final)=2.158 | acc=0.9375 | 4885.1 samples/s | 76.3 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09446 | Reg=0.00000 | L2-Norm=20.239 | L2-Norm(final)=2.165 | acc=0.9531 | 4933.7 samples/s | 77.1 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09039 | Reg=0.00000 | L2-Norm=20.280 | L2-Norm(final)=2.171 | acc=0.9531 | 4860.2 samples/s | 75.9 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08754 | Reg=0.00000 | L2-Norm=20.319 | L2-Norm(final)=2.177 | acc=0.9688 | 4804.1 samples/s | 75.1 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08563 | Reg=0.00000 | L2-Norm=20.356 | L2-Norm(final)=2.181 | acc=0.8906 | 4913.1 samples/s | 76.8 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.08430 | Reg=0.00000 | L2-Norm=20.391 | L2-Norm(final)=2.183 | acc=0.9062 | 4907.2 samples/s | 76.7 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.08327 | Reg=0.00000 | L2-Norm=20.427 | L2-Norm(final)=2.185 | acc=0.9688 | 4811.2 samples/s | 75.2 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.08134 | Reg=0.00000 | L2-Norm=20.462 | L2-Norm(final)=2.188 | acc=0.8906 | 4889.4 samples/s | 76.4 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.08031 | Reg=0.00000 | L2-Norm=20.497 | L2-Norm(final)=2.190 | acc=0.9375 | 4784.7 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1201 Epoch= 2.3] | Loss=0.09091 | Reg=0.00000 | L2-Norm=19.929 | L2-Norm(final)=2.142 | acc=0.9219 | 3568.7 samples/s | 55.8 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.02202 | Reg=0.00000 | L2-Norm=20.062 | L2-Norm(final)=2.155 | acc=1.0000 | 4477.2 samples/s | 70.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01391 | Reg=0.00000 | L2-Norm=20.126 | L2-Norm(final)=2.157 | acc=0.9844 | 4564.9 samples/s | 71.3 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01230 | Reg=0.00000 | L2-Norm=20.163 | L2-Norm(final)=2.160 | acc=0.9844 | 4597.3 samples/s | 71.8 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.01026 | Reg=0.00000 | L2-Norm=20.191 | L2-Norm(final)=2.160 | acc=1.0000 | 4607.9 samples/s | 72.0 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00902 | Reg=0.00000 | L2-Norm=20.215 | L2-Norm(final)=2.163 | acc=0.9844 | 4673.9 samples/s | 73.0 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00845 | Reg=0.00000 | L2-Norm=20.237 | L2-Norm(final)=2.165 | acc=1.0000 | 4570.4 samples/s | 71.4 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00779 | Reg=0.00000 | L2-Norm=20.256 | L2-Norm(final)=2.166 | acc=1.0000 | 4618.8 samples/s | 72.2 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00694 | Reg=0.00000 | L2-Norm=20.274 | L2-Norm(final)=2.168 | acc=1.0000 | 4594.5 samples/s | 71.8 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.00626 | Reg=0.00000 | L2-Norm=20.289 | L2-Norm(final)=2.170 | acc=1.0000 | 4564.2 samples/s | 71.3 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.00606 | Reg=0.00000 | L2-Norm=20.305 | L2-Norm(final)=2.172 | acc=0.9844 | 4649.0 samples/s | 72.6 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.00605 | Reg=0.00000 | L2-Norm=20.321 | L2-Norm(final)=2.173 | acc=1.0000 | 1933.2 samples/s | 30.2 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.00559 | Reg=0.00000 | L2-Norm=20.339 | L2-Norm(final)=2.174 | acc=1.0000 | 4628.2 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1800.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55299 | acc=0.5574 | tpr=0.3691 | fpr=0.0337 | 4314.0 samples/s | 16.9 steps/s
Avg test loss: 0.55664, Avg test acc: 0.55613, Avg tpr: 0.36900, Avg fpr: 0.03230, total FA: 252

Testing server on iccad2012
[Step=  50] | Loss=0.17655 | acc=0.8600 | tpr=0.9735 | fpr=0.1420 | 4341.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.17916 | acc=0.8625 | tpr=0.9808 | fpr=0.1397 | 8870.7 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.18086 | acc=0.8614 | tpr=0.9813 | fpr=0.1408 | 8001.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.18118 | acc=0.8620 | tpr=0.9781 | fpr=0.1401 | 8355.8 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.18080 | acc=0.8610 | tpr=0.9764 | fpr=0.1411 | 8177.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.18115 | acc=0.8615 | tpr=0.9724 | fpr=0.1406 | 8109.2 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.18209 | acc=0.8607 | tpr=0.9731 | fpr=0.1413 | 8280.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.18254 | acc=0.8607 | tpr=0.9716 | fpr=0.1414 | 8083.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.18301 | acc=0.8611 | tpr=0.9708 | fpr=0.1409 | 8196.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.18285 | acc=0.8609 | tpr=0.9718 | fpr=0.1411 | 7962.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.18190 | acc=0.8619 | tpr=0.9721 | fpr=0.1401 | 15104.3 samples/s | 59.0 steps/s
Avg test loss: 0.18179, Avg test acc: 0.86195, Avg tpr: 0.97227, Avg fpr: 0.14006, total FA: 19447

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1801 Epoch= 1.8] | Loss=0.47847 | Reg=0.00000 | L2-Norm=20.428 | L2-Norm(final)=2.184 | acc=0.6094 | 3959.7 samples/s | 61.9 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.12731 | Reg=0.00000 | L2-Norm=20.525 | L2-Norm(final)=2.160 | acc=0.9219 | 4306.9 samples/s | 67.3 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.10479 | Reg=0.00000 | L2-Norm=20.584 | L2-Norm(final)=2.167 | acc=0.8906 | 4736.8 samples/s | 74.0 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.09404 | Reg=0.00000 | L2-Norm=20.626 | L2-Norm(final)=2.171 | acc=0.8906 | 4714.0 samples/s | 73.7 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.08737 | Reg=0.00000 | L2-Norm=20.663 | L2-Norm(final)=2.177 | acc=0.9688 | 4775.8 samples/s | 74.6 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.08252 | Reg=0.00000 | L2-Norm=20.699 | L2-Norm(final)=2.182 | acc=0.9531 | 4783.0 samples/s | 74.7 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07947 | Reg=0.00000 | L2-Norm=20.734 | L2-Norm(final)=2.187 | acc=0.9531 | 4847.1 samples/s | 75.7 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07764 | Reg=0.00000 | L2-Norm=20.768 | L2-Norm(final)=2.191 | acc=0.9844 | 4843.8 samples/s | 75.7 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07605 | Reg=0.00000 | L2-Norm=20.803 | L2-Norm(final)=2.195 | acc=0.9219 | 4710.9 samples/s | 73.6 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07502 | Reg=0.00000 | L2-Norm=20.836 | L2-Norm(final)=2.196 | acc=0.9375 | 4803.3 samples/s | 75.1 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07427 | Reg=0.00000 | L2-Norm=20.868 | L2-Norm(final)=2.197 | acc=1.0000 | 4739.1 samples/s | 74.0 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07321 | Reg=0.00000 | L2-Norm=20.900 | L2-Norm(final)=2.198 | acc=0.9688 | 4875.5 samples/s | 76.2 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07230 | Reg=0.00000 | L2-Norm=20.931 | L2-Norm(final)=2.199 | acc=0.9688 | 4782.9 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1801 Epoch= 3.4] | Loss=0.08504 | Reg=0.00000 | L2-Norm=20.428 | L2-Norm(final)=2.187 | acc=0.9531 | 3580.2 samples/s | 55.9 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01542 | Reg=0.00000 | L2-Norm=20.551 | L2-Norm(final)=2.206 | acc=0.9844 | 4075.0 samples/s | 63.7 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00959 | Reg=0.00000 | L2-Norm=20.612 | L2-Norm(final)=2.212 | acc=0.9688 | 4466.4 samples/s | 69.8 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00880 | Reg=0.00000 | L2-Norm=20.650 | L2-Norm(final)=2.213 | acc=1.0000 | 4446.7 samples/s | 69.5 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00806 | Reg=0.00000 | L2-Norm=20.679 | L2-Norm(final)=2.213 | acc=1.0000 | 4458.9 samples/s | 69.7 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00707 | Reg=0.00000 | L2-Norm=20.706 | L2-Norm(final)=2.213 | acc=1.0000 | 4355.7 samples/s | 68.1 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00609 | Reg=0.00000 | L2-Norm=20.729 | L2-Norm(final)=2.215 | acc=1.0000 | 4414.0 samples/s | 69.0 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00534 | Reg=0.00000 | L2-Norm=20.747 | L2-Norm(final)=2.218 | acc=1.0000 | 4431.5 samples/s | 69.2 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00489 | Reg=0.00000 | L2-Norm=20.764 | L2-Norm(final)=2.221 | acc=1.0000 | 4370.2 samples/s | 68.3 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00439 | Reg=0.00000 | L2-Norm=20.778 | L2-Norm(final)=2.224 | acc=1.0000 | 4407.2 samples/s | 68.9 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00410 | Reg=0.00000 | L2-Norm=20.791 | L2-Norm(final)=2.226 | acc=1.0000 | 4436.9 samples/s | 69.3 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00388 | Reg=0.00000 | L2-Norm=20.803 | L2-Norm(final)=2.229 | acc=1.0000 | 1882.2 samples/s | 29.4 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00395 | Reg=0.00000 | L2-Norm=20.816 | L2-Norm(final)=2.230 | acc=0.9688 | 4468.3 samples/s | 69.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.59141 | acc=0.5604 | tpr=0.3682 | fpr=0.0223 | 4169.9 samples/s | 16.3 steps/s
Avg test loss: 0.59557, Avg test acc: 0.55770, Avg tpr: 0.36656, Avg fpr: 0.02192, total FA: 171

Testing server on iccad2012
[Step=  50] | Loss=0.13456 | acc=0.9063 | tpr=0.9513 | fpr=0.0945 | 4124.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13771 | acc=0.9046 | tpr=0.9552 | fpr=0.0963 | 8287.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.13935 | acc=0.9037 | tpr=0.9625 | fpr=0.0974 | 8126.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.14115 | acc=0.9031 | tpr=0.9585 | fpr=0.0979 | 8157.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.14022 | acc=0.9034 | tpr=0.9590 | fpr=0.0977 | 7947.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.14120 | acc=0.9034 | tpr=0.9578 | fpr=0.0976 | 8093.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9025 | tpr=0.9606 | fpr=0.0986 | 8190.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.14233 | acc=0.9022 | tpr=0.9601 | fpr=0.0989 | 8113.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.14309 | acc=0.9019 | tpr=0.9581 | fpr=0.0992 | 8038.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.14275 | acc=0.9019 | tpr=0.9599 | fpr=0.0991 | 8149.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.14209 | acc=0.9023 | tpr=0.9586 | fpr=0.0987 | 14309.8 samples/s | 55.9 steps/s
Avg test loss: 0.14197, Avg test acc: 0.90229, Avg tpr: 0.95880, Avg fpr: 0.09874, total FA: 13710

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.45962 | Reg=0.00000 | L2-Norm=20.884 | L2-Norm(final)=2.213 | acc=0.6719 | 4027.5 samples/s | 62.9 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.11823 | Reg=0.00000 | L2-Norm=20.983 | L2-Norm(final)=2.191 | acc=0.9219 | 4269.9 samples/s | 66.7 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09246 | Reg=0.00000 | L2-Norm=21.043 | L2-Norm(final)=2.202 | acc=0.8906 | 4745.2 samples/s | 74.1 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.08520 | Reg=0.00000 | L2-Norm=21.090 | L2-Norm(final)=2.208 | acc=0.9219 | 4806.1 samples/s | 75.1 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07945 | Reg=0.00000 | L2-Norm=21.131 | L2-Norm(final)=2.213 | acc=0.9219 | 4669.7 samples/s | 73.0 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07662 | Reg=0.00000 | L2-Norm=21.168 | L2-Norm(final)=2.215 | acc=0.9844 | 4711.8 samples/s | 73.6 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07314 | Reg=0.00000 | L2-Norm=21.204 | L2-Norm(final)=2.218 | acc=0.9688 | 4709.4 samples/s | 73.6 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.07148 | Reg=0.00000 | L2-Norm=21.239 | L2-Norm(final)=2.221 | acc=0.9375 | 4770.1 samples/s | 74.5 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06989 | Reg=0.00000 | L2-Norm=21.272 | L2-Norm(final)=2.224 | acc=0.9219 | 4647.6 samples/s | 72.6 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06798 | Reg=0.00000 | L2-Norm=21.303 | L2-Norm(final)=2.225 | acc=1.0000 | 4653.6 samples/s | 72.7 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06760 | Reg=0.00000 | L2-Norm=21.334 | L2-Norm(final)=2.226 | acc=0.9688 | 4765.1 samples/s | 74.5 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06609 | Reg=0.00000 | L2-Norm=21.363 | L2-Norm(final)=2.227 | acc=1.0000 | 4720.8 samples/s | 73.8 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06512 | Reg=0.00000 | L2-Norm=21.393 | L2-Norm(final)=2.228 | acc=0.9688 | 4698.0 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.06307 | Reg=0.00000 | L2-Norm=20.884 | L2-Norm(final)=2.215 | acc=0.9531 | 3837.5 samples/s | 60.0 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01412 | Reg=0.00000 | L2-Norm=21.026 | L2-Norm(final)=2.228 | acc=0.9531 | 4050.3 samples/s | 63.3 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01284 | Reg=0.00000 | L2-Norm=21.099 | L2-Norm(final)=2.217 | acc=1.0000 | 4452.5 samples/s | 69.6 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00949 | Reg=0.00000 | L2-Norm=21.144 | L2-Norm(final)=2.213 | acc=1.0000 | 4506.6 samples/s | 70.4 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00861 | Reg=0.00000 | L2-Norm=21.175 | L2-Norm(final)=2.212 | acc=1.0000 | 4480.6 samples/s | 70.0 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00781 | Reg=0.00000 | L2-Norm=21.207 | L2-Norm(final)=2.210 | acc=1.0000 | 4484.1 samples/s | 70.1 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00737 | Reg=0.00000 | L2-Norm=21.232 | L2-Norm(final)=2.209 | acc=1.0000 | 4451.9 samples/s | 69.6 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00663 | Reg=0.00000 | L2-Norm=21.254 | L2-Norm(final)=2.207 | acc=1.0000 | 4502.5 samples/s | 70.4 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00593 | Reg=0.00000 | L2-Norm=21.273 | L2-Norm(final)=2.207 | acc=1.0000 | 4471.6 samples/s | 69.9 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00541 | Reg=0.00000 | L2-Norm=21.289 | L2-Norm(final)=2.207 | acc=1.0000 | 4515.0 samples/s | 70.5 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00491 | Reg=0.00000 | L2-Norm=21.304 | L2-Norm(final)=2.208 | acc=1.0000 | 4570.1 samples/s | 71.4 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00468 | Reg=0.00000 | L2-Norm=21.318 | L2-Norm(final)=2.210 | acc=0.9844 | 1851.9 samples/s | 28.9 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00440 | Reg=0.00000 | L2-Norm=21.332 | L2-Norm(final)=2.210 | acc=1.0000 | 4517.3 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3000.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.67671 | acc=0.5518 | tpr=0.3514 | fpr=0.0131 | 4108.1 samples/s | 16.0 steps/s
Avg test loss: 0.68179, Avg test acc: 0.55125, Avg tpr: 0.35286, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.15924 | acc=0.8996 | tpr=0.9558 | fpr=0.1014 | 4114.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.16587 | acc=0.8993 | tpr=0.9574 | fpr=0.1018 | 8194.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.16836 | acc=0.8983 | tpr=0.9568 | fpr=0.1028 | 8205.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.17022 | acc=0.8977 | tpr=0.9574 | fpr=0.1034 | 8062.1 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.16940 | acc=0.8980 | tpr=0.9590 | fpr=0.1032 | 7906.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.17030 | acc=0.8987 | tpr=0.9600 | fpr=0.1024 | 8161.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.17134 | acc=0.8982 | tpr=0.9624 | fpr=0.1030 | 8907.0 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.17196 | acc=0.8981 | tpr=0.9584 | fpr=0.1030 | 7503.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.17323 | acc=0.8978 | tpr=0.9581 | fpr=0.1033 | 8034.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.17289 | acc=0.8979 | tpr=0.9608 | fpr=0.1033 | 7922.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.17197 | acc=0.8984 | tpr=0.9610 | fpr=0.1028 | 14648.1 samples/s | 57.2 steps/s
Avg test loss: 0.17180, Avg test acc: 0.89840, Avg tpr: 0.96117, Avg fpr: 0.10274, total FA: 14265

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3001 Epoch= 2.9] | Loss=0.56586 | Reg=0.00000 | L2-Norm=21.357 | L2-Norm(final)=2.218 | acc=0.6562 | 3650.7 samples/s | 57.0 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.11830 | Reg=0.00000 | L2-Norm=21.493 | L2-Norm(final)=2.185 | acc=0.9844 | 4500.5 samples/s | 70.3 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.08952 | Reg=0.00000 | L2-Norm=21.569 | L2-Norm(final)=2.200 | acc=0.9531 | 4645.4 samples/s | 72.6 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.08075 | Reg=0.00000 | L2-Norm=21.617 | L2-Norm(final)=2.207 | acc=0.9688 | 4744.3 samples/s | 74.1 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.07611 | Reg=0.00000 | L2-Norm=21.655 | L2-Norm(final)=2.212 | acc=0.9375 | 4700.2 samples/s | 73.4 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.07024 | Reg=0.00000 | L2-Norm=21.691 | L2-Norm(final)=2.216 | acc=0.9844 | 4757.2 samples/s | 74.3 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.06786 | Reg=0.00000 | L2-Norm=21.723 | L2-Norm(final)=2.218 | acc=0.9531 | 4749.5 samples/s | 74.2 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.06557 | Reg=0.00000 | L2-Norm=21.754 | L2-Norm(final)=2.220 | acc=0.9688 | 4730.3 samples/s | 73.9 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.06300 | Reg=0.00000 | L2-Norm=21.784 | L2-Norm(final)=2.222 | acc=0.9688 | 4725.3 samples/s | 73.8 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06187 | Reg=0.00000 | L2-Norm=21.814 | L2-Norm(final)=2.223 | acc=1.0000 | 4696.2 samples/s | 73.4 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06239 | Reg=0.00000 | L2-Norm=21.843 | L2-Norm(final)=2.224 | acc=0.9531 | 4684.4 samples/s | 73.2 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06032 | Reg=0.00000 | L2-Norm=21.871 | L2-Norm(final)=2.224 | acc=0.9844 | 4762.0 samples/s | 74.4 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.05955 | Reg=0.00000 | L2-Norm=21.901 | L2-Norm(final)=2.226 | acc=0.9375 | 4644.6 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3001 Epoch= 5.7] | Loss=0.02734 | Reg=0.00000 | L2-Norm=21.357 | L2-Norm(final)=2.223 | acc=0.9844 | 3614.0 samples/s | 56.5 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00656 | Reg=0.00000 | L2-Norm=21.432 | L2-Norm(final)=2.245 | acc=1.0000 | 4125.6 samples/s | 64.5 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00423 | Reg=0.00000 | L2-Norm=21.468 | L2-Norm(final)=2.251 | acc=1.0000 | 4518.6 samples/s | 70.6 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00438 | Reg=0.00000 | L2-Norm=21.497 | L2-Norm(final)=2.255 | acc=1.0000 | 4447.9 samples/s | 69.5 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00558 | Reg=0.00000 | L2-Norm=21.534 | L2-Norm(final)=2.253 | acc=1.0000 | 4520.4 samples/s | 70.6 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00557 | Reg=0.00000 | L2-Norm=21.572 | L2-Norm(final)=2.250 | acc=1.0000 | 4471.1 samples/s | 69.9 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00507 | Reg=0.00000 | L2-Norm=21.606 | L2-Norm(final)=2.246 | acc=1.0000 | 4488.2 samples/s | 70.1 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00490 | Reg=0.00000 | L2-Norm=21.634 | L2-Norm(final)=2.244 | acc=0.9844 | 4483.8 samples/s | 70.1 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00500 | Reg=0.00000 | L2-Norm=21.662 | L2-Norm(final)=2.241 | acc=0.9688 | 4446.5 samples/s | 69.5 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00477 | Reg=0.00000 | L2-Norm=21.690 | L2-Norm(final)=2.238 | acc=1.0000 | 4520.3 samples/s | 70.6 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00439 | Reg=0.00000 | L2-Norm=21.715 | L2-Norm(final)=2.236 | acc=1.0000 | 4469.5 samples/s | 69.8 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00406 | Reg=0.00000 | L2-Norm=21.737 | L2-Norm(final)=2.235 | acc=1.0000 | 1925.8 samples/s | 30.1 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00393 | Reg=0.00000 | L2-Norm=21.756 | L2-Norm(final)=2.233 | acc=1.0000 | 4571.6 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3600.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44955 | acc=0.6421 | tpr=0.4945 | fpr=0.0374 | 4174.5 samples/s | 16.3 steps/s
Avg test loss: 0.45283, Avg test acc: 0.64044, Avg tpr: 0.49338, Avg fpr: 0.03615, total FA: 282

Testing server on iccad2012
[Step=  50] | Loss=0.16467 | acc=0.8949 | tpr=0.9646 | fpr=0.1063 | 4170.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.17134 | acc=0.8915 | tpr=0.9701 | fpr=0.1100 | 8082.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.17387 | acc=0.8908 | tpr=0.9769 | fpr=0.1108 | 8004.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.17657 | acc=0.8897 | tpr=0.9781 | fpr=0.1119 | 8167.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.17566 | acc=0.8899 | tpr=0.9773 | fpr=0.1117 | 7958.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.17671 | acc=0.8898 | tpr=0.9753 | fpr=0.1118 | 8476.6 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.17808 | acc=0.8889 | tpr=0.9750 | fpr=0.1126 | 7733.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.17811 | acc=0.8891 | tpr=0.9748 | fpr=0.1124 | 8098.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.17946 | acc=0.8890 | tpr=0.9737 | fpr=0.1125 | 8173.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17911 | acc=0.8891 | tpr=0.9749 | fpr=0.1125 | 7797.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.17850 | acc=0.8896 | tpr=0.9741 | fpr=0.1119 | 14554.4 samples/s | 56.9 steps/s
Avg test loss: 0.17833, Avg test acc: 0.88969, Avg tpr: 0.97425, Avg fpr: 0.11185, total FA: 15530

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3601 Epoch= 3.5] | Loss=0.30341 | Reg=0.00000 | L2-Norm=21.842 | L2-Norm(final)=2.216 | acc=0.7656 | 3641.0 samples/s | 56.9 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.08781 | Reg=0.00000 | L2-Norm=21.922 | L2-Norm(final)=2.208 | acc=0.9688 | 4620.1 samples/s | 72.2 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.07393 | Reg=0.00000 | L2-Norm=21.974 | L2-Norm(final)=2.217 | acc=0.8906 | 4769.5 samples/s | 74.5 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.06719 | Reg=0.00000 | L2-Norm=22.015 | L2-Norm(final)=2.224 | acc=0.9375 | 4731.5 samples/s | 73.9 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.06427 | Reg=0.00000 | L2-Norm=22.052 | L2-Norm(final)=2.228 | acc=0.9844 | 4714.6 samples/s | 73.7 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.06159 | Reg=0.00000 | L2-Norm=22.089 | L2-Norm(final)=2.231 | acc=0.9844 | 4754.8 samples/s | 74.3 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.06066 | Reg=0.00000 | L2-Norm=22.127 | L2-Norm(final)=2.234 | acc=0.9531 | 4764.5 samples/s | 74.4 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05951 | Reg=0.00000 | L2-Norm=22.163 | L2-Norm(final)=2.234 | acc=0.9844 | 4673.1 samples/s | 73.0 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05913 | Reg=0.00000 | L2-Norm=22.196 | L2-Norm(final)=2.234 | acc=0.9531 | 4788.7 samples/s | 74.8 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.05869 | Reg=0.00000 | L2-Norm=22.231 | L2-Norm(final)=2.235 | acc=0.9219 | 4675.5 samples/s | 73.1 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.05807 | Reg=0.00000 | L2-Norm=22.266 | L2-Norm(final)=2.235 | acc=0.9844 | 4699.6 samples/s | 73.4 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.05713 | Reg=0.00000 | L2-Norm=22.301 | L2-Norm(final)=2.235 | acc=1.0000 | 4662.0 samples/s | 72.8 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.05677 | Reg=0.00000 | L2-Norm=22.334 | L2-Norm(final)=2.234 | acc=0.9375 | 4671.8 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3601 Epoch= 6.8] | Loss=0.06182 | Reg=0.00000 | L2-Norm=21.842 | L2-Norm(final)=2.218 | acc=0.9531 | 3860.9 samples/s | 60.3 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00642 | Reg=0.00000 | L2-Norm=21.927 | L2-Norm(final)=2.237 | acc=1.0000 | 3297.7 samples/s | 51.5 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00680 | Reg=0.00000 | L2-Norm=21.966 | L2-Norm(final)=2.240 | acc=1.0000 | 3796.3 samples/s | 59.3 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00703 | Reg=0.00000 | L2-Norm=22.019 | L2-Norm(final)=2.235 | acc=1.0000 | 3787.9 samples/s | 59.2 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00585 | Reg=0.00000 | L2-Norm=22.067 | L2-Norm(final)=2.232 | acc=1.0000 | 3824.5 samples/s | 59.8 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00503 | Reg=0.00000 | L2-Norm=22.105 | L2-Norm(final)=2.233 | acc=1.0000 | 3800.4 samples/s | 59.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00473 | Reg=0.00000 | L2-Norm=22.138 | L2-Norm(final)=2.233 | acc=1.0000 | 4100.5 samples/s | 64.1 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00413 | Reg=0.00000 | L2-Norm=22.166 | L2-Norm(final)=2.233 | acc=1.0000 | 4434.3 samples/s | 69.3 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00383 | Reg=0.00000 | L2-Norm=22.189 | L2-Norm(final)=2.235 | acc=0.9844 | 4444.2 samples/s | 69.4 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00359 | Reg=0.00000 | L2-Norm=22.212 | L2-Norm(final)=2.237 | acc=1.0000 | 4376.3 samples/s | 68.4 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00362 | Reg=0.00000 | L2-Norm=22.233 | L2-Norm(final)=2.237 | acc=0.9844 | 4445.5 samples/s | 69.5 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00386 | Reg=0.00000 | L2-Norm=22.257 | L2-Norm(final)=2.236 | acc=1.0000 | 1835.2 samples/s | 28.7 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00362 | Reg=0.00000 | L2-Norm=22.281 | L2-Norm(final)=2.234 | acc=1.0000 | 4539.7 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4200.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41914 | acc=0.6684 | tpr=0.5354 | fpr=0.0426 | 4122.0 samples/s | 16.1 steps/s
Avg test loss: 0.42327, Avg test acc: 0.66864, Avg tpr: 0.53617, Avg fpr: 0.03999, total FA: 312

Testing server on iccad2012
[Step=  50] | Loss=0.21654 | acc=0.8608 | tpr=0.9823 | fpr=0.1414 | 4162.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.22410 | acc=0.8587 | tpr=0.9872 | fpr=0.1437 | 8232.2 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.22613 | acc=0.8591 | tpr=0.9899 | fpr=0.1433 | 8191.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.22741 | acc=0.8589 | tpr=0.9891 | fpr=0.1435 | 7905.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.22688 | acc=0.8583 | tpr=0.9886 | fpr=0.1440 | 8544.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.22813 | acc=0.8585 | tpr=0.9862 | fpr=0.1439 | 8192.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.22971 | acc=0.8572 | tpr=0.9862 | fpr=0.1452 | 7629.8 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.23022 | acc=0.8573 | tpr=0.9858 | fpr=0.1450 | 8004.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.23215 | acc=0.8567 | tpr=0.9854 | fpr=0.1456 | 8508.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.23215 | acc=0.8563 | tpr=0.9859 | fpr=0.1460 | 7815.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.23114 | acc=0.8570 | tpr=0.9849 | fpr=0.1453 | 14590.7 samples/s | 57.0 steps/s
Avg test loss: 0.23098, Avg test acc: 0.85708, Avg tpr: 0.98494, Avg fpr: 0.14525, total FA: 20167

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4201 Epoch= 4.1] | Loss=0.29997 | Reg=0.00000 | L2-Norm=22.367 | L2-Norm(final)=2.215 | acc=0.8438 | 3872.0 samples/s | 60.5 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.08559 | Reg=0.00000 | L2-Norm=22.488 | L2-Norm(final)=2.200 | acc=0.9375 | 4290.6 samples/s | 67.0 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06920 | Reg=0.00000 | L2-Norm=22.547 | L2-Norm(final)=2.211 | acc=0.9375 | 4723.8 samples/s | 73.8 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06086 | Reg=0.00000 | L2-Norm=22.587 | L2-Norm(final)=2.217 | acc=0.8906 | 4703.6 samples/s | 73.5 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05896 | Reg=0.00000 | L2-Norm=22.622 | L2-Norm(final)=2.221 | acc=0.9375 | 4717.8 samples/s | 73.7 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05693 | Reg=0.00000 | L2-Norm=22.655 | L2-Norm(final)=2.224 | acc=0.9844 | 4698.8 samples/s | 73.4 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05525 | Reg=0.00000 | L2-Norm=22.686 | L2-Norm(final)=2.227 | acc=0.9531 | 4723.1 samples/s | 73.8 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05329 | Reg=0.00000 | L2-Norm=22.717 | L2-Norm(final)=2.230 | acc=0.9375 | 4761.5 samples/s | 74.4 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05286 | Reg=0.00000 | L2-Norm=22.748 | L2-Norm(final)=2.231 | acc=0.9844 | 4742.9 samples/s | 74.1 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05212 | Reg=0.00000 | L2-Norm=22.778 | L2-Norm(final)=2.231 | acc=1.0000 | 4692.7 samples/s | 73.3 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05182 | Reg=0.00000 | L2-Norm=22.809 | L2-Norm(final)=2.232 | acc=0.8906 | 4726.2 samples/s | 73.8 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05133 | Reg=0.00000 | L2-Norm=22.839 | L2-Norm(final)=2.232 | acc=0.9219 | 4755.7 samples/s | 74.3 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05052 | Reg=0.00000 | L2-Norm=22.868 | L2-Norm(final)=2.233 | acc=0.9844 | 4753.3 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4201 Epoch= 7.9] | Loss=0.05398 | Reg=0.00000 | L2-Norm=22.367 | L2-Norm(final)=2.217 | acc=0.9531 | 3405.5 samples/s | 53.2 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00529 | Reg=0.00000 | L2-Norm=22.445 | L2-Norm(final)=2.246 | acc=1.0000 | 4563.3 samples/s | 71.3 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00337 | Reg=0.00000 | L2-Norm=22.473 | L2-Norm(final)=2.255 | acc=1.0000 | 4468.6 samples/s | 69.8 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00331 | Reg=0.00000 | L2-Norm=22.493 | L2-Norm(final)=2.257 | acc=1.0000 | 4420.7 samples/s | 69.1 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00307 | Reg=0.00000 | L2-Norm=22.511 | L2-Norm(final)=2.255 | acc=1.0000 | 4500.0 samples/s | 70.3 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00350 | Reg=0.00000 | L2-Norm=22.528 | L2-Norm(final)=2.255 | acc=1.0000 | 4506.9 samples/s | 70.4 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00313 | Reg=0.00000 | L2-Norm=22.549 | L2-Norm(final)=2.253 | acc=1.0000 | 4502.2 samples/s | 70.3 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00281 | Reg=0.00000 | L2-Norm=22.569 | L2-Norm(final)=2.254 | acc=1.0000 | 4552.5 samples/s | 71.1 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00251 | Reg=0.00000 | L2-Norm=22.586 | L2-Norm(final)=2.256 | acc=1.0000 | 4524.2 samples/s | 70.7 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00232 | Reg=0.00000 | L2-Norm=22.600 | L2-Norm(final)=2.259 | acc=1.0000 | 4428.9 samples/s | 69.2 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00230 | Reg=0.00000 | L2-Norm=22.614 | L2-Norm(final)=2.260 | acc=1.0000 | 4527.2 samples/s | 70.7 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00222 | Reg=0.00000 | L2-Norm=22.629 | L2-Norm(final)=2.261 | acc=1.0000 | 1876.5 samples/s | 29.3 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00210 | Reg=0.00000 | L2-Norm=22.644 | L2-Norm(final)=2.262 | acc=1.0000 | 4436.9 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44436 | acc=0.6899 | tpr=0.5580 | fpr=0.0235 | 4149.3 samples/s | 16.2 steps/s
Avg test loss: 0.44752, Avg test acc: 0.69092, Avg tpr: 0.55977, Avg fpr: 0.02064, total FA: 161

Testing server on iccad2012
[Step=  50] | Loss=0.22446 | acc=0.8681 | tpr=0.9735 | fpr=0.1338 | 4156.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.23217 | acc=0.8685 | tpr=0.9808 | fpr=0.1336 | 8086.0 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.23642 | acc=0.8682 | tpr=0.9827 | fpr=0.1340 | 8204.2 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.23940 | acc=0.8671 | tpr=0.9803 | fpr=0.1349 | 7797.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.23911 | acc=0.8672 | tpr=0.9834 | fpr=0.1350 | 8489.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.24017 | acc=0.8673 | tpr=0.9811 | fpr=0.1348 | 7587.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.24168 | acc=0.8662 | tpr=0.9818 | fpr=0.1359 | 8272.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.24208 | acc=0.8658 | tpr=0.9819 | fpr=0.1364 | 7963.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.24389 | acc=0.8654 | tpr=0.9815 | fpr=0.1367 | 8255.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.24352 | acc=0.8656 | tpr=0.9819 | fpr=0.1365 | 7770.3 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.24203 | acc=0.8666 | tpr=0.9813 | fpr=0.1355 | 14834.3 samples/s | 57.9 steps/s
Avg test loss: 0.24181, Avg test acc: 0.86661, Avg tpr: 0.98138, Avg fpr: 0.13548, total FA: 18811

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.36067 | Reg=0.00000 | L2-Norm=22.787 | L2-Norm(final)=2.248 | acc=0.7500 | 3640.7 samples/s | 56.9 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.07074 | Reg=0.00000 | L2-Norm=22.879 | L2-Norm(final)=2.232 | acc=0.9844 | 4434.6 samples/s | 69.3 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06458 | Reg=0.00000 | L2-Norm=22.931 | L2-Norm(final)=2.236 | acc=0.9844 | 4693.2 samples/s | 73.3 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.05775 | Reg=0.00000 | L2-Norm=22.972 | L2-Norm(final)=2.241 | acc=0.9844 | 4697.7 samples/s | 73.4 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05389 | Reg=0.00000 | L2-Norm=23.013 | L2-Norm(final)=2.247 | acc=0.9531 | 4748.4 samples/s | 74.2 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05310 | Reg=0.00000 | L2-Norm=23.053 | L2-Norm(final)=2.248 | acc=0.9688 | 4767.4 samples/s | 74.5 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05249 | Reg=0.00000 | L2-Norm=23.092 | L2-Norm(final)=2.249 | acc=0.9688 | 4721.9 samples/s | 73.8 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05170 | Reg=0.00000 | L2-Norm=23.126 | L2-Norm(final)=2.249 | acc=0.9531 | 4743.7 samples/s | 74.1 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05067 | Reg=0.00000 | L2-Norm=23.158 | L2-Norm(final)=2.249 | acc=0.9844 | 4720.2 samples/s | 73.8 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.04983 | Reg=0.00000 | L2-Norm=23.190 | L2-Norm(final)=2.249 | acc=1.0000 | 4745.4 samples/s | 74.1 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.04888 | Reg=0.00000 | L2-Norm=23.220 | L2-Norm(final)=2.250 | acc=0.9688 | 4741.4 samples/s | 74.1 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.04857 | Reg=0.00000 | L2-Norm=23.249 | L2-Norm(final)=2.250 | acc=0.9219 | 4698.6 samples/s | 73.4 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.04761 | Reg=0.00000 | L2-Norm=23.279 | L2-Norm(final)=2.252 | acc=0.9375 | 4722.4 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.04512 | Reg=0.00000 | L2-Norm=22.787 | L2-Norm(final)=2.250 | acc=0.9531 | 3921.5 samples/s | 61.3 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00381 | Reg=0.00000 | L2-Norm=22.865 | L2-Norm(final)=2.264 | acc=1.0000 | 3942.9 samples/s | 61.6 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00274 | Reg=0.00000 | L2-Norm=22.901 | L2-Norm(final)=2.270 | acc=1.0000 | 4448.9 samples/s | 69.5 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00222 | Reg=0.00000 | L2-Norm=22.931 | L2-Norm(final)=2.274 | acc=1.0000 | 4434.6 samples/s | 69.3 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00233 | Reg=0.00000 | L2-Norm=22.954 | L2-Norm(final)=2.277 | acc=1.0000 | 4461.2 samples/s | 69.7 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00244 | Reg=0.00000 | L2-Norm=22.977 | L2-Norm(final)=2.278 | acc=0.9844 | 4551.9 samples/s | 71.1 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00221 | Reg=0.00000 | L2-Norm=22.996 | L2-Norm(final)=2.279 | acc=1.0000 | 4428.0 samples/s | 69.2 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00198 | Reg=0.00000 | L2-Norm=23.012 | L2-Norm(final)=2.280 | acc=1.0000 | 4540.7 samples/s | 70.9 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00193 | Reg=0.00000 | L2-Norm=23.029 | L2-Norm(final)=2.281 | acc=1.0000 | 4424.9 samples/s | 69.1 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00190 | Reg=0.00000 | L2-Norm=23.045 | L2-Norm(final)=2.283 | acc=1.0000 | 4475.2 samples/s | 69.9 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00184 | Reg=0.00000 | L2-Norm=23.063 | L2-Norm(final)=2.284 | acc=1.0000 | 4568.7 samples/s | 71.4 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00202 | Reg=0.00000 | L2-Norm=23.080 | L2-Norm(final)=2.285 | acc=1.0000 | 1879.4 samples/s | 29.4 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00192 | Reg=0.00000 | L2-Norm=23.100 | L2-Norm(final)=2.285 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5400.h5
Adjusting learning rate of group 0 to 1.0000e-03.
Adjusting learning rate of group 0 to 1.0000e-03.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40854 | acc=0.6867 | tpr=0.5524 | fpr=0.0216 | 4113.1 samples/s | 16.1 steps/s
Avg test loss: 0.41276, Avg test acc: 0.68567, Avg tpr: 0.55249, Avg fpr: 0.02141, total FA: 167

Testing server on iccad2012
[Step=  50] | Loss=0.25186 | acc=0.8685 | tpr=0.9690 | fpr=0.1333 | 4164.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.26106 | acc=0.8652 | tpr=0.9808 | fpr=0.1370 | 8227.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.26550 | acc=0.8652 | tpr=0.9856 | fpr=0.1370 | 7930.2 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.26856 | acc=0.8647 | tpr=0.9825 | fpr=0.1374 | 8568.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.26837 | acc=0.8640 | tpr=0.9852 | fpr=0.1382 | 7942.6 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.27146 | acc=0.8629 | tpr=0.9833 | fpr=0.1393 | 7931.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.27292 | acc=0.8619 | tpr=0.9831 | fpr=0.1403 | 7776.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.27305 | acc=0.8618 | tpr=0.9819 | fpr=0.1404 | 8377.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.27548 | acc=0.8614 | tpr=0.9810 | fpr=0.1407 | 7792.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.27524 | acc=0.8614 | tpr=0.9811 | fpr=0.1407 | 7882.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.27386 | acc=0.8618 | tpr=0.9793 | fpr=0.1404 | 15058.8 samples/s | 58.8 steps/s
Avg test loss: 0.27354, Avg test acc: 0.86183, Avg tpr: 0.97940, Avg fpr: 0.14031, total FA: 19482

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5401 Epoch= 5.3] | Loss=0.34219 | Reg=0.00000 | L2-Norm=23.231 | L2-Norm(final)=2.262 | acc=0.7188 | 3717.6 samples/s | 58.1 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.07474 | Reg=0.00000 | L2-Norm=23.335 | L2-Norm(final)=2.248 | acc=0.9844 | 4534.9 samples/s | 70.9 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.05957 | Reg=0.00000 | L2-Norm=23.394 | L2-Norm(final)=2.260 | acc=0.9688 | 4694.4 samples/s | 73.3 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.05418 | Reg=0.00000 | L2-Norm=23.436 | L2-Norm(final)=2.267 | acc=0.9531 | 4734.2 samples/s | 74.0 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.05345 | Reg=0.00000 | L2-Norm=23.475 | L2-Norm(final)=2.268 | acc=0.9531 | 4733.2 samples/s | 74.0 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.05281 | Reg=0.00000 | L2-Norm=23.512 | L2-Norm(final)=2.268 | acc=1.0000 | 4648.3 samples/s | 72.6 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05089 | Reg=0.00000 | L2-Norm=23.546 | L2-Norm(final)=2.268 | acc=1.0000 | 4721.4 samples/s | 73.8 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.04980 | Reg=0.00000 | L2-Norm=23.577 | L2-Norm(final)=2.269 | acc=1.0000 | 4778.7 samples/s | 74.7 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.04870 | Reg=0.00000 | L2-Norm=23.610 | L2-Norm(final)=2.271 | acc=0.9531 | 4730.2 samples/s | 73.9 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.04805 | Reg=0.00000 | L2-Norm=23.643 | L2-Norm(final)=2.273 | acc=0.9844 | 4753.6 samples/s | 74.3 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.04741 | Reg=0.00000 | L2-Norm=23.678 | L2-Norm(final)=2.274 | acc=0.9531 | 4772.0 samples/s | 74.6 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04744 | Reg=0.00000 | L2-Norm=23.711 | L2-Norm(final)=2.274 | acc=0.9531 | 4694.6 samples/s | 73.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04676 | Reg=0.00000 | L2-Norm=23.745 | L2-Norm(final)=2.274 | acc=1.0000 | 4727.5 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5401 Epoch=10.2] | Loss=0.02807 | Reg=0.00000 | L2-Norm=23.231 | L2-Norm(final)=2.265 | acc=0.9844 | 3460.0 samples/s | 54.1 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00453 | Reg=0.00000 | L2-Norm=23.316 | L2-Norm(final)=2.287 | acc=1.0000 | 4215.9 samples/s | 65.9 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00294 | Reg=0.00000 | L2-Norm=23.356 | L2-Norm(final)=2.295 | acc=1.0000 | 4387.7 samples/s | 68.6 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00398 | Reg=0.00000 | L2-Norm=23.388 | L2-Norm(final)=2.296 | acc=1.0000 | 4400.5 samples/s | 68.8 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00341 | Reg=0.00000 | L2-Norm=23.426 | L2-Norm(final)=2.297 | acc=1.0000 | 4509.4 samples/s | 70.5 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00291 | Reg=0.00000 | L2-Norm=23.456 | L2-Norm(final)=2.298 | acc=1.0000 | 4474.1 samples/s | 69.9 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00286 | Reg=0.00000 | L2-Norm=23.482 | L2-Norm(final)=2.299 | acc=1.0000 | 4480.4 samples/s | 70.0 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00279 | Reg=0.00000 | L2-Norm=23.510 | L2-Norm(final)=2.300 | acc=0.9844 | 4491.6 samples/s | 70.2 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00287 | Reg=0.00000 | L2-Norm=23.537 | L2-Norm(final)=2.298 | acc=1.0000 | 4482.0 samples/s | 70.0 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00293 | Reg=0.00000 | L2-Norm=23.565 | L2-Norm(final)=2.296 | acc=1.0000 | 4488.5 samples/s | 70.1 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00283 | Reg=0.00000 | L2-Norm=23.594 | L2-Norm(final)=2.295 | acc=1.0000 | 4482.4 samples/s | 70.0 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00261 | Reg=0.00000 | L2-Norm=23.621 | L2-Norm(final)=2.295 | acc=1.0000 | 1866.9 samples/s | 29.2 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00240 | Reg=0.00000 | L2-Norm=23.644 | L2-Norm(final)=2.295 | acc=1.0000 | 4573.8 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6000.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52584 | acc=0.6645 | tpr=0.5160 | fpr=0.0129 | 4133.7 samples/s | 16.1 steps/s
Avg test loss: 0.53181, Avg test acc: 0.66215, Avg tpr: 0.51349, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.22193 | acc=0.8868 | tpr=0.9646 | fpr=0.1146 | 4136.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.22862 | acc=0.8854 | tpr=0.9744 | fpr=0.1162 | 8106.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.23256 | acc=0.8840 | tpr=0.9784 | fpr=0.1178 | 7976.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.23489 | acc=0.8836 | tpr=0.9738 | fpr=0.1180 | 8088.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.23342 | acc=0.8834 | tpr=0.9764 | fpr=0.1183 | 7986.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.23542 | acc=0.8830 | tpr=0.9760 | fpr=0.1187 | 8152.7 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.23713 | acc=0.8821 | tpr=0.9762 | fpr=0.1196 | 8384.0 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.23779 | acc=0.8820 | tpr=0.9737 | fpr=0.1197 | 8025.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.24034 | acc=0.8812 | tpr=0.9727 | fpr=0.1204 | 7988.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.23972 | acc=0.8815 | tpr=0.9740 | fpr=0.1201 | 7956.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.23834 | acc=0.8820 | tpr=0.9729 | fpr=0.1196 | 15002.4 samples/s | 58.6 steps/s
Avg test loss: 0.23801, Avg test acc: 0.88218, Avg tpr: 0.97306, Avg fpr: 0.11947, total FA: 16588

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=6001 Epoch= 5.9] | Loss=0.42130 | Reg=0.00000 | L2-Norm=23.754 | L2-Norm(final)=2.274 | acc=0.7031 | 3871.4 samples/s | 60.5 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.08191 | Reg=0.00000 | L2-Norm=23.843 | L2-Norm(final)=2.253 | acc=0.9688 | 4225.6 samples/s | 66.0 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.05892 | Reg=0.00000 | L2-Norm=23.884 | L2-Norm(final)=2.261 | acc=0.9844 | 4709.1 samples/s | 73.6 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.05159 | Reg=0.00000 | L2-Norm=23.910 | L2-Norm(final)=2.268 | acc=0.9688 | 4721.5 samples/s | 73.8 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04747 | Reg=0.00000 | L2-Norm=23.932 | L2-Norm(final)=2.276 | acc=0.9844 | 4678.7 samples/s | 73.1 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04608 | Reg=0.00000 | L2-Norm=23.952 | L2-Norm(final)=2.281 | acc=0.9375 | 4724.1 samples/s | 73.8 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04428 | Reg=0.00000 | L2-Norm=23.972 | L2-Norm(final)=2.284 | acc=0.9688 | 4706.8 samples/s | 73.5 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04352 | Reg=0.00000 | L2-Norm=23.991 | L2-Norm(final)=2.287 | acc=0.9688 | 4753.5 samples/s | 74.3 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04175 | Reg=0.00000 | L2-Norm=24.009 | L2-Norm(final)=2.289 | acc=0.9844 | 4785.6 samples/s | 74.8 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.04124 | Reg=0.00000 | L2-Norm=24.027 | L2-Norm(final)=2.290 | acc=0.9844 | 4707.7 samples/s | 73.6 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.04036 | Reg=0.00000 | L2-Norm=24.045 | L2-Norm(final)=2.292 | acc=1.0000 | 4696.4 samples/s | 73.4 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.03987 | Reg=0.00000 | L2-Norm=24.064 | L2-Norm(final)=2.294 | acc=1.0000 | 4694.4 samples/s | 73.4 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.03932 | Reg=0.00000 | L2-Norm=24.083 | L2-Norm(final)=2.296 | acc=0.9844 | 4736.4 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=6001 Epoch=11.3] | Loss=0.04562 | Reg=0.00000 | L2-Norm=23.754 | L2-Norm(final)=2.275 | acc=0.9688 | 3304.5 samples/s | 51.6 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00549 | Reg=0.00000 | L2-Norm=23.815 | L2-Norm(final)=2.278 | acc=1.0000 | 4530.2 samples/s | 70.8 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00313 | Reg=0.00000 | L2-Norm=23.834 | L2-Norm(final)=2.283 | acc=1.0000 | 4478.2 samples/s | 70.0 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00211 | Reg=0.00000 | L2-Norm=23.843 | L2-Norm(final)=2.288 | acc=1.0000 | 4464.3 samples/s | 69.8 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00160 | Reg=0.00000 | L2-Norm=23.848 | L2-Norm(final)=2.291 | acc=1.0000 | 4504.4 samples/s | 70.4 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00131 | Reg=0.00000 | L2-Norm=23.852 | L2-Norm(final)=2.294 | acc=1.0000 | 4500.3 samples/s | 70.3 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00110 | Reg=0.00000 | L2-Norm=23.855 | L2-Norm(final)=2.296 | acc=1.0000 | 4419.1 samples/s | 69.0 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00096 | Reg=0.00000 | L2-Norm=23.858 | L2-Norm(final)=2.298 | acc=1.0000 | 4484.7 samples/s | 70.1 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00084 | Reg=0.00000 | L2-Norm=23.860 | L2-Norm(final)=2.301 | acc=1.0000 | 4464.2 samples/s | 69.8 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00075 | Reg=0.00000 | L2-Norm=23.862 | L2-Norm(final)=2.302 | acc=1.0000 | 4500.7 samples/s | 70.3 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00068 | Reg=0.00000 | L2-Norm=23.864 | L2-Norm(final)=2.304 | acc=1.0000 | 4511.8 samples/s | 70.5 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00062 | Reg=0.00000 | L2-Norm=23.865 | L2-Norm(final)=2.306 | acc=1.0000 | 1895.2 samples/s | 29.6 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00057 | Reg=0.00000 | L2-Norm=23.867 | L2-Norm(final)=2.307 | acc=1.0000 | 4479.7 samples/s | 70.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6600.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32766 | acc=0.7806 | tpr=0.6885 | fpr=0.0193 | 4127.7 samples/s | 16.1 steps/s
Avg test loss: 0.33061, Avg test acc: 0.78067, Avg tpr: 0.68957, Avg fpr: 0.01897, total FA: 148

Testing server on iccad2012
[Step=  50] | Loss=0.26637 | acc=0.8786 | tpr=0.9735 | fpr=0.1231 | 4184.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.27695 | acc=0.8763 | tpr=0.9851 | fpr=0.1257 | 8055.6 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.28208 | acc=0.8757 | tpr=0.9856 | fpr=0.1264 | 7891.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.28623 | acc=0.8746 | tpr=0.9825 | fpr=0.1273 | 7944.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.28432 | acc=0.8745 | tpr=0.9825 | fpr=0.1275 | 8174.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.28622 | acc=0.8747 | tpr=0.9804 | fpr=0.1272 | 8179.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.28850 | acc=0.8736 | tpr=0.9800 | fpr=0.1283 | 7821.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.28828 | acc=0.8739 | tpr=0.9781 | fpr=0.1280 | 8236.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.29124 | acc=0.8732 | tpr=0.9771 | fpr=0.1287 | 8029.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.29038 | acc=0.8734 | tpr=0.9784 | fpr=0.1285 | 7971.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.28892 | acc=0.8738 | tpr=0.9769 | fpr=0.1281 | 14781.8 samples/s | 57.7 steps/s
Avg test loss: 0.28850, Avg test acc: 0.87390, Avg tpr: 0.97702, Avg fpr: 0.12797, total FA: 17769

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=6601 Epoch= 6.4] | Loss=0.23604 | Reg=0.00000 | L2-Norm=23.972 | L2-Norm(final)=2.306 | acc=0.8438 | 3616.6 samples/s | 56.5 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05456 | Reg=0.00000 | L2-Norm=24.039 | L2-Norm(final)=2.294 | acc=0.9844 | 4540.3 samples/s | 70.9 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04152 | Reg=0.00000 | L2-Norm=24.074 | L2-Norm(final)=2.302 | acc=0.9375 | 4748.0 samples/s | 74.2 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.03793 | Reg=0.00000 | L2-Norm=24.097 | L2-Norm(final)=2.311 | acc=1.0000 | 4673.1 samples/s | 73.0 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.03748 | Reg=0.00000 | L2-Norm=24.115 | L2-Norm(final)=2.311 | acc=0.9844 | 4679.9 samples/s | 73.1 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.03620 | Reg=0.00000 | L2-Norm=24.133 | L2-Norm(final)=2.313 | acc=0.9844 | 4705.2 samples/s | 73.5 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.03545 | Reg=0.00000 | L2-Norm=24.149 | L2-Norm(final)=2.313 | acc=0.9844 | 4663.4 samples/s | 72.9 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.03466 | Reg=0.00000 | L2-Norm=24.167 | L2-Norm(final)=2.315 | acc=0.9531 | 4721.4 samples/s | 73.8 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.03405 | Reg=0.00000 | L2-Norm=24.185 | L2-Norm(final)=2.317 | acc=0.9844 | 4707.9 samples/s | 73.6 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.03451 | Reg=0.00000 | L2-Norm=24.204 | L2-Norm(final)=2.318 | acc=0.9219 | 4697.1 samples/s | 73.4 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.03477 | Reg=0.00000 | L2-Norm=24.223 | L2-Norm(final)=2.319 | acc=0.9375 | 4704.8 samples/s | 73.5 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.03473 | Reg=0.00000 | L2-Norm=24.241 | L2-Norm(final)=2.318 | acc=0.9531 | 4754.2 samples/s | 74.3 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.03470 | Reg=0.00000 | L2-Norm=24.260 | L2-Norm(final)=2.319 | acc=0.9844 | 4644.2 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=6601 Epoch=12.4] | Loss=0.05436 | Reg=0.00000 | L2-Norm=23.972 | L2-Norm(final)=2.307 | acc=0.9844 | 3608.9 samples/s | 56.4 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00710 | Reg=0.00000 | L2-Norm=24.061 | L2-Norm(final)=2.306 | acc=1.0000 | 4149.9 samples/s | 64.8 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00448 | Reg=0.00000 | L2-Norm=24.111 | L2-Norm(final)=2.312 | acc=1.0000 | 4471.9 samples/s | 69.9 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00332 | Reg=0.00000 | L2-Norm=24.137 | L2-Norm(final)=2.316 | acc=1.0000 | 4480.1 samples/s | 70.0 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00278 | Reg=0.00000 | L2-Norm=24.157 | L2-Norm(final)=2.320 | acc=1.0000 | 4471.5 samples/s | 69.9 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00228 | Reg=0.00000 | L2-Norm=24.172 | L2-Norm(final)=2.323 | acc=1.0000 | 4477.3 samples/s | 70.0 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00190 | Reg=0.00000 | L2-Norm=24.183 | L2-Norm(final)=2.326 | acc=1.0000 | 4498.5 samples/s | 70.3 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00175 | Reg=0.00000 | L2-Norm=24.192 | L2-Norm(final)=2.329 | acc=1.0000 | 4527.1 samples/s | 70.7 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00200 | Reg=0.00000 | L2-Norm=24.203 | L2-Norm(final)=2.331 | acc=1.0000 | 4531.3 samples/s | 70.8 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00198 | Reg=0.00000 | L2-Norm=24.218 | L2-Norm(final)=2.332 | acc=1.0000 | 4509.1 samples/s | 70.5 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00181 | Reg=0.00000 | L2-Norm=24.234 | L2-Norm(final)=2.333 | acc=1.0000 | 4493.9 samples/s | 70.2 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00168 | Reg=0.00000 | L2-Norm=24.249 | L2-Norm(final)=2.335 | acc=1.0000 | 1882.0 samples/s | 29.4 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00155 | Reg=0.00000 | L2-Norm=24.262 | L2-Norm(final)=2.337 | acc=1.0000 | 4581.4 samples/s | 71.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29677 | acc=0.7855 | tpr=0.7025 | fpr=0.0342 | 4159.6 samples/s | 16.2 steps/s
Avg test loss: 0.30013, Avg test acc: 0.78652, Avg tpr: 0.70444, Avg fpr: 0.03294, total FA: 257

Testing server on iccad2012
[Step=  50] | Loss=0.29559 | acc=0.8684 | tpr=0.9779 | fpr=0.1336 | 4201.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.30813 | acc=0.8674 | tpr=0.9872 | fpr=0.1349 | 7848.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.31398 | acc=0.8673 | tpr=0.9885 | fpr=0.1349 | 8131.2 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.31797 | acc=0.8665 | tpr=0.9869 | fpr=0.1357 | 8038.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.31636 | acc=0.8662 | tpr=0.9869 | fpr=0.1359 | 8140.3 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.31846 | acc=0.8667 | tpr=0.9855 | fpr=0.1354 | 8033.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.32068 | acc=0.8660 | tpr=0.9850 | fpr=0.1361 | 8011.6 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.32086 | acc=0.8660 | tpr=0.9847 | fpr=0.1361 | 8053.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.32421 | acc=0.8651 | tpr=0.9839 | fpr=0.1371 | 7660.2 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.32317 | acc=0.8654 | tpr=0.9846 | fpr=0.1368 | 8159.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.32174 | acc=0.8658 | tpr=0.9845 | fpr=0.1364 | 13758.8 samples/s | 53.7 steps/s
Avg test loss: 0.32124, Avg test acc: 0.86587, Avg tpr: 0.98455, Avg fpr: 0.13629, total FA: 18923

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=7201 Epoch= 7.0] | Loss=0.25136 | Reg=0.00000 | L2-Norm=24.272 | L2-Norm(final)=2.336 | acc=0.8125 | 3663.2 samples/s | 57.2 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.05162 | Reg=0.00000 | L2-Norm=24.348 | L2-Norm(final)=2.332 | acc=1.0000 | 4382.9 samples/s | 68.5 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.04157 | Reg=0.00000 | L2-Norm=24.385 | L2-Norm(final)=2.341 | acc=1.0000 | 4688.9 samples/s | 73.3 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.03768 | Reg=0.00000 | L2-Norm=24.410 | L2-Norm(final)=2.346 | acc=0.9531 | 4765.6 samples/s | 74.5 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.03627 | Reg=0.00000 | L2-Norm=24.432 | L2-Norm(final)=2.347 | acc=0.9844 | 4655.1 samples/s | 72.7 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.03656 | Reg=0.00000 | L2-Norm=24.453 | L2-Norm(final)=2.349 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.03587 | Reg=0.00000 | L2-Norm=24.474 | L2-Norm(final)=2.349 | acc=0.9844 | 4718.7 samples/s | 73.7 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.03545 | Reg=0.00000 | L2-Norm=24.494 | L2-Norm(final)=2.349 | acc=0.9844 | 4729.0 samples/s | 73.9 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.03536 | Reg=0.00000 | L2-Norm=24.514 | L2-Norm(final)=2.350 | acc=0.9375 | 4749.0 samples/s | 74.2 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.03536 | Reg=0.00000 | L2-Norm=24.533 | L2-Norm(final)=2.350 | acc=0.9844 | 4687.2 samples/s | 73.2 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.03552 | Reg=0.00000 | L2-Norm=24.553 | L2-Norm(final)=2.350 | acc=0.9688 | 4685.3 samples/s | 73.2 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.03544 | Reg=0.00000 | L2-Norm=24.573 | L2-Norm(final)=2.349 | acc=0.9688 | 4710.4 samples/s | 73.6 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.03505 | Reg=0.00000 | L2-Norm=24.593 | L2-Norm(final)=2.349 | acc=0.9688 | 4636.7 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=7201 Epoch=13.6] | Loss=0.05030 | Reg=0.00000 | L2-Norm=24.272 | L2-Norm(final)=2.337 | acc=0.9688 | 3580.0 samples/s | 55.9 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00669 | Reg=0.00000 | L2-Norm=24.360 | L2-Norm(final)=2.330 | acc=1.0000 | 3997.8 samples/s | 62.5 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00429 | Reg=0.00000 | L2-Norm=24.401 | L2-Norm(final)=2.329 | acc=1.0000 | 4386.4 samples/s | 68.5 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00292 | Reg=0.00000 | L2-Norm=24.423 | L2-Norm(final)=2.333 | acc=1.0000 | 4453.1 samples/s | 69.6 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00239 | Reg=0.00000 | L2-Norm=24.437 | L2-Norm(final)=2.337 | acc=1.0000 | 4498.9 samples/s | 70.3 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00213 | Reg=0.00000 | L2-Norm=24.450 | L2-Norm(final)=2.339 | acc=1.0000 | 4468.5 samples/s | 69.8 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00179 | Reg=0.00000 | L2-Norm=24.461 | L2-Norm(final)=2.341 | acc=1.0000 | 4451.1 samples/s | 69.5 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00154 | Reg=0.00000 | L2-Norm=24.469 | L2-Norm(final)=2.343 | acc=1.0000 | 4526.1 samples/s | 70.7 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00146 | Reg=0.00000 | L2-Norm=24.476 | L2-Norm(final)=2.344 | acc=1.0000 | 4407.3 samples/s | 68.9 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00139 | Reg=0.00000 | L2-Norm=24.482 | L2-Norm(final)=2.345 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00126 | Reg=0.00000 | L2-Norm=24.488 | L2-Norm(final)=2.347 | acc=1.0000 | 4514.9 samples/s | 70.5 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00115 | Reg=0.00000 | L2-Norm=24.493 | L2-Norm(final)=2.348 | acc=1.0000 | 1885.9 samples/s | 29.5 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00105 | Reg=0.00000 | L2-Norm=24.498 | L2-Norm(final)=2.350 | acc=1.0000 | 4509.8 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7800.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38378 | acc=0.7463 | tpr=0.6359 | fpr=0.0139 | 4129.7 samples/s | 16.1 steps/s
Avg test loss: 0.38667, Avg test acc: 0.74669, Avg tpr: 0.63717, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.25736 | acc=0.8881 | tpr=0.9646 | fpr=0.1132 | 4117.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.26905 | acc=0.8848 | tpr=0.9787 | fpr=0.1169 | 8351.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.27487 | acc=0.8855 | tpr=0.9841 | fpr=0.1163 | 7781.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.27706 | acc=0.8853 | tpr=0.9814 | fpr=0.1164 | 8132.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.27499 | acc=0.8854 | tpr=0.9817 | fpr=0.1164 | 8131.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.27762 | acc=0.8852 | tpr=0.9804 | fpr=0.1165 | 8027.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.27934 | acc=0.8846 | tpr=0.9800 | fpr=0.1172 | 8131.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.27924 | acc=0.8849 | tpr=0.9765 | fpr=0.1168 | 8003.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.28243 | acc=0.8842 | tpr=0.9747 | fpr=0.1175 | 8201.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.28200 | acc=0.8842 | tpr=0.9744 | fpr=0.1174 | 7874.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.28073 | acc=0.8846 | tpr=0.9733 | fpr=0.1170 | 14908.5 samples/s | 58.2 steps/s
Avg test loss: 0.28039, Avg test acc: 0.88474, Avg tpr: 0.97345, Avg fpr: 0.11688, total FA: 16228

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=7801 Epoch= 7.6] | Loss=0.24262 | Reg=0.00000 | L2-Norm=24.545 | L2-Norm(final)=2.352 | acc=0.8125 | 3621.2 samples/s | 56.6 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.05217 | Reg=0.00000 | L2-Norm=24.622 | L2-Norm(final)=2.337 | acc=1.0000 | 4399.2 samples/s | 68.7 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.03978 | Reg=0.00000 | L2-Norm=24.660 | L2-Norm(final)=2.355 | acc=1.0000 | 4670.1 samples/s | 73.0 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.03641 | Reg=0.00000 | L2-Norm=24.691 | L2-Norm(final)=2.363 | acc=0.9531 | 4747.4 samples/s | 74.2 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.03443 | Reg=0.00000 | L2-Norm=24.717 | L2-Norm(final)=2.365 | acc=0.9844 | 4731.6 samples/s | 73.9 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.03371 | Reg=0.00000 | L2-Norm=24.742 | L2-Norm(final)=2.365 | acc=0.9844 | 4625.9 samples/s | 72.3 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.03345 | Reg=0.00000 | L2-Norm=24.764 | L2-Norm(final)=2.366 | acc=1.0000 | 4759.5 samples/s | 74.4 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.03305 | Reg=0.00000 | L2-Norm=24.785 | L2-Norm(final)=2.367 | acc=0.9844 | 4651.9 samples/s | 72.7 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.03262 | Reg=0.00000 | L2-Norm=24.806 | L2-Norm(final)=2.368 | acc=0.9531 | 4770.6 samples/s | 74.5 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.03241 | Reg=0.00000 | L2-Norm=24.826 | L2-Norm(final)=2.370 | acc=0.9844 | 4671.4 samples/s | 73.0 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03268 | Reg=0.00000 | L2-Norm=24.847 | L2-Norm(final)=2.373 | acc=0.9531 | 4764.6 samples/s | 74.4 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03246 | Reg=0.00000 | L2-Norm=24.869 | L2-Norm(final)=2.375 | acc=0.9688 | 4757.3 samples/s | 74.3 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03294 | Reg=0.00000 | L2-Norm=24.891 | L2-Norm(final)=2.377 | acc=1.0000 | 4721.0 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=7801 Epoch=14.7] | Loss=0.06423 | Reg=0.00000 | L2-Norm=24.545 | L2-Norm(final)=2.353 | acc=0.9688 | 3800.5 samples/s | 59.4 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00557 | Reg=0.00000 | L2-Norm=24.608 | L2-Norm(final)=2.356 | acc=1.0000 | 3885.1 samples/s | 60.7 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00395 | Reg=0.00000 | L2-Norm=24.650 | L2-Norm(final)=2.351 | acc=1.0000 | 4422.2 samples/s | 69.1 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00327 | Reg=0.00000 | L2-Norm=24.687 | L2-Norm(final)=2.350 | acc=1.0000 | 4486.0 samples/s | 70.1 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00270 | Reg=0.00000 | L2-Norm=24.716 | L2-Norm(final)=2.350 | acc=1.0000 | 4470.3 samples/s | 69.8 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00225 | Reg=0.00000 | L2-Norm=24.737 | L2-Norm(final)=2.352 | acc=1.0000 | 4493.1 samples/s | 70.2 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00188 | Reg=0.00000 | L2-Norm=24.752 | L2-Norm(final)=2.354 | acc=1.0000 | 4457.8 samples/s | 69.7 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00162 | Reg=0.00000 | L2-Norm=24.763 | L2-Norm(final)=2.357 | acc=1.0000 | 4510.2 samples/s | 70.5 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00142 | Reg=0.00000 | L2-Norm=24.772 | L2-Norm(final)=2.359 | acc=1.0000 | 4463.8 samples/s | 69.7 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00127 | Reg=0.00000 | L2-Norm=24.779 | L2-Norm(final)=2.362 | acc=1.0000 | 4486.2 samples/s | 70.1 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00114 | Reg=0.00000 | L2-Norm=24.785 | L2-Norm(final)=2.364 | acc=1.0000 | 4504.9 samples/s | 70.4 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00104 | Reg=0.00000 | L2-Norm=24.791 | L2-Norm(final)=2.366 | acc=1.0000 | 1956.5 samples/s | 30.6 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00096 | Reg=0.00000 | L2-Norm=24.796 | L2-Norm(final)=2.368 | acc=1.0000 | 4357.6 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8400.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36375 | acc=0.7565 | tpr=0.6500 | fpr=0.0124 | 4120.4 samples/s | 16.1 steps/s
Avg test loss: 0.36458, Avg test acc: 0.75883, Avg tpr: 0.65414, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.31003 | acc=0.8688 | tpr=0.9823 | fpr=0.1332 | 4121.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.32573 | acc=0.8671 | tpr=0.9872 | fpr=0.1352 | 8050.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.33330 | acc=0.8667 | tpr=0.9885 | fpr=0.1355 | 7890.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.33793 | acc=0.8663 | tpr=0.9880 | fpr=0.1359 | 8086.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.33655 | acc=0.8646 | tpr=0.9895 | fpr=0.1377 | 8072.0 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.33950 | acc=0.8642 | tpr=0.9884 | fpr=0.1381 | 8179.7 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.34189 | acc=0.8632 | tpr=0.9875 | fpr=0.1390 | 8023.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.34151 | acc=0.8639 | tpr=0.9858 | fpr=0.1383 | 8280.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.34516 | acc=0.8634 | tpr=0.9844 | fpr=0.1388 | 7743.0 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.34431 | acc=0.8636 | tpr=0.9846 | fpr=0.1386 | 8012.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.34230 | acc=0.8642 | tpr=0.9833 | fpr=0.1379 | 14328.0 samples/s | 56.0 steps/s
Avg test loss: 0.34184, Avg test acc: 0.86436, Avg tpr: 0.98336, Avg fpr: 0.13781, total FA: 19134

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=8401 Epoch= 8.2] | Loss=0.14585 | Reg=0.00000 | L2-Norm=24.840 | L2-Norm(final)=2.379 | acc=0.8750 | 3510.9 samples/s | 54.9 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.04558 | Reg=0.00000 | L2-Norm=24.922 | L2-Norm(final)=2.368 | acc=0.9844 | 4578.7 samples/s | 71.5 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03584 | Reg=0.00000 | L2-Norm=24.958 | L2-Norm(final)=2.373 | acc=0.9688 | 4690.3 samples/s | 73.3 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03264 | Reg=0.00000 | L2-Norm=24.985 | L2-Norm(final)=2.380 | acc=1.0000 | 4624.0 samples/s | 72.3 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03380 | Reg=0.00000 | L2-Norm=25.010 | L2-Norm(final)=2.384 | acc=0.9688 | 4623.1 samples/s | 72.2 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03282 | Reg=0.00000 | L2-Norm=25.033 | L2-Norm(final)=2.387 | acc=0.9844 | 4662.3 samples/s | 72.8 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03187 | Reg=0.00000 | L2-Norm=25.055 | L2-Norm(final)=2.390 | acc=0.9844 | 4704.9 samples/s | 73.5 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03187 | Reg=0.00000 | L2-Norm=25.077 | L2-Norm(final)=2.392 | acc=0.9844 | 4657.0 samples/s | 72.8 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03141 | Reg=0.00000 | L2-Norm=25.098 | L2-Norm(final)=2.394 | acc=0.9844 | 4696.6 samples/s | 73.4 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.03098 | Reg=0.00000 | L2-Norm=25.120 | L2-Norm(final)=2.396 | acc=0.9844 | 4765.4 samples/s | 74.5 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03122 | Reg=0.00000 | L2-Norm=25.141 | L2-Norm(final)=2.397 | acc=0.9531 | 4671.0 samples/s | 73.0 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03081 | Reg=0.00000 | L2-Norm=25.162 | L2-Norm(final)=2.399 | acc=0.9844 | 4764.6 samples/s | 74.4 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03079 | Reg=0.00000 | L2-Norm=25.182 | L2-Norm(final)=2.400 | acc=0.9844 | 4745.0 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=8401 Epoch=15.8] | Loss=0.02691 | Reg=0.00000 | L2-Norm=24.840 | L2-Norm(final)=2.379 | acc=0.9688 | 3451.6 samples/s | 53.9 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00708 | Reg=0.00000 | L2-Norm=24.967 | L2-Norm(final)=2.373 | acc=1.0000 | 4139.8 samples/s | 64.7 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00392 | Reg=0.00000 | L2-Norm=25.027 | L2-Norm(final)=2.371 | acc=0.9844 | 4508.3 samples/s | 70.4 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00321 | Reg=0.00000 | L2-Norm=25.059 | L2-Norm(final)=2.373 | acc=1.0000 | 4410.7 samples/s | 68.9 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00291 | Reg=0.00000 | L2-Norm=25.086 | L2-Norm(final)=2.375 | acc=1.0000 | 4476.5 samples/s | 69.9 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00248 | Reg=0.00000 | L2-Norm=25.113 | L2-Norm(final)=2.376 | acc=1.0000 | 4469.7 samples/s | 69.8 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00259 | Reg=0.00000 | L2-Norm=25.135 | L2-Norm(final)=2.378 | acc=0.9688 | 4489.8 samples/s | 70.2 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00309 | Reg=0.00000 | L2-Norm=25.163 | L2-Norm(final)=2.377 | acc=0.9844 | 4452.9 samples/s | 69.6 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00340 | Reg=0.00000 | L2-Norm=25.193 | L2-Norm(final)=2.374 | acc=1.0000 | 4570.7 samples/s | 71.4 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00333 | Reg=0.00000 | L2-Norm=25.225 | L2-Norm(final)=2.370 | acc=1.0000 | 4493.9 samples/s | 70.2 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00311 | Reg=0.00000 | L2-Norm=25.256 | L2-Norm(final)=2.368 | acc=1.0000 | 4464.0 samples/s | 69.7 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00285 | Reg=0.00000 | L2-Norm=25.282 | L2-Norm(final)=2.367 | acc=1.0000 | 1877.2 samples/s | 29.3 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00262 | Reg=0.00000 | L2-Norm=25.304 | L2-Norm(final)=2.367 | acc=1.0000 | 4533.6 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9000.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50945 | acc=0.6484 | tpr=0.4937 | fpr=0.0156 | 4102.0 samples/s | 16.0 steps/s
Avg test loss: 0.51292, Avg test acc: 0.65057, Avg tpr: 0.49764, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.21084 | acc=0.9141 | tpr=0.9823 | fpr=0.0871 | 4148.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.22214 | acc=0.9104 | tpr=0.9893 | fpr=0.0911 | 8013.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.22953 | acc=0.9091 | tpr=0.9899 | fpr=0.0923 | 8338.5 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.23225 | acc=0.9083 | tpr=0.9902 | fpr=0.0932 | 7920.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.23068 | acc=0.9078 | tpr=0.9895 | fpr=0.0937 | 8235.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.23264 | acc=0.9077 | tpr=0.9876 | fpr=0.0938 | 8039.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.23439 | acc=0.9073 | tpr=0.9862 | fpr=0.0941 | 7975.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.23457 | acc=0.9076 | tpr=0.9841 | fpr=0.0938 | 8089.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.23720 | acc=0.9074 | tpr=0.9830 | fpr=0.0940 | 8664.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.23703 | acc=0.9075 | tpr=0.9837 | fpr=0.0939 | 7602.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.23574 | acc=0.9078 | tpr=0.9833 | fpr=0.0936 | 14252.6 samples/s | 55.7 steps/s
Avg test loss: 0.23551, Avg test acc: 0.90790, Avg tpr: 0.98336, Avg fpr: 0.09347, total FA: 12978

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=9001 Epoch= 8.8] | Loss=0.44951 | Reg=0.00000 | L2-Norm=25.260 | L2-Norm(final)=2.374 | acc=0.7031 | 3844.7 samples/s | 60.1 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.06642 | Reg=0.00000 | L2-Norm=25.371 | L2-Norm(final)=2.350 | acc=0.9844 | 4319.3 samples/s | 67.5 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.04907 | Reg=0.00000 | L2-Norm=25.418 | L2-Norm(final)=2.362 | acc=0.9844 | 4730.5 samples/s | 73.9 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.04373 | Reg=0.00000 | L2-Norm=25.446 | L2-Norm(final)=2.369 | acc=0.9844 | 4676.6 samples/s | 73.1 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.04098 | Reg=0.00000 | L2-Norm=25.472 | L2-Norm(final)=2.374 | acc=0.9844 | 4718.2 samples/s | 73.7 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.03918 | Reg=0.00000 | L2-Norm=25.495 | L2-Norm(final)=2.380 | acc=0.9688 | 4695.6 samples/s | 73.4 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.03730 | Reg=0.00000 | L2-Norm=25.517 | L2-Norm(final)=2.383 | acc=0.9688 | 4698.3 samples/s | 73.4 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.03540 | Reg=0.00000 | L2-Norm=25.537 | L2-Norm(final)=2.386 | acc=0.9844 | 4616.6 samples/s | 72.1 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.03477 | Reg=0.00000 | L2-Norm=25.556 | L2-Norm(final)=2.389 | acc=1.0000 | 4602.2 samples/s | 71.9 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.03389 | Reg=0.00000 | L2-Norm=25.575 | L2-Norm(final)=2.392 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.03362 | Reg=0.00000 | L2-Norm=25.593 | L2-Norm(final)=2.394 | acc=0.9531 | 4704.9 samples/s | 73.5 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.03368 | Reg=0.00000 | L2-Norm=25.612 | L2-Norm(final)=2.394 | acc=0.9844 | 4758.1 samples/s | 74.3 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.03321 | Reg=0.00000 | L2-Norm=25.630 | L2-Norm(final)=2.395 | acc=0.9844 | 4622.9 samples/s | 72.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=9001 Epoch=17.0] | Loss=0.00411 | Reg=0.00000 | L2-Norm=25.260 | L2-Norm(final)=2.378 | acc=1.0000 | 3737.5 samples/s | 58.4 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00181 | Reg=0.00000 | L2-Norm=25.294 | L2-Norm(final)=2.393 | acc=1.0000 | 3919.0 samples/s | 61.2 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00093 | Reg=0.00000 | L2-Norm=25.304 | L2-Norm(final)=2.398 | acc=1.0000 | 4423.3 samples/s | 69.1 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00064 | Reg=0.00000 | L2-Norm=25.307 | L2-Norm(final)=2.401 | acc=1.0000 | 4422.1 samples/s | 69.1 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00051 | Reg=0.00000 | L2-Norm=25.310 | L2-Norm(final)=2.403 | acc=1.0000 | 4458.5 samples/s | 69.7 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00041 | Reg=0.00000 | L2-Norm=25.312 | L2-Norm(final)=2.405 | acc=1.0000 | 4468.8 samples/s | 69.8 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00035 | Reg=0.00000 | L2-Norm=25.314 | L2-Norm(final)=2.407 | acc=1.0000 | 4466.2 samples/s | 69.8 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00030 | Reg=0.00000 | L2-Norm=25.315 | L2-Norm(final)=2.408 | acc=1.0000 | 4517.3 samples/s | 70.6 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00026 | Reg=0.00000 | L2-Norm=25.316 | L2-Norm(final)=2.410 | acc=1.0000 | 4468.6 samples/s | 69.8 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00024 | Reg=0.00000 | L2-Norm=25.317 | L2-Norm(final)=2.411 | acc=1.0000 | 4471.0 samples/s | 69.9 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00022 | Reg=0.00000 | L2-Norm=25.319 | L2-Norm(final)=2.412 | acc=1.0000 | 4484.3 samples/s | 70.1 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00020 | Reg=0.00000 | L2-Norm=25.320 | L2-Norm(final)=2.413 | acc=1.0000 | 1839.7 samples/s | 28.7 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00018 | Reg=0.00000 | L2-Norm=25.321 | L2-Norm(final)=2.415 | acc=1.0000 | 4503.5 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23039 | acc=0.8291 | tpr=0.7568 | fpr=0.0139 | 4118.7 samples/s | 16.1 steps/s
Avg test loss: 0.23545, Avg test acc: 0.82691, Avg tpr: 0.75462, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.34922 | acc=0.8518 | tpr=0.9690 | fpr=0.1503 | 4130.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.36528 | acc=0.8488 | tpr=0.9808 | fpr=0.1537 | 8055.8 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.37300 | acc=0.8489 | tpr=0.9841 | fpr=0.1536 | 7957.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.37789 | acc=0.8480 | tpr=0.9836 | fpr=0.1544 | 8126.0 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.37653 | acc=0.8473 | tpr=0.9834 | fpr=0.1552 | 8111.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.37960 | acc=0.8464 | tpr=0.9825 | fpr=0.1560 | 7947.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.38242 | acc=0.8448 | tpr=0.9825 | fpr=0.1577 | 8153.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.38169 | acc=0.8451 | tpr=0.9803 | fpr=0.1573 | 8285.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.38470 | acc=0.8448 | tpr=0.9800 | fpr=0.1577 | 7794.2 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.38434 | acc=0.8450 | tpr=0.9802 | fpr=0.1574 | 8375.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.38288 | acc=0.8451 | tpr=0.9789 | fpr=0.1573 | 13631.1 samples/s | 53.2 steps/s
Avg test loss: 0.38242, Avg test acc: 0.84527, Avg tpr: 0.97900, Avg fpr: 0.15716, total FA: 21822

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=9601 Epoch= 9.4] | Loss=0.07869 | Reg=0.00000 | L2-Norm=25.480 | L2-Norm(final)=2.405 | acc=0.9219 | 4007.6 samples/s | 62.6 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.03658 | Reg=0.00000 | L2-Norm=25.531 | L2-Norm(final)=2.408 | acc=0.9531 | 4112.9 samples/s | 64.3 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03176 | Reg=0.00000 | L2-Norm=25.560 | L2-Norm(final)=2.410 | acc=0.9844 | 4735.5 samples/s | 74.0 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.02865 | Reg=0.00000 | L2-Norm=25.584 | L2-Norm(final)=2.415 | acc=0.9688 | 4695.9 samples/s | 73.4 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.02874 | Reg=0.00000 | L2-Norm=25.605 | L2-Norm(final)=2.422 | acc=1.0000 | 4719.8 samples/s | 73.7 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02772 | Reg=0.00000 | L2-Norm=25.626 | L2-Norm(final)=2.428 | acc=0.9688 | 4648.6 samples/s | 72.6 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02704 | Reg=0.00000 | L2-Norm=25.645 | L2-Norm(final)=2.430 | acc=0.9688 | 4717.6 samples/s | 73.7 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02720 | Reg=0.00000 | L2-Norm=25.665 | L2-Norm(final)=2.432 | acc=0.9844 | 4791.0 samples/s | 74.9 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02696 | Reg=0.00000 | L2-Norm=25.686 | L2-Norm(final)=2.434 | acc=0.9844 | 4692.9 samples/s | 73.3 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02693 | Reg=0.00000 | L2-Norm=25.706 | L2-Norm(final)=2.436 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02720 | Reg=0.00000 | L2-Norm=25.725 | L2-Norm(final)=2.438 | acc=0.9844 | 4700.4 samples/s | 73.4 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02705 | Reg=0.00000 | L2-Norm=25.744 | L2-Norm(final)=2.439 | acc=0.9688 | 4748.4 samples/s | 74.2 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02721 | Reg=0.00000 | L2-Norm=25.763 | L2-Norm(final)=2.440 | acc=0.9844 | 4720.9 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=9601 Epoch=18.1] | Loss=0.11612 | Reg=0.00000 | L2-Norm=25.480 | L2-Norm(final)=2.402 | acc=0.9375 | 3519.6 samples/s | 55.0 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00590 | Reg=0.00000 | L2-Norm=25.607 | L2-Norm(final)=2.384 | acc=1.0000 | 4198.3 samples/s | 65.6 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00424 | Reg=0.00000 | L2-Norm=25.657 | L2-Norm(final)=2.385 | acc=1.0000 | 4463.7 samples/s | 69.7 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00386 | Reg=0.00000 | L2-Norm=25.692 | L2-Norm(final)=2.387 | acc=1.0000 | 4474.9 samples/s | 69.9 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00333 | Reg=0.00000 | L2-Norm=25.727 | L2-Norm(final)=2.390 | acc=1.0000 | 4478.2 samples/s | 70.0 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00358 | Reg=0.00000 | L2-Norm=25.758 | L2-Norm(final)=2.391 | acc=1.0000 | 4492.6 samples/s | 70.2 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00377 | Reg=0.00000 | L2-Norm=25.787 | L2-Norm(final)=2.389 | acc=1.0000 | 4484.3 samples/s | 70.1 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00382 | Reg=0.00000 | L2-Norm=25.813 | L2-Norm(final)=2.383 | acc=1.0000 | 4449.7 samples/s | 69.5 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00346 | Reg=0.00000 | L2-Norm=25.836 | L2-Norm(final)=2.379 | acc=1.0000 | 4502.8 samples/s | 70.4 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00310 | Reg=0.00000 | L2-Norm=25.855 | L2-Norm(final)=2.378 | acc=1.0000 | 4451.7 samples/s | 69.6 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00281 | Reg=0.00000 | L2-Norm=25.872 | L2-Norm(final)=2.378 | acc=1.0000 | 4498.6 samples/s | 70.3 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00256 | Reg=0.00000 | L2-Norm=25.886 | L2-Norm(final)=2.378 | acc=1.0000 | 1880.8 samples/s | 29.4 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00235 | Reg=0.00000 | L2-Norm=25.898 | L2-Norm(final)=2.379 | acc=1.0000 | 4463.0 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10200.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45046 | acc=0.6905 | tpr=0.5556 | fpr=0.0166 | 4115.5 samples/s | 16.1 steps/s
Avg test loss: 0.45515, Avg test acc: 0.68952, Avg tpr: 0.55546, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.23102 | acc=0.9221 | tpr=0.9867 | fpr=0.0791 | 4095.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.24397 | acc=0.9187 | tpr=0.9893 | fpr=0.0826 | 7881.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.25245 | acc=0.9176 | tpr=0.9885 | fpr=0.0838 | 8497.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.25628 | acc=0.9173 | tpr=0.9880 | fpr=0.0840 | 7765.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.25301 | acc=0.9174 | tpr=0.9878 | fpr=0.0839 | 8533.9 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.25637 | acc=0.9171 | tpr=0.9862 | fpr=0.0841 | 7773.4 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.25797 | acc=0.9168 | tpr=0.9856 | fpr=0.0845 | 8343.7 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.25834 | acc=0.9169 | tpr=0.9836 | fpr=0.0843 | 7808.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.26162 | acc=0.9165 | tpr=0.9825 | fpr=0.0847 | 8060.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.26123 | acc=0.9164 | tpr=0.9819 | fpr=0.0848 | 8522.2 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.25946 | acc=0.9168 | tpr=0.9813 | fpr=0.0844 | 13033.9 samples/s | 50.9 steps/s
Avg test loss: 0.25911, Avg test acc: 0.91682, Avg tpr: 0.98138, Avg fpr: 0.08436, total FA: 11713

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=10201 Epoch=10.0] | Loss=0.40240 | Reg=0.00000 | L2-Norm=25.811 | L2-Norm(final)=2.403 | acc=0.6875 | 3523.4 samples/s | 55.1 steps/s
[Step=10250 Epoch=10.0] | Loss=0.05620 | Reg=0.00000 | L2-Norm=25.905 | L2-Norm(final)=2.385 | acc=0.9688 | 4686.1 samples/s | 73.2 steps/s
[Step=10300 Epoch=10.1] | Loss=0.04212 | Reg=0.00000 | L2-Norm=25.949 | L2-Norm(final)=2.397 | acc=0.9531 | 4628.3 samples/s | 72.3 steps/s
[Step=10350 Epoch=10.1] | Loss=0.03849 | Reg=0.00000 | L2-Norm=25.981 | L2-Norm(final)=2.404 | acc=0.9375 | 4591.2 samples/s | 71.7 steps/s
[Step=10400 Epoch=10.2] | Loss=0.03662 | Reg=0.00000 | L2-Norm=26.008 | L2-Norm(final)=2.410 | acc=0.9688 | 4693.6 samples/s | 73.3 steps/s
[Step=10450 Epoch=10.2] | Loss=0.03464 | Reg=0.00000 | L2-Norm=26.032 | L2-Norm(final)=2.414 | acc=1.0000 | 4699.1 samples/s | 73.4 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03403 | Reg=0.00000 | L2-Norm=26.056 | L2-Norm(final)=2.418 | acc=0.9688 | 4701.6 samples/s | 73.5 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03365 | Reg=0.00000 | L2-Norm=26.078 | L2-Norm(final)=2.419 | acc=0.9688 | 4699.9 samples/s | 73.4 steps/s
[Step=10600 Epoch=10.3] | Loss=0.03317 | Reg=0.00000 | L2-Norm=26.099 | L2-Norm(final)=2.419 | acc=0.9688 | 4905.1 samples/s | 76.6 steps/s
[Step=10650 Epoch=10.4] | Loss=0.03230 | Reg=0.00000 | L2-Norm=26.120 | L2-Norm(final)=2.421 | acc=0.9531 | 4661.9 samples/s | 72.8 steps/s
[Step=10700 Epoch=10.4] | Loss=0.03143 | Reg=0.00000 | L2-Norm=26.139 | L2-Norm(final)=2.423 | acc=0.9688 | 4730.2 samples/s | 73.9 steps/s
[Step=10750 Epoch=10.5] | Loss=0.03126 | Reg=0.00000 | L2-Norm=26.158 | L2-Norm(final)=2.425 | acc=0.9531 | 4723.2 samples/s | 73.8 steps/s
[Step=10800 Epoch=10.5] | Loss=0.03107 | Reg=0.00000 | L2-Norm=26.177 | L2-Norm(final)=2.427 | acc=1.0000 | 4771.3 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=10201 Epoch=19.2] | Loss=0.01602 | Reg=0.00000 | L2-Norm=25.811 | L2-Norm(final)=2.406 | acc=1.0000 | 3466.6 samples/s | 54.2 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00148 | Reg=0.00000 | L2-Norm=25.854 | L2-Norm(final)=2.418 | acc=1.0000 | 4355.0 samples/s | 68.0 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00078 | Reg=0.00000 | L2-Norm=25.870 | L2-Norm(final)=2.426 | acc=1.0000 | 4441.8 samples/s | 69.4 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00053 | Reg=0.00000 | L2-Norm=25.877 | L2-Norm(final)=2.431 | acc=1.0000 | 4480.2 samples/s | 70.0 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00042 | Reg=0.00000 | L2-Norm=25.882 | L2-Norm(final)=2.434 | acc=1.0000 | 4499.5 samples/s | 70.3 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00035 | Reg=0.00000 | L2-Norm=25.885 | L2-Norm(final)=2.437 | acc=1.0000 | 4484.4 samples/s | 70.1 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00029 | Reg=0.00000 | L2-Norm=25.889 | L2-Norm(final)=2.440 | acc=1.0000 | 4425.6 samples/s | 69.1 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00025 | Reg=0.00000 | L2-Norm=25.892 | L2-Norm(final)=2.443 | acc=1.0000 | 4492.3 samples/s | 70.2 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00022 | Reg=0.00000 | L2-Norm=25.894 | L2-Norm(final)=2.445 | acc=1.0000 | 4480.6 samples/s | 70.0 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00020 | Reg=0.00000 | L2-Norm=25.896 | L2-Norm(final)=2.447 | acc=1.0000 | 4599.6 samples/s | 71.9 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00018 | Reg=0.00000 | L2-Norm=25.897 | L2-Norm(final)=2.448 | acc=1.0000 | 4420.5 samples/s | 69.1 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00016 | Reg=0.00000 | L2-Norm=25.898 | L2-Norm(final)=2.449 | acc=1.0000 | 1885.9 samples/s | 29.5 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00015 | Reg=0.00000 | L2-Norm=25.900 | L2-Norm(final)=2.451 | acc=1.0000 | 4546.8 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10800.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28448 | acc=0.8025 | tpr=0.7165 | fpr=0.0107 | 4151.2 samples/s | 16.2 steps/s
Avg test loss: 0.28941, Avg test acc: 0.80235, Avg tpr: 0.71703, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.32965 | acc=0.8745 | tpr=0.9867 | fpr=0.1275 | 4172.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.34304 | acc=0.8715 | tpr=0.9872 | fpr=0.1307 | 8137.2 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.35145 | acc=0.8724 | tpr=0.9885 | fpr=0.1297 | 8340.9 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.35746 | acc=0.8703 | tpr=0.9836 | fpr=0.1317 | 7744.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.35532 | acc=0.8700 | tpr=0.9843 | fpr=0.1321 | 8603.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.35865 | acc=0.8697 | tpr=0.9833 | fpr=0.1324 | 8158.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.36161 | acc=0.8685 | tpr=0.9831 | fpr=0.1336 | 7670.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.36127 | acc=0.8691 | tpr=0.9798 | fpr=0.1329 | 8255.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.36462 | acc=0.8686 | tpr=0.9786 | fpr=0.1334 | 8147.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.36411 | acc=0.8685 | tpr=0.9789 | fpr=0.1335 | 7702.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.36204 | acc=0.8687 | tpr=0.9769 | fpr=0.1333 | 14554.4 samples/s | 56.9 steps/s
Avg test loss: 0.36148, Avg test acc: 0.86871, Avg tpr: 0.97662, Avg fpr: 0.13325, total FA: 18502

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=10801 Epoch=10.5] | Loss=0.21705 | Reg=0.00000 | L2-Norm=26.043 | L2-Norm(final)=2.447 | acc=0.8750 | 3987.8 samples/s | 62.3 steps/s
[Step=10850 Epoch=10.6] | Loss=0.03490 | Reg=0.00000 | L2-Norm=26.099 | L2-Norm(final)=2.446 | acc=0.9688 | 4206.1 samples/s | 65.7 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02771 | Reg=0.00000 | L2-Norm=26.124 | L2-Norm(final)=2.450 | acc=0.9688 | 4715.2 samples/s | 73.7 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02727 | Reg=0.00000 | L2-Norm=26.147 | L2-Norm(final)=2.452 | acc=0.9688 | 4658.4 samples/s | 72.8 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02641 | Reg=0.00000 | L2-Norm=26.168 | L2-Norm(final)=2.454 | acc=1.0000 | 4666.4 samples/s | 72.9 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02701 | Reg=0.00000 | L2-Norm=26.188 | L2-Norm(final)=2.455 | acc=0.9844 | 4680.8 samples/s | 73.1 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02716 | Reg=0.00000 | L2-Norm=26.208 | L2-Norm(final)=2.456 | acc=0.9531 | 4608.1 samples/s | 72.0 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02689 | Reg=0.00000 | L2-Norm=26.227 | L2-Norm(final)=2.458 | acc=0.9688 | 4592.2 samples/s | 71.8 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02609 | Reg=0.00000 | L2-Norm=26.247 | L2-Norm(final)=2.460 | acc=0.9844 | 4675.4 samples/s | 73.1 steps/s
[Step=11250 Epoch=11.0] | Loss=0.02629 | Reg=0.00000 | L2-Norm=26.267 | L2-Norm(final)=2.463 | acc=1.0000 | 4720.4 samples/s | 73.8 steps/s
[Step=11300 Epoch=11.0] | Loss=0.02615 | Reg=0.00000 | L2-Norm=26.287 | L2-Norm(final)=2.466 | acc=1.0000 | 4701.6 samples/s | 73.5 steps/s
[Step=11350 Epoch=11.1] | Loss=0.02601 | Reg=0.00000 | L2-Norm=26.307 | L2-Norm(final)=2.469 | acc=1.0000 | 4699.7 samples/s | 73.4 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02584 | Reg=0.00000 | L2-Norm=26.326 | L2-Norm(final)=2.472 | acc=0.9531 | 4705.1 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=10801 Epoch=20.4] | Loss=0.02086 | Reg=0.00000 | L2-Norm=26.043 | L2-Norm(final)=2.448 | acc=0.9844 | 3341.2 samples/s | 52.2 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00362 | Reg=0.00000 | L2-Norm=26.145 | L2-Norm(final)=2.457 | acc=0.9844 | 4410.3 samples/s | 68.9 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00387 | Reg=0.00000 | L2-Norm=26.202 | L2-Norm(final)=2.453 | acc=1.0000 | 4444.0 samples/s | 69.4 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00348 | Reg=0.00000 | L2-Norm=26.253 | L2-Norm(final)=2.445 | acc=1.0000 | 4484.3 samples/s | 70.1 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00306 | Reg=0.00000 | L2-Norm=26.298 | L2-Norm(final)=2.441 | acc=1.0000 | 4483.3 samples/s | 70.1 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00308 | Reg=0.00000 | L2-Norm=26.334 | L2-Norm(final)=2.435 | acc=1.0000 | 4420.2 samples/s | 69.1 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00271 | Reg=0.00000 | L2-Norm=26.361 | L2-Norm(final)=2.432 | acc=1.0000 | 4462.5 samples/s | 69.7 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00235 | Reg=0.00000 | L2-Norm=26.383 | L2-Norm(final)=2.430 | acc=1.0000 | 4449.8 samples/s | 69.5 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00206 | Reg=0.00000 | L2-Norm=26.400 | L2-Norm(final)=2.429 | acc=1.0000 | 4457.7 samples/s | 69.7 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00209 | Reg=0.00000 | L2-Norm=26.415 | L2-Norm(final)=2.428 | acc=1.0000 | 4488.3 samples/s | 70.1 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00198 | Reg=0.00000 | L2-Norm=26.431 | L2-Norm(final)=2.427 | acc=1.0000 | 4537.8 samples/s | 70.9 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00199 | Reg=0.00000 | L2-Norm=26.446 | L2-Norm(final)=2.427 | acc=1.0000 | 1874.2 samples/s | 29.3 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00209 | Reg=0.00000 | L2-Norm=26.463 | L2-Norm(final)=2.426 | acc=1.0000 | 4455.6 samples/s | 69.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11400.h5
Adjusting learning rate of group 0 to 7.5000e-04.
Adjusting learning rate of group 0 to 7.5000e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35608 | acc=0.7541 | tpr=0.6523 | fpr=0.0248 | 4148.4 samples/s | 16.2 steps/s
Avg test loss: 0.35656, Avg test acc: 0.75307, Avg tpr: 0.65198, Avg fpr: 0.02461, total FA: 192

Testing server on iccad2012
[Step=  50] | Loss=0.26054 | acc=0.9173 | tpr=0.9779 | fpr=0.0838 | 4086.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.27206 | acc=0.9152 | tpr=0.9787 | fpr=0.0860 | 8248.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.28370 | acc=0.9132 | tpr=0.9798 | fpr=0.0880 | 8053.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.28841 | acc=0.9127 | tpr=0.9792 | fpr=0.0885 | 7963.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.28554 | acc=0.9129 | tpr=0.9808 | fpr=0.0883 | 8072.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.28928 | acc=0.9123 | tpr=0.9796 | fpr=0.0889 | 8214.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.29208 | acc=0.9117 | tpr=0.9806 | fpr=0.0896 | 8078.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.29279 | acc=0.9120 | tpr=0.9792 | fpr=0.0892 | 8087.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.29606 | acc=0.9117 | tpr=0.9786 | fpr=0.0895 | 7923.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.29515 | acc=0.9121 | tpr=0.9793 | fpr=0.0891 | 8024.7 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.29290 | acc=0.9124 | tpr=0.9789 | fpr=0.0888 | 14049.7 samples/s | 54.9 steps/s
Avg test loss: 0.29246, Avg test acc: 0.91255, Avg tpr: 0.97900, Avg fpr: 0.08866, total FA: 12310

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00075, len=1
[Step=11401 Epoch=11.1] | Loss=0.11525 | Reg=0.00000 | L2-Norm=26.405 | L2-Norm(final)=2.445 | acc=0.9062 | 3673.6 samples/s | 57.4 steps/s
[Step=11450 Epoch=11.2] | Loss=0.05469 | Reg=0.00000 | L2-Norm=26.503 | L2-Norm(final)=2.426 | acc=1.0000 | 4562.7 samples/s | 71.3 steps/s
[Step=11500 Epoch=11.2] | Loss=0.04073 | Reg=0.00000 | L2-Norm=26.549 | L2-Norm(final)=2.436 | acc=0.9844 | 4710.0 samples/s | 73.6 steps/s
[Step=11550 Epoch=11.3] | Loss=0.03747 | Reg=0.00000 | L2-Norm=26.578 | L2-Norm(final)=2.439 | acc=0.9531 | 4740.8 samples/s | 74.1 steps/s
[Step=11600 Epoch=11.3] | Loss=0.03330 | Reg=0.00000 | L2-Norm=26.601 | L2-Norm(final)=2.443 | acc=1.0000 | 4664.1 samples/s | 72.9 steps/s
[Step=11650 Epoch=11.4] | Loss=0.03144 | Reg=0.00000 | L2-Norm=26.621 | L2-Norm(final)=2.446 | acc=0.9688 | 4774.0 samples/s | 74.6 steps/s
[Step=11700 Epoch=11.4] | Loss=0.03062 | Reg=0.00000 | L2-Norm=26.640 | L2-Norm(final)=2.449 | acc=0.9688 | 4751.0 samples/s | 74.2 steps/s
[Step=11750 Epoch=11.5] | Loss=0.03015 | Reg=0.00000 | L2-Norm=26.659 | L2-Norm(final)=2.452 | acc=0.9844 | 4771.3 samples/s | 74.6 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02990 | Reg=0.00000 | L2-Norm=26.677 | L2-Norm(final)=2.454 | acc=0.9531 | 4646.9 samples/s | 72.6 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02949 | Reg=0.00000 | L2-Norm=26.697 | L2-Norm(final)=2.456 | acc=0.9688 | 4759.0 samples/s | 74.4 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02955 | Reg=0.00000 | L2-Norm=26.717 | L2-Norm(final)=2.457 | acc=0.9531 | 4723.1 samples/s | 73.8 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02936 | Reg=0.00000 | L2-Norm=26.738 | L2-Norm(final)=2.458 | acc=0.9688 | 4754.7 samples/s | 74.3 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02924 | Reg=0.00000 | L2-Norm=26.759 | L2-Norm(final)=2.458 | acc=0.9688 | 4660.5 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00075, len=1
[Step=11401 Epoch=21.5] | Loss=0.05310 | Reg=0.00000 | L2-Norm=26.405 | L2-Norm(final)=2.446 | acc=0.9688 | 3444.4 samples/s | 53.8 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00222 | Reg=0.00000 | L2-Norm=26.454 | L2-Norm(final)=2.450 | acc=1.0000 | 4346.6 samples/s | 67.9 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00118 | Reg=0.00000 | L2-Norm=26.469 | L2-Norm(final)=2.456 | acc=1.0000 | 4489.3 samples/s | 70.1 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00081 | Reg=0.00000 | L2-Norm=26.476 | L2-Norm(final)=2.460 | acc=1.0000 | 4417.8 samples/s | 69.0 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00062 | Reg=0.00000 | L2-Norm=26.480 | L2-Norm(final)=2.463 | acc=1.0000 | 4473.9 samples/s | 69.9 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00050 | Reg=0.00000 | L2-Norm=26.482 | L2-Norm(final)=2.465 | acc=1.0000 | 4538.7 samples/s | 70.9 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00042 | Reg=0.00000 | L2-Norm=26.484 | L2-Norm(final)=2.467 | acc=1.0000 | 4510.0 samples/s | 70.5 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00039 | Reg=0.00000 | L2-Norm=26.486 | L2-Norm(final)=2.469 | acc=1.0000 | 4429.4 samples/s | 69.2 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00034 | Reg=0.00000 | L2-Norm=26.489 | L2-Norm(final)=2.471 | acc=1.0000 | 4445.6 samples/s | 69.5 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00031 | Reg=0.00000 | L2-Norm=26.491 | L2-Norm(final)=2.473 | acc=1.0000 | 4454.4 samples/s | 69.6 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00028 | Reg=0.00000 | L2-Norm=26.493 | L2-Norm(final)=2.474 | acc=1.0000 | 4511.7 samples/s | 70.5 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00025 | Reg=0.00000 | L2-Norm=26.494 | L2-Norm(final)=2.476 | acc=1.0000 | 1878.2 samples/s | 29.3 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00023 | Reg=0.00000 | L2-Norm=26.496 | L2-Norm(final)=2.477 | acc=1.0000 | 4487.5 samples/s | 70.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23304 | acc=0.8264 | tpr=0.7523 | fpr=0.0126 | 4130.1 samples/s | 16.1 steps/s
Avg test loss: 0.23456, Avg test acc: 0.82643, Avg tpr: 0.75299, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.38227 | acc=0.8588 | tpr=0.9779 | fpr=0.1434 | 4078.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.39275 | acc=0.8566 | tpr=0.9872 | fpr=0.1458 | 8063.8 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.40345 | acc=0.8550 | tpr=0.9870 | fpr=0.1474 | 8100.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.40850 | acc=0.8548 | tpr=0.9858 | fpr=0.1476 | 7879.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.40638 | acc=0.8538 | tpr=0.9886 | fpr=0.1487 | 8225.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.40992 | acc=0.8538 | tpr=0.9869 | fpr=0.1487 | 8157.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.41378 | acc=0.8530 | tpr=0.9869 | fpr=0.1494 | 8123.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.41424 | acc=0.8535 | tpr=0.9847 | fpr=0.1489 | 7942.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.41837 | acc=0.8534 | tpr=0.9844 | fpr=0.1490 | 7981.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.41747 | acc=0.8534 | tpr=0.9846 | fpr=0.1490 | 8088.2 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.41528 | acc=0.8538 | tpr=0.9833 | fpr=0.1486 | 14362.1 samples/s | 56.1 steps/s
Avg test loss: 0.41465, Avg test acc: 0.85388, Avg tpr: 0.98336, Avg fpr: 0.14847, total FA: 20615

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=12001 Epoch=11.7] | Loss=0.16929 | Reg=0.00000 | L2-Norm=26.640 | L2-Norm(final)=2.464 | acc=0.8750 | 3712.0 samples/s | 58.0 steps/s
[Step=12050 Epoch=11.8] | Loss=0.03730 | Reg=0.00000 | L2-Norm=26.690 | L2-Norm(final)=2.459 | acc=0.9844 | 4368.0 samples/s | 68.2 steps/s
[Step=12100 Epoch=11.8] | Loss=0.02745 | Reg=0.00000 | L2-Norm=26.708 | L2-Norm(final)=2.470 | acc=1.0000 | 4677.8 samples/s | 73.1 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02530 | Reg=0.00000 | L2-Norm=26.720 | L2-Norm(final)=2.476 | acc=0.9844 | 4679.1 samples/s | 73.1 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02552 | Reg=0.00000 | L2-Norm=26.730 | L2-Norm(final)=2.480 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02323 | Reg=0.00000 | L2-Norm=26.741 | L2-Norm(final)=2.484 | acc=1.0000 | 4651.7 samples/s | 72.7 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02226 | Reg=0.00000 | L2-Norm=26.750 | L2-Norm(final)=2.488 | acc=0.9688 | 4695.2 samples/s | 73.4 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02210 | Reg=0.00000 | L2-Norm=26.759 | L2-Norm(final)=2.491 | acc=0.9844 | 4736.5 samples/s | 74.0 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02158 | Reg=0.00000 | L2-Norm=26.768 | L2-Norm(final)=2.493 | acc=0.9844 | 4737.9 samples/s | 74.0 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02150 | Reg=0.00000 | L2-Norm=26.778 | L2-Norm(final)=2.496 | acc=0.9688 | 4723.8 samples/s | 73.8 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02092 | Reg=0.00000 | L2-Norm=26.786 | L2-Norm(final)=2.498 | acc=0.9844 | 4715.3 samples/s | 73.7 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02071 | Reg=0.00000 | L2-Norm=26.795 | L2-Norm(final)=2.501 | acc=0.9688 | 4729.6 samples/s | 73.9 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02042 | Reg=0.00000 | L2-Norm=26.804 | L2-Norm(final)=2.503 | acc=1.0000 | 4813.6 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=12001 Epoch=22.6] | Loss=0.08103 | Reg=0.00000 | L2-Norm=26.640 | L2-Norm(final)=2.464 | acc=0.9531 | 3625.6 samples/s | 56.7 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00525 | Reg=0.00000 | L2-Norm=26.714 | L2-Norm(final)=2.453 | acc=1.0000 | 3976.4 samples/s | 62.1 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00296 | Reg=0.00000 | L2-Norm=26.737 | L2-Norm(final)=2.449 | acc=1.0000 | 4480.5 samples/s | 70.0 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00201 | Reg=0.00000 | L2-Norm=26.748 | L2-Norm(final)=2.451 | acc=1.0000 | 4480.9 samples/s | 70.0 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00159 | Reg=0.00000 | L2-Norm=26.755 | L2-Norm(final)=2.453 | acc=1.0000 | 4469.1 samples/s | 69.8 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00128 | Reg=0.00000 | L2-Norm=26.760 | L2-Norm(final)=2.456 | acc=1.0000 | 4469.6 samples/s | 69.8 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00110 | Reg=0.00000 | L2-Norm=26.764 | L2-Norm(final)=2.458 | acc=1.0000 | 4488.5 samples/s | 70.1 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00094 | Reg=0.00000 | L2-Norm=26.767 | L2-Norm(final)=2.460 | acc=1.0000 | 4476.2 samples/s | 69.9 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00083 | Reg=0.00000 | L2-Norm=26.770 | L2-Norm(final)=2.461 | acc=1.0000 | 4472.1 samples/s | 69.9 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00074 | Reg=0.00000 | L2-Norm=26.772 | L2-Norm(final)=2.463 | acc=1.0000 | 4538.1 samples/s | 70.9 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00067 | Reg=0.00000 | L2-Norm=26.773 | L2-Norm(final)=2.464 | acc=1.0000 | 4491.3 samples/s | 70.2 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00061 | Reg=0.00000 | L2-Norm=26.775 | L2-Norm(final)=2.465 | acc=1.0000 | 1876.9 samples/s | 29.3 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00056 | Reg=0.00000 | L2-Norm=26.776 | L2-Norm(final)=2.466 | acc=1.0000 | 4508.0 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12600.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25918 | acc=0.8144 | tpr=0.7352 | fpr=0.0136 | 4104.1 samples/s | 16.0 steps/s
Avg test loss: 0.26151, Avg test acc: 0.81305, Avg tpr: 0.73358, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.35959 | acc=0.8843 | tpr=0.9823 | fpr=0.1175 | 4208.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.37338 | acc=0.8823 | tpr=0.9893 | fpr=0.1197 | 7897.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.38379 | acc=0.8822 | tpr=0.9885 | fpr=0.1198 | 8245.7 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.38885 | acc=0.8819 | tpr=0.9847 | fpr=0.1200 | 7994.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.38577 | acc=0.8814 | tpr=0.9869 | fpr=0.1205 | 8095.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.39075 | acc=0.8810 | tpr=0.9847 | fpr=0.1209 | 7956.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.39466 | acc=0.8809 | tpr=0.9850 | fpr=0.1210 | 8034.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.39547 | acc=0.8814 | tpr=0.9836 | fpr=0.1204 | 8082.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.40001 | acc=0.8813 | tpr=0.9834 | fpr=0.1206 | 8023.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.39934 | acc=0.8814 | tpr=0.9837 | fpr=0.1205 | 8489.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.39689 | acc=0.8817 | tpr=0.9829 | fpr=0.1202 | 13568.2 samples/s | 53.0 steps/s
Avg test loss: 0.39624, Avg test acc: 0.88177, Avg tpr: 0.98257, Avg fpr: 0.12007, total FA: 16671

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=12601 Epoch=12.3] | Loss=0.13200 | Reg=0.00000 | L2-Norm=26.772 | L2-Norm(final)=2.499 | acc=0.8906 | 3856.5 samples/s | 60.3 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02990 | Reg=0.00000 | L2-Norm=26.831 | L2-Norm(final)=2.496 | acc=1.0000 | 4390.8 samples/s | 68.6 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02316 | Reg=0.00000 | L2-Norm=26.852 | L2-Norm(final)=2.507 | acc=0.9688 | 4704.5 samples/s | 73.5 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02362 | Reg=0.00000 | L2-Norm=26.865 | L2-Norm(final)=2.512 | acc=0.9844 | 4734.6 samples/s | 74.0 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02186 | Reg=0.00000 | L2-Norm=26.878 | L2-Norm(final)=2.515 | acc=0.9688 | 4614.2 samples/s | 72.1 steps/s
[Step=12850 Epoch=12.5] | Loss=0.02223 | Reg=0.00000 | L2-Norm=26.888 | L2-Norm(final)=2.518 | acc=0.9531 | 4617.8 samples/s | 72.2 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02208 | Reg=0.00000 | L2-Norm=26.899 | L2-Norm(final)=2.522 | acc=1.0000 | 4618.5 samples/s | 72.2 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02257 | Reg=0.00000 | L2-Norm=26.910 | L2-Norm(final)=2.525 | acc=0.9844 | 4661.1 samples/s | 72.8 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02230 | Reg=0.00000 | L2-Norm=26.921 | L2-Norm(final)=2.527 | acc=1.0000 | 4692.6 samples/s | 73.3 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02170 | Reg=0.00000 | L2-Norm=26.933 | L2-Norm(final)=2.531 | acc=0.9844 | 4694.7 samples/s | 73.4 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02169 | Reg=0.00000 | L2-Norm=26.945 | L2-Norm(final)=2.533 | acc=1.0000 | 4689.9 samples/s | 73.3 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02148 | Reg=0.00000 | L2-Norm=26.957 | L2-Norm(final)=2.536 | acc=0.9844 | 4746.8 samples/s | 74.2 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02156 | Reg=0.00000 | L2-Norm=26.970 | L2-Norm(final)=2.539 | acc=0.9688 | 4698.0 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=12601 Epoch=23.8] | Loss=0.06846 | Reg=0.00000 | L2-Norm=26.772 | L2-Norm(final)=2.500 | acc=0.9688 | 3758.6 samples/s | 58.7 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00449 | Reg=0.00000 | L2-Norm=26.844 | L2-Norm(final)=2.502 | acc=1.0000 | 4214.6 samples/s | 65.9 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00242 | Reg=0.00000 | L2-Norm=26.867 | L2-Norm(final)=2.505 | acc=1.0000 | 4468.1 samples/s | 69.8 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00165 | Reg=0.00000 | L2-Norm=26.877 | L2-Norm(final)=2.509 | acc=1.0000 | 4464.0 samples/s | 69.7 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00125 | Reg=0.00000 | L2-Norm=26.884 | L2-Norm(final)=2.512 | acc=1.0000 | 4410.2 samples/s | 68.9 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00102 | Reg=0.00000 | L2-Norm=26.888 | L2-Norm(final)=2.515 | acc=1.0000 | 4434.6 samples/s | 69.3 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00086 | Reg=0.00000 | L2-Norm=26.891 | L2-Norm(final)=2.517 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00074 | Reg=0.00000 | L2-Norm=26.894 | L2-Norm(final)=2.519 | acc=1.0000 | 4480.5 samples/s | 70.0 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00066 | Reg=0.00000 | L2-Norm=26.896 | L2-Norm(final)=2.521 | acc=1.0000 | 4450.2 samples/s | 69.5 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00059 | Reg=0.00000 | L2-Norm=26.899 | L2-Norm(final)=2.523 | acc=1.0000 | 4550.1 samples/s | 71.1 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00053 | Reg=0.00000 | L2-Norm=26.901 | L2-Norm(final)=2.525 | acc=1.0000 | 4446.2 samples/s | 69.5 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00049 | Reg=0.00000 | L2-Norm=26.903 | L2-Norm(final)=2.527 | acc=1.0000 | 1879.6 samples/s | 29.4 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00045 | Reg=0.00000 | L2-Norm=26.905 | L2-Norm(final)=2.529 | acc=1.0000 | 4554.2 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13200.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24575 | acc=0.8217 | tpr=0.7457 | fpr=0.0131 | 4116.1 samples/s | 16.1 steps/s
Avg test loss: 0.24723, Avg test acc: 0.82058, Avg tpr: 0.74448, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.36808 | acc=0.8830 | tpr=0.9779 | fpr=0.1187 | 4151.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.38086 | acc=0.8814 | tpr=0.9872 | fpr=0.1206 | 7924.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.39250 | acc=0.8807 | tpr=0.9841 | fpr=0.1212 | 8046.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.39675 | acc=0.8800 | tpr=0.9836 | fpr=0.1219 | 8417.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.39275 | acc=0.8802 | tpr=0.9843 | fpr=0.1217 | 8359.5 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.39839 | acc=0.8797 | tpr=0.9833 | fpr=0.1221 | 7467.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.40226 | acc=0.8789 | tpr=0.9837 | fpr=0.1230 | 7966.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.40330 | acc=0.8796 | tpr=0.9819 | fpr=0.1223 | 8259.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.40777 | acc=0.8794 | tpr=0.9815 | fpr=0.1225 | 8036.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.40714 | acc=0.8793 | tpr=0.9819 | fpr=0.1225 | 8142.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.40446 | acc=0.8797 | tpr=0.9813 | fpr=0.1222 | 13622.6 samples/s | 53.2 steps/s
Avg test loss: 0.40399, Avg test acc: 0.87979, Avg tpr: 0.98098, Avg fpr: 0.12205, total FA: 16946

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=13201 Epoch=12.9] | Loss=0.17457 | Reg=0.00000 | L2-Norm=26.932 | L2-Norm(final)=2.553 | acc=0.8438 | 3756.9 samples/s | 58.7 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02961 | Reg=0.00000 | L2-Norm=26.995 | L2-Norm(final)=2.552 | acc=0.9688 | 4531.1 samples/s | 70.8 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02360 | Reg=0.00000 | L2-Norm=27.019 | L2-Norm(final)=2.562 | acc=0.9844 | 4741.4 samples/s | 74.1 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02103 | Reg=0.00000 | L2-Norm=27.035 | L2-Norm(final)=2.568 | acc=0.9844 | 4666.9 samples/s | 72.9 steps/s
[Step=13400 Epoch=13.1] | Loss=0.01984 | Reg=0.00000 | L2-Norm=27.048 | L2-Norm(final)=2.572 | acc=1.0000 | 4686.3 samples/s | 73.2 steps/s
[Step=13450 Epoch=13.1] | Loss=0.01967 | Reg=0.00000 | L2-Norm=27.059 | L2-Norm(final)=2.576 | acc=0.9688 | 4723.1 samples/s | 73.8 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02000 | Reg=0.00000 | L2-Norm=27.071 | L2-Norm(final)=2.578 | acc=0.9688 | 4726.4 samples/s | 73.8 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02035 | Reg=0.00000 | L2-Norm=27.082 | L2-Norm(final)=2.578 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02001 | Reg=0.00000 | L2-Norm=27.094 | L2-Norm(final)=2.579 | acc=0.9375 | 4712.1 samples/s | 73.6 steps/s
[Step=13650 Epoch=13.3] | Loss=0.02035 | Reg=0.00000 | L2-Norm=27.104 | L2-Norm(final)=2.580 | acc=0.9688 | 4718.0 samples/s | 73.7 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02005 | Reg=0.00000 | L2-Norm=27.115 | L2-Norm(final)=2.581 | acc=0.9844 | 4714.8 samples/s | 73.7 steps/s
[Step=13750 Epoch=13.4] | Loss=0.01985 | Reg=0.00000 | L2-Norm=27.125 | L2-Norm(final)=2.582 | acc=0.9688 | 4747.1 samples/s | 74.2 steps/s
[Step=13800 Epoch=13.5] | Loss=0.01981 | Reg=0.00000 | L2-Norm=27.136 | L2-Norm(final)=2.583 | acc=1.0000 | 4732.7 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=13201 Epoch=24.9] | Loss=0.03680 | Reg=0.00000 | L2-Norm=26.932 | L2-Norm(final)=2.554 | acc=0.9688 | 3697.1 samples/s | 57.8 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00249 | Reg=0.00000 | L2-Norm=26.993 | L2-Norm(final)=2.566 | acc=1.0000 | 4113.4 samples/s | 64.3 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00146 | Reg=0.00000 | L2-Norm=27.024 | L2-Norm(final)=2.571 | acc=1.0000 | 4437.3 samples/s | 69.3 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00113 | Reg=0.00000 | L2-Norm=27.042 | L2-Norm(final)=2.575 | acc=1.0000 | 4497.3 samples/s | 70.3 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00112 | Reg=0.00000 | L2-Norm=27.062 | L2-Norm(final)=2.577 | acc=1.0000 | 4460.5 samples/s | 69.7 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00110 | Reg=0.00000 | L2-Norm=27.082 | L2-Norm(final)=2.578 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00168 | Reg=0.00000 | L2-Norm=27.102 | L2-Norm(final)=2.577 | acc=0.9844 | 4495.8 samples/s | 70.2 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00234 | Reg=0.00000 | L2-Norm=27.128 | L2-Norm(final)=2.572 | acc=1.0000 | 4492.0 samples/s | 70.2 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00215 | Reg=0.00000 | L2-Norm=27.155 | L2-Norm(final)=2.566 | acc=1.0000 | 4546.0 samples/s | 71.0 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00198 | Reg=0.00000 | L2-Norm=27.178 | L2-Norm(final)=2.561 | acc=1.0000 | 4421.7 samples/s | 69.1 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00192 | Reg=0.00000 | L2-Norm=27.198 | L2-Norm(final)=2.558 | acc=1.0000 | 4544.7 samples/s | 71.0 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00220 | Reg=0.00000 | L2-Norm=27.217 | L2-Norm(final)=2.554 | acc=1.0000 | 1927.8 samples/s | 30.1 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00205 | Reg=0.00000 | L2-Norm=27.235 | L2-Norm(final)=2.551 | acc=1.0000 | 4545.4 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13800.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29332 | acc=0.7880 | tpr=0.6968 | fpr=0.0139 | 4170.4 samples/s | 16.3 steps/s
Avg test loss: 0.29499, Avg test acc: 0.78756, Avg tpr: 0.69703, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.30502 | acc=0.9073 | tpr=0.9823 | fpr=0.0940 | 4137.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.32185 | acc=0.9043 | tpr=0.9893 | fpr=0.0973 | 8104.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.33075 | acc=0.9038 | tpr=0.9885 | fpr=0.0978 | 7909.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.33446 | acc=0.9029 | tpr=0.9880 | fpr=0.0987 | 8042.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.33074 | acc=0.9027 | tpr=0.9878 | fpr=0.0989 | 8097.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.33504 | acc=0.9025 | tpr=0.9869 | fpr=0.0990 | 7983.5 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.33891 | acc=0.9020 | tpr=0.9869 | fpr=0.0995 | 8108.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.34015 | acc=0.9021 | tpr=0.9852 | fpr=0.0994 | 8099.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.34495 | acc=0.9015 | tpr=0.9844 | fpr=0.1000 | 8025.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.34436 | acc=0.9014 | tpr=0.9841 | fpr=0.1001 | 8015.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.34212 | acc=0.9017 | tpr=0.9833 | fpr=0.0998 | 14581.4 samples/s | 57.0 steps/s
Avg test loss: 0.34171, Avg test acc: 0.90178, Avg tpr: 0.98336, Avg fpr: 0.09970, total FA: 13843

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=13801 Epoch=13.5] | Loss=0.09549 | Reg=0.00000 | L2-Norm=27.191 | L2-Norm(final)=2.549 | acc=0.9062 | 3555.7 samples/s | 55.6 steps/s
[Step=13850 Epoch=13.5] | Loss=0.04445 | Reg=0.00000 | L2-Norm=27.253 | L2-Norm(final)=2.539 | acc=0.9531 | 4643.2 samples/s | 72.6 steps/s
[Step=13900 Epoch=13.6] | Loss=0.03377 | Reg=0.00000 | L2-Norm=27.281 | L2-Norm(final)=2.544 | acc=0.9844 | 4693.9 samples/s | 73.3 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02954 | Reg=0.00000 | L2-Norm=27.299 | L2-Norm(final)=2.548 | acc=0.9844 | 4688.0 samples/s | 73.2 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02685 | Reg=0.00000 | L2-Norm=27.315 | L2-Norm(final)=2.552 | acc=1.0000 | 4699.5 samples/s | 73.4 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02531 | Reg=0.00000 | L2-Norm=27.330 | L2-Norm(final)=2.556 | acc=0.9531 | 4789.5 samples/s | 74.8 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02417 | Reg=0.00000 | L2-Norm=27.344 | L2-Norm(final)=2.559 | acc=0.9844 | 4665.9 samples/s | 72.9 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02401 | Reg=0.00000 | L2-Norm=27.357 | L2-Norm(final)=2.561 | acc=1.0000 | 4755.8 samples/s | 74.3 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02411 | Reg=0.00000 | L2-Norm=27.370 | L2-Norm(final)=2.562 | acc=0.9688 | 4716.1 samples/s | 73.7 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02411 | Reg=0.00000 | L2-Norm=27.383 | L2-Norm(final)=2.563 | acc=0.9531 | 4713.7 samples/s | 73.7 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02408 | Reg=0.00000 | L2-Norm=27.396 | L2-Norm(final)=2.564 | acc=1.0000 | 4732.9 samples/s | 74.0 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02408 | Reg=0.00000 | L2-Norm=27.409 | L2-Norm(final)=2.564 | acc=0.9844 | 4688.0 samples/s | 73.3 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02379 | Reg=0.00000 | L2-Norm=27.421 | L2-Norm(final)=2.565 | acc=1.0000 | 4720.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=13801 Epoch=26.0] | Loss=0.05705 | Reg=0.00000 | L2-Norm=27.191 | L2-Norm(final)=2.548 | acc=0.9375 | 3555.0 samples/s | 55.5 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00303 | Reg=0.00000 | L2-Norm=27.237 | L2-Norm(final)=2.538 | acc=1.0000 | 4302.1 samples/s | 67.2 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00160 | Reg=0.00000 | L2-Norm=27.249 | L2-Norm(final)=2.538 | acc=1.0000 | 4446.9 samples/s | 69.5 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00109 | Reg=0.00000 | L2-Norm=27.254 | L2-Norm(final)=2.539 | acc=1.0000 | 4515.1 samples/s | 70.5 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00082 | Reg=0.00000 | L2-Norm=27.257 | L2-Norm(final)=2.540 | acc=1.0000 | 4362.2 samples/s | 68.2 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00066 | Reg=0.00000 | L2-Norm=27.259 | L2-Norm(final)=2.540 | acc=1.0000 | 4465.0 samples/s | 69.8 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00055 | Reg=0.00000 | L2-Norm=27.260 | L2-Norm(final)=2.541 | acc=1.0000 | 4462.3 samples/s | 69.7 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00048 | Reg=0.00000 | L2-Norm=27.261 | L2-Norm(final)=2.542 | acc=1.0000 | 4478.4 samples/s | 70.0 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00042 | Reg=0.00000 | L2-Norm=27.262 | L2-Norm(final)=2.542 | acc=1.0000 | 4457.5 samples/s | 69.6 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00037 | Reg=0.00000 | L2-Norm=27.263 | L2-Norm(final)=2.543 | acc=1.0000 | 4449.5 samples/s | 69.5 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00034 | Reg=0.00000 | L2-Norm=27.263 | L2-Norm(final)=2.544 | acc=1.0000 | 4517.4 samples/s | 70.6 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00031 | Reg=0.00000 | L2-Norm=27.264 | L2-Norm(final)=2.544 | acc=1.0000 | 1947.2 samples/s | 30.4 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00028 | Reg=0.00000 | L2-Norm=27.264 | L2-Norm(final)=2.545 | acc=1.0000 | 4504.4 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25324 | acc=0.8117 | tpr=0.7309 | fpr=0.0129 | 4162.6 samples/s | 16.3 steps/s
Avg test loss: 0.25550, Avg test acc: 0.80956, Avg tpr: 0.72792, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.31350 | acc=0.9002 | tpr=0.9735 | fpr=0.1012 | 4109.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.32796 | acc=0.8964 | tpr=0.9808 | fpr=0.1051 | 8462.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.33637 | acc=0.8965 | tpr=0.9813 | fpr=0.1051 | 8225.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.34073 | acc=0.8962 | tpr=0.9803 | fpr=0.1053 | 7826.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.33611 | acc=0.8967 | tpr=0.9817 | fpr=0.1048 | 7972.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.34056 | acc=0.8962 | tpr=0.9811 | fpr=0.1053 | 7887.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.34408 | acc=0.8957 | tpr=0.9818 | fpr=0.1059 | 8215.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.34471 | acc=0.8958 | tpr=0.9803 | fpr=0.1057 | 8044.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.34930 | acc=0.8954 | tpr=0.9800 | fpr=0.1061 | 7990.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.34821 | acc=0.8955 | tpr=0.9802 | fpr=0.1060 | 8200.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.34618 | acc=0.8957 | tpr=0.9793 | fpr=0.1058 | 14214.8 samples/s | 55.5 steps/s
Avg test loss: 0.34571, Avg test acc: 0.89580, Avg tpr: 0.97900, Avg fpr: 0.10571, total FA: 14678

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=14401 Epoch=14.1] | Loss=0.09214 | Reg=0.00000 | L2-Norm=27.340 | L2-Norm(final)=2.558 | acc=0.9219 | 3762.5 samples/s | 58.8 steps/s
[Step=14450 Epoch=14.1] | Loss=0.03217 | Reg=0.00000 | L2-Norm=27.391 | L2-Norm(final)=2.552 | acc=1.0000 | 4263.6 samples/s | 66.6 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02546 | Reg=0.00000 | L2-Norm=27.412 | L2-Norm(final)=2.561 | acc=1.0000 | 4659.3 samples/s | 72.8 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02193 | Reg=0.00000 | L2-Norm=27.425 | L2-Norm(final)=2.569 | acc=0.9844 | 4542.8 samples/s | 71.0 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02032 | Reg=0.00000 | L2-Norm=27.434 | L2-Norm(final)=2.576 | acc=0.9688 | 4665.7 samples/s | 72.9 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02039 | Reg=0.00000 | L2-Norm=27.443 | L2-Norm(final)=2.578 | acc=0.9688 | 4686.1 samples/s | 73.2 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02036 | Reg=0.00000 | L2-Norm=27.452 | L2-Norm(final)=2.580 | acc=0.9688 | 4706.2 samples/s | 73.5 steps/s
[Step=14750 Epoch=14.4] | Loss=0.01938 | Reg=0.00000 | L2-Norm=27.460 | L2-Norm(final)=2.581 | acc=0.9844 | 4755.6 samples/s | 74.3 steps/s
[Step=14800 Epoch=14.4] | Loss=0.01937 | Reg=0.00000 | L2-Norm=27.469 | L2-Norm(final)=2.583 | acc=0.9688 | 4631.4 samples/s | 72.4 steps/s
[Step=14850 Epoch=14.5] | Loss=0.01937 | Reg=0.00000 | L2-Norm=27.478 | L2-Norm(final)=2.584 | acc=1.0000 | 4708.5 samples/s | 73.6 steps/s
[Step=14900 Epoch=14.5] | Loss=0.01998 | Reg=0.00000 | L2-Norm=27.489 | L2-Norm(final)=2.584 | acc=1.0000 | 4708.2 samples/s | 73.6 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02007 | Reg=0.00000 | L2-Norm=27.499 | L2-Norm(final)=2.584 | acc=0.9844 | 4767.8 samples/s | 74.5 steps/s
[Step=15000 Epoch=14.6] | Loss=0.01997 | Reg=0.00000 | L2-Norm=27.510 | L2-Norm(final)=2.585 | acc=1.0000 | 4719.6 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=14401 Epoch=27.1] | Loss=0.00666 | Reg=0.00000 | L2-Norm=27.340 | L2-Norm(final)=2.558 | acc=1.0000 | 3774.9 samples/s | 59.0 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00472 | Reg=0.00000 | L2-Norm=27.409 | L2-Norm(final)=2.548 | acc=1.0000 | 4075.2 samples/s | 63.7 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00266 | Reg=0.00000 | L2-Norm=27.432 | L2-Norm(final)=2.548 | acc=1.0000 | 4483.6 samples/s | 70.1 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00182 | Reg=0.00000 | L2-Norm=27.443 | L2-Norm(final)=2.551 | acc=1.0000 | 4441.9 samples/s | 69.4 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00137 | Reg=0.00000 | L2-Norm=27.450 | L2-Norm(final)=2.554 | acc=1.0000 | 4551.2 samples/s | 71.1 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00110 | Reg=0.00000 | L2-Norm=27.454 | L2-Norm(final)=2.556 | acc=1.0000 | 4373.5 samples/s | 68.3 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00092 | Reg=0.00000 | L2-Norm=27.457 | L2-Norm(final)=2.557 | acc=1.0000 | 4508.1 samples/s | 70.4 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00079 | Reg=0.00000 | L2-Norm=27.459 | L2-Norm(final)=2.558 | acc=1.0000 | 4435.8 samples/s | 69.3 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00069 | Reg=0.00000 | L2-Norm=27.461 | L2-Norm(final)=2.559 | acc=1.0000 | 4535.1 samples/s | 70.9 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00062 | Reg=0.00000 | L2-Norm=27.463 | L2-Norm(final)=2.560 | acc=1.0000 | 4491.0 samples/s | 70.2 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00056 | Reg=0.00000 | L2-Norm=27.464 | L2-Norm(final)=2.561 | acc=1.0000 | 4450.3 samples/s | 69.5 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00051 | Reg=0.00000 | L2-Norm=27.465 | L2-Norm(final)=2.562 | acc=1.0000 | 1861.2 samples/s | 29.1 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00046 | Reg=0.00000 | L2-Norm=27.466 | L2-Norm(final)=2.563 | acc=1.0000 | 4506.5 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15000.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22430 | acc=0.8339 | tpr=0.7632 | fpr=0.0126 | 4246.2 samples/s | 16.6 steps/s
Avg test loss: 0.22540, Avg test acc: 0.83168, Avg tpr: 0.76056, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.34386 | acc=0.9002 | tpr=0.9779 | fpr=0.1012 | 4112.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.36040 | acc=0.8960 | tpr=0.9872 | fpr=0.1057 | 8066.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.37176 | acc=0.8948 | tpr=0.9870 | fpr=0.1069 | 8112.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.37661 | acc=0.8942 | tpr=0.9858 | fpr=0.1075 | 8101.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.37139 | acc=0.8946 | tpr=0.9860 | fpr=0.1071 | 8082.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.37638 | acc=0.8941 | tpr=0.9855 | fpr=0.1076 | 8158.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.38018 | acc=0.8935 | tpr=0.9856 | fpr=0.1082 | 7705.7 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.38107 | acc=0.8936 | tpr=0.9830 | fpr=0.1080 | 8272.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.38630 | acc=0.8935 | tpr=0.9825 | fpr=0.1081 | 7918.8 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.38502 | acc=0.8937 | tpr=0.9824 | fpr=0.1079 | 8042.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.38293 | acc=0.8938 | tpr=0.9817 | fpr=0.1078 | 14686.5 samples/s | 57.4 steps/s
Avg test loss: 0.38237, Avg test acc: 0.89389, Avg tpr: 0.98138, Avg fpr: 0.10770, total FA: 14954

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=15001 Epoch=14.6] | Loss=0.14970 | Reg=0.00000 | L2-Norm=27.480 | L2-Norm(final)=2.577 | acc=0.9062 | 3668.9 samples/s | 57.3 steps/s
[Step=15050 Epoch=14.7] | Loss=0.03135 | Reg=0.00000 | L2-Norm=27.535 | L2-Norm(final)=2.574 | acc=1.0000 | 4535.2 samples/s | 70.9 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02427 | Reg=0.00000 | L2-Norm=27.557 | L2-Norm(final)=2.584 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02244 | Reg=0.00000 | L2-Norm=27.572 | L2-Norm(final)=2.590 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02171 | Reg=0.00000 | L2-Norm=27.584 | L2-Norm(final)=2.596 | acc=0.9688 | 4750.7 samples/s | 74.2 steps/s
[Step=15250 Epoch=14.9] | Loss=0.02075 | Reg=0.00000 | L2-Norm=27.595 | L2-Norm(final)=2.599 | acc=0.9844 | 4691.3 samples/s | 73.3 steps/s
[Step=15300 Epoch=14.9] | Loss=0.01961 | Reg=0.00000 | L2-Norm=27.607 | L2-Norm(final)=2.603 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=15350 Epoch=15.0] | Loss=0.01975 | Reg=0.00000 | L2-Norm=27.618 | L2-Norm(final)=2.606 | acc=0.9844 | 4714.8 samples/s | 73.7 steps/s
[Step=15400 Epoch=15.0] | Loss=0.01965 | Reg=0.00000 | L2-Norm=27.629 | L2-Norm(final)=2.608 | acc=0.9375 | 4753.2 samples/s | 74.3 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02003 | Reg=0.00000 | L2-Norm=27.642 | L2-Norm(final)=2.608 | acc=1.0000 | 4699.1 samples/s | 73.4 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02013 | Reg=0.00000 | L2-Norm=27.655 | L2-Norm(final)=2.609 | acc=0.9844 | 4716.7 samples/s | 73.7 steps/s
[Step=15550 Epoch=15.2] | Loss=0.01995 | Reg=0.00000 | L2-Norm=27.668 | L2-Norm(final)=2.610 | acc=0.9844 | 4680.7 samples/s | 73.1 steps/s
[Step=15600 Epoch=15.2] | Loss=0.01956 | Reg=0.00000 | L2-Norm=27.680 | L2-Norm(final)=2.611 | acc=0.9844 | 4760.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=15001 Epoch=28.3] | Loss=0.02321 | Reg=0.00000 | L2-Norm=27.480 | L2-Norm(final)=2.579 | acc=0.9688 | 3403.0 samples/s | 53.2 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00225 | Reg=0.00000 | L2-Norm=27.527 | L2-Norm(final)=2.586 | acc=1.0000 | 4279.6 samples/s | 66.9 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00114 | Reg=0.00000 | L2-Norm=27.541 | L2-Norm(final)=2.589 | acc=1.0000 | 4427.4 samples/s | 69.2 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00077 | Reg=0.00000 | L2-Norm=27.546 | L2-Norm(final)=2.590 | acc=1.0000 | 4480.5 samples/s | 70.0 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00058 | Reg=0.00000 | L2-Norm=27.549 | L2-Norm(final)=2.592 | acc=1.0000 | 4487.2 samples/s | 70.1 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00047 | Reg=0.00000 | L2-Norm=27.551 | L2-Norm(final)=2.594 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00039 | Reg=0.00000 | L2-Norm=27.553 | L2-Norm(final)=2.595 | acc=1.0000 | 4492.8 samples/s | 70.2 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00034 | Reg=0.00000 | L2-Norm=27.554 | L2-Norm(final)=2.596 | acc=1.0000 | 4570.6 samples/s | 71.4 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00030 | Reg=0.00000 | L2-Norm=27.555 | L2-Norm(final)=2.598 | acc=1.0000 | 4413.7 samples/s | 69.0 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00026 | Reg=0.00000 | L2-Norm=27.556 | L2-Norm(final)=2.599 | acc=1.0000 | 4507.2 samples/s | 70.4 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00024 | Reg=0.00000 | L2-Norm=27.557 | L2-Norm(final)=2.600 | acc=1.0000 | 4521.4 samples/s | 70.6 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00022 | Reg=0.00000 | L2-Norm=27.558 | L2-Norm(final)=2.601 | acc=1.0000 | 1896.7 samples/s | 29.6 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00020 | Reg=0.00000 | L2-Norm=27.559 | L2-Norm(final)=2.602 | acc=1.0000 | 4335.3 samples/s | 67.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15600.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17494 | acc=0.8812 | tpr=0.8326 | fpr=0.0134 | 4042.2 samples/s | 15.8 steps/s
Avg test loss: 0.17684, Avg test acc: 0.87956, Avg tpr: 0.83086, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.49202 | acc=0.8450 | tpr=0.9779 | fpr=0.1574 | 4134.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.51328 | acc=0.8416 | tpr=0.9829 | fpr=0.1611 | 7942.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.52548 | acc=0.8399 | tpr=0.9841 | fpr=0.1628 | 8201.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.53182 | acc=0.8388 | tpr=0.9836 | fpr=0.1638 | 8316.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.52735 | acc=0.8379 | tpr=0.9843 | fpr=0.1648 | 7869.1 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.53294 | acc=0.8375 | tpr=0.9840 | fpr=0.1652 | 8176.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.53779 | acc=0.8367 | tpr=0.9843 | fpr=0.1660 | 8091.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.53821 | acc=0.8368 | tpr=0.9830 | fpr=0.1658 | 8262.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.54417 | acc=0.8365 | tpr=0.9815 | fpr=0.1662 | 7852.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.54289 | acc=0.8365 | tpr=0.9819 | fpr=0.1661 | 7821.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.54012 | acc=0.8365 | tpr=0.9809 | fpr=0.1661 | 14519.8 samples/s | 56.7 steps/s
Avg test loss: 0.53936, Avg test acc: 0.83666, Avg tpr: 0.98059, Avg fpr: 0.16595, total FA: 23042

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=15601 Epoch=15.2] | Loss=0.11726 | Reg=0.00000 | L2-Norm=27.620 | L2-Norm(final)=2.617 | acc=0.8906 | 3591.4 samples/s | 56.1 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02717 | Reg=0.00000 | L2-Norm=27.660 | L2-Norm(final)=2.614 | acc=0.9688 | 4477.3 samples/s | 70.0 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02309 | Reg=0.00000 | L2-Norm=27.681 | L2-Norm(final)=2.617 | acc=0.9844 | 4735.0 samples/s | 74.0 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02145 | Reg=0.00000 | L2-Norm=27.697 | L2-Norm(final)=2.619 | acc=1.0000 | 4672.7 samples/s | 73.0 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02131 | Reg=0.00000 | L2-Norm=27.711 | L2-Norm(final)=2.622 | acc=0.9688 | 4703.5 samples/s | 73.5 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02134 | Reg=0.00000 | L2-Norm=27.725 | L2-Norm(final)=2.626 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02107 | Reg=0.00000 | L2-Norm=27.740 | L2-Norm(final)=2.628 | acc=0.9844 | 4671.1 samples/s | 73.0 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02062 | Reg=0.00000 | L2-Norm=27.754 | L2-Norm(final)=2.631 | acc=1.0000 | 4724.9 samples/s | 73.8 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01972 | Reg=0.00000 | L2-Norm=27.767 | L2-Norm(final)=2.634 | acc=1.0000 | 4724.9 samples/s | 73.8 steps/s
[Step=16050 Epoch=15.7] | Loss=0.01948 | Reg=0.00000 | L2-Norm=27.780 | L2-Norm(final)=2.637 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=16100 Epoch=15.7] | Loss=0.01917 | Reg=0.00000 | L2-Norm=27.793 | L2-Norm(final)=2.640 | acc=0.9688 | 4656.1 samples/s | 72.8 steps/s
[Step=16150 Epoch=15.8] | Loss=0.01952 | Reg=0.00000 | L2-Norm=27.804 | L2-Norm(final)=2.642 | acc=0.9844 | 4719.4 samples/s | 73.7 steps/s
[Step=16200 Epoch=15.8] | Loss=0.01943 | Reg=0.00000 | L2-Norm=27.816 | L2-Norm(final)=2.643 | acc=0.9844 | 4709.3 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=15601 Epoch=29.4] | Loss=0.09977 | Reg=0.00000 | L2-Norm=27.620 | L2-Norm(final)=2.617 | acc=0.9219 | 3319.0 samples/s | 51.9 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00461 | Reg=0.00000 | L2-Norm=27.728 | L2-Norm(final)=2.621 | acc=1.0000 | 4345.2 samples/s | 67.9 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00446 | Reg=0.00000 | L2-Norm=27.766 | L2-Norm(final)=2.624 | acc=1.0000 | 4411.3 samples/s | 68.9 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00369 | Reg=0.00000 | L2-Norm=27.808 | L2-Norm(final)=2.621 | acc=1.0000 | 4469.1 samples/s | 69.8 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00396 | Reg=0.00000 | L2-Norm=27.840 | L2-Norm(final)=2.616 | acc=0.9844 | 4473.4 samples/s | 69.9 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00360 | Reg=0.00000 | L2-Norm=27.869 | L2-Norm(final)=2.611 | acc=1.0000 | 4502.9 samples/s | 70.4 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00304 | Reg=0.00000 | L2-Norm=27.892 | L2-Norm(final)=2.607 | acc=1.0000 | 4470.3 samples/s | 69.8 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00266 | Reg=0.00000 | L2-Norm=27.910 | L2-Norm(final)=2.605 | acc=1.0000 | 4522.6 samples/s | 70.7 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00234 | Reg=0.00000 | L2-Norm=27.924 | L2-Norm(final)=2.604 | acc=1.0000 | 4439.6 samples/s | 69.4 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00208 | Reg=0.00000 | L2-Norm=27.935 | L2-Norm(final)=2.604 | acc=1.0000 | 4494.0 samples/s | 70.2 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00188 | Reg=0.00000 | L2-Norm=27.945 | L2-Norm(final)=2.604 | acc=1.0000 | 4527.1 samples/s | 70.7 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00171 | Reg=0.00000 | L2-Norm=27.952 | L2-Norm(final)=2.604 | acc=1.0000 | 1881.7 samples/s | 29.4 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00156 | Reg=0.00000 | L2-Norm=27.959 | L2-Norm(final)=2.604 | acc=1.0000 | 4480.0 samples/s | 70.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16200.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31974 | acc=0.7779 | tpr=0.6814 | fpr=0.0126 | 4090.6 samples/s | 16.0 steps/s
Avg test loss: 0.32371, Avg test acc: 0.77538, Avg tpr: 0.67896, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.35056 | acc=0.9198 | tpr=0.9779 | fpr=0.0813 | 4141.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.36600 | acc=0.9185 | tpr=0.9872 | fpr=0.0828 | 8570.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.37967 | acc=0.9166 | tpr=0.9870 | fpr=0.0847 | 7833.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.38408 | acc=0.9162 | tpr=0.9858 | fpr=0.0851 | 7842.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.37924 | acc=0.9157 | tpr=0.9860 | fpr=0.0856 | 8397.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.38525 | acc=0.9154 | tpr=0.9855 | fpr=0.0859 | 7996.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.38955 | acc=0.9149 | tpr=0.9850 | fpr=0.0864 | 7930.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.39061 | acc=0.9148 | tpr=0.9819 | fpr=0.0865 | 8306.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.39666 | acc=0.9143 | tpr=0.9815 | fpr=0.0869 | 8722.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.39525 | acc=0.9145 | tpr=0.9815 | fpr=0.0867 | 7334.1 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.39236 | acc=0.9146 | tpr=0.9801 | fpr=0.0866 | 14502.3 samples/s | 56.6 steps/s
Avg test loss: 0.39170, Avg test acc: 0.91473, Avg tpr: 0.98019, Avg fpr: 0.08646, total FA: 12005

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=16201 Epoch=15.8] | Loss=0.28427 | Reg=0.00000 | L2-Norm=27.850 | L2-Norm(final)=2.622 | acc=0.8594 | 4014.7 samples/s | 62.7 steps/s
[Step=16250 Epoch=15.9] | Loss=0.03914 | Reg=0.00000 | L2-Norm=27.936 | L2-Norm(final)=2.614 | acc=0.9844 | 4379.0 samples/s | 68.4 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02892 | Reg=0.00000 | L2-Norm=27.970 | L2-Norm(final)=2.623 | acc=0.9844 | 4630.7 samples/s | 72.4 steps/s
[Step=16350 Epoch=16.0] | Loss=0.02523 | Reg=0.00000 | L2-Norm=27.992 | L2-Norm(final)=2.630 | acc=1.0000 | 4724.4 samples/s | 73.8 steps/s
[Step=16400 Epoch=16.0] | Loss=0.02435 | Reg=0.00000 | L2-Norm=28.010 | L2-Norm(final)=2.635 | acc=1.0000 | 4750.3 samples/s | 74.2 steps/s
[Step=16450 Epoch=16.1] | Loss=0.02418 | Reg=0.00000 | L2-Norm=28.027 | L2-Norm(final)=2.636 | acc=0.9844 | 4634.5 samples/s | 72.4 steps/s
[Step=16500 Epoch=16.1] | Loss=0.02319 | Reg=0.00000 | L2-Norm=28.042 | L2-Norm(final)=2.637 | acc=0.9844 | 4703.6 samples/s | 73.5 steps/s
[Step=16550 Epoch=16.2] | Loss=0.02293 | Reg=0.00000 | L2-Norm=28.057 | L2-Norm(final)=2.639 | acc=0.9688 | 4734.5 samples/s | 74.0 steps/s
[Step=16600 Epoch=16.2] | Loss=0.02273 | Reg=0.00000 | L2-Norm=28.071 | L2-Norm(final)=2.641 | acc=1.0000 | 4733.5 samples/s | 74.0 steps/s
[Step=16650 Epoch=16.3] | Loss=0.02270 | Reg=0.00000 | L2-Norm=28.085 | L2-Norm(final)=2.643 | acc=0.9688 | 4710.9 samples/s | 73.6 steps/s
[Step=16700 Epoch=16.3] | Loss=0.02231 | Reg=0.00000 | L2-Norm=28.098 | L2-Norm(final)=2.644 | acc=0.9688 | 4766.3 samples/s | 74.5 steps/s
[Step=16750 Epoch=16.4] | Loss=0.02176 | Reg=0.00000 | L2-Norm=28.111 | L2-Norm(final)=2.645 | acc=0.9688 | 4800.0 samples/s | 75.0 steps/s
[Step=16800 Epoch=16.4] | Loss=0.02117 | Reg=0.00000 | L2-Norm=28.123 | L2-Norm(final)=2.647 | acc=1.0000 | 4664.8 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=16201 Epoch=30.5] | Loss=0.00475 | Reg=0.00000 | L2-Norm=27.850 | L2-Norm(final)=2.624 | acc=1.0000 | 3542.3 samples/s | 55.3 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00256 | Reg=0.00000 | L2-Norm=27.886 | L2-Norm(final)=2.626 | acc=1.0000 | 4298.0 samples/s | 67.2 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00140 | Reg=0.00000 | L2-Norm=27.899 | L2-Norm(final)=2.629 | acc=1.0000 | 4376.3 samples/s | 68.4 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00095 | Reg=0.00000 | L2-Norm=27.904 | L2-Norm(final)=2.631 | acc=1.0000 | 4486.1 samples/s | 70.1 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00072 | Reg=0.00000 | L2-Norm=27.907 | L2-Norm(final)=2.633 | acc=1.0000 | 4460.7 samples/s | 69.7 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00058 | Reg=0.00000 | L2-Norm=27.909 | L2-Norm(final)=2.634 | acc=1.0000 | 4496.8 samples/s | 70.3 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00048 | Reg=0.00000 | L2-Norm=27.910 | L2-Norm(final)=2.636 | acc=1.0000 | 4417.2 samples/s | 69.0 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00042 | Reg=0.00000 | L2-Norm=27.911 | L2-Norm(final)=2.637 | acc=1.0000 | 4530.4 samples/s | 70.8 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00037 | Reg=0.00000 | L2-Norm=27.912 | L2-Norm(final)=2.638 | acc=1.0000 | 4434.1 samples/s | 69.3 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00033 | Reg=0.00000 | L2-Norm=27.913 | L2-Norm(final)=2.639 | acc=1.0000 | 4410.5 samples/s | 68.9 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00029 | Reg=0.00000 | L2-Norm=27.914 | L2-Norm(final)=2.639 | acc=1.0000 | 4476.5 samples/s | 69.9 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00027 | Reg=0.00000 | L2-Norm=27.915 | L2-Norm(final)=2.640 | acc=1.0000 | 1896.0 samples/s | 29.6 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00025 | Reg=0.00000 | L2-Norm=27.916 | L2-Norm(final)=2.641 | acc=1.0000 | 4549.4 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18373 | acc=0.8642 | tpr=0.8081 | fpr=0.0139 | 4121.1 samples/s | 16.1 steps/s
Avg test loss: 0.18546, Avg test acc: 0.86253, Avg tpr: 0.80626, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.41758 | acc=0.8802 | tpr=0.9735 | fpr=0.1215 | 4144.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.43443 | acc=0.8781 | tpr=0.9829 | fpr=0.1238 | 8408.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.44807 | acc=0.8772 | tpr=0.9841 | fpr=0.1248 | 7918.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.45311 | acc=0.8761 | tpr=0.9836 | fpr=0.1259 | 8157.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.44765 | acc=0.8758 | tpr=0.9843 | fpr=0.1262 | 7873.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.45396 | acc=0.8757 | tpr=0.9840 | fpr=0.1263 | 8156.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.45861 | acc=0.8748 | tpr=0.9843 | fpr=0.1271 | 7961.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.46032 | acc=0.8746 | tpr=0.9825 | fpr=0.1273 | 8171.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.46683 | acc=0.8740 | tpr=0.9820 | fpr=0.1280 | 7970.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.46584 | acc=0.8740 | tpr=0.9819 | fpr=0.1280 | 8665.4 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.46268 | acc=0.8742 | tpr=0.9813 | fpr=0.1277 | 13092.4 samples/s | 51.1 steps/s
Avg test loss: 0.46195, Avg test acc: 0.87433, Avg tpr: 0.98098, Avg fpr: 0.12761, total FA: 17718

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=16801 Epoch=16.4] | Loss=0.05459 | Reg=0.00000 | L2-Norm=28.008 | L2-Norm(final)=2.651 | acc=0.9531 | 3888.5 samples/s | 60.8 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02696 | Reg=0.00000 | L2-Norm=28.058 | L2-Norm(final)=2.648 | acc=1.0000 | 4310.6 samples/s | 67.4 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02047 | Reg=0.00000 | L2-Norm=28.078 | L2-Norm(final)=2.657 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01898 | Reg=0.00000 | L2-Norm=28.090 | L2-Norm(final)=2.663 | acc=0.9844 | 4677.4 samples/s | 73.1 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01842 | Reg=0.00000 | L2-Norm=28.101 | L2-Norm(final)=2.670 | acc=0.9844 | 4681.6 samples/s | 73.1 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01789 | Reg=0.00000 | L2-Norm=28.111 | L2-Norm(final)=2.674 | acc=0.9844 | 4685.7 samples/s | 73.2 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01737 | Reg=0.00000 | L2-Norm=28.120 | L2-Norm(final)=2.678 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01705 | Reg=0.00000 | L2-Norm=28.129 | L2-Norm(final)=2.682 | acc=1.0000 | 4701.0 samples/s | 73.5 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01729 | Reg=0.00000 | L2-Norm=28.138 | L2-Norm(final)=2.685 | acc=1.0000 | 4762.3 samples/s | 74.4 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01747 | Reg=0.00000 | L2-Norm=28.147 | L2-Norm(final)=2.686 | acc=1.0000 | 4776.5 samples/s | 74.6 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01772 | Reg=0.00000 | L2-Norm=28.156 | L2-Norm(final)=2.687 | acc=0.9688 | 4682.5 samples/s | 73.2 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01753 | Reg=0.00000 | L2-Norm=28.165 | L2-Norm(final)=2.688 | acc=0.9844 | 4740.3 samples/s | 74.1 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01783 | Reg=0.00000 | L2-Norm=28.174 | L2-Norm(final)=2.688 | acc=0.9844 | 4754.2 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=16801 Epoch=31.7] | Loss=0.14505 | Reg=0.00000 | L2-Norm=28.008 | L2-Norm(final)=2.650 | acc=0.8906 | 3548.6 samples/s | 55.4 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00612 | Reg=0.00000 | L2-Norm=28.086 | L2-Norm(final)=2.645 | acc=1.0000 | 4098.9 samples/s | 64.0 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00515 | Reg=0.00000 | L2-Norm=28.116 | L2-Norm(final)=2.643 | acc=1.0000 | 4451.0 samples/s | 69.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00432 | Reg=0.00000 | L2-Norm=28.149 | L2-Norm(final)=2.639 | acc=0.9844 | 4445.6 samples/s | 69.5 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00334 | Reg=0.00000 | L2-Norm=28.174 | L2-Norm(final)=2.639 | acc=1.0000 | 4503.8 samples/s | 70.4 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00285 | Reg=0.00000 | L2-Norm=28.191 | L2-Norm(final)=2.640 | acc=1.0000 | 4428.1 samples/s | 69.2 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00244 | Reg=0.00000 | L2-Norm=28.204 | L2-Norm(final)=2.641 | acc=1.0000 | 4596.6 samples/s | 71.8 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00213 | Reg=0.00000 | L2-Norm=28.215 | L2-Norm(final)=2.642 | acc=1.0000 | 4412.9 samples/s | 69.0 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00196 | Reg=0.00000 | L2-Norm=28.224 | L2-Norm(final)=2.644 | acc=1.0000 | 4479.6 samples/s | 70.0 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00180 | Reg=0.00000 | L2-Norm=28.236 | L2-Norm(final)=2.646 | acc=1.0000 | 4470.8 samples/s | 69.9 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00163 | Reg=0.00000 | L2-Norm=28.248 | L2-Norm(final)=2.648 | acc=1.0000 | 4571.3 samples/s | 71.4 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00151 | Reg=0.00000 | L2-Norm=28.259 | L2-Norm(final)=2.650 | acc=1.0000 | 1878.0 samples/s | 29.3 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00139 | Reg=0.00000 | L2-Norm=28.268 | L2-Norm(final)=2.652 | acc=1.0000 | 4480.7 samples/s | 70.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17400.h5
Adjusting learning rate of group 0 to 5.6250e-04.
Adjusting learning rate of group 0 to 5.6250e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26084 | acc=0.8132 | tpr=0.7328 | fpr=0.0121 | 4130.9 samples/s | 16.1 steps/s
Avg test loss: 0.26030, Avg test acc: 0.81477, Avg tpr: 0.73579, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.38520 | acc=0.8900 | tpr=0.9823 | fpr=0.1117 | 4132.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.40182 | acc=0.8881 | tpr=0.9872 | fpr=0.1137 | 8069.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.41396 | acc=0.8872 | tpr=0.9885 | fpr=0.1146 | 8002.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.41928 | acc=0.8869 | tpr=0.9891 | fpr=0.1149 | 8242.9 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.41479 | acc=0.8869 | tpr=0.9886 | fpr=0.1149 | 8033.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.42054 | acc=0.8861 | tpr=0.9869 | fpr=0.1157 | 8151.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.42478 | acc=0.8856 | tpr=0.9869 | fpr=0.1162 | 8114.8 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.42611 | acc=0.8856 | tpr=0.9836 | fpr=0.1162 | 8415.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.43209 | acc=0.8850 | tpr=0.9834 | fpr=0.1168 | 7653.5 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.43124 | acc=0.8849 | tpr=0.9833 | fpr=0.1168 | 7874.9 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.42841 | acc=0.8851 | tpr=0.9825 | fpr=0.1167 | 14672.0 samples/s | 57.3 steps/s
Avg test loss: 0.42773, Avg test acc: 0.88512, Avg tpr: 0.98257, Avg fpr: 0.11665, total FA: 16197

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00056, len=1
[Step=17401 Epoch=17.0] | Loss=0.14879 | Reg=0.00000 | L2-Norm=28.204 | L2-Norm(final)=2.674 | acc=0.8906 | 3627.8 samples/s | 56.7 steps/s
[Step=17450 Epoch=17.0] | Loss=0.03423 | Reg=0.00000 | L2-Norm=28.265 | L2-Norm(final)=2.664 | acc=1.0000 | 4427.6 samples/s | 69.2 steps/s
[Step=17500 Epoch=17.1] | Loss=0.02541 | Reg=0.00000 | L2-Norm=28.286 | L2-Norm(final)=2.676 | acc=1.0000 | 4668.0 samples/s | 72.9 steps/s
[Step=17550 Epoch=17.1] | Loss=0.02341 | Reg=0.00000 | L2-Norm=28.300 | L2-Norm(final)=2.681 | acc=0.9844 | 4724.7 samples/s | 73.8 steps/s
[Step=17600 Epoch=17.2] | Loss=0.02108 | Reg=0.00000 | L2-Norm=28.314 | L2-Norm(final)=2.685 | acc=0.9844 | 4703.0 samples/s | 73.5 steps/s
[Step=17650 Epoch=17.2] | Loss=0.02084 | Reg=0.00000 | L2-Norm=28.327 | L2-Norm(final)=2.689 | acc=0.9844 | 4702.8 samples/s | 73.5 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02021 | Reg=0.00000 | L2-Norm=28.340 | L2-Norm(final)=2.692 | acc=0.9844 | 4706.4 samples/s | 73.5 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01983 | Reg=0.00000 | L2-Norm=28.352 | L2-Norm(final)=2.694 | acc=0.9531 | 4733.4 samples/s | 74.0 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01948 | Reg=0.00000 | L2-Norm=28.364 | L2-Norm(final)=2.697 | acc=0.9844 | 4736.4 samples/s | 74.0 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01925 | Reg=0.00000 | L2-Norm=28.376 | L2-Norm(final)=2.700 | acc=1.0000 | 4682.6 samples/s | 73.2 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01915 | Reg=0.00000 | L2-Norm=28.387 | L2-Norm(final)=2.702 | acc=1.0000 | 4754.8 samples/s | 74.3 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01891 | Reg=0.00000 | L2-Norm=28.399 | L2-Norm(final)=2.704 | acc=0.9688 | 4701.8 samples/s | 73.5 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01880 | Reg=0.00000 | L2-Norm=28.410 | L2-Norm(final)=2.706 | acc=1.0000 | 4705.6 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00056, len=1
[Step=17401 Epoch=32.8] | Loss=0.07575 | Reg=0.00000 | L2-Norm=28.204 | L2-Norm(final)=2.674 | acc=0.9531 | 3376.5 samples/s | 52.8 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00318 | Reg=0.00000 | L2-Norm=28.258 | L2-Norm(final)=2.670 | acc=1.0000 | 4326.5 samples/s | 67.6 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00184 | Reg=0.00000 | L2-Norm=28.278 | L2-Norm(final)=2.670 | acc=1.0000 | 4501.8 samples/s | 70.3 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00124 | Reg=0.00000 | L2-Norm=28.287 | L2-Norm(final)=2.670 | acc=1.0000 | 4442.6 samples/s | 69.4 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00094 | Reg=0.00000 | L2-Norm=28.292 | L2-Norm(final)=2.671 | acc=1.0000 | 4461.8 samples/s | 69.7 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00076 | Reg=0.00000 | L2-Norm=28.296 | L2-Norm(final)=2.672 | acc=1.0000 | 4507.6 samples/s | 70.4 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00065 | Reg=0.00000 | L2-Norm=28.298 | L2-Norm(final)=2.673 | acc=1.0000 | 4406.0 samples/s | 68.8 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00056 | Reg=0.00000 | L2-Norm=28.300 | L2-Norm(final)=2.674 | acc=1.0000 | 4453.4 samples/s | 69.6 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00049 | Reg=0.00000 | L2-Norm=28.301 | L2-Norm(final)=2.674 | acc=1.0000 | 4506.2 samples/s | 70.4 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00044 | Reg=0.00000 | L2-Norm=28.303 | L2-Norm(final)=2.675 | acc=1.0000 | 4425.9 samples/s | 69.2 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00039 | Reg=0.00000 | L2-Norm=28.304 | L2-Norm(final)=2.676 | acc=1.0000 | 4507.9 samples/s | 70.4 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00036 | Reg=0.00000 | L2-Norm=28.305 | L2-Norm(final)=2.676 | acc=1.0000 | 1844.1 samples/s | 28.8 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00033 | Reg=0.00000 | L2-Norm=28.305 | L2-Norm(final)=2.677 | acc=1.0000 | 4457.6 samples/s | 69.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18000.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25557 | acc=0.8223 | tpr=0.7451 | fpr=0.0099 | 4070.6 samples/s | 15.9 steps/s
Avg test loss: 0.25527, Avg test acc: 0.82078, Avg tpr: 0.74413, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.36813 | acc=0.9117 | tpr=0.9779 | fpr=0.0895 | 4187.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.38676 | acc=0.9084 | tpr=0.9872 | fpr=0.0930 | 7988.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.39980 | acc=0.9072 | tpr=0.9856 | fpr=0.0942 | 8095.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.40496 | acc=0.9070 | tpr=0.9869 | fpr=0.0944 | 8107.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.40003 | acc=0.9069 | tpr=0.9878 | fpr=0.0946 | 8152.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.40624 | acc=0.9065 | tpr=0.9862 | fpr=0.0950 | 8050.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.41094 | acc=0.9058 | tpr=0.9862 | fpr=0.0956 | 8093.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.41213 | acc=0.9060 | tpr=0.9836 | fpr=0.0954 | 8163.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.41898 | acc=0.9054 | tpr=0.9834 | fpr=0.0960 | 8005.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.41810 | acc=0.9053 | tpr=0.9833 | fpr=0.0961 | 7890.8 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.41487 | acc=0.9056 | tpr=0.9817 | fpr=0.0958 | 14179.3 samples/s | 55.4 steps/s
Avg test loss: 0.41426, Avg test acc: 0.90560, Avg tpr: 0.98138, Avg fpr: 0.09578, total FA: 13299

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=18001 Epoch=17.6] | Loss=0.24631 | Reg=0.00000 | L2-Norm=28.347 | L2-Norm(final)=2.697 | acc=0.8594 | 4030.5 samples/s | 63.0 steps/s
[Step=18050 Epoch=17.6] | Loss=0.03772 | Reg=0.00000 | L2-Norm=28.397 | L2-Norm(final)=2.682 | acc=0.9844 | 4235.9 samples/s | 66.2 steps/s
[Step=18100 Epoch=17.7] | Loss=0.02519 | Reg=0.00000 | L2-Norm=28.413 | L2-Norm(final)=2.690 | acc=1.0000 | 4662.7 samples/s | 72.9 steps/s
[Step=18150 Epoch=17.7] | Loss=0.02138 | Reg=0.00000 | L2-Norm=28.421 | L2-Norm(final)=2.696 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01973 | Reg=0.00000 | L2-Norm=28.427 | L2-Norm(final)=2.702 | acc=0.9531 | 4704.9 samples/s | 73.5 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01803 | Reg=0.00000 | L2-Norm=28.432 | L2-Norm(final)=2.707 | acc=0.9844 | 4732.1 samples/s | 73.9 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01741 | Reg=0.00000 | L2-Norm=28.436 | L2-Norm(final)=2.710 | acc=0.9844 | 4680.8 samples/s | 73.1 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01647 | Reg=0.00000 | L2-Norm=28.441 | L2-Norm(final)=2.712 | acc=1.0000 | 4713.1 samples/s | 73.6 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01637 | Reg=0.00000 | L2-Norm=28.446 | L2-Norm(final)=2.714 | acc=1.0000 | 4728.5 samples/s | 73.9 steps/s
[Step=18450 Epoch=18.0] | Loss=0.01609 | Reg=0.00000 | L2-Norm=28.451 | L2-Norm(final)=2.716 | acc=1.0000 | 4753.0 samples/s | 74.3 steps/s
[Step=18500 Epoch=18.1] | Loss=0.01572 | Reg=0.00000 | L2-Norm=28.455 | L2-Norm(final)=2.717 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01555 | Reg=0.00000 | L2-Norm=28.460 | L2-Norm(final)=2.719 | acc=0.9844 | 4738.4 samples/s | 74.0 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01548 | Reg=0.00000 | L2-Norm=28.464 | L2-Norm(final)=2.721 | acc=0.9844 | 4719.2 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=18001 Epoch=33.9] | Loss=0.04330 | Reg=0.00000 | L2-Norm=28.347 | L2-Norm(final)=2.698 | acc=0.9531 | 3730.1 samples/s | 58.3 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00415 | Reg=0.00000 | L2-Norm=28.380 | L2-Norm(final)=2.693 | acc=1.0000 | 4135.1 samples/s | 64.6 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00224 | Reg=0.00000 | L2-Norm=28.392 | L2-Norm(final)=2.695 | acc=1.0000 | 4419.6 samples/s | 69.1 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00151 | Reg=0.00000 | L2-Norm=28.398 | L2-Norm(final)=2.697 | acc=1.0000 | 4418.2 samples/s | 69.0 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00114 | Reg=0.00000 | L2-Norm=28.402 | L2-Norm(final)=2.699 | acc=1.0000 | 4476.3 samples/s | 69.9 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00091 | Reg=0.00000 | L2-Norm=28.405 | L2-Norm(final)=2.700 | acc=1.0000 | 4385.2 samples/s | 68.5 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00076 | Reg=0.00000 | L2-Norm=28.406 | L2-Norm(final)=2.701 | acc=1.0000 | 4450.9 samples/s | 69.5 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00066 | Reg=0.00000 | L2-Norm=28.408 | L2-Norm(final)=2.702 | acc=1.0000 | 4386.7 samples/s | 68.5 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00058 | Reg=0.00000 | L2-Norm=28.409 | L2-Norm(final)=2.703 | acc=1.0000 | 4459.9 samples/s | 69.7 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00052 | Reg=0.00000 | L2-Norm=28.410 | L2-Norm(final)=2.704 | acc=1.0000 | 4457.7 samples/s | 69.7 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00046 | Reg=0.00000 | L2-Norm=28.411 | L2-Norm(final)=2.705 | acc=1.0000 | 4473.1 samples/s | 69.9 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00042 | Reg=0.00000 | L2-Norm=28.412 | L2-Norm(final)=2.705 | acc=1.0000 | 1870.0 samples/s | 29.2 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00039 | Reg=0.00000 | L2-Norm=28.412 | L2-Norm(final)=2.706 | acc=1.0000 | 4546.1 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18600.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15167 | acc=0.8904 | tpr=0.8462 | fpr=0.0136 | 4143.5 samples/s | 16.2 steps/s
Avg test loss: 0.15299, Avg test acc: 0.88857, Avg tpr: 0.84380, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.44911 | acc=0.8798 | tpr=0.9690 | fpr=0.1218 | 4143.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.46765 | acc=0.8773 | tpr=0.9829 | fpr=0.1246 | 8226.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.48143 | acc=0.8755 | tpr=0.9827 | fpr=0.1265 | 8082.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.48663 | acc=0.8756 | tpr=0.9847 | fpr=0.1263 | 8326.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.48051 | acc=0.8758 | tpr=0.9860 | fpr=0.1262 | 7732.7 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.48716 | acc=0.8756 | tpr=0.9855 | fpr=0.1264 | 8255.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.49160 | acc=0.8747 | tpr=0.9856 | fpr=0.1273 | 7826.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.49260 | acc=0.8748 | tpr=0.9825 | fpr=0.1271 | 8311.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.49899 | acc=0.8745 | tpr=0.9820 | fpr=0.1274 | 7869.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.49815 | acc=0.8746 | tpr=0.9824 | fpr=0.1274 | 7907.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.49472 | acc=0.8747 | tpr=0.9809 | fpr=0.1272 | 14660.7 samples/s | 57.3 steps/s
Avg test loss: 0.49398, Avg test acc: 0.87481, Avg tpr: 0.98059, Avg fpr: 0.12712, total FA: 17650

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=18601 Epoch=18.2] | Loss=0.05302 | Reg=0.00000 | L2-Norm=28.425 | L2-Norm(final)=2.720 | acc=0.9531 | 3907.8 samples/s | 61.1 steps/s
[Step=18650 Epoch=18.2] | Loss=0.02176 | Reg=0.00000 | L2-Norm=28.455 | L2-Norm(final)=2.725 | acc=0.9844 | 4172.3 samples/s | 65.2 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01711 | Reg=0.00000 | L2-Norm=28.467 | L2-Norm(final)=2.731 | acc=0.9844 | 4706.6 samples/s | 73.5 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01488 | Reg=0.00000 | L2-Norm=28.476 | L2-Norm(final)=2.737 | acc=1.0000 | 4720.4 samples/s | 73.8 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01455 | Reg=0.00000 | L2-Norm=28.482 | L2-Norm(final)=2.741 | acc=1.0000 | 4668.4 samples/s | 72.9 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01428 | Reg=0.00000 | L2-Norm=28.487 | L2-Norm(final)=2.743 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01360 | Reg=0.00000 | L2-Norm=28.493 | L2-Norm(final)=2.746 | acc=1.0000 | 4741.8 samples/s | 74.1 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01391 | Reg=0.00000 | L2-Norm=28.498 | L2-Norm(final)=2.749 | acc=1.0000 | 4795.8 samples/s | 74.9 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01384 | Reg=0.00000 | L2-Norm=28.503 | L2-Norm(final)=2.751 | acc=1.0000 | 4722.2 samples/s | 73.8 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01379 | Reg=0.00000 | L2-Norm=28.508 | L2-Norm(final)=2.752 | acc=0.9844 | 4655.7 samples/s | 72.7 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01410 | Reg=0.00000 | L2-Norm=28.513 | L2-Norm(final)=2.753 | acc=1.0000 | 4712.8 samples/s | 73.6 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01423 | Reg=0.00000 | L2-Norm=28.519 | L2-Norm(final)=2.754 | acc=1.0000 | 4754.1 samples/s | 74.3 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01414 | Reg=0.00000 | L2-Norm=28.526 | L2-Norm(final)=2.755 | acc=1.0000 | 4713.4 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=18601 Epoch=35.1] | Loss=0.07432 | Reg=0.00000 | L2-Norm=28.425 | L2-Norm(final)=2.720 | acc=0.9688 | 3872.1 samples/s | 60.5 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00307 | Reg=0.00000 | L2-Norm=28.473 | L2-Norm(final)=2.729 | acc=1.0000 | 3960.2 samples/s | 61.9 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00160 | Reg=0.00000 | L2-Norm=28.487 | L2-Norm(final)=2.731 | acc=1.0000 | 4422.2 samples/s | 69.1 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00109 | Reg=0.00000 | L2-Norm=28.493 | L2-Norm(final)=2.733 | acc=1.0000 | 4531.2 samples/s | 70.8 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00091 | Reg=0.00000 | L2-Norm=28.499 | L2-Norm(final)=2.735 | acc=1.0000 | 4457.2 samples/s | 69.6 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00074 | Reg=0.00000 | L2-Norm=28.504 | L2-Norm(final)=2.737 | acc=1.0000 | 4432.1 samples/s | 69.3 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00062 | Reg=0.00000 | L2-Norm=28.507 | L2-Norm(final)=2.739 | acc=1.0000 | 4491.5 samples/s | 70.2 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00053 | Reg=0.00000 | L2-Norm=28.510 | L2-Norm(final)=2.740 | acc=1.0000 | 4517.2 samples/s | 70.6 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00047 | Reg=0.00000 | L2-Norm=28.512 | L2-Norm(final)=2.741 | acc=1.0000 | 4416.9 samples/s | 69.0 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00041 | Reg=0.00000 | L2-Norm=28.514 | L2-Norm(final)=2.742 | acc=1.0000 | 4470.4 samples/s | 69.8 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00037 | Reg=0.00000 | L2-Norm=28.516 | L2-Norm(final)=2.743 | acc=1.0000 | 4555.7 samples/s | 71.2 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00034 | Reg=0.00000 | L2-Norm=28.517 | L2-Norm(final)=2.744 | acc=1.0000 | 1850.1 samples/s | 28.9 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00031 | Reg=0.00000 | L2-Norm=28.519 | L2-Norm(final)=2.745 | acc=1.0000 | 4474.0 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22723 | acc=0.8514 | tpr=0.7882 | fpr=0.0114 | 4152.6 samples/s | 16.2 steps/s
Avg test loss: 0.22918, Avg test acc: 0.85027, Avg tpr: 0.78743, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.46497 | acc=0.8958 | tpr=0.9690 | fpr=0.1055 | 4128.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.48621 | acc=0.8921 | tpr=0.9829 | fpr=0.1096 | 8216.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.50097 | acc=0.8903 | tpr=0.9841 | fpr=0.1114 | 8237.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.50811 | acc=0.8903 | tpr=0.9858 | fpr=0.1114 | 7677.2 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.50143 | acc=0.8901 | tpr=0.9869 | fpr=0.1117 | 7996.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.50880 | acc=0.8896 | tpr=0.9869 | fpr=0.1121 | 8004.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.51387 | acc=0.8887 | tpr=0.9869 | fpr=0.1130 | 8215.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.51492 | acc=0.8887 | tpr=0.9836 | fpr=0.1130 | 8163.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.52226 | acc=0.8882 | tpr=0.9830 | fpr=0.1136 | 8099.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.52081 | acc=0.8881 | tpr=0.9833 | fpr=0.1136 | 7660.1 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.51717 | acc=0.8881 | tpr=0.9809 | fpr=0.1136 | 14942.8 samples/s | 58.4 steps/s
Avg test loss: 0.51652, Avg test acc: 0.88808, Avg tpr: 0.98059, Avg fpr: 0.11361, total FA: 15774

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=19201 Epoch=18.7] | Loss=0.07406 | Reg=0.00000 | L2-Norm=28.512 | L2-Norm(final)=2.759 | acc=0.9375 | 3650.5 samples/s | 57.0 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02080 | Reg=0.00000 | L2-Norm=28.550 | L2-Norm(final)=2.755 | acc=0.9844 | 4456.7 samples/s | 69.6 steps/s
[Step=19300 Epoch=18.8] | Loss=0.01866 | Reg=0.00000 | L2-Norm=28.564 | L2-Norm(final)=2.760 | acc=0.9688 | 4695.8 samples/s | 73.4 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01765 | Reg=0.00000 | L2-Norm=28.573 | L2-Norm(final)=2.762 | acc=0.9844 | 4725.9 samples/s | 73.8 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01610 | Reg=0.00000 | L2-Norm=28.580 | L2-Norm(final)=2.763 | acc=1.0000 | 4683.8 samples/s | 73.2 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01599 | Reg=0.00000 | L2-Norm=28.586 | L2-Norm(final)=2.765 | acc=1.0000 | 4679.1 samples/s | 73.1 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01574 | Reg=0.00000 | L2-Norm=28.592 | L2-Norm(final)=2.766 | acc=0.9844 | 4721.0 samples/s | 73.8 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01530 | Reg=0.00000 | L2-Norm=28.597 | L2-Norm(final)=2.767 | acc=1.0000 | 4719.1 samples/s | 73.7 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01519 | Reg=0.00000 | L2-Norm=28.602 | L2-Norm(final)=2.768 | acc=0.9844 | 4730.9 samples/s | 73.9 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01478 | Reg=0.00000 | L2-Norm=28.607 | L2-Norm(final)=2.770 | acc=0.9844 | 4709.2 samples/s | 73.6 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01505 | Reg=0.00000 | L2-Norm=28.613 | L2-Norm(final)=2.772 | acc=0.9844 | 4747.8 samples/s | 74.2 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01524 | Reg=0.00000 | L2-Norm=28.619 | L2-Norm(final)=2.774 | acc=1.0000 | 4688.9 samples/s | 73.3 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01507 | Reg=0.00000 | L2-Norm=28.626 | L2-Norm(final)=2.775 | acc=1.0000 | 4747.9 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=19201 Epoch=36.2] | Loss=0.03107 | Reg=0.00000 | L2-Norm=28.512 | L2-Norm(final)=2.760 | acc=0.9844 | 4846.0 samples/s | 75.7 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00689 | Reg=0.00000 | L2-Norm=28.578 | L2-Norm(final)=2.742 | acc=1.0000 | 3266.7 samples/s | 51.0 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00358 | Reg=0.00000 | L2-Norm=28.604 | L2-Norm(final)=2.743 | acc=1.0000 | 4467.3 samples/s | 69.8 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00240 | Reg=0.00000 | L2-Norm=28.614 | L2-Norm(final)=2.744 | acc=1.0000 | 4486.4 samples/s | 70.1 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00180 | Reg=0.00000 | L2-Norm=28.619 | L2-Norm(final)=2.746 | acc=1.0000 | 4419.0 samples/s | 69.0 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00146 | Reg=0.00000 | L2-Norm=28.623 | L2-Norm(final)=2.747 | acc=1.0000 | 4535.9 samples/s | 70.9 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00122 | Reg=0.00000 | L2-Norm=28.625 | L2-Norm(final)=2.748 | acc=1.0000 | 4457.6 samples/s | 69.6 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00107 | Reg=0.00000 | L2-Norm=28.628 | L2-Norm(final)=2.749 | acc=1.0000 | 4451.4 samples/s | 69.6 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00095 | Reg=0.00000 | L2-Norm=28.630 | L2-Norm(final)=2.750 | acc=1.0000 | 4471.1 samples/s | 69.9 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00084 | Reg=0.00000 | L2-Norm=28.631 | L2-Norm(final)=2.751 | acc=1.0000 | 4546.4 samples/s | 71.0 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00076 | Reg=0.00000 | L2-Norm=28.632 | L2-Norm(final)=2.751 | acc=1.0000 | 4512.9 samples/s | 70.5 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00069 | Reg=0.00000 | L2-Norm=28.633 | L2-Norm(final)=2.752 | acc=1.0000 | 1845.0 samples/s | 28.8 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00063 | Reg=0.00000 | L2-Norm=28.634 | L2-Norm(final)=2.753 | acc=1.0000 | 4581.5 samples/s | 71.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19800.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18362 | acc=0.8706 | tpr=0.8174 | fpr=0.0139 | 4143.6 samples/s | 16.2 steps/s
Avg test loss: 0.18672, Avg test acc: 0.86722, Avg tpr: 0.81302, Avg fpr: 0.01359, total FA: 106

Testing server on iccad2012
[Step=  50] | Loss=0.48734 | acc=0.8700 | tpr=0.9779 | fpr=0.1319 | 4187.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.51376 | acc=0.8677 | tpr=0.9851 | fpr=0.1345 | 7797.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.52787 | acc=0.8667 | tpr=0.9870 | fpr=0.1355 | 8215.0 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.53475 | acc=0.8663 | tpr=0.9869 | fpr=0.1359 | 7981.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.52989 | acc=0.8664 | tpr=0.9878 | fpr=0.1359 | 7957.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.53661 | acc=0.8662 | tpr=0.9869 | fpr=0.1360 | 8135.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.54183 | acc=0.8656 | tpr=0.9869 | fpr=0.1366 | 7858.5 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.54347 | acc=0.8656 | tpr=0.9836 | fpr=0.1366 | 8022.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.55081 | acc=0.8654 | tpr=0.9834 | fpr=0.1367 | 8256.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.54957 | acc=0.8655 | tpr=0.9837 | fpr=0.1367 | 7812.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.54619 | acc=0.8656 | tpr=0.9821 | fpr=0.1365 | 14276.6 samples/s | 55.8 steps/s
Avg test loss: 0.54530, Avg test acc: 0.86567, Avg tpr: 0.98217, Avg fpr: 0.13645, total FA: 18946

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=19801 Epoch=19.3] | Loss=0.09167 | Reg=0.00000 | L2-Norm=28.610 | L2-Norm(final)=2.768 | acc=0.9219 | 3916.4 samples/s | 61.2 steps/s
[Step=19850 Epoch=19.4] | Loss=0.02442 | Reg=0.00000 | L2-Norm=28.650 | L2-Norm(final)=2.773 | acc=0.9531 | 4268.1 samples/s | 66.7 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01937 | Reg=0.00000 | L2-Norm=28.664 | L2-Norm(final)=2.775 | acc=0.9688 | 4651.5 samples/s | 72.7 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01696 | Reg=0.00000 | L2-Norm=28.672 | L2-Norm(final)=2.779 | acc=0.9688 | 4679.1 samples/s | 73.1 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01598 | Reg=0.00000 | L2-Norm=28.680 | L2-Norm(final)=2.783 | acc=1.0000 | 4722.7 samples/s | 73.8 steps/s
[Step=20050 Epoch=19.6] | Loss=0.01530 | Reg=0.00000 | L2-Norm=28.687 | L2-Norm(final)=2.787 | acc=0.9844 | 4664.2 samples/s | 72.9 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01548 | Reg=0.00000 | L2-Norm=28.694 | L2-Norm(final)=2.790 | acc=0.9531 | 4710.4 samples/s | 73.6 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01507 | Reg=0.00000 | L2-Norm=28.700 | L2-Norm(final)=2.792 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01484 | Reg=0.00000 | L2-Norm=28.707 | L2-Norm(final)=2.794 | acc=0.9531 | 4695.8 samples/s | 73.4 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01424 | Reg=0.00000 | L2-Norm=28.714 | L2-Norm(final)=2.797 | acc=1.0000 | 4717.9 samples/s | 73.7 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01415 | Reg=0.00000 | L2-Norm=28.720 | L2-Norm(final)=2.799 | acc=0.9844 | 4735.2 samples/s | 74.0 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01413 | Reg=0.00000 | L2-Norm=28.727 | L2-Norm(final)=2.802 | acc=1.0000 | 4731.5 samples/s | 73.9 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01407 | Reg=0.00000 | L2-Norm=28.735 | L2-Norm(final)=2.804 | acc=1.0000 | 4716.0 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=19801 Epoch=37.3] | Loss=0.03861 | Reg=0.00000 | L2-Norm=28.610 | L2-Norm(final)=2.769 | acc=0.9531 | 3619.6 samples/s | 56.6 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00534 | Reg=0.00000 | L2-Norm=28.681 | L2-Norm(final)=2.764 | acc=0.9688 | 4123.7 samples/s | 64.4 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00306 | Reg=0.00000 | L2-Norm=28.710 | L2-Norm(final)=2.762 | acc=1.0000 | 4413.6 samples/s | 69.0 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00253 | Reg=0.00000 | L2-Norm=28.726 | L2-Norm(final)=2.759 | acc=1.0000 | 4450.0 samples/s | 69.5 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00193 | Reg=0.00000 | L2-Norm=28.736 | L2-Norm(final)=2.758 | acc=1.0000 | 4346.5 samples/s | 67.9 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00157 | Reg=0.00000 | L2-Norm=28.742 | L2-Norm(final)=2.758 | acc=1.0000 | 4424.1 samples/s | 69.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00131 | Reg=0.00000 | L2-Norm=28.747 | L2-Norm(final)=2.759 | acc=1.0000 | 4454.0 samples/s | 69.6 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00113 | Reg=0.00000 | L2-Norm=28.751 | L2-Norm(final)=2.761 | acc=1.0000 | 4457.2 samples/s | 69.6 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00099 | Reg=0.00000 | L2-Norm=28.754 | L2-Norm(final)=2.761 | acc=1.0000 | 4477.9 samples/s | 70.0 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00088 | Reg=0.00000 | L2-Norm=28.756 | L2-Norm(final)=2.762 | acc=1.0000 | 4498.8 samples/s | 70.3 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00079 | Reg=0.00000 | L2-Norm=28.758 | L2-Norm(final)=2.763 | acc=1.0000 | 4530.4 samples/s | 70.8 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00072 | Reg=0.00000 | L2-Norm=28.760 | L2-Norm(final)=2.764 | acc=1.0000 | 1900.8 samples/s | 29.7 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00066 | Reg=0.00000 | L2-Norm=28.762 | L2-Norm(final)=2.765 | acc=1.0000 | 4512.4 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20400.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30323 | acc=0.8021 | tpr=0.7150 | fpr=0.0087 | 4144.9 samples/s | 16.2 steps/s
Avg test loss: 0.30586, Avg test acc: 0.80159, Avg tpr: 0.71516, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.41477 | acc=0.9159 | tpr=0.9779 | fpr=0.0853 | 4131.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.44060 | acc=0.9133 | tpr=0.9829 | fpr=0.0880 | 8207.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.45708 | acc=0.9123 | tpr=0.9841 | fpr=0.0890 | 8328.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.46242 | acc=0.9126 | tpr=0.9847 | fpr=0.0887 | 7696.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.45771 | acc=0.9122 | tpr=0.9860 | fpr=0.0892 | 7977.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.46585 | acc=0.9117 | tpr=0.9855 | fpr=0.0896 | 8179.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.47038 | acc=0.9114 | tpr=0.9856 | fpr=0.0899 | 8078.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.47266 | acc=0.9113 | tpr=0.9825 | fpr=0.0900 | 8047.1 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.47976 | acc=0.9107 | tpr=0.9820 | fpr=0.0906 | 8097.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.47838 | acc=0.9106 | tpr=0.9824 | fpr=0.0907 | 8069.8 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.47489 | acc=0.9109 | tpr=0.9805 | fpr=0.0904 | 13644.0 samples/s | 53.3 steps/s
Avg test loss: 0.47421, Avg test acc: 0.91096, Avg tpr: 0.98019, Avg fpr: 0.09030, total FA: 12538

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=20401 Epoch=19.9] | Loss=0.18906 | Reg=0.00000 | L2-Norm=28.727 | L2-Norm(final)=2.796 | acc=0.8125 | 3633.5 samples/s | 56.8 steps/s
[Step=20450 Epoch=20.0] | Loss=0.02784 | Reg=0.00000 | L2-Norm=28.776 | L2-Norm(final)=2.788 | acc=1.0000 | 4634.6 samples/s | 72.4 steps/s
[Step=20500 Epoch=20.0] | Loss=0.02214 | Reg=0.00000 | L2-Norm=28.794 | L2-Norm(final)=2.795 | acc=1.0000 | 4629.2 samples/s | 72.3 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01916 | Reg=0.00000 | L2-Norm=28.804 | L2-Norm(final)=2.800 | acc=0.9688 | 4685.6 samples/s | 73.2 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01684 | Reg=0.00000 | L2-Norm=28.812 | L2-Norm(final)=2.807 | acc=1.0000 | 4744.5 samples/s | 74.1 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01627 | Reg=0.00000 | L2-Norm=28.819 | L2-Norm(final)=2.811 | acc=1.0000 | 4654.9 samples/s | 72.7 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01566 | Reg=0.00000 | L2-Norm=28.826 | L2-Norm(final)=2.814 | acc=0.9844 | 4746.4 samples/s | 74.2 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01555 | Reg=0.00000 | L2-Norm=28.832 | L2-Norm(final)=2.816 | acc=0.9844 | 4738.4 samples/s | 74.0 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01514 | Reg=0.00000 | L2-Norm=28.839 | L2-Norm(final)=2.818 | acc=1.0000 | 4722.5 samples/s | 73.8 steps/s
[Step=20850 Epoch=20.4] | Loss=0.01535 | Reg=0.00000 | L2-Norm=28.846 | L2-Norm(final)=2.819 | acc=1.0000 | 4780.7 samples/s | 74.7 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01500 | Reg=0.00000 | L2-Norm=28.853 | L2-Norm(final)=2.820 | acc=0.9844 | 4691.9 samples/s | 73.3 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01534 | Reg=0.00000 | L2-Norm=28.860 | L2-Norm(final)=2.822 | acc=0.9531 | 4671.0 samples/s | 73.0 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01509 | Reg=0.00000 | L2-Norm=28.867 | L2-Norm(final)=2.823 | acc=0.9844 | 4755.0 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=20401 Epoch=38.5] | Loss=0.00306 | Reg=0.00000 | L2-Norm=28.727 | L2-Norm(final)=2.797 | acc=1.0000 | 3409.6 samples/s | 53.3 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00654 | Reg=0.00000 | L2-Norm=28.790 | L2-Norm(final)=2.789 | acc=1.0000 | 4344.8 samples/s | 67.9 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00409 | Reg=0.00000 | L2-Norm=28.810 | L2-Norm(final)=2.789 | acc=1.0000 | 4422.0 samples/s | 69.1 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00276 | Reg=0.00000 | L2-Norm=28.821 | L2-Norm(final)=2.787 | acc=1.0000 | 4441.3 samples/s | 69.4 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00208 | Reg=0.00000 | L2-Norm=28.827 | L2-Norm(final)=2.787 | acc=1.0000 | 4444.5 samples/s | 69.4 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00167 | Reg=0.00000 | L2-Norm=28.832 | L2-Norm(final)=2.788 | acc=1.0000 | 4471.0 samples/s | 69.9 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00139 | Reg=0.00000 | L2-Norm=28.835 | L2-Norm(final)=2.788 | acc=1.0000 | 4386.4 samples/s | 68.5 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00120 | Reg=0.00000 | L2-Norm=28.837 | L2-Norm(final)=2.788 | acc=1.0000 | 4377.4 samples/s | 68.4 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00105 | Reg=0.00000 | L2-Norm=28.839 | L2-Norm(final)=2.789 | acc=1.0000 | 4435.5 samples/s | 69.3 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00093 | Reg=0.00000 | L2-Norm=28.841 | L2-Norm(final)=2.789 | acc=1.0000 | 4432.7 samples/s | 69.3 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00084 | Reg=0.00000 | L2-Norm=28.842 | L2-Norm(final)=2.790 | acc=1.0000 | 4526.3 samples/s | 70.7 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00076 | Reg=0.00000 | L2-Norm=28.843 | L2-Norm(final)=2.790 | acc=1.0000 | 1881.8 samples/s | 29.4 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00070 | Reg=0.00000 | L2-Norm=28.844 | L2-Norm(final)=2.790 | acc=1.0000 | 4500.1 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21000.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20489 | acc=0.8547 | tpr=0.7932 | fpr=0.0119 | 4108.6 samples/s | 16.0 steps/s
Avg test loss: 0.20792, Avg test acc: 0.85279, Avg tpr: 0.79076, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.43852 | acc=0.8962 | tpr=0.9823 | fpr=0.1053 | 4131.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.46127 | acc=0.8931 | tpr=0.9829 | fpr=0.1086 | 7947.5 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.47853 | acc=0.8909 | tpr=0.9827 | fpr=0.1108 | 7951.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.48581 | acc=0.8905 | tpr=0.9836 | fpr=0.1112 | 8037.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.48215 | acc=0.8904 | tpr=0.9843 | fpr=0.1113 | 8263.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.48877 | acc=0.8905 | tpr=0.9840 | fpr=0.1112 | 8140.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.49301 | acc=0.8902 | tpr=0.9837 | fpr=0.1115 | 7875.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.49495 | acc=0.8898 | tpr=0.9809 | fpr=0.1118 | 8189.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.50161 | acc=0.8895 | tpr=0.9810 | fpr=0.1121 | 8050.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.50033 | acc=0.8895 | tpr=0.9815 | fpr=0.1121 | 7809.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.49685 | acc=0.8897 | tpr=0.9805 | fpr=0.1120 | 14896.4 samples/s | 58.2 steps/s
Avg test loss: 0.49605, Avg test acc: 0.88971, Avg tpr: 0.98019, Avg fpr: 0.11194, total FA: 15542

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=21001 Epoch=20.5] | Loss=0.11667 | Reg=0.00000 | L2-Norm=28.834 | L2-Norm(final)=2.810 | acc=0.8594 | 3879.8 samples/s | 60.6 steps/s
[Step=21050 Epoch=20.6] | Loss=0.02676 | Reg=0.00000 | L2-Norm=28.872 | L2-Norm(final)=2.812 | acc=1.0000 | 4286.7 samples/s | 67.0 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01959 | Reg=0.00000 | L2-Norm=28.887 | L2-Norm(final)=2.820 | acc=0.9844 | 4701.6 samples/s | 73.5 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01725 | Reg=0.00000 | L2-Norm=28.896 | L2-Norm(final)=2.826 | acc=1.0000 | 4676.9 samples/s | 73.1 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01647 | Reg=0.00000 | L2-Norm=28.902 | L2-Norm(final)=2.830 | acc=1.0000 | 4713.0 samples/s | 73.6 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01583 | Reg=0.00000 | L2-Norm=28.908 | L2-Norm(final)=2.833 | acc=0.9844 | 4712.5 samples/s | 73.6 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01485 | Reg=0.00000 | L2-Norm=28.914 | L2-Norm(final)=2.836 | acc=0.9688 | 4691.9 samples/s | 73.3 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01453 | Reg=0.00000 | L2-Norm=28.920 | L2-Norm(final)=2.840 | acc=1.0000 | 4673.4 samples/s | 73.0 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01425 | Reg=0.00000 | L2-Norm=28.925 | L2-Norm(final)=2.843 | acc=0.9844 | 4758.6 samples/s | 74.4 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01413 | Reg=0.00000 | L2-Norm=28.931 | L2-Norm(final)=2.846 | acc=0.9688 | 4712.7 samples/s | 73.6 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01397 | Reg=0.00000 | L2-Norm=28.937 | L2-Norm(final)=2.849 | acc=1.0000 | 4756.8 samples/s | 74.3 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01451 | Reg=0.00000 | L2-Norm=28.944 | L2-Norm(final)=2.850 | acc=1.0000 | 4699.1 samples/s | 73.4 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01425 | Reg=0.00000 | L2-Norm=28.950 | L2-Norm(final)=2.852 | acc=0.9844 | 4729.2 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=21001 Epoch=39.6] | Loss=0.06226 | Reg=0.00000 | L2-Norm=28.834 | L2-Norm(final)=2.811 | acc=0.9375 | 3417.9 samples/s | 53.4 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00259 | Reg=0.00000 | L2-Norm=28.872 | L2-Norm(final)=2.819 | acc=1.0000 | 4259.7 samples/s | 66.6 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00145 | Reg=0.00000 | L2-Norm=28.883 | L2-Norm(final)=2.821 | acc=1.0000 | 4450.0 samples/s | 69.5 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00098 | Reg=0.00000 | L2-Norm=28.890 | L2-Norm(final)=2.823 | acc=1.0000 | 4468.1 samples/s | 69.8 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00074 | Reg=0.00000 | L2-Norm=28.894 | L2-Norm(final)=2.824 | acc=1.0000 | 4437.9 samples/s | 69.3 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00060 | Reg=0.00000 | L2-Norm=28.896 | L2-Norm(final)=2.825 | acc=1.0000 | 4430.8 samples/s | 69.2 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00050 | Reg=0.00000 | L2-Norm=28.898 | L2-Norm(final)=2.826 | acc=1.0000 | 4494.6 samples/s | 70.2 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00043 | Reg=0.00000 | L2-Norm=28.899 | L2-Norm(final)=2.827 | acc=1.0000 | 4420.6 samples/s | 69.1 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00037 | Reg=0.00000 | L2-Norm=28.899 | L2-Norm(final)=2.827 | acc=1.0000 | 4477.1 samples/s | 70.0 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00033 | Reg=0.00000 | L2-Norm=28.900 | L2-Norm(final)=2.828 | acc=1.0000 | 4462.4 samples/s | 69.7 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00030 | Reg=0.00000 | L2-Norm=28.901 | L2-Norm(final)=2.828 | acc=1.0000 | 4536.8 samples/s | 70.9 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00027 | Reg=0.00000 | L2-Norm=28.901 | L2-Norm(final)=2.829 | acc=1.0000 | 1915.4 samples/s | 29.9 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00025 | Reg=0.00000 | L2-Norm=28.901 | L2-Norm(final)=2.829 | acc=1.0000 | 4515.7 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19903 | acc=0.8669 | tpr=0.8112 | fpr=0.0121 | 4081.3 samples/s | 15.9 steps/s
Avg test loss: 0.20062, Avg test acc: 0.86529, Avg tpr: 0.80958, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.47816 | acc=0.9020 | tpr=0.9779 | fpr=0.0993 | 4144.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.50075 | acc=0.8997 | tpr=0.9808 | fpr=0.1018 | 7995.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.51762 | acc=0.8988 | tpr=0.9813 | fpr=0.1028 | 8048.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.52347 | acc=0.8990 | tpr=0.9825 | fpr=0.1026 | 8078.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.51833 | acc=0.8986 | tpr=0.9834 | fpr=0.1029 | 8147.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.52613 | acc=0.8986 | tpr=0.9825 | fpr=0.1030 | 7786.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.53075 | acc=0.8979 | tpr=0.9825 | fpr=0.1036 | 8090.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.53291 | acc=0.8980 | tpr=0.9803 | fpr=0.1035 | 8011.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.54067 | acc=0.8975 | tpr=0.9796 | fpr=0.1040 | 7897.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.53976 | acc=0.8972 | tpr=0.9793 | fpr=0.1043 | 7999.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.53614 | acc=0.8973 | tpr=0.9781 | fpr=0.1042 | 14599.4 samples/s | 57.0 steps/s
Avg test loss: 0.53526, Avg test acc: 0.89735, Avg tpr: 0.97821, Avg fpr: 0.10412, total FA: 14457

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=21601 Epoch=21.1] | Loss=0.12803 | Reg=0.00000 | L2-Norm=28.917 | L2-Norm(final)=2.848 | acc=0.9219 | 3741.8 samples/s | 58.5 steps/s
[Step=21650 Epoch=21.1] | Loss=0.02479 | Reg=0.00000 | L2-Norm=28.962 | L2-Norm(final)=2.847 | acc=1.0000 | 4296.9 samples/s | 67.1 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01886 | Reg=0.00000 | L2-Norm=28.977 | L2-Norm(final)=2.854 | acc=0.9688 | 4600.1 samples/s | 71.9 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01615 | Reg=0.00000 | L2-Norm=28.987 | L2-Norm(final)=2.859 | acc=0.9688 | 4703.3 samples/s | 73.5 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01536 | Reg=0.00000 | L2-Norm=28.995 | L2-Norm(final)=2.862 | acc=1.0000 | 4714.9 samples/s | 73.7 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01537 | Reg=0.00000 | L2-Norm=29.002 | L2-Norm(final)=2.863 | acc=1.0000 | 4660.1 samples/s | 72.8 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01496 | Reg=0.00000 | L2-Norm=29.008 | L2-Norm(final)=2.865 | acc=0.9844 | 4673.9 samples/s | 73.0 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01433 | Reg=0.00000 | L2-Norm=29.014 | L2-Norm(final)=2.867 | acc=0.9844 | 4729.7 samples/s | 73.9 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01415 | Reg=0.00000 | L2-Norm=29.020 | L2-Norm(final)=2.868 | acc=0.9844 | 4700.1 samples/s | 73.4 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01380 | Reg=0.00000 | L2-Norm=29.025 | L2-Norm(final)=2.870 | acc=1.0000 | 4738.4 samples/s | 74.0 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01418 | Reg=0.00000 | L2-Norm=29.031 | L2-Norm(final)=2.871 | acc=0.9688 | 4610.5 samples/s | 72.0 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01406 | Reg=0.00000 | L2-Norm=29.037 | L2-Norm(final)=2.872 | acc=1.0000 | 4680.9 samples/s | 73.1 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01405 | Reg=0.00000 | L2-Norm=29.043 | L2-Norm(final)=2.874 | acc=0.9844 | 4737.4 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=21601 Epoch=40.7] | Loss=0.07731 | Reg=0.00000 | L2-Norm=28.917 | L2-Norm(final)=2.849 | acc=0.9375 | 3511.7 samples/s | 54.9 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00288 | Reg=0.00000 | L2-Norm=28.962 | L2-Norm(final)=2.860 | acc=1.0000 | 4191.2 samples/s | 65.5 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00152 | Reg=0.00000 | L2-Norm=28.979 | L2-Norm(final)=2.863 | acc=1.0000 | 4472.6 samples/s | 69.9 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00116 | Reg=0.00000 | L2-Norm=28.987 | L2-Norm(final)=2.866 | acc=1.0000 | 4441.6 samples/s | 69.4 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00122 | Reg=0.00000 | L2-Norm=28.994 | L2-Norm(final)=2.866 | acc=1.0000 | 4534.7 samples/s | 70.9 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00102 | Reg=0.00000 | L2-Norm=29.002 | L2-Norm(final)=2.867 | acc=1.0000 | 4419.7 samples/s | 69.1 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00090 | Reg=0.00000 | L2-Norm=29.008 | L2-Norm(final)=2.867 | acc=1.0000 | 4463.1 samples/s | 69.7 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.013 | L2-Norm(final)=2.869 | acc=1.0000 | 4469.6 samples/s | 69.8 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00075 | Reg=0.00000 | L2-Norm=29.017 | L2-Norm(final)=2.870 | acc=1.0000 | 4482.1 samples/s | 70.0 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00076 | Reg=0.00000 | L2-Norm=29.023 | L2-Norm(final)=2.872 | acc=1.0000 | 4442.7 samples/s | 69.4 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00116 | Reg=0.00000 | L2-Norm=29.032 | L2-Norm(final)=2.873 | acc=1.0000 | 4509.5 samples/s | 70.5 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00167 | Reg=0.00000 | L2-Norm=29.046 | L2-Norm(final)=2.871 | acc=1.0000 | 1928.7 samples/s | 30.1 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00161 | Reg=0.00000 | L2-Norm=29.061 | L2-Norm(final)=2.868 | acc=0.9844 | 4520.6 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22200.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15169 | acc=0.8838 | tpr=0.8395 | fpr=0.0198 | 4167.1 samples/s | 16.3 steps/s
Avg test loss: 0.15431, Avg test acc: 0.88180, Avg tpr: 0.83674, Avg fpr: 0.01910, total FA: 149

Testing server on iccad2012
[Step=  50] | Loss=0.48511 | acc=0.8752 | tpr=0.9779 | fpr=0.1266 | 4139.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.50705 | acc=0.8727 | tpr=0.9851 | fpr=0.1294 | 8015.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.52058 | acc=0.8706 | tpr=0.9841 | fpr=0.1315 | 8233.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.52868 | acc=0.8695 | tpr=0.9858 | fpr=0.1326 | 8089.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.52330 | acc=0.8698 | tpr=0.9860 | fpr=0.1323 | 7812.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.52897 | acc=0.8694 | tpr=0.9847 | fpr=0.1327 | 8097.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.53420 | acc=0.8689 | tpr=0.9837 | fpr=0.1332 | 8086.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.53533 | acc=0.8685 | tpr=0.9819 | fpr=0.1335 | 8029.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.54218 | acc=0.8682 | tpr=0.9820 | fpr=0.1339 | 7949.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.54113 | acc=0.8680 | tpr=0.9824 | fpr=0.1341 | 8059.2 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.53768 | acc=0.8685 | tpr=0.9813 | fpr=0.1335 | 14568.0 samples/s | 56.9 steps/s
Avg test loss: 0.53682, Avg test acc: 0.86855, Avg tpr: 0.98098, Avg fpr: 0.13349, total FA: 18535

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=22201 Epoch=21.7] | Loss=0.11014 | Reg=0.00000 | L2-Norm=29.078 | L2-Norm(final)=2.861 | acc=0.9062 | 3974.6 samples/s | 62.1 steps/s
[Step=22250 Epoch=21.7] | Loss=0.02601 | Reg=0.00000 | L2-Norm=29.113 | L2-Norm(final)=2.872 | acc=0.9844 | 4287.1 samples/s | 67.0 steps/s
[Step=22300 Epoch=21.8] | Loss=0.02170 | Reg=0.00000 | L2-Norm=29.128 | L2-Norm(final)=2.877 | acc=1.0000 | 4754.6 samples/s | 74.3 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01921 | Reg=0.00000 | L2-Norm=29.138 | L2-Norm(final)=2.879 | acc=1.0000 | 4595.0 samples/s | 71.8 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01786 | Reg=0.00000 | L2-Norm=29.148 | L2-Norm(final)=2.882 | acc=1.0000 | 4813.3 samples/s | 75.2 steps/s
[Step=22450 Epoch=21.9] | Loss=0.01687 | Reg=0.00000 | L2-Norm=29.156 | L2-Norm(final)=2.884 | acc=0.9844 | 4603.1 samples/s | 71.9 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01677 | Reg=0.00000 | L2-Norm=29.164 | L2-Norm(final)=2.885 | acc=1.0000 | 4709.7 samples/s | 73.6 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01650 | Reg=0.00000 | L2-Norm=29.170 | L2-Norm(final)=2.886 | acc=1.0000 | 4740.0 samples/s | 74.1 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01668 | Reg=0.00000 | L2-Norm=29.178 | L2-Norm(final)=2.886 | acc=1.0000 | 4684.4 samples/s | 73.2 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01637 | Reg=0.00000 | L2-Norm=29.185 | L2-Norm(final)=2.886 | acc=0.9844 | 4720.1 samples/s | 73.8 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01597 | Reg=0.00000 | L2-Norm=29.191 | L2-Norm(final)=2.886 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01563 | Reg=0.00000 | L2-Norm=29.198 | L2-Norm(final)=2.887 | acc=1.0000 | 4673.3 samples/s | 73.0 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01544 | Reg=0.00000 | L2-Norm=29.204 | L2-Norm(final)=2.888 | acc=0.9688 | 4680.6 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=22201 Epoch=41.8] | Loss=0.03185 | Reg=0.00000 | L2-Norm=29.078 | L2-Norm(final)=2.861 | acc=0.9688 | 3441.3 samples/s | 53.8 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00413 | Reg=0.00000 | L2-Norm=29.126 | L2-Norm(final)=2.858 | acc=1.0000 | 4254.7 samples/s | 66.5 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00224 | Reg=0.00000 | L2-Norm=29.139 | L2-Norm(final)=2.857 | acc=1.0000 | 4407.6 samples/s | 68.9 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00164 | Reg=0.00000 | L2-Norm=29.145 | L2-Norm(final)=2.857 | acc=1.0000 | 4481.5 samples/s | 70.0 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00125 | Reg=0.00000 | L2-Norm=29.148 | L2-Norm(final)=2.858 | acc=1.0000 | 4432.2 samples/s | 69.3 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00101 | Reg=0.00000 | L2-Norm=29.150 | L2-Norm(final)=2.858 | acc=1.0000 | 4522.3 samples/s | 70.7 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00084 | Reg=0.00000 | L2-Norm=29.152 | L2-Norm(final)=2.858 | acc=1.0000 | 4410.8 samples/s | 68.9 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00072 | Reg=0.00000 | L2-Norm=29.153 | L2-Norm(final)=2.858 | acc=1.0000 | 4448.8 samples/s | 69.5 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00063 | Reg=0.00000 | L2-Norm=29.154 | L2-Norm(final)=2.858 | acc=1.0000 | 4437.8 samples/s | 69.3 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00056 | Reg=0.00000 | L2-Norm=29.154 | L2-Norm(final)=2.859 | acc=1.0000 | 4475.0 samples/s | 69.9 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00051 | Reg=0.00000 | L2-Norm=29.155 | L2-Norm(final)=2.859 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00046 | Reg=0.00000 | L2-Norm=29.156 | L2-Norm(final)=2.859 | acc=1.0000 | 1920.6 samples/s | 30.0 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00042 | Reg=0.00000 | L2-Norm=29.156 | L2-Norm(final)=2.859 | acc=1.0000 | 4472.7 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22800.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21151 | acc=0.8537 | tpr=0.7918 | fpr=0.0119 | 4217.4 samples/s | 16.5 steps/s
Avg test loss: 0.21381, Avg test acc: 0.85183, Avg tpr: 0.78994, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.44389 | acc=0.9098 | tpr=0.9823 | fpr=0.0915 | 4154.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.46396 | acc=0.9059 | tpr=0.9851 | fpr=0.0956 | 7839.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.47797 | acc=0.9061 | tpr=0.9841 | fpr=0.0953 | 8080.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.48393 | acc=0.9055 | tpr=0.9836 | fpr=0.0960 | 8113.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.47785 | acc=0.9055 | tpr=0.9843 | fpr=0.0959 | 8214.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.48469 | acc=0.9051 | tpr=0.9833 | fpr=0.0963 | 7871.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.48930 | acc=0.9047 | tpr=0.9831 | fpr=0.0967 | 8168.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.48975 | acc=0.9049 | tpr=0.9792 | fpr=0.0964 | 8067.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.49748 | acc=0.9043 | tpr=0.9796 | fpr=0.0971 | 8073.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.49665 | acc=0.9042 | tpr=0.9789 | fpr=0.0971 | 7876.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.49320 | acc=0.9046 | tpr=0.9773 | fpr=0.0968 | 14302.8 samples/s | 55.9 steps/s
Avg test loss: 0.49243, Avg test acc: 0.90459, Avg tpr: 0.97742, Avg fpr: 0.09674, total FA: 13432

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=22801 Epoch=22.3] | Loss=0.08427 | Reg=0.00000 | L2-Norm=29.162 | L2-Norm(final)=2.876 | acc=0.9375 | 3775.6 samples/s | 59.0 steps/s
[Step=22850 Epoch=22.3] | Loss=0.02312 | Reg=0.00000 | L2-Norm=29.203 | L2-Norm(final)=2.878 | acc=0.9844 | 4421.4 samples/s | 69.1 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01845 | Reg=0.00000 | L2-Norm=29.217 | L2-Norm(final)=2.880 | acc=0.9688 | 4700.7 samples/s | 73.4 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01589 | Reg=0.00000 | L2-Norm=29.225 | L2-Norm(final)=2.880 | acc=0.9844 | 4695.4 samples/s | 73.4 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01535 | Reg=0.00000 | L2-Norm=29.232 | L2-Norm(final)=2.882 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01463 | Reg=0.00000 | L2-Norm=29.239 | L2-Norm(final)=2.884 | acc=1.0000 | 4691.1 samples/s | 73.3 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01402 | Reg=0.00000 | L2-Norm=29.244 | L2-Norm(final)=2.887 | acc=1.0000 | 4701.6 samples/s | 73.5 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01378 | Reg=0.00000 | L2-Norm=29.249 | L2-Norm(final)=2.889 | acc=0.9844 | 4676.1 samples/s | 73.1 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01425 | Reg=0.00000 | L2-Norm=29.255 | L2-Norm(final)=2.890 | acc=1.0000 | 4709.4 samples/s | 73.6 steps/s
[Step=23250 Epoch=22.7] | Loss=0.01423 | Reg=0.00000 | L2-Norm=29.261 | L2-Norm(final)=2.891 | acc=0.9844 | 4703.4 samples/s | 73.5 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01413 | Reg=0.00000 | L2-Norm=29.267 | L2-Norm(final)=2.892 | acc=0.9531 | 4739.8 samples/s | 74.1 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01400 | Reg=0.00000 | L2-Norm=29.273 | L2-Norm(final)=2.894 | acc=0.9688 | 4712.5 samples/s | 73.6 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01393 | Reg=0.00000 | L2-Norm=29.279 | L2-Norm(final)=2.895 | acc=0.9688 | 4809.2 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=22801 Epoch=43.0] | Loss=0.08055 | Reg=0.00000 | L2-Norm=29.162 | L2-Norm(final)=2.876 | acc=0.9844 | 3444.4 samples/s | 53.8 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00307 | Reg=0.00000 | L2-Norm=29.188 | L2-Norm(final)=2.875 | acc=1.0000 | 4179.6 samples/s | 65.3 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00157 | Reg=0.00000 | L2-Norm=29.194 | L2-Norm(final)=2.876 | acc=1.0000 | 4473.3 samples/s | 69.9 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00105 | Reg=0.00000 | L2-Norm=29.196 | L2-Norm(final)=2.877 | acc=1.0000 | 4458.2 samples/s | 69.7 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00081 | Reg=0.00000 | L2-Norm=29.198 | L2-Norm(final)=2.878 | acc=1.0000 | 4412.0 samples/s | 68.9 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00065 | Reg=0.00000 | L2-Norm=29.199 | L2-Norm(final)=2.879 | acc=1.0000 | 4564.9 samples/s | 71.3 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00054 | Reg=0.00000 | L2-Norm=29.200 | L2-Norm(final)=2.880 | acc=1.0000 | 4442.8 samples/s | 69.4 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00047 | Reg=0.00000 | L2-Norm=29.200 | L2-Norm(final)=2.880 | acc=1.0000 | 4489.3 samples/s | 70.1 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.201 | L2-Norm(final)=2.881 | acc=1.0000 | 4439.3 samples/s | 69.4 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00037 | Reg=0.00000 | L2-Norm=29.201 | L2-Norm(final)=2.881 | acc=1.0000 | 4492.9 samples/s | 70.2 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00033 | Reg=0.00000 | L2-Norm=29.201 | L2-Norm(final)=2.882 | acc=1.0000 | 4555.3 samples/s | 71.2 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00030 | Reg=0.00000 | L2-Norm=29.201 | L2-Norm(final)=2.882 | acc=1.0000 | 1891.7 samples/s | 29.6 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00028 | Reg=0.00000 | L2-Norm=29.202 | L2-Norm(final)=2.883 | acc=1.0000 | 4459.1 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23400.h5
Adjusting learning rate of group 0 to 4.2188e-04.
Adjusting learning rate of group 0 to 4.2188e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14705 | acc=0.9014 | tpr=0.8630 | fpr=0.0151 | 4034.7 samples/s | 15.8 steps/s
Avg test loss: 0.14889, Avg test acc: 0.89919, Avg tpr: 0.86012, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.52879 | acc=0.8733 | tpr=0.9779 | fpr=0.1286 | 4179.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.55470 | acc=0.8695 | tpr=0.9787 | fpr=0.1326 | 7727.9 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.56856 | acc=0.8690 | tpr=0.9813 | fpr=0.1330 | 8041.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.57524 | acc=0.8679 | tpr=0.9803 | fpr=0.1341 | 8095.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.57025 | acc=0.8682 | tpr=0.9799 | fpr=0.1339 | 8025.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.57743 | acc=0.8677 | tpr=0.9789 | fpr=0.1343 | 8246.7 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.58278 | acc=0.8673 | tpr=0.9800 | fpr=0.1347 | 8098.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.58419 | acc=0.8671 | tpr=0.9781 | fpr=0.1350 | 7725.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.59148 | acc=0.8664 | tpr=0.9786 | fpr=0.1356 | 8267.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.59027 | acc=0.8665 | tpr=0.9789 | fpr=0.1356 | 7712.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.58646 | acc=0.8665 | tpr=0.9773 | fpr=0.1355 | 14147.3 samples/s | 55.3 steps/s
Avg test loss: 0.58570, Avg test acc: 0.86648, Avg tpr: 0.97742, Avg fpr: 0.13554, total FA: 18819

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00042, len=1
[Step=23401 Epoch=22.8] | Loss=0.06326 | Reg=0.00000 | L2-Norm=29.235 | L2-Norm(final)=2.898 | acc=0.9375 | 3880.5 samples/s | 60.6 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01933 | Reg=0.00000 | L2-Norm=29.267 | L2-Norm(final)=2.897 | acc=1.0000 | 4375.3 samples/s | 68.4 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01548 | Reg=0.00000 | L2-Norm=29.277 | L2-Norm(final)=2.900 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01459 | Reg=0.00000 | L2-Norm=29.284 | L2-Norm(final)=2.903 | acc=0.9844 | 4704.4 samples/s | 73.5 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01376 | Reg=0.00000 | L2-Norm=29.290 | L2-Norm(final)=2.906 | acc=0.9844 | 4686.2 samples/s | 73.2 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01348 | Reg=0.00000 | L2-Norm=29.295 | L2-Norm(final)=2.909 | acc=0.9844 | 4688.1 samples/s | 73.3 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01300 | Reg=0.00000 | L2-Norm=29.300 | L2-Norm(final)=2.911 | acc=1.0000 | 4737.3 samples/s | 74.0 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01298 | Reg=0.00000 | L2-Norm=29.306 | L2-Norm(final)=2.912 | acc=0.9688 | 4707.2 samples/s | 73.5 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01281 | Reg=0.00000 | L2-Norm=29.311 | L2-Norm(final)=2.914 | acc=1.0000 | 4786.3 samples/s | 74.8 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01289 | Reg=0.00000 | L2-Norm=29.317 | L2-Norm(final)=2.915 | acc=1.0000 | 4770.6 samples/s | 74.5 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01302 | Reg=0.00000 | L2-Norm=29.322 | L2-Norm(final)=2.916 | acc=0.9688 | 4724.0 samples/s | 73.8 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01288 | Reg=0.00000 | L2-Norm=29.328 | L2-Norm(final)=2.917 | acc=1.0000 | 4692.9 samples/s | 73.3 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01291 | Reg=0.00000 | L2-Norm=29.333 | L2-Norm(final)=2.919 | acc=0.9844 | 4703.6 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00042, len=1
[Step=23401 Epoch=44.1] | Loss=0.01673 | Reg=0.00000 | L2-Norm=29.235 | L2-Norm(final)=2.899 | acc=0.9844 | 3423.1 samples/s | 53.5 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00498 | Reg=0.00000 | L2-Norm=29.300 | L2-Norm(final)=2.895 | acc=1.0000 | 4315.6 samples/s | 67.4 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00255 | Reg=0.00000 | L2-Norm=29.316 | L2-Norm(final)=2.895 | acc=1.0000 | 4474.4 samples/s | 69.9 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00171 | Reg=0.00000 | L2-Norm=29.322 | L2-Norm(final)=2.896 | acc=1.0000 | 4383.1 samples/s | 68.5 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00129 | Reg=0.00000 | L2-Norm=29.325 | L2-Norm(final)=2.897 | acc=1.0000 | 4493.4 samples/s | 70.2 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00104 | Reg=0.00000 | L2-Norm=29.327 | L2-Norm(final)=2.898 | acc=1.0000 | 4526.1 samples/s | 70.7 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00089 | Reg=0.00000 | L2-Norm=29.330 | L2-Norm(final)=2.899 | acc=1.0000 | 4439.8 samples/s | 69.4 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.333 | L2-Norm(final)=2.900 | acc=1.0000 | 4431.7 samples/s | 69.2 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00069 | Reg=0.00000 | L2-Norm=29.335 | L2-Norm(final)=2.901 | acc=1.0000 | 4496.8 samples/s | 70.3 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00062 | Reg=0.00000 | L2-Norm=29.338 | L2-Norm(final)=2.902 | acc=1.0000 | 4483.1 samples/s | 70.0 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00056 | Reg=0.00000 | L2-Norm=29.340 | L2-Norm(final)=2.903 | acc=1.0000 | 4510.5 samples/s | 70.5 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00051 | Reg=0.00000 | L2-Norm=29.341 | L2-Norm(final)=2.904 | acc=1.0000 | 1870.6 samples/s | 29.2 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00046 | Reg=0.00000 | L2-Norm=29.343 | L2-Norm(final)=2.904 | acc=1.0000 | 4528.5 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22586 | acc=0.8576 | tpr=0.7972 | fpr=0.0114 | 4094.5 samples/s | 16.0 steps/s
Avg test loss: 0.22715, Avg test acc: 0.85492, Avg tpr: 0.79431, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.41183 | acc=0.9215 | tpr=0.9823 | fpr=0.0796 | 4077.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.43441 | acc=0.9195 | tpr=0.9808 | fpr=0.0816 | 8038.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.44778 | acc=0.9193 | tpr=0.9813 | fpr=0.0819 | 7962.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.45415 | acc=0.9184 | tpr=0.9814 | fpr=0.0828 | 7914.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.44818 | acc=0.9185 | tpr=0.9825 | fpr=0.0826 | 8043.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.45537 | acc=0.9183 | tpr=0.9818 | fpr=0.0829 | 8164.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.45983 | acc=0.9180 | tpr=0.9818 | fpr=0.0832 | 8137.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.46163 | acc=0.9181 | tpr=0.9803 | fpr=0.0830 | 7935.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.46912 | acc=0.9176 | tpr=0.9791 | fpr=0.0835 | 8108.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.46768 | acc=0.9176 | tpr=0.9784 | fpr=0.0835 | 8126.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.46363 | acc=0.9180 | tpr=0.9761 | fpr=0.0831 | 13846.6 samples/s | 54.1 steps/s
Avg test loss: 0.46281, Avg test acc: 0.91796, Avg tpr: 0.97623, Avg fpr: 0.08310, total FA: 11538

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=24001 Epoch=23.4] | Loss=0.09914 | Reg=0.00000 | L2-Norm=29.326 | L2-Norm(final)=2.918 | acc=0.9219 | 3644.6 samples/s | 56.9 steps/s
[Step=24050 Epoch=23.5] | Loss=0.02503 | Reg=0.00000 | L2-Norm=29.359 | L2-Norm(final)=2.915 | acc=1.0000 | 4508.5 samples/s | 70.4 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01718 | Reg=0.00000 | L2-Norm=29.372 | L2-Norm(final)=2.921 | acc=1.0000 | 4685.0 samples/s | 73.2 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01435 | Reg=0.00000 | L2-Norm=29.378 | L2-Norm(final)=2.925 | acc=0.9844 | 4705.5 samples/s | 73.5 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01389 | Reg=0.00000 | L2-Norm=29.382 | L2-Norm(final)=2.929 | acc=1.0000 | 4708.8 samples/s | 73.6 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01302 | Reg=0.00000 | L2-Norm=29.386 | L2-Norm(final)=2.932 | acc=1.0000 | 4656.8 samples/s | 72.8 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01248 | Reg=0.00000 | L2-Norm=29.390 | L2-Norm(final)=2.935 | acc=1.0000 | 4760.5 samples/s | 74.4 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01197 | Reg=0.00000 | L2-Norm=29.393 | L2-Norm(final)=2.938 | acc=1.0000 | 4707.9 samples/s | 73.6 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01214 | Reg=0.00000 | L2-Norm=29.396 | L2-Norm(final)=2.939 | acc=1.0000 | 4698.7 samples/s | 73.4 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01212 | Reg=0.00000 | L2-Norm=29.400 | L2-Norm(final)=2.941 | acc=0.9844 | 4728.0 samples/s | 73.9 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01203 | Reg=0.00000 | L2-Norm=29.403 | L2-Norm(final)=2.942 | acc=1.0000 | 4638.1 samples/s | 72.5 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01208 | Reg=0.00000 | L2-Norm=29.406 | L2-Norm(final)=2.943 | acc=0.9844 | 4775.5 samples/s | 74.6 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01180 | Reg=0.00000 | L2-Norm=29.410 | L2-Norm(final)=2.944 | acc=0.9844 | 4699.4 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=24001 Epoch=45.2] | Loss=0.05739 | Reg=0.00000 | L2-Norm=29.326 | L2-Norm(final)=2.918 | acc=0.9844 | 3688.1 samples/s | 57.6 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00421 | Reg=0.00000 | L2-Norm=29.350 | L2-Norm(final)=2.914 | acc=1.0000 | 4119.6 samples/s | 64.4 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00214 | Reg=0.00000 | L2-Norm=29.357 | L2-Norm(final)=2.913 | acc=1.0000 | 4431.6 samples/s | 69.2 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00146 | Reg=0.00000 | L2-Norm=29.359 | L2-Norm(final)=2.914 | acc=1.0000 | 4462.0 samples/s | 69.7 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00111 | Reg=0.00000 | L2-Norm=29.361 | L2-Norm(final)=2.914 | acc=1.0000 | 4476.3 samples/s | 69.9 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00090 | Reg=0.00000 | L2-Norm=29.362 | L2-Norm(final)=2.915 | acc=1.0000 | 4476.8 samples/s | 69.9 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00075 | Reg=0.00000 | L2-Norm=29.363 | L2-Norm(final)=2.916 | acc=1.0000 | 4446.2 samples/s | 69.5 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00064 | Reg=0.00000 | L2-Norm=29.364 | L2-Norm(final)=2.916 | acc=1.0000 | 4453.6 samples/s | 69.6 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00056 | Reg=0.00000 | L2-Norm=29.365 | L2-Norm(final)=2.917 | acc=1.0000 | 4426.7 samples/s | 69.2 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00050 | Reg=0.00000 | L2-Norm=29.365 | L2-Norm(final)=2.917 | acc=1.0000 | 4426.9 samples/s | 69.2 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00045 | Reg=0.00000 | L2-Norm=29.366 | L2-Norm(final)=2.917 | acc=1.0000 | 4486.9 samples/s | 70.1 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.366 | L2-Norm(final)=2.918 | acc=1.0000 | 1900.8 samples/s | 29.7 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00038 | Reg=0.00000 | L2-Norm=29.366 | L2-Norm(final)=2.918 | acc=1.0000 | 4537.8 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24600.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15052 | acc=0.8984 | tpr=0.8581 | fpr=0.0139 | 4244.4 samples/s | 16.6 steps/s
Avg test loss: 0.15461, Avg test acc: 0.89643, Avg tpr: 0.85615, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.49991 | acc=0.8842 | tpr=0.9779 | fpr=0.1175 | 4108.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.52636 | acc=0.8812 | tpr=0.9829 | fpr=0.1207 | 8372.5 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.54251 | acc=0.8794 | tpr=0.9827 | fpr=0.1225 | 7869.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.54884 | acc=0.8789 | tpr=0.9825 | fpr=0.1230 | 8201.4 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.54291 | acc=0.8790 | tpr=0.9817 | fpr=0.1228 | 8055.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.54977 | acc=0.8793 | tpr=0.9818 | fpr=0.1226 | 8600.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.55461 | acc=0.8788 | tpr=0.9825 | fpr=0.1231 | 7609.9 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.55618 | acc=0.8788 | tpr=0.9814 | fpr=0.1231 | 8144.4 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.56452 | acc=0.8782 | tpr=0.9815 | fpr=0.1237 | 8144.5 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.56288 | acc=0.8781 | tpr=0.9815 | fpr=0.1238 | 7768.7 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.55868 | acc=0.8783 | tpr=0.9805 | fpr=0.1236 | 14641.5 samples/s | 57.2 steps/s
Avg test loss: 0.55783, Avg test acc: 0.87824, Avg tpr: 0.98019, Avg fpr: 0.12362, total FA: 17164

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=24601 Epoch=24.0] | Loss=0.07588 | Reg=0.00000 | L2-Norm=29.373 | L2-Norm(final)=2.935 | acc=0.9219 | 3409.8 samples/s | 53.3 steps/s
[Step=24650 Epoch=24.1] | Loss=0.02133 | Reg=0.00000 | L2-Norm=29.397 | L2-Norm(final)=2.934 | acc=0.9688 | 4669.5 samples/s | 73.0 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01469 | Reg=0.00000 | L2-Norm=29.405 | L2-Norm(final)=2.940 | acc=0.9844 | 4642.8 samples/s | 72.5 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01245 | Reg=0.00000 | L2-Norm=29.408 | L2-Norm(final)=2.945 | acc=1.0000 | 4711.1 samples/s | 73.6 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01184 | Reg=0.00000 | L2-Norm=29.411 | L2-Norm(final)=2.949 | acc=1.0000 | 4745.8 samples/s | 74.2 steps/s
[Step=24850 Epoch=24.3] | Loss=0.01153 | Reg=0.00000 | L2-Norm=29.414 | L2-Norm(final)=2.951 | acc=0.9844 | 4732.7 samples/s | 73.9 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01131 | Reg=0.00000 | L2-Norm=29.418 | L2-Norm(final)=2.952 | acc=0.9844 | 4693.3 samples/s | 73.3 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01088 | Reg=0.00000 | L2-Norm=29.421 | L2-Norm(final)=2.954 | acc=1.0000 | 4728.6 samples/s | 73.9 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01092 | Reg=0.00000 | L2-Norm=29.424 | L2-Norm(final)=2.955 | acc=0.9844 | 4720.5 samples/s | 73.8 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01078 | Reg=0.00000 | L2-Norm=29.427 | L2-Norm(final)=2.956 | acc=0.9844 | 4795.1 samples/s | 74.9 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01064 | Reg=0.00000 | L2-Norm=29.430 | L2-Norm(final)=2.957 | acc=0.9844 | 4668.9 samples/s | 73.0 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01066 | Reg=0.00000 | L2-Norm=29.433 | L2-Norm(final)=2.958 | acc=0.9844 | 4722.7 samples/s | 73.8 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01058 | Reg=0.00000 | L2-Norm=29.435 | L2-Norm(final)=2.960 | acc=0.9844 | 4724.1 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=24601 Epoch=46.4] | Loss=0.05308 | Reg=0.00000 | L2-Norm=29.373 | L2-Norm(final)=2.935 | acc=0.9531 | 3604.2 samples/s | 56.3 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00366 | Reg=0.00000 | L2-Norm=29.404 | L2-Norm(final)=2.936 | acc=1.0000 | 4273.6 samples/s | 66.8 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00184 | Reg=0.00000 | L2-Norm=29.414 | L2-Norm(final)=2.936 | acc=1.0000 | 4449.0 samples/s | 69.5 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00123 | Reg=0.00000 | L2-Norm=29.418 | L2-Norm(final)=2.936 | acc=1.0000 | 4462.5 samples/s | 69.7 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00093 | Reg=0.00000 | L2-Norm=29.419 | L2-Norm(final)=2.936 | acc=1.0000 | 4438.1 samples/s | 69.3 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00074 | Reg=0.00000 | L2-Norm=29.420 | L2-Norm(final)=2.937 | acc=1.0000 | 4472.2 samples/s | 69.9 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00062 | Reg=0.00000 | L2-Norm=29.421 | L2-Norm(final)=2.937 | acc=1.0000 | 4496.7 samples/s | 70.3 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00053 | Reg=0.00000 | L2-Norm=29.422 | L2-Norm(final)=2.937 | acc=1.0000 | 4401.2 samples/s | 68.8 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00047 | Reg=0.00000 | L2-Norm=29.422 | L2-Norm(final)=2.938 | acc=1.0000 | 4477.8 samples/s | 70.0 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00042 | Reg=0.00000 | L2-Norm=29.422 | L2-Norm(final)=2.938 | acc=1.0000 | 4483.0 samples/s | 70.0 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00037 | Reg=0.00000 | L2-Norm=29.423 | L2-Norm(final)=2.938 | acc=1.0000 | 4506.1 samples/s | 70.4 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00034 | Reg=0.00000 | L2-Norm=29.423 | L2-Norm(final)=2.938 | acc=1.0000 | 1841.6 samples/s | 28.8 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00031 | Reg=0.00000 | L2-Norm=29.423 | L2-Norm(final)=2.939 | acc=1.0000 | 4511.5 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25200.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16241 | acc=0.8989 | tpr=0.8582 | fpr=0.0126 | 4059.6 samples/s | 15.9 steps/s
Avg test loss: 0.16678, Avg test acc: 0.89687, Avg tpr: 0.85592, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.54800 | acc=0.8826 | tpr=0.9779 | fpr=0.1191 | 4147.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.57634 | acc=0.8772 | tpr=0.9829 | fpr=0.1248 | 8210.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.59598 | acc=0.8748 | tpr=0.9827 | fpr=0.1272 | 8026.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.60269 | acc=0.8733 | tpr=0.9825 | fpr=0.1286 | 8331.2 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.59598 | acc=0.8733 | tpr=0.9834 | fpr=0.1287 | 7759.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.60278 | acc=0.8737 | tpr=0.9833 | fpr=0.1283 | 7958.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.60838 | acc=0.8733 | tpr=0.9837 | fpr=0.1287 | 7929.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.60964 | acc=0.8732 | tpr=0.9814 | fpr=0.1288 | 8558.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.61815 | acc=0.8726 | tpr=0.9820 | fpr=0.1293 | 7685.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.61627 | acc=0.8730 | tpr=0.9819 | fpr=0.1290 | 8241.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.61189 | acc=0.8732 | tpr=0.9805 | fpr=0.1288 | 14491.9 samples/s | 56.6 steps/s
Avg test loss: 0.61112, Avg test acc: 0.87318, Avg tpr: 0.98059, Avg fpr: 0.12877, total FA: 17880

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=25201 Epoch=24.6] | Loss=0.20155 | Reg=0.00000 | L2-Norm=29.415 | L2-Norm(final)=2.956 | acc=0.8594 | 3503.8 samples/s | 54.7 steps/s
[Step=25250 Epoch=24.7] | Loss=0.02239 | Reg=0.00000 | L2-Norm=29.434 | L2-Norm(final)=2.949 | acc=1.0000 | 4742.4 samples/s | 74.1 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01646 | Reg=0.00000 | L2-Norm=29.443 | L2-Norm(final)=2.953 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01501 | Reg=0.00000 | L2-Norm=29.448 | L2-Norm(final)=2.957 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01377 | Reg=0.00000 | L2-Norm=29.453 | L2-Norm(final)=2.960 | acc=0.9844 | 4725.7 samples/s | 73.8 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01313 | Reg=0.00000 | L2-Norm=29.458 | L2-Norm(final)=2.962 | acc=0.9688 | 4715.7 samples/s | 73.7 steps/s
[Step=25500 Epoch=24.9] | Loss=0.01233 | Reg=0.00000 | L2-Norm=29.461 | L2-Norm(final)=2.964 | acc=1.0000 | 4726.6 samples/s | 73.9 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01152 | Reg=0.00000 | L2-Norm=29.465 | L2-Norm(final)=2.967 | acc=1.0000 | 4727.0 samples/s | 73.9 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01147 | Reg=0.00000 | L2-Norm=29.468 | L2-Norm(final)=2.970 | acc=0.9688 | 4742.6 samples/s | 74.1 steps/s
[Step=25650 Epoch=25.0] | Loss=0.01144 | Reg=0.00000 | L2-Norm=29.471 | L2-Norm(final)=2.972 | acc=1.0000 | 4703.1 samples/s | 73.5 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01161 | Reg=0.00000 | L2-Norm=29.475 | L2-Norm(final)=2.973 | acc=0.9844 | 4696.2 samples/s | 73.4 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01138 | Reg=0.00000 | L2-Norm=29.479 | L2-Norm(final)=2.974 | acc=0.9844 | 4787.4 samples/s | 74.8 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01136 | Reg=0.00000 | L2-Norm=29.483 | L2-Norm(final)=2.976 | acc=1.0000 | 4705.0 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=25201 Epoch=47.5] | Loss=0.00605 | Reg=0.00000 | L2-Norm=29.415 | L2-Norm(final)=2.957 | acc=1.0000 | 3351.3 samples/s | 52.4 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00424 | Reg=0.00000 | L2-Norm=29.442 | L2-Norm(final)=2.960 | acc=1.0000 | 4472.2 samples/s | 69.9 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00219 | Reg=0.00000 | L2-Norm=29.451 | L2-Norm(final)=2.962 | acc=1.0000 | 4418.7 samples/s | 69.0 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00147 | Reg=0.00000 | L2-Norm=29.455 | L2-Norm(final)=2.963 | acc=1.0000 | 4459.0 samples/s | 69.7 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00111 | Reg=0.00000 | L2-Norm=29.457 | L2-Norm(final)=2.964 | acc=1.0000 | 4462.1 samples/s | 69.7 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00089 | Reg=0.00000 | L2-Norm=29.458 | L2-Norm(final)=2.964 | acc=1.0000 | 4434.5 samples/s | 69.3 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00074 | Reg=0.00000 | L2-Norm=29.459 | L2-Norm(final)=2.965 | acc=1.0000 | 4503.4 samples/s | 70.4 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00064 | Reg=0.00000 | L2-Norm=29.460 | L2-Norm(final)=2.965 | acc=1.0000 | 4485.3 samples/s | 70.1 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00056 | Reg=0.00000 | L2-Norm=29.460 | L2-Norm(final)=2.966 | acc=1.0000 | 4442.9 samples/s | 69.4 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00050 | Reg=0.00000 | L2-Norm=29.461 | L2-Norm(final)=2.967 | acc=1.0000 | 4459.5 samples/s | 69.7 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00045 | Reg=0.00000 | L2-Norm=29.461 | L2-Norm(final)=2.967 | acc=1.0000 | 4519.1 samples/s | 70.6 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.461 | L2-Norm(final)=2.967 | acc=1.0000 | 1859.7 samples/s | 29.1 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00038 | Reg=0.00000 | L2-Norm=29.462 | L2-Norm(final)=2.968 | acc=1.0000 | 4545.6 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25800.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18169 | acc=0.8869 | tpr=0.8401 | fpr=0.0116 | 4084.5 samples/s | 16.0 steps/s
Avg test loss: 0.18572, Avg test acc: 0.88372, Avg tpr: 0.83674, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.48767 | acc=0.9030 | tpr=0.9779 | fpr=0.0983 | 4168.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.51365 | acc=0.8999 | tpr=0.9808 | fpr=0.1016 | 7859.3 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.53033 | acc=0.8983 | tpr=0.9813 | fpr=0.1033 | 8259.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.53800 | acc=0.8977 | tpr=0.9803 | fpr=0.1038 | 7913.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.53139 | acc=0.8979 | tpr=0.9817 | fpr=0.1036 | 7989.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.53763 | acc=0.8978 | tpr=0.9818 | fpr=0.1038 | 8291.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.54262 | acc=0.8970 | tpr=0.9825 | fpr=0.1046 | 7958.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.54458 | acc=0.8969 | tpr=0.9814 | fpr=0.1046 | 7852.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.55213 | acc=0.8965 | tpr=0.9805 | fpr=0.1050 | 8128.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.55047 | acc=0.8968 | tpr=0.9806 | fpr=0.1047 | 7858.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.54664 | acc=0.8968 | tpr=0.9801 | fpr=0.1047 | 14720.5 samples/s | 57.5 steps/s
Avg test loss: 0.54591, Avg test acc: 0.89684, Avg tpr: 0.98019, Avg fpr: 0.10468, total FA: 14534

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=25801 Epoch=25.2] | Loss=0.13554 | Reg=0.00000 | L2-Norm=29.466 | L2-Norm(final)=2.978 | acc=0.9219 | 4024.1 samples/s | 62.9 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01789 | Reg=0.00000 | L2-Norm=29.494 | L2-Norm(final)=2.974 | acc=0.9688 | 4306.5 samples/s | 67.3 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01356 | Reg=0.00000 | L2-Norm=29.503 | L2-Norm(final)=2.978 | acc=0.9844 | 4727.5 samples/s | 73.9 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01215 | Reg=0.00000 | L2-Norm=29.508 | L2-Norm(final)=2.981 | acc=1.0000 | 4621.0 samples/s | 72.2 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01076 | Reg=0.00000 | L2-Norm=29.513 | L2-Norm(final)=2.985 | acc=1.0000 | 4690.2 samples/s | 73.3 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01060 | Reg=0.00000 | L2-Norm=29.516 | L2-Norm(final)=2.989 | acc=0.9844 | 4716.2 samples/s | 73.7 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01057 | Reg=0.00000 | L2-Norm=29.520 | L2-Norm(final)=2.991 | acc=1.0000 | 4826.5 samples/s | 75.4 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01030 | Reg=0.00000 | L2-Norm=29.524 | L2-Norm(final)=2.993 | acc=0.9844 | 4615.2 samples/s | 72.1 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01076 | Reg=0.00000 | L2-Norm=29.527 | L2-Norm(final)=2.994 | acc=1.0000 | 4718.3 samples/s | 73.7 steps/s
[Step=26250 Epoch=25.6] | Loss=0.01054 | Reg=0.00000 | L2-Norm=29.530 | L2-Norm(final)=2.996 | acc=1.0000 | 4736.2 samples/s | 74.0 steps/s
[Step=26300 Epoch=25.7] | Loss=0.01093 | Reg=0.00000 | L2-Norm=29.534 | L2-Norm(final)=2.997 | acc=0.9688 | 4713.6 samples/s | 73.7 steps/s
[Step=26350 Epoch=25.7] | Loss=0.01099 | Reg=0.00000 | L2-Norm=29.537 | L2-Norm(final)=2.998 | acc=0.9688 | 4667.0 samples/s | 72.9 steps/s
[Step=26400 Epoch=25.8] | Loss=0.01081 | Reg=0.00000 | L2-Norm=29.540 | L2-Norm(final)=2.998 | acc=1.0000 | 4691.2 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=25801 Epoch=48.6] | Loss=0.01361 | Reg=0.00000 | L2-Norm=29.466 | L2-Norm(final)=2.978 | acc=0.9844 | 3644.8 samples/s | 57.0 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00353 | Reg=0.00000 | L2-Norm=29.497 | L2-Norm(final)=2.984 | acc=1.0000 | 4126.2 samples/s | 64.5 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00180 | Reg=0.00000 | L2-Norm=29.508 | L2-Norm(final)=2.987 | acc=1.0000 | 4473.2 samples/s | 69.9 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00120 | Reg=0.00000 | L2-Norm=29.513 | L2-Norm(final)=2.988 | acc=1.0000 | 4458.5 samples/s | 69.7 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00090 | Reg=0.00000 | L2-Norm=29.515 | L2-Norm(final)=2.989 | acc=1.0000 | 4460.1 samples/s | 69.7 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00073 | Reg=0.00000 | L2-Norm=29.516 | L2-Norm(final)=2.990 | acc=1.0000 | 4557.3 samples/s | 71.2 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00061 | Reg=0.00000 | L2-Norm=29.517 | L2-Norm(final)=2.990 | acc=1.0000 | 4408.8 samples/s | 68.9 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00052 | Reg=0.00000 | L2-Norm=29.518 | L2-Norm(final)=2.991 | acc=1.0000 | 4478.0 samples/s | 70.0 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00046 | Reg=0.00000 | L2-Norm=29.519 | L2-Norm(final)=2.991 | acc=1.0000 | 4498.0 samples/s | 70.3 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.519 | L2-Norm(final)=2.992 | acc=1.0000 | 4536.3 samples/s | 70.9 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00037 | Reg=0.00000 | L2-Norm=29.519 | L2-Norm(final)=2.992 | acc=1.0000 | 4462.7 samples/s | 69.7 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00033 | Reg=0.00000 | L2-Norm=29.520 | L2-Norm(final)=2.993 | acc=1.0000 | 1846.1 samples/s | 28.8 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00031 | Reg=0.00000 | L2-Norm=29.520 | L2-Norm(final)=2.993 | acc=1.0000 | 4558.8 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14701 | acc=0.9074 | tpr=0.8721 | fpr=0.0159 | 4121.1 samples/s | 16.1 steps/s
Avg test loss: 0.15166, Avg test acc: 0.90636, Avg tpr: 0.87090, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.53891 | acc=0.8911 | tpr=0.9735 | fpr=0.1104 | 4154.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.56467 | acc=0.8880 | tpr=0.9765 | fpr=0.1137 | 7861.0 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.58267 | acc=0.8870 | tpr=0.9784 | fpr=0.1147 | 8159.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.58978 | acc=0.8870 | tpr=0.9781 | fpr=0.1147 | 8465.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.58303 | acc=0.8869 | tpr=0.9799 | fpr=0.1148 | 7625.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.58998 | acc=0.8870 | tpr=0.9796 | fpr=0.1147 | 8172.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.59566 | acc=0.8864 | tpr=0.9806 | fpr=0.1154 | 8518.6 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.59768 | acc=0.8862 | tpr=0.9787 | fpr=0.1155 | 7438.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.60501 | acc=0.8861 | tpr=0.9791 | fpr=0.1156 | 8043.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.60292 | acc=0.8864 | tpr=0.9789 | fpr=0.1153 | 8118.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.59871 | acc=0.8865 | tpr=0.9773 | fpr=0.1152 | 14569.9 samples/s | 56.9 steps/s
Avg test loss: 0.59791, Avg test acc: 0.88653, Avg tpr: 0.97742, Avg fpr: 0.11512, total FA: 15984

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=26401 Epoch=25.8] | Loss=0.15095 | Reg=0.00000 | L2-Norm=29.519 | L2-Norm(final)=2.997 | acc=0.8906 | 3732.2 samples/s | 58.3 steps/s
[Step=26450 Epoch=25.8] | Loss=0.01697 | Reg=0.00000 | L2-Norm=29.543 | L2-Norm(final)=2.993 | acc=1.0000 | 4413.3 samples/s | 69.0 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01230 | Reg=0.00000 | L2-Norm=29.551 | L2-Norm(final)=2.999 | acc=0.9844 | 4732.9 samples/s | 74.0 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01120 | Reg=0.00000 | L2-Norm=29.556 | L2-Norm(final)=3.005 | acc=0.9844 | 4683.9 samples/s | 73.2 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01076 | Reg=0.00000 | L2-Norm=29.560 | L2-Norm(final)=3.008 | acc=1.0000 | 4795.9 samples/s | 74.9 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01087 | Reg=0.00000 | L2-Norm=29.563 | L2-Norm(final)=3.011 | acc=0.9844 | 4665.5 samples/s | 72.9 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01085 | Reg=0.00000 | L2-Norm=29.567 | L2-Norm(final)=3.012 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01069 | Reg=0.00000 | L2-Norm=29.571 | L2-Norm(final)=3.014 | acc=1.0000 | 4693.6 samples/s | 73.3 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01068 | Reg=0.00000 | L2-Norm=29.575 | L2-Norm(final)=3.015 | acc=1.0000 | 4697.4 samples/s | 73.4 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01088 | Reg=0.00000 | L2-Norm=29.578 | L2-Norm(final)=3.016 | acc=0.9844 | 4786.7 samples/s | 74.8 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01092 | Reg=0.00000 | L2-Norm=29.582 | L2-Norm(final)=3.017 | acc=1.0000 | 4683.9 samples/s | 73.2 steps/s
[Step=26950 Epoch=26.3] | Loss=0.01078 | Reg=0.00000 | L2-Norm=29.586 | L2-Norm(final)=3.018 | acc=1.0000 | 4743.4 samples/s | 74.1 steps/s
[Step=27000 Epoch=26.4] | Loss=0.01085 | Reg=0.00000 | L2-Norm=29.589 | L2-Norm(final)=3.019 | acc=1.0000 | 4702.1 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=26401 Epoch=49.8] | Loss=0.01000 | Reg=0.00000 | L2-Norm=29.519 | L2-Norm(final)=2.999 | acc=0.9844 | 3567.4 samples/s | 55.7 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00300 | Reg=0.00000 | L2-Norm=29.557 | L2-Norm(final)=3.004 | acc=1.0000 | 4172.4 samples/s | 65.2 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00151 | Reg=0.00000 | L2-Norm=29.569 | L2-Norm(final)=3.004 | acc=1.0000 | 4522.3 samples/s | 70.7 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00103 | Reg=0.00000 | L2-Norm=29.573 | L2-Norm(final)=3.004 | acc=1.0000 | 4321.0 samples/s | 67.5 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.575 | L2-Norm(final)=3.004 | acc=1.0000 | 4447.0 samples/s | 69.5 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00066 | Reg=0.00000 | L2-Norm=29.577 | L2-Norm(final)=3.005 | acc=1.0000 | 4395.6 samples/s | 68.7 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00055 | Reg=0.00000 | L2-Norm=29.579 | L2-Norm(final)=3.006 | acc=1.0000 | 4468.5 samples/s | 69.8 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00047 | Reg=0.00000 | L2-Norm=29.580 | L2-Norm(final)=3.007 | acc=1.0000 | 4500.9 samples/s | 70.3 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.581 | L2-Norm(final)=3.007 | acc=1.0000 | 4427.2 samples/s | 69.2 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00037 | Reg=0.00000 | L2-Norm=29.582 | L2-Norm(final)=3.008 | acc=1.0000 | 4466.3 samples/s | 69.8 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00033 | Reg=0.00000 | L2-Norm=29.583 | L2-Norm(final)=3.008 | acc=1.0000 | 4506.2 samples/s | 70.4 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00030 | Reg=0.00000 | L2-Norm=29.583 | L2-Norm(final)=3.008 | acc=1.0000 | 1868.4 samples/s | 29.2 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00028 | Reg=0.00000 | L2-Norm=29.583 | L2-Norm(final)=3.009 | acc=1.0000 | 4529.3 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27000.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20620 | acc=0.8721 | tpr=0.8193 | fpr=0.0131 | 4098.9 samples/s | 16.0 steps/s
Avg test loss: 0.21136, Avg test acc: 0.86974, Avg tpr: 0.81681, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.46657 | acc=0.9198 | tpr=0.9823 | fpr=0.0814 | 4173.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.49456 | acc=0.9188 | tpr=0.9851 | fpr=0.0824 | 7905.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.51199 | acc=0.9176 | tpr=0.9856 | fpr=0.0836 | 8427.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.51887 | acc=0.9171 | tpr=0.9847 | fpr=0.0841 | 7590.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.51171 | acc=0.9171 | tpr=0.9860 | fpr=0.0842 | 8375.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.51916 | acc=0.9168 | tpr=0.9855 | fpr=0.0844 | 7805.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.52556 | acc=0.9164 | tpr=0.9850 | fpr=0.0849 | 8177.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.52727 | acc=0.9166 | tpr=0.9830 | fpr=0.0846 | 8007.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.53634 | acc=0.9161 | tpr=0.9825 | fpr=0.0851 | 8535.3 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.53488 | acc=0.9162 | tpr=0.9824 | fpr=0.0850 | 7766.4 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.53075 | acc=0.9164 | tpr=0.9809 | fpr=0.0848 | 13583.0 samples/s | 53.1 steps/s
Avg test loss: 0.52991, Avg test acc: 0.91640, Avg tpr: 0.98098, Avg fpr: 0.08477, total FA: 11770

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=27001 Epoch=26.4] | Loss=0.06222 | Reg=0.00000 | L2-Norm=29.573 | L2-Norm(final)=3.017 | acc=0.9375 | 3819.9 samples/s | 59.7 steps/s
[Step=27050 Epoch=26.4] | Loss=0.01676 | Reg=0.00000 | L2-Norm=29.604 | L2-Norm(final)=3.022 | acc=0.9688 | 4381.5 samples/s | 68.5 steps/s
[Step=27100 Epoch=26.5] | Loss=0.01341 | Reg=0.00000 | L2-Norm=29.616 | L2-Norm(final)=3.026 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=27150 Epoch=26.5] | Loss=0.01160 | Reg=0.00000 | L2-Norm=29.622 | L2-Norm(final)=3.030 | acc=1.0000 | 4713.5 samples/s | 73.6 steps/s
[Step=27200 Epoch=26.6] | Loss=0.01127 | Reg=0.00000 | L2-Norm=29.626 | L2-Norm(final)=3.033 | acc=0.9688 | 4646.5 samples/s | 72.6 steps/s
[Step=27250 Epoch=26.6] | Loss=0.01120 | Reg=0.00000 | L2-Norm=29.631 | L2-Norm(final)=3.035 | acc=1.0000 | 4740.2 samples/s | 74.1 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01076 | Reg=0.00000 | L2-Norm=29.634 | L2-Norm(final)=3.036 | acc=1.0000 | 4748.1 samples/s | 74.2 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01050 | Reg=0.00000 | L2-Norm=29.638 | L2-Norm(final)=3.038 | acc=1.0000 | 4760.2 samples/s | 74.4 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01042 | Reg=0.00000 | L2-Norm=29.641 | L2-Norm(final)=3.039 | acc=1.0000 | 4708.5 samples/s | 73.6 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01034 | Reg=0.00000 | L2-Norm=29.644 | L2-Norm(final)=3.041 | acc=1.0000 | 4768.3 samples/s | 74.5 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01031 | Reg=0.00000 | L2-Norm=29.647 | L2-Norm(final)=3.042 | acc=0.9844 | 4718.1 samples/s | 73.7 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01056 | Reg=0.00000 | L2-Norm=29.651 | L2-Norm(final)=3.044 | acc=0.9844 | 4783.7 samples/s | 74.7 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01061 | Reg=0.00000 | L2-Norm=29.654 | L2-Norm(final)=3.044 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=27001 Epoch=50.9] | Loss=0.05201 | Reg=0.00000 | L2-Norm=29.573 | L2-Norm(final)=3.016 | acc=0.9531 | 3762.5 samples/s | 58.8 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00151 | Reg=0.00000 | L2-Norm=29.588 | L2-Norm(final)=3.020 | acc=1.0000 | 4134.9 samples/s | 64.6 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.593 | L2-Norm(final)=3.021 | acc=1.0000 | 4489.8 samples/s | 70.2 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00052 | Reg=0.00000 | L2-Norm=29.594 | L2-Norm(final)=3.022 | acc=1.0000 | 4546.5 samples/s | 71.0 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00039 | Reg=0.00000 | L2-Norm=29.595 | L2-Norm(final)=3.023 | acc=1.0000 | 4496.1 samples/s | 70.3 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00032 | Reg=0.00000 | L2-Norm=29.596 | L2-Norm(final)=3.024 | acc=1.0000 | 4429.8 samples/s | 69.2 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00027 | Reg=0.00000 | L2-Norm=29.596 | L2-Norm(final)=3.025 | acc=1.0000 | 4480.3 samples/s | 70.0 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00023 | Reg=0.00000 | L2-Norm=29.596 | L2-Norm(final)=3.026 | acc=1.0000 | 4381.6 samples/s | 68.5 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00020 | Reg=0.00000 | L2-Norm=29.597 | L2-Norm(final)=3.026 | acc=1.0000 | 4468.0 samples/s | 69.8 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00019 | Reg=0.00000 | L2-Norm=29.597 | L2-Norm(final)=3.027 | acc=1.0000 | 4448.2 samples/s | 69.5 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00017 | Reg=0.00000 | L2-Norm=29.598 | L2-Norm(final)=3.028 | acc=1.0000 | 4527.2 samples/s | 70.7 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00015 | Reg=0.00000 | L2-Norm=29.599 | L2-Norm(final)=3.028 | acc=1.0000 | 1904.2 samples/s | 29.8 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00014 | Reg=0.00000 | L2-Norm=29.599 | L2-Norm(final)=3.029 | acc=1.0000 | 4569.0 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27600.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.13701 | acc=0.9160 | tpr=0.8837 | fpr=0.0139 | 4055.4 samples/s | 15.8 steps/s
Avg test loss: 0.14195, Avg test acc: 0.91321, Avg tpr: 0.88063, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.59100 | acc=0.8752 | tpr=0.9867 | fpr=0.1268 | 4166.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.62400 | acc=0.8705 | tpr=0.9851 | fpr=0.1317 | 7811.7 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.64084 | acc=0.8691 | tpr=0.9841 | fpr=0.1330 | 8020.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.64851 | acc=0.8683 | tpr=0.9825 | fpr=0.1338 | 8079.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.64223 | acc=0.8684 | tpr=0.9825 | fpr=0.1337 | 8643.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.64844 | acc=0.8683 | tpr=0.9811 | fpr=0.1337 | 7582.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.65548 | acc=0.8676 | tpr=0.9818 | fpr=0.1345 | 8000.8 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.65792 | acc=0.8674 | tpr=0.9814 | fpr=0.1347 | 8347.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.66581 | acc=0.8668 | tpr=0.9815 | fpr=0.1352 | 7847.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.66419 | acc=0.8672 | tpr=0.9815 | fpr=0.1349 | 8148.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.66054 | acc=0.8675 | tpr=0.9801 | fpr=0.1346 | 14332.1 samples/s | 56.0 steps/s
Avg test loss: 0.65968, Avg test acc: 0.86749, Avg tpr: 0.98019, Avg fpr: 0.13456, total FA: 18683

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=27601 Epoch=26.9] | Loss=0.05669 | Reg=0.00000 | L2-Norm=29.623 | L2-Norm(final)=3.042 | acc=0.9531 | 3875.0 samples/s | 60.5 steps/s
[Step=27650 Epoch=27.0] | Loss=0.01459 | Reg=0.00000 | L2-Norm=29.642 | L2-Norm(final)=3.042 | acc=1.0000 | 4113.0 samples/s | 64.3 steps/s
[Step=27700 Epoch=27.0] | Loss=0.01104 | Reg=0.00000 | L2-Norm=29.649 | L2-Norm(final)=3.046 | acc=1.0000 | 4651.4 samples/s | 72.7 steps/s
[Step=27750 Epoch=27.1] | Loss=0.01128 | Reg=0.00000 | L2-Norm=29.653 | L2-Norm(final)=3.049 | acc=1.0000 | 4650.8 samples/s | 72.7 steps/s
[Step=27800 Epoch=27.1] | Loss=0.01061 | Reg=0.00000 | L2-Norm=29.657 | L2-Norm(final)=3.052 | acc=1.0000 | 4665.9 samples/s | 72.9 steps/s
[Step=27850 Epoch=27.2] | Loss=0.01024 | Reg=0.00000 | L2-Norm=29.660 | L2-Norm(final)=3.054 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
[Step=27900 Epoch=27.2] | Loss=0.01021 | Reg=0.00000 | L2-Norm=29.663 | L2-Norm(final)=3.056 | acc=1.0000 | 4735.7 samples/s | 74.0 steps/s
[Step=27950 Epoch=27.3] | Loss=0.01035 | Reg=0.00000 | L2-Norm=29.667 | L2-Norm(final)=3.058 | acc=1.0000 | 4714.3 samples/s | 73.7 steps/s
[Step=28000 Epoch=27.3] | Loss=0.01017 | Reg=0.00000 | L2-Norm=29.671 | L2-Norm(final)=3.059 | acc=1.0000 | 4705.2 samples/s | 73.5 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01009 | Reg=0.00000 | L2-Norm=29.675 | L2-Norm(final)=3.060 | acc=1.0000 | 4688.5 samples/s | 73.3 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01003 | Reg=0.00000 | L2-Norm=29.679 | L2-Norm(final)=3.060 | acc=1.0000 | 4744.4 samples/s | 74.1 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01031 | Reg=0.00000 | L2-Norm=29.683 | L2-Norm(final)=3.061 | acc=1.0000 | 4759.0 samples/s | 74.4 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01057 | Reg=0.00000 | L2-Norm=29.687 | L2-Norm(final)=3.061 | acc=1.0000 | 4713.8 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=27601 Epoch=52.0] | Loss=0.15467 | Reg=0.00000 | L2-Norm=29.623 | L2-Norm(final)=3.041 | acc=0.9219 | 3488.8 samples/s | 54.5 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00528 | Reg=0.00000 | L2-Norm=29.664 | L2-Norm(final)=3.039 | acc=1.0000 | 4309.5 samples/s | 67.3 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00286 | Reg=0.00000 | L2-Norm=29.679 | L2-Norm(final)=3.039 | acc=1.0000 | 4510.5 samples/s | 70.5 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00212 | Reg=0.00000 | L2-Norm=29.687 | L2-Norm(final)=3.040 | acc=1.0000 | 4419.5 samples/s | 69.1 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00160 | Reg=0.00000 | L2-Norm=29.693 | L2-Norm(final)=3.041 | acc=1.0000 | 4475.5 samples/s | 69.9 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00128 | Reg=0.00000 | L2-Norm=29.696 | L2-Norm(final)=3.041 | acc=1.0000 | 4508.5 samples/s | 70.4 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00107 | Reg=0.00000 | L2-Norm=29.698 | L2-Norm(final)=3.042 | acc=1.0000 | 4442.1 samples/s | 69.4 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00092 | Reg=0.00000 | L2-Norm=29.700 | L2-Norm(final)=3.042 | acc=1.0000 | 4449.7 samples/s | 69.5 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00081 | Reg=0.00000 | L2-Norm=29.701 | L2-Norm(final)=3.043 | acc=1.0000 | 4491.7 samples/s | 70.2 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00072 | Reg=0.00000 | L2-Norm=29.702 | L2-Norm(final)=3.044 | acc=1.0000 | 4480.8 samples/s | 70.0 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00065 | Reg=0.00000 | L2-Norm=29.703 | L2-Norm(final)=3.044 | acc=1.0000 | 4512.9 samples/s | 70.5 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00059 | Reg=0.00000 | L2-Norm=29.704 | L2-Norm(final)=3.045 | acc=1.0000 | 1887.6 samples/s | 29.5 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00054 | Reg=0.00000 | L2-Norm=29.705 | L2-Norm(final)=3.045 | acc=1.0000 | 4511.1 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28200.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24519 | acc=0.8533 | tpr=0.7931 | fpr=0.0161 | 4183.1 samples/s | 16.3 steps/s
Avg test loss: 0.24900, Avg test acc: 0.85099, Avg tpr: 0.79064, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.39014 | acc=0.9409 | tpr=0.9823 | fpr=0.0599 | 4131.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.41559 | acc=0.9389 | tpr=0.9872 | fpr=0.0620 | 8044.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.42962 | acc=0.9390 | tpr=0.9870 | fpr=0.0618 | 7981.7 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.43516 | acc=0.9385 | tpr=0.9869 | fpr=0.0624 | 8106.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.42791 | acc=0.9386 | tpr=0.9852 | fpr=0.0623 | 8430.9 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.43528 | acc=0.9377 | tpr=0.9855 | fpr=0.0631 | 7875.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.44027 | acc=0.9374 | tpr=0.9843 | fpr=0.0634 | 8281.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.44328 | acc=0.9373 | tpr=0.9830 | fpr=0.0636 | 7870.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.45086 | acc=0.9367 | tpr=0.9820 | fpr=0.0642 | 7890.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.44934 | acc=0.9366 | tpr=0.9815 | fpr=0.0642 | 4640.8 samples/s | 18.1 steps/s
[Step= 550] | Loss=0.44565 | acc=0.9369 | tpr=0.9797 | fpr=0.0639 | 14833.7 samples/s | 57.9 steps/s
Avg test loss: 0.44481, Avg test acc: 0.93692, Avg tpr: 0.97979, Avg fpr: 0.06386, total FA: 8867

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=28201 Epoch=27.5] | Loss=0.04520 | Reg=0.00000 | L2-Norm=29.684 | L2-Norm(final)=3.053 | acc=0.9844 | 3918.2 samples/s | 61.2 steps/s
[Step=28250 Epoch=27.6] | Loss=0.02185 | Reg=0.00000 | L2-Norm=29.715 | L2-Norm(final)=3.051 | acc=1.0000 | 4273.7 samples/s | 66.8 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01685 | Reg=0.00000 | L2-Norm=29.725 | L2-Norm(final)=3.055 | acc=0.9844 | 4641.7 samples/s | 72.5 steps/s
[Step=28350 Epoch=27.7] | Loss=0.01531 | Reg=0.00000 | L2-Norm=29.733 | L2-Norm(final)=3.058 | acc=0.9688 | 4666.3 samples/s | 72.9 steps/s
[Step=28400 Epoch=27.7] | Loss=0.01457 | Reg=0.00000 | L2-Norm=29.738 | L2-Norm(final)=3.060 | acc=0.9844 | 4613.2 samples/s | 72.1 steps/s
[Step=28450 Epoch=27.8] | Loss=0.01371 | Reg=0.00000 | L2-Norm=29.743 | L2-Norm(final)=3.061 | acc=1.0000 | 4623.9 samples/s | 72.2 steps/s
[Step=28500 Epoch=27.8] | Loss=0.01308 | Reg=0.00000 | L2-Norm=29.749 | L2-Norm(final)=3.063 | acc=1.0000 | 4731.4 samples/s | 73.9 steps/s
[Step=28550 Epoch=27.9] | Loss=0.01308 | Reg=0.00000 | L2-Norm=29.753 | L2-Norm(final)=3.065 | acc=1.0000 | 4725.6 samples/s | 73.8 steps/s
[Step=28600 Epoch=27.9] | Loss=0.01251 | Reg=0.00000 | L2-Norm=29.757 | L2-Norm(final)=3.067 | acc=0.9844 | 4690.4 samples/s | 73.3 steps/s
[Step=28650 Epoch=28.0] | Loss=0.01202 | Reg=0.00000 | L2-Norm=29.761 | L2-Norm(final)=3.069 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=28700 Epoch=28.0] | Loss=0.01200 | Reg=0.00000 | L2-Norm=29.765 | L2-Norm(final)=3.071 | acc=1.0000 | 4755.2 samples/s | 74.3 steps/s
[Step=28750 Epoch=28.1] | Loss=0.01187 | Reg=0.00000 | L2-Norm=29.769 | L2-Norm(final)=3.072 | acc=1.0000 | 4712.1 samples/s | 73.6 steps/s
[Step=28800 Epoch=28.1] | Loss=0.01220 | Reg=0.00000 | L2-Norm=29.773 | L2-Norm(final)=3.073 | acc=0.9844 | 4658.1 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=28201 Epoch=53.2] | Loss=0.00492 | Reg=0.00000 | L2-Norm=29.684 | L2-Norm(final)=3.053 | acc=1.0000 | 3744.3 samples/s | 58.5 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00292 | Reg=0.00000 | L2-Norm=29.702 | L2-Norm(final)=3.049 | acc=1.0000 | 4135.7 samples/s | 64.6 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00153 | Reg=0.00000 | L2-Norm=29.709 | L2-Norm(final)=3.047 | acc=1.0000 | 4457.4 samples/s | 69.6 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00103 | Reg=0.00000 | L2-Norm=29.712 | L2-Norm(final)=3.046 | acc=1.0000 | 4449.3 samples/s | 69.5 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.713 | L2-Norm(final)=3.046 | acc=1.0000 | 4596.1 samples/s | 71.8 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00062 | Reg=0.00000 | L2-Norm=29.714 | L2-Norm(final)=3.046 | acc=1.0000 | 4359.8 samples/s | 68.1 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00054 | Reg=0.00000 | L2-Norm=29.715 | L2-Norm(final)=3.047 | acc=1.0000 | 4463.5 samples/s | 69.7 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00046 | Reg=0.00000 | L2-Norm=29.716 | L2-Norm(final)=3.048 | acc=1.0000 | 4508.4 samples/s | 70.4 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00041 | Reg=0.00000 | L2-Norm=29.717 | L2-Norm(final)=3.048 | acc=1.0000 | 4468.2 samples/s | 69.8 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00036 | Reg=0.00000 | L2-Norm=29.718 | L2-Norm(final)=3.049 | acc=1.0000 | 4520.3 samples/s | 70.6 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00033 | Reg=0.00000 | L2-Norm=29.719 | L2-Norm(final)=3.050 | acc=1.0000 | 4497.8 samples/s | 70.3 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00030 | Reg=0.00000 | L2-Norm=29.719 | L2-Norm(final)=3.050 | acc=1.0000 | 1882.3 samples/s | 29.4 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00027 | Reg=0.00000 | L2-Norm=29.720 | L2-Norm(final)=3.051 | acc=1.0000 | 4340.5 samples/s | 67.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16390 | acc=0.8991 | tpr=0.8594 | fpr=0.0149 | 4060.8 samples/s | 15.9 steps/s
Avg test loss: 0.16910, Avg test acc: 0.89518, Avg tpr: 0.85411, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.48513 | acc=0.9066 | tpr=0.9823 | fpr=0.0947 | 4206.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.51472 | acc=0.9027 | tpr=0.9851 | fpr=0.0989 | 7588.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.52860 | acc=0.9016 | tpr=0.9856 | fpr=0.0999 | 8564.4 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.53649 | acc=0.9017 | tpr=0.9847 | fpr=0.0998 | 7554.4 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.52843 | acc=0.9020 | tpr=0.9843 | fpr=0.0995 | 8151.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.53540 | acc=0.9017 | tpr=0.9840 | fpr=0.0998 | 8060.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.54161 | acc=0.9013 | tpr=0.9843 | fpr=0.1002 | 8135.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.54457 | acc=0.9012 | tpr=0.9830 | fpr=0.1003 | 7042.0 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.55310 | acc=0.9006 | tpr=0.9825 | fpr=0.1008 | 5434.9 samples/s | 21.2 steps/s
[Step= 500] | Loss=0.55138 | acc=0.9007 | tpr=0.9819 | fpr=0.1007 | 7918.6 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.54731 | acc=0.9011 | tpr=0.9801 | fpr=0.1003 | 14397.5 samples/s | 56.2 steps/s
Avg test loss: 0.54644, Avg test acc: 0.90111, Avg tpr: 0.98019, Avg fpr: 0.10033, total FA: 13930

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=28801 Epoch=28.1] | Loss=0.01991 | Reg=0.00000 | L2-Norm=29.741 | L2-Norm(final)=3.066 | acc=0.9844 | 3915.6 samples/s | 61.2 steps/s
[Step=28850 Epoch=28.2] | Loss=0.01800 | Reg=0.00000 | L2-Norm=29.767 | L2-Norm(final)=3.061 | acc=1.0000 | 4295.9 samples/s | 67.1 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01368 | Reg=0.00000 | L2-Norm=29.775 | L2-Norm(final)=3.066 | acc=0.9844 | 4689.3 samples/s | 73.3 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01203 | Reg=0.00000 | L2-Norm=29.779 | L2-Norm(final)=3.070 | acc=1.0000 | 4728.0 samples/s | 73.9 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01157 | Reg=0.00000 | L2-Norm=29.783 | L2-Norm(final)=3.073 | acc=0.9688 | 4645.0 samples/s | 72.6 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01097 | Reg=0.00000 | L2-Norm=29.786 | L2-Norm(final)=3.075 | acc=1.0000 | 4716.1 samples/s | 73.7 steps/s
[Step=29100 Epoch=28.4] | Loss=0.01063 | Reg=0.00000 | L2-Norm=29.789 | L2-Norm(final)=3.076 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=29150 Epoch=28.5] | Loss=0.01022 | Reg=0.00000 | L2-Norm=29.792 | L2-Norm(final)=3.079 | acc=0.9844 | 4701.2 samples/s | 73.5 steps/s
[Step=29200 Epoch=28.5] | Loss=0.01030 | Reg=0.00000 | L2-Norm=29.795 | L2-Norm(final)=3.081 | acc=1.0000 | 4679.9 samples/s | 73.1 steps/s
[Step=29250 Epoch=28.6] | Loss=0.01016 | Reg=0.00000 | L2-Norm=29.798 | L2-Norm(final)=3.082 | acc=1.0000 | 4765.6 samples/s | 74.5 steps/s
[Step=29300 Epoch=28.6] | Loss=0.01033 | Reg=0.00000 | L2-Norm=29.801 | L2-Norm(final)=3.083 | acc=1.0000 | 4725.1 samples/s | 73.8 steps/s
[Step=29350 Epoch=28.7] | Loss=0.01011 | Reg=0.00000 | L2-Norm=29.803 | L2-Norm(final)=3.084 | acc=1.0000 | 4671.1 samples/s | 73.0 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00995 | Reg=0.00000 | L2-Norm=29.806 | L2-Norm(final)=3.085 | acc=1.0000 | 4707.2 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=28801 Epoch=54.3] | Loss=0.00832 | Reg=0.00000 | L2-Norm=29.741 | L2-Norm(final)=3.066 | acc=1.0000 | 3697.2 samples/s | 57.8 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00402 | Reg=0.00000 | L2-Norm=29.772 | L2-Norm(final)=3.066 | acc=1.0000 | 4167.3 samples/s | 65.1 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00216 | Reg=0.00000 | L2-Norm=29.783 | L2-Norm(final)=3.065 | acc=1.0000 | 4417.7 samples/s | 69.0 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00144 | Reg=0.00000 | L2-Norm=29.790 | L2-Norm(final)=3.065 | acc=1.0000 | 4461.5 samples/s | 69.7 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00108 | Reg=0.00000 | L2-Norm=29.793 | L2-Norm(final)=3.065 | acc=1.0000 | 4494.2 samples/s | 70.2 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00087 | Reg=0.00000 | L2-Norm=29.795 | L2-Norm(final)=3.066 | acc=1.0000 | 4467.3 samples/s | 69.8 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00078 | Reg=0.00000 | L2-Norm=29.797 | L2-Norm(final)=3.066 | acc=1.0000 | 4483.0 samples/s | 70.0 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00068 | Reg=0.00000 | L2-Norm=29.800 | L2-Norm(final)=3.066 | acc=1.0000 | 4404.9 samples/s | 68.8 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00065 | Reg=0.00000 | L2-Norm=29.802 | L2-Norm(final)=3.067 | acc=1.0000 | 4502.3 samples/s | 70.3 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00058 | Reg=0.00000 | L2-Norm=29.805 | L2-Norm(final)=3.067 | acc=1.0000 | 4496.2 samples/s | 70.3 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00052 | Reg=0.00000 | L2-Norm=29.807 | L2-Norm(final)=3.067 | acc=1.0000 | 4497.9 samples/s | 70.3 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00047 | Reg=0.00000 | L2-Norm=29.809 | L2-Norm(final)=3.067 | acc=1.0000 | 1892.0 samples/s | 29.6 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00043 | Reg=0.00000 | L2-Norm=29.810 | L2-Norm(final)=3.068 | acc=1.0000 | 4315.8 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29400.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16931 | acc=0.8920 | tpr=0.8518 | fpr=0.0206 | 4175.5 samples/s | 16.3 steps/s
Avg test loss: 0.17208, Avg test acc: 0.89062, Avg tpr: 0.85038, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.51967 | acc=0.9206 | tpr=0.9823 | fpr=0.0805 | 4131.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.55212 | acc=0.9190 | tpr=0.9893 | fpr=0.0823 | 7854.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.56969 | acc=0.9185 | tpr=0.9885 | fpr=0.0828 | 8026.7 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.57712 | acc=0.9181 | tpr=0.9891 | fpr=0.0832 | 8101.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.56752 | acc=0.9182 | tpr=0.9878 | fpr=0.0831 | 8178.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.57674 | acc=0.9181 | tpr=0.9869 | fpr=0.0832 | 8125.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.58276 | acc=0.9174 | tpr=0.9869 | fpr=0.0839 | 4702.3 samples/s | 18.4 steps/s
[Step= 400] | Loss=0.58584 | acc=0.9172 | tpr=0.9847 | fpr=0.0840 | 8099.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.59577 | acc=0.9168 | tpr=0.9839 | fpr=0.0844 | 7984.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.59395 | acc=0.9166 | tpr=0.9828 | fpr=0.0845 | 7985.2 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.58898 | acc=0.9170 | tpr=0.9817 | fpr=0.0842 | 14194.2 samples/s | 55.4 steps/s
Avg test loss: 0.58801, Avg test acc: 0.91698, Avg tpr: 0.98177, Avg fpr: 0.08420, total FA: 11691

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00032, len=1
[Step=29401 Epoch=28.7] | Loss=0.07884 | Reg=0.00000 | L2-Norm=29.796 | L2-Norm(final)=3.079 | acc=0.9531 | 3591.9 samples/s | 56.1 steps/s
[Step=29450 Epoch=28.8] | Loss=0.01734 | Reg=0.00000 | L2-Norm=29.822 | L2-Norm(final)=3.082 | acc=0.9844 | 4709.2 samples/s | 73.6 steps/s
[Step=29500 Epoch=28.8] | Loss=0.01252 | Reg=0.00000 | L2-Norm=29.832 | L2-Norm(final)=3.084 | acc=1.0000 | 4724.8 samples/s | 73.8 steps/s
[Step=29550 Epoch=28.9] | Loss=0.01261 | Reg=0.00000 | L2-Norm=29.838 | L2-Norm(final)=3.087 | acc=0.9688 | 4726.2 samples/s | 73.8 steps/s
[Step=29600 Epoch=28.9] | Loss=0.01198 | Reg=0.00000 | L2-Norm=29.844 | L2-Norm(final)=3.088 | acc=1.0000 | 4619.6 samples/s | 72.2 steps/s
[Step=29650 Epoch=28.9] | Loss=0.01199 | Reg=0.00000 | L2-Norm=29.848 | L2-Norm(final)=3.089 | acc=1.0000 | 4711.5 samples/s | 73.6 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01204 | Reg=0.00000 | L2-Norm=29.853 | L2-Norm(final)=3.090 | acc=0.9531 | 4778.5 samples/s | 74.7 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01185 | Reg=0.00000 | L2-Norm=29.858 | L2-Norm(final)=3.091 | acc=0.9844 | 4687.2 samples/s | 73.2 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01141 | Reg=0.00000 | L2-Norm=29.862 | L2-Norm(final)=3.092 | acc=1.0000 | 4680.7 samples/s | 73.1 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01128 | Reg=0.00000 | L2-Norm=29.866 | L2-Norm(final)=3.094 | acc=0.9688 | 4718.3 samples/s | 73.7 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01089 | Reg=0.00000 | L2-Norm=29.870 | L2-Norm(final)=3.095 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01080 | Reg=0.00000 | L2-Norm=29.874 | L2-Norm(final)=3.097 | acc=0.9844 | 4710.7 samples/s | 73.6 steps/s
[Step=30000 Epoch=29.3] | Loss=0.01057 | Reg=0.00000 | L2-Norm=29.878 | L2-Norm(final)=3.099 | acc=1.0000 | 4737.1 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00032, len=1
[Step=29401 Epoch=55.4] | Loss=0.00835 | Reg=0.00000 | L2-Norm=29.796 | L2-Norm(final)=3.079 | acc=1.0000 | 3689.5 samples/s | 57.6 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00218 | Reg=0.00000 | L2-Norm=29.825 | L2-Norm(final)=3.086 | acc=1.0000 | 3975.1 samples/s | 62.1 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00109 | Reg=0.00000 | L2-Norm=29.832 | L2-Norm(final)=3.087 | acc=1.0000 | 4476.1 samples/s | 69.9 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00073 | Reg=0.00000 | L2-Norm=29.835 | L2-Norm(final)=3.088 | acc=1.0000 | 4463.0 samples/s | 69.7 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00055 | Reg=0.00000 | L2-Norm=29.837 | L2-Norm(final)=3.088 | acc=1.0000 | 4534.5 samples/s | 70.9 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00044 | Reg=0.00000 | L2-Norm=29.838 | L2-Norm(final)=3.089 | acc=1.0000 | 4429.8 samples/s | 69.2 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00037 | Reg=0.00000 | L2-Norm=29.840 | L2-Norm(final)=3.089 | acc=1.0000 | 4505.8 samples/s | 70.4 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00032 | Reg=0.00000 | L2-Norm=29.841 | L2-Norm(final)=3.090 | acc=1.0000 | 4431.1 samples/s | 69.2 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00028 | Reg=0.00000 | L2-Norm=29.842 | L2-Norm(final)=3.090 | acc=1.0000 | 4491.0 samples/s | 70.2 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00025 | Reg=0.00000 | L2-Norm=29.843 | L2-Norm(final)=3.091 | acc=1.0000 | 4516.0 samples/s | 70.6 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00023 | Reg=0.00000 | L2-Norm=29.845 | L2-Norm(final)=3.092 | acc=1.0000 | 4477.0 samples/s | 70.0 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00021 | Reg=0.00000 | L2-Norm=29.846 | L2-Norm(final)=3.092 | acc=1.0000 | 1851.6 samples/s | 28.9 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00019 | Reg=0.00000 | L2-Norm=29.847 | L2-Norm(final)=3.092 | acc=1.0000 | 4497.8 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30000.h5
Adjusting learning rate of group 0 to 3.1641e-04.
Adjusting learning rate of group 0 to 3.1641e-04.

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19142 | acc=0.8893 | tpr=0.8444 | fpr=0.0131 | 4035.9 samples/s | 15.8 steps/s
Avg test loss: 0.19798, Avg test acc: 0.88541, Avg tpr: 0.83937, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.54169 | acc=0.9187 | tpr=0.9735 | fpr=0.0822 | 4089.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.57636 | acc=0.9159 | tpr=0.9787 | fpr=0.0853 | 7800.3 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.59465 | acc=0.9150 | tpr=0.9813 | fpr=0.0862 | 8276.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.60289 | acc=0.9148 | tpr=0.9803 | fpr=0.0864 | 7945.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.59394 | acc=0.9152 | tpr=0.9799 | fpr=0.0860 | 5042.8 samples/s | 19.7 steps/s
[Step= 300] | Loss=0.60250 | acc=0.9151 | tpr=0.9796 | fpr=0.0860 | 7682.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.60922 | acc=0.9145 | tpr=0.9806 | fpr=0.0867 | 8150.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.61199 | acc=0.9146 | tpr=0.9776 | fpr=0.0865 | 7855.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.62156 | acc=0.9142 | tpr=0.9776 | fpr=0.0870 | 8014.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.61997 | acc=0.9142 | tpr=0.9775 | fpr=0.0869 | 8172.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.61515 | acc=0.9144 | tpr=0.9761 | fpr=0.0867 | 14020.9 samples/s | 54.8 steps/s
Avg test loss: 0.61402, Avg test acc: 0.91440, Avg tpr: 0.97623, Avg fpr: 0.08672, total FA: 12041
