Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.47307 | Reg=0.00356 | L2-Norm=18.877 | L2-Norm(final)=1.888 | acc=0.5000 | 2717.3 samples/s | 42.5 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.31602 | Reg=0.00337 | L2-Norm=18.368 | L2-Norm(final)=1.873 | acc=0.8438 | 4713.2 samples/s | 73.6 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.26061 | Reg=0.00330 | L2-Norm=18.178 | L2-Norm(final)=1.886 | acc=0.8594 | 4644.9 samples/s | 72.6 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.23023 | Reg=0.00326 | L2-Norm=18.060 | L2-Norm(final)=1.895 | acc=0.9219 | 4693.9 samples/s | 73.3 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.21112 | Reg=0.00323 | L2-Norm=17.974 | L2-Norm(final)=1.902 | acc=0.9062 | 4632.9 samples/s | 72.4 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19701 | Reg=0.00321 | L2-Norm=17.910 | L2-Norm(final)=1.908 | acc=0.9219 | 4677.6 samples/s | 73.1 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18534 | Reg=0.00319 | L2-Norm=17.859 | L2-Norm(final)=1.915 | acc=0.9219 | 4669.3 samples/s | 73.0 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17433 | Reg=0.00318 | L2-Norm=17.818 | L2-Norm(final)=1.923 | acc=0.9219 | 4697.6 samples/s | 73.4 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16578 | Reg=0.00316 | L2-Norm=17.785 | L2-Norm(final)=1.930 | acc=0.8594 | 4698.7 samples/s | 73.4 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.15863 | Reg=0.00315 | L2-Norm=17.756 | L2-Norm(final)=1.936 | acc=0.8438 | 4652.3 samples/s | 72.7 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15319 | Reg=0.00314 | L2-Norm=17.730 | L2-Norm(final)=1.941 | acc=0.9062 | 4455.8 samples/s | 69.6 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14771 | Reg=0.00314 | L2-Norm=17.707 | L2-Norm(final)=1.947 | acc=0.9062 | 4295.6 samples/s | 67.1 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14293 | Reg=0.00313 | L2-Norm=17.687 | L2-Norm(final)=1.952 | acc=0.8906 | 4661.3 samples/s | 72.8 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.13907 | Reg=0.00312 | L2-Norm=17.669 | L2-Norm(final)=1.956 | acc=0.9219 | 4581.4 samples/s | 71.6 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13576 | Reg=0.00312 | L2-Norm=17.654 | L2-Norm(final)=1.960 | acc=0.8906 | 4656.8 samples/s | 72.8 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13176 | Reg=0.00311 | L2-Norm=17.641 | L2-Norm(final)=1.964 | acc=0.9062 | 4621.9 samples/s | 72.2 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12814 | Reg=0.00311 | L2-Norm=17.628 | L2-Norm(final)=1.968 | acc=0.8594 | 4541.1 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39453 | Reg=0.00356 | L2-Norm=18.877 | L2-Norm(final)=1.889 | acc=0.4219 | 3754.3 samples/s | 58.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.16294 | Reg=0.00340 | L2-Norm=18.428 | L2-Norm(final)=1.910 | acc=0.9688 | 4007.3 samples/s | 62.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.10766 | Reg=0.00333 | L2-Norm=18.237 | L2-Norm(final)=1.920 | acc=0.9688 | 4405.7 samples/s | 68.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08266 | Reg=0.00328 | L2-Norm=18.096 | L2-Norm(final)=1.928 | acc=0.9844 | 4401.3 samples/s | 68.8 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06801 | Reg=0.00323 | L2-Norm=17.979 | L2-Norm(final)=1.934 | acc=0.9844 | 4122.4 samples/s | 64.4 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05765 | Reg=0.00320 | L2-Norm=17.880 | L2-Norm(final)=1.938 | acc=0.9844 | 4445.3 samples/s | 69.5 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05017 | Reg=0.00317 | L2-Norm=17.793 | L2-Norm(final)=1.943 | acc=0.9844 | 4381.5 samples/s | 68.5 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04486 | Reg=0.00314 | L2-Norm=17.714 | L2-Norm(final)=1.946 | acc=0.9688 | 4363.7 samples/s | 68.2 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04149 | Reg=0.00311 | L2-Norm=17.644 | L2-Norm(final)=1.948 | acc=1.0000 | 4443.0 samples/s | 69.4 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03796 | Reg=0.00309 | L2-Norm=17.581 | L2-Norm(final)=1.951 | acc=0.9688 | 4379.0 samples/s | 68.4 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03492 | Reg=0.00307 | L2-Norm=17.522 | L2-Norm(final)=1.953 | acc=0.9844 | 4488.2 samples/s | 70.1 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03210 | Reg=0.00305 | L2-Norm=17.466 | L2-Norm(final)=1.957 | acc=1.0000 | 1932.9 samples/s | 30.2 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02981 | Reg=0.00303 | L2-Norm=17.412 | L2-Norm(final)=1.960 | acc=1.0000 | 4411.9 samples/s | 68.9 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02788 | Reg=0.00302 | L2-Norm=17.360 | L2-Norm(final)=1.963 | acc=1.0000 | 4397.3 samples/s | 68.7 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02611 | Reg=0.00300 | L2-Norm=17.309 | L2-Norm(final)=1.967 | acc=1.0000 | 4430.7 samples/s | 69.2 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02448 | Reg=0.00298 | L2-Norm=17.260 | L2-Norm(final)=1.970 | acc=1.0000 | 4459.2 samples/s | 69.7 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02313 | Reg=0.00297 | L2-Norm=17.213 | L2-Norm(final)=1.974 | acc=1.0000 | 4434.9 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36419 | acc=0.5595 | tpr=0.3772 | fpr=0.0448 | 4183.1 samples/s | 16.3 steps/s
Avg test loss: 0.36415, Avg test acc: 0.56114, Avg tpr: 0.38194, Avg fpr: 0.04474, total FA: 349

Testing server on iccad2012
[Step=  50] | Loss=0.20926 | acc=0.8359 | tpr=0.7257 | fpr=0.1622 | 4228.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.20980 | acc=0.8369 | tpr=0.7676 | fpr=0.1618 | 8128.5 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.21093 | acc=0.8356 | tpr=0.7666 | fpr=0.1631 | 8317.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.21093 | acc=0.8367 | tpr=0.7727 | fpr=0.1622 | 8101.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.21088 | acc=0.8370 | tpr=0.7782 | fpr=0.1619 | 8161.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.21081 | acc=0.8364 | tpr=0.7760 | fpr=0.1625 | 8340.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.21093 | acc=0.8360 | tpr=0.7758 | fpr=0.1629 | 8178.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.21115 | acc=0.8360 | tpr=0.7735 | fpr=0.1629 | 8178.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.21129 | acc=0.8359 | tpr=0.7760 | fpr=0.1631 | 8347.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.21138 | acc=0.8353 | tpr=0.7744 | fpr=0.1636 | 7921.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.21112 | acc=0.8357 | tpr=0.7744 | fpr=0.1632 | 15325.3 samples/s | 59.9 steps/s
Avg test loss: 0.21115, Avg test acc: 0.83567, Avg tpr: 0.77417, Avg fpr: 0.16321, total FA: 22662

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.29723 | Reg=0.00260 | L2-Norm=16.119 | L2-Norm(final)=2.012 | acc=0.7031 | 3775.8 samples/s | 59.0 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15175 | Reg=0.00264 | L2-Norm=16.249 | L2-Norm(final)=2.009 | acc=0.9219 | 4480.6 samples/s | 70.0 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13154 | Reg=0.00266 | L2-Norm=16.296 | L2-Norm(final)=2.024 | acc=0.9375 | 4616.7 samples/s | 72.1 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.11831 | Reg=0.00266 | L2-Norm=16.320 | L2-Norm(final)=2.034 | acc=0.9062 | 4648.2 samples/s | 72.6 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11147 | Reg=0.00267 | L2-Norm=16.335 | L2-Norm(final)=2.043 | acc=0.9219 | 4612.2 samples/s | 72.1 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.10582 | Reg=0.00267 | L2-Norm=16.347 | L2-Norm(final)=2.050 | acc=0.9531 | 4669.7 samples/s | 73.0 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10289 | Reg=0.00268 | L2-Norm=16.358 | L2-Norm(final)=2.057 | acc=0.9219 | 4691.4 samples/s | 73.3 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.09973 | Reg=0.00268 | L2-Norm=16.368 | L2-Norm(final)=2.062 | acc=0.9531 | 4640.4 samples/s | 72.5 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.09634 | Reg=0.00268 | L2-Norm=16.378 | L2-Norm(final)=2.067 | acc=0.9531 | 4758.3 samples/s | 74.3 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.09474 | Reg=0.00269 | L2-Norm=16.386 | L2-Norm(final)=2.070 | acc=0.9844 | 4629.3 samples/s | 72.3 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09338 | Reg=0.00269 | L2-Norm=16.396 | L2-Norm(final)=2.073 | acc=0.9062 | 4649.3 samples/s | 72.6 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09199 | Reg=0.00269 | L2-Norm=16.407 | L2-Norm(final)=2.077 | acc=0.9375 | 4674.3 samples/s | 73.0 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09022 | Reg=0.00270 | L2-Norm=16.418 | L2-Norm(final)=2.079 | acc=0.9531 | 4665.5 samples/s | 72.9 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.08886 | Reg=0.00270 | L2-Norm=16.427 | L2-Norm(final)=2.082 | acc=0.9688 | 4762.5 samples/s | 74.4 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.08755 | Reg=0.00270 | L2-Norm=16.434 | L2-Norm(final)=2.084 | acc=0.9844 | 4599.3 samples/s | 71.9 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08588 | Reg=0.00270 | L2-Norm=16.442 | L2-Norm(final)=2.087 | acc=0.9531 | 4679.1 samples/s | 73.1 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08458 | Reg=0.00271 | L2-Norm=16.449 | L2-Norm(final)=2.090 | acc=0.9375 | 4716.5 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.21752 | Reg=0.00260 | L2-Norm=16.119 | L2-Norm(final)=2.013 | acc=0.7969 | 3622.3 samples/s | 56.6 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.05312 | Reg=0.00270 | L2-Norm=16.428 | L2-Norm(final)=2.004 | acc=0.9688 | 4114.4 samples/s | 64.3 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.03205 | Reg=0.00272 | L2-Norm=16.488 | L2-Norm(final)=2.002 | acc=0.9688 | 4462.9 samples/s | 69.7 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02426 | Reg=0.00272 | L2-Norm=16.487 | L2-Norm(final)=2.005 | acc=1.0000 | 4439.5 samples/s | 69.4 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01993 | Reg=0.00271 | L2-Norm=16.467 | L2-Norm(final)=2.009 | acc=0.9844 | 4441.1 samples/s | 69.4 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01707 | Reg=0.00270 | L2-Norm=16.441 | L2-Norm(final)=2.013 | acc=0.9844 | 4434.2 samples/s | 69.3 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01494 | Reg=0.00269 | L2-Norm=16.413 | L2-Norm(final)=2.017 | acc=1.0000 | 4481.6 samples/s | 70.0 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01327 | Reg=0.00268 | L2-Norm=16.383 | L2-Norm(final)=2.022 | acc=0.9844 | 4390.3 samples/s | 68.6 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01251 | Reg=0.00267 | L2-Norm=16.350 | L2-Norm(final)=2.026 | acc=0.9844 | 4408.7 samples/s | 68.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01147 | Reg=0.00266 | L2-Norm=16.319 | L2-Norm(final)=2.028 | acc=1.0000 | 4412.6 samples/s | 68.9 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01058 | Reg=0.00265 | L2-Norm=16.287 | L2-Norm(final)=2.032 | acc=1.0000 | 4474.5 samples/s | 69.9 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00977 | Reg=0.00264 | L2-Norm=16.257 | L2-Norm(final)=2.036 | acc=1.0000 | 1892.0 samples/s | 29.6 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00908 | Reg=0.00263 | L2-Norm=16.226 | L2-Norm(final)=2.040 | acc=1.0000 | 4392.2 samples/s | 68.6 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00845 | Reg=0.00262 | L2-Norm=16.194 | L2-Norm(final)=2.044 | acc=1.0000 | 4222.9 samples/s | 66.0 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00803 | Reg=0.00261 | L2-Norm=16.162 | L2-Norm(final)=2.048 | acc=1.0000 | 4330.8 samples/s | 67.7 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00765 | Reg=0.00260 | L2-Norm=16.131 | L2-Norm(final)=2.052 | acc=1.0000 | 4421.3 samples/s | 69.1 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00721 | Reg=0.00259 | L2-Norm=16.099 | L2-Norm(final)=2.055 | acc=1.0000 | 4393.8 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38421 | acc=0.6202 | tpr=0.4800 | fpr=0.0753 | 4259.2 samples/s | 16.6 steps/s
Avg test loss: 0.38164, Avg test acc: 0.62289, Avg tpr: 0.48353, Avg fpr: 0.07063, total FA: 551

Testing server on iccad2012
[Step=  50] | Loss=0.16293 | acc=0.8691 | tpr=0.9071 | fpr=0.1315 | 4188.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.16544 | acc=0.8675 | tpr=0.9254 | fpr=0.1336 | 8093.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.16682 | acc=0.8667 | tpr=0.9308 | fpr=0.1345 | 8333.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.16738 | acc=0.8662 | tpr=0.9355 | fpr=0.1351 | 8219.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.16775 | acc=0.8653 | tpr=0.9310 | fpr=0.1359 | 8714.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.16788 | acc=0.8651 | tpr=0.9331 | fpr=0.1362 | 7550.7 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.16825 | acc=0.8646 | tpr=0.9355 | fpr=0.1367 | 8107.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.16878 | acc=0.8640 | tpr=0.9311 | fpr=0.1372 | 8190.3 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.16945 | acc=0.8639 | tpr=0.9318 | fpr=0.1373 | 8090.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.16978 | acc=0.8636 | tpr=0.9326 | fpr=0.1376 | 8223.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.16937 | acc=0.8641 | tpr=0.9331 | fpr=0.1371 | 14700.5 samples/s | 57.4 steps/s
Avg test loss: 0.16925, Avg test acc: 0.86414, Avg tpr: 0.93265, Avg fpr: 0.13711, total FA: 19037

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.30985 | Reg=0.00241 | L2-Norm=15.526 | L2-Norm(final)=2.105 | acc=0.6406 | 3689.5 samples/s | 57.6 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.12237 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.105 | acc=0.9062 | 4413.1 samples/s | 69.0 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10432 | Reg=0.00247 | L2-Norm=15.727 | L2-Norm(final)=2.117 | acc=0.9688 | 4545.6 samples/s | 71.0 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09417 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.127 | acc=0.9531 | 4607.0 samples/s | 72.0 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09037 | Reg=0.00249 | L2-Norm=15.781 | L2-Norm(final)=2.134 | acc=0.9062 | 4675.7 samples/s | 73.1 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08823 | Reg=0.00250 | L2-Norm=15.803 | L2-Norm(final)=2.138 | acc=0.9688 | 4667.9 samples/s | 72.9 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08427 | Reg=0.00250 | L2-Norm=15.823 | L2-Norm(final)=2.143 | acc=0.9531 | 4574.5 samples/s | 71.5 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08105 | Reg=0.00251 | L2-Norm=15.840 | L2-Norm(final)=2.149 | acc=0.9375 | 4717.4 samples/s | 73.7 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07976 | Reg=0.00251 | L2-Norm=15.853 | L2-Norm(final)=2.152 | acc=0.9531 | 4625.2 samples/s | 72.3 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07888 | Reg=0.00252 | L2-Norm=15.863 | L2-Norm(final)=2.154 | acc=0.9062 | 4682.0 samples/s | 73.2 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07677 | Reg=0.00252 | L2-Norm=15.872 | L2-Norm(final)=2.156 | acc=0.9062 | 4653.0 samples/s | 72.7 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07543 | Reg=0.00252 | L2-Norm=15.883 | L2-Norm(final)=2.159 | acc=0.9531 | 4631.5 samples/s | 72.4 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07469 | Reg=0.00253 | L2-Norm=15.892 | L2-Norm(final)=2.160 | acc=0.9844 | 4658.8 samples/s | 72.8 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07388 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.162 | acc=0.9219 | 4646.4 samples/s | 72.6 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07259 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.164 | acc=0.9844 | 4693.7 samples/s | 73.3 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07144 | Reg=0.00254 | L2-Norm=15.923 | L2-Norm(final)=2.166 | acc=0.9219 | 4654.2 samples/s | 72.7 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07053 | Reg=0.00254 | L2-Norm=15.934 | L2-Norm(final)=2.168 | acc=0.9844 | 4630.2 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.05233 | Reg=0.00241 | L2-Norm=15.526 | L2-Norm(final)=2.107 | acc=0.9688 | 3764.5 samples/s | 58.8 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02421 | Reg=0.00246 | L2-Norm=15.675 | L2-Norm(final)=2.118 | acc=0.9844 | 4174.6 samples/s | 65.2 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01585 | Reg=0.00247 | L2-Norm=15.704 | L2-Norm(final)=2.115 | acc=1.0000 | 4417.4 samples/s | 69.0 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01265 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.119 | acc=1.0000 | 4420.2 samples/s | 69.1 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01071 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.122 | acc=1.0000 | 4398.7 samples/s | 68.7 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00951 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.124 | acc=1.0000 | 4489.0 samples/s | 70.1 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00891 | Reg=0.00245 | L2-Norm=15.660 | L2-Norm(final)=2.125 | acc=1.0000 | 4388.6 samples/s | 68.6 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00833 | Reg=0.00245 | L2-Norm=15.642 | L2-Norm(final)=2.126 | acc=1.0000 | 4412.1 samples/s | 68.9 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00780 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.127 | acc=1.0000 | 4460.0 samples/s | 69.7 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00716 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.129 | acc=0.9844 | 4418.2 samples/s | 69.0 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00670 | Reg=0.00243 | L2-Norm=15.586 | L2-Norm(final)=2.131 | acc=1.0000 | 4463.1 samples/s | 69.7 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00683 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.132 | acc=1.0000 | 1909.8 samples/s | 29.8 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00647 | Reg=0.00242 | L2-Norm=15.554 | L2-Norm(final)=2.133 | acc=0.9844 | 4502.9 samples/s | 70.4 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00627 | Reg=0.00241 | L2-Norm=15.539 | L2-Norm(final)=2.134 | acc=1.0000 | 4373.1 samples/s | 68.3 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00594 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.135 | acc=1.0000 | 4404.2 samples/s | 68.8 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00562 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.136 | acc=1.0000 | 4466.3 samples/s | 69.8 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00535 | Reg=0.00240 | L2-Norm=15.489 | L2-Norm(final)=2.138 | acc=1.0000 | 4363.8 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28488 | acc=0.7208 | tpr=0.6495 | fpr=0.1244 | 4269.2 samples/s | 16.7 steps/s
Avg test loss: 0.28229, Avg test acc: 0.72726, Avg tpr: 0.65752, Avg fpr: 0.11934, total FA: 931

Testing server on iccad2012
[Step=  50] | Loss=0.31390 | acc=0.7440 | tpr=0.9690 | fpr=0.2601 | 4197.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.31644 | acc=0.7455 | tpr=0.9787 | fpr=0.2588 | 8051.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.31970 | acc=0.7430 | tpr=0.9827 | fpr=0.2614 | 8019.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.32091 | acc=0.7421 | tpr=0.9847 | fpr=0.2623 | 8316.7 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.32096 | acc=0.7419 | tpr=0.9843 | fpr=0.2626 | 8459.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.32145 | acc=0.7417 | tpr=0.9855 | fpr=0.2628 | 7639.3 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.32209 | acc=0.7412 | tpr=0.9856 | fpr=0.2632 | 8177.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.32320 | acc=0.7412 | tpr=0.9847 | fpr=0.2632 | 8336.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.32444 | acc=0.7412 | tpr=0.9844 | fpr=0.2632 | 8245.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.32468 | acc=0.7410 | tpr=0.9841 | fpr=0.2634 | 8392.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.32425 | acc=0.7414 | tpr=0.9845 | fpr=0.2630 | 14179.5 samples/s | 55.4 steps/s
Avg test loss: 0.32410, Avg test acc: 0.74148, Avg tpr: 0.98455, Avg fpr: 0.26294, total FA: 36509

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.27552 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.176 | acc=0.7500 | 3914.1 samples/s | 61.2 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.10667 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.177 | acc=0.9844 | 4288.0 samples/s | 67.0 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09332 | Reg=0.00235 | L2-Norm=15.331 | L2-Norm(final)=2.189 | acc=0.9375 | 4615.6 samples/s | 72.1 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.08709 | Reg=0.00236 | L2-Norm=15.372 | L2-Norm(final)=2.192 | acc=0.9375 | 4549.6 samples/s | 71.1 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.08149 | Reg=0.00237 | L2-Norm=15.404 | L2-Norm(final)=2.198 | acc=0.9375 | 4637.4 samples/s | 72.5 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07826 | Reg=0.00238 | L2-Norm=15.429 | L2-Norm(final)=2.202 | acc=0.9375 | 4673.1 samples/s | 73.0 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07692 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.205 | acc=0.9062 | 4674.3 samples/s | 73.0 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.07517 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.207 | acc=0.9844 | 4661.6 samples/s | 72.8 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.07298 | Reg=0.00240 | L2-Norm=15.500 | L2-Norm(final)=2.209 | acc=0.9844 | 4628.4 samples/s | 72.3 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.07223 | Reg=0.00241 | L2-Norm=15.521 | L2-Norm(final)=2.211 | acc=0.9688 | 4670.0 samples/s | 73.0 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.07124 | Reg=0.00242 | L2-Norm=15.540 | L2-Norm(final)=2.211 | acc=0.9531 | 4665.6 samples/s | 72.9 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06968 | Reg=0.00242 | L2-Norm=15.558 | L2-Norm(final)=2.212 | acc=0.9688 | 4654.2 samples/s | 72.7 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06872 | Reg=0.00243 | L2-Norm=15.573 | L2-Norm(final)=2.212 | acc=0.9688 | 4641.8 samples/s | 72.5 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06755 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.213 | acc=0.8906 | 4639.9 samples/s | 72.5 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06641 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.213 | acc=0.9688 | 4695.4 samples/s | 73.4 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06545 | Reg=0.00244 | L2-Norm=15.621 | L2-Norm(final)=2.213 | acc=0.9844 | 4648.3 samples/s | 72.6 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06467 | Reg=0.00245 | L2-Norm=15.636 | L2-Norm(final)=2.213 | acc=0.9688 | 4684.1 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.12239 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.176 | acc=0.9062 | 3426.8 samples/s | 53.5 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01957 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.187 | acc=1.0000 | 4329.3 samples/s | 67.6 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01307 | Reg=0.00238 | L2-Norm=15.419 | L2-Norm(final)=2.187 | acc=1.0000 | 4489.1 samples/s | 70.1 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.01075 | Reg=0.00238 | L2-Norm=15.431 | L2-Norm(final)=2.188 | acc=1.0000 | 4437.9 samples/s | 69.3 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00911 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.190 | acc=1.0000 | 4357.8 samples/s | 68.1 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00826 | Reg=0.00238 | L2-Norm=15.413 | L2-Norm(final)=2.190 | acc=1.0000 | 4409.4 samples/s | 68.9 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00738 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.190 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00661 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.191 | acc=1.0000 | 4473.0 samples/s | 69.9 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00597 | Reg=0.00236 | L2-Norm=15.350 | L2-Norm(final)=2.193 | acc=1.0000 | 4389.8 samples/s | 68.6 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00566 | Reg=0.00235 | L2-Norm=15.326 | L2-Norm(final)=2.195 | acc=0.9844 | 4443.6 samples/s | 69.4 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00565 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.195 | acc=1.0000 | 4446.2 samples/s | 69.5 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00550 | Reg=0.00234 | L2-Norm=15.280 | L2-Norm(final)=2.196 | acc=1.0000 | 1881.5 samples/s | 29.4 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00508 | Reg=0.00233 | L2-Norm=15.257 | L2-Norm(final)=2.196 | acc=1.0000 | 4422.8 samples/s | 69.1 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00484 | Reg=0.00232 | L2-Norm=15.234 | L2-Norm(final)=2.197 | acc=1.0000 | 4401.7 samples/s | 68.8 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00454 | Reg=0.00231 | L2-Norm=15.209 | L2-Norm(final)=2.198 | acc=1.0000 | 4398.9 samples/s | 68.7 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00426 | Reg=0.00231 | L2-Norm=15.184 | L2-Norm(final)=2.199 | acc=1.0000 | 4409.7 samples/s | 68.9 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00402 | Reg=0.00230 | L2-Norm=15.158 | L2-Norm(final)=2.201 | acc=1.0000 | 4437.1 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40429 | acc=0.6229 | tpr=0.4856 | fpr=0.0790 | 4206.8 samples/s | 16.4 steps/s
Avg test loss: 0.40475, Avg test acc: 0.62341, Avg tpr: 0.48837, Avg fpr: 0.07961, total FA: 621

Testing server on iccad2012
[Step=  50] | Loss=0.21835 | acc=0.8427 | tpr=0.9646 | fpr=0.1595 | 4307.5 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.22214 | acc=0.8419 | tpr=0.9723 | fpr=0.1605 | 7862.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.22553 | acc=0.8395 | tpr=0.9755 | fpr=0.1631 | 8450.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.22578 | acc=0.8401 | tpr=0.9738 | fpr=0.1624 | 7792.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.22639 | acc=0.8392 | tpr=0.9747 | fpr=0.1633 | 8599.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.22688 | acc=0.8392 | tpr=0.9738 | fpr=0.1633 | 7953.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.22762 | acc=0.8391 | tpr=0.9737 | fpr=0.1634 | 8377.5 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.22835 | acc=0.8393 | tpr=0.9737 | fpr=0.1632 | 7798.4 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.22969 | acc=0.8387 | tpr=0.9742 | fpr=0.1637 | 8151.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.23019 | acc=0.8385 | tpr=0.9744 | fpr=0.1640 | 8240.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.22967 | acc=0.8387 | tpr=0.9741 | fpr=0.1637 | 14766.9 samples/s | 57.7 steps/s
Avg test loss: 0.22946, Avg test acc: 0.83874, Avg tpr: 0.97385, Avg fpr: 0.16372, total FA: 22732

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.31633 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.220 | acc=0.7656 | 3841.1 samples/s | 60.0 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.09612 | Reg=0.00225 | L2-Norm=15.009 | L2-Norm(final)=2.217 | acc=0.9688 | 4244.7 samples/s | 66.3 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.08335 | Reg=0.00227 | L2-Norm=15.059 | L2-Norm(final)=2.228 | acc=0.9531 | 4625.5 samples/s | 72.3 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07747 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.235 | acc=0.9844 | 4646.3 samples/s | 72.6 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.07378 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.240 | acc=0.9531 | 4623.5 samples/s | 72.2 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.07006 | Reg=0.00229 | L2-Norm=15.148 | L2-Norm(final)=2.244 | acc=0.9531 | 4642.2 samples/s | 72.5 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06772 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.248 | acc=0.9531 | 4556.9 samples/s | 71.2 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06576 | Reg=0.00231 | L2-Norm=15.199 | L2-Norm(final)=2.251 | acc=0.9688 | 4704.9 samples/s | 73.5 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06524 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.253 | acc=0.9531 | 4622.7 samples/s | 72.2 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.06435 | Reg=0.00232 | L2-Norm=15.241 | L2-Norm(final)=2.255 | acc=0.9688 | 4654.9 samples/s | 72.7 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.06367 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.256 | acc=0.9062 | 4656.4 samples/s | 72.8 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.06325 | Reg=0.00233 | L2-Norm=15.276 | L2-Norm(final)=2.256 | acc=0.9531 | 4643.5 samples/s | 72.6 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.06227 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.257 | acc=0.9688 | 4649.0 samples/s | 72.6 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.06168 | Reg=0.00234 | L2-Norm=15.307 | L2-Norm(final)=2.257 | acc=0.9531 | 4735.6 samples/s | 74.0 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.06017 | Reg=0.00235 | L2-Norm=15.322 | L2-Norm(final)=2.259 | acc=0.9688 | 4552.0 samples/s | 71.1 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05993 | Reg=0.00235 | L2-Norm=15.337 | L2-Norm(final)=2.259 | acc=0.9688 | 4618.4 samples/s | 72.2 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05936 | Reg=0.00236 | L2-Norm=15.352 | L2-Norm(final)=2.260 | acc=0.9844 | 4647.0 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.06877 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.222 | acc=0.9375 | 3553.6 samples/s | 55.5 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.01133 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.249 | acc=1.0000 | 4187.7 samples/s | 65.4 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00930 | Reg=0.00225 | L2-Norm=15.014 | L2-Norm(final)=2.250 | acc=1.0000 | 4441.7 samples/s | 69.4 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00924 | Reg=0.00226 | L2-Norm=15.038 | L2-Norm(final)=2.244 | acc=1.0000 | 4476.4 samples/s | 69.9 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00795 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.241 | acc=1.0000 | 4357.3 samples/s | 68.1 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00786 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.239 | acc=0.9844 | 4433.0 samples/s | 69.3 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00721 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.239 | acc=1.0000 | 4529.8 samples/s | 70.8 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00642 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.240 | acc=1.0000 | 4372.2 samples/s | 68.3 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00575 | Reg=0.00226 | L2-Norm=15.035 | L2-Norm(final)=2.240 | acc=1.0000 | 4450.5 samples/s | 69.5 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00531 | Reg=0.00226 | L2-Norm=15.019 | L2-Norm(final)=2.242 | acc=1.0000 | 4406.1 samples/s | 68.8 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00493 | Reg=0.00225 | L2-Norm=15.002 | L2-Norm(final)=2.244 | acc=1.0000 | 4480.0 samples/s | 70.0 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00465 | Reg=0.00225 | L2-Norm=14.984 | L2-Norm(final)=2.246 | acc=0.9844 | 1908.6 samples/s | 29.8 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00456 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.247 | acc=1.0000 | 4421.6 samples/s | 69.1 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00429 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.249 | acc=1.0000 | 4463.9 samples/s | 69.7 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00410 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.251 | acc=1.0000 | 4406.7 samples/s | 68.9 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00388 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.253 | acc=1.0000 | 4431.1 samples/s | 69.2 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00376 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.254 | acc=1.0000 | 4367.3 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27470 | acc=0.7516 | tpr=0.6786 | fpr=0.0899 | 4230.1 samples/s | 16.5 steps/s
Avg test loss: 0.27463, Avg test acc: 0.75294, Avg tpr: 0.68001, Avg fpr: 0.08666, total FA: 676

Testing server on iccad2012
[Step=  50] | Loss=0.31580 | acc=0.7738 | tpr=0.9779 | fpr=0.2298 | 4306.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.32060 | acc=0.7712 | tpr=0.9829 | fpr=0.2328 | 7805.7 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.32404 | acc=0.7682 | tpr=0.9870 | fpr=0.2359 | 8153.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.32454 | acc=0.7682 | tpr=0.9847 | fpr=0.2357 | 8186.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.32513 | acc=0.7685 | tpr=0.9852 | fpr=0.2354 | 8162.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.32556 | acc=0.7681 | tpr=0.9855 | fpr=0.2359 | 8291.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.32613 | acc=0.7681 | tpr=0.9856 | fpr=0.2359 | 7959.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.32783 | acc=0.7677 | tpr=0.9847 | fpr=0.2362 | 8212.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.32941 | acc=0.7672 | tpr=0.9849 | fpr=0.2368 | 8190.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.32971 | acc=0.7672 | tpr=0.9850 | fpr=0.2368 | 8112.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.32912 | acc=0.7675 | tpr=0.9837 | fpr=0.2364 | 15358.7 samples/s | 60.0 steps/s
Avg test loss: 0.32889, Avg test acc: 0.76751, Avg tpr: 0.98376, Avg fpr: 0.23642, total FA: 32826

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.15803 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.266 | acc=0.8594 | 3793.4 samples/s | 59.3 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.08634 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.268 | acc=0.9531 | 4205.2 samples/s | 65.7 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07481 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.279 | acc=0.9688 | 4633.5 samples/s | 72.4 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.06759 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.287 | acc=0.9844 | 4665.4 samples/s | 72.9 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06417 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.296 | acc=0.9688 | 4610.5 samples/s | 72.0 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06407 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.300 | acc=0.9844 | 4661.6 samples/s | 72.8 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06226 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.303 | acc=0.9375 | 4635.5 samples/s | 72.4 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06122 | Reg=0.00225 | L2-Norm=15.014 | L2-Norm(final)=2.305 | acc=0.9219 | 4654.2 samples/s | 72.7 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05973 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.308 | acc=0.9219 | 4634.7 samples/s | 72.4 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05867 | Reg=0.00227 | L2-Norm=15.060 | L2-Norm(final)=2.311 | acc=0.9688 | 4685.9 samples/s | 73.2 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05857 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.312 | acc=0.9219 | 4626.9 samples/s | 72.3 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05803 | Reg=0.00228 | L2-Norm=15.101 | L2-Norm(final)=2.313 | acc=0.9688 | 4672.5 samples/s | 73.0 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05736 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.313 | acc=0.9688 | 4656.4 samples/s | 72.8 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05684 | Reg=0.00229 | L2-Norm=15.139 | L2-Norm(final)=2.313 | acc=0.9688 | 4636.7 samples/s | 72.4 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05580 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.313 | acc=0.9375 | 4666.5 samples/s | 72.9 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05522 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.314 | acc=0.9375 | 4618.7 samples/s | 72.2 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05509 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.314 | acc=0.9375 | 4660.0 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.09607 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.267 | acc=0.9219 | 4231.1 samples/s | 66.1 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.01059 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.293 | acc=1.0000 | 3658.5 samples/s | 57.2 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00636 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.300 | acc=1.0000 | 4411.6 samples/s | 68.9 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00526 | Reg=0.00222 | L2-Norm=14.898 | L2-Norm(final)=2.305 | acc=1.0000 | 4445.7 samples/s | 69.5 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00456 | Reg=0.00221 | L2-Norm=14.881 | L2-Norm(final)=2.309 | acc=0.9844 | 4365.2 samples/s | 68.2 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00441 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.314 | acc=1.0000 | 4416.7 samples/s | 69.0 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00458 | Reg=0.00221 | L2-Norm=14.855 | L2-Norm(final)=2.316 | acc=1.0000 | 4465.5 samples/s | 69.8 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00440 | Reg=0.00220 | L2-Norm=14.843 | L2-Norm(final)=2.315 | acc=1.0000 | 4370.3 samples/s | 68.3 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00457 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.314 | acc=1.0000 | 4423.5 samples/s | 69.1 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00460 | Reg=0.00220 | L2-Norm=14.825 | L2-Norm(final)=2.312 | acc=0.9844 | 4391.6 samples/s | 68.6 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00442 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.311 | acc=1.0000 | 4473.4 samples/s | 69.9 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00420 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.311 | acc=1.0000 | 1888.1 samples/s | 29.5 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00399 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.312 | acc=1.0000 | 4424.7 samples/s | 69.1 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00374 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.313 | acc=1.0000 | 4363.9 samples/s | 68.2 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00348 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.315 | acc=1.0000 | 4396.6 samples/s | 68.7 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00335 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.317 | acc=1.0000 | 4402.9 samples/s | 68.8 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00334 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.319 | acc=1.0000 | 4433.1 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55520 | acc=0.5720 | tpr=0.4005 | fpr=0.0557 | 4307.3 samples/s | 16.8 steps/s
Avg test loss: 0.55645, Avg test acc: 0.57228, Avg tpr: 0.40141, Avg fpr: 0.05192, total FA: 405

Testing server on iccad2012
[Step=  50] | Loss=0.13655 | acc=0.9172 | tpr=0.9779 | fpr=0.0839 | 4199.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13919 | acc=0.9159 | tpr=0.9723 | fpr=0.0851 | 8304.9 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.14045 | acc=0.9159 | tpr=0.9741 | fpr=0.0851 | 8060.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.14084 | acc=0.9163 | tpr=0.9727 | fpr=0.0847 | 8038.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.14078 | acc=0.9159 | tpr=0.9747 | fpr=0.0852 | 8331.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.14136 | acc=0.9153 | tpr=0.9745 | fpr=0.0857 | 8433.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14207 | acc=0.9146 | tpr=0.9762 | fpr=0.0865 | 7909.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.14302 | acc=0.9137 | tpr=0.9748 | fpr=0.0874 | 8379.5 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.14452 | acc=0.9131 | tpr=0.9742 | fpr=0.0880 | 8143.6 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.14454 | acc=0.9131 | tpr=0.9740 | fpr=0.0880 | 8052.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.14439 | acc=0.9132 | tpr=0.9729 | fpr=0.0879 | 14973.0 samples/s | 58.5 steps/s
Avg test loss: 0.14422, Avg test acc: 0.91321, Avg tpr: 0.97266, Avg fpr: 0.08787, total FA: 12201

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.38180 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.308 | acc=0.7344 | 4287.2 samples/s | 67.0 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.10689 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.292 | acc=0.9688 | 3950.4 samples/s | 61.7 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.07988 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.313 | acc=0.9688 | 4661.7 samples/s | 72.8 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.07195 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.324 | acc=0.9688 | 4586.7 samples/s | 71.7 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.06957 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.328 | acc=0.9688 | 4639.0 samples/s | 72.5 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.06785 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.330 | acc=1.0000 | 4649.7 samples/s | 72.7 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.06480 | Reg=0.00224 | L2-Norm=14.979 | L2-Norm(final)=2.333 | acc=0.9688 | 4638.0 samples/s | 72.5 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.06305 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.332 | acc=0.9219 | 4636.5 samples/s | 72.4 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.06137 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.334 | acc=0.9219 | 4681.6 samples/s | 73.1 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05993 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.334 | acc=0.9688 | 4750.1 samples/s | 74.2 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05909 | Reg=0.00227 | L2-Norm=15.067 | L2-Norm(final)=2.333 | acc=0.9531 | 4599.0 samples/s | 71.9 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05797 | Reg=0.00228 | L2-Norm=15.087 | L2-Norm(final)=2.333 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05682 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.334 | acc=0.9688 | 4626.0 samples/s | 72.3 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.05524 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.336 | acc=0.9844 | 4674.0 samples/s | 73.0 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.05513 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.337 | acc=0.9844 | 4640.4 samples/s | 72.5 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.05479 | Reg=0.00230 | L2-Norm=15.171 | L2-Norm(final)=2.337 | acc=0.9844 | 4681.1 samples/s | 73.1 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.05463 | Reg=0.00231 | L2-Norm=15.191 | L2-Norm(final)=2.337 | acc=0.9531 | 4709.5 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.01262 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.311 | acc=1.0000 | 3894.8 samples/s | 60.9 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00601 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.355 | acc=1.0000 | 3830.3 samples/s | 59.8 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00894 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=2.357 | acc=1.0000 | 4457.2 samples/s | 69.6 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.01145 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.335 | acc=1.0000 | 4433.5 samples/s | 69.3 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00980 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.323 | acc=1.0000 | 4355.4 samples/s | 68.1 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00844 | Reg=0.00219 | L2-Norm=14.815 | L2-Norm(final)=2.317 | acc=1.0000 | 4368.5 samples/s | 68.3 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00747 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.313 | acc=1.0000 | 4429.0 samples/s | 69.2 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00674 | Reg=0.00220 | L2-Norm=14.828 | L2-Norm(final)=2.312 | acc=1.0000 | 4445.4 samples/s | 69.5 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00600 | Reg=0.00220 | L2-Norm=14.823 | L2-Norm(final)=2.312 | acc=1.0000 | 4456.0 samples/s | 69.6 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00555 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.313 | acc=1.0000 | 4373.3 samples/s | 68.3 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00503 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.314 | acc=1.0000 | 4468.8 samples/s | 69.8 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00460 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.316 | acc=1.0000 | 1895.5 samples/s | 29.6 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00424 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.318 | acc=1.0000 | 4486.8 samples/s | 70.1 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00393 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.320 | acc=1.0000 | 4368.1 samples/s | 68.3 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00367 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.323 | acc=1.0000 | 4389.9 samples/s | 68.6 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00351 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.326 | acc=1.0000 | 4427.1 samples/s | 69.2 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00341 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=2.329 | acc=1.0000 | 4376.2 samples/s | 68.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24553 | acc=0.7836 | tpr=0.7252 | fpr=0.0897 | 4222.2 samples/s | 16.5 steps/s
Avg test loss: 0.24833, Avg test acc: 0.78368, Avg tpr: 0.72594, Avg fpr: 0.08935, total FA: 697

Testing server on iccad2012
[Step=  50] | Loss=0.36742 | acc=0.7459 | tpr=0.9779 | fpr=0.2582 | 4242.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.37151 | acc=0.7461 | tpr=0.9787 | fpr=0.2582 | 8000.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.37488 | acc=0.7443 | tpr=0.9841 | fpr=0.2601 | 8343.7 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.37327 | acc=0.7454 | tpr=0.9836 | fpr=0.2590 | 8140.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.37462 | acc=0.7456 | tpr=0.9843 | fpr=0.2587 | 7982.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.37598 | acc=0.7447 | tpr=0.9840 | fpr=0.2597 | 8372.2 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.37626 | acc=0.7443 | tpr=0.9843 | fpr=0.2600 | 8150.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.37757 | acc=0.7439 | tpr=0.9841 | fpr=0.2605 | 8116.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.37886 | acc=0.7436 | tpr=0.9834 | fpr=0.2608 | 8335.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.37947 | acc=0.7432 | tpr=0.9841 | fpr=0.2611 | 7989.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.37920 | acc=0.7429 | tpr=0.9841 | fpr=0.2615 | 15470.5 samples/s | 60.4 steps/s
Avg test loss: 0.37901, Avg test acc: 0.74293, Avg tpr: 0.98415, Avg fpr: 0.26146, total FA: 36303

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.19954 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.346 | acc=0.8594 | 3473.8 samples/s | 54.3 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.08590 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.340 | acc=1.0000 | 4581.2 samples/s | 71.6 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.07241 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.348 | acc=1.0000 | 4621.6 samples/s | 72.2 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.06546 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.354 | acc=0.9062 | 4613.8 samples/s | 72.1 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.06317 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.356 | acc=0.9531 | 4617.8 samples/s | 72.2 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.06122 | Reg=0.00220 | L2-Norm=14.819 | L2-Norm(final)=2.361 | acc=0.9688 | 4624.0 samples/s | 72.3 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05893 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.364 | acc=0.9688 | 4660.8 samples/s | 72.8 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05821 | Reg=0.00222 | L2-Norm=14.882 | L2-Norm(final)=2.366 | acc=0.9844 | 4685.7 samples/s | 73.2 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.05681 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.368 | acc=1.0000 | 4632.4 samples/s | 72.4 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.05576 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.369 | acc=0.9688 | 4669.9 samples/s | 73.0 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.05488 | Reg=0.00224 | L2-Norm=14.964 | L2-Norm(final)=2.371 | acc=0.9375 | 4602.0 samples/s | 71.9 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.05509 | Reg=0.00225 | L2-Norm=14.990 | L2-Norm(final)=2.370 | acc=0.9375 | 4704.3 samples/s | 73.5 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.05488 | Reg=0.00226 | L2-Norm=15.016 | L2-Norm(final)=2.369 | acc=0.9688 | 4556.5 samples/s | 71.2 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.05431 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.370 | acc=0.9062 | 4659.2 samples/s | 72.8 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.05362 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.370 | acc=0.9844 | 4654.7 samples/s | 72.7 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.05305 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.371 | acc=0.9688 | 4694.1 samples/s | 73.3 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.05215 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.372 | acc=0.9688 | 4657.6 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.11827 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.348 | acc=0.8906 | 3560.9 samples/s | 55.6 steps/s
[Step=5650 Epoch=10.7] | Loss=0.01262 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.358 | acc=1.0000 | 4207.8 samples/s | 65.7 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00973 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.348 | acc=1.0000 | 4436.3 samples/s | 69.3 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00711 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.354 | acc=1.0000 | 4343.1 samples/s | 67.9 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00597 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.360 | acc=1.0000 | 4479.7 samples/s | 70.0 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00501 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.366 | acc=1.0000 | 4404.6 samples/s | 68.8 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00488 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.369 | acc=1.0000 | 4415.3 samples/s | 69.0 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00472 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.370 | acc=1.0000 | 4418.5 samples/s | 69.0 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00554 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.368 | acc=1.0000 | 4393.7 samples/s | 68.7 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00561 | Reg=0.00218 | L2-Norm=14.752 | L2-Norm(final)=2.364 | acc=1.0000 | 4471.5 samples/s | 69.9 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00525 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.362 | acc=1.0000 | 4452.6 samples/s | 69.6 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00486 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.361 | acc=1.0000 | 1934.2 samples/s | 30.2 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00457 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.362 | acc=1.0000 | 4339.1 samples/s | 67.8 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00428 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.363 | acc=1.0000 | 4384.3 samples/s | 68.5 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00403 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.365 | acc=1.0000 | 4450.9 samples/s | 69.5 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00388 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.367 | acc=1.0000 | 4443.7 samples/s | 69.4 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00373 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.369 | acc=1.0000 | 4356.9 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44440 | acc=0.6454 | tpr=0.5074 | fpr=0.0550 | 4155.4 samples/s | 16.2 steps/s
Avg test loss: 0.44594, Avg test acc: 0.64504, Avg tpr: 0.50825, Avg fpr: 0.05410, total FA: 422

Testing server on iccad2012
[Step=  50] | Loss=0.18391 | acc=0.8906 | tpr=0.9735 | fpr=0.1109 | 4358.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.18707 | acc=0.8896 | tpr=0.9829 | fpr=0.1122 | 7692.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.19026 | acc=0.8887 | tpr=0.9841 | fpr=0.1131 | 8243.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.19012 | acc=0.8895 | tpr=0.9847 | fpr=0.1122 | 7999.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.19092 | acc=0.8885 | tpr=0.9860 | fpr=0.1132 | 8171.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.19285 | acc=0.8879 | tpr=0.9855 | fpr=0.1138 | 7996.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.19382 | acc=0.8875 | tpr=0.9837 | fpr=0.1142 | 7067.0 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.19492 | acc=0.8868 | tpr=0.9830 | fpr=0.1150 | 6777.8 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.19616 | acc=0.8865 | tpr=0.9820 | fpr=0.1152 | 6927.0 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.19650 | acc=0.8861 | tpr=0.9819 | fpr=0.1156 | 6572.8 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.19589 | acc=0.8862 | tpr=0.9805 | fpr=0.1155 | 14325.3 samples/s | 56.0 steps/s
Avg test loss: 0.19569, Avg test acc: 0.88624, Avg tpr: 0.98059, Avg fpr: 0.11548, total FA: 16034

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.35326 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.387 | acc=0.6875 | 3569.6 samples/s | 55.8 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.09917 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.361 | acc=0.9688 | 4783.2 samples/s | 74.7 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.07477 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.382 | acc=0.9688 | 4809.1 samples/s | 75.1 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.06959 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.389 | acc=0.8594 | 4802.4 samples/s | 75.0 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.06554 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.390 | acc=0.9375 | 4779.4 samples/s | 74.7 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.06302 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.394 | acc=0.9688 | 4843.4 samples/s | 75.7 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.05993 | Reg=0.00223 | L2-Norm=14.947 | L2-Norm(final)=2.396 | acc=0.9688 | 4759.5 samples/s | 74.4 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.05714 | Reg=0.00224 | L2-Norm=14.979 | L2-Norm(final)=2.400 | acc=0.9844 | 4764.8 samples/s | 74.5 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.05671 | Reg=0.00225 | L2-Norm=15.009 | L2-Norm(final)=2.402 | acc=0.9688 | 4797.7 samples/s | 75.0 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.05526 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.404 | acc=0.9688 | 4816.7 samples/s | 75.3 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.05487 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.406 | acc=0.9844 | 4788.3 samples/s | 74.8 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.05379 | Reg=0.00228 | L2-Norm=15.097 | L2-Norm(final)=2.408 | acc=0.9844 | 4819.3 samples/s | 75.3 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.05316 | Reg=0.00229 | L2-Norm=15.124 | L2-Norm(final)=2.409 | acc=0.9375 | 4738.2 samples/s | 74.0 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.05233 | Reg=0.00230 | L2-Norm=15.149 | L2-Norm(final)=2.411 | acc=1.0000 | 4817.3 samples/s | 75.3 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.05181 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.412 | acc=0.9219 | 4798.6 samples/s | 75.0 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.05127 | Reg=0.00231 | L2-Norm=15.200 | L2-Norm(final)=2.412 | acc=0.9375 | 4911.3 samples/s | 76.7 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.05123 | Reg=0.00232 | L2-Norm=15.225 | L2-Norm(final)=2.412 | acc=0.9688 | 4877.0 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.02326 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.391 | acc=1.0000 | 3681.6 samples/s | 57.5 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00544 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.417 | acc=1.0000 | 4426.3 samples/s | 69.2 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00582 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.418 | acc=1.0000 | 4618.4 samples/s | 72.2 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00424 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.417 | acc=1.0000 | 4641.1 samples/s | 72.5 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00347 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.421 | acc=1.0000 | 4646.1 samples/s | 72.6 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00480 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.420 | acc=1.0000 | 4627.5 samples/s | 72.3 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00429 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.414 | acc=1.0000 | 4671.5 samples/s | 73.0 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00378 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.413 | acc=1.0000 | 4529.3 samples/s | 70.8 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00353 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=2.414 | acc=1.0000 | 4540.7 samples/s | 70.9 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00326 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.416 | acc=1.0000 | 4616.5 samples/s | 72.1 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00309 | Reg=0.00213 | L2-Norm=14.602 | L2-Norm(final)=2.418 | acc=1.0000 | 4468.6 samples/s | 69.8 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00303 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.419 | acc=1.0000 | 1957.5 samples/s | 30.6 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00288 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.420 | acc=1.0000 | 4794.2 samples/s | 74.9 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00276 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=2.421 | acc=1.0000 | 4566.0 samples/s | 71.3 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00274 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=2.423 | acc=1.0000 | 4566.3 samples/s | 71.3 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00270 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.422 | acc=1.0000 | 4533.1 samples/s | 70.8 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00274 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=2.422 | acc=1.0000 | 4553.2 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28601 | acc=0.7504 | tpr=0.6737 | fpr=0.0830 | 4352.3 samples/s | 17.0 steps/s
Avg test loss: 0.28863, Avg test acc: 0.74854, Avg tpr: 0.67080, Avg fpr: 0.08050, total FA: 628

Testing server on iccad2012
[Step=  50] | Loss=0.23390 | acc=0.8463 | tpr=0.9690 | fpr=0.1559 | 4385.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.23405 | acc=0.8475 | tpr=0.9765 | fpr=0.1549 | 8669.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.23790 | acc=0.8446 | tpr=0.9813 | fpr=0.1580 | 8541.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.23701 | acc=0.8451 | tpr=0.9803 | fpr=0.1574 | 8391.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.23785 | acc=0.8446 | tpr=0.9817 | fpr=0.1579 | 8770.3 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.23890 | acc=0.8441 | tpr=0.9804 | fpr=0.1584 | 9097.5 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.23933 | acc=0.8443 | tpr=0.9806 | fpr=0.1582 | 8320.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.24042 | acc=0.8437 | tpr=0.9798 | fpr=0.1588 | 8545.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.24200 | acc=0.8429 | tpr=0.9796 | fpr=0.1596 | 8714.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.24224 | acc=0.8427 | tpr=0.9797 | fpr=0.1598 | 8244.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.24142 | acc=0.8432 | tpr=0.9785 | fpr=0.1592 | 15793.1 samples/s | 61.7 steps/s
Avg test loss: 0.24128, Avg test acc: 0.84323, Avg tpr: 0.97861, Avg fpr: 0.15923, total FA: 22109

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.23401 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=2.397 | acc=0.8125 | 3718.2 samples/s | 58.1 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.08801 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.388 | acc=0.9062 | 4558.4 samples/s | 71.2 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.06857 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.407 | acc=0.9375 | 4783.4 samples/s | 74.7 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.06160 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.415 | acc=0.9531 | 4844.6 samples/s | 75.7 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.05852 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.421 | acc=0.9531 | 4784.8 samples/s | 74.8 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.05810 | Reg=0.00221 | L2-Norm=14.878 | L2-Norm(final)=2.424 | acc=0.9531 | 4877.1 samples/s | 76.2 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.05552 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.427 | acc=0.9688 | 4884.7 samples/s | 76.3 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.05353 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.432 | acc=0.9531 | 4953.0 samples/s | 77.4 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.05213 | Reg=0.00224 | L2-Norm=14.967 | L2-Norm(final)=2.435 | acc=0.9688 | 4882.0 samples/s | 76.3 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.05112 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.438 | acc=1.0000 | 4902.6 samples/s | 76.6 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.05118 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.437 | acc=0.9844 | 4805.8 samples/s | 75.1 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.05057 | Reg=0.00226 | L2-Norm=15.042 | L2-Norm(final)=2.437 | acc=0.9844 | 4780.7 samples/s | 74.7 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.05022 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.435 | acc=0.9844 | 4800.9 samples/s | 75.0 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04957 | Reg=0.00228 | L2-Norm=15.086 | L2-Norm(final)=2.434 | acc=0.9844 | 4786.8 samples/s | 74.8 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04886 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.434 | acc=1.0000 | 4829.0 samples/s | 75.5 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04921 | Reg=0.00229 | L2-Norm=15.131 | L2-Norm(final)=2.432 | acc=0.9688 | 4871.3 samples/s | 76.1 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04884 | Reg=0.00230 | L2-Norm=15.153 | L2-Norm(final)=2.431 | acc=0.9844 | 4770.0 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.09714 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=2.396 | acc=0.9375 | 3796.0 samples/s | 59.3 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00836 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.433 | acc=1.0000 | 4428.7 samples/s | 69.2 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00488 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.448 | acc=1.0000 | 4521.5 samples/s | 70.6 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00545 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.448 | acc=0.9844 | 4513.1 samples/s | 70.5 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00519 | Reg=0.00218 | L2-Norm=14.749 | L2-Norm(final)=2.443 | acc=1.0000 | 4546.6 samples/s | 71.0 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00447 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.441 | acc=1.0000 | 4509.5 samples/s | 70.5 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00425 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.439 | acc=1.0000 | 4576.0 samples/s | 71.5 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00408 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.440 | acc=1.0000 | 4577.7 samples/s | 71.5 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00368 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.441 | acc=1.0000 | 4516.2 samples/s | 70.6 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00330 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.444 | acc=1.0000 | 4540.9 samples/s | 71.0 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00300 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.447 | acc=1.0000 | 4597.7 samples/s | 71.8 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00274 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.451 | acc=1.0000 | 1975.2 samples/s | 30.9 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00251 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.455 | acc=1.0000 | 4560.3 samples/s | 71.3 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00232 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.458 | acc=1.0000 | 4512.3 samples/s | 70.5 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00216 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.462 | acc=1.0000 | 4554.4 samples/s | 71.2 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00202 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=2.465 | acc=1.0000 | 4466.7 samples/s | 69.8 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00189 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=2.468 | acc=1.0000 | 4542.8 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35130 | acc=0.7180 | tpr=0.6113 | fpr=0.0503 | 4386.3 samples/s | 17.1 steps/s
Avg test loss: 0.35318, Avg test acc: 0.71817, Avg tpr: 0.61159, Avg fpr: 0.04743, total FA: 370

Testing server on iccad2012
[Step=  50] | Loss=0.20732 | acc=0.8853 | tpr=0.9646 | fpr=0.1161 | 4393.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.21007 | acc=0.8838 | tpr=0.9701 | fpr=0.1178 | 8286.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.21474 | acc=0.8815 | tpr=0.9726 | fpr=0.1201 | 8609.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.21468 | acc=0.8829 | tpr=0.9760 | fpr=0.1188 | 8714.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.21467 | acc=0.8819 | tpr=0.9790 | fpr=0.1199 | 8755.9 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.21614 | acc=0.8815 | tpr=0.9767 | fpr=0.1202 | 8774.0 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.21648 | acc=0.8818 | tpr=0.9768 | fpr=0.1199 | 8205.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.21741 | acc=0.8812 | tpr=0.9759 | fpr=0.1205 | 9003.6 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.21906 | acc=0.8809 | tpr=0.9752 | fpr=0.1209 | 8211.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.21921 | acc=0.8807 | tpr=0.9758 | fpr=0.1210 | 8719.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.21866 | acc=0.8809 | tpr=0.9753 | fpr=0.1208 | 15206.5 samples/s | 59.4 steps/s
Avg test loss: 0.21844, Avg test acc: 0.88093, Avg tpr: 0.97504, Avg fpr: 0.12078, total FA: 16770

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.38854 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=2.451 | acc=0.7500 | 3854.1 samples/s | 60.2 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.07254 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=2.443 | acc=0.9844 | 4656.6 samples/s | 72.8 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.05342 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=2.457 | acc=0.9688 | 4578.8 samples/s | 71.5 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.04784 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.468 | acc=1.0000 | 4893.8 samples/s | 76.5 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04393 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.476 | acc=0.9688 | 4895.0 samples/s | 76.5 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04278 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=2.484 | acc=0.9844 | 4891.1 samples/s | 76.4 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.04142 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.489 | acc=0.9688 | 4876.6 samples/s | 76.2 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.04006 | Reg=0.00213 | L2-Norm=14.577 | L2-Norm(final)=2.494 | acc=0.9688 | 4805.5 samples/s | 75.1 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03979 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.497 | acc=0.9688 | 4725.2 samples/s | 73.8 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03911 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.502 | acc=0.9531 | 4785.6 samples/s | 74.8 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03879 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.506 | acc=0.9531 | 4777.9 samples/s | 74.7 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03794 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.510 | acc=0.9688 | 4788.4 samples/s | 74.8 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03777 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.514 | acc=0.9844 | 4816.0 samples/s | 75.2 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03696 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.518 | acc=1.0000 | 4679.5 samples/s | 73.1 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03654 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.522 | acc=0.9531 | 4129.8 samples/s | 64.5 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03619 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.525 | acc=1.0000 | 4391.8 samples/s | 68.6 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03583 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.528 | acc=0.9844 | 4188.9 samples/s | 65.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.03717 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=2.454 | acc=0.9688 | 3474.1 samples/s | 54.3 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00616 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.477 | acc=1.0000 | 3729.7 samples/s | 58.3 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00335 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=2.486 | acc=1.0000 | 3970.2 samples/s | 62.0 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00231 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=2.496 | acc=1.0000 | 3944.4 samples/s | 61.6 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00179 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=2.504 | acc=1.0000 | 3969.6 samples/s | 62.0 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00157 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=2.510 | acc=1.0000 | 3968.1 samples/s | 62.0 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00134 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=2.515 | acc=1.0000 | 3933.0 samples/s | 61.5 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00121 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=2.520 | acc=1.0000 | 4429.2 samples/s | 69.2 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00118 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=2.525 | acc=1.0000 | 4636.9 samples/s | 72.5 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00108 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=2.528 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00099 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=2.532 | acc=1.0000 | 4605.8 samples/s | 72.0 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00093 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=2.535 | acc=1.0000 | 1969.0 samples/s | 30.8 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00086 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.538 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00080 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.542 | acc=1.0000 | 4537.7 samples/s | 70.9 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00074 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=2.545 | acc=1.0000 | 4490.9 samples/s | 70.2 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00070 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.547 | acc=1.0000 | 4534.6 samples/s | 70.9 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00066 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.550 | acc=1.0000 | 4523.1 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26053 | acc=0.8009 | tpr=0.7210 | fpr=0.0258 | 4398.9 samples/s | 17.2 steps/s
Avg test loss: 0.26477, Avg test acc: 0.80083, Avg tpr: 0.72198, Avg fpr: 0.02577, total FA: 201

Testing server on iccad2012
[Step=  50] | Loss=0.32569 | acc=0.8172 | tpr=0.9690 | fpr=0.1855 | 4362.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.33032 | acc=0.8160 | tpr=0.9787 | fpr=0.1870 | 8687.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.33608 | acc=0.8150 | tpr=0.9813 | fpr=0.1881 | 8384.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.33559 | acc=0.8162 | tpr=0.9836 | fpr=0.1869 | 8626.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.33519 | acc=0.8160 | tpr=0.9852 | fpr=0.1871 | 8688.7 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.33627 | acc=0.8161 | tpr=0.9833 | fpr=0.1869 | 9182.4 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.33708 | acc=0.8159 | tpr=0.9837 | fpr=0.1872 | 7879.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.33819 | acc=0.8153 | tpr=0.9830 | fpr=0.1877 | 9216.1 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.34043 | acc=0.8150 | tpr=0.9825 | fpr=0.1881 | 8236.5 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.34045 | acc=0.8149 | tpr=0.9824 | fpr=0.1881 | 8367.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.33975 | acc=0.8150 | tpr=0.9817 | fpr=0.1880 | 15586.2 samples/s | 60.9 steps/s
Avg test loss: 0.33952, Avg test acc: 0.81503, Avg tpr: 0.98138, Avg fpr: 0.18800, total FA: 26103

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.16773 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.578 | acc=0.8750 | 3773.9 samples/s | 59.0 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04803 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.576 | acc=0.9688 | 4564.8 samples/s | 71.3 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03885 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=2.587 | acc=0.9531 | 4918.4 samples/s | 76.8 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03858 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=2.594 | acc=0.9688 | 4795.4 samples/s | 74.9 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03700 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.599 | acc=0.9844 | 4840.7 samples/s | 75.6 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03660 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=2.605 | acc=0.9688 | 4853.4 samples/s | 75.8 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.03518 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.612 | acc=0.9531 | 4743.4 samples/s | 74.1 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.03548 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=2.616 | acc=0.9844 | 4847.0 samples/s | 75.7 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.03437 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=2.620 | acc=0.9688 | 4787.4 samples/s | 74.8 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.03390 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.625 | acc=1.0000 | 4841.0 samples/s | 75.6 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.03383 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.629 | acc=0.9844 | 4753.1 samples/s | 74.3 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.03387 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.631 | acc=0.9531 | 4761.6 samples/s | 74.4 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.03347 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.634 | acc=0.9844 | 4822.9 samples/s | 75.4 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.03326 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=2.638 | acc=1.0000 | 4779.1 samples/s | 74.7 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.03333 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=2.641 | acc=0.9688 | 4771.2 samples/s | 74.5 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.03320 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.644 | acc=0.9844 | 4778.9 samples/s | 74.7 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.03310 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=2.646 | acc=0.9844 | 4856.3 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.03213 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.579 | acc=0.9688 | 4080.8 samples/s | 63.8 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00874 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=2.588 | acc=1.0000 | 4069.8 samples/s | 63.6 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00500 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.589 | acc=1.0000 | 4540.9 samples/s | 71.0 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00400 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=2.595 | acc=1.0000 | 4531.9 samples/s | 70.8 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00315 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=2.600 | acc=1.0000 | 4511.9 samples/s | 70.5 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00255 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=2.605 | acc=1.0000 | 4537.0 samples/s | 70.9 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00214 | Reg=0.00206 | L2-Norm=14.338 | L2-Norm(final)=2.610 | acc=1.0000 | 4522.4 samples/s | 70.7 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00220 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=2.614 | acc=1.0000 | 4506.2 samples/s | 70.4 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00210 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.617 | acc=1.0000 | 4505.6 samples/s | 70.4 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00201 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.619 | acc=1.0000 | 4582.6 samples/s | 71.6 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00208 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=2.621 | acc=1.0000 | 4538.5 samples/s | 70.9 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00194 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=2.622 | acc=1.0000 | 1927.3 samples/s | 30.1 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00179 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=2.623 | acc=1.0000 | 4594.2 samples/s | 71.8 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00168 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.625 | acc=1.0000 | 4571.5 samples/s | 71.4 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00157 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.627 | acc=1.0000 | 4486.9 samples/s | 70.1 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00147 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.629 | acc=1.0000 | 4564.8 samples/s | 71.3 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00139 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.631 | acc=1.0000 | 4595.1 samples/s | 71.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48183 | acc=0.6721 | tpr=0.5305 | fpr=0.0203 | 4394.0 samples/s | 17.2 steps/s
Avg test loss: 0.48758, Avg test acc: 0.67373, Avg tpr: 0.53383, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.19785 | acc=0.9014 | tpr=0.9735 | fpr=0.0999 | 4400.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.20164 | acc=0.9005 | tpr=0.9808 | fpr=0.1010 | 8537.3 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.20623 | acc=0.8979 | tpr=0.9798 | fpr=0.1036 | 9211.1 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.20655 | acc=0.8989 | tpr=0.9825 | fpr=0.1026 | 8443.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.20582 | acc=0.8988 | tpr=0.9834 | fpr=0.1028 | 8284.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.20736 | acc=0.8985 | tpr=0.9811 | fpr=0.1031 | 8490.0 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.20860 | acc=0.8979 | tpr=0.9812 | fpr=0.1037 | 8710.3 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.20953 | acc=0.8971 | tpr=0.9798 | fpr=0.1044 | 8603.8 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.21099 | acc=0.8968 | tpr=0.9800 | fpr=0.1047 | 8597.7 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.21095 | acc=0.8968 | tpr=0.9802 | fpr=0.1047 | 8801.1 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.21015 | acc=0.8970 | tpr=0.9785 | fpr=0.1044 | 15457.4 samples/s | 60.4 steps/s
Avg test loss: 0.20999, Avg test acc: 0.89704, Avg tpr: 0.97781, Avg fpr: 0.10443, total FA: 14500

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.49767 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=2.669 | acc=0.7031 | 3589.2 samples/s | 56.1 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.06685 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.645 | acc=0.9844 | 4806.4 samples/s | 75.1 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.05016 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.658 | acc=0.9844 | 4944.9 samples/s | 77.3 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.04408 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=2.668 | acc=0.9688 | 4871.8 samples/s | 76.1 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.04126 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.675 | acc=0.9688 | 4915.1 samples/s | 76.8 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.04026 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=2.680 | acc=1.0000 | 4904.2 samples/s | 76.6 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.03916 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=2.686 | acc=0.9688 | 4968.7 samples/s | 77.6 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.03856 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=2.690 | acc=1.0000 | 4889.9 samples/s | 76.4 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.03758 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.695 | acc=1.0000 | 4939.3 samples/s | 77.2 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.03671 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=2.700 | acc=0.9844 | 4894.0 samples/s | 76.5 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.03592 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=2.705 | acc=0.9844 | 4933.2 samples/s | 77.1 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.03557 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=2.710 | acc=0.9844 | 4948.1 samples/s | 77.3 steps/s
[Step=10200 Epoch=10.0] | Loss=0.03511 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=2.714 | acc=0.9844 | 4955.8 samples/s | 77.4 steps/s
[Step=10250 Epoch=10.0] | Loss=0.03467 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.719 | acc=0.9688 | 4919.9 samples/s | 76.9 steps/s
[Step=10300 Epoch=10.1] | Loss=0.03425 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.722 | acc=0.9844 | 4875.0 samples/s | 76.2 steps/s
[Step=10350 Epoch=10.1] | Loss=0.03407 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=2.726 | acc=0.9688 | 4813.1 samples/s | 75.2 steps/s
[Step=10400 Epoch=10.2] | Loss=0.03359 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=2.730 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.02019 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=2.672 | acc=0.9844 | 3672.7 samples/s | 57.4 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00503 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.689 | acc=1.0000 | 4382.2 samples/s | 68.5 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00375 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.689 | acc=1.0000 | 4523.7 samples/s | 70.7 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00270 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.694 | acc=1.0000 | 4550.1 samples/s | 71.1 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00207 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=2.700 | acc=1.0000 | 4553.4 samples/s | 71.1 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00168 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.706 | acc=1.0000 | 4542.0 samples/s | 71.0 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00141 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.711 | acc=1.0000 | 4551.5 samples/s | 71.1 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00122 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=2.715 | acc=1.0000 | 4562.9 samples/s | 71.3 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00107 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=2.719 | acc=1.0000 | 4587.4 samples/s | 71.7 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00096 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=2.722 | acc=1.0000 | 4586.8 samples/s | 71.7 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00087 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=2.726 | acc=1.0000 | 4564.9 samples/s | 71.3 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00081 | Reg=0.00197 | L2-Norm=14.032 | L2-Norm(final)=2.729 | acc=1.0000 | 1992.5 samples/s | 31.1 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00075 | Reg=0.00196 | L2-Norm=14.015 | L2-Norm(final)=2.732 | acc=1.0000 | 4730.6 samples/s | 73.9 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00069 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=2.735 | acc=1.0000 | 4634.5 samples/s | 72.4 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00064 | Reg=0.00195 | L2-Norm=13.978 | L2-Norm(final)=2.738 | acc=1.0000 | 4516.5 samples/s | 70.6 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00060 | Reg=0.00195 | L2-Norm=13.958 | L2-Norm(final)=2.741 | acc=1.0000 | 4523.9 samples/s | 70.7 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00056 | Reg=0.00194 | L2-Norm=13.939 | L2-Norm(final)=2.743 | acc=1.0000 | 4532.3 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18482 | acc=0.8573 | tpr=0.8024 | fpr=0.0235 | 4445.1 samples/s | 17.4 steps/s
Avg test loss: 0.18797, Avg test acc: 0.85700, Avg tpr: 0.80206, Avg fpr: 0.02218, total FA: 173

Testing server on iccad2012
[Step=  50] | Loss=0.43795 | acc=0.7567 | tpr=0.9690 | fpr=0.2471 | 4407.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.44487 | acc=0.7559 | tpr=0.9808 | fpr=0.2483 | 8627.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.45181 | acc=0.7539 | tpr=0.9813 | fpr=0.2503 | 9454.2 samples/s | 36.9 steps/s
[Step= 200] | Loss=0.45115 | acc=0.7545 | tpr=0.9836 | fpr=0.2496 | 7799.5 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.45179 | acc=0.7541 | tpr=0.9860 | fpr=0.2501 | 9146.4 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.45338 | acc=0.7540 | tpr=0.9855 | fpr=0.2502 | 8582.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.45373 | acc=0.7536 | tpr=0.9850 | fpr=0.2506 | 8310.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.45475 | acc=0.7532 | tpr=0.9847 | fpr=0.2511 | 8765.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.45650 | acc=0.7531 | tpr=0.9844 | fpr=0.2511 | 8483.0 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.45701 | acc=0.7531 | tpr=0.9841 | fpr=0.2511 | 8520.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.45589 | acc=0.7536 | tpr=0.9833 | fpr=0.2506 | 15103.1 samples/s | 59.0 steps/s
Avg test loss: 0.45558, Avg test acc: 0.75357, Avg tpr: 0.98336, Avg fpr: 0.25060, total FA: 34796

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.07851 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=2.782 | acc=0.9062 | 3944.2 samples/s | 61.6 steps/s
[Step=10450 Epoch=10.2] | Loss=0.04322 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.788 | acc=0.9844 | 4359.6 samples/s | 68.1 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03815 | Reg=0.00197 | L2-Norm=14.053 | L2-Norm(final)=2.795 | acc=0.9844 | 4775.0 samples/s | 74.6 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03641 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=2.800 | acc=0.9531 | 4802.7 samples/s | 75.0 steps/s
[Step=10600 Epoch=10.3] | Loss=0.03689 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=2.803 | acc=0.9531 | 4693.6 samples/s | 73.3 steps/s
[Step=10650 Epoch=10.4] | Loss=0.03686 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=2.805 | acc=0.9688 | 4798.4 samples/s | 75.0 steps/s
[Step=10700 Epoch=10.4] | Loss=0.03599 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.809 | acc=0.9375 | 4720.7 samples/s | 73.8 steps/s
[Step=10750 Epoch=10.5] | Loss=0.03506 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=2.814 | acc=0.9688 | 4851.3 samples/s | 75.8 steps/s
[Step=10800 Epoch=10.5] | Loss=0.03465 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=2.818 | acc=1.0000 | 4750.3 samples/s | 74.2 steps/s
[Step=10850 Epoch=10.6] | Loss=0.03444 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.823 | acc=0.9688 | 4751.1 samples/s | 74.2 steps/s
[Step=10900 Epoch=10.6] | Loss=0.03354 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.828 | acc=0.9531 | 4771.0 samples/s | 74.5 steps/s
[Step=10950 Epoch=10.7] | Loss=0.03277 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.832 | acc=0.9844 | 4814.6 samples/s | 75.2 steps/s
[Step=11000 Epoch=10.7] | Loss=0.03266 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.836 | acc=0.9531 | 4776.4 samples/s | 74.6 steps/s
[Step=11050 Epoch=10.8] | Loss=0.03220 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.840 | acc=0.9844 | 4788.8 samples/s | 74.8 steps/s
[Step=11100 Epoch=10.8] | Loss=0.03207 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.843 | acc=1.0000 | 4818.7 samples/s | 75.3 steps/s
[Step=11150 Epoch=10.9] | Loss=0.03183 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.846 | acc=0.9688 | 4802.7 samples/s | 75.0 steps/s
[Step=11200 Epoch=10.9] | Loss=0.03158 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=2.849 | acc=0.9844 | 4763.9 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.06511 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=2.781 | acc=0.9531 | 3759.1 samples/s | 58.7 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00662 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=2.791 | acc=1.0000 | 4229.8 samples/s | 66.1 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00750 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=2.790 | acc=0.9844 | 4659.4 samples/s | 72.8 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00753 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.770 | acc=0.9844 | 4624.6 samples/s | 72.3 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00641 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.761 | acc=1.0000 | 4515.6 samples/s | 70.6 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00545 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.758 | acc=1.0000 | 4600.0 samples/s | 71.9 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00466 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.758 | acc=1.0000 | 4507.6 samples/s | 70.4 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00411 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.759 | acc=1.0000 | 4700.5 samples/s | 73.4 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00367 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=2.761 | acc=1.0000 | 4573.9 samples/s | 71.5 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00332 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=2.764 | acc=1.0000 | 4586.5 samples/s | 71.7 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00302 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=2.766 | acc=1.0000 | 4565.3 samples/s | 71.3 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00276 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.769 | acc=1.0000 | 1942.0 samples/s | 30.3 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00254 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.772 | acc=1.0000 | 4740.3 samples/s | 74.1 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00234 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=2.774 | acc=1.0000 | 4612.8 samples/s | 72.1 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00218 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=2.777 | acc=1.0000 | 4630.4 samples/s | 72.4 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00204 | Reg=0.00198 | L2-Norm=14.070 | L2-Norm(final)=2.779 | acc=1.0000 | 4600.6 samples/s | 71.9 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00191 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=2.781 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.68542 | acc=0.5761 | tpr=0.3867 | fpr=0.0126 | 4432.4 samples/s | 17.3 steps/s
Avg test loss: 0.69030, Avg test acc: 0.57637, Avg tpr: 0.38946, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.18300 | acc=0.9220 | tpr=0.9690 | fpr=0.0788 | 4445.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.18886 | acc=0.9200 | tpr=0.9787 | fpr=0.0811 | 8413.1 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.19363 | acc=0.9181 | tpr=0.9798 | fpr=0.0831 | 8684.7 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.19327 | acc=0.9189 | tpr=0.9825 | fpr=0.0823 | 8570.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.19249 | acc=0.9185 | tpr=0.9852 | fpr=0.0827 | 8535.7 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.19412 | acc=0.9179 | tpr=0.9840 | fpr=0.0833 | 8510.8 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.19499 | acc=0.9176 | tpr=0.9831 | fpr=0.0836 | 9061.0 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.19542 | acc=0.9174 | tpr=0.9825 | fpr=0.0838 | 8298.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.19775 | acc=0.9166 | tpr=0.9815 | fpr=0.0846 | 8597.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.19796 | acc=0.9162 | tpr=0.9815 | fpr=0.0850 | 9005.6 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.19706 | acc=0.9162 | tpr=0.9813 | fpr=0.0849 | 14547.2 samples/s | 56.8 steps/s
Avg test loss: 0.19688, Avg test acc: 0.91633, Avg tpr: 0.98138, Avg fpr: 0.08486, total FA: 11782

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.47376 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=2.852 | acc=0.6875 | 3780.1 samples/s | 59.1 steps/s
[Step=11250 Epoch=11.0] | Loss=0.07533 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.825 | acc=0.9531 | 4758.8 samples/s | 74.4 steps/s
[Step=11300 Epoch=11.0] | Loss=0.05502 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.838 | acc=0.9844 | 4894.5 samples/s | 76.5 steps/s
[Step=11350 Epoch=11.1] | Loss=0.04792 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=2.850 | acc=0.9531 | 4932.3 samples/s | 77.1 steps/s
[Step=11400 Epoch=11.1] | Loss=0.04301 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.858 | acc=0.9844 | 4705.8 samples/s | 73.5 steps/s
[Step=11450 Epoch=11.2] | Loss=0.04094 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.865 | acc=0.9844 | 4764.8 samples/s | 74.5 steps/s
[Step=11500 Epoch=11.2] | Loss=0.03891 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=2.871 | acc=0.9531 | 4789.5 samples/s | 74.8 steps/s
[Step=11550 Epoch=11.3] | Loss=0.03814 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.876 | acc=0.9844 | 4756.5 samples/s | 74.3 steps/s
[Step=11600 Epoch=11.3] | Loss=0.03660 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=2.881 | acc=0.9688 | 4762.7 samples/s | 74.4 steps/s
[Step=11650 Epoch=11.4] | Loss=0.03627 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=2.885 | acc=0.9688 | 4808.3 samples/s | 75.1 steps/s
[Step=11700 Epoch=11.4] | Loss=0.03576 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.888 | acc=0.9688 | 4838.4 samples/s | 75.6 steps/s
[Step=11750 Epoch=11.5] | Loss=0.03524 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.892 | acc=0.9688 | 4724.3 samples/s | 73.8 steps/s
[Step=11800 Epoch=11.5] | Loss=0.03484 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.895 | acc=1.0000 | 4781.9 samples/s | 74.7 steps/s
[Step=11850 Epoch=11.6] | Loss=0.03431 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.898 | acc=0.9844 | 4753.0 samples/s | 74.3 steps/s
[Step=11900 Epoch=11.6] | Loss=0.03439 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.901 | acc=0.9844 | 4812.7 samples/s | 75.2 steps/s
[Step=11950 Epoch=11.7] | Loss=0.03405 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=2.903 | acc=0.9844 | 4931.3 samples/s | 77.1 steps/s
[Step=12000 Epoch=11.7] | Loss=0.03382 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=2.904 | acc=0.9688 | 4743.2 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.01319 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=2.854 | acc=0.9844 | 3766.4 samples/s | 58.9 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00380 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.869 | acc=1.0000 | 4511.2 samples/s | 70.5 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00364 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.874 | acc=1.0000 | 4577.9 samples/s | 71.5 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00385 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.877 | acc=0.9844 | 4542.5 samples/s | 71.0 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00396 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.872 | acc=1.0000 | 4588.0 samples/s | 71.7 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00387 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=2.865 | acc=1.0000 | 4602.3 samples/s | 71.9 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00345 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=2.861 | acc=1.0000 | 4725.1 samples/s | 73.8 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00301 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.860 | acc=1.0000 | 4635.3 samples/s | 72.4 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00278 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.861 | acc=1.0000 | 4625.1 samples/s | 72.3 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00248 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=2.862 | acc=1.0000 | 4608.3 samples/s | 72.0 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00229 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=2.864 | acc=1.0000 | 4539.1 samples/s | 70.9 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00209 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=2.866 | acc=1.0000 | 1951.4 samples/s | 30.5 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00192 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=2.868 | acc=1.0000 | 4643.7 samples/s | 72.6 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00178 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=2.870 | acc=1.0000 | 4672.1 samples/s | 73.0 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00166 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.872 | acc=1.0000 | 4629.8 samples/s | 72.3 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00156 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.875 | acc=1.0000 | 4547.6 samples/s | 71.1 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00146 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=2.877 | acc=1.0000 | 4554.7 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28303 | acc=0.7845 | tpr=0.6998 | fpr=0.0315 | 4482.1 samples/s | 17.5 steps/s
Avg test loss: 0.28731, Avg test acc: 0.78352, Avg tpr: 0.69837, Avg fpr: 0.02923, total FA: 228

Testing server on iccad2012
[Step=  50] | Loss=0.35547 | acc=0.8283 | tpr=0.9690 | fpr=0.1742 | 4410.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.36124 | acc=0.8268 | tpr=0.9808 | fpr=0.1761 | 8622.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.36959 | acc=0.8241 | tpr=0.9798 | fpr=0.1787 | 8595.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.36846 | acc=0.8250 | tpr=0.9825 | fpr=0.1778 | 8564.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.36673 | acc=0.8251 | tpr=0.9843 | fpr=0.1778 | 8637.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.36964 | acc=0.8247 | tpr=0.9818 | fpr=0.1782 | 8623.5 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.37074 | acc=0.8237 | tpr=0.9825 | fpr=0.1792 | 8659.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.37125 | acc=0.8235 | tpr=0.9819 | fpr=0.1794 | 8867.9 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.37324 | acc=0.8231 | tpr=0.9825 | fpr=0.1798 | 8359.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.37347 | acc=0.8230 | tpr=0.9828 | fpr=0.1799 | 8928.4 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.37216 | acc=0.8231 | tpr=0.9825 | fpr=0.1798 | 14682.3 samples/s | 57.4 steps/s
Avg test loss: 0.37188, Avg test acc: 0.82311, Avg tpr: 0.98257, Avg fpr: 0.17979, total FA: 24963

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.23280 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=2.919 | acc=0.8438 | 3845.9 samples/s | 60.1 steps/s
[Step=12050 Epoch=11.8] | Loss=0.06124 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=2.908 | acc=0.9688 | 4495.8 samples/s | 70.2 steps/s
[Step=12100 Epoch=11.8] | Loss=0.04668 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=2.916 | acc=0.9844 | 4760.3 samples/s | 74.4 steps/s
[Step=12150 Epoch=11.9] | Loss=0.04321 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=2.924 | acc=0.9844 | 4784.2 samples/s | 74.8 steps/s
[Step=12200 Epoch=11.9] | Loss=0.04118 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=2.930 | acc=0.9688 | 4835.0 samples/s | 75.5 steps/s
[Step=12250 Epoch=12.0] | Loss=0.03919 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=2.937 | acc=0.9844 | 4868.4 samples/s | 76.1 steps/s
[Step=12300 Epoch=12.0] | Loss=0.03725 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=2.943 | acc=0.9688 | 4889.2 samples/s | 76.4 steps/s
[Step=12350 Epoch=12.1] | Loss=0.03579 | Reg=0.00199 | L2-Norm=14.115 | L2-Norm(final)=2.950 | acc=1.0000 | 4977.7 samples/s | 77.8 steps/s
[Step=12400 Epoch=12.1] | Loss=0.03560 | Reg=0.00200 | L2-Norm=14.126 | L2-Norm(final)=2.954 | acc=0.9844 | 4860.8 samples/s | 75.9 steps/s
[Step=12450 Epoch=12.2] | Loss=0.03488 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=2.958 | acc=0.9375 | 4932.7 samples/s | 77.1 steps/s
[Step=12500 Epoch=12.2] | Loss=0.03459 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.961 | acc=0.9688 | 4923.9 samples/s | 76.9 steps/s
[Step=12550 Epoch=12.3] | Loss=0.03396 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.965 | acc=1.0000 | 4865.3 samples/s | 76.0 steps/s
[Step=12600 Epoch=12.3] | Loss=0.03355 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.968 | acc=0.9531 | 4768.2 samples/s | 74.5 steps/s
[Step=12650 Epoch=12.4] | Loss=0.03325 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=2.970 | acc=1.0000 | 4782.2 samples/s | 74.7 steps/s
[Step=12700 Epoch=12.4] | Loss=0.03293 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.973 | acc=0.9688 | 4799.6 samples/s | 75.0 steps/s
[Step=12750 Epoch=12.4] | Loss=0.03235 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=2.976 | acc=0.9844 | 4775.6 samples/s | 74.6 steps/s
[Step=12800 Epoch=12.5] | Loss=0.03239 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.979 | acc=1.0000 | 4807.7 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.05536 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=2.918 | acc=0.9688 | 3903.7 samples/s | 61.0 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00633 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.912 | acc=1.0000 | 4139.5 samples/s | 64.7 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00332 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.920 | acc=1.0000 | 4560.4 samples/s | 71.3 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00238 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.927 | acc=1.0000 | 4682.2 samples/s | 73.2 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00192 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=2.933 | acc=1.0000 | 4672.7 samples/s | 73.0 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00159 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=2.939 | acc=1.0000 | 4517.9 samples/s | 70.6 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00136 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=2.944 | acc=1.0000 | 4546.5 samples/s | 71.0 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00158 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=2.949 | acc=1.0000 | 4513.2 samples/s | 70.5 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00151 | Reg=0.00195 | L2-Norm=13.979 | L2-Norm(final)=2.952 | acc=1.0000 | 4652.9 samples/s | 72.7 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00140 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.956 | acc=1.0000 | 4530.7 samples/s | 70.8 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00130 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=2.960 | acc=1.0000 | 4584.6 samples/s | 71.6 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00120 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=2.964 | acc=1.0000 | 1951.7 samples/s | 30.5 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00110 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=2.968 | acc=1.0000 | 4715.3 samples/s | 73.7 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00102 | Reg=0.00194 | L2-Norm=13.942 | L2-Norm(final)=2.971 | acc=1.0000 | 4660.8 samples/s | 72.8 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00095 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=2.975 | acc=1.0000 | 4556.5 samples/s | 71.2 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00089 | Reg=0.00194 | L2-Norm=13.920 | L2-Norm(final)=2.978 | acc=1.0000 | 4561.2 samples/s | 71.3 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00083 | Reg=0.00193 | L2-Norm=13.908 | L2-Norm(final)=2.980 | acc=1.0000 | 4501.0 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52695 | acc=0.6490 | tpr=0.4905 | fpr=0.0069 | 4460.6 samples/s | 17.4 steps/s
Avg test loss: 0.52961, Avg test acc: 0.65025, Avg tpr: 0.49449, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.21188 | acc=0.9083 | tpr=0.9690 | fpr=0.0928 | 4459.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.21509 | acc=0.9063 | tpr=0.9744 | fpr=0.0950 | 8379.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.21833 | acc=0.9060 | tpr=0.9769 | fpr=0.0953 | 8516.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.21791 | acc=0.9066 | tpr=0.9781 | fpr=0.0947 | 8337.9 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.21724 | acc=0.9064 | tpr=0.9808 | fpr=0.0950 | 8604.7 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.21954 | acc=0.9058 | tpr=0.9782 | fpr=0.0955 | 8316.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.21999 | acc=0.9060 | tpr=0.9775 | fpr=0.0953 | 8445.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.22073 | acc=0.9058 | tpr=0.9765 | fpr=0.0955 | 8787.4 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.22308 | acc=0.9051 | tpr=0.9766 | fpr=0.0962 | 8801.3 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.22371 | acc=0.9045 | tpr=0.9767 | fpr=0.0968 | 8580.3 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.22306 | acc=0.9047 | tpr=0.9745 | fpr=0.0966 | 14907.2 samples/s | 58.2 steps/s
Avg test loss: 0.22285, Avg test acc: 0.90476, Avg tpr: 0.97464, Avg fpr: 0.09651, total FA: 13400

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.42866 | Reg=0.00192 | L2-Norm=13.867 | L2-Norm(final)=3.016 | acc=0.7031 | 3981.5 samples/s | 62.2 steps/s
[Step=12850 Epoch=12.5] | Loss=0.06008 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=2.997 | acc=0.9688 | 4561.1 samples/s | 71.3 steps/s
[Step=12900 Epoch=12.6] | Loss=0.04420 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=3.007 | acc=1.0000 | 4736.6 samples/s | 74.0 steps/s
[Step=12950 Epoch=12.6] | Loss=0.04051 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=3.016 | acc=0.9844 | 4737.3 samples/s | 74.0 steps/s
[Step=13000 Epoch=12.7] | Loss=0.03825 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=3.022 | acc=0.9688 | 4826.2 samples/s | 75.4 steps/s
[Step=13050 Epoch=12.7] | Loss=0.03609 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.028 | acc=0.9844 | 4733.1 samples/s | 74.0 steps/s
[Step=13100 Epoch=12.8] | Loss=0.03543 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=3.033 | acc=0.9375 | 4785.6 samples/s | 74.8 steps/s
[Step=13150 Epoch=12.8] | Loss=0.03468 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=3.036 | acc=0.9688 | 4812.5 samples/s | 75.2 steps/s
[Step=13200 Epoch=12.9] | Loss=0.03387 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=3.040 | acc=0.9688 | 4745.4 samples/s | 74.1 steps/s
[Step=13250 Epoch=12.9] | Loss=0.03358 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=3.043 | acc=0.9844 | 4750.7 samples/s | 74.2 steps/s
[Step=13300 Epoch=13.0] | Loss=0.03319 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=3.047 | acc=0.9688 | 4779.7 samples/s | 74.7 steps/s
[Step=13350 Epoch=13.0] | Loss=0.03297 | Reg=0.00199 | L2-Norm=14.122 | L2-Norm(final)=3.050 | acc=0.9844 | 4792.9 samples/s | 74.9 steps/s
[Step=13400 Epoch=13.1] | Loss=0.03228 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=3.053 | acc=1.0000 | 4751.5 samples/s | 74.2 steps/s
[Step=13450 Epoch=13.1] | Loss=0.03220 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=3.056 | acc=0.9844 | 4809.3 samples/s | 75.1 steps/s
[Step=13500 Epoch=13.2] | Loss=0.03179 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.058 | acc=0.9531 | 4784.3 samples/s | 74.8 steps/s
[Step=13550 Epoch=13.2] | Loss=0.03207 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.059 | acc=0.9844 | 4796.7 samples/s | 74.9 steps/s
[Step=13600 Epoch=13.3] | Loss=0.03166 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=3.061 | acc=1.0000 | 4723.8 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.00925 | Reg=0.00192 | L2-Norm=13.867 | L2-Norm(final)=3.019 | acc=1.0000 | 4152.4 samples/s | 64.9 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00258 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=3.038 | acc=1.0000 | 4013.9 samples/s | 62.7 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00260 | Reg=0.00193 | L2-Norm=13.909 | L2-Norm(final)=3.048 | acc=1.0000 | 4665.4 samples/s | 72.9 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00201 | Reg=0.00194 | L2-Norm=13.918 | L2-Norm(final)=3.055 | acc=1.0000 | 4554.5 samples/s | 71.2 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00173 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=3.062 | acc=1.0000 | 4513.4 samples/s | 70.5 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00218 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=3.067 | acc=1.0000 | 4600.4 samples/s | 71.9 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00262 | Reg=0.00194 | L2-Norm=13.943 | L2-Norm(final)=3.066 | acc=0.9844 | 4648.9 samples/s | 72.6 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00311 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.060 | acc=1.0000 | 4433.5 samples/s | 69.3 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00298 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.052 | acc=1.0000 | 4570.0 samples/s | 71.4 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00287 | Reg=0.00195 | L2-Norm=13.975 | L2-Norm(final)=3.047 | acc=1.0000 | 4532.5 samples/s | 70.8 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00276 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=3.044 | acc=1.0000 | 4588.0 samples/s | 71.7 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00264 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=3.041 | acc=1.0000 | 1957.6 samples/s | 30.6 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00245 | Reg=0.00196 | L2-Norm=13.988 | L2-Norm(final)=3.040 | acc=1.0000 | 4512.3 samples/s | 70.5 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00230 | Reg=0.00196 | L2-Norm=13.988 | L2-Norm(final)=3.040 | acc=1.0000 | 4482.7 samples/s | 70.0 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00217 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=3.039 | acc=1.0000 | 4510.1 samples/s | 70.5 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00205 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=3.040 | acc=1.0000 | 4557.2 samples/s | 71.2 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00193 | Reg=0.00196 | L2-Norm=13.982 | L2-Norm(final)=3.040 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40585 | acc=0.7051 | tpr=0.5764 | fpr=0.0156 | 4426.5 samples/s | 17.3 steps/s
Avg test loss: 0.40683, Avg test acc: 0.70635, Avg tpr: 0.58087, Avg fpr: 0.01769, total FA: 138

Testing server on iccad2012
[Step=  50] | Loss=0.21482 | acc=0.8993 | tpr=0.9646 | fpr=0.1019 | 4335.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.21936 | acc=0.8982 | tpr=0.9744 | fpr=0.1032 | 8737.3 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.22420 | acc=0.8973 | tpr=0.9741 | fpr=0.1041 | 8247.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.22475 | acc=0.8982 | tpr=0.9770 | fpr=0.1033 | 8439.8 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.22324 | acc=0.8984 | tpr=0.9782 | fpr=0.1031 | 8543.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.22452 | acc=0.8980 | tpr=0.9745 | fpr=0.1033 | 8714.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.22516 | acc=0.8980 | tpr=0.9743 | fpr=0.1034 | 8701.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.22615 | acc=0.8978 | tpr=0.9737 | fpr=0.1036 | 8512.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.22793 | acc=0.8974 | tpr=0.9747 | fpr=0.1040 | 8799.8 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.22804 | acc=0.8970 | tpr=0.9749 | fpr=0.1044 | 8515.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.22739 | acc=0.8972 | tpr=0.9737 | fpr=0.1042 | 15001.2 samples/s | 58.6 steps/s
Avg test loss: 0.22718, Avg test acc: 0.89720, Avg tpr: 0.97385, Avg fpr: 0.10419, total FA: 14467

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.18178 | Reg=0.00194 | L2-Norm=13.933 | L2-Norm(final)=3.075 | acc=0.8594 | 3743.7 samples/s | 58.5 steps/s
[Step=13650 Epoch=13.3] | Loss=0.06259 | Reg=0.00196 | L2-Norm=14.011 | L2-Norm(final)=3.066 | acc=0.9844 | 4546.5 samples/s | 71.0 steps/s
[Step=13700 Epoch=13.4] | Loss=0.04758 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=3.070 | acc=1.0000 | 4701.1 samples/s | 73.5 steps/s
[Step=13750 Epoch=13.4] | Loss=0.04275 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=3.078 | acc=0.9688 | 4843.0 samples/s | 75.7 steps/s
[Step=13800 Epoch=13.5] | Loss=0.04116 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=3.080 | acc=1.0000 | 4767.3 samples/s | 74.5 steps/s
[Step=13850 Epoch=13.5] | Loss=0.03951 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=3.084 | acc=0.9375 | 4760.4 samples/s | 74.4 steps/s
[Step=13900 Epoch=13.6] | Loss=0.03808 | Reg=0.00199 | L2-Norm=14.112 | L2-Norm(final)=3.086 | acc=0.9844 | 4784.2 samples/s | 74.8 steps/s
[Step=13950 Epoch=13.6] | Loss=0.03803 | Reg=0.00199 | L2-Norm=14.121 | L2-Norm(final)=3.088 | acc=0.9062 | 4750.6 samples/s | 74.2 steps/s
[Step=14000 Epoch=13.7] | Loss=0.03674 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=3.089 | acc=0.9844 | 4856.7 samples/s | 75.9 steps/s
[Step=14050 Epoch=13.7] | Loss=0.03587 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=3.091 | acc=0.9688 | 4775.5 samples/s | 74.6 steps/s
[Step=14100 Epoch=13.8] | Loss=0.03502 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=3.094 | acc=0.9844 | 4838.7 samples/s | 75.6 steps/s
[Step=14150 Epoch=13.8] | Loss=0.03462 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.097 | acc=0.9844 | 4734.0 samples/s | 74.0 steps/s
[Step=14200 Epoch=13.9] | Loss=0.03428 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.100 | acc=0.9688 | 4752.8 samples/s | 74.3 steps/s
[Step=14250 Epoch=13.9] | Loss=0.03405 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=3.102 | acc=1.0000 | 4889.1 samples/s | 76.4 steps/s
[Step=14300 Epoch=14.0] | Loss=0.03389 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.105 | acc=0.9688 | 4827.8 samples/s | 75.4 steps/s
[Step=14350 Epoch=14.0] | Loss=0.03374 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.107 | acc=0.9844 | 4746.9 samples/s | 74.2 steps/s
[Step=14400 Epoch=14.1] | Loss=0.03354 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.109 | acc=0.9688 | 4787.5 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.04825 | Reg=0.00194 | L2-Norm=13.933 | L2-Norm(final)=3.074 | acc=0.9688 | 3381.6 samples/s | 52.8 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00249 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=3.091 | acc=1.0000 | 4603.6 samples/s | 71.9 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00133 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=3.101 | acc=1.0000 | 4557.2 samples/s | 71.2 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00091 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=3.107 | acc=1.0000 | 4594.3 samples/s | 71.8 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00071 | Reg=0.00195 | L2-Norm=13.964 | L2-Norm(final)=3.112 | acc=1.0000 | 4501.7 samples/s | 70.3 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00057 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=3.116 | acc=1.0000 | 4543.0 samples/s | 71.0 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00048 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=3.119 | acc=1.0000 | 4490.9 samples/s | 70.2 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00042 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=3.122 | acc=1.0000 | 4602.7 samples/s | 71.9 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00037 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=3.125 | acc=1.0000 | 4566.0 samples/s | 71.3 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00034 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=3.128 | acc=1.0000 | 4525.4 samples/s | 70.7 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00031 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=3.130 | acc=1.0000 | 4585.2 samples/s | 71.6 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00028 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=3.133 | acc=1.0000 | 1961.2 samples/s | 30.6 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00026 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.135 | acc=1.0000 | 4634.1 samples/s | 72.4 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00024 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.138 | acc=1.0000 | 4643.5 samples/s | 72.6 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00023 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.140 | acc=1.0000 | 4675.9 samples/s | 73.1 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00021 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.142 | acc=1.0000 | 4655.5 samples/s | 72.7 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00020 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.145 | acc=1.0000 | 4679.3 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24879 | acc=0.8162 | tpr=0.7368 | fpr=0.0114 | 4377.8 samples/s | 17.1 steps/s
Avg test loss: 0.25339, Avg test acc: 0.81589, Avg tpr: 0.73772, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.29789 | acc=0.8416 | tpr=0.9646 | fpr=0.1606 | 4398.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.30111 | acc=0.8413 | tpr=0.9723 | fpr=0.1612 | 8597.1 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.30618 | acc=0.8400 | tpr=0.9712 | fpr=0.1624 | 8493.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.30579 | acc=0.8410 | tpr=0.9760 | fpr=0.1614 | 8515.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.30529 | acc=0.8404 | tpr=0.9773 | fpr=0.1621 | 8719.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.30654 | acc=0.8407 | tpr=0.9753 | fpr=0.1617 | 8645.8 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.30717 | acc=0.8403 | tpr=0.9756 | fpr=0.1622 | 8392.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.30829 | acc=0.8400 | tpr=0.9748 | fpr=0.1625 | 9410.6 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.31037 | acc=0.8393 | tpr=0.9752 | fpr=0.1631 | 8098.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.31112 | acc=0.8391 | tpr=0.9758 | fpr=0.1633 | 8531.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.31039 | acc=0.8393 | tpr=0.9749 | fpr=0.1632 | 16023.0 samples/s | 62.6 steps/s
Avg test loss: 0.31016, Avg test acc: 0.83935, Avg tpr: 0.97504, Avg fpr: 0.16311, total FA: 22648

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.11692 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.159 | acc=0.8750 | 4334.6 samples/s | 67.7 steps/s
[Step=14450 Epoch=14.1] | Loss=0.03878 | Reg=0.00193 | L2-Norm=13.902 | L2-Norm(final)=3.159 | acc=0.9688 | 4161.5 samples/s | 65.0 steps/s
[Step=14500 Epoch=14.2] | Loss=0.03410 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=3.168 | acc=0.9531 | 4909.0 samples/s | 76.7 steps/s
[Step=14550 Epoch=14.2] | Loss=0.03182 | Reg=0.00194 | L2-Norm=13.945 | L2-Norm(final)=3.176 | acc=0.9844 | 4866.6 samples/s | 76.0 steps/s
[Step=14600 Epoch=14.3] | Loss=0.03048 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=3.183 | acc=0.9531 | 4910.7 samples/s | 76.7 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02970 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=3.190 | acc=0.9844 | 4892.5 samples/s | 76.4 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02917 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=3.195 | acc=1.0000 | 4974.0 samples/s | 77.7 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02959 | Reg=0.00196 | L2-Norm=13.999 | L2-Norm(final)=3.200 | acc=0.9844 | 4844.9 samples/s | 75.7 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02996 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=3.203 | acc=0.9844 | 4948.4 samples/s | 77.3 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02980 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=3.207 | acc=1.0000 | 4942.7 samples/s | 77.2 steps/s
[Step=14900 Epoch=14.5] | Loss=0.03004 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=3.210 | acc=0.9531 | 4883.8 samples/s | 76.3 steps/s
[Step=14950 Epoch=14.6] | Loss=0.03032 | Reg=0.00197 | L2-Norm=14.044 | L2-Norm(final)=3.213 | acc=0.9531 | 4960.2 samples/s | 77.5 steps/s
[Step=15000 Epoch=14.6] | Loss=0.03035 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=3.216 | acc=0.9844 | 4918.9 samples/s | 76.9 steps/s
[Step=15050 Epoch=14.7] | Loss=0.03039 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=3.218 | acc=0.9688 | 4941.0 samples/s | 77.2 steps/s
[Step=15100 Epoch=14.7] | Loss=0.03021 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=3.220 | acc=1.0000 | 4906.7 samples/s | 76.7 steps/s
[Step=15150 Epoch=14.8] | Loss=0.03042 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=3.222 | acc=1.0000 | 4818.3 samples/s | 75.3 steps/s
[Step=15200 Epoch=14.8] | Loss=0.03019 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.224 | acc=1.0000 | 4850.5 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.05434 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.160 | acc=0.9375 | 4097.5 samples/s | 64.0 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00677 | Reg=0.00194 | L2-Norm=13.945 | L2-Norm(final)=3.178 | acc=1.0000 | 3953.2 samples/s | 61.8 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00557 | Reg=0.00195 | L2-Norm=13.980 | L2-Norm(final)=3.173 | acc=1.0000 | 4492.4 samples/s | 70.2 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00514 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=3.165 | acc=1.0000 | 4526.4 samples/s | 70.7 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00460 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=3.164 | acc=1.0000 | 4541.7 samples/s | 71.0 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00521 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=3.155 | acc=1.0000 | 4631.2 samples/s | 72.4 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00447 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=3.148 | acc=1.0000 | 4544.4 samples/s | 71.0 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00404 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=3.146 | acc=1.0000 | 4538.6 samples/s | 70.9 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00359 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=3.145 | acc=1.0000 | 4626.3 samples/s | 72.3 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00322 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=3.146 | acc=1.0000 | 4559.6 samples/s | 71.2 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00295 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=3.148 | acc=1.0000 | 4513.4 samples/s | 70.5 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00276 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=3.150 | acc=0.9844 | 1928.0 samples/s | 30.1 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00262 | Reg=0.00197 | L2-Norm=14.027 | L2-Norm(final)=3.152 | acc=1.0000 | 4750.2 samples/s | 74.2 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00250 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=3.153 | acc=1.0000 | 4673.4 samples/s | 73.0 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00235 | Reg=0.00197 | L2-Norm=14.018 | L2-Norm(final)=3.154 | acc=1.0000 | 4584.8 samples/s | 71.6 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00220 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=3.156 | acc=1.0000 | 4673.9 samples/s | 73.0 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00208 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=3.157 | acc=1.0000 | 4472.7 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48432 | acc=0.6644 | tpr=0.5171 | fpr=0.0159 | 4420.7 samples/s | 17.3 steps/s
Avg test loss: 0.48588, Avg test acc: 0.66520, Avg tpr: 0.52049, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.19770 | acc=0.9168 | tpr=0.9735 | fpr=0.0842 | 4419.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.20186 | acc=0.9157 | tpr=0.9829 | fpr=0.0856 | 8484.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.20645 | acc=0.9146 | tpr=0.9841 | fpr=0.0866 | 9150.7 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.20655 | acc=0.9156 | tpr=0.9858 | fpr=0.0857 | 8678.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.20571 | acc=0.9156 | tpr=0.9869 | fpr=0.0857 | 8390.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.20763 | acc=0.9152 | tpr=0.9825 | fpr=0.0860 | 8465.3 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.20820 | acc=0.9152 | tpr=0.9818 | fpr=0.0860 | 8870.0 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.20905 | acc=0.9150 | tpr=0.9798 | fpr=0.0862 | 8859.0 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.21138 | acc=0.9145 | tpr=0.9800 | fpr=0.0867 | 8180.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.21139 | acc=0.9143 | tpr=0.9802 | fpr=0.0869 | 8498.7 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.21053 | acc=0.9143 | tpr=0.9793 | fpr=0.0869 | 16036.7 samples/s | 62.6 steps/s
Avg test loss: 0.21037, Avg test acc: 0.91434, Avg tpr: 0.97940, Avg fpr: 0.08684, total FA: 12058

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.36477 | Reg=0.00193 | L2-Norm=13.891 | L2-Norm(final)=3.208 | acc=0.7188 | 3435.9 samples/s | 53.7 steps/s
[Step=15250 Epoch=14.9] | Loss=0.06218 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=3.182 | acc=0.9688 | 4886.3 samples/s | 76.3 steps/s
[Step=15300 Epoch=14.9] | Loss=0.04680 | Reg=0.00197 | L2-Norm=14.044 | L2-Norm(final)=3.188 | acc=0.9844 | 4724.4 samples/s | 73.8 steps/s
[Step=15350 Epoch=15.0] | Loss=0.04203 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=3.198 | acc=1.0000 | 4769.8 samples/s | 74.5 steps/s
[Step=15400 Epoch=15.0] | Loss=0.03930 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=3.205 | acc=0.9375 | 4765.8 samples/s | 74.5 steps/s
[Step=15450 Epoch=15.1] | Loss=0.03764 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=3.209 | acc=0.9531 | 4813.7 samples/s | 75.2 steps/s
[Step=15500 Epoch=15.1] | Loss=0.03658 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=3.212 | acc=0.9688 | 4843.4 samples/s | 75.7 steps/s
[Step=15550 Epoch=15.2] | Loss=0.03547 | Reg=0.00199 | L2-Norm=14.111 | L2-Norm(final)=3.215 | acc=1.0000 | 4892.8 samples/s | 76.4 steps/s
[Step=15600 Epoch=15.2] | Loss=0.03455 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=3.219 | acc=0.9375 | 4928.1 samples/s | 77.0 steps/s
[Step=15650 Epoch=15.3] | Loss=0.03458 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=3.222 | acc=1.0000 | 4967.2 samples/s | 77.6 steps/s
[Step=15700 Epoch=15.3] | Loss=0.03371 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=3.226 | acc=0.9844 | 4888.9 samples/s | 76.4 steps/s
[Step=15750 Epoch=15.4] | Loss=0.03347 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=3.230 | acc=0.9688 | 4912.0 samples/s | 76.7 steps/s
[Step=15800 Epoch=15.4] | Loss=0.03351 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=3.232 | acc=0.9531 | 4926.5 samples/s | 77.0 steps/s
[Step=15850 Epoch=15.5] | Loss=0.03310 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.234 | acc=0.9844 | 4883.3 samples/s | 76.3 steps/s
[Step=15900 Epoch=15.5] | Loss=0.03263 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.236 | acc=1.0000 | 4914.7 samples/s | 76.8 steps/s
[Step=15950 Epoch=15.6] | Loss=0.03216 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.238 | acc=0.9531 | 4917.0 samples/s | 76.8 steps/s
[Step=16000 Epoch=15.6] | Loss=0.03196 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=3.241 | acc=0.9844 | 4983.9 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.01555 | Reg=0.00193 | L2-Norm=13.891 | L2-Norm(final)=3.210 | acc=0.9844 | 3528.4 samples/s | 55.1 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00207 | Reg=0.00194 | L2-Norm=13.917 | L2-Norm(final)=3.226 | acc=1.0000 | 4488.1 samples/s | 70.1 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00114 | Reg=0.00194 | L2-Norm=13.916 | L2-Norm(final)=3.236 | acc=1.0000 | 4668.1 samples/s | 72.9 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00087 | Reg=0.00193 | L2-Norm=13.909 | L2-Norm(final)=3.243 | acc=1.0000 | 4502.0 samples/s | 70.3 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00071 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=3.250 | acc=1.0000 | 4635.6 samples/s | 72.4 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00058 | Reg=0.00193 | L2-Norm=13.890 | L2-Norm(final)=3.255 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00049 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.259 | acc=1.0000 | 4622.6 samples/s | 72.2 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00042 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.263 | acc=1.0000 | 4644.2 samples/s | 72.6 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00037 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.266 | acc=1.0000 | 4678.7 samples/s | 73.1 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00033 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=3.269 | acc=1.0000 | 4574.7 samples/s | 71.5 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00030 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.271 | acc=1.0000 | 4592.3 samples/s | 71.8 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00028 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.274 | acc=1.0000 | 1947.2 samples/s | 30.4 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00026 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.277 | acc=1.0000 | 4645.6 samples/s | 72.6 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00024 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.279 | acc=1.0000 | 4517.1 samples/s | 70.6 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00022 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.282 | acc=1.0000 | 4529.0 samples/s | 70.8 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00021 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.284 | acc=1.0000 | 4521.1 samples/s | 70.6 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00020 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.286 | acc=1.0000 | 4552.6 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16449 | acc=0.8722 | tpr=0.8209 | fpr=0.0164 | 4431.0 samples/s | 17.3 steps/s
Avg test loss: 0.16954, Avg test acc: 0.87154, Avg tpr: 0.82054, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.43990 | acc=0.7748 | tpr=0.9690 | fpr=0.2286 | 4495.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.44595 | acc=0.7710 | tpr=0.9808 | fpr=0.2329 | 8482.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.45238 | acc=0.7691 | tpr=0.9813 | fpr=0.2348 | 8620.1 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.45202 | acc=0.7695 | tpr=0.9836 | fpr=0.2344 | 8570.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.45208 | acc=0.7688 | tpr=0.9860 | fpr=0.2352 | 8421.5 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.45480 | acc=0.7683 | tpr=0.9833 | fpr=0.2356 | 9033.9 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.45551 | acc=0.7681 | tpr=0.9831 | fpr=0.2358 | 8497.8 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.45721 | acc=0.7679 | tpr=0.9830 | fpr=0.2360 | 8561.1 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.45991 | acc=0.7674 | tpr=0.9834 | fpr=0.2365 | 8814.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.46084 | acc=0.7674 | tpr=0.9833 | fpr=0.2365 | 8442.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.45976 | acc=0.7676 | tpr=0.9825 | fpr=0.2363 | 15550.2 samples/s | 60.7 steps/s
Avg test loss: 0.45954, Avg test acc: 0.76766, Avg tpr: 0.98257, Avg fpr: 0.23624, total FA: 32802

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.06517 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.301 | acc=0.9375 | 3671.4 samples/s | 57.4 steps/s
[Step=16050 Epoch=15.7] | Loss=0.03945 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.301 | acc=0.9688 | 4783.4 samples/s | 74.7 steps/s
[Step=16100 Epoch=15.7] | Loss=0.02999 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.308 | acc=0.9844 | 4842.2 samples/s | 75.7 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02676 | Reg=0.00192 | L2-Norm=13.856 | L2-Norm(final)=3.316 | acc=1.0000 | 4881.2 samples/s | 76.3 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02503 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=3.323 | acc=1.0000 | 4895.2 samples/s | 76.5 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02440 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.328 | acc=0.9844 | 4863.5 samples/s | 76.0 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02421 | Reg=0.00193 | L2-Norm=13.875 | L2-Norm(final)=3.333 | acc=0.9844 | 4900.5 samples/s | 76.6 steps/s
[Step=16350 Epoch=16.0] | Loss=0.02364 | Reg=0.00193 | L2-Norm=13.879 | L2-Norm(final)=3.337 | acc=0.9688 | 4811.6 samples/s | 75.2 steps/s
[Step=16400 Epoch=16.0] | Loss=0.02363 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.340 | acc=0.9531 | 4805.3 samples/s | 75.1 steps/s
[Step=16450 Epoch=16.1] | Loss=0.02357 | Reg=0.00193 | L2-Norm=13.888 | L2-Norm(final)=3.343 | acc=0.9844 | 4804.3 samples/s | 75.1 steps/s
[Step=16500 Epoch=16.1] | Loss=0.02317 | Reg=0.00193 | L2-Norm=13.892 | L2-Norm(final)=3.346 | acc=0.9844 | 4830.4 samples/s | 75.5 steps/s
[Step=16550 Epoch=16.2] | Loss=0.02296 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=3.350 | acc=0.9688 | 4792.7 samples/s | 74.9 steps/s
[Step=16600 Epoch=16.2] | Loss=0.02277 | Reg=0.00193 | L2-Norm=13.899 | L2-Norm(final)=3.354 | acc=1.0000 | 4771.3 samples/s | 74.6 steps/s
[Step=16650 Epoch=16.3] | Loss=0.02265 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=3.357 | acc=0.9844 | 4728.2 samples/s | 73.9 steps/s
[Step=16700 Epoch=16.3] | Loss=0.02239 | Reg=0.00193 | L2-Norm=13.906 | L2-Norm(final)=3.360 | acc=1.0000 | 4747.9 samples/s | 74.2 steps/s
[Step=16750 Epoch=16.4] | Loss=0.02206 | Reg=0.00193 | L2-Norm=13.909 | L2-Norm(final)=3.364 | acc=0.9375 | 4797.7 samples/s | 75.0 steps/s
[Step=16800 Epoch=16.4] | Loss=0.02204 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=3.367 | acc=0.9844 | 4827.6 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.22076 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.300 | acc=0.8906 | 3663.2 samples/s | 57.2 steps/s
[Step=16050 Epoch=30.3] | Loss=0.01239 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.295 | acc=1.0000 | 4457.1 samples/s | 69.6 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00666 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=3.299 | acc=1.0000 | 4574.4 samples/s | 71.5 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00457 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.304 | acc=1.0000 | 4477.1 samples/s | 70.0 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00362 | Reg=0.00192 | L2-Norm=13.864 | L2-Norm(final)=3.309 | acc=1.0000 | 4539.3 samples/s | 70.9 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00293 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=3.313 | acc=1.0000 | 4539.3 samples/s | 70.9 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00247 | Reg=0.00192 | L2-Norm=13.858 | L2-Norm(final)=3.317 | acc=1.0000 | 4521.8 samples/s | 70.7 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00215 | Reg=0.00192 | L2-Norm=13.854 | L2-Norm(final)=3.320 | acc=1.0000 | 4546.1 samples/s | 71.0 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00190 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.324 | acc=1.0000 | 4578.3 samples/s | 71.5 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00169 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=3.327 | acc=1.0000 | 4499.7 samples/s | 70.3 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00153 | Reg=0.00192 | L2-Norm=13.840 | L2-Norm(final)=3.329 | acc=1.0000 | 4584.9 samples/s | 71.6 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00140 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.332 | acc=1.0000 | 1921.4 samples/s | 30.0 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00128 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.334 | acc=1.0000 | 4700.2 samples/s | 73.4 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00119 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.336 | acc=1.0000 | 4642.0 samples/s | 72.5 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00110 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.338 | acc=1.0000 | 4691.1 samples/s | 73.3 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00103 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=3.340 | acc=1.0000 | 4662.0 samples/s | 72.8 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00097 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=3.342 | acc=1.0000 | 4696.5 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33193 | acc=0.7568 | tpr=0.6491 | fpr=0.0094 | 4413.3 samples/s | 17.2 steps/s
Avg test loss: 0.33607, Avg test acc: 0.75711, Avg tpr: 0.65134, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.26136 | acc=0.8926 | tpr=0.9735 | fpr=0.1089 | 4500.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.26681 | acc=0.8905 | tpr=0.9851 | fpr=0.1113 | 8046.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.27211 | acc=0.8894 | tpr=0.9841 | fpr=0.1124 | 8687.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.27173 | acc=0.8906 | tpr=0.9858 | fpr=0.1111 | 8956.6 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.27070 | acc=0.8898 | tpr=0.9869 | fpr=0.1120 | 8267.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.27285 | acc=0.8894 | tpr=0.9840 | fpr=0.1123 | 9036.8 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.27347 | acc=0.8892 | tpr=0.9831 | fpr=0.1125 | 8334.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.27453 | acc=0.8888 | tpr=0.9814 | fpr=0.1129 | 8463.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.27715 | acc=0.8883 | tpr=0.9815 | fpr=0.1134 | 8689.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.27751 | acc=0.8879 | tpr=0.9811 | fpr=0.1138 | 8632.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.27676 | acc=0.8881 | tpr=0.9801 | fpr=0.1135 | 15555.0 samples/s | 60.8 steps/s
Avg test loss: 0.27657, Avg test acc: 0.88818, Avg tpr: 0.98019, Avg fpr: 0.11349, total FA: 15758

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.29645 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.387 | acc=0.7969 | 3649.6 samples/s | 57.0 steps/s
[Step=16850 Epoch=16.5] | Loss=0.04263 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.385 | acc=0.9844 | 4764.3 samples/s | 74.4 steps/s
[Step=16900 Epoch=16.5] | Loss=0.03045 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.394 | acc=0.9844 | 4749.4 samples/s | 74.2 steps/s
[Step=16950 Epoch=16.5] | Loss=0.02688 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=3.403 | acc=1.0000 | 4839.3 samples/s | 75.6 steps/s
[Step=17000 Epoch=16.6] | Loss=0.02508 | Reg=0.00192 | L2-Norm=13.849 | L2-Norm(final)=3.409 | acc=1.0000 | 4753.0 samples/s | 74.3 steps/s
[Step=17050 Epoch=16.6] | Loss=0.02450 | Reg=0.00192 | L2-Norm=13.855 | L2-Norm(final)=3.415 | acc=0.9844 | 4676.1 samples/s | 73.1 steps/s
[Step=17100 Epoch=16.7] | Loss=0.02426 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=3.420 | acc=0.9844 | 4813.7 samples/s | 75.2 steps/s
[Step=17150 Epoch=16.7] | Loss=0.02377 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.425 | acc=0.9844 | 4902.4 samples/s | 76.6 steps/s
[Step=17200 Epoch=16.8] | Loss=0.02358 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.429 | acc=0.9531 | 4880.3 samples/s | 76.3 steps/s
[Step=17250 Epoch=16.8] | Loss=0.02345 | Reg=0.00192 | L2-Norm=13.873 | L2-Norm(final)=3.433 | acc=0.9688 | 4940.9 samples/s | 77.2 steps/s
[Step=17300 Epoch=16.9] | Loss=0.02315 | Reg=0.00193 | L2-Norm=13.876 | L2-Norm(final)=3.437 | acc=1.0000 | 4909.8 samples/s | 76.7 steps/s
[Step=17350 Epoch=16.9] | Loss=0.02325 | Reg=0.00193 | L2-Norm=13.880 | L2-Norm(final)=3.440 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=17400 Epoch=17.0] | Loss=0.02293 | Reg=0.00193 | L2-Norm=13.884 | L2-Norm(final)=3.443 | acc=0.9844 | 4896.9 samples/s | 76.5 steps/s
[Step=17450 Epoch=17.0] | Loss=0.02249 | Reg=0.00193 | L2-Norm=13.887 | L2-Norm(final)=3.447 | acc=0.9844 | 4964.2 samples/s | 77.6 steps/s
[Step=17500 Epoch=17.1] | Loss=0.02242 | Reg=0.00193 | L2-Norm=13.891 | L2-Norm(final)=3.450 | acc=0.9688 | 4952.6 samples/s | 77.4 steps/s
[Step=17550 Epoch=17.1] | Loss=0.02224 | Reg=0.00193 | L2-Norm=13.894 | L2-Norm(final)=3.453 | acc=0.9688 | 4927.1 samples/s | 77.0 steps/s
[Step=17600 Epoch=17.2] | Loss=0.02234 | Reg=0.00193 | L2-Norm=13.897 | L2-Norm(final)=3.456 | acc=1.0000 | 4874.9 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.02946 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.389 | acc=0.9688 | 3584.6 samples/s | 56.0 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00362 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=3.401 | acc=1.0000 | 4612.3 samples/s | 72.1 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00257 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.405 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00192 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=3.407 | acc=1.0000 | 4687.8 samples/s | 73.2 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00149 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.410 | acc=1.0000 | 4703.6 samples/s | 73.5 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00126 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.413 | acc=1.0000 | 4631.7 samples/s | 72.4 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00109 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=3.416 | acc=1.0000 | 4570.2 samples/s | 71.4 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00094 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=3.419 | acc=1.0000 | 4569.6 samples/s | 71.4 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00083 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=3.421 | acc=1.0000 | 4542.2 samples/s | 71.0 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00075 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=3.423 | acc=1.0000 | 4589.9 samples/s | 71.7 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00068 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=3.425 | acc=1.0000 | 4604.5 samples/s | 71.9 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00062 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.427 | acc=1.0000 | 1976.8 samples/s | 30.9 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00057 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.429 | acc=1.0000 | 4596.3 samples/s | 71.8 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00053 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.431 | acc=1.0000 | 4549.5 samples/s | 71.1 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00049 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.433 | acc=1.0000 | 4604.0 samples/s | 71.9 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00046 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.434 | acc=1.0000 | 4312.0 samples/s | 67.4 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00044 | Reg=0.00188 | L2-Norm=13.709 | L2-Norm(final)=3.436 | acc=1.0000 | 4523.7 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21811 | acc=0.8342 | tpr=0.7630 | fpr=0.0111 | 4421.2 samples/s | 17.3 steps/s
Avg test loss: 0.22358, Avg test acc: 0.83604, Avg tpr: 0.76633, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.34055 | acc=0.8434 | tpr=0.9779 | fpr=0.1590 | 4453.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.34627 | acc=0.8424 | tpr=0.9851 | fpr=0.1603 | 8452.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.35122 | acc=0.8413 | tpr=0.9856 | fpr=0.1614 | 8611.2 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.35030 | acc=0.8419 | tpr=0.9869 | fpr=0.1608 | 9387.0 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.34936 | acc=0.8415 | tpr=0.9886 | fpr=0.1612 | 8251.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.35132 | acc=0.8417 | tpr=0.9855 | fpr=0.1609 | 8442.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.35214 | acc=0.8418 | tpr=0.9856 | fpr=0.1609 | 8603.6 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.35351 | acc=0.8413 | tpr=0.9847 | fpr=0.1613 | 8647.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.35605 | acc=0.8409 | tpr=0.9834 | fpr=0.1617 | 8635.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.35649 | acc=0.8407 | tpr=0.9833 | fpr=0.1618 | 8521.7 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.35579 | acc=0.8409 | tpr=0.9825 | fpr=0.1617 | 15822.3 samples/s | 61.8 steps/s
Avg test loss: 0.35563, Avg test acc: 0.84082, Avg tpr: 0.98257, Avg fpr: 0.16175, total FA: 22459

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.09528 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.476 | acc=0.8906 | 3759.2 samples/s | 58.7 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03737 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.478 | acc=0.9688 | 4804.1 samples/s | 75.1 steps/s
[Step=17700 Epoch=17.3] | Loss=0.03072 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=3.485 | acc=1.0000 | 4860.7 samples/s | 75.9 steps/s
[Step=17750 Epoch=17.3] | Loss=0.02644 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.492 | acc=1.0000 | 4871.6 samples/s | 76.1 steps/s
[Step=17800 Epoch=17.4] | Loss=0.02427 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.500 | acc=0.9844 | 4930.8 samples/s | 77.0 steps/s
[Step=17850 Epoch=17.4] | Loss=0.02393 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.506 | acc=0.9531 | 4913.8 samples/s | 76.8 steps/s
[Step=17900 Epoch=17.5] | Loss=0.02378 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.511 | acc=0.9531 | 4868.9 samples/s | 76.1 steps/s
[Step=17950 Epoch=17.5] | Loss=0.02319 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.515 | acc=0.9531 | 4944.8 samples/s | 77.3 steps/s
[Step=18000 Epoch=17.6] | Loss=0.02258 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.520 | acc=1.0000 | 4873.8 samples/s | 76.2 steps/s
[Step=18050 Epoch=17.6] | Loss=0.02253 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.525 | acc=0.9688 | 4926.5 samples/s | 77.0 steps/s
[Step=18100 Epoch=17.7] | Loss=0.02214 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.529 | acc=1.0000 | 5020.8 samples/s | 78.4 steps/s
[Step=18150 Epoch=17.7] | Loss=0.02203 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.533 | acc=0.9531 | 4910.4 samples/s | 76.7 steps/s
[Step=18200 Epoch=17.8] | Loss=0.02205 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=3.537 | acc=0.9531 | 4899.6 samples/s | 76.6 steps/s
[Step=18250 Epoch=17.8] | Loss=0.02202 | Reg=0.00192 | L2-Norm=13.840 | L2-Norm(final)=3.541 | acc=0.9844 | 4922.2 samples/s | 76.9 steps/s
[Step=18300 Epoch=17.9] | Loss=0.02181 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.544 | acc=1.0000 | 4902.1 samples/s | 76.6 steps/s
[Step=18350 Epoch=17.9] | Loss=0.02193 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=3.547 | acc=0.9844 | 4948.0 samples/s | 77.3 steps/s
[Step=18400 Epoch=18.0] | Loss=0.02173 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.550 | acc=0.9844 | 4912.4 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.17071 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.476 | acc=0.8906 | 4078.7 samples/s | 63.7 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00767 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.474 | acc=1.0000 | 3963.9 samples/s | 61.9 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00422 | Reg=0.00189 | L2-Norm=13.766 | L2-Norm(final)=3.478 | acc=1.0000 | 4434.8 samples/s | 69.3 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00291 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=3.483 | acc=1.0000 | 4532.7 samples/s | 70.8 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00226 | Reg=0.00190 | L2-Norm=13.766 | L2-Norm(final)=3.488 | acc=1.0000 | 4587.6 samples/s | 71.7 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00182 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=3.492 | acc=1.0000 | 4454.6 samples/s | 69.6 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00153 | Reg=0.00189 | L2-Norm=13.760 | L2-Norm(final)=3.496 | acc=1.0000 | 4471.6 samples/s | 69.9 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00132 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=3.499 | acc=1.0000 | 4506.0 samples/s | 70.4 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00116 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.501 | acc=1.0000 | 4569.9 samples/s | 71.4 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00106 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.504 | acc=1.0000 | 4516.4 samples/s | 70.6 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00097 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.506 | acc=1.0000 | 4587.4 samples/s | 71.7 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00089 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.509 | acc=1.0000 | 1984.0 samples/s | 31.0 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00082 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.511 | acc=1.0000 | 4633.2 samples/s | 72.4 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00076 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.512 | acc=1.0000 | 4677.0 samples/s | 73.1 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00070 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=3.514 | acc=1.0000 | 4646.9 samples/s | 72.6 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00066 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=3.516 | acc=1.0000 | 4697.8 samples/s | 73.4 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00062 | Reg=0.00188 | L2-Norm=13.699 | L2-Norm(final)=3.518 | acc=1.0000 | 4680.9 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36227 | acc=0.7462 | tpr=0.6317 | fpr=0.0050 | 4382.4 samples/s | 17.1 steps/s
Avg test loss: 0.36927, Avg test acc: 0.74429, Avg tpr: 0.63059, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.26158 | acc=0.8960 | tpr=0.9690 | fpr=0.1053 | 4436.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.26720 | acc=0.8946 | tpr=0.9744 | fpr=0.1069 | 8554.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.27249 | acc=0.8935 | tpr=0.9755 | fpr=0.1080 | 8789.1 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.27155 | acc=0.8943 | tpr=0.9781 | fpr=0.1073 | 8614.4 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.26951 | acc=0.8945 | tpr=0.9790 | fpr=0.1070 | 9144.2 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.27184 | acc=0.8939 | tpr=0.9767 | fpr=0.1076 | 7895.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.27214 | acc=0.8939 | tpr=0.9775 | fpr=0.1076 | 8732.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.27310 | acc=0.8932 | tpr=0.9765 | fpr=0.1083 | 8491.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.27552 | acc=0.8929 | tpr=0.9766 | fpr=0.1087 | 8737.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.27595 | acc=0.8925 | tpr=0.9771 | fpr=0.1090 | 9022.8 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.27515 | acc=0.8927 | tpr=0.9765 | fpr=0.1088 | 14462.0 samples/s | 56.5 steps/s
Avg test loss: 0.27491, Avg test acc: 0.89277, Avg tpr: 0.97662, Avg fpr: 0.10875, total FA: 15100

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.23611 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=3.568 | acc=0.7500 | 3631.8 samples/s | 56.7 steps/s
[Step=18450 Epoch=18.0] | Loss=0.03856 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.564 | acc=0.9844 | 4601.2 samples/s | 71.9 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02948 | Reg=0.00190 | L2-Norm=13.770 | L2-Norm(final)=3.572 | acc=0.9844 | 4771.9 samples/s | 74.6 steps/s
[Step=18550 Epoch=18.1] | Loss=0.02597 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=3.580 | acc=1.0000 | 4722.5 samples/s | 73.8 steps/s
[Step=18600 Epoch=18.2] | Loss=0.02409 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.586 | acc=0.9844 | 4773.0 samples/s | 74.6 steps/s
[Step=18650 Epoch=18.2] | Loss=0.02337 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.590 | acc=0.9844 | 4825.2 samples/s | 75.4 steps/s
[Step=18700 Epoch=18.3] | Loss=0.02303 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.595 | acc=0.9844 | 4774.9 samples/s | 74.6 steps/s
[Step=18750 Epoch=18.3] | Loss=0.02269 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=3.599 | acc=0.9688 | 4751.4 samples/s | 74.2 steps/s
[Step=18800 Epoch=18.4] | Loss=0.02285 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.603 | acc=0.9688 | 4854.1 samples/s | 75.8 steps/s
[Step=18850 Epoch=18.4] | Loss=0.02244 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.607 | acc=0.9688 | 4744.8 samples/s | 74.1 steps/s
[Step=18900 Epoch=18.5] | Loss=0.02259 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.610 | acc=0.9688 | 4808.6 samples/s | 75.1 steps/s
[Step=18950 Epoch=18.5] | Loss=0.02234 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.613 | acc=1.0000 | 4811.2 samples/s | 75.2 steps/s
[Step=19000 Epoch=18.6] | Loss=0.02234 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.616 | acc=1.0000 | 4840.2 samples/s | 75.6 steps/s
[Step=19050 Epoch=18.6] | Loss=0.02201 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.619 | acc=0.9844 | 4709.1 samples/s | 73.6 steps/s
[Step=19100 Epoch=18.6] | Loss=0.02195 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.623 | acc=1.0000 | 4782.6 samples/s | 74.7 steps/s
[Step=19150 Epoch=18.7] | Loss=0.02193 | Reg=0.00192 | L2-Norm=13.842 | L2-Norm(final)=3.627 | acc=0.9844 | 4758.6 samples/s | 74.4 steps/s
[Step=19200 Epoch=18.7] | Loss=0.02159 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=3.630 | acc=0.9844 | 4788.0 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.04010 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=3.569 | acc=0.9844 | 3593.2 samples/s | 56.1 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00464 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.576 | acc=1.0000 | 4488.2 samples/s | 70.1 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00257 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.582 | acc=1.0000 | 4664.7 samples/s | 72.9 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00181 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.587 | acc=1.0000 | 4693.4 samples/s | 73.3 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00138 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.590 | acc=1.0000 | 4648.4 samples/s | 72.6 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00116 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.594 | acc=1.0000 | 4639.4 samples/s | 72.5 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00098 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=3.596 | acc=1.0000 | 4662.5 samples/s | 72.9 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00090 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=3.599 | acc=1.0000 | 4667.1 samples/s | 72.9 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00080 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=3.602 | acc=1.0000 | 4649.0 samples/s | 72.6 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00079 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=3.605 | acc=1.0000 | 4697.2 samples/s | 73.4 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00086 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.606 | acc=1.0000 | 4691.9 samples/s | 73.3 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00096 | Reg=0.00187 | L2-Norm=13.691 | L2-Norm(final)=3.608 | acc=1.0000 | 1967.9 samples/s | 30.7 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00113 | Reg=0.00187 | L2-Norm=13.689 | L2-Norm(final)=3.608 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00117 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=3.608 | acc=1.0000 | 4656.7 samples/s | 72.8 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00112 | Reg=0.00187 | L2-Norm=13.685 | L2-Norm(final)=3.608 | acc=1.0000 | 4654.2 samples/s | 72.7 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00106 | Reg=0.00187 | L2-Norm=13.682 | L2-Norm(final)=3.608 | acc=1.0000 | 4640.5 samples/s | 72.5 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00101 | Reg=0.00187 | L2-Norm=13.680 | L2-Norm(final)=3.609 | acc=1.0000 | 4664.9 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31309 | acc=0.7706 | tpr=0.6699 | fpr=0.0107 | 4404.4 samples/s | 17.2 steps/s
Avg test loss: 0.31829, Avg test acc: 0.76885, Avg tpr: 0.66906, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.33266 | acc=0.8735 | tpr=0.9690 | fpr=0.1282 | 4467.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.34039 | acc=0.8692 | tpr=0.9787 | fpr=0.1329 | 8340.3 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.34822 | acc=0.8677 | tpr=0.9798 | fpr=0.1344 | 8842.9 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.34820 | acc=0.8686 | tpr=0.9825 | fpr=0.1335 | 8485.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.34598 | acc=0.8683 | tpr=0.9852 | fpr=0.1338 | 8485.6 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.34936 | acc=0.8680 | tpr=0.9825 | fpr=0.1341 | 8603.7 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.35070 | acc=0.8677 | tpr=0.9818 | fpr=0.1343 | 8894.9 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.35193 | acc=0.8672 | tpr=0.9819 | fpr=0.1349 | 8302.3 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.35499 | acc=0.8667 | tpr=0.9815 | fpr=0.1354 | 9009.8 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.35569 | acc=0.8665 | tpr=0.9815 | fpr=0.1355 | 8211.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.35460 | acc=0.8669 | tpr=0.9805 | fpr=0.1352 | 15639.2 samples/s | 61.1 steps/s
Avg test loss: 0.35432, Avg test acc: 0.86688, Avg tpr: 0.98059, Avg fpr: 0.13518, total FA: 18770

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.20924 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=3.651 | acc=0.8594 | 3458.6 samples/s | 54.0 steps/s
[Step=19250 Epoch=18.8] | Loss=0.04829 | Reg=0.00189 | L2-Norm=13.761 | L2-Norm(final)=3.641 | acc=0.9844 | 4857.4 samples/s | 75.9 steps/s
[Step=19300 Epoch=18.8] | Loss=0.03741 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.646 | acc=0.9688 | 4880.4 samples/s | 76.3 steps/s
[Step=19350 Epoch=18.9] | Loss=0.03230 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.651 | acc=0.9844 | 4828.6 samples/s | 75.4 steps/s
[Step=19400 Epoch=18.9] | Loss=0.02942 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.657 | acc=0.9688 | 4814.1 samples/s | 75.2 steps/s
[Step=19450 Epoch=19.0] | Loss=0.02727 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.662 | acc=0.9844 | 4743.1 samples/s | 74.1 steps/s
[Step=19500 Epoch=19.0] | Loss=0.02656 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.666 | acc=1.0000 | 4756.0 samples/s | 74.3 steps/s
[Step=19550 Epoch=19.1] | Loss=0.02533 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.670 | acc=0.9688 | 4780.3 samples/s | 74.7 steps/s
[Step=19600 Epoch=19.1] | Loss=0.02480 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.674 | acc=1.0000 | 4797.9 samples/s | 75.0 steps/s
[Step=19650 Epoch=19.2] | Loss=0.02453 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.678 | acc=0.9688 | 4787.9 samples/s | 74.8 steps/s
[Step=19700 Epoch=19.2] | Loss=0.02427 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.682 | acc=1.0000 | 4823.6 samples/s | 75.4 steps/s
[Step=19750 Epoch=19.3] | Loss=0.02414 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.686 | acc=0.9844 | 4816.0 samples/s | 75.3 steps/s
[Step=19800 Epoch=19.3] | Loss=0.02391 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.689 | acc=0.9688 | 4746.1 samples/s | 74.2 steps/s
[Step=19850 Epoch=19.4] | Loss=0.02370 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=3.692 | acc=0.9844 | 4834.4 samples/s | 75.5 steps/s
[Step=19900 Epoch=19.4] | Loss=0.02357 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.694 | acc=0.9844 | 4766.9 samples/s | 74.5 steps/s
[Step=19950 Epoch=19.5] | Loss=0.02347 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.697 | acc=0.9844 | 4798.4 samples/s | 75.0 steps/s
[Step=20000 Epoch=19.5] | Loss=0.02313 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.700 | acc=0.9844 | 4784.5 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.02873 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=3.652 | acc=0.9844 | 3785.6 samples/s | 59.2 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00236 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.661 | acc=1.0000 | 4356.1 samples/s | 68.1 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00125 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.664 | acc=1.0000 | 4654.8 samples/s | 72.7 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00087 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.667 | acc=1.0000 | 4624.9 samples/s | 72.3 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00067 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.669 | acc=1.0000 | 4669.2 samples/s | 73.0 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00055 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.671 | acc=1.0000 | 4655.4 samples/s | 72.7 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00046 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.673 | acc=1.0000 | 4685.8 samples/s | 73.2 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00040 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.675 | acc=1.0000 | 4708.9 samples/s | 73.6 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00036 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.676 | acc=1.0000 | 4535.9 samples/s | 70.9 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00033 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=3.678 | acc=1.0000 | 4633.4 samples/s | 72.4 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00030 | Reg=0.00188 | L2-Norm=13.698 | L2-Norm(final)=3.679 | acc=1.0000 | 4507.9 samples/s | 70.4 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00028 | Reg=0.00187 | L2-Norm=13.691 | L2-Norm(final)=3.681 | acc=1.0000 | 1930.9 samples/s | 30.2 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00026 | Reg=0.00187 | L2-Norm=13.685 | L2-Norm(final)=3.682 | acc=1.0000 | 4746.1 samples/s | 74.2 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00024 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=3.684 | acc=1.0000 | 4687.4 samples/s | 73.2 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00022 | Reg=0.00187 | L2-Norm=13.671 | L2-Norm(final)=3.685 | acc=1.0000 | 4677.2 samples/s | 73.1 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00021 | Reg=0.00187 | L2-Norm=13.665 | L2-Norm(final)=3.687 | acc=1.0000 | 4670.5 samples/s | 73.0 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00020 | Reg=0.00187 | L2-Norm=13.658 | L2-Norm(final)=3.689 | acc=1.0000 | 4688.5 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25747 | acc=0.8118 | tpr=0.7275 | fpr=0.0052 | 4433.7 samples/s | 17.3 steps/s
Avg test loss: 0.26259, Avg test acc: 0.81132, Avg tpr: 0.72833, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.32187 | acc=0.8694 | tpr=0.9690 | fpr=0.1324 | 4410.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.32910 | acc=0.8655 | tpr=0.9765 | fpr=0.1365 | 8639.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.33515 | acc=0.8639 | tpr=0.9798 | fpr=0.1382 | 8619.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.33437 | acc=0.8655 | tpr=0.9825 | fpr=0.1366 | 8648.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.33310 | acc=0.8653 | tpr=0.9834 | fpr=0.1368 | 8787.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.33597 | acc=0.8651 | tpr=0.9811 | fpr=0.1370 | 8487.4 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.33682 | acc=0.8652 | tpr=0.9818 | fpr=0.1369 | 8662.1 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.33800 | acc=0.8646 | tpr=0.9814 | fpr=0.1375 | 9168.2 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.34066 | acc=0.8643 | tpr=0.9810 | fpr=0.1378 | 8261.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.34139 | acc=0.8639 | tpr=0.9806 | fpr=0.1382 | 8682.8 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.34029 | acc=0.8640 | tpr=0.9797 | fpr=0.1381 | 14086.4 samples/s | 55.0 steps/s
Avg test loss: 0.34005, Avg test acc: 0.86396, Avg tpr: 0.97979, Avg fpr: 0.13814, total FA: 19181

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.24672 | Reg=0.00187 | L2-Norm=13.676 | L2-Norm(final)=3.726 | acc=0.8594 | 3778.3 samples/s | 59.0 steps/s
[Step=20050 Epoch=19.6] | Loss=0.03707 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.722 | acc=0.9375 | 4647.7 samples/s | 72.6 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02718 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.730 | acc=1.0000 | 4715.5 samples/s | 73.7 steps/s
[Step=20150 Epoch=19.7] | Loss=0.02399 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.737 | acc=0.9688 | 4772.7 samples/s | 74.6 steps/s
[Step=20200 Epoch=19.7] | Loss=0.02261 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.744 | acc=1.0000 | 4773.5 samples/s | 74.6 steps/s
[Step=20250 Epoch=19.8] | Loss=0.02221 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=3.750 | acc=0.9531 | 4833.7 samples/s | 75.5 steps/s
[Step=20300 Epoch=19.8] | Loss=0.02193 | Reg=0.00190 | L2-Norm=13.770 | L2-Norm(final)=3.754 | acc=0.9844 | 4937.4 samples/s | 77.1 steps/s
[Step=20350 Epoch=19.9] | Loss=0.02183 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=3.758 | acc=1.0000 | 4898.4 samples/s | 76.5 steps/s
[Step=20400 Epoch=19.9] | Loss=0.02179 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.762 | acc=1.0000 | 4953.5 samples/s | 77.4 steps/s
[Step=20450 Epoch=20.0] | Loss=0.02161 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=3.766 | acc=0.9844 | 4925.4 samples/s | 77.0 steps/s
[Step=20500 Epoch=20.0] | Loss=0.02158 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.769 | acc=0.9844 | 4804.4 samples/s | 75.1 steps/s
[Step=20550 Epoch=20.1] | Loss=0.02105 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.773 | acc=1.0000 | 4810.3 samples/s | 75.2 steps/s
[Step=20600 Epoch=20.1] | Loss=0.02097 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.777 | acc=1.0000 | 4826.5 samples/s | 75.4 steps/s
[Step=20650 Epoch=20.2] | Loss=0.02115 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.781 | acc=0.9375 | 4869.8 samples/s | 76.1 steps/s
[Step=20700 Epoch=20.2] | Loss=0.02159 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.785 | acc=0.9844 | 4773.7 samples/s | 74.6 steps/s
[Step=20750 Epoch=20.3] | Loss=0.02135 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.788 | acc=1.0000 | 4795.4 samples/s | 74.9 steps/s
[Step=20800 Epoch=20.3] | Loss=0.02126 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.792 | acc=0.9844 | 4803.9 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.02646 | Reg=0.00187 | L2-Norm=13.676 | L2-Norm(final)=3.727 | acc=0.9844 | 3583.6 samples/s | 56.0 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00404 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.729 | acc=1.0000 | 4420.4 samples/s | 69.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00221 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.734 | acc=1.0000 | 4616.0 samples/s | 72.1 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00154 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.738 | acc=1.0000 | 4485.1 samples/s | 70.1 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00124 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.741 | acc=1.0000 | 4569.4 samples/s | 71.4 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00102 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.743 | acc=1.0000 | 4562.2 samples/s | 71.3 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00088 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.746 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00077 | Reg=0.00188 | L2-Norm=13.709 | L2-Norm(final)=3.749 | acc=1.0000 | 4555.4 samples/s | 71.2 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00069 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=3.751 | acc=1.0000 | 4499.4 samples/s | 70.3 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00061 | Reg=0.00188 | L2-Norm=13.699 | L2-Norm(final)=3.754 | acc=1.0000 | 4653.6 samples/s | 72.7 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00056 | Reg=0.00187 | L2-Norm=13.693 | L2-Norm(final)=3.756 | acc=1.0000 | 4601.4 samples/s | 71.9 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00051 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=3.758 | acc=1.0000 | 1968.1 samples/s | 30.8 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00047 | Reg=0.00187 | L2-Norm=13.680 | L2-Norm(final)=3.760 | acc=1.0000 | 4802.5 samples/s | 75.0 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00044 | Reg=0.00187 | L2-Norm=13.673 | L2-Norm(final)=3.762 | acc=1.0000 | 4648.4 samples/s | 72.6 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00041 | Reg=0.00187 | L2-Norm=13.666 | L2-Norm(final)=3.763 | acc=1.0000 | 4600.1 samples/s | 71.9 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00038 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=3.765 | acc=1.0000 | 4440.1 samples/s | 69.4 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00036 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=3.766 | acc=1.0000 | 4498.1 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30888 | acc=0.7853 | tpr=0.6887 | fpr=0.0050 | 4403.8 samples/s | 17.2 steps/s
Avg test loss: 0.31394, Avg test acc: 0.78524, Avg tpr: 0.69004, Avg fpr: 0.00538, total FA: 42

Testing server on iccad2012
[Step=  50] | Loss=0.29486 | acc=0.8855 | tpr=0.9735 | fpr=0.1161 | 4451.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.30366 | acc=0.8843 | tpr=0.9808 | fpr=0.1175 | 8506.5 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.30990 | acc=0.8836 | tpr=0.9841 | fpr=0.1182 | 8584.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.30995 | acc=0.8845 | tpr=0.9858 | fpr=0.1174 | 8668.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.30819 | acc=0.8840 | tpr=0.9852 | fpr=0.1179 | 8767.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.31113 | acc=0.8835 | tpr=0.9833 | fpr=0.1183 | 8765.5 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.31223 | acc=0.8835 | tpr=0.9831 | fpr=0.1183 | 8402.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.31357 | acc=0.8830 | tpr=0.9825 | fpr=0.1188 | 8883.8 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.31637 | acc=0.8828 | tpr=0.9825 | fpr=0.1190 | 8727.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.31652 | acc=0.8825 | tpr=0.9819 | fpr=0.1193 | 8435.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.31496 | acc=0.8828 | tpr=0.9813 | fpr=0.1190 | 15696.1 samples/s | 61.3 steps/s
Avg test loss: 0.31470, Avg test acc: 0.88280, Avg tpr: 0.98098, Avg fpr: 0.11899, total FA: 16521

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.23184 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=3.818 | acc=0.8750 | 3670.1 samples/s | 57.3 steps/s
[Step=20850 Epoch=20.4] | Loss=0.03584 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.814 | acc=0.9844 | 4786.7 samples/s | 74.8 steps/s
[Step=20900 Epoch=20.4] | Loss=0.02822 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.819 | acc=0.9844 | 4801.2 samples/s | 75.0 steps/s
[Step=20950 Epoch=20.5] | Loss=0.02582 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.827 | acc=1.0000 | 4756.8 samples/s | 74.3 steps/s
[Step=21000 Epoch=20.5] | Loss=0.02414 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.834 | acc=0.9531 | 4797.3 samples/s | 75.0 steps/s
[Step=21050 Epoch=20.6] | Loss=0.02361 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=3.839 | acc=0.9688 | 4791.5 samples/s | 74.9 steps/s
[Step=21100 Epoch=20.6] | Loss=0.02328 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.844 | acc=0.9844 | 4715.8 samples/s | 73.7 steps/s
[Step=21150 Epoch=20.6] | Loss=0.02294 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=3.848 | acc=0.9688 | 4790.9 samples/s | 74.9 steps/s
[Step=21200 Epoch=20.7] | Loss=0.02283 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=3.852 | acc=0.9219 | 4816.2 samples/s | 75.3 steps/s
[Step=21250 Epoch=20.7] | Loss=0.02230 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.857 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=21300 Epoch=20.8] | Loss=0.02214 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.862 | acc=0.9844 | 4669.1 samples/s | 73.0 steps/s
[Step=21350 Epoch=20.8] | Loss=0.02166 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.866 | acc=0.9688 | 4797.3 samples/s | 75.0 steps/s
[Step=21400 Epoch=20.9] | Loss=0.02145 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.870 | acc=1.0000 | 4815.2 samples/s | 75.2 steps/s
[Step=21450 Epoch=20.9] | Loss=0.02118 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=3.874 | acc=0.9844 | 4799.3 samples/s | 75.0 steps/s
[Step=21500 Epoch=21.0] | Loss=0.02101 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=3.878 | acc=0.9844 | 4831.6 samples/s | 75.5 steps/s
[Step=21550 Epoch=21.0] | Loss=0.02107 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.882 | acc=1.0000 | 4828.5 samples/s | 75.4 steps/s
[Step=21600 Epoch=21.1] | Loss=0.02116 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=3.885 | acc=0.9844 | 4852.1 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.04163 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=3.819 | acc=0.9531 | 4167.0 samples/s | 65.1 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00169 | Reg=0.00187 | L2-Norm=13.682 | L2-Norm(final)=3.830 | acc=1.0000 | 3825.9 samples/s | 59.8 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00101 | Reg=0.00187 | L2-Norm=13.683 | L2-Norm(final)=3.836 | acc=1.0000 | 4559.3 samples/s | 71.2 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00073 | Reg=0.00187 | L2-Norm=13.680 | L2-Norm(final)=3.841 | acc=1.0000 | 4576.8 samples/s | 71.5 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00058 | Reg=0.00187 | L2-Norm=13.675 | L2-Norm(final)=3.844 | acc=1.0000 | 4758.3 samples/s | 74.3 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00048 | Reg=0.00187 | L2-Norm=13.670 | L2-Norm(final)=3.847 | acc=1.0000 | 4577.3 samples/s | 71.5 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00041 | Reg=0.00187 | L2-Norm=13.664 | L2-Norm(final)=3.850 | acc=1.0000 | 4593.3 samples/s | 71.8 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00035 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=3.853 | acc=1.0000 | 4584.1 samples/s | 71.6 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00032 | Reg=0.00186 | L2-Norm=13.649 | L2-Norm(final)=3.855 | acc=1.0000 | 4569.4 samples/s | 71.4 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00029 | Reg=0.00186 | L2-Norm=13.641 | L2-Norm(final)=3.857 | acc=1.0000 | 4599.7 samples/s | 71.9 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00026 | Reg=0.00186 | L2-Norm=13.634 | L2-Norm(final)=3.859 | acc=1.0000 | 4619.4 samples/s | 72.2 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00024 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=3.861 | acc=1.0000 | 1967.6 samples/s | 30.7 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00022 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=3.863 | acc=1.0000 | 4627.8 samples/s | 72.3 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00021 | Reg=0.00185 | L2-Norm=13.608 | L2-Norm(final)=3.864 | acc=1.0000 | 4618.9 samples/s | 72.2 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00019 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=3.866 | acc=1.0000 | 4492.9 samples/s | 70.2 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00018 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=3.868 | acc=1.0000 | 4543.7 samples/s | 71.0 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00017 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=3.869 | acc=1.0000 | 4537.6 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28387 | acc=0.7980 | tpr=0.7073 | fpr=0.0052 | 4428.7 samples/s | 17.3 steps/s
Avg test loss: 0.28797, Avg test acc: 0.79698, Avg tpr: 0.70758, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.31415 | acc=0.8777 | tpr=0.9690 | fpr=0.1239 | 4456.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.32159 | acc=0.8773 | tpr=0.9787 | fpr=0.1246 | 8484.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.32700 | acc=0.8763 | tpr=0.9813 | fpr=0.1256 | 8691.1 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.32598 | acc=0.8770 | tpr=0.9836 | fpr=0.1250 | 8691.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.32400 | acc=0.8769 | tpr=0.9843 | fpr=0.1251 | 8369.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.32634 | acc=0.8764 | tpr=0.9811 | fpr=0.1255 | 8782.5 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.32704 | acc=0.8764 | tpr=0.9818 | fpr=0.1256 | 8650.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.32840 | acc=0.8757 | tpr=0.9814 | fpr=0.1262 | 8415.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.33146 | acc=0.8756 | tpr=0.9820 | fpr=0.1263 | 8738.4 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.33177 | acc=0.8749 | tpr=0.9819 | fpr=0.1270 | 8822.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.33048 | acc=0.8751 | tpr=0.9809 | fpr=0.1269 | 14868.5 samples/s | 58.1 steps/s
Avg test loss: 0.33021, Avg test acc: 0.87506, Avg tpr: 0.98098, Avg fpr: 0.12687, total FA: 17615

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.17114 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=3.913 | acc=0.8594 | 3565.0 samples/s | 55.7 steps/s
[Step=21650 Epoch=21.1] | Loss=0.03727 | Reg=0.00186 | L2-Norm=13.644 | L2-Norm(final)=3.909 | acc=0.9844 | 4888.0 samples/s | 76.4 steps/s
[Step=21700 Epoch=21.2] | Loss=0.02878 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=3.915 | acc=1.0000 | 4931.5 samples/s | 77.1 steps/s
[Step=21750 Epoch=21.2] | Loss=0.02563 | Reg=0.00187 | L2-Norm=13.669 | L2-Norm(final)=3.922 | acc=0.9688 | 4857.3 samples/s | 75.9 steps/s
[Step=21800 Epoch=21.3] | Loss=0.02392 | Reg=0.00187 | L2-Norm=13.677 | L2-Norm(final)=3.928 | acc=1.0000 | 4934.6 samples/s | 77.1 steps/s
[Step=21850 Epoch=21.3] | Loss=0.02354 | Reg=0.00187 | L2-Norm=13.683 | L2-Norm(final)=3.933 | acc=0.9844 | 4897.4 samples/s | 76.5 steps/s
[Step=21900 Epoch=21.4] | Loss=0.02330 | Reg=0.00187 | L2-Norm=13.689 | L2-Norm(final)=3.937 | acc=1.0000 | 4873.4 samples/s | 76.1 steps/s
[Step=21950 Epoch=21.4] | Loss=0.02265 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.942 | acc=0.9844 | 4904.5 samples/s | 76.6 steps/s
[Step=22000 Epoch=21.5] | Loss=0.02237 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=3.947 | acc=0.9844 | 4913.2 samples/s | 76.8 steps/s
[Step=22050 Epoch=21.5] | Loss=0.02214 | Reg=0.00188 | L2-Norm=13.705 | L2-Norm(final)=3.951 | acc=0.9375 | 4786.6 samples/s | 74.8 steps/s
[Step=22100 Epoch=21.6] | Loss=0.02230 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.955 | acc=1.0000 | 4798.1 samples/s | 75.0 steps/s
[Step=22150 Epoch=21.6] | Loss=0.02196 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=3.959 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step=22200 Epoch=21.7] | Loss=0.02195 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.962 | acc=0.9844 | 4776.3 samples/s | 74.6 steps/s
[Step=22250 Epoch=21.7] | Loss=0.02187 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.965 | acc=1.0000 | 4817.7 samples/s | 75.3 steps/s
[Step=22300 Epoch=21.8] | Loss=0.02154 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.969 | acc=1.0000 | 4717.5 samples/s | 73.7 steps/s
[Step=22350 Epoch=21.8] | Loss=0.02120 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.972 | acc=1.0000 | 4844.4 samples/s | 75.7 steps/s
[Step=22400 Epoch=21.9] | Loss=0.02126 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.976 | acc=0.9375 | 4792.2 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.11290 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=3.912 | acc=0.9375 | 3707.5 samples/s | 57.9 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00508 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=3.911 | acc=1.0000 | 4479.0 samples/s | 70.0 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00296 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=3.918 | acc=1.0000 | 4634.2 samples/s | 72.4 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00257 | Reg=0.00186 | L2-Norm=13.634 | L2-Norm(final)=3.925 | acc=1.0000 | 4637.9 samples/s | 72.5 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00234 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=3.927 | acc=1.0000 | 4667.2 samples/s | 72.9 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00198 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=3.930 | acc=1.0000 | 4645.3 samples/s | 72.6 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00173 | Reg=0.00186 | L2-Norm=13.635 | L2-Norm(final)=3.933 | acc=0.9844 | 4665.9 samples/s | 72.9 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00164 | Reg=0.00186 | L2-Norm=13.633 | L2-Norm(final)=3.935 | acc=1.0000 | 4624.0 samples/s | 72.2 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00174 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=3.936 | acc=1.0000 | 4559.7 samples/s | 71.2 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00171 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=3.937 | acc=1.0000 | 4556.8 samples/s | 71.2 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00156 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=3.938 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00143 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=3.939 | acc=1.0000 | 1879.2 samples/s | 29.4 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00132 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=3.940 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00123 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=3.942 | acc=1.0000 | 4666.1 samples/s | 72.9 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00114 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=3.943 | acc=1.0000 | 4654.8 samples/s | 72.7 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00107 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=3.945 | acc=1.0000 | 4622.7 samples/s | 72.2 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00100 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=3.947 | acc=1.0000 | 4652.0 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35550 | acc=0.7555 | tpr=0.6480 | fpr=0.0109 | 4449.0 samples/s | 17.4 steps/s
Avg test loss: 0.35715, Avg test acc: 0.75519, Avg tpr: 0.64930, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.30627 | acc=0.8869 | tpr=0.9646 | fpr=0.1145 | 4485.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.31399 | acc=0.8858 | tpr=0.9808 | fpr=0.1160 | 8593.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.32069 | acc=0.8852 | tpr=0.9827 | fpr=0.1166 | 8520.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.32021 | acc=0.8861 | tpr=0.9836 | fpr=0.1157 | 8632.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.31843 | acc=0.8860 | tpr=0.9852 | fpr=0.1158 | 8630.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.32216 | acc=0.8851 | tpr=0.9833 | fpr=0.1167 | 8702.9 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.32377 | acc=0.8853 | tpr=0.9837 | fpr=0.1164 | 8865.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.32490 | acc=0.8850 | tpr=0.9830 | fpr=0.1168 | 8535.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.32885 | acc=0.8843 | tpr=0.9834 | fpr=0.1175 | 8729.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.32894 | acc=0.8838 | tpr=0.9828 | fpr=0.1180 | 8789.1 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.32753 | acc=0.8840 | tpr=0.9817 | fpr=0.1178 | 14244.5 samples/s | 55.6 steps/s
Avg test loss: 0.32732, Avg test acc: 0.88395, Avg tpr: 0.98177, Avg fpr: 0.11783, total FA: 16360

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.17547 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=3.997 | acc=0.8906 | 3494.2 samples/s | 54.6 steps/s
[Step=22450 Epoch=21.9] | Loss=0.04953 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=3.978 | acc=0.9844 | 4798.5 samples/s | 75.0 steps/s
[Step=22500 Epoch=22.0] | Loss=0.03758 | Reg=0.00187 | L2-Norm=13.673 | L2-Norm(final)=3.982 | acc=0.9531 | 4862.9 samples/s | 76.0 steps/s
[Step=22550 Epoch=22.0] | Loss=0.03481 | Reg=0.00187 | L2-Norm=13.683 | L2-Norm(final)=3.985 | acc=0.9844 | 4877.1 samples/s | 76.2 steps/s
[Step=22600 Epoch=22.1] | Loss=0.03159 | Reg=0.00187 | L2-Norm=13.691 | L2-Norm(final)=3.990 | acc=1.0000 | 4851.7 samples/s | 75.8 steps/s
[Step=22650 Epoch=22.1] | Loss=0.02964 | Reg=0.00188 | L2-Norm=13.698 | L2-Norm(final)=3.995 | acc=1.0000 | 4725.5 samples/s | 73.8 steps/s
[Step=22700 Epoch=22.2] | Loss=0.02849 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=4.001 | acc=0.9688 | 4780.0 samples/s | 74.7 steps/s
[Step=22750 Epoch=22.2] | Loss=0.02801 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=4.006 | acc=0.9844 | 4758.2 samples/s | 74.3 steps/s
[Step=22800 Epoch=22.3] | Loss=0.02685 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=4.010 | acc=0.9844 | 4815.6 samples/s | 75.2 steps/s
[Step=22850 Epoch=22.3] | Loss=0.02593 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=4.015 | acc=0.9844 | 4730.1 samples/s | 73.9 steps/s
[Step=22900 Epoch=22.4] | Loss=0.02530 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=4.021 | acc=1.0000 | 4794.7 samples/s | 74.9 steps/s
[Step=22950 Epoch=22.4] | Loss=0.02481 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=4.025 | acc=0.9844 | 4754.2 samples/s | 74.3 steps/s
[Step=23000 Epoch=22.5] | Loss=0.02467 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=4.030 | acc=0.9844 | 4796.2 samples/s | 74.9 steps/s
[Step=23050 Epoch=22.5] | Loss=0.02437 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=4.034 | acc=0.9844 | 4856.6 samples/s | 75.9 steps/s
[Step=23100 Epoch=22.6] | Loss=0.02392 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=4.038 | acc=0.9688 | 4729.5 samples/s | 73.9 steps/s
[Step=23150 Epoch=22.6] | Loss=0.02381 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=4.042 | acc=1.0000 | 4757.8 samples/s | 74.3 steps/s
[Step=23200 Epoch=22.7] | Loss=0.02356 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=4.045 | acc=0.9844 | 4761.5 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.01860 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=3.998 | acc=0.9844 | 3798.5 samples/s | 59.4 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00129 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=4.021 | acc=1.0000 | 4369.8 samples/s | 68.3 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00067 | Reg=0.00186 | L2-Norm=13.637 | L2-Norm(final)=4.026 | acc=1.0000 | 4440.7 samples/s | 69.4 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00048 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=4.029 | acc=1.0000 | 4408.3 samples/s | 68.9 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00037 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=4.032 | acc=1.0000 | 4561.6 samples/s | 71.3 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00033 | Reg=0.00186 | L2-Norm=13.620 | L2-Norm(final)=4.035 | acc=1.0000 | 4455.7 samples/s | 69.6 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00028 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=4.037 | acc=1.0000 | 4525.2 samples/s | 70.7 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00025 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=4.040 | acc=1.0000 | 4568.2 samples/s | 71.4 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00022 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=4.042 | acc=1.0000 | 4576.0 samples/s | 71.5 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00020 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=4.044 | acc=1.0000 | 4541.9 samples/s | 71.0 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00018 | Reg=0.00185 | L2-Norm=13.585 | L2-Norm(final)=4.046 | acc=1.0000 | 4573.7 samples/s | 71.5 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00017 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=4.048 | acc=1.0000 | 1969.8 samples/s | 30.8 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00015 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=4.050 | acc=1.0000 | 4643.5 samples/s | 72.6 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00014 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=4.052 | acc=1.0000 | 4624.2 samples/s | 72.3 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00013 | Reg=0.00184 | L2-Norm=13.554 | L2-Norm(final)=4.053 | acc=1.0000 | 4569.0 samples/s | 71.4 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00013 | Reg=0.00183 | L2-Norm=13.546 | L2-Norm(final)=4.055 | acc=1.0000 | 4478.1 samples/s | 70.0 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00012 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=4.057 | acc=1.0000 | 4534.0 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25101 | acc=0.8202 | tpr=0.7412 | fpr=0.0084 | 4426.0 samples/s | 17.3 steps/s
Avg test loss: 0.25227, Avg test acc: 0.82118, Avg tpr: 0.74389, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.31457 | acc=0.8715 | tpr=0.9735 | fpr=0.1303 | 4420.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.32377 | acc=0.8709 | tpr=0.9808 | fpr=0.1312 | 8567.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.32872 | acc=0.8700 | tpr=0.9827 | fpr=0.1321 | 8650.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.32862 | acc=0.8706 | tpr=0.9858 | fpr=0.1315 | 8809.7 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.32700 | acc=0.8703 | tpr=0.9878 | fpr=0.1318 | 9009.1 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.33023 | acc=0.8701 | tpr=0.9862 | fpr=0.1320 | 8159.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.33113 | acc=0.8701 | tpr=0.9850 | fpr=0.1320 | 8793.6 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.33202 | acc=0.8697 | tpr=0.9841 | fpr=0.1324 | 8421.5 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.33502 | acc=0.8690 | tpr=0.9839 | fpr=0.1331 | 9093.2 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.33508 | acc=0.8686 | tpr=0.9833 | fpr=0.1334 | 8855.5 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.33379 | acc=0.8689 | tpr=0.9825 | fpr=0.1332 | 13904.3 samples/s | 54.3 steps/s
Avg test loss: 0.33366, Avg test acc: 0.86886, Avg tpr: 0.98217, Avg fpr: 0.13320, total FA: 18495

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.18904 | Reg=0.00184 | L2-Norm=13.566 | L2-Norm(final)=4.089 | acc=0.8906 | 4074.5 samples/s | 63.7 steps/s
[Step=23250 Epoch=22.7] | Loss=0.03700 | Reg=0.00186 | L2-Norm=13.620 | L2-Norm(final)=4.083 | acc=0.9844 | 4435.3 samples/s | 69.3 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02866 | Reg=0.00186 | L2-Norm=13.637 | L2-Norm(final)=4.090 | acc=0.9531 | 4776.3 samples/s | 74.6 steps/s
[Step=23350 Epoch=22.8] | Loss=0.02455 | Reg=0.00186 | L2-Norm=13.647 | L2-Norm(final)=4.098 | acc=0.9844 | 4713.9 samples/s | 73.7 steps/s
[Step=23400 Epoch=22.8] | Loss=0.02417 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=4.105 | acc=0.9688 | 4795.4 samples/s | 74.9 steps/s
[Step=23450 Epoch=22.9] | Loss=0.02331 | Reg=0.00187 | L2-Norm=13.661 | L2-Norm(final)=4.110 | acc=0.9688 | 4767.6 samples/s | 74.5 steps/s
[Step=23500 Epoch=22.9] | Loss=0.02291 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=4.114 | acc=0.9688 | 4742.9 samples/s | 74.1 steps/s
[Step=23550 Epoch=23.0] | Loss=0.02244 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=4.119 | acc=0.9688 | 4817.5 samples/s | 75.3 steps/s
[Step=23600 Epoch=23.0] | Loss=0.02189 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=4.123 | acc=1.0000 | 4808.0 samples/s | 75.1 steps/s
[Step=23650 Epoch=23.1] | Loss=0.02172 | Reg=0.00187 | L2-Norm=13.683 | L2-Norm(final)=4.128 | acc=1.0000 | 4791.4 samples/s | 74.9 steps/s
[Step=23700 Epoch=23.1] | Loss=0.02149 | Reg=0.00187 | L2-Norm=13.688 | L2-Norm(final)=4.133 | acc=0.9531 | 4792.1 samples/s | 74.9 steps/s
[Step=23750 Epoch=23.2] | Loss=0.02136 | Reg=0.00187 | L2-Norm=13.692 | L2-Norm(final)=4.137 | acc=0.9844 | 4713.0 samples/s | 73.6 steps/s
[Step=23800 Epoch=23.2] | Loss=0.02131 | Reg=0.00188 | L2-Norm=13.697 | L2-Norm(final)=4.141 | acc=0.9844 | 4876.9 samples/s | 76.2 steps/s
[Step=23850 Epoch=23.3] | Loss=0.02145 | Reg=0.00188 | L2-Norm=13.702 | L2-Norm(final)=4.145 | acc=0.9531 | 4748.7 samples/s | 74.2 steps/s
[Step=23900 Epoch=23.3] | Loss=0.02143 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=4.149 | acc=0.9844 | 4806.6 samples/s | 75.1 steps/s
[Step=23950 Epoch=23.4] | Loss=0.02127 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=4.152 | acc=0.9531 | 4800.5 samples/s | 75.0 steps/s
[Step=24000 Epoch=23.4] | Loss=0.02126 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=4.156 | acc=0.9844 | 4818.0 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.01475 | Reg=0.00184 | L2-Norm=13.566 | L2-Norm(final)=4.090 | acc=0.9844 | 3442.3 samples/s | 53.8 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00213 | Reg=0.00185 | L2-Norm=13.606 | L2-Norm(final)=4.108 | acc=1.0000 | 4660.2 samples/s | 72.8 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00138 | Reg=0.00185 | L2-Norm=13.612 | L2-Norm(final)=4.117 | acc=1.0000 | 4660.0 samples/s | 72.8 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00186 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=4.119 | acc=1.0000 | 4613.0 samples/s | 72.1 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00159 | Reg=0.00185 | L2-Norm=13.609 | L2-Norm(final)=4.119 | acc=1.0000 | 4650.4 samples/s | 72.7 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00189 | Reg=0.00185 | L2-Norm=13.608 | L2-Norm(final)=4.120 | acc=1.0000 | 4713.4 samples/s | 73.6 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00167 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=4.119 | acc=1.0000 | 4739.8 samples/s | 74.1 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00146 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=4.120 | acc=1.0000 | 4651.5 samples/s | 72.7 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00154 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=4.121 | acc=1.0000 | 4560.7 samples/s | 71.3 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00152 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=4.121 | acc=1.0000 | 4671.2 samples/s | 73.0 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00145 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=4.121 | acc=1.0000 | 4635.3 samples/s | 72.4 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00139 | Reg=0.00185 | L2-Norm=13.602 | L2-Norm(final)=4.121 | acc=1.0000 | 1961.1 samples/s | 30.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00129 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=4.122 | acc=1.0000 | 4714.2 samples/s | 73.7 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00123 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=4.123 | acc=1.0000 | 4663.8 samples/s | 72.9 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00116 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=4.124 | acc=1.0000 | 4566.6 samples/s | 71.4 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00109 | Reg=0.00185 | L2-Norm=13.594 | L2-Norm(final)=4.125 | acc=1.0000 | 4554.6 samples/s | 71.2 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00108 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=4.127 | acc=1.0000 | 4548.1 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36955 | acc=0.7511 | tpr=0.6401 | fpr=0.0079 | 4409.4 samples/s | 17.2 steps/s
Avg test loss: 0.37024, Avg test acc: 0.75142, Avg tpr: 0.64213, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.25098 | acc=0.9043 | tpr=0.9690 | fpr=0.0969 | 4471.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.25798 | acc=0.9032 | tpr=0.9787 | fpr=0.0982 | 8605.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.26298 | acc=0.9029 | tpr=0.9798 | fpr=0.0985 | 8770.4 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.26345 | acc=0.9038 | tpr=0.9836 | fpr=0.0976 | 8493.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.26154 | acc=0.9038 | tpr=0.9843 | fpr=0.0976 | 8684.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.26418 | acc=0.9033 | tpr=0.9811 | fpr=0.0981 | 8530.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.26568 | acc=0.9030 | tpr=0.9812 | fpr=0.0984 | 8593.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.26671 | acc=0.9031 | tpr=0.9792 | fpr=0.0983 | 8756.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.26969 | acc=0.9024 | tpr=0.9791 | fpr=0.0990 | 8944.8 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.26953 | acc=0.9022 | tpr=0.9793 | fpr=0.0992 | 8419.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.26856 | acc=0.9023 | tpr=0.9781 | fpr=0.0991 | 15420.5 samples/s | 60.2 steps/s
Avg test loss: 0.26826, Avg test acc: 0.90229, Avg tpr: 0.97821, Avg fpr: 0.09909, total FA: 13759

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.39847 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=4.176 | acc=0.7344 | 3875.6 samples/s | 60.6 steps/s
[Step=24050 Epoch=23.5] | Loss=0.05325 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=4.169 | acc=1.0000 | 4620.7 samples/s | 72.2 steps/s
[Step=24100 Epoch=23.5] | Loss=0.03840 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=4.172 | acc=0.9219 | 4827.8 samples/s | 75.4 steps/s
[Step=24150 Epoch=23.6] | Loss=0.03233 | Reg=0.00186 | L2-Norm=13.633 | L2-Norm(final)=4.176 | acc=0.9844 | 4845.9 samples/s | 75.7 steps/s
[Step=24200 Epoch=23.6] | Loss=0.02887 | Reg=0.00186 | L2-Norm=13.638 | L2-Norm(final)=4.181 | acc=0.9844 | 4830.8 samples/s | 75.5 steps/s
[Step=24250 Epoch=23.7] | Loss=0.02674 | Reg=0.00186 | L2-Norm=13.643 | L2-Norm(final)=4.185 | acc=1.0000 | 4794.5 samples/s | 74.9 steps/s
[Step=24300 Epoch=23.7] | Loss=0.02551 | Reg=0.00186 | L2-Norm=13.647 | L2-Norm(final)=4.189 | acc=1.0000 | 4764.9 samples/s | 74.5 steps/s
[Step=24350 Epoch=23.8] | Loss=0.02454 | Reg=0.00186 | L2-Norm=13.650 | L2-Norm(final)=4.192 | acc=0.9844 | 4854.4 samples/s | 75.8 steps/s
[Step=24400 Epoch=23.8] | Loss=0.02346 | Reg=0.00186 | L2-Norm=13.653 | L2-Norm(final)=4.195 | acc=0.9844 | 4727.4 samples/s | 73.9 steps/s
[Step=24450 Epoch=23.9] | Loss=0.02251 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=4.199 | acc=1.0000 | 4805.0 samples/s | 75.1 steps/s
[Step=24500 Epoch=23.9] | Loss=0.02164 | Reg=0.00187 | L2-Norm=13.658 | L2-Norm(final)=4.202 | acc=1.0000 | 4831.8 samples/s | 75.5 steps/s
[Step=24550 Epoch=24.0] | Loss=0.02082 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=4.205 | acc=0.9844 | 4766.1 samples/s | 74.5 steps/s
[Step=24600 Epoch=24.0] | Loss=0.02064 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=4.209 | acc=1.0000 | 4851.8 samples/s | 75.8 steps/s
[Step=24650 Epoch=24.1] | Loss=0.02019 | Reg=0.00187 | L2-Norm=13.665 | L2-Norm(final)=4.211 | acc=1.0000 | 4819.1 samples/s | 75.3 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01977 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=4.214 | acc=1.0000 | 4854.5 samples/s | 75.9 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01951 | Reg=0.00187 | L2-Norm=13.669 | L2-Norm(final)=4.217 | acc=0.9844 | 4750.5 samples/s | 74.2 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01937 | Reg=0.00187 | L2-Norm=13.671 | L2-Norm(final)=4.220 | acc=1.0000 | 4825.2 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.00638 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=4.176 | acc=1.0000 | 3601.7 samples/s | 56.3 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00282 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=4.182 | acc=1.0000 | 4502.5 samples/s | 70.4 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00149 | Reg=0.00185 | L2-Norm=13.606 | L2-Norm(final)=4.185 | acc=1.0000 | 4613.8 samples/s | 72.1 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00104 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=4.188 | acc=1.0000 | 4599.5 samples/s | 71.9 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00080 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=4.190 | acc=1.0000 | 4463.4 samples/s | 69.7 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00065 | Reg=0.00185 | L2-Norm=13.601 | L2-Norm(final)=4.192 | acc=1.0000 | 4533.7 samples/s | 70.8 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00055 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=4.193 | acc=1.0000 | 4601.2 samples/s | 71.9 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00049 | Reg=0.00185 | L2-Norm=13.595 | L2-Norm(final)=4.195 | acc=1.0000 | 4530.0 samples/s | 70.8 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00043 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=4.196 | acc=1.0000 | 4526.9 samples/s | 70.7 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00039 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=4.198 | acc=1.0000 | 4521.1 samples/s | 70.6 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00036 | Reg=0.00185 | L2-Norm=13.587 | L2-Norm(final)=4.199 | acc=1.0000 | 4614.0 samples/s | 72.1 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00033 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=4.200 | acc=1.0000 | 1959.5 samples/s | 30.6 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00030 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=4.201 | acc=1.0000 | 4612.1 samples/s | 72.1 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00028 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=4.202 | acc=1.0000 | 4577.1 samples/s | 71.5 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00026 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=4.203 | acc=1.0000 | 4544.3 samples/s | 71.0 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00025 | Reg=0.00184 | L2-Norm=13.571 | L2-Norm(final)=4.204 | acc=1.0000 | 4537.4 samples/s | 70.9 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00023 | Reg=0.00184 | L2-Norm=13.568 | L2-Norm(final)=4.205 | acc=1.0000 | 4536.9 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26838 | acc=0.8139 | tpr=0.7307 | fpr=0.0055 | 4360.3 samples/s | 17.0 steps/s
Avg test loss: 0.26962, Avg test acc: 0.81581, Avg tpr: 0.73486, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.31732 | acc=0.8707 | tpr=0.9690 | fpr=0.1311 | 4357.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.32508 | acc=0.8710 | tpr=0.9765 | fpr=0.1310 | 8817.6 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.33049 | acc=0.8704 | tpr=0.9784 | fpr=0.1316 | 8791.2 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.32995 | acc=0.8710 | tpr=0.9825 | fpr=0.1311 | 8554.9 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.32786 | acc=0.8707 | tpr=0.9843 | fpr=0.1314 | 9055.2 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.33049 | acc=0.8703 | tpr=0.9818 | fpr=0.1317 | 8217.1 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.33188 | acc=0.8701 | tpr=0.9825 | fpr=0.1319 | 8658.6 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.33313 | acc=0.8697 | tpr=0.9819 | fpr=0.1324 | 8621.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.33609 | acc=0.8690 | tpr=0.9825 | fpr=0.1330 | 8788.4 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.33621 | acc=0.8689 | tpr=0.9819 | fpr=0.1331 | 8854.7 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.33531 | acc=0.8688 | tpr=0.9813 | fpr=0.1333 | 14638.8 samples/s | 57.2 steps/s
Avg test loss: 0.33504, Avg test acc: 0.86875, Avg tpr: 0.98138, Avg fpr: 0.13330, total FA: 18508

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.19032 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=4.238 | acc=0.7969 | 3604.2 samples/s | 56.3 steps/s
[Step=24850 Epoch=24.3] | Loss=0.03801 | Reg=0.00185 | L2-Norm=13.609 | L2-Norm(final)=4.238 | acc=0.9531 | 4867.7 samples/s | 76.1 steps/s
[Step=24900 Epoch=24.3] | Loss=0.02650 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=4.242 | acc=0.9844 | 4892.1 samples/s | 76.4 steps/s
[Step=24950 Epoch=24.4] | Loss=0.02253 | Reg=0.00186 | L2-Norm=13.624 | L2-Norm(final)=4.247 | acc=1.0000 | 4896.6 samples/s | 76.5 steps/s
[Step=25000 Epoch=24.4] | Loss=0.02086 | Reg=0.00186 | L2-Norm=13.629 | L2-Norm(final)=4.252 | acc=0.9688 | 4922.1 samples/s | 76.9 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01951 | Reg=0.00186 | L2-Norm=13.633 | L2-Norm(final)=4.256 | acc=0.9844 | 4833.7 samples/s | 75.5 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01902 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=4.260 | acc=1.0000 | 4853.4 samples/s | 75.8 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01857 | Reg=0.00186 | L2-Norm=13.639 | L2-Norm(final)=4.263 | acc=1.0000 | 4840.7 samples/s | 75.6 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01820 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=4.266 | acc=1.0000 | 4829.1 samples/s | 75.5 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01762 | Reg=0.00186 | L2-Norm=13.644 | L2-Norm(final)=4.269 | acc=0.9844 | 4779.2 samples/s | 74.7 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01717 | Reg=0.00186 | L2-Norm=13.647 | L2-Norm(final)=4.272 | acc=1.0000 | 4841.3 samples/s | 75.6 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01700 | Reg=0.00186 | L2-Norm=13.649 | L2-Norm(final)=4.275 | acc=0.9844 | 4791.2 samples/s | 74.9 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01697 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=4.278 | acc=0.9844 | 4857.0 samples/s | 75.9 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01696 | Reg=0.00186 | L2-Norm=13.653 | L2-Norm(final)=4.281 | acc=0.9844 | 4776.6 samples/s | 74.6 steps/s
[Step=25500 Epoch=24.9] | Loss=0.01694 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=4.283 | acc=0.9844 | 4817.2 samples/s | 75.3 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01710 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=4.286 | acc=1.0000 | 4790.1 samples/s | 74.8 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01702 | Reg=0.00187 | L2-Norm=13.658 | L2-Norm(final)=4.288 | acc=0.9688 | 4751.4 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.01734 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=4.238 | acc=0.9844 | 3783.1 samples/s | 59.1 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00333 | Reg=0.00185 | L2-Norm=13.597 | L2-Norm(final)=4.242 | acc=1.0000 | 4575.5 samples/s | 71.5 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00177 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=4.245 | acc=1.0000 | 4625.2 samples/s | 72.3 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00120 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=4.247 | acc=1.0000 | 4702.0 samples/s | 73.5 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00092 | Reg=0.00185 | L2-Norm=13.595 | L2-Norm(final)=4.249 | acc=1.0000 | 4617.5 samples/s | 72.1 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00075 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=4.251 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00063 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=4.252 | acc=1.0000 | 4707.0 samples/s | 73.5 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00055 | Reg=0.00185 | L2-Norm=13.587 | L2-Norm(final)=4.253 | acc=1.0000 | 4620.7 samples/s | 72.2 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00049 | Reg=0.00185 | L2-Norm=13.583 | L2-Norm(final)=4.254 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00044 | Reg=0.00184 | L2-Norm=13.580 | L2-Norm(final)=4.256 | acc=1.0000 | 4688.2 samples/s | 73.3 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00039 | Reg=0.00184 | L2-Norm=13.576 | L2-Norm(final)=4.257 | acc=1.0000 | 4686.5 samples/s | 73.2 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00036 | Reg=0.00184 | L2-Norm=13.573 | L2-Norm(final)=4.258 | acc=1.0000 | 2013.1 samples/s | 31.5 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00033 | Reg=0.00184 | L2-Norm=13.569 | L2-Norm(final)=4.259 | acc=1.0000 | 4620.7 samples/s | 72.2 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00031 | Reg=0.00184 | L2-Norm=13.565 | L2-Norm(final)=4.260 | acc=1.0000 | 4547.9 samples/s | 71.1 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00029 | Reg=0.00184 | L2-Norm=13.561 | L2-Norm(final)=4.260 | acc=1.0000 | 4579.8 samples/s | 71.6 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00027 | Reg=0.00184 | L2-Norm=13.557 | L2-Norm(final)=4.261 | acc=1.0000 | 4546.9 samples/s | 71.0 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00026 | Reg=0.00184 | L2-Norm=13.553 | L2-Norm(final)=4.262 | acc=1.0000 | 4503.4 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25096 | acc=0.8305 | tpr=0.7552 | fpr=0.0062 | 4445.4 samples/s | 17.4 steps/s
Avg test loss: 0.25236, Avg test acc: 0.83116, Avg tpr: 0.75748, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.32394 | acc=0.8724 | tpr=0.9690 | fpr=0.1293 | 4367.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.33237 | acc=0.8728 | tpr=0.9787 | fpr=0.1292 | 8605.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.33852 | acc=0.8716 | tpr=0.9813 | fpr=0.1305 | 9243.9 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.33727 | acc=0.8724 | tpr=0.9836 | fpr=0.1297 | 8238.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.33506 | acc=0.8721 | tpr=0.9860 | fpr=0.1300 | 8958.2 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.33804 | acc=0.8716 | tpr=0.9840 | fpr=0.1304 | 8316.7 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.33939 | acc=0.8714 | tpr=0.9843 | fpr=0.1307 | 8787.3 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.34059 | acc=0.8709 | tpr=0.9841 | fpr=0.1312 | 8642.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.34369 | acc=0.8702 | tpr=0.9844 | fpr=0.1318 | 8517.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.34404 | acc=0.8699 | tpr=0.9837 | fpr=0.1322 | 8736.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.34293 | acc=0.8699 | tpr=0.9829 | fpr=0.1322 | 15318.7 samples/s | 59.8 steps/s
Avg test loss: 0.34271, Avg test acc: 0.86980, Avg tpr: 0.98257, Avg fpr: 0.13225, total FA: 18363

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.13339 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=4.297 | acc=0.9062 | 3702.5 samples/s | 57.9 steps/s
[Step=25650 Epoch=25.0] | Loss=0.03240 | Reg=0.00185 | L2-Norm=13.589 | L2-Norm(final)=4.295 | acc=0.9688 | 4844.1 samples/s | 75.7 steps/s
[Step=25700 Epoch=25.1] | Loss=0.02480 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=4.300 | acc=0.9844 | 4884.1 samples/s | 76.3 steps/s
[Step=25750 Epoch=25.1] | Loss=0.02212 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=4.304 | acc=0.9531 | 4876.2 samples/s | 76.2 steps/s
[Step=25800 Epoch=25.2] | Loss=0.02011 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=4.307 | acc=1.0000 | 4838.7 samples/s | 75.6 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01897 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=4.310 | acc=1.0000 | 4785.7 samples/s | 74.8 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01839 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=4.314 | acc=1.0000 | 4810.1 samples/s | 75.2 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01796 | Reg=0.00185 | L2-Norm=13.616 | L2-Norm(final)=4.317 | acc=1.0000 | 4792.2 samples/s | 74.9 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01732 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=4.320 | acc=1.0000 | 4851.8 samples/s | 75.8 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01700 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=4.323 | acc=1.0000 | 4807.2 samples/s | 75.1 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01701 | Reg=0.00186 | L2-Norm=13.624 | L2-Norm(final)=4.326 | acc=1.0000 | 4825.9 samples/s | 75.4 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01700 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=4.329 | acc=1.0000 | 4823.9 samples/s | 75.4 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01683 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=4.331 | acc=0.9531 | 4806.4 samples/s | 75.1 steps/s
[Step=26250 Epoch=25.6] | Loss=0.01656 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=4.334 | acc=0.9688 | 4826.9 samples/s | 75.4 steps/s
[Step=26300 Epoch=25.7] | Loss=0.01670 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=4.336 | acc=0.9531 | 4782.4 samples/s | 74.7 steps/s
[Step=26350 Epoch=25.7] | Loss=0.01667 | Reg=0.00186 | L2-Norm=13.634 | L2-Norm(final)=4.338 | acc=1.0000 | 4811.9 samples/s | 75.2 steps/s
[Step=26400 Epoch=25.8] | Loss=0.01653 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=4.341 | acc=0.9844 | 4950.0 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.01425 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=4.297 | acc=0.9844 | 3632.6 samples/s | 56.8 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00230 | Reg=0.00184 | L2-Norm=13.577 | L2-Norm(final)=4.305 | acc=1.0000 | 4438.8 samples/s | 69.4 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00120 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=4.308 | acc=1.0000 | 4503.2 samples/s | 70.4 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00081 | Reg=0.00184 | L2-Norm=13.576 | L2-Norm(final)=4.310 | acc=1.0000 | 4513.8 samples/s | 70.5 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00063 | Reg=0.00184 | L2-Norm=13.573 | L2-Norm(final)=4.311 | acc=1.0000 | 4485.6 samples/s | 70.1 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00051 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=4.313 | acc=1.0000 | 4494.8 samples/s | 70.2 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00044 | Reg=0.00184 | L2-Norm=13.566 | L2-Norm(final)=4.314 | acc=1.0000 | 4630.6 samples/s | 72.4 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00038 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=4.315 | acc=1.0000 | 4558.3 samples/s | 71.2 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00033 | Reg=0.00184 | L2-Norm=13.558 | L2-Norm(final)=4.317 | acc=1.0000 | 4624.7 samples/s | 72.3 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00030 | Reg=0.00184 | L2-Norm=13.553 | L2-Norm(final)=4.318 | acc=1.0000 | 4582.8 samples/s | 71.6 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00027 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=4.319 | acc=1.0000 | 4587.5 samples/s | 71.7 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00025 | Reg=0.00183 | L2-Norm=13.544 | L2-Norm(final)=4.319 | acc=1.0000 | 1964.8 samples/s | 30.7 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00023 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=4.320 | acc=1.0000 | 4597.8 samples/s | 71.8 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00021 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=4.321 | acc=1.0000 | 4454.5 samples/s | 69.6 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00020 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=4.322 | acc=1.0000 | 4550.3 samples/s | 71.1 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00019 | Reg=0.00183 | L2-Norm=13.525 | L2-Norm(final)=4.323 | acc=1.0000 | 4563.4 samples/s | 71.3 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00018 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=4.324 | acc=1.0000 | 4476.3 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21848 | acc=0.8501 | tpr=0.7842 | fpr=0.0069 | 4360.0 samples/s | 17.0 steps/s
Avg test loss: 0.22102, Avg test acc: 0.84919, Avg tpr: 0.78405, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.35949 | acc=0.8580 | tpr=0.9735 | fpr=0.1440 | 4417.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.36854 | acc=0.8580 | tpr=0.9765 | fpr=0.1442 | 9121.4 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.37435 | acc=0.8574 | tpr=0.9798 | fpr=0.1449 | 7981.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.37271 | acc=0.8582 | tpr=0.9836 | fpr=0.1441 | 9168.6 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.36967 | acc=0.8583 | tpr=0.9852 | fpr=0.1440 | 8367.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.37261 | acc=0.8582 | tpr=0.9833 | fpr=0.1441 | 8601.5 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.37395 | acc=0.8581 | tpr=0.9837 | fpr=0.1442 | 8828.1 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.37527 | acc=0.8580 | tpr=0.9841 | fpr=0.1443 | 8539.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.37844 | acc=0.8573 | tpr=0.9844 | fpr=0.1450 | 8604.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.37894 | acc=0.8571 | tpr=0.9841 | fpr=0.1452 | 8871.6 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.37791 | acc=0.8572 | tpr=0.9837 | fpr=0.1451 | 14765.6 samples/s | 57.7 steps/s
Avg test loss: 0.37777, Avg test acc: 0.85715, Avg tpr: 0.98376, Avg fpr: 0.14515, total FA: 20154

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.14236 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=4.356 | acc=0.8906 | 3952.0 samples/s | 61.8 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02500 | Reg=0.00184 | L2-Norm=13.554 | L2-Norm(final)=4.358 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01998 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=4.363 | acc=0.9844 | 4718.0 samples/s | 73.7 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01861 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=4.368 | acc=0.9844 | 4807.0 samples/s | 75.1 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01726 | Reg=0.00184 | L2-Norm=13.571 | L2-Norm(final)=4.372 | acc=1.0000 | 4797.8 samples/s | 75.0 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01624 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=4.376 | acc=1.0000 | 4811.4 samples/s | 75.2 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01564 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=4.380 | acc=0.9844 | 4825.0 samples/s | 75.4 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01532 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=4.384 | acc=0.9844 | 4780.9 samples/s | 74.7 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01497 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=4.387 | acc=1.0000 | 4811.0 samples/s | 75.2 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01506 | Reg=0.00185 | L2-Norm=13.587 | L2-Norm(final)=4.391 | acc=1.0000 | 4839.5 samples/s | 75.6 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01507 | Reg=0.00185 | L2-Norm=13.589 | L2-Norm(final)=4.394 | acc=0.9688 | 4699.6 samples/s | 73.4 steps/s
[Step=26950 Epoch=26.3] | Loss=0.01531 | Reg=0.00185 | L2-Norm=13.592 | L2-Norm(final)=4.396 | acc=0.9844 | 4765.3 samples/s | 74.5 steps/s
[Step=27000 Epoch=26.4] | Loss=0.01533 | Reg=0.00185 | L2-Norm=13.594 | L2-Norm(final)=4.399 | acc=0.9844 | 4900.4 samples/s | 76.6 steps/s
[Step=27050 Epoch=26.4] | Loss=0.01535 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=4.401 | acc=0.9688 | 4924.9 samples/s | 77.0 steps/s
[Step=27100 Epoch=26.5] | Loss=0.01540 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=4.403 | acc=0.9844 | 4938.4 samples/s | 77.2 steps/s
[Step=27150 Epoch=26.5] | Loss=0.01537 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=4.406 | acc=0.9844 | 4880.8 samples/s | 76.3 steps/s
[Step=27200 Epoch=26.6] | Loss=0.01552 | Reg=0.00185 | L2-Norm=13.602 | L2-Norm(final)=4.408 | acc=0.9844 | 4907.2 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.04207 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=4.356 | acc=0.9531 | 3823.8 samples/s | 59.7 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00436 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=4.362 | acc=1.0000 | 4124.5 samples/s | 64.4 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00232 | Reg=0.00184 | L2-Norm=13.550 | L2-Norm(final)=4.365 | acc=1.0000 | 4582.8 samples/s | 71.6 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00157 | Reg=0.00184 | L2-Norm=13.548 | L2-Norm(final)=4.368 | acc=1.0000 | 4540.7 samples/s | 70.9 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00122 | Reg=0.00183 | L2-Norm=13.546 | L2-Norm(final)=4.369 | acc=1.0000 | 4500.1 samples/s | 70.3 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00099 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=4.371 | acc=1.0000 | 4486.0 samples/s | 70.1 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00084 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=4.372 | acc=1.0000 | 4499.0 samples/s | 70.3 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00073 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=4.374 | acc=1.0000 | 4483.8 samples/s | 70.1 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00064 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=4.375 | acc=1.0000 | 4565.6 samples/s | 71.3 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00057 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=4.376 | acc=1.0000 | 4507.4 samples/s | 70.4 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00052 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=4.377 | acc=1.0000 | 4586.6 samples/s | 71.7 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00047 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=4.378 | acc=1.0000 | 1958.0 samples/s | 30.6 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00044 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=4.379 | acc=1.0000 | 4672.6 samples/s | 73.0 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00040 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=4.379 | acc=1.0000 | 4554.2 samples/s | 71.2 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00038 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=4.380 | acc=1.0000 | 4591.1 samples/s | 71.7 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00035 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=4.381 | acc=1.0000 | 4507.9 samples/s | 70.4 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00033 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=4.382 | acc=1.0000 | 4564.0 samples/s | 71.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24377 | acc=0.8302 | tpr=0.7548 | fpr=0.0062 | 4359.9 samples/s | 17.0 steps/s
Avg test loss: 0.24705, Avg test acc: 0.82867, Avg tpr: 0.75415, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.32931 | acc=0.8802 | tpr=0.9646 | fpr=0.1214 | 4433.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.33796 | acc=0.8802 | tpr=0.9744 | fpr=0.1215 | 8701.5 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.34360 | acc=0.8796 | tpr=0.9784 | fpr=0.1222 | 8504.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.34209 | acc=0.8807 | tpr=0.9814 | fpr=0.1212 | 8684.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.33909 | acc=0.8812 | tpr=0.9834 | fpr=0.1207 | 9009.0 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.34212 | acc=0.8808 | tpr=0.9818 | fpr=0.1211 | 8397.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.34282 | acc=0.8805 | tpr=0.9825 | fpr=0.1214 | 8626.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.34416 | acc=0.8800 | tpr=0.9814 | fpr=0.1219 | 8783.7 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.34726 | acc=0.8796 | tpr=0.9820 | fpr=0.1223 | 8691.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.34759 | acc=0.8792 | tpr=0.9824 | fpr=0.1226 | 8536.4 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.34635 | acc=0.8794 | tpr=0.9817 | fpr=0.1224 | 15457.2 samples/s | 60.4 steps/s
Avg test loss: 0.34617, Avg test acc: 0.87940, Avg tpr: 0.98177, Avg fpr: 0.12246, total FA: 17003

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.19451 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=4.419 | acc=0.8750 | 3996.0 samples/s | 62.4 steps/s
[Step=27250 Epoch=26.6] | Loss=0.03094 | Reg=0.00183 | L2-Norm=13.539 | L2-Norm(final)=4.417 | acc=0.9844 | 4619.0 samples/s | 72.2 steps/s
[Step=27300 Epoch=26.7] | Loss=0.02363 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=4.422 | acc=1.0000 | 4781.5 samples/s | 74.7 steps/s
[Step=27350 Epoch=26.7] | Loss=0.02002 | Reg=0.00184 | L2-Norm=13.555 | L2-Norm(final)=4.426 | acc=1.0000 | 4773.1 samples/s | 74.6 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01866 | Reg=0.00184 | L2-Norm=13.559 | L2-Norm(final)=4.431 | acc=1.0000 | 4713.0 samples/s | 73.6 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01789 | Reg=0.00184 | L2-Norm=13.563 | L2-Norm(final)=4.435 | acc=0.9531 | 4771.2 samples/s | 74.5 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01789 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=4.438 | acc=1.0000 | 4781.1 samples/s | 74.7 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01743 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=4.442 | acc=0.9688 | 4809.1 samples/s | 75.1 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01724 | Reg=0.00184 | L2-Norm=13.573 | L2-Norm(final)=4.445 | acc=1.0000 | 4741.6 samples/s | 74.1 steps/s
[Step=27650 Epoch=27.0] | Loss=0.01691 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=4.448 | acc=0.9688 | 4806.6 samples/s | 75.1 steps/s
[Step=27700 Epoch=27.0] | Loss=0.01658 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=4.451 | acc=0.9844 | 4774.5 samples/s | 74.6 steps/s
[Step=27750 Epoch=27.1] | Loss=0.01650 | Reg=0.00184 | L2-Norm=13.580 | L2-Norm(final)=4.455 | acc=0.9844 | 4817.4 samples/s | 75.3 steps/s
[Step=27800 Epoch=27.1] | Loss=0.01639 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=4.457 | acc=0.9844 | 4851.4 samples/s | 75.8 steps/s
[Step=27850 Epoch=27.2] | Loss=0.01665 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=4.460 | acc=0.9844 | 4781.2 samples/s | 74.7 steps/s
[Step=27900 Epoch=27.2] | Loss=0.01646 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=4.463 | acc=1.0000 | 4799.7 samples/s | 75.0 steps/s
[Step=27950 Epoch=27.3] | Loss=0.01655 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=4.465 | acc=1.0000 | 4794.8 samples/s | 74.9 steps/s
[Step=28000 Epoch=27.3] | Loss=0.01629 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=4.468 | acc=0.9844 | 4788.4 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.02284 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=4.419 | acc=0.9844 | 3576.8 samples/s | 55.9 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00309 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=4.425 | acc=1.0000 | 4591.8 samples/s | 71.7 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00158 | Reg=0.00183 | L2-Norm=13.521 | L2-Norm(final)=4.428 | acc=1.0000 | 4666.7 samples/s | 72.9 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00108 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=4.430 | acc=1.0000 | 4595.8 samples/s | 71.8 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00083 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=4.431 | acc=1.0000 | 4562.4 samples/s | 71.3 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00068 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=4.433 | acc=1.0000 | 4528.6 samples/s | 70.8 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00057 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=4.434 | acc=1.0000 | 4585.4 samples/s | 71.6 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00049 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=4.436 | acc=1.0000 | 4534.1 samples/s | 70.8 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00044 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=4.437 | acc=1.0000 | 4544.6 samples/s | 71.0 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00039 | Reg=0.00182 | L2-Norm=13.496 | L2-Norm(final)=4.438 | acc=1.0000 | 4531.5 samples/s | 70.8 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00036 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=4.439 | acc=1.0000 | 4612.5 samples/s | 72.1 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00033 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=4.440 | acc=1.0000 | 1994.8 samples/s | 31.2 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00030 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=4.441 | acc=1.0000 | 4610.0 samples/s | 72.0 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00028 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=4.442 | acc=1.0000 | 4611.7 samples/s | 72.1 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00026 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=4.443 | acc=1.0000 | 4458.6 samples/s | 69.7 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00025 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=4.444 | acc=1.0000 | 4577.6 samples/s | 71.5 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00023 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=4.445 | acc=1.0000 | 4472.1 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25034 | acc=0.8285 | tpr=0.7514 | fpr=0.0040 | 4424.9 samples/s | 17.3 steps/s
Avg test loss: 0.25351, Avg test acc: 0.82783, Avg tpr: 0.75188, Avg fpr: 0.00513, total FA: 40

Testing server on iccad2012
[Step=  50] | Loss=0.35553 | acc=0.8611 | tpr=0.9646 | fpr=0.1408 | 4425.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.36406 | acc=0.8606 | tpr=0.9723 | fpr=0.1415 | 8479.7 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.36957 | acc=0.8607 | tpr=0.9769 | fpr=0.1414 | 8741.0 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.36797 | acc=0.8621 | tpr=0.9803 | fpr=0.1401 | 8562.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.36527 | acc=0.8622 | tpr=0.9825 | fpr=0.1400 | 8719.6 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.36837 | acc=0.8621 | tpr=0.9811 | fpr=0.1400 | 8669.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.36934 | acc=0.8617 | tpr=0.9812 | fpr=0.1404 | 8457.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.37048 | acc=0.8612 | tpr=0.9809 | fpr=0.1410 | 8542.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.37354 | acc=0.8609 | tpr=0.9815 | fpr=0.1413 | 8720.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.37388 | acc=0.8607 | tpr=0.9815 | fpr=0.1415 | 8659.4 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.37264 | acc=0.8607 | tpr=0.9801 | fpr=0.1415 | 15421.9 samples/s | 60.2 steps/s
Avg test loss: 0.37250, Avg test acc: 0.86065, Avg tpr: 0.98019, Avg fpr: 0.14152, total FA: 19650

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.17588 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=4.484 | acc=0.8281 | 3752.5 samples/s | 58.6 steps/s
[Step=28050 Epoch=27.4] | Loss=0.03556 | Reg=0.00182 | L2-Norm=13.509 | L2-Norm(final)=4.481 | acc=1.0000 | 4789.8 samples/s | 74.8 steps/s
[Step=28100 Epoch=27.4] | Loss=0.02484 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=4.484 | acc=0.9844 | 4891.4 samples/s | 76.4 steps/s
[Step=28150 Epoch=27.5] | Loss=0.02152 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=4.488 | acc=0.9844 | 4865.2 samples/s | 76.0 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01925 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=4.492 | acc=1.0000 | 4919.0 samples/s | 76.9 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01905 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=4.496 | acc=1.0000 | 4891.5 samples/s | 76.4 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01942 | Reg=0.00183 | L2-Norm=13.532 | L2-Norm(final)=4.498 | acc=1.0000 | 4938.0 samples/s | 77.2 steps/s
[Step=28350 Epoch=27.7] | Loss=0.01863 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=4.501 | acc=0.9844 | 4935.9 samples/s | 77.1 steps/s
[Step=28400 Epoch=27.7] | Loss=0.01817 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=4.504 | acc=0.9688 | 4849.3 samples/s | 75.8 steps/s
[Step=28450 Epoch=27.8] | Loss=0.01789 | Reg=0.00183 | L2-Norm=13.541 | L2-Norm(final)=4.507 | acc=0.9844 | 4830.9 samples/s | 75.5 steps/s
[Step=28500 Epoch=27.8] | Loss=0.01756 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=4.509 | acc=1.0000 | 4824.2 samples/s | 75.4 steps/s
[Step=28550 Epoch=27.9] | Loss=0.01737 | Reg=0.00183 | L2-Norm=13.546 | L2-Norm(final)=4.512 | acc=1.0000 | 4853.9 samples/s | 75.8 steps/s
[Step=28600 Epoch=27.9] | Loss=0.01708 | Reg=0.00184 | L2-Norm=13.548 | L2-Norm(final)=4.515 | acc=0.9688 | 4841.0 samples/s | 75.6 steps/s
[Step=28650 Epoch=28.0] | Loss=0.01692 | Reg=0.00184 | L2-Norm=13.551 | L2-Norm(final)=4.518 | acc=1.0000 | 4805.2 samples/s | 75.1 steps/s
[Step=28700 Epoch=28.0] | Loss=0.01684 | Reg=0.00184 | L2-Norm=13.553 | L2-Norm(final)=4.520 | acc=1.0000 | 4815.4 samples/s | 75.2 steps/s
[Step=28750 Epoch=28.1] | Loss=0.01668 | Reg=0.00184 | L2-Norm=13.555 | L2-Norm(final)=4.523 | acc=1.0000 | 4718.8 samples/s | 73.7 steps/s
[Step=28800 Epoch=28.1] | Loss=0.01648 | Reg=0.00184 | L2-Norm=13.558 | L2-Norm(final)=4.525 | acc=1.0000 | 4800.2 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.02841 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=4.485 | acc=0.9531 | 3546.2 samples/s | 55.4 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00291 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=4.492 | acc=1.0000 | 4285.4 samples/s | 67.0 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00202 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=4.495 | acc=1.0000 | 4596.0 samples/s | 71.8 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00152 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=4.496 | acc=1.0000 | 4400.2 samples/s | 68.8 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00121 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=4.497 | acc=1.0000 | 4551.7 samples/s | 71.1 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00099 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=4.499 | acc=1.0000 | 4679.9 samples/s | 73.1 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00084 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=4.500 | acc=1.0000 | 4640.2 samples/s | 72.5 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00073 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=4.501 | acc=1.0000 | 4728.9 samples/s | 73.9 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00064 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=4.502 | acc=1.0000 | 4640.9 samples/s | 72.5 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00062 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=4.504 | acc=1.0000 | 4643.2 samples/s | 72.6 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00056 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=4.505 | acc=1.0000 | 4653.5 samples/s | 72.7 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00051 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=4.506 | acc=1.0000 | 1903.3 samples/s | 29.7 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00047 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=4.507 | acc=1.0000 | 4767.0 samples/s | 74.5 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00044 | Reg=0.00182 | L2-Norm=13.476 | L2-Norm(final)=4.508 | acc=1.0000 | 4614.3 samples/s | 72.1 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00041 | Reg=0.00181 | L2-Norm=13.472 | L2-Norm(final)=4.509 | acc=1.0000 | 4603.5 samples/s | 71.9 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00038 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=4.510 | acc=1.0000 | 4512.2 samples/s | 70.5 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.464 | L2-Norm(final)=4.511 | acc=1.0000 | 4545.2 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30184 | acc=0.7951 | tpr=0.7030 | fpr=0.0050 | 4411.2 samples/s | 17.2 steps/s
Avg test loss: 0.30612, Avg test acc: 0.79401, Avg tpr: 0.70286, Avg fpr: 0.00551, total FA: 43

Testing server on iccad2012
[Step=  50] | Loss=0.30000 | acc=0.8956 | tpr=0.9646 | fpr=0.1056 | 4441.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.30854 | acc=0.8939 | tpr=0.9765 | fpr=0.1076 | 8507.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.31474 | acc=0.8936 | tpr=0.9798 | fpr=0.1080 | 8838.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.31342 | acc=0.8947 | tpr=0.9814 | fpr=0.1069 | 8483.8 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.31114 | acc=0.8953 | tpr=0.9843 | fpr=0.1063 | 8771.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.31506 | acc=0.8946 | tpr=0.9804 | fpr=0.1070 | 9079.3 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.31603 | acc=0.8944 | tpr=0.9806 | fpr=0.1071 | 8198.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.31726 | acc=0.8941 | tpr=0.9803 | fpr=0.1075 | 8554.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.32060 | acc=0.8934 | tpr=0.9810 | fpr=0.1082 | 9027.9 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.32080 | acc=0.8931 | tpr=0.9811 | fpr=0.1085 | 8151.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.31953 | acc=0.8935 | tpr=0.9805 | fpr=0.1081 | 12863.2 samples/s | 50.2 steps/s
Avg test loss: 0.31932, Avg test acc: 0.89344, Avg tpr: 0.98059, Avg fpr: 0.10814, total FA: 15015

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.23380 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=4.545 | acc=0.8438 | 3744.2 samples/s | 58.5 steps/s
[Step=28850 Epoch=28.2] | Loss=0.03592 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=4.541 | acc=1.0000 | 3677.2 samples/s | 57.5 steps/s
[Step=28900 Epoch=28.2] | Loss=0.02538 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=4.545 | acc=1.0000 | 4235.4 samples/s | 66.2 steps/s
[Step=28950 Epoch=28.3] | Loss=0.02281 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=4.549 | acc=0.9688 | 4167.6 samples/s | 65.1 steps/s
[Step=29000 Epoch=28.3] | Loss=0.02137 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=4.552 | acc=1.0000 | 4128.6 samples/s | 64.5 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01988 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=4.555 | acc=1.0000 | 4197.8 samples/s | 65.6 steps/s
[Step=29100 Epoch=28.4] | Loss=0.01937 | Reg=0.00183 | L2-Norm=13.527 | L2-Norm(final)=4.558 | acc=0.9688 | 4222.5 samples/s | 66.0 steps/s
[Step=29150 Epoch=28.5] | Loss=0.01885 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=4.561 | acc=0.9844 | 4838.7 samples/s | 75.6 steps/s
[Step=29200 Epoch=28.5] | Loss=0.01866 | Reg=0.00183 | L2-Norm=13.532 | L2-Norm(final)=4.563 | acc=0.9844 | 4871.8 samples/s | 76.1 steps/s
[Step=29250 Epoch=28.6] | Loss=0.01813 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=4.566 | acc=0.9844 | 4733.7 samples/s | 74.0 steps/s
[Step=29300 Epoch=28.6] | Loss=0.01808 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=4.568 | acc=0.9844 | 4759.3 samples/s | 74.4 steps/s
[Step=29350 Epoch=28.7] | Loss=0.01760 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=4.571 | acc=1.0000 | 4776.8 samples/s | 74.6 steps/s
[Step=29400 Epoch=28.7] | Loss=0.01747 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=4.573 | acc=1.0000 | 4800.6 samples/s | 75.0 steps/s
[Step=29450 Epoch=28.8] | Loss=0.01738 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=4.576 | acc=1.0000 | 4771.8 samples/s | 74.6 steps/s
[Step=29500 Epoch=28.8] | Loss=0.01726 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=4.578 | acc=1.0000 | 4859.2 samples/s | 75.9 steps/s
[Step=29550 Epoch=28.9] | Loss=0.01726 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=4.581 | acc=0.9844 | 4725.0 samples/s | 73.8 steps/s
[Step=29600 Epoch=28.9] | Loss=0.01712 | Reg=0.00184 | L2-Norm=13.551 | L2-Norm(final)=4.583 | acc=1.0000 | 4793.1 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.02445 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=4.545 | acc=0.9688 | 3613.4 samples/s | 56.5 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00170 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=4.552 | acc=1.0000 | 4623.1 samples/s | 72.2 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00092 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=4.555 | acc=1.0000 | 4665.0 samples/s | 72.9 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00066 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=4.558 | acc=1.0000 | 4594.7 samples/s | 71.8 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00051 | Reg=0.00182 | L2-Norm=13.481 | L2-Norm(final)=4.560 | acc=1.0000 | 4549.6 samples/s | 71.1 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00043 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=4.561 | acc=1.0000 | 4672.4 samples/s | 73.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00037 | Reg=0.00182 | L2-Norm=13.474 | L2-Norm(final)=4.563 | acc=1.0000 | 4474.8 samples/s | 69.9 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00033 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=4.564 | acc=1.0000 | 4535.2 samples/s | 70.9 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00029 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=4.566 | acc=1.0000 | 4517.8 samples/s | 70.6 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00026 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=4.567 | acc=1.0000 | 4546.6 samples/s | 71.0 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00024 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=4.568 | acc=1.0000 | 4566.3 samples/s | 71.3 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00022 | Reg=0.00181 | L2-Norm=13.454 | L2-Norm(final)=4.569 | acc=1.0000 | 2001.2 samples/s | 31.3 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00021 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=4.571 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00019 | Reg=0.00181 | L2-Norm=13.445 | L2-Norm(final)=4.572 | acc=1.0000 | 4627.1 samples/s | 72.3 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00018 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=4.573 | acc=1.0000 | 4737.1 samples/s | 74.0 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00017 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=4.574 | acc=1.0000 | 4501.0 samples/s | 70.3 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00016 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=4.575 | acc=1.0000 | 4556.0 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25776 | acc=0.8206 | tpr=0.7400 | fpr=0.0042 | 4376.9 samples/s | 17.1 steps/s
Avg test loss: 0.26368, Avg test acc: 0.81793, Avg tpr: 0.73772, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.32426 | acc=0.8798 | tpr=0.9690 | fpr=0.1218 | 4458.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.33254 | acc=0.8782 | tpr=0.9765 | fpr=0.1237 | 8647.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.33821 | acc=0.8775 | tpr=0.9784 | fpr=0.1244 | 8780.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.33690 | acc=0.8786 | tpr=0.9803 | fpr=0.1233 | 8282.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.33481 | acc=0.8785 | tpr=0.9834 | fpr=0.1234 | 8832.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.33815 | acc=0.8784 | tpr=0.9818 | fpr=0.1234 | 8415.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.33890 | acc=0.8783 | tpr=0.9818 | fpr=0.1235 | 8523.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.34028 | acc=0.8780 | tpr=0.9814 | fpr=0.1239 | 8366.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.34329 | acc=0.8775 | tpr=0.9820 | fpr=0.1244 | 8962.2 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.34353 | acc=0.8773 | tpr=0.9824 | fpr=0.1246 | 8681.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.34233 | acc=0.8774 | tpr=0.9813 | fpr=0.1245 | 14957.0 samples/s | 58.4 steps/s
Avg test loss: 0.34221, Avg test acc: 0.87732, Avg tpr: 0.98138, Avg fpr: 0.12457, total FA: 17296

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.09421 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=4.603 | acc=0.9531 | 4037.1 samples/s | 63.1 steps/s
[Step=29650 Epoch=28.9] | Loss=0.03233 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=4.604 | acc=1.0000 | 4459.9 samples/s | 69.7 steps/s
[Step=29700 Epoch=29.0] | Loss=0.02348 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=4.607 | acc=0.9844 | 4845.1 samples/s | 75.7 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01967 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=4.611 | acc=0.9844 | 4929.1 samples/s | 77.0 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01925 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=4.614 | acc=0.9531 | 4878.8 samples/s | 76.2 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01861 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=4.617 | acc=0.9844 | 4903.9 samples/s | 76.6 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01801 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=4.620 | acc=1.0000 | 4928.4 samples/s | 77.0 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01775 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=4.623 | acc=1.0000 | 4842.2 samples/s | 75.7 steps/s
[Step=30000 Epoch=29.3] | Loss=0.01724 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=4.626 | acc=1.0000 | 4919.1 samples/s | 76.9 steps/s
[Step=30050 Epoch=29.3] | Loss=0.01673 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=4.628 | acc=0.9844 | 4919.3 samples/s | 76.9 steps/s
[Step=30100 Epoch=29.4] | Loss=0.01624 | Reg=0.00182 | L2-Norm=13.509 | L2-Norm(final)=4.631 | acc=1.0000 | 4882.6 samples/s | 76.3 steps/s
[Step=30150 Epoch=29.4] | Loss=0.01591 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=4.634 | acc=1.0000 | 4974.5 samples/s | 77.7 steps/s
[Step=30200 Epoch=29.5] | Loss=0.01615 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=4.637 | acc=0.9688 | 4852.7 samples/s | 75.8 steps/s
[Step=30250 Epoch=29.5] | Loss=0.01589 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=4.640 | acc=1.0000 | 4919.6 samples/s | 76.9 steps/s
[Step=30300 Epoch=29.6] | Loss=0.01587 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=4.643 | acc=0.9688 | 4952.8 samples/s | 77.4 steps/s
[Step=30350 Epoch=29.6] | Loss=0.01599 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=4.645 | acc=1.0000 | 4883.8 samples/s | 76.3 steps/s
[Step=30400 Epoch=29.7] | Loss=0.01602 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=4.648 | acc=0.9844 | 4923.6 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.01654 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=4.603 | acc=1.0000 | 3482.4 samples/s | 54.4 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00243 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=4.606 | acc=1.0000 | 4666.6 samples/s | 72.9 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00126 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=4.609 | acc=1.0000 | 4669.7 samples/s | 73.0 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00089 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=4.611 | acc=1.0000 | 4654.6 samples/s | 72.7 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00068 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=4.613 | acc=1.0000 | 4618.6 samples/s | 72.2 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00055 | Reg=0.00181 | L2-Norm=13.454 | L2-Norm(final)=4.615 | acc=1.0000 | 4755.3 samples/s | 74.3 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00047 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=4.616 | acc=1.0000 | 4605.9 samples/s | 72.0 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00040 | Reg=0.00181 | L2-Norm=13.445 | L2-Norm(final)=4.617 | acc=1.0000 | 4662.4 samples/s | 72.9 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=4.618 | acc=1.0000 | 4619.3 samples/s | 72.2 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00032 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=4.620 | acc=1.0000 | 4459.8 samples/s | 69.7 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00029 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=4.621 | acc=1.0000 | 4611.0 samples/s | 72.0 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00027 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=4.622 | acc=1.0000 | 1943.0 samples/s | 30.4 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00025 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=4.623 | acc=1.0000 | 4710.1 samples/s | 73.6 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00023 | Reg=0.00180 | L2-Norm=13.416 | L2-Norm(final)=4.624 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00021 | Reg=0.00180 | L2-Norm=13.411 | L2-Norm(final)=4.625 | acc=1.0000 | 4479.5 samples/s | 70.0 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00020 | Reg=0.00180 | L2-Norm=13.405 | L2-Norm(final)=4.626 | acc=1.0000 | 4589.6 samples/s | 71.7 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00019 | Reg=0.00180 | L2-Norm=13.400 | L2-Norm(final)=4.626 | acc=1.0000 | 4529.7 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24414 | acc=0.8290 | tpr=0.7529 | fpr=0.0057 | 4487.5 samples/s | 17.5 steps/s
Avg test loss: 0.24968, Avg test acc: 0.82551, Avg tpr: 0.74908, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.33378 | acc=0.8784 | tpr=0.9690 | fpr=0.1232 | 4367.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.34362 | acc=0.8777 | tpr=0.9808 | fpr=0.1242 | 8590.7 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.34894 | acc=0.8773 | tpr=0.9827 | fpr=0.1246 | 8993.1 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.34758 | acc=0.8777 | tpr=0.9836 | fpr=0.1242 | 8460.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.34508 | acc=0.8780 | tpr=0.9860 | fpr=0.1239 | 8770.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.34880 | acc=0.8774 | tpr=0.9825 | fpr=0.1245 | 8578.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.34930 | acc=0.8774 | tpr=0.9831 | fpr=0.1245 | 8609.4 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.35024 | acc=0.8771 | tpr=0.9830 | fpr=0.1249 | 8355.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.35360 | acc=0.8768 | tpr=0.9834 | fpr=0.1251 | 8487.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.35389 | acc=0.8766 | tpr=0.9837 | fpr=0.1254 | 8872.0 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.35269 | acc=0.8767 | tpr=0.9825 | fpr=0.1252 | 15093.0 samples/s | 59.0 steps/s
Avg test loss: 0.35249, Avg test acc: 0.87668, Avg tpr: 0.98257, Avg fpr: 0.12524, total FA: 17390

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.10478 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=4.663 | acc=0.8750 | 3880.5 samples/s | 60.6 steps/s
[Step=30450 Epoch=29.7] | Loss=0.02738 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=4.664 | acc=0.9844 | 4563.6 samples/s | 71.3 steps/s
[Step=30500 Epoch=29.8] | Loss=0.02176 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=4.668 | acc=1.0000 | 4834.4 samples/s | 75.5 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01975 | Reg=0.00181 | L2-Norm=13.455 | L2-Norm(final)=4.673 | acc=1.0000 | 4902.9 samples/s | 76.6 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01881 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=4.678 | acc=0.9844 | 4868.8 samples/s | 76.1 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01788 | Reg=0.00181 | L2-Norm=13.464 | L2-Norm(final)=4.682 | acc=1.0000 | 4857.6 samples/s | 75.9 steps/s
[Step=30700 Epoch=30.0] | Loss=0.01777 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=4.685 | acc=0.9688 | 4723.8 samples/s | 73.8 steps/s
[Step=30750 Epoch=30.0] | Loss=0.01765 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=4.688 | acc=0.9844 | 4746.8 samples/s | 74.2 steps/s
[Step=30800 Epoch=30.1] | Loss=0.01771 | Reg=0.00182 | L2-Norm=13.474 | L2-Norm(final)=4.691 | acc=0.9844 | 4779.3 samples/s | 74.7 steps/s
[Step=30850 Epoch=30.1] | Loss=0.01729 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=4.694 | acc=1.0000 | 4773.2 samples/s | 74.6 steps/s
[Step=30900 Epoch=30.2] | Loss=0.01671 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=4.697 | acc=0.9844 | 4844.0 samples/s | 75.7 steps/s
[Step=30950 Epoch=30.2] | Loss=0.01646 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=4.700 | acc=0.9688 | 4825.8 samples/s | 75.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.01636 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=4.703 | acc=1.0000 | 4792.5 samples/s | 74.9 steps/s
[Step=31050 Epoch=30.3] | Loss=0.01624 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=4.706 | acc=0.9844 | 4818.0 samples/s | 75.3 steps/s
[Step=31100 Epoch=30.4] | Loss=0.01622 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=4.709 | acc=1.0000 | 4752.8 samples/s | 74.3 steps/s
[Step=31150 Epoch=30.4] | Loss=0.01607 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=4.711 | acc=1.0000 | 4792.5 samples/s | 74.9 steps/s
[Step=31200 Epoch=30.5] | Loss=0.01624 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=4.714 | acc=1.0000 | 4864.4 samples/s | 76.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.05444 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=4.663 | acc=0.9531 | 3864.9 samples/s | 60.4 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00237 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=4.670 | acc=1.0000 | 4127.3 samples/s | 64.5 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00158 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=4.673 | acc=1.0000 | 4512.4 samples/s | 70.5 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00113 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=4.675 | acc=1.0000 | 4508.3 samples/s | 70.4 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00086 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=4.676 | acc=1.0000 | 4584.6 samples/s | 71.6 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00070 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=4.678 | acc=1.0000 | 4464.4 samples/s | 69.8 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00062 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=4.679 | acc=1.0000 | 4547.7 samples/s | 71.1 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00055 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=4.680 | acc=1.0000 | 4550.5 samples/s | 71.1 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00048 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=4.682 | acc=1.0000 | 4572.1 samples/s | 71.4 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00043 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=4.683 | acc=1.0000 | 4573.1 samples/s | 71.5 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00040 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=4.684 | acc=1.0000 | 4574.2 samples/s | 71.5 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00037 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=4.685 | acc=1.0000 | 1924.8 samples/s | 30.1 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00034 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=4.686 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00031 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=4.687 | acc=1.0000 | 4626.0 samples/s | 72.3 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00029 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=4.688 | acc=1.0000 | 4632.3 samples/s | 72.4 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00027 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=4.689 | acc=1.0000 | 4661.6 samples/s | 72.8 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00026 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=4.690 | acc=1.0000 | 4690.5 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29937 | acc=0.7950 | tpr=0.7023 | fpr=0.0037 | 4384.0 samples/s | 17.1 steps/s
Avg test loss: 0.30372, Avg test acc: 0.79309, Avg tpr: 0.70129, Avg fpr: 0.00500, total FA: 39

Testing server on iccad2012
[Step=  50] | Loss=0.28795 | acc=0.9009 | tpr=0.9690 | fpr=0.1004 | 4363.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.29795 | acc=0.8993 | tpr=0.9787 | fpr=0.1022 | 8756.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.30436 | acc=0.8991 | tpr=0.9798 | fpr=0.1024 | 8607.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.30194 | acc=0.9003 | tpr=0.9814 | fpr=0.1011 | 8703.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.29921 | acc=0.9008 | tpr=0.9843 | fpr=0.1007 | 8529.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.30249 | acc=0.9003 | tpr=0.9811 | fpr=0.1011 | 8835.0 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.30313 | acc=0.9003 | tpr=0.9812 | fpr=0.1011 | 8296.4 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.30371 | acc=0.9001 | tpr=0.9803 | fpr=0.1013 | 8875.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.30621 | acc=0.8998 | tpr=0.9810 | fpr=0.1017 | 8630.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.30626 | acc=0.8995 | tpr=0.9815 | fpr=0.1019 | 8667.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.30519 | acc=0.8996 | tpr=0.9805 | fpr=0.1018 | 15265.8 samples/s | 59.6 steps/s
Avg test loss: 0.30507, Avg test acc: 0.89961, Avg tpr: 0.98059, Avg fpr: 0.10187, total FA: 14144

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.13769 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=4.727 | acc=0.9062 | 3838.7 samples/s | 60.0 steps/s
[Step=31250 Epoch=30.5] | Loss=0.03104 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=4.725 | acc=1.0000 | 4450.6 samples/s | 69.5 steps/s
[Step=31300 Epoch=30.6] | Loss=0.02466 | Reg=0.00180 | L2-Norm=13.434 | L2-Norm(final)=4.729 | acc=0.9844 | 4928.9 samples/s | 77.0 steps/s
[Step=31350 Epoch=30.6] | Loss=0.02093 | Reg=0.00181 | L2-Norm=13.439 | L2-Norm(final)=4.733 | acc=0.9844 | 4804.4 samples/s | 75.1 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01976 | Reg=0.00181 | L2-Norm=13.443 | L2-Norm(final)=4.737 | acc=0.9688 | 4896.5 samples/s | 76.5 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01841 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=4.742 | acc=1.0000 | 4984.7 samples/s | 77.9 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01825 | Reg=0.00181 | L2-Norm=13.452 | L2-Norm(final)=4.747 | acc=1.0000 | 4811.6 samples/s | 75.2 steps/s
[Step=31550 Epoch=30.8] | Loss=0.01779 | Reg=0.00181 | L2-Norm=13.455 | L2-Norm(final)=4.751 | acc=0.9844 | 4836.6 samples/s | 75.6 steps/s
[Step=31600 Epoch=30.9] | Loss=0.01752 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=4.754 | acc=1.0000 | 4789.8 samples/s | 74.8 steps/s
[Step=31650 Epoch=30.9] | Loss=0.01729 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=4.758 | acc=1.0000 | 4813.9 samples/s | 75.2 steps/s
[Step=31700 Epoch=30.9] | Loss=0.01704 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=4.761 | acc=1.0000 | 4844.2 samples/s | 75.7 steps/s
[Step=31750 Epoch=31.0] | Loss=0.01682 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=4.764 | acc=1.0000 | 4735.8 samples/s | 74.0 steps/s
[Step=31800 Epoch=31.0] | Loss=0.01682 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=4.766 | acc=0.9844 | 4771.5 samples/s | 74.6 steps/s
[Step=31850 Epoch=31.1] | Loss=0.01701 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=4.769 | acc=0.9688 | 4753.8 samples/s | 74.3 steps/s
[Step=31900 Epoch=31.1] | Loss=0.01690 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=4.771 | acc=0.9844 | 4864.5 samples/s | 76.0 steps/s
[Step=31950 Epoch=31.2] | Loss=0.01689 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=4.774 | acc=0.9844 | 4757.6 samples/s | 74.3 steps/s
[Step=32000 Epoch=31.2] | Loss=0.01678 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=4.776 | acc=1.0000 | 4859.8 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.01723 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=4.727 | acc=0.9844 | 3613.9 samples/s | 56.5 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00184 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=4.735 | acc=1.0000 | 4527.9 samples/s | 70.7 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00110 | Reg=0.00180 | L2-Norm=13.411 | L2-Norm(final)=4.738 | acc=1.0000 | 4649.0 samples/s | 72.6 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00086 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=4.741 | acc=1.0000 | 4733.2 samples/s | 74.0 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00074 | Reg=0.00180 | L2-Norm=13.408 | L2-Norm(final)=4.743 | acc=1.0000 | 4597.9 samples/s | 71.8 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00061 | Reg=0.00180 | L2-Norm=13.405 | L2-Norm(final)=4.745 | acc=1.0000 | 4676.5 samples/s | 73.1 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00052 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=4.747 | acc=1.0000 | 4628.6 samples/s | 72.3 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00045 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=4.748 | acc=1.0000 | 4558.5 samples/s | 71.2 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00040 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=4.750 | acc=1.0000 | 4535.1 samples/s | 70.9 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00036 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=4.751 | acc=1.0000 | 4470.8 samples/s | 69.9 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00032 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=4.752 | acc=1.0000 | 4639.2 samples/s | 72.5 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00030 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=4.753 | acc=1.0000 | 1978.5 samples/s | 30.9 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00027 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=4.755 | acc=1.0000 | 4602.1 samples/s | 71.9 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00025 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=4.756 | acc=1.0000 | 4607.3 samples/s | 72.0 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00024 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=4.757 | acc=1.0000 | 4558.0 samples/s | 71.2 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00022 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=4.757 | acc=1.0000 | 4454.3 samples/s | 69.6 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00021 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=4.758 | acc=1.0000 | 4553.2 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28978 | acc=0.7935 | tpr=0.7005 | fpr=0.0045 | 4461.8 samples/s | 17.4 steps/s
Avg test loss: 0.29283, Avg test acc: 0.79461, Avg tpr: 0.70379, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.27830 | acc=0.9005 | tpr=0.9735 | fpr=0.1008 | 4391.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.28724 | acc=0.8987 | tpr=0.9829 | fpr=0.1029 | 8705.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.29325 | acc=0.8982 | tpr=0.9841 | fpr=0.1034 | 8661.8 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.29170 | acc=0.8992 | tpr=0.9847 | fpr=0.1023 | 8965.4 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.28897 | acc=0.8998 | tpr=0.9869 | fpr=0.1018 | 8424.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.29256 | acc=0.8993 | tpr=0.9847 | fpr=0.1022 | 8909.7 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.29352 | acc=0.8992 | tpr=0.9843 | fpr=0.1023 | 8558.3 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.29411 | acc=0.8990 | tpr=0.9830 | fpr=0.1026 | 8468.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.29672 | acc=0.8984 | tpr=0.9834 | fpr=0.1032 | 8782.4 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.29708 | acc=0.8981 | tpr=0.9833 | fpr=0.1035 | 8564.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.29603 | acc=0.8982 | tpr=0.9821 | fpr=0.1033 | 15978.1 samples/s | 62.4 steps/s
Avg test loss: 0.29590, Avg test acc: 0.89818, Avg tpr: 0.98217, Avg fpr: 0.10335, total FA: 14350

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.24434 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=4.795 | acc=0.8281 | 3706.0 samples/s | 57.9 steps/s
[Step=32050 Epoch=31.3] | Loss=0.03935 | Reg=0.00179 | L2-Norm=13.394 | L2-Norm(final)=4.794 | acc=1.0000 | 4611.2 samples/s | 72.1 steps/s
[Step=32100 Epoch=31.3] | Loss=0.02681 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=4.796 | acc=0.9844 | 4839.4 samples/s | 75.6 steps/s
[Step=32150 Epoch=31.4] | Loss=0.02382 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=4.798 | acc=1.0000 | 4936.0 samples/s | 77.1 steps/s
[Step=32200 Epoch=31.4] | Loss=0.02101 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=4.801 | acc=0.9844 | 4871.1 samples/s | 76.1 steps/s
[Step=32250 Epoch=31.5] | Loss=0.01985 | Reg=0.00180 | L2-Norm=13.408 | L2-Norm(final)=4.803 | acc=0.9844 | 4898.5 samples/s | 76.5 steps/s
[Step=32300 Epoch=31.5] | Loss=0.01863 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=4.805 | acc=0.9844 | 4933.4 samples/s | 77.1 steps/s
[Step=32350 Epoch=31.6] | Loss=0.01781 | Reg=0.00180 | L2-Norm=13.412 | L2-Norm(final)=4.808 | acc=1.0000 | 4922.7 samples/s | 76.9 steps/s
[Step=32400 Epoch=31.6] | Loss=0.01700 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=4.810 | acc=0.9844 | 4935.5 samples/s | 77.1 steps/s
[Step=32450 Epoch=31.7] | Loss=0.01631 | Reg=0.00180 | L2-Norm=13.416 | L2-Norm(final)=4.812 | acc=1.0000 | 4778.1 samples/s | 74.7 steps/s
[Step=32500 Epoch=31.7] | Loss=0.01586 | Reg=0.00180 | L2-Norm=13.418 | L2-Norm(final)=4.815 | acc=1.0000 | 4774.2 samples/s | 74.6 steps/s
[Step=32550 Epoch=31.8] | Loss=0.01547 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=4.817 | acc=0.9844 | 4761.3 samples/s | 74.4 steps/s
[Step=32600 Epoch=31.8] | Loss=0.01539 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=4.819 | acc=1.0000 | 4834.8 samples/s | 75.5 steps/s
[Step=32650 Epoch=31.9] | Loss=0.01507 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=4.822 | acc=1.0000 | 4813.0 samples/s | 75.2 steps/s
[Step=32700 Epoch=31.9] | Loss=0.01481 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=4.824 | acc=1.0000 | 4830.3 samples/s | 75.5 steps/s
[Step=32750 Epoch=32.0] | Loss=0.01478 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=4.826 | acc=1.0000 | 4854.4 samples/s | 75.8 steps/s
[Step=32800 Epoch=32.0] | Loss=0.01457 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=4.828 | acc=1.0000 | 4867.4 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.00581 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=4.795 | acc=1.0000 | 3712.9 samples/s | 58.0 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00291 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=4.799 | acc=1.0000 | 4541.5 samples/s | 71.0 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00148 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=4.801 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00101 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=4.802 | acc=1.0000 | 4639.6 samples/s | 72.5 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00078 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=4.803 | acc=1.0000 | 4625.1 samples/s | 72.3 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00063 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=4.804 | acc=1.0000 | 4742.2 samples/s | 74.1 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00053 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=4.804 | acc=1.0000 | 4599.5 samples/s | 71.9 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00046 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=4.805 | acc=1.0000 | 4647.1 samples/s | 72.6 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00042 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=4.806 | acc=1.0000 | 4722.4 samples/s | 73.8 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00038 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=4.807 | acc=1.0000 | 4659.5 samples/s | 72.8 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00034 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=4.807 | acc=1.0000 | 4710.5 samples/s | 73.6 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00031 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=4.808 | acc=1.0000 | 1917.9 samples/s | 30.0 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00029 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=4.809 | acc=1.0000 | 4560.7 samples/s | 71.3 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=4.809 | acc=1.0000 | 4537.9 samples/s | 70.9 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00025 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=4.810 | acc=1.0000 | 4516.3 samples/s | 70.6 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00024 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=4.810 | acc=1.0000 | 4504.7 samples/s | 70.4 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00022 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=4.811 | acc=1.0000 | 4576.3 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27735 | acc=0.8062 | tpr=0.7190 | fpr=0.0045 | 4406.7 samples/s | 17.2 steps/s
Avg test loss: 0.28141, Avg test acc: 0.80551, Avg tpr: 0.71947, Avg fpr: 0.00526, total FA: 41

Testing server on iccad2012
[Step=  50] | Loss=0.29455 | acc=0.8953 | tpr=0.9735 | fpr=0.1061 | 4470.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.30446 | acc=0.8926 | tpr=0.9765 | fpr=0.1089 | 8465.8 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.30984 | acc=0.8923 | tpr=0.9784 | fpr=0.1093 | 8678.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.30812 | acc=0.8929 | tpr=0.9803 | fpr=0.1087 | 9266.9 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.30581 | acc=0.8935 | tpr=0.9834 | fpr=0.1081 | 8345.5 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.30954 | acc=0.8928 | tpr=0.9811 | fpr=0.1088 | 8427.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.31033 | acc=0.8929 | tpr=0.9812 | fpr=0.1087 | 9059.4 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.31104 | acc=0.8925 | tpr=0.9798 | fpr=0.1091 | 8947.3 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.31368 | acc=0.8919 | tpr=0.9805 | fpr=0.1097 | 8339.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.31411 | acc=0.8915 | tpr=0.9806 | fpr=0.1101 | 8201.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.31289 | acc=0.8917 | tpr=0.9797 | fpr=0.1099 | 15530.3 samples/s | 60.7 steps/s
Avg test loss: 0.31272, Avg test acc: 0.89165, Avg tpr: 0.97979, Avg fpr: 0.10995, total FA: 15266

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.18053 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=4.840 | acc=0.8281 | 3858.3 samples/s | 60.3 steps/s
[Step=32850 Epoch=32.1] | Loss=0.03592 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=4.840 | acc=1.0000 | 4706.6 samples/s | 73.5 steps/s
[Step=32900 Epoch=32.1] | Loss=0.02414 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=4.842 | acc=0.9688 | 4933.7 samples/s | 77.1 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01987 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=4.844 | acc=0.9844 | 4870.9 samples/s | 76.1 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01830 | Reg=0.00180 | L2-Norm=13.400 | L2-Norm(final)=4.847 | acc=0.9844 | 4864.4 samples/s | 76.0 steps/s
[Step=33050 Epoch=32.3] | Loss=0.01734 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=4.850 | acc=1.0000 | 4831.7 samples/s | 75.5 steps/s
[Step=33100 Epoch=32.3] | Loss=0.01656 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=4.852 | acc=0.9844 | 4744.2 samples/s | 74.1 steps/s
[Step=33150 Epoch=32.4] | Loss=0.01594 | Reg=0.00180 | L2-Norm=13.407 | L2-Norm(final)=4.854 | acc=1.0000 | 4802.6 samples/s | 75.0 steps/s
[Step=33200 Epoch=32.4] | Loss=0.01558 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=4.856 | acc=1.0000 | 4820.0 samples/s | 75.3 steps/s
[Step=33250 Epoch=32.5] | Loss=0.01529 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=4.858 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=33300 Epoch=32.5] | Loss=0.01510 | Reg=0.00180 | L2-Norm=13.412 | L2-Norm(final)=4.860 | acc=1.0000 | 4793.5 samples/s | 74.9 steps/s
[Step=33350 Epoch=32.6] | Loss=0.01495 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=4.862 | acc=0.9844 | 4754.7 samples/s | 74.3 steps/s
[Step=33400 Epoch=32.6] | Loss=0.01462 | Reg=0.00180 | L2-Norm=13.415 | L2-Norm(final)=4.864 | acc=1.0000 | 4820.8 samples/s | 75.3 steps/s
[Step=33450 Epoch=32.7] | Loss=0.01447 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=4.866 | acc=0.9844 | 4812.6 samples/s | 75.2 steps/s
[Step=33500 Epoch=32.7] | Loss=0.01452 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=4.868 | acc=0.9531 | 4839.3 samples/s | 75.6 steps/s
[Step=33550 Epoch=32.8] | Loss=0.01433 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=4.870 | acc=1.0000 | 4798.9 samples/s | 75.0 steps/s
[Step=33600 Epoch=32.8] | Loss=0.01410 | Reg=0.00180 | L2-Norm=13.422 | L2-Norm(final)=4.871 | acc=1.0000 | 4763.9 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.03480 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=4.840 | acc=0.9844 | 3648.6 samples/s | 57.0 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00221 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=4.845 | acc=1.0000 | 4483.7 samples/s | 70.1 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00114 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=4.848 | acc=1.0000 | 4633.4 samples/s | 72.4 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00078 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=4.849 | acc=1.0000 | 4688.1 samples/s | 73.3 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00060 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=4.850 | acc=1.0000 | 4636.6 samples/s | 72.4 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00049 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=4.851 | acc=1.0000 | 4726.8 samples/s | 73.9 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00042 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=4.852 | acc=1.0000 | 4478.5 samples/s | 70.0 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00036 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=4.853 | acc=1.0000 | 4526.8 samples/s | 70.7 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00032 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=4.853 | acc=1.0000 | 4585.5 samples/s | 71.6 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=4.854 | acc=1.0000 | 4566.7 samples/s | 71.4 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00026 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=4.855 | acc=1.0000 | 4628.5 samples/s | 72.3 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00024 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=4.856 | acc=1.0000 | 1939.7 samples/s | 30.3 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00022 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=4.856 | acc=1.0000 | 4722.4 samples/s | 73.8 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00021 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=4.857 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00020 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=4.857 | acc=1.0000 | 4604.1 samples/s | 71.9 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00018 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=4.858 | acc=1.0000 | 4611.3 samples/s | 72.1 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00017 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=4.859 | acc=1.0000 | 4585.5 samples/s | 71.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23270 | acc=0.8346 | tpr=0.7605 | fpr=0.0045 | 4373.1 samples/s | 17.1 steps/s
Avg test loss: 0.23671, Avg test acc: 0.83384, Avg tpr: 0.76068, Avg fpr: 0.00526, total FA: 41

Testing server on iccad2012
[Step=  50] | Loss=0.32886 | acc=0.8794 | tpr=0.9735 | fpr=0.1223 | 4432.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.33907 | acc=0.8775 | tpr=0.9808 | fpr=0.1244 | 8630.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.34430 | acc=0.8769 | tpr=0.9813 | fpr=0.1250 | 8446.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.34249 | acc=0.8778 | tpr=0.9825 | fpr=0.1241 | 8913.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.33988 | acc=0.8782 | tpr=0.9852 | fpr=0.1237 | 8393.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.34311 | acc=0.8777 | tpr=0.9825 | fpr=0.1242 | 8570.6 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.34386 | acc=0.8775 | tpr=0.9831 | fpr=0.1244 | 9257.3 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.34467 | acc=0.8772 | tpr=0.9814 | fpr=0.1246 | 8118.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.34723 | acc=0.8767 | tpr=0.9820 | fpr=0.1252 | 9069.5 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.34768 | acc=0.8766 | tpr=0.9819 | fpr=0.1253 | 8311.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.34636 | acc=0.8768 | tpr=0.9809 | fpr=0.1251 | 15924.9 samples/s | 62.2 steps/s
Avg test loss: 0.34623, Avg test acc: 0.87679, Avg tpr: 0.98098, Avg fpr: 0.12511, total FA: 17371

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.18595 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=4.884 | acc=0.8750 | 3739.1 samples/s | 58.4 steps/s
[Step=33650 Epoch=32.9] | Loss=0.03151 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=4.884 | acc=1.0000 | 4693.8 samples/s | 73.3 steps/s
[Step=33700 Epoch=32.9] | Loss=0.02187 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=4.886 | acc=1.0000 | 4890.0 samples/s | 76.4 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01900 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=4.888 | acc=1.0000 | 4897.0 samples/s | 76.5 steps/s
[Step=33800 Epoch=33.0] | Loss=0.01733 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=4.890 | acc=1.0000 | 4795.5 samples/s | 74.9 steps/s
[Step=33850 Epoch=33.0] | Loss=0.01668 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=4.893 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
[Step=33900 Epoch=33.1] | Loss=0.01607 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=4.895 | acc=0.9844 | 4788.7 samples/s | 74.8 steps/s
[Step=33950 Epoch=33.1] | Loss=0.01599 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=4.897 | acc=0.9844 | 4758.0 samples/s | 74.3 steps/s
[Step=34000 Epoch=33.2] | Loss=0.01548 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=4.899 | acc=0.9844 | 4766.1 samples/s | 74.5 steps/s
[Step=34050 Epoch=33.2] | Loss=0.01536 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=4.901 | acc=1.0000 | 4819.8 samples/s | 75.3 steps/s
[Step=34100 Epoch=33.3] | Loss=0.01501 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=4.903 | acc=1.0000 | 4797.8 samples/s | 75.0 steps/s
[Step=34150 Epoch=33.3] | Loss=0.01471 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=4.905 | acc=0.9688 | 4750.5 samples/s | 74.2 steps/s
[Step=34200 Epoch=33.4] | Loss=0.01442 | Reg=0.00180 | L2-Norm=13.398 | L2-Norm(final)=4.907 | acc=1.0000 | 4795.1 samples/s | 74.9 steps/s
[Step=34250 Epoch=33.4] | Loss=0.01440 | Reg=0.00180 | L2-Norm=13.400 | L2-Norm(final)=4.909 | acc=0.9844 | 4806.8 samples/s | 75.1 steps/s
[Step=34300 Epoch=33.5] | Loss=0.01422 | Reg=0.00180 | L2-Norm=13.401 | L2-Norm(final)=4.911 | acc=0.9688 | 4777.6 samples/s | 74.7 steps/s
[Step=34350 Epoch=33.5] | Loss=0.01420 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=4.913 | acc=0.9844 | 4794.3 samples/s | 74.9 steps/s
[Step=34400 Epoch=33.6] | Loss=0.01402 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=4.915 | acc=1.0000 | 4814.9 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.03210 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=4.884 | acc=0.9688 | 3640.1 samples/s | 56.9 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00228 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=4.889 | acc=1.0000 | 4323.3 samples/s | 67.6 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00120 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=4.891 | acc=1.0000 | 4470.3 samples/s | 69.8 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00081 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=4.893 | acc=1.0000 | 4532.8 samples/s | 70.8 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00062 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=4.894 | acc=1.0000 | 4583.0 samples/s | 71.6 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00051 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=4.895 | acc=1.0000 | 4481.7 samples/s | 70.0 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00043 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=4.896 | acc=1.0000 | 4572.3 samples/s | 71.4 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=4.896 | acc=1.0000 | 4514.8 samples/s | 70.5 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00033 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=4.897 | acc=1.0000 | 4618.1 samples/s | 72.2 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00030 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=4.898 | acc=1.0000 | 4526.8 samples/s | 70.7 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=4.899 | acc=1.0000 | 4585.0 samples/s | 71.6 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00025 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=4.899 | acc=1.0000 | 1964.5 samples/s | 30.7 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00023 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=4.900 | acc=1.0000 | 4792.1 samples/s | 74.9 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00022 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=4.901 | acc=1.0000 | 4517.4 samples/s | 70.6 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00020 | Reg=0.00178 | L2-Norm=13.331 | L2-Norm(final)=4.901 | acc=1.0000 | 4617.1 samples/s | 72.1 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00019 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=4.902 | acc=1.0000 | 4399.6 samples/s | 68.7 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00018 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=4.902 | acc=1.0000 | 4599.8 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25786 | acc=0.8225 | tpr=0.7421 | fpr=0.0030 | 4419.5 samples/s | 17.3 steps/s
Avg test loss: 0.26245, Avg test acc: 0.82082, Avg tpr: 0.74127, Avg fpr: 0.00423, total FA: 33

Testing server on iccad2012
[Step=  50] | Loss=0.30600 | acc=0.8895 | tpr=0.9690 | fpr=0.1120 | 4484.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.31552 | acc=0.8872 | tpr=0.9765 | fpr=0.1144 | 8395.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.32033 | acc=0.8870 | tpr=0.9784 | fpr=0.1147 | 8598.2 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.31915 | acc=0.8878 | tpr=0.9814 | fpr=0.1140 | 8769.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.31693 | acc=0.8885 | tpr=0.9834 | fpr=0.1133 | 8572.5 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.32010 | acc=0.8881 | tpr=0.9811 | fpr=0.1136 | 8836.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.32096 | acc=0.8883 | tpr=0.9818 | fpr=0.1134 | 8230.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.32179 | acc=0.8882 | tpr=0.9803 | fpr=0.1134 | 8637.2 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.32438 | acc=0.8877 | tpr=0.9805 | fpr=0.1140 | 9176.4 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.32497 | acc=0.8873 | tpr=0.9802 | fpr=0.1144 | 8435.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.32381 | acc=0.8874 | tpr=0.9793 | fpr=0.1142 | 14507.2 samples/s | 56.7 steps/s
Avg test loss: 0.32368, Avg test acc: 0.88740, Avg tpr: 0.97900, Avg fpr: 0.11427, total FA: 15866

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.18959 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=4.928 | acc=0.8594 | 3801.9 samples/s | 59.4 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02945 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=4.929 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=34500 Epoch=33.7] | Loss=0.02072 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=4.931 | acc=0.9844 | 4908.7 samples/s | 76.7 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01780 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=4.933 | acc=1.0000 | 4887.0 samples/s | 76.4 steps/s
[Step=34600 Epoch=33.8] | Loss=0.01666 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=4.935 | acc=1.0000 | 4887.7 samples/s | 76.4 steps/s
[Step=34650 Epoch=33.8] | Loss=0.01579 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=4.938 | acc=0.9844 | 4936.7 samples/s | 77.1 steps/s
[Step=34700 Epoch=33.9] | Loss=0.01483 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=4.940 | acc=0.9844 | 4942.2 samples/s | 77.2 steps/s
[Step=34750 Epoch=33.9] | Loss=0.01428 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=4.942 | acc=1.0000 | 4906.2 samples/s | 76.7 steps/s
[Step=34800 Epoch=34.0] | Loss=0.01394 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=4.945 | acc=1.0000 | 4894.4 samples/s | 76.5 steps/s
[Step=34850 Epoch=34.0] | Loss=0.01399 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=4.947 | acc=1.0000 | 4940.4 samples/s | 77.2 steps/s
[Step=34900 Epoch=34.1] | Loss=0.01420 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=4.949 | acc=1.0000 | 4900.7 samples/s | 76.6 steps/s
[Step=34950 Epoch=34.1] | Loss=0.01422 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=4.951 | acc=1.0000 | 4917.3 samples/s | 76.8 steps/s
[Step=35000 Epoch=34.2] | Loss=0.01402 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=4.953 | acc=1.0000 | 4841.9 samples/s | 75.7 steps/s
[Step=35050 Epoch=34.2] | Loss=0.01393 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=4.954 | acc=0.9844 | 4856.4 samples/s | 75.9 steps/s
[Step=35100 Epoch=34.3] | Loss=0.01365 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=4.956 | acc=0.9844 | 4911.9 samples/s | 76.7 steps/s
[Step=35150 Epoch=34.3] | Loss=0.01372 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=4.958 | acc=0.9844 | 4943.9 samples/s | 77.2 steps/s
[Step=35200 Epoch=34.4] | Loss=0.01350 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=4.960 | acc=1.0000 | 4894.9 samples/s | 76.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.02663 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=4.928 | acc=0.9844 | 3657.8 samples/s | 57.2 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00287 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=4.930 | acc=1.0000 | 4379.0 samples/s | 68.4 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00148 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=4.931 | acc=1.0000 | 4593.7 samples/s | 71.8 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00102 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=4.932 | acc=1.0000 | 4570.8 samples/s | 71.4 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00078 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=4.933 | acc=1.0000 | 4641.1 samples/s | 72.5 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00064 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=4.934 | acc=1.0000 | 4666.3 samples/s | 72.9 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00054 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=4.935 | acc=1.0000 | 4652.7 samples/s | 72.7 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00047 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=4.936 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00042 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=4.937 | acc=1.0000 | 4693.0 samples/s | 73.3 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=4.938 | acc=1.0000 | 4460.1 samples/s | 69.7 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=4.938 | acc=1.0000 | 4559.4 samples/s | 71.2 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00031 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=4.939 | acc=1.0000 | 1988.3 samples/s | 31.1 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=4.940 | acc=1.0000 | 4532.3 samples/s | 70.8 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=4.940 | acc=1.0000 | 4570.2 samples/s | 71.4 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00025 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=4.941 | acc=1.0000 | 4365.0 samples/s | 68.2 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=4.942 | acc=1.0000 | 4539.2 samples/s | 70.9 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=4.942 | acc=1.0000 | 4566.0 samples/s | 71.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29934 | acc=0.7985 | tpr=0.7073 | fpr=0.0035 | 4415.2 samples/s | 17.2 steps/s
Avg test loss: 0.30426, Avg test acc: 0.79806, Avg tpr: 0.70776, Avg fpr: 0.00333, total FA: 26

Testing server on iccad2012
[Step=  50] | Loss=0.28626 | acc=0.8978 | tpr=0.9735 | fpr=0.1035 | 4327.5 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.29601 | acc=0.8956 | tpr=0.9787 | fpr=0.1059 | 8847.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.30055 | acc=0.8953 | tpr=0.9798 | fpr=0.1063 | 8313.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.29932 | acc=0.8959 | tpr=0.9814 | fpr=0.1057 | 8767.0 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.29696 | acc=0.8965 | tpr=0.9834 | fpr=0.1051 | 8625.9 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.29992 | acc=0.8961 | tpr=0.9811 | fpr=0.1054 | 8454.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.30076 | acc=0.8959 | tpr=0.9806 | fpr=0.1056 | 9069.9 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.30183 | acc=0.8959 | tpr=0.9787 | fpr=0.1056 | 8393.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.30456 | acc=0.8953 | tpr=0.9786 | fpr=0.1062 | 8970.8 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.30491 | acc=0.8953 | tpr=0.9789 | fpr=0.1063 | 8156.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.30356 | acc=0.8954 | tpr=0.9781 | fpr=0.1061 | 16129.1 samples/s | 63.0 steps/s
Avg test loss: 0.30344, Avg test acc: 0.89540, Avg tpr: 0.97821, Avg fpr: 0.10610, total FA: 14732

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.26871 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=4.970 | acc=0.7969 | 3771.2 samples/s | 58.9 steps/s
[Step=35250 Epoch=34.4] | Loss=0.03188 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=4.971 | acc=1.0000 | 4524.1 samples/s | 70.7 steps/s
[Step=35300 Epoch=34.5] | Loss=0.02146 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=4.973 | acc=1.0000 | 4789.1 samples/s | 74.8 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01906 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=4.976 | acc=1.0000 | 4748.6 samples/s | 74.2 steps/s
[Step=35400 Epoch=34.6] | Loss=0.01746 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=4.978 | acc=1.0000 | 4712.3 samples/s | 73.6 steps/s
[Step=35450 Epoch=34.6] | Loss=0.01678 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=4.980 | acc=0.9844 | 4729.4 samples/s | 73.9 steps/s
[Step=35500 Epoch=34.7] | Loss=0.01592 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=4.982 | acc=1.0000 | 4813.1 samples/s | 75.2 steps/s
[Step=35550 Epoch=34.7] | Loss=0.01537 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=4.985 | acc=0.9844 | 4771.8 samples/s | 74.6 steps/s
[Step=35600 Epoch=34.8] | Loss=0.01501 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=4.987 | acc=0.9844 | 4801.4 samples/s | 75.0 steps/s
[Step=35650 Epoch=34.8] | Loss=0.01477 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=4.989 | acc=0.9844 | 4769.2 samples/s | 74.5 steps/s
[Step=35700 Epoch=34.9] | Loss=0.01455 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=4.990 | acc=1.0000 | 4804.4 samples/s | 75.1 steps/s
[Step=35750 Epoch=34.9] | Loss=0.01422 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=4.992 | acc=1.0000 | 4839.3 samples/s | 75.6 steps/s
[Step=35800 Epoch=35.0] | Loss=0.01407 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=4.994 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
[Step=35850 Epoch=35.0] | Loss=0.01398 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=4.996 | acc=1.0000 | 4790.9 samples/s | 74.9 steps/s
[Step=35900 Epoch=35.1] | Loss=0.01379 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=4.998 | acc=1.0000 | 4820.2 samples/s | 75.3 steps/s
[Step=35950 Epoch=35.1] | Loss=0.01375 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=4.999 | acc=0.9844 | 4806.5 samples/s | 75.1 steps/s
[Step=36000 Epoch=35.1] | Loss=0.01370 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=5.001 | acc=1.0000 | 4835.8 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.02720 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=4.970 | acc=0.9844 | 3722.8 samples/s | 58.2 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00208 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=4.975 | acc=1.0000 | 4346.9 samples/s | 67.9 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00109 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=4.977 | acc=1.0000 | 4666.1 samples/s | 72.9 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00074 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=4.979 | acc=1.0000 | 4492.2 samples/s | 70.2 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00057 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=4.979 | acc=1.0000 | 4539.1 samples/s | 70.9 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00046 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=4.980 | acc=1.0000 | 4544.0 samples/s | 71.0 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00039 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=4.981 | acc=1.0000 | 4568.6 samples/s | 71.4 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=4.982 | acc=1.0000 | 4490.3 samples/s | 70.2 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00030 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=4.983 | acc=1.0000 | 4526.7 samples/s | 70.7 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=4.983 | acc=1.0000 | 4560.5 samples/s | 71.3 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=4.984 | acc=1.0000 | 4681.4 samples/s | 73.1 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=4.985 | acc=1.0000 | 1875.5 samples/s | 29.3 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=4.985 | acc=1.0000 | 4571.0 samples/s | 71.4 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00020 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=4.986 | acc=1.0000 | 4498.5 samples/s | 70.3 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00018 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=4.986 | acc=1.0000 | 4616.8 samples/s | 72.1 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00017 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=4.987 | acc=1.0000 | 4495.0 samples/s | 70.2 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00016 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=4.988 | acc=1.0000 | 4603.4 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25372 | acc=0.8260 | tpr=0.7475 | fpr=0.0035 | 4412.6 samples/s | 17.2 steps/s
Avg test loss: 0.25762, Avg test acc: 0.82471, Avg tpr: 0.74704, Avg fpr: 0.00449, total FA: 35

Testing server on iccad2012
[Step=  50] | Loss=0.30920 | acc=0.8893 | tpr=0.9735 | fpr=0.1122 | 4449.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.31956 | acc=0.8871 | tpr=0.9787 | fpr=0.1146 | 8458.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.32456 | acc=0.8869 | tpr=0.9813 | fpr=0.1148 | 8690.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.32317 | acc=0.8873 | tpr=0.9825 | fpr=0.1144 | 8859.1 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.32057 | acc=0.8877 | tpr=0.9834 | fpr=0.1140 | 8349.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.32337 | acc=0.8872 | tpr=0.9818 | fpr=0.1146 | 8816.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.32406 | acc=0.8869 | tpr=0.9818 | fpr=0.1148 | 9157.8 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.32524 | acc=0.8867 | tpr=0.9809 | fpr=0.1151 | 8076.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.32803 | acc=0.8860 | tpr=0.9815 | fpr=0.1157 | 8691.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.32860 | acc=0.8857 | tpr=0.9815 | fpr=0.1160 | 9367.5 samples/s | 36.6 steps/s
[Step= 550] | Loss=0.32716 | acc=0.8859 | tpr=0.9805 | fpr=0.1159 | 13945.9 samples/s | 54.5 steps/s
Avg test loss: 0.32702, Avg test acc: 0.88584, Avg tpr: 0.98059, Avg fpr: 0.11588, total FA: 16090

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.25779 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=5.011 | acc=0.8281 | 4086.7 samples/s | 63.9 steps/s
[Step=36050 Epoch=35.2] | Loss=0.03433 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=5.012 | acc=0.9844 | 4516.8 samples/s | 70.6 steps/s
[Step=36100 Epoch=35.2] | Loss=0.02412 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=5.013 | acc=1.0000 | 4867.0 samples/s | 76.0 steps/s
[Step=36150 Epoch=35.3] | Loss=0.02046 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=5.014 | acc=0.9688 | 4873.4 samples/s | 76.1 steps/s
[Step=36200 Epoch=35.3] | Loss=0.01857 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=5.016 | acc=1.0000 | 4882.5 samples/s | 76.3 steps/s
[Step=36250 Epoch=35.4] | Loss=0.01764 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=5.018 | acc=1.0000 | 4889.9 samples/s | 76.4 steps/s
[Step=36300 Epoch=35.4] | Loss=0.01662 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=5.020 | acc=1.0000 | 4761.9 samples/s | 74.4 steps/s
[Step=36350 Epoch=35.5] | Loss=0.01595 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=5.022 | acc=0.9844 | 4809.4 samples/s | 75.1 steps/s
[Step=36400 Epoch=35.5] | Loss=0.01569 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=5.024 | acc=1.0000 | 4749.4 samples/s | 74.2 steps/s
[Step=36450 Epoch=35.6] | Loss=0.01527 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=5.026 | acc=0.9844 | 4793.2 samples/s | 74.9 steps/s
[Step=36500 Epoch=35.6] | Loss=0.01497 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=5.028 | acc=1.0000 | 4776.2 samples/s | 74.6 steps/s
[Step=36550 Epoch=35.7] | Loss=0.01458 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=5.030 | acc=0.9844 | 4787.5 samples/s | 74.8 steps/s
[Step=36600 Epoch=35.7] | Loss=0.01451 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=5.032 | acc=1.0000 | 4901.2 samples/s | 76.6 steps/s
[Step=36650 Epoch=35.8] | Loss=0.01439 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=5.034 | acc=0.9844 | 4898.5 samples/s | 76.5 steps/s
[Step=36700 Epoch=35.8] | Loss=0.01419 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=5.035 | acc=0.9844 | 4889.8 samples/s | 76.4 steps/s
[Step=36750 Epoch=35.9] | Loss=0.01401 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=5.037 | acc=1.0000 | 4709.8 samples/s | 73.6 steps/s
[Step=36800 Epoch=35.9] | Loss=0.01393 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=5.039 | acc=1.0000 | 4834.9 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.01367 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=5.012 | acc=0.9844 | 3709.9 samples/s | 58.0 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00225 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=5.016 | acc=1.0000 | 4434.0 samples/s | 69.3 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00116 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=5.018 | acc=1.0000 | 4671.2 samples/s | 73.0 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00079 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=5.019 | acc=1.0000 | 4658.4 samples/s | 72.8 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00060 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=5.020 | acc=1.0000 | 4724.9 samples/s | 73.8 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00049 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=5.021 | acc=1.0000 | 4591.7 samples/s | 71.7 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=5.021 | acc=1.0000 | 4628.3 samples/s | 72.3 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00036 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=5.022 | acc=1.0000 | 4651.8 samples/s | 72.7 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=5.023 | acc=1.0000 | 4715.0 samples/s | 73.7 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=5.023 | acc=1.0000 | 4519.8 samples/s | 70.6 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=5.024 | acc=1.0000 | 4629.8 samples/s | 72.3 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=5.025 | acc=1.0000 | 1994.0 samples/s | 31.2 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=5.025 | acc=1.0000 | 4654.3 samples/s | 72.7 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=5.026 | acc=1.0000 | 4690.7 samples/s | 73.3 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00019 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=5.026 | acc=1.0000 | 4600.0 samples/s | 71.9 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=5.027 | acc=1.0000 | 4623.3 samples/s | 72.2 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=5.027 | acc=1.0000 | 4550.4 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25000 | acc=0.8258 | tpr=0.7473 | fpr=0.0037 | 4394.5 samples/s | 17.2 steps/s
Avg test loss: 0.25312, Avg test acc: 0.82515, Avg tpr: 0.74780, Avg fpr: 0.00474, total FA: 37

Testing server on iccad2012
[Step=  50] | Loss=0.30600 | acc=0.8913 | tpr=0.9646 | fpr=0.1100 | 4364.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.31597 | acc=0.8904 | tpr=0.9744 | fpr=0.1112 | 8767.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.32099 | acc=0.8894 | tpr=0.9769 | fpr=0.1122 | 9231.4 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.31909 | acc=0.8899 | tpr=0.9803 | fpr=0.1117 | 8111.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.31701 | acc=0.8903 | tpr=0.9817 | fpr=0.1114 | 8831.1 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.31979 | acc=0.8900 | tpr=0.9804 | fpr=0.1116 | 8555.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.32022 | acc=0.8899 | tpr=0.9806 | fpr=0.1117 | 8653.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.32130 | acc=0.8898 | tpr=0.9798 | fpr=0.1119 | 8554.1 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.32401 | acc=0.8891 | tpr=0.9800 | fpr=0.1126 | 8800.8 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.32442 | acc=0.8888 | tpr=0.9806 | fpr=0.1129 | 8696.3 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.32308 | acc=0.8891 | tpr=0.9797 | fpr=0.1126 | 15299.5 samples/s | 59.8 steps/s
Avg test loss: 0.32295, Avg test acc: 0.88907, Avg tpr: 0.97979, Avg fpr: 0.11258, total FA: 15632

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.21938 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=5.051 | acc=0.8594 | 3998.0 samples/s | 62.5 steps/s
[Step=36850 Epoch=36.0] | Loss=0.03113 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=5.051 | acc=0.9844 | 4412.6 samples/s | 68.9 steps/s
[Step=36900 Epoch=36.0] | Loss=0.02141 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=5.053 | acc=0.9844 | 4903.2 samples/s | 76.6 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01871 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=5.056 | acc=1.0000 | 4903.4 samples/s | 76.6 steps/s
[Step=37000 Epoch=36.1] | Loss=0.01726 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=5.059 | acc=1.0000 | 4921.6 samples/s | 76.9 steps/s
[Step=37050 Epoch=36.2] | Loss=0.01625 | Reg=0.00178 | L2-Norm=13.331 | L2-Norm(final)=5.061 | acc=1.0000 | 4810.3 samples/s | 75.2 steps/s
[Step=37100 Epoch=36.2] | Loss=0.01590 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=5.064 | acc=1.0000 | 4875.3 samples/s | 76.2 steps/s
[Step=37150 Epoch=36.3] | Loss=0.01551 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=5.066 | acc=0.9844 | 4978.6 samples/s | 77.8 steps/s
[Step=37200 Epoch=36.3] | Loss=0.01521 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=5.068 | acc=0.9688 | 4763.7 samples/s | 74.4 steps/s
[Step=37250 Epoch=36.4] | Loss=0.01474 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=5.070 | acc=0.9844 | 4839.3 samples/s | 75.6 steps/s
[Step=37300 Epoch=36.4] | Loss=0.01461 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=5.072 | acc=1.0000 | 4781.2 samples/s | 74.7 steps/s
[Step=37350 Epoch=36.5] | Loss=0.01443 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=5.074 | acc=0.9688 | 4872.0 samples/s | 76.1 steps/s
[Step=37400 Epoch=36.5] | Loss=0.01403 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=5.076 | acc=1.0000 | 4719.7 samples/s | 73.7 steps/s
[Step=37450 Epoch=36.6] | Loss=0.01387 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=5.078 | acc=1.0000 | 4786.6 samples/s | 74.8 steps/s
[Step=37500 Epoch=36.6] | Loss=0.01402 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=5.080 | acc=0.9688 | 4824.5 samples/s | 75.4 steps/s
[Step=37550 Epoch=36.7] | Loss=0.01404 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=5.082 | acc=0.9844 | 4881.2 samples/s | 76.3 steps/s
[Step=37600 Epoch=36.7] | Loss=0.01395 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=5.084 | acc=0.9688 | 4790.0 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.01274 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=5.051 | acc=0.9844 | 3543.0 samples/s | 55.4 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00179 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=5.057 | acc=1.0000 | 4457.5 samples/s | 69.6 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00093 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=5.059 | acc=1.0000 | 4600.4 samples/s | 71.9 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00064 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=5.060 | acc=1.0000 | 4632.3 samples/s | 72.4 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00049 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=5.061 | acc=1.0000 | 4664.8 samples/s | 72.9 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00040 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=5.062 | acc=1.0000 | 4557.7 samples/s | 71.2 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=5.062 | acc=1.0000 | 4577.8 samples/s | 71.5 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=5.063 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=5.064 | acc=1.0000 | 4582.7 samples/s | 71.6 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=5.064 | acc=1.0000 | 4521.5 samples/s | 70.6 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=5.065 | acc=1.0000 | 4635.8 samples/s | 72.4 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00020 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=5.065 | acc=1.0000 | 1946.6 samples/s | 30.4 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=5.066 | acc=1.0000 | 4828.9 samples/s | 75.5 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=5.067 | acc=1.0000 | 4533.6 samples/s | 70.8 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=5.067 | acc=1.0000 | 4684.9 samples/s | 73.2 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00015 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=5.068 | acc=1.0000 | 4616.3 samples/s | 72.1 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00014 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=5.068 | acc=1.0000 | 4595.8 samples/s | 71.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26488 | acc=0.8168 | tpr=0.7341 | fpr=0.0037 | 4469.9 samples/s | 17.5 steps/s
Avg test loss: 0.26865, Avg test acc: 0.81549, Avg tpr: 0.73375, Avg fpr: 0.00474, total FA: 37

Testing server on iccad2012
[Step=  50] | Loss=0.29578 | acc=0.8970 | tpr=0.9690 | fpr=0.1043 | 4450.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.30497 | acc=0.8951 | tpr=0.9765 | fpr=0.1064 | 8713.3 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.30943 | acc=0.8946 | tpr=0.9798 | fpr=0.1070 | 8800.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.30791 | acc=0.8953 | tpr=0.9825 | fpr=0.1063 | 8266.5 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.30580 | acc=0.8958 | tpr=0.9843 | fpr=0.1058 | 8730.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.30868 | acc=0.8951 | tpr=0.9818 | fpr=0.1064 | 8401.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.30923 | acc=0.8951 | tpr=0.9818 | fpr=0.1065 | 9296.3 samples/s | 36.3 steps/s
[Step= 400] | Loss=0.31032 | acc=0.8949 | tpr=0.9809 | fpr=0.1067 | 8320.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.31314 | acc=0.8942 | tpr=0.9810 | fpr=0.1073 | 8535.1 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.31346 | acc=0.8942 | tpr=0.9811 | fpr=0.1074 | 5164.8 samples/s | 20.2 steps/s
[Step= 550] | Loss=0.31202 | acc=0.8943 | tpr=0.9801 | fpr=0.1072 | 15059.2 samples/s | 58.8 steps/s
Avg test loss: 0.31181, Avg test acc: 0.89434, Avg tpr: 0.97979, Avg fpr: 0.10722, total FA: 14887

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.07948 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=5.094 | acc=0.9531 | 3924.7 samples/s | 61.3 steps/s
[Step=37650 Epoch=36.8] | Loss=0.03456 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=5.093 | acc=1.0000 | 4571.9 samples/s | 71.4 steps/s
[Step=37700 Epoch=36.8] | Loss=0.02445 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=5.095 | acc=0.9844 | 4887.8 samples/s | 76.4 steps/s
[Step=37750 Epoch=36.9] | Loss=0.02101 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=5.097 | acc=1.0000 | 4867.0 samples/s | 76.0 steps/s
[Step=37800 Epoch=36.9] | Loss=0.01911 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=5.099 | acc=0.9688 | 4782.4 samples/s | 74.7 steps/s
[Step=37850 Epoch=37.0] | Loss=0.01750 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=5.101 | acc=0.9844 | 4792.9 samples/s | 74.9 steps/s
[Step=37900 Epoch=37.0] | Loss=0.01720 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=5.103 | acc=0.9688 | 4768.1 samples/s | 74.5 steps/s
[Step=37950 Epoch=37.1] | Loss=0.01666 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=5.105 | acc=0.9844 | 4774.1 samples/s | 74.6 steps/s
[Step=38000 Epoch=37.1] | Loss=0.01596 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=5.107 | acc=0.9688 | 4739.4 samples/s | 74.1 steps/s
[Step=38050 Epoch=37.1] | Loss=0.01564 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=5.109 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=38100 Epoch=37.2] | Loss=0.01545 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=5.111 | acc=1.0000 | 4734.7 samples/s | 74.0 steps/s
[Step=38150 Epoch=37.2] | Loss=0.01523 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=5.113 | acc=1.0000 | 4780.4 samples/s | 74.7 steps/s
[Step=38200 Epoch=37.3] | Loss=0.01503 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=5.116 | acc=0.9688 | 4729.2 samples/s | 73.9 steps/s
[Step=38250 Epoch=37.3] | Loss=0.01479 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=5.118 | acc=0.9844 | 4819.0 samples/s | 75.3 steps/s
[Step=38300 Epoch=37.4] | Loss=0.01465 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=5.120 | acc=1.0000 | 4771.6 samples/s | 74.6 steps/s
[Step=38350 Epoch=37.4] | Loss=0.01441 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=5.122 | acc=0.9688 | 4830.0 samples/s | 75.5 steps/s
[Step=38400 Epoch=37.5] | Loss=0.01409 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=5.124 | acc=0.9844 | 4870.7 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00450 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=5.094 | acc=1.0000 | 4070.2 samples/s | 63.6 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00120 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=5.099 | acc=1.0000 | 4194.7 samples/s | 65.5 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=5.101 | acc=1.0000 | 4567.0 samples/s | 71.4 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=5.102 | acc=1.0000 | 4559.6 samples/s | 71.2 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=5.103 | acc=1.0000 | 4512.9 samples/s | 70.5 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=5.104 | acc=1.0000 | 4534.6 samples/s | 70.9 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=5.105 | acc=1.0000 | 4540.8 samples/s | 71.0 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=5.106 | acc=1.0000 | 4532.9 samples/s | 70.8 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=5.107 | acc=1.0000 | 4549.0 samples/s | 71.1 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=5.108 | acc=1.0000 | 4702.1 samples/s | 73.5 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=5.108 | acc=1.0000 | 4628.9 samples/s | 72.3 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00015 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=5.109 | acc=1.0000 | 1924.5 samples/s | 30.1 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00014 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=5.110 | acc=1.0000 | 4685.5 samples/s | 73.2 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00013 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=5.111 | acc=1.0000 | 4616.2 samples/s | 72.1 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00012 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=5.111 | acc=1.0000 | 4526.8 samples/s | 70.7 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00011 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=5.112 | acc=1.0000 | 4562.2 samples/s | 71.3 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00011 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=5.112 | acc=1.0000 | 4539.8 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24391 | acc=0.8291 | tpr=0.7523 | fpr=0.0042 | 4414.9 samples/s | 17.2 steps/s
Avg test loss: 0.24729, Avg test acc: 0.82719, Avg tpr: 0.75089, Avg fpr: 0.00500, total FA: 39

Testing server on iccad2012
[Step=  50] | Loss=0.30668 | acc=0.8891 | tpr=0.9690 | fpr=0.1123 | 4443.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.31767 | acc=0.8868 | tpr=0.9765 | fpr=0.1149 | 9285.3 samples/s | 36.3 steps/s
[Step= 150] | Loss=0.32243 | acc=0.8862 | tpr=0.9798 | fpr=0.1156 | 8052.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.32060 | acc=0.8871 | tpr=0.9825 | fpr=0.1147 | 8925.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.31863 | acc=0.8871 | tpr=0.9852 | fpr=0.1147 | 8335.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.32169 | acc=0.8867 | tpr=0.9825 | fpr=0.1150 | 8589.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.32237 | acc=0.8867 | tpr=0.9818 | fpr=0.1150 | 8459.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.32345 | acc=0.8867 | tpr=0.9814 | fpr=0.1151 | 7782.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.32638 | acc=0.8860 | tpr=0.9815 | fpr=0.1157 | 5916.1 samples/s | 23.1 steps/s
[Step= 500] | Loss=0.32684 | acc=0.8859 | tpr=0.9815 | fpr=0.1158 | 8784.3 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.32544 | acc=0.8861 | tpr=0.9805 | fpr=0.1156 | 15629.3 samples/s | 61.1 steps/s
Avg test loss: 0.32524, Avg test acc: 0.88613, Avg tpr: 0.98059, Avg fpr: 0.11559, total FA: 16049

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.13618 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=5.138 | acc=0.8906 | 3649.8 samples/s | 57.0 steps/s
[Step=38450 Epoch=37.5] | Loss=0.03256 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=5.139 | acc=1.0000 | 4830.3 samples/s | 75.5 steps/s
[Step=38500 Epoch=37.6] | Loss=0.02267 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=5.141 | acc=1.0000 | 4957.3 samples/s | 77.5 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01925 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=5.144 | acc=1.0000 | 4825.7 samples/s | 75.4 steps/s
[Step=38600 Epoch=37.7] | Loss=0.01779 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=5.146 | acc=1.0000 | 4891.2 samples/s | 76.4 steps/s
[Step=38650 Epoch=37.7] | Loss=0.01714 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=5.148 | acc=1.0000 | 4870.7 samples/s | 76.1 steps/s
[Step=38700 Epoch=37.8] | Loss=0.01592 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=5.150 | acc=0.9844 | 4891.9 samples/s | 76.4 steps/s
[Step=38750 Epoch=37.8] | Loss=0.01531 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=5.153 | acc=0.9844 | 4758.0 samples/s | 74.3 steps/s
[Step=38800 Epoch=37.9] | Loss=0.01541 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=5.155 | acc=0.9688 | 4819.3 samples/s | 75.3 steps/s
[Step=38850 Epoch=37.9] | Loss=0.01537 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=5.157 | acc=1.0000 | 4777.6 samples/s | 74.7 steps/s
[Step=38900 Epoch=38.0] | Loss=0.01513 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=5.158 | acc=0.9844 | 4786.0 samples/s | 74.8 steps/s
[Step=38950 Epoch=38.0] | Loss=0.01514 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=5.160 | acc=1.0000 | 4827.9 samples/s | 75.4 steps/s
[Step=39000 Epoch=38.1] | Loss=0.01489 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=5.162 | acc=0.9844 | 4835.2 samples/s | 75.6 steps/s
[Step=39050 Epoch=38.1] | Loss=0.01470 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=5.164 | acc=0.9688 | 4749.2 samples/s | 74.2 steps/s
[Step=39100 Epoch=38.2] | Loss=0.01464 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=5.165 | acc=1.0000 | 4795.2 samples/s | 74.9 steps/s
[Step=39150 Epoch=38.2] | Loss=0.01449 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=5.167 | acc=1.0000 | 4793.0 samples/s | 74.9 steps/s
[Step=39200 Epoch=38.3] | Loss=0.01442 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=5.169 | acc=1.0000 | 4808.6 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.02028 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=5.138 | acc=0.9688 | 3654.9 samples/s | 57.1 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00174 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=5.143 | acc=1.0000 | 4504.9 samples/s | 70.4 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00096 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=5.145 | acc=1.0000 | 4632.9 samples/s | 72.4 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=5.146 | acc=1.0000 | 4673.5 samples/s | 73.0 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=5.148 | acc=1.0000 | 4664.5 samples/s | 72.9 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=5.149 | acc=1.0000 | 4725.2 samples/s | 73.8 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=5.150 | acc=1.0000 | 4579.6 samples/s | 71.6 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=5.150 | acc=1.0000 | 4694.7 samples/s | 73.4 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=5.151 | acc=1.0000 | 4704.8 samples/s | 73.5 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=5.152 | acc=1.0000 | 4646.6 samples/s | 72.6 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00023 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=5.153 | acc=1.0000 | 4722.7 samples/s | 73.8 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00022 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=5.153 | acc=1.0000 | 1943.9 samples/s | 30.4 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=5.154 | acc=1.0000 | 4657.1 samples/s | 72.8 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00019 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=5.155 | acc=1.0000 | 4528.8 samples/s | 70.8 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00018 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=5.155 | acc=1.0000 | 4529.4 samples/s | 70.8 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00016 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=5.156 | acc=1.0000 | 4610.9 samples/s | 72.0 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00016 | Reg=0.00175 | L2-Norm=13.225 | L2-Norm(final)=5.157 | acc=1.0000 | 4452.8 samples/s | 69.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26753 | acc=0.8130 | tpr=0.7288 | fpr=0.0040 | 4357.7 samples/s | 17.0 steps/s
Avg test loss: 0.26937, Avg test acc: 0.81132, Avg tpr: 0.72787, Avg fpr: 0.00513, total FA: 40

Testing server on iccad2012
[Step=  50] | Loss=0.26176 | acc=0.9118 | tpr=0.9779 | fpr=0.0894 | 4430.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.27121 | acc=0.9089 | tpr=0.9808 | fpr=0.0925 | 8770.4 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.27524 | acc=0.9083 | tpr=0.9813 | fpr=0.0930 | 7391.8 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.27388 | acc=0.9088 | tpr=0.9825 | fpr=0.0926 | 8881.8 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.27192 | acc=0.9090 | tpr=0.9843 | fpr=0.0924 | 8908.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.27509 | acc=0.9085 | tpr=0.9811 | fpr=0.0929 | 8242.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.27567 | acc=0.9084 | tpr=0.9806 | fpr=0.0929 | 5335.5 samples/s | 20.8 steps/s
[Step= 400] | Loss=0.27684 | acc=0.9083 | tpr=0.9792 | fpr=0.0930 | 8793.0 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.27943 | acc=0.9079 | tpr=0.9800 | fpr=0.0934 | 8667.3 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.27986 | acc=0.9076 | tpr=0.9802 | fpr=0.0937 | 8408.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.27851 | acc=0.9078 | tpr=0.9797 | fpr=0.0935 | 15659.1 samples/s | 61.2 steps/s
Avg test loss: 0.27827, Avg test acc: 0.90776, Avg tpr: 0.97979, Avg fpr: 0.09355, total FA: 12989

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.13436 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=5.182 | acc=0.9062 | 3774.1 samples/s | 59.0 steps/s
[Step=39250 Epoch=38.3] | Loss=0.03563 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=5.181 | acc=0.9844 | 4560.2 samples/s | 71.3 steps/s
[Step=39300 Epoch=38.4] | Loss=0.02493 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=5.183 | acc=1.0000 | 4737.1 samples/s | 74.0 steps/s
[Step=39350 Epoch=38.4] | Loss=0.02104 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=5.186 | acc=0.9844 | 4721.0 samples/s | 73.8 steps/s
[Step=39400 Epoch=38.5] | Loss=0.01897 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=5.189 | acc=0.9844 | 4671.7 samples/s | 73.0 steps/s
[Step=39450 Epoch=38.5] | Loss=0.01799 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=5.192 | acc=0.9688 | 4782.1 samples/s | 74.7 steps/s
[Step=39500 Epoch=38.6] | Loss=0.01726 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=5.194 | acc=1.0000 | 4811.3 samples/s | 75.2 steps/s
[Step=39550 Epoch=38.6] | Loss=0.01660 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=5.196 | acc=0.9688 | 4840.1 samples/s | 75.6 steps/s
[Step=39600 Epoch=38.7] | Loss=0.01596 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=5.199 | acc=1.0000 | 4817.6 samples/s | 75.3 steps/s
[Step=39650 Epoch=38.7] | Loss=0.01575 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=5.201 | acc=0.9844 | 4810.8 samples/s | 75.2 steps/s
[Step=39700 Epoch=38.8] | Loss=0.01562 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=5.203 | acc=0.9688 | 4823.3 samples/s | 75.4 steps/s
[Step=39750 Epoch=38.8] | Loss=0.01538 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=5.205 | acc=0.9844 | 4721.9 samples/s | 73.8 steps/s
[Step=39800 Epoch=38.9] | Loss=0.01503 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=5.207 | acc=0.9844 | 4828.8 samples/s | 75.5 steps/s
[Step=39850 Epoch=38.9] | Loss=0.01487 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=5.210 | acc=0.9688 | 4777.6 samples/s | 74.7 steps/s
[Step=39900 Epoch=39.0] | Loss=0.01477 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=5.212 | acc=0.9688 | 4819.4 samples/s | 75.3 steps/s
[Step=39950 Epoch=39.0] | Loss=0.01471 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=5.214 | acc=0.9844 | 4901.4 samples/s | 76.6 steps/s
[Step=40000 Epoch=39.1] | Loss=0.01450 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=5.216 | acc=1.0000 | 4788.6 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.00575 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=5.182 | acc=1.0000 | 3706.7 samples/s | 57.9 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00082 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=5.187 | acc=1.0000 | 4425.7 samples/s | 69.2 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=5.189 | acc=1.0000 | 4553.6 samples/s | 71.1 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=5.190 | acc=1.0000 | 4581.5 samples/s | 71.6 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=5.191 | acc=1.0000 | 4560.3 samples/s | 71.3 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.229 | L2-Norm(final)=5.192 | acc=1.0000 | 4594.4 samples/s | 71.8 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00017 | Reg=0.00175 | L2-Norm=13.226 | L2-Norm(final)=5.193 | acc=1.0000 | 4502.2 samples/s | 70.3 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00015 | Reg=0.00175 | L2-Norm=13.222 | L2-Norm(final)=5.194 | acc=1.0000 | 4538.4 samples/s | 70.9 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00014 | Reg=0.00175 | L2-Norm=13.219 | L2-Norm(final)=5.195 | acc=1.0000 | 4573.5 samples/s | 71.5 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00012 | Reg=0.00175 | L2-Norm=13.215 | L2-Norm(final)=5.195 | acc=1.0000 | 4574.0 samples/s | 71.5 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00011 | Reg=0.00175 | L2-Norm=13.211 | L2-Norm(final)=5.196 | acc=1.0000 | 4582.4 samples/s | 71.6 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00011 | Reg=0.00174 | L2-Norm=13.207 | L2-Norm(final)=5.197 | acc=1.0000 | 1958.7 samples/s | 30.6 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00010 | Reg=0.00174 | L2-Norm=13.204 | L2-Norm(final)=5.198 | acc=1.0000 | 4698.9 samples/s | 73.4 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00009 | Reg=0.00174 | L2-Norm=13.200 | L2-Norm(final)=5.198 | acc=1.0000 | 4646.8 samples/s | 72.6 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00009 | Reg=0.00174 | L2-Norm=13.196 | L2-Norm(final)=5.199 | acc=1.0000 | 4624.6 samples/s | 72.3 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00008 | Reg=0.00174 | L2-Norm=13.192 | L2-Norm(final)=5.200 | acc=1.0000 | 4645.5 samples/s | 72.6 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00008 | Reg=0.00174 | L2-Norm=13.188 | L2-Norm(final)=5.200 | acc=1.0000 | 4646.9 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23248 | acc=0.8358 | tpr=0.7623 | fpr=0.0047 | 4474.1 samples/s | 17.5 steps/s
Avg test loss: 0.23573, Avg test acc: 0.83380, Avg tpr: 0.76068, Avg fpr: 0.00538, total FA: 42

Testing server on iccad2012
[Step=  50] | Loss=0.31611 | acc=0.8870 | tpr=0.9690 | fpr=0.1144 | 4483.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.32614 | acc=0.8860 | tpr=0.9787 | fpr=0.1157 | 8518.6 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.33102 | acc=0.8854 | tpr=0.9827 | fpr=0.1164 | 8830.3 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.32945 | acc=0.8859 | tpr=0.9836 | fpr=0.1159 | 8756.4 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.32729 | acc=0.8857 | tpr=0.9860 | fpr=0.1162 | 5275.1 samples/s | 20.6 steps/s
[Step= 300] | Loss=0.33085 | acc=0.8852 | tpr=0.9818 | fpr=0.1166 | 8095.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.33135 | acc=0.8852 | tpr=0.9818 | fpr=0.1166 | 8696.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.33278 | acc=0.8847 | tpr=0.9803 | fpr=0.1170 | 8503.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.33542 | acc=0.8842 | tpr=0.9810 | fpr=0.1176 | 8651.9 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.33603 | acc=0.8838 | tpr=0.9811 | fpr=0.1179 | 9179.0 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.33449 | acc=0.8842 | tpr=0.9805 | fpr=0.1175 | 13540.1 samples/s | 52.9 steps/s
Avg test loss: 0.33430, Avg test acc: 0.88421, Avg tpr: 0.98059, Avg fpr: 0.11755, total FA: 16321
