Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 20)
Resampled dataset to size (65551, 144, 20)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 20)
Resampled dataset to size (33952, 144, 20)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 20)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 20)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38838 | Reg=0.00357 | L2-Norm=18.889 | L2-Norm(final)=1.985 | acc=0.4375 | 2388.2 samples/s | 37.3 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29989 | Reg=0.00349 | L2-Norm=18.673 | L2-Norm(final)=1.971 | acc=0.7344 | 4993.5 samples/s | 78.0 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25256 | Reg=0.00345 | L2-Norm=18.574 | L2-Norm(final)=1.983 | acc=0.9062 | 5035.2 samples/s | 78.7 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22488 | Reg=0.00342 | L2-Norm=18.496 | L2-Norm(final)=1.992 | acc=0.8281 | 4890.9 samples/s | 76.4 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20736 | Reg=0.00340 | L2-Norm=18.435 | L2-Norm(final)=2.000 | acc=0.9062 | 4021.9 samples/s | 62.8 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19178 | Reg=0.00338 | L2-Norm=18.384 | L2-Norm(final)=2.009 | acc=0.9531 | 3958.8 samples/s | 61.9 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18043 | Reg=0.00336 | L2-Norm=18.342 | L2-Norm(final)=2.017 | acc=0.9062 | 3990.8 samples/s | 62.4 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17189 | Reg=0.00335 | L2-Norm=18.306 | L2-Norm(final)=2.024 | acc=0.9062 | 3951.8 samples/s | 61.7 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16416 | Reg=0.00334 | L2-Norm=18.274 | L2-Norm(final)=2.030 | acc=0.8906 | 4000.4 samples/s | 62.5 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.15793 | Reg=0.00333 | L2-Norm=18.249 | L2-Norm(final)=2.035 | acc=0.9531 | 4002.5 samples/s | 62.5 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15242 | Reg=0.00332 | L2-Norm=18.226 | L2-Norm(final)=2.041 | acc=0.7969 | 3954.7 samples/s | 61.8 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14697 | Reg=0.00332 | L2-Norm=18.208 | L2-Norm(final)=2.047 | acc=0.9844 | 3996.9 samples/s | 62.5 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14308 | Reg=0.00331 | L2-Norm=18.193 | L2-Norm(final)=2.053 | acc=0.9062 | 3933.9 samples/s | 61.5 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.13980 | Reg=0.00330 | L2-Norm=18.178 | L2-Norm(final)=2.057 | acc=0.9375 | 4004.0 samples/s | 62.6 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13602 | Reg=0.00330 | L2-Norm=18.165 | L2-Norm(final)=2.062 | acc=0.9375 | 3966.1 samples/s | 62.0 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13288 | Reg=0.00330 | L2-Norm=18.154 | L2-Norm(final)=2.067 | acc=0.9219 | 4017.4 samples/s | 62.8 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12988 | Reg=0.00329 | L2-Norm=18.146 | L2-Norm(final)=2.071 | acc=0.9062 | 3969.6 samples/s | 62.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.61626 | Reg=0.00357 | L2-Norm=18.889 | L2-Norm(final)=1.985 | acc=0.4062 | 2936.9 samples/s | 45.9 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.22068 | Reg=0.00351 | L2-Norm=18.722 | L2-Norm(final)=1.988 | acc=0.9219 | 4625.5 samples/s | 72.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.13413 | Reg=0.00348 | L2-Norm=18.651 | L2-Norm(final)=2.009 | acc=0.9688 | 4772.0 samples/s | 74.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.09906 | Reg=0.00345 | L2-Norm=18.577 | L2-Norm(final)=2.021 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.08023 | Reg=0.00343 | L2-Norm=18.509 | L2-Norm(final)=2.028 | acc=1.0000 | 4821.3 samples/s | 75.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.06668 | Reg=0.00340 | L2-Norm=18.450 | L2-Norm(final)=2.036 | acc=1.0000 | 4804.8 samples/s | 75.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05747 | Reg=0.00338 | L2-Norm=18.394 | L2-Norm(final)=2.042 | acc=1.0000 | 4839.3 samples/s | 75.6 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04991 | Reg=0.00336 | L2-Norm=18.340 | L2-Norm(final)=2.048 | acc=1.0000 | 4750.4 samples/s | 74.2 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04513 | Reg=0.00335 | L2-Norm=18.288 | L2-Norm(final)=2.053 | acc=1.0000 | 4742.3 samples/s | 74.1 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.04125 | Reg=0.00333 | L2-Norm=18.239 | L2-Norm(final)=2.056 | acc=1.0000 | 4829.0 samples/s | 75.5 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03775 | Reg=0.00331 | L2-Norm=18.192 | L2-Norm(final)=2.060 | acc=1.0000 | 4756.5 samples/s | 74.3 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03489 | Reg=0.00329 | L2-Norm=18.147 | L2-Norm(final)=2.063 | acc=0.9844 | 1468.8 samples/s | 22.9 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.03238 | Reg=0.00328 | L2-Norm=18.103 | L2-Norm(final)=2.067 | acc=1.0000 | 4906.1 samples/s | 76.7 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.03001 | Reg=0.00326 | L2-Norm=18.060 | L2-Norm(final)=2.071 | acc=1.0000 | 4671.8 samples/s | 73.0 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02829 | Reg=0.00325 | L2-Norm=18.018 | L2-Norm(final)=2.074 | acc=1.0000 | 4676.1 samples/s | 73.1 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02666 | Reg=0.00323 | L2-Norm=17.978 | L2-Norm(final)=2.077 | acc=1.0000 | 4826.8 samples/s | 75.4 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02534 | Reg=0.00322 | L2-Norm=17.939 | L2-Norm(final)=2.080 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37987 | acc=0.5288 | tpr=0.3570 | fpr=0.0984 | 4420.1 samples/s | 17.3 steps/s
Avg test loss: 0.38065, Avg test acc: 0.52765, Avg tpr: 0.35711, Avg fpr: 0.09730, total FA: 759

Testing server on iccad2012
[Step=  50] | Loss=0.21342 | acc=0.8516 | tpr=0.9558 | fpr=0.1502 | 4579.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.21377 | acc=0.8526 | tpr=0.9616 | fpr=0.1494 | 9328.1 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.21449 | acc=0.8520 | tpr=0.9683 | fpr=0.1502 | 9192.7 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.21446 | acc=0.8519 | tpr=0.9672 | fpr=0.1502 | 8631.1 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.21450 | acc=0.8519 | tpr=0.9694 | fpr=0.1502 | 9348.9 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.21457 | acc=0.8517 | tpr=0.9709 | fpr=0.1505 | 9438.9 samples/s | 36.9 steps/s
[Step= 350] | Loss=0.21520 | acc=0.8515 | tpr=0.9699 | fpr=0.1507 | 9583.3 samples/s | 37.4 steps/s
[Step= 400] | Loss=0.21557 | acc=0.8513 | tpr=0.9694 | fpr=0.1509 | 8977.7 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.21591 | acc=0.8508 | tpr=0.9679 | fpr=0.1513 | 9010.4 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.21596 | acc=0.8506 | tpr=0.9709 | fpr=0.1516 | 9222.7 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.21567 | acc=0.8507 | tpr=0.9686 | fpr=0.1514 | 17328.0 samples/s | 67.7 steps/s
Avg test loss: 0.21558, Avg test acc: 0.85085, Avg tpr: 0.96870, Avg fpr: 0.15129, total FA: 21007

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.34838 | Reg=0.00288 | L2-Norm=16.960 | L2-Norm(final)=2.103 | acc=0.5469 | 3693.1 samples/s | 57.7 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15986 | Reg=0.00292 | L2-Norm=17.094 | L2-Norm(final)=2.100 | acc=0.9062 | 4811.8 samples/s | 75.2 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13480 | Reg=0.00294 | L2-Norm=17.144 | L2-Norm(final)=2.108 | acc=0.9844 | 4922.0 samples/s | 76.9 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12415 | Reg=0.00295 | L2-Norm=17.173 | L2-Norm(final)=2.119 | acc=0.8750 | 5030.2 samples/s | 78.6 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11765 | Reg=0.00296 | L2-Norm=17.194 | L2-Norm(final)=2.127 | acc=0.9375 | 4993.9 samples/s | 78.0 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11170 | Reg=0.00296 | L2-Norm=17.216 | L2-Norm(final)=2.134 | acc=0.9531 | 4923.7 samples/s | 76.9 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10756 | Reg=0.00297 | L2-Norm=17.236 | L2-Norm(final)=2.141 | acc=0.9062 | 4888.3 samples/s | 76.4 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10335 | Reg=0.00298 | L2-Norm=17.254 | L2-Norm(final)=2.148 | acc=0.9375 | 4986.3 samples/s | 77.9 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10021 | Reg=0.00298 | L2-Norm=17.270 | L2-Norm(final)=2.154 | acc=0.9688 | 4907.9 samples/s | 76.7 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.09741 | Reg=0.00299 | L2-Norm=17.283 | L2-Norm(final)=2.159 | acc=0.9844 | 5079.1 samples/s | 79.4 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09535 | Reg=0.00299 | L2-Norm=17.293 | L2-Norm(final)=2.163 | acc=0.9375 | 4970.6 samples/s | 77.7 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09297 | Reg=0.00299 | L2-Norm=17.304 | L2-Norm(final)=2.168 | acc=0.9375 | 4971.8 samples/s | 77.7 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09113 | Reg=0.00300 | L2-Norm=17.313 | L2-Norm(final)=2.172 | acc=0.9531 | 5063.7 samples/s | 79.1 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.08977 | Reg=0.00300 | L2-Norm=17.321 | L2-Norm(final)=2.175 | acc=0.9375 | 4936.7 samples/s | 77.1 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.08836 | Reg=0.00300 | L2-Norm=17.329 | L2-Norm(final)=2.177 | acc=0.9688 | 4913.0 samples/s | 76.8 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08685 | Reg=0.00301 | L2-Norm=17.338 | L2-Norm(final)=2.180 | acc=0.9531 | 5044.0 samples/s | 78.8 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08563 | Reg=0.00301 | L2-Norm=17.346 | L2-Norm(final)=2.182 | acc=0.9375 | 4217.9 samples/s | 65.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.13878 | Reg=0.00288 | L2-Norm=16.960 | L2-Norm(final)=2.106 | acc=0.8906 | 3204.4 samples/s | 50.1 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.04599 | Reg=0.00292 | L2-Norm=17.096 | L2-Norm(final)=2.120 | acc=0.9844 | 4247.1 samples/s | 66.4 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.02842 | Reg=0.00293 | L2-Norm=17.127 | L2-Norm(final)=2.124 | acc=1.0000 | 4724.5 samples/s | 73.8 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02206 | Reg=0.00293 | L2-Norm=17.124 | L2-Norm(final)=2.130 | acc=1.0000 | 4749.8 samples/s | 74.2 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01801 | Reg=0.00293 | L2-Norm=17.109 | L2-Norm(final)=2.135 | acc=1.0000 | 4721.5 samples/s | 73.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01559 | Reg=0.00292 | L2-Norm=17.088 | L2-Norm(final)=2.139 | acc=1.0000 | 4839.7 samples/s | 75.6 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01369 | Reg=0.00291 | L2-Norm=17.062 | L2-Norm(final)=2.143 | acc=1.0000 | 4986.9 samples/s | 77.9 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01217 | Reg=0.00290 | L2-Norm=17.037 | L2-Norm(final)=2.147 | acc=0.9844 | 4800.3 samples/s | 75.0 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01117 | Reg=0.00289 | L2-Norm=17.012 | L2-Norm(final)=2.151 | acc=1.0000 | 4637.8 samples/s | 72.5 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01049 | Reg=0.00289 | L2-Norm=16.987 | L2-Norm(final)=2.154 | acc=1.0000 | 4701.1 samples/s | 73.5 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00966 | Reg=0.00288 | L2-Norm=16.961 | L2-Norm(final)=2.157 | acc=1.0000 | 4910.3 samples/s | 76.7 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00933 | Reg=0.00287 | L2-Norm=16.936 | L2-Norm(final)=2.160 | acc=1.0000 | 1491.8 samples/s | 23.3 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00873 | Reg=0.00286 | L2-Norm=16.913 | L2-Norm(final)=2.162 | acc=1.0000 | 4961.4 samples/s | 77.5 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00814 | Reg=0.00285 | L2-Norm=16.888 | L2-Norm(final)=2.165 | acc=1.0000 | 4763.7 samples/s | 74.4 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00763 | Reg=0.00284 | L2-Norm=16.863 | L2-Norm(final)=2.167 | acc=1.0000 | 4779.6 samples/s | 74.7 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00730 | Reg=0.00284 | L2-Norm=16.837 | L2-Norm(final)=2.169 | acc=1.0000 | 4678.0 samples/s | 73.1 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00689 | Reg=0.00283 | L2-Norm=16.811 | L2-Norm(final)=2.171 | acc=1.0000 | 4870.5 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38506 | acc=0.6090 | tpr=0.4542 | fpr=0.0550 | 4584.7 samples/s | 17.9 steps/s
Avg test loss: 0.38486, Avg test acc: 0.60714, Avg tpr: 0.45299, Avg fpr: 0.05384, total FA: 420

Testing server on iccad2012
[Step=  50] | Loss=0.28583 | acc=0.8030 | tpr=0.9867 | fpr=0.2003 | 4590.8 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.28535 | acc=0.8043 | tpr=0.9872 | fpr=0.1992 | 9354.8 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.28816 | acc=0.8023 | tpr=0.9899 | fpr=0.2012 | 9378.3 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.28795 | acc=0.8033 | tpr=0.9880 | fpr=0.2001 | 9217.7 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.28787 | acc=0.8028 | tpr=0.9886 | fpr=0.2006 | 9090.4 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.28805 | acc=0.8026 | tpr=0.9884 | fpr=0.2008 | 9413.2 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.28859 | acc=0.8024 | tpr=0.9894 | fpr=0.2009 | 9275.5 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.28913 | acc=0.8026 | tpr=0.9891 | fpr=0.2008 | 9550.7 samples/s | 37.3 steps/s
[Step= 450] | Loss=0.29000 | acc=0.8024 | tpr=0.9888 | fpr=0.2010 | 8939.3 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.29045 | acc=0.8018 | tpr=0.9894 | fpr=0.2016 | 9011.9 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.28979 | acc=0.8020 | tpr=0.9901 | fpr=0.2015 | 18129.0 samples/s | 70.8 steps/s
Avg test loss: 0.28965, Avg test acc: 0.80200, Avg tpr: 0.99010, Avg fpr: 0.20142, total FA: 27967

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.31640 | Reg=0.00270 | L2-Norm=16.426 | L2-Norm(final)=2.189 | acc=0.6562 | 3573.7 samples/s | 55.8 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.11390 | Reg=0.00273 | L2-Norm=16.538 | L2-Norm(final)=2.181 | acc=0.9062 | 4980.6 samples/s | 77.8 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.09743 | Reg=0.00275 | L2-Norm=16.595 | L2-Norm(final)=2.196 | acc=0.9688 | 4973.2 samples/s | 77.7 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09098 | Reg=0.00276 | L2-Norm=16.624 | L2-Norm(final)=2.205 | acc=0.9688 | 5043.1 samples/s | 78.8 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.08785 | Reg=0.00277 | L2-Norm=16.649 | L2-Norm(final)=2.212 | acc=0.9531 | 4985.5 samples/s | 77.9 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08266 | Reg=0.00278 | L2-Norm=16.670 | L2-Norm(final)=2.219 | acc=0.9844 | 4943.4 samples/s | 77.2 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08060 | Reg=0.00279 | L2-Norm=16.688 | L2-Norm(final)=2.225 | acc=0.9688 | 4997.2 samples/s | 78.1 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.07860 | Reg=0.00279 | L2-Norm=16.706 | L2-Norm(final)=2.230 | acc=0.9375 | 4951.8 samples/s | 77.4 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07716 | Reg=0.00280 | L2-Norm=16.721 | L2-Norm(final)=2.234 | acc=0.9219 | 4987.4 samples/s | 77.9 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07540 | Reg=0.00280 | L2-Norm=16.734 | L2-Norm(final)=2.238 | acc=0.9219 | 4974.6 samples/s | 77.7 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07517 | Reg=0.00281 | L2-Norm=16.748 | L2-Norm(final)=2.242 | acc=0.9375 | 4958.2 samples/s | 77.5 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07404 | Reg=0.00281 | L2-Norm=16.762 | L2-Norm(final)=2.244 | acc=0.9531 | 4913.0 samples/s | 76.8 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07307 | Reg=0.00281 | L2-Norm=16.776 | L2-Norm(final)=2.247 | acc=0.9531 | 4976.2 samples/s | 77.8 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07193 | Reg=0.00282 | L2-Norm=16.790 | L2-Norm(final)=2.249 | acc=0.9688 | 4007.4 samples/s | 62.6 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07099 | Reg=0.00282 | L2-Norm=16.803 | L2-Norm(final)=2.252 | acc=0.9844 | 3960.9 samples/s | 61.9 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07010 | Reg=0.00283 | L2-Norm=16.817 | L2-Norm(final)=2.254 | acc=0.9688 | 3870.0 samples/s | 60.5 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.06937 | Reg=0.00283 | L2-Norm=16.830 | L2-Norm(final)=2.255 | acc=0.9062 | 3913.3 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.05520 | Reg=0.00270 | L2-Norm=16.426 | L2-Norm(final)=2.192 | acc=0.9531 | 2995.9 samples/s | 46.8 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02740 | Reg=0.00273 | L2-Norm=16.520 | L2-Norm(final)=2.209 | acc=1.0000 | 4764.8 samples/s | 74.4 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01593 | Reg=0.00274 | L2-Norm=16.545 | L2-Norm(final)=2.208 | acc=1.0000 | 4821.3 samples/s | 75.3 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01188 | Reg=0.00274 | L2-Norm=16.538 | L2-Norm(final)=2.212 | acc=1.0000 | 4920.6 samples/s | 76.9 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.00982 | Reg=0.00273 | L2-Norm=16.525 | L2-Norm(final)=2.216 | acc=1.0000 | 4753.5 samples/s | 74.3 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00848 | Reg=0.00273 | L2-Norm=16.509 | L2-Norm(final)=2.221 | acc=1.0000 | 4895.6 samples/s | 76.5 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00770 | Reg=0.00272 | L2-Norm=16.490 | L2-Norm(final)=2.224 | acc=1.0000 | 4746.1 samples/s | 74.2 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00675 | Reg=0.00271 | L2-Norm=16.470 | L2-Norm(final)=2.227 | acc=1.0000 | 4717.1 samples/s | 73.7 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00594 | Reg=0.00271 | L2-Norm=16.447 | L2-Norm(final)=2.230 | acc=1.0000 | 4740.0 samples/s | 74.1 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00531 | Reg=0.00270 | L2-Norm=16.422 | L2-Norm(final)=2.233 | acc=1.0000 | 4767.9 samples/s | 74.5 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00511 | Reg=0.00269 | L2-Norm=16.396 | L2-Norm(final)=2.236 | acc=1.0000 | 4934.8 samples/s | 77.1 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00506 | Reg=0.00268 | L2-Norm=16.373 | L2-Norm(final)=2.237 | acc=1.0000 | 1520.3 samples/s | 23.8 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00470 | Reg=0.00267 | L2-Norm=16.354 | L2-Norm(final)=2.238 | acc=1.0000 | 4918.0 samples/s | 76.8 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00451 | Reg=0.00267 | L2-Norm=16.334 | L2-Norm(final)=2.239 | acc=1.0000 | 4904.4 samples/s | 76.6 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00433 | Reg=0.00266 | L2-Norm=16.314 | L2-Norm(final)=2.241 | acc=1.0000 | 4761.3 samples/s | 74.4 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00416 | Reg=0.00266 | L2-Norm=16.294 | L2-Norm(final)=2.242 | acc=1.0000 | 4709.4 samples/s | 73.6 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00418 | Reg=0.00265 | L2-Norm=16.275 | L2-Norm(final)=2.243 | acc=0.9531 | 3887.7 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19628 | acc=0.8174 | tpr=0.7948 | fpr=0.1335 | 4271.8 samples/s | 16.7 steps/s
Avg test loss: 0.19544, Avg test acc: 0.81890, Avg tpr: 0.79548, Avg fpr: 0.12960, total FA: 1011

Testing server on iccad2012
[Step=  50] | Loss=0.50316 | acc=0.6672 | tpr=0.9956 | fpr=0.3387 | 4557.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.50932 | acc=0.6666 | tpr=0.9936 | fpr=0.3395 | 9128.8 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.51461 | acc=0.6635 | tpr=0.9957 | fpr=0.3427 | 9167.0 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.51412 | acc=0.6630 | tpr=0.9956 | fpr=0.3431 | 9726.6 samples/s | 38.0 steps/s
[Step= 250] | Loss=0.51423 | acc=0.6623 | tpr=0.9956 | fpr=0.3438 | 8916.7 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.51504 | acc=0.6620 | tpr=0.9949 | fpr=0.3441 | 9404.6 samples/s | 36.7 steps/s
[Step= 350] | Loss=0.51609 | acc=0.6613 | tpr=0.9944 | fpr=0.3448 | 9276.0 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.51759 | acc=0.6603 | tpr=0.9945 | fpr=0.3458 | 9578.1 samples/s | 37.4 steps/s
[Step= 450] | Loss=0.51910 | acc=0.6601 | tpr=0.9942 | fpr=0.3460 | 8852.1 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.51891 | acc=0.6602 | tpr=0.9947 | fpr=0.3459 | 9202.4 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.51803 | acc=0.6605 | tpr=0.9952 | fpr=0.3456 | 17801.6 samples/s | 69.5 steps/s
Avg test loss: 0.51778, Avg test acc: 0.66057, Avg tpr: 0.99525, Avg fpr: 0.34551, total FA: 47974

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.20458 | Reg=0.00259 | L2-Norm=16.099 | L2-Norm(final)=2.253 | acc=0.8281 | 3629.1 samples/s | 56.7 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.09560 | Reg=0.00262 | L2-Norm=16.186 | L2-Norm(final)=2.267 | acc=0.9062 | 4872.0 samples/s | 76.1 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.08119 | Reg=0.00264 | L2-Norm=16.249 | L2-Norm(final)=2.275 | acc=0.9375 | 4997.9 samples/s | 78.1 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.07469 | Reg=0.00266 | L2-Norm=16.296 | L2-Norm(final)=2.284 | acc=0.9688 | 5068.3 samples/s | 79.2 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07298 | Reg=0.00267 | L2-Norm=16.332 | L2-Norm(final)=2.288 | acc=0.9688 | 4858.4 samples/s | 75.9 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07072 | Reg=0.00268 | L2-Norm=16.363 | L2-Norm(final)=2.291 | acc=0.9688 | 4369.9 samples/s | 68.3 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07032 | Reg=0.00269 | L2-Norm=16.390 | L2-Norm(final)=2.292 | acc=0.9531 | 3925.8 samples/s | 61.3 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06980 | Reg=0.00269 | L2-Norm=16.414 | L2-Norm(final)=2.292 | acc=0.9219 | 3934.1 samples/s | 61.5 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06818 | Reg=0.00270 | L2-Norm=16.436 | L2-Norm(final)=2.294 | acc=0.9844 | 3914.7 samples/s | 61.2 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06583 | Reg=0.00271 | L2-Norm=16.456 | L2-Norm(final)=2.295 | acc=1.0000 | 3841.5 samples/s | 60.0 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06555 | Reg=0.00271 | L2-Norm=16.474 | L2-Norm(final)=2.295 | acc=0.9688 | 3921.1 samples/s | 61.3 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06480 | Reg=0.00272 | L2-Norm=16.491 | L2-Norm(final)=2.295 | acc=0.9531 | 3943.2 samples/s | 61.6 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06456 | Reg=0.00273 | L2-Norm=16.508 | L2-Norm(final)=2.294 | acc=0.9844 | 3943.7 samples/s | 61.6 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06411 | Reg=0.00273 | L2-Norm=16.525 | L2-Norm(final)=2.294 | acc=0.9688 | 3987.5 samples/s | 62.3 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06361 | Reg=0.00274 | L2-Norm=16.542 | L2-Norm(final)=2.294 | acc=0.9688 | 3944.3 samples/s | 61.6 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06301 | Reg=0.00274 | L2-Norm=16.560 | L2-Norm(final)=2.295 | acc=0.9062 | 3921.2 samples/s | 61.3 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06197 | Reg=0.00275 | L2-Norm=16.577 | L2-Norm(final)=2.295 | acc=0.9688 | 3909.4 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.13479 | Reg=0.00259 | L2-Norm=16.099 | L2-Norm(final)=2.252 | acc=0.9062 | 2972.6 samples/s | 46.4 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.02244 | Reg=0.00266 | L2-Norm=16.303 | L2-Norm(final)=2.247 | acc=0.9844 | 4775.0 samples/s | 74.6 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01477 | Reg=0.00267 | L2-Norm=16.340 | L2-Norm(final)=2.246 | acc=0.9688 | 4755.6 samples/s | 74.3 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.01147 | Reg=0.00267 | L2-Norm=16.338 | L2-Norm(final)=2.246 | acc=1.0000 | 4827.0 samples/s | 75.4 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00930 | Reg=0.00267 | L2-Norm=16.329 | L2-Norm(final)=2.248 | acc=1.0000 | 4792.7 samples/s | 74.9 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00781 | Reg=0.00266 | L2-Norm=16.316 | L2-Norm(final)=2.252 | acc=1.0000 | 4690.4 samples/s | 73.3 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00677 | Reg=0.00266 | L2-Norm=16.298 | L2-Norm(final)=2.257 | acc=1.0000 | 4796.2 samples/s | 74.9 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00621 | Reg=0.00265 | L2-Norm=16.279 | L2-Norm(final)=2.260 | acc=1.0000 | 4733.9 samples/s | 74.0 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00558 | Reg=0.00264 | L2-Norm=16.258 | L2-Norm(final)=2.264 | acc=1.0000 | 4741.3 samples/s | 74.1 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00529 | Reg=0.00264 | L2-Norm=16.237 | L2-Norm(final)=2.267 | acc=1.0000 | 4879.4 samples/s | 76.2 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00490 | Reg=0.00263 | L2-Norm=16.216 | L2-Norm(final)=2.270 | acc=1.0000 | 4835.8 samples/s | 75.6 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00447 | Reg=0.00262 | L2-Norm=16.194 | L2-Norm(final)=2.272 | acc=1.0000 | 1752.6 samples/s | 27.4 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00421 | Reg=0.00262 | L2-Norm=16.170 | L2-Norm(final)=2.275 | acc=1.0000 | 4763.2 samples/s | 74.4 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00438 | Reg=0.00261 | L2-Norm=16.148 | L2-Norm(final)=2.277 | acc=1.0000 | 4889.7 samples/s | 76.4 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00415 | Reg=0.00260 | L2-Norm=16.129 | L2-Norm(final)=2.277 | acc=1.0000 | 4762.4 samples/s | 74.4 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00411 | Reg=0.00260 | L2-Norm=16.111 | L2-Norm(final)=2.278 | acc=1.0000 | 4766.6 samples/s | 74.5 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00392 | Reg=0.00259 | L2-Norm=16.093 | L2-Norm(final)=2.279 | acc=1.0000 | 4730.0 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57125 | acc=0.5687 | tpr=0.3796 | fpr=0.0208 | 4582.4 samples/s | 17.9 steps/s
Avg test loss: 0.57348, Avg test acc: 0.56443, Avg tpr: 0.37606, Avg fpr: 0.02128, total FA: 166

Testing server on iccad2012
[Step=  50] | Loss=0.22523 | acc=0.8806 | tpr=0.9779 | fpr=0.1211 | 4574.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.23046 | acc=0.8782 | tpr=0.9808 | fpr=0.1237 | 9410.9 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.23485 | acc=0.8761 | tpr=0.9827 | fpr=0.1259 | 9655.5 samples/s | 37.7 steps/s
[Step= 200] | Loss=0.23454 | acc=0.8763 | tpr=0.9836 | fpr=0.1256 | 8889.0 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.23511 | acc=0.8762 | tpr=0.9843 | fpr=0.1257 | 9665.6 samples/s | 37.8 steps/s
[Step= 300] | Loss=0.23609 | acc=0.8761 | tpr=0.9833 | fpr=0.1259 | 9163.2 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.23735 | acc=0.8757 | tpr=0.9825 | fpr=0.1262 | 9175.9 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.23816 | acc=0.8753 | tpr=0.9825 | fpr=0.1266 | 9012.0 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.23964 | acc=0.8750 | tpr=0.9820 | fpr=0.1269 | 9161.8 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.23959 | acc=0.8749 | tpr=0.9828 | fpr=0.1270 | 9128.3 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.23894 | acc=0.8750 | tpr=0.9841 | fpr=0.1270 | 17435.7 samples/s | 68.1 steps/s
Avg test loss: 0.23870, Avg test acc: 0.87513, Avg tpr: 0.98376, Avg fpr: 0.12684, total FA: 17612

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.42627 | Reg=0.00254 | L2-Norm=15.926 | L2-Norm(final)=2.291 | acc=0.6875 | 3634.7 samples/s | 56.8 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.09482 | Reg=0.00258 | L2-Norm=16.077 | L2-Norm(final)=2.272 | acc=0.9531 | 4896.3 samples/s | 76.5 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.07561 | Reg=0.00260 | L2-Norm=16.138 | L2-Norm(final)=2.281 | acc=0.9531 | 4844.5 samples/s | 75.7 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.06984 | Reg=0.00262 | L2-Norm=16.177 | L2-Norm(final)=2.287 | acc=0.9844 | 4914.2 samples/s | 76.8 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.06962 | Reg=0.00263 | L2-Norm=16.205 | L2-Norm(final)=2.288 | acc=0.9375 | 4916.8 samples/s | 76.8 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06771 | Reg=0.00263 | L2-Norm=16.227 | L2-Norm(final)=2.286 | acc=1.0000 | 4450.5 samples/s | 69.5 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06561 | Reg=0.00264 | L2-Norm=16.245 | L2-Norm(final)=2.286 | acc=0.9531 | 3925.1 samples/s | 61.3 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06329 | Reg=0.00265 | L2-Norm=16.264 | L2-Norm(final)=2.287 | acc=1.0000 | 3950.0 samples/s | 61.7 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06146 | Reg=0.00265 | L2-Norm=16.280 | L2-Norm(final)=2.287 | acc=0.9688 | 3927.3 samples/s | 61.4 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.06134 | Reg=0.00266 | L2-Norm=16.295 | L2-Norm(final)=2.287 | acc=0.9531 | 3975.6 samples/s | 62.1 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05980 | Reg=0.00266 | L2-Norm=16.313 | L2-Norm(final)=2.287 | acc=0.9531 | 3911.2 samples/s | 61.1 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05897 | Reg=0.00267 | L2-Norm=16.332 | L2-Norm(final)=2.288 | acc=1.0000 | 3878.2 samples/s | 60.6 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05850 | Reg=0.00267 | L2-Norm=16.350 | L2-Norm(final)=2.288 | acc=0.9219 | 3948.2 samples/s | 61.7 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05763 | Reg=0.00268 | L2-Norm=16.368 | L2-Norm(final)=2.289 | acc=1.0000 | 3897.6 samples/s | 60.9 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05688 | Reg=0.00268 | L2-Norm=16.384 | L2-Norm(final)=2.289 | acc=0.9688 | 3968.3 samples/s | 62.0 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05608 | Reg=0.00269 | L2-Norm=16.400 | L2-Norm(final)=2.288 | acc=0.9531 | 3967.0 samples/s | 62.0 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05538 | Reg=0.00269 | L2-Norm=16.415 | L2-Norm(final)=2.289 | acc=0.9844 | 3875.0 samples/s | 60.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.01532 | Reg=0.00254 | L2-Norm=15.926 | L2-Norm(final)=2.294 | acc=0.9844 | 3410.7 samples/s | 53.3 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00494 | Reg=0.00255 | L2-Norm=15.965 | L2-Norm(final)=2.318 | acc=1.0000 | 4602.7 samples/s | 71.9 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00548 | Reg=0.00255 | L2-Norm=15.976 | L2-Norm(final)=2.326 | acc=0.9688 | 4793.7 samples/s | 74.9 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00479 | Reg=0.00255 | L2-Norm=15.981 | L2-Norm(final)=2.327 | acc=1.0000 | 4799.4 samples/s | 75.0 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00536 | Reg=0.00255 | L2-Norm=15.979 | L2-Norm(final)=2.325 | acc=1.0000 | 4894.0 samples/s | 76.5 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00530 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.321 | acc=1.0000 | 4715.8 samples/s | 73.7 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00577 | Reg=0.00255 | L2-Norm=15.974 | L2-Norm(final)=2.316 | acc=1.0000 | 4332.4 samples/s | 67.7 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00533 | Reg=0.00255 | L2-Norm=15.972 | L2-Norm(final)=2.312 | acc=0.9844 | 3783.6 samples/s | 59.1 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00480 | Reg=0.00255 | L2-Norm=15.965 | L2-Norm(final)=2.309 | acc=1.0000 | 3759.7 samples/s | 58.7 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00459 | Reg=0.00255 | L2-Norm=15.956 | L2-Norm(final)=2.308 | acc=1.0000 | 3760.4 samples/s | 58.8 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00438 | Reg=0.00254 | L2-Norm=15.943 | L2-Norm(final)=2.306 | acc=1.0000 | 3809.1 samples/s | 59.5 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00410 | Reg=0.00254 | L2-Norm=15.931 | L2-Norm(final)=2.306 | acc=1.0000 | 1534.6 samples/s | 24.0 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00377 | Reg=0.00253 | L2-Norm=15.918 | L2-Norm(final)=2.307 | acc=1.0000 | 4807.7 samples/s | 75.1 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00349 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.307 | acc=1.0000 | 4801.2 samples/s | 75.0 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00324 | Reg=0.00252 | L2-Norm=15.883 | L2-Norm(final)=2.308 | acc=1.0000 | 4829.1 samples/s | 75.5 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00303 | Reg=0.00252 | L2-Norm=15.863 | L2-Norm(final)=2.309 | acc=1.0000 | 3901.5 samples/s | 61.0 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00284 | Reg=0.00251 | L2-Norm=15.841 | L2-Norm(final)=2.310 | acc=1.0000 | 3707.1 samples/s | 57.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50690 | acc=0.6252 | tpr=0.4565 | fpr=0.0087 | 4246.6 samples/s | 16.6 steps/s
Avg test loss: 0.50998, Avg test acc: 0.62361, Avg tpr: 0.45661, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.28311 | acc=0.8438 | tpr=0.9823 | fpr=0.1587 | 4524.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.28862 | acc=0.8428 | tpr=0.9765 | fpr=0.1597 | 9970.2 samples/s | 38.9 steps/s
[Step= 150] | Loss=0.29300 | acc=0.8406 | tpr=0.9813 | fpr=0.1620 | 9113.0 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.29319 | acc=0.8414 | tpr=0.9803 | fpr=0.1611 | 8956.3 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.29304 | acc=0.8420 | tpr=0.9790 | fpr=0.1604 | 9274.1 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.29418 | acc=0.8420 | tpr=0.9782 | fpr=0.1605 | 9357.5 samples/s | 36.6 steps/s
[Step= 350] | Loss=0.29534 | acc=0.8418 | tpr=0.9793 | fpr=0.1607 | 9806.4 samples/s | 38.3 steps/s
[Step= 400] | Loss=0.29669 | acc=0.8415 | tpr=0.9803 | fpr=0.1610 | 8827.7 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.29833 | acc=0.8410 | tpr=0.9815 | fpr=0.1616 | 9272.3 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.29859 | acc=0.8405 | tpr=0.9819 | fpr=0.1620 | 9002.0 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.29777 | acc=0.8406 | tpr=0.9821 | fpr=0.1620 | 17916.2 samples/s | 70.0 steps/s
Avg test loss: 0.29756, Avg test acc: 0.84072, Avg tpr: 0.98217, Avg fpr: 0.16185, total FA: 22473

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.27191 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.302 | acc=0.8438 | 3881.6 samples/s | 60.7 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.09483 | Reg=0.00250 | L2-Norm=15.816 | L2-Norm(final)=2.281 | acc=0.9375 | 4681.3 samples/s | 73.1 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07263 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.293 | acc=0.9688 | 4774.1 samples/s | 74.6 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.06578 | Reg=0.00253 | L2-Norm=15.917 | L2-Norm(final)=2.298 | acc=0.9688 | 4903.4 samples/s | 76.6 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06426 | Reg=0.00254 | L2-Norm=15.950 | L2-Norm(final)=2.300 | acc=0.9844 | 4190.3 samples/s | 65.5 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06063 | Reg=0.00255 | L2-Norm=15.977 | L2-Norm(final)=2.300 | acc=1.0000 | 3916.5 samples/s | 61.2 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.05844 | Reg=0.00256 | L2-Norm=16.003 | L2-Norm(final)=2.303 | acc=0.9375 | 3865.9 samples/s | 60.4 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.05755 | Reg=0.00257 | L2-Norm=16.028 | L2-Norm(final)=2.304 | acc=0.9531 | 3931.0 samples/s | 61.4 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05630 | Reg=0.00258 | L2-Norm=16.053 | L2-Norm(final)=2.305 | acc=0.9844 | 3910.3 samples/s | 61.1 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05519 | Reg=0.00259 | L2-Norm=16.078 | L2-Norm(final)=2.307 | acc=0.9688 | 3952.3 samples/s | 61.8 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05405 | Reg=0.00259 | L2-Norm=16.102 | L2-Norm(final)=2.308 | acc=0.9844 | 3916.4 samples/s | 61.2 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05300 | Reg=0.00260 | L2-Norm=16.124 | L2-Norm(final)=2.310 | acc=1.0000 | 3897.4 samples/s | 60.9 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05258 | Reg=0.00261 | L2-Norm=16.145 | L2-Norm(final)=2.312 | acc=0.9688 | 3926.5 samples/s | 61.4 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05188 | Reg=0.00261 | L2-Norm=16.166 | L2-Norm(final)=2.313 | acc=0.9688 | 3905.0 samples/s | 61.0 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05137 | Reg=0.00262 | L2-Norm=16.186 | L2-Norm(final)=2.314 | acc=0.9844 | 3835.9 samples/s | 59.9 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05133 | Reg=0.00263 | L2-Norm=16.204 | L2-Norm(final)=2.314 | acc=0.9844 | 3893.5 samples/s | 60.8 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05108 | Reg=0.00263 | L2-Norm=16.223 | L2-Norm(final)=2.314 | acc=0.9531 | 3955.0 samples/s | 61.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.03146 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.303 | acc=0.9688 | 3093.5 samples/s | 48.3 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.01115 | Reg=0.00249 | L2-Norm=15.777 | L2-Norm(final)=2.322 | acc=1.0000 | 4506.2 samples/s | 70.4 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00766 | Reg=0.00250 | L2-Norm=15.807 | L2-Norm(final)=2.312 | acc=1.0000 | 4818.8 samples/s | 75.3 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00537 | Reg=0.00250 | L2-Norm=15.808 | L2-Norm(final)=2.314 | acc=1.0000 | 4774.5 samples/s | 74.6 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00446 | Reg=0.00249 | L2-Norm=15.795 | L2-Norm(final)=2.318 | acc=0.9844 | 4651.3 samples/s | 72.7 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00383 | Reg=0.00249 | L2-Norm=15.778 | L2-Norm(final)=2.322 | acc=1.0000 | 4807.2 samples/s | 75.1 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00378 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.326 | acc=1.0000 | 4731.2 samples/s | 73.9 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00390 | Reg=0.00248 | L2-Norm=15.756 | L2-Norm(final)=2.327 | acc=1.0000 | 4726.1 samples/s | 73.8 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00416 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.328 | acc=1.0000 | 4851.5 samples/s | 75.8 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00418 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.324 | acc=1.0000 | 4840.8 samples/s | 75.6 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00416 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.321 | acc=1.0000 | 4834.9 samples/s | 75.5 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00400 | Reg=0.00248 | L2-Norm=15.748 | L2-Norm(final)=2.319 | acc=1.0000 | 1475.0 samples/s | 23.0 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00375 | Reg=0.00248 | L2-Norm=15.741 | L2-Norm(final)=2.318 | acc=1.0000 | 4840.3 samples/s | 75.6 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00362 | Reg=0.00248 | L2-Norm=15.733 | L2-Norm(final)=2.316 | acc=1.0000 | 4724.8 samples/s | 73.8 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00351 | Reg=0.00247 | L2-Norm=15.723 | L2-Norm(final)=2.315 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00338 | Reg=0.00247 | L2-Norm=15.712 | L2-Norm(final)=2.314 | acc=1.0000 | 4843.6 samples/s | 75.7 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00326 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.313 | acc=1.0000 | 4886.0 samples/s | 76.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.71429 | acc=0.5238 | tpr=0.3088 | fpr=0.0094 | 4548.3 samples/s | 17.8 steps/s
Avg test loss: 0.71727, Avg test acc: 0.52092, Avg tpr: 0.30757, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.21934 | acc=0.8910 | tpr=0.9779 | fpr=0.1105 | 4573.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.22219 | acc=0.8920 | tpr=0.9851 | fpr=0.1097 | 9793.4 samples/s | 38.3 steps/s
[Step= 150] | Loss=0.22639 | acc=0.8905 | tpr=0.9856 | fpr=0.1113 | 9120.3 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.22786 | acc=0.8900 | tpr=0.9858 | fpr=0.1118 | 9087.7 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.22820 | acc=0.8900 | tpr=0.9843 | fpr=0.1117 | 9197.0 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.22988 | acc=0.8898 | tpr=0.9825 | fpr=0.1118 | 9593.7 samples/s | 37.5 steps/s
[Step= 350] | Loss=0.23084 | acc=0.8898 | tpr=0.9818 | fpr=0.1119 | 8861.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.23194 | acc=0.8895 | tpr=0.9819 | fpr=0.1122 | 9196.1 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.23382 | acc=0.8888 | tpr=0.9820 | fpr=0.1129 | 9966.2 samples/s | 38.9 steps/s
[Step= 500] | Loss=0.23385 | acc=0.8885 | tpr=0.9824 | fpr=0.1132 | 8533.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.23291 | acc=0.8888 | tpr=0.9825 | fpr=0.1129 | 17701.8 samples/s | 69.1 steps/s
Avg test loss: 0.23269, Avg test acc: 0.88884, Avg tpr: 0.98217, Avg fpr: 0.11286, total FA: 15670

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.63725 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.301 | acc=0.5625 | 3607.2 samples/s | 56.4 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.09388 | Reg=0.00249 | L2-Norm=15.785 | L2-Norm(final)=2.285 | acc=1.0000 | 4856.9 samples/s | 75.9 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06943 | Reg=0.00251 | L2-Norm=15.857 | L2-Norm(final)=2.299 | acc=0.9531 | 4947.6 samples/s | 77.3 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06200 | Reg=0.00253 | L2-Norm=15.906 | L2-Norm(final)=2.308 | acc=0.9688 | 4917.9 samples/s | 76.8 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05842 | Reg=0.00254 | L2-Norm=15.943 | L2-Norm(final)=2.314 | acc=0.9844 | 4893.7 samples/s | 76.5 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05624 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.317 | acc=0.9375 | 4980.7 samples/s | 77.8 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05496 | Reg=0.00256 | L2-Norm=16.003 | L2-Norm(final)=2.318 | acc=1.0000 | 4995.7 samples/s | 78.1 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05388 | Reg=0.00257 | L2-Norm=16.028 | L2-Norm(final)=2.319 | acc=0.9688 | 4913.1 samples/s | 76.8 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05192 | Reg=0.00258 | L2-Norm=16.052 | L2-Norm(final)=2.323 | acc=0.9844 | 4891.8 samples/s | 76.4 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05166 | Reg=0.00258 | L2-Norm=16.073 | L2-Norm(final)=2.324 | acc=0.9375 | 5040.1 samples/s | 78.8 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05134 | Reg=0.00259 | L2-Norm=16.094 | L2-Norm(final)=2.324 | acc=0.9844 | 4183.5 samples/s | 65.4 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05037 | Reg=0.00260 | L2-Norm=16.114 | L2-Norm(final)=2.323 | acc=0.9375 | 3899.0 samples/s | 60.9 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05019 | Reg=0.00260 | L2-Norm=16.135 | L2-Norm(final)=2.323 | acc=0.9844 | 3927.0 samples/s | 61.4 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04935 | Reg=0.00261 | L2-Norm=16.156 | L2-Norm(final)=2.322 | acc=0.9531 | 3912.0 samples/s | 61.1 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04909 | Reg=0.00262 | L2-Norm=16.178 | L2-Norm(final)=2.322 | acc=0.9531 | 3944.7 samples/s | 61.6 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04872 | Reg=0.00263 | L2-Norm=16.201 | L2-Norm(final)=2.321 | acc=0.9531 | 3957.2 samples/s | 61.8 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04843 | Reg=0.00263 | L2-Norm=16.223 | L2-Norm(final)=2.321 | acc=0.9531 | 3923.6 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.01252 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.305 | acc=0.9844 | 3023.2 samples/s | 47.2 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00294 | Reg=0.00245 | L2-Norm=15.663 | L2-Norm(final)=2.326 | acc=1.0000 | 4469.2 samples/s | 69.8 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00301 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.333 | acc=1.0000 | 4856.3 samples/s | 75.9 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00228 | Reg=0.00244 | L2-Norm=15.636 | L2-Norm(final)=2.335 | acc=0.9844 | 4805.7 samples/s | 75.1 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00223 | Reg=0.00244 | L2-Norm=15.618 | L2-Norm(final)=2.337 | acc=1.0000 | 4863.7 samples/s | 76.0 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00242 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.338 | acc=1.0000 | 4861.6 samples/s | 76.0 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00261 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.336 | acc=1.0000 | 4718.1 samples/s | 73.7 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00338 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.331 | acc=0.9844 | 4777.7 samples/s | 74.7 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00368 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.323 | acc=1.0000 | 4730.2 samples/s | 73.9 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00335 | Reg=0.00243 | L2-Norm=15.603 | L2-Norm(final)=2.316 | acc=1.0000 | 4790.3 samples/s | 74.8 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00304 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.313 | acc=1.0000 | 4873.1 samples/s | 76.1 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00277 | Reg=0.00243 | L2-Norm=15.595 | L2-Norm(final)=2.310 | acc=1.0000 | 1462.7 samples/s | 22.9 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00258 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.308 | acc=1.0000 | 4713.1 samples/s | 73.6 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00238 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.307 | acc=1.0000 | 4890.3 samples/s | 76.4 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00222 | Reg=0.00242 | L2-Norm=15.554 | L2-Norm(final)=2.307 | acc=1.0000 | 4867.3 samples/s | 76.1 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00207 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.306 | acc=1.0000 | 4753.0 samples/s | 74.3 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00194 | Reg=0.00241 | L2-Norm=15.516 | L2-Norm(final)=2.306 | acc=1.0000 | 4910.7 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42309 | acc=0.6930 | tpr=0.5567 | fpr=0.0109 | 4653.4 samples/s | 18.2 steps/s
Avg test loss: 0.42683, Avg test acc: 0.68992, Avg tpr: 0.55482, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.35321 | acc=0.8137 | tpr=0.9867 | fpr=0.1894 | 4657.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.35593 | acc=0.8158 | tpr=0.9893 | fpr=0.1874 | 9119.9 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.35941 | acc=0.8149 | tpr=0.9870 | fpr=0.1883 | 8875.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.36117 | acc=0.8152 | tpr=0.9880 | fpr=0.1879 | 9350.8 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.36066 | acc=0.8155 | tpr=0.9886 | fpr=0.1877 | 9165.2 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.36322 | acc=0.8150 | tpr=0.9862 | fpr=0.1882 | 9614.2 samples/s | 37.6 steps/s
[Step= 350] | Loss=0.36392 | acc=0.8152 | tpr=0.9862 | fpr=0.1879 | 9069.8 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.36555 | acc=0.8151 | tpr=0.9869 | fpr=0.1880 | 9744.3 samples/s | 38.1 steps/s
[Step= 450] | Loss=0.36752 | acc=0.8149 | tpr=0.9869 | fpr=0.1882 | 8604.1 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.36758 | acc=0.8148 | tpr=0.9872 | fpr=0.1883 | 9182.9 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.36669 | acc=0.8148 | tpr=0.9881 | fpr=0.1884 | 17531.6 samples/s | 68.5 steps/s
Avg test loss: 0.36616, Avg test acc: 0.81491, Avg tpr: 0.98772, Avg fpr: 0.18823, total FA: 26136

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.30925 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.303 | acc=0.7969 | 3828.7 samples/s | 59.8 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.07640 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.292 | acc=0.9844 | 4950.3 samples/s | 77.3 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05963 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.306 | acc=0.9688 | 4889.1 samples/s | 76.4 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05442 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.311 | acc=0.9844 | 5002.8 samples/s | 78.2 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.05256 | Reg=0.00250 | L2-Norm=15.796 | L2-Norm(final)=2.313 | acc=0.9688 | 4903.5 samples/s | 76.6 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05273 | Reg=0.00250 | L2-Norm=15.825 | L2-Norm(final)=2.310 | acc=0.9375 | 4882.5 samples/s | 76.3 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05094 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.310 | acc=0.9844 | 5087.2 samples/s | 79.5 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04924 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.312 | acc=0.9844 | 5014.9 samples/s | 78.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04879 | Reg=0.00253 | L2-Norm=15.906 | L2-Norm(final)=2.312 | acc=0.9531 | 4897.1 samples/s | 76.5 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04738 | Reg=0.00254 | L2-Norm=15.930 | L2-Norm(final)=2.313 | acc=1.0000 | 5090.6 samples/s | 79.5 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04711 | Reg=0.00255 | L2-Norm=15.954 | L2-Norm(final)=2.313 | acc=0.9844 | 4917.3 samples/s | 76.8 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04648 | Reg=0.00255 | L2-Norm=15.979 | L2-Norm(final)=2.315 | acc=0.9844 | 4914.9 samples/s | 76.8 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04599 | Reg=0.00256 | L2-Norm=16.002 | L2-Norm(final)=2.315 | acc=0.9688 | 4948.7 samples/s | 77.3 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04537 | Reg=0.00257 | L2-Norm=16.026 | L2-Norm(final)=2.316 | acc=0.9688 | 5076.0 samples/s | 79.3 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04503 | Reg=0.00258 | L2-Norm=16.049 | L2-Norm(final)=2.317 | acc=0.9844 | 4819.6 samples/s | 75.3 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04471 | Reg=0.00258 | L2-Norm=16.071 | L2-Norm(final)=2.317 | acc=0.9375 | 5016.0 samples/s | 78.4 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04408 | Reg=0.00259 | L2-Norm=16.093 | L2-Norm(final)=2.318 | acc=0.9688 | 4899.5 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.04867 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.305 | acc=0.9531 | 3751.3 samples/s | 58.6 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00592 | Reg=0.00245 | L2-Norm=15.653 | L2-Norm(final)=2.317 | acc=1.0000 | 4414.1 samples/s | 69.0 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00602 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.318 | acc=0.9844 | 4901.3 samples/s | 76.6 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00534 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.308 | acc=1.0000 | 4736.4 samples/s | 74.0 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00415 | Reg=0.00246 | L2-Norm=15.697 | L2-Norm(final)=2.305 | acc=1.0000 | 4705.3 samples/s | 73.5 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00347 | Reg=0.00246 | L2-Norm=15.690 | L2-Norm(final)=2.306 | acc=1.0000 | 4443.9 samples/s | 69.4 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00341 | Reg=0.00246 | L2-Norm=15.678 | L2-Norm(final)=2.307 | acc=1.0000 | 3769.2 samples/s | 58.9 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00342 | Reg=0.00245 | L2-Norm=15.667 | L2-Norm(final)=2.305 | acc=0.9688 | 3699.9 samples/s | 57.8 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00325 | Reg=0.00245 | L2-Norm=15.654 | L2-Norm(final)=2.302 | acc=1.0000 | 3799.8 samples/s | 59.4 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00328 | Reg=0.00245 | L2-Norm=15.642 | L2-Norm(final)=2.300 | acc=0.9531 | 3731.3 samples/s | 58.3 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00325 | Reg=0.00244 | L2-Norm=15.635 | L2-Norm(final)=2.296 | acc=1.0000 | 3775.6 samples/s | 59.0 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00321 | Reg=0.00244 | L2-Norm=15.629 | L2-Norm(final)=2.294 | acc=1.0000 | 1508.2 samples/s | 23.6 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00313 | Reg=0.00244 | L2-Norm=15.622 | L2-Norm(final)=2.291 | acc=1.0000 | 4886.5 samples/s | 76.4 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00309 | Reg=0.00244 | L2-Norm=15.613 | L2-Norm(final)=2.288 | acc=1.0000 | 4873.5 samples/s | 76.1 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00289 | Reg=0.00243 | L2-Norm=15.603 | L2-Norm(final)=2.286 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00272 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.284 | acc=1.0000 | 4856.6 samples/s | 75.9 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00256 | Reg=0.00243 | L2-Norm=15.577 | L2-Norm(final)=2.284 | acc=1.0000 | 4705.8 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.90693 | acc=0.4725 | tpr=0.2306 | fpr=0.0022 | 4598.3 samples/s | 18.0 steps/s
Avg test loss: 0.91240, Avg test acc: 0.46735, Avg tpr: 0.22632, Avg fpr: 0.00256, total FA: 20

Testing server on iccad2012
[Step=  50] | Loss=0.18543 | acc=0.9159 | tpr=0.9779 | fpr=0.0852 | 4704.0 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.19090 | acc=0.9134 | tpr=0.9851 | fpr=0.0879 | 8747.8 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.19555 | acc=0.9124 | tpr=0.9841 | fpr=0.0889 | 9297.9 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.19675 | acc=0.9122 | tpr=0.9858 | fpr=0.0891 | 9231.0 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.19631 | acc=0.9120 | tpr=0.9834 | fpr=0.0893 | 9579.0 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.19839 | acc=0.9119 | tpr=0.9818 | fpr=0.0894 | 9092.2 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.19976 | acc=0.9116 | tpr=0.9812 | fpr=0.0897 | 9220.0 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.20126 | acc=0.9111 | tpr=0.9814 | fpr=0.0901 | 9332.9 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.20327 | acc=0.9108 | tpr=0.9810 | fpr=0.0905 | 9095.4 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.20302 | acc=0.9106 | tpr=0.9811 | fpr=0.0906 | 9062.5 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.20197 | acc=0.9109 | tpr=0.9805 | fpr=0.0904 | 17101.7 samples/s | 66.8 steps/s
Avg test loss: 0.20167, Avg test acc: 0.91094, Avg tpr: 0.98019, Avg fpr: 0.09031, total FA: 12540

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.53358 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.291 | acc=0.6719 | 3953.6 samples/s | 61.8 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.09889 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.254 | acc=0.9375 | 4526.1 samples/s | 70.7 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.07491 | Reg=0.00248 | L2-Norm=15.755 | L2-Norm(final)=2.269 | acc=0.9531 | 4978.8 samples/s | 77.8 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.06552 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.279 | acc=0.9844 | 5001.9 samples/s | 78.2 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05979 | Reg=0.00251 | L2-Norm=15.849 | L2-Norm(final)=2.283 | acc=0.9219 | 4837.4 samples/s | 75.6 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05677 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.286 | acc=0.9844 | 4936.6 samples/s | 77.1 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.05321 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.289 | acc=0.9844 | 5026.1 samples/s | 78.5 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.05101 | Reg=0.00254 | L2-Norm=15.939 | L2-Norm(final)=2.292 | acc=0.9844 | 4859.2 samples/s | 75.9 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04938 | Reg=0.00255 | L2-Norm=15.967 | L2-Norm(final)=2.295 | acc=0.9844 | 4972.4 samples/s | 77.7 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04830 | Reg=0.00256 | L2-Norm=15.995 | L2-Norm(final)=2.298 | acc=0.9531 | 4857.3 samples/s | 75.9 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04723 | Reg=0.00257 | L2-Norm=16.022 | L2-Norm(final)=2.300 | acc=0.9531 | 4105.8 samples/s | 64.2 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04652 | Reg=0.00258 | L2-Norm=16.047 | L2-Norm(final)=2.302 | acc=0.9375 | 3889.4 samples/s | 60.8 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04564 | Reg=0.00258 | L2-Norm=16.073 | L2-Norm(final)=2.304 | acc=1.0000 | 3888.8 samples/s | 60.8 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04514 | Reg=0.00259 | L2-Norm=16.097 | L2-Norm(final)=2.305 | acc=0.9688 | 3905.6 samples/s | 61.0 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04436 | Reg=0.00260 | L2-Norm=16.120 | L2-Norm(final)=2.306 | acc=0.9688 | 3914.1 samples/s | 61.2 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04394 | Reg=0.00261 | L2-Norm=16.143 | L2-Norm(final)=2.306 | acc=0.9844 | 3919.1 samples/s | 61.2 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04344 | Reg=0.00261 | L2-Norm=16.166 | L2-Norm(final)=2.308 | acc=0.9844 | 3887.2 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.00511 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.295 | acc=1.0000 | 3175.4 samples/s | 49.6 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00592 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.299 | acc=1.0000 | 4091.2 samples/s | 63.9 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00307 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.312 | acc=1.0000 | 4832.4 samples/s | 75.5 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00210 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.320 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00161 | Reg=0.00241 | L2-Norm=15.521 | L2-Norm(final)=2.326 | acc=1.0000 | 4817.3 samples/s | 75.3 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00134 | Reg=0.00240 | L2-Norm=15.493 | L2-Norm(final)=2.331 | acc=1.0000 | 4727.0 samples/s | 73.9 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00112 | Reg=0.00239 | L2-Norm=15.464 | L2-Norm(final)=2.336 | acc=1.0000 | 4835.3 samples/s | 75.6 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00096 | Reg=0.00238 | L2-Norm=15.433 | L2-Norm(final)=2.339 | acc=1.0000 | 4699.0 samples/s | 73.4 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00085 | Reg=0.00237 | L2-Norm=15.401 | L2-Norm(final)=2.343 | acc=1.0000 | 4784.5 samples/s | 74.8 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00088 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.346 | acc=1.0000 | 4668.6 samples/s | 72.9 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00101 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.349 | acc=1.0000 | 4838.3 samples/s | 75.6 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00144 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.348 | acc=1.0000 | 1495.2 samples/s | 23.4 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00147 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.347 | acc=1.0000 | 4858.6 samples/s | 75.9 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00142 | Reg=0.00235 | L2-Norm=15.319 | L2-Norm(final)=2.346 | acc=1.0000 | 4808.4 samples/s | 75.1 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00134 | Reg=0.00234 | L2-Norm=15.308 | L2-Norm(final)=2.346 | acc=1.0000 | 4700.3 samples/s | 73.4 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00127 | Reg=0.00234 | L2-Norm=15.296 | L2-Norm(final)=2.347 | acc=1.0000 | 4749.6 samples/s | 74.2 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00119 | Reg=0.00234 | L2-Norm=15.282 | L2-Norm(final)=2.348 | acc=1.0000 | 4882.2 samples/s | 76.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46520 | acc=0.6604 | tpr=0.5082 | fpr=0.0092 | 4607.1 samples/s | 18.0 steps/s
Avg test loss: 0.46490, Avg test acc: 0.66051, Avg tpr: 0.51046, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.26591 | acc=0.8709 | tpr=0.9735 | fpr=0.1310 | 4518.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.27338 | acc=0.8682 | tpr=0.9787 | fpr=0.1339 | 9013.4 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.27799 | acc=0.8669 | tpr=0.9813 | fpr=0.1352 | 10421.6 samples/s | 40.7 steps/s
[Step= 200] | Loss=0.28018 | acc=0.8667 | tpr=0.9825 | fpr=0.1354 | 8259.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.28008 | acc=0.8666 | tpr=0.9817 | fpr=0.1355 | 9482.1 samples/s | 37.0 steps/s
[Step= 300] | Loss=0.28234 | acc=0.8659 | tpr=0.9796 | fpr=0.1362 | 9849.5 samples/s | 38.5 steps/s
[Step= 350] | Loss=0.28476 | acc=0.8658 | tpr=0.9806 | fpr=0.1363 | 8733.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.28635 | acc=0.8654 | tpr=0.9814 | fpr=0.1367 | 9087.5 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.28853 | acc=0.8652 | tpr=0.9810 | fpr=0.1369 | 9179.9 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.28798 | acc=0.8653 | tpr=0.9819 | fpr=0.1368 | 9322.9 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.28740 | acc=0.8652 | tpr=0.9825 | fpr=0.1369 | 17458.6 samples/s | 68.2 steps/s
Avg test loss: 0.28704, Avg test acc: 0.86531, Avg tpr: 0.98257, Avg fpr: 0.13682, total FA: 18997

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.25566 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.333 | acc=0.7812 | 3556.0 samples/s | 55.6 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.07665 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.314 | acc=0.9375 | 4959.8 samples/s | 77.5 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.05974 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.322 | acc=0.9688 | 4892.4 samples/s | 76.4 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.05388 | Reg=0.00246 | L2-Norm=15.689 | L2-Norm(final)=2.329 | acc=0.9688 | 4515.5 samples/s | 70.6 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.04890 | Reg=0.00248 | L2-Norm=15.732 | L2-Norm(final)=2.336 | acc=0.9688 | 3913.7 samples/s | 61.2 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04683 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.340 | acc=0.9531 | 3886.3 samples/s | 60.7 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04551 | Reg=0.00250 | L2-Norm=15.802 | L2-Norm(final)=2.341 | acc=0.9531 | 3901.4 samples/s | 61.0 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04370 | Reg=0.00251 | L2-Norm=15.831 | L2-Norm(final)=2.341 | acc=0.9844 | 3919.5 samples/s | 61.2 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04350 | Reg=0.00252 | L2-Norm=15.858 | L2-Norm(final)=2.342 | acc=0.9531 | 3943.6 samples/s | 61.6 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04254 | Reg=0.00252 | L2-Norm=15.885 | L2-Norm(final)=2.341 | acc=0.9531 | 3869.5 samples/s | 60.5 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04239 | Reg=0.00253 | L2-Norm=15.911 | L2-Norm(final)=2.340 | acc=0.9844 | 3897.1 samples/s | 60.9 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04166 | Reg=0.00254 | L2-Norm=15.937 | L2-Norm(final)=2.341 | acc=0.9844 | 3902.7 samples/s | 61.0 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04115 | Reg=0.00255 | L2-Norm=15.963 | L2-Norm(final)=2.341 | acc=0.9531 | 3948.5 samples/s | 61.7 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04036 | Reg=0.00256 | L2-Norm=15.988 | L2-Norm(final)=2.343 | acc=1.0000 | 3923.2 samples/s | 61.3 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04046 | Reg=0.00256 | L2-Norm=16.012 | L2-Norm(final)=2.343 | acc=0.9219 | 3910.0 samples/s | 61.1 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04070 | Reg=0.00257 | L2-Norm=16.037 | L2-Norm(final)=2.343 | acc=0.9844 | 3903.4 samples/s | 61.0 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04085 | Reg=0.00258 | L2-Norm=16.062 | L2-Norm(final)=2.343 | acc=0.9375 | 3858.4 samples/s | 60.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.02494 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.335 | acc=0.9688 | 2911.7 samples/s | 45.5 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00832 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.341 | acc=1.0000 | 4551.9 samples/s | 71.1 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00614 | Reg=0.00244 | L2-Norm=15.607 | L2-Norm(final)=2.343 | acc=1.0000 | 4833.7 samples/s | 75.5 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00461 | Reg=0.00244 | L2-Norm=15.620 | L2-Norm(final)=2.344 | acc=1.0000 | 4703.7 samples/s | 73.5 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00397 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.344 | acc=1.0000 | 4817.7 samples/s | 75.3 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00364 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.342 | acc=1.0000 | 4801.4 samples/s | 75.0 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00399 | Reg=0.00244 | L2-Norm=15.621 | L2-Norm(final)=2.341 | acc=1.0000 | 4712.1 samples/s | 73.6 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00392 | Reg=0.00244 | L2-Norm=15.625 | L2-Norm(final)=2.336 | acc=1.0000 | 4816.8 samples/s | 75.3 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00352 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.332 | acc=1.0000 | 4738.2 samples/s | 74.0 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00316 | Reg=0.00244 | L2-Norm=15.624 | L2-Norm(final)=2.329 | acc=1.0000 | 4773.6 samples/s | 74.6 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00286 | Reg=0.00244 | L2-Norm=15.616 | L2-Norm(final)=2.328 | acc=1.0000 | 4922.6 samples/s | 76.9 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00268 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.328 | acc=1.0000 | 1477.5 samples/s | 23.1 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00248 | Reg=0.00243 | L2-Norm=15.594 | L2-Norm(final)=2.328 | acc=1.0000 | 4864.1 samples/s | 76.0 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00253 | Reg=0.00243 | L2-Norm=15.582 | L2-Norm(final)=2.328 | acc=1.0000 | 4771.3 samples/s | 74.6 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00257 | Reg=0.00243 | L2-Norm=15.573 | L2-Norm(final)=2.326 | acc=1.0000 | 4849.5 samples/s | 75.8 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00246 | Reg=0.00242 | L2-Norm=15.566 | L2-Norm(final)=2.324 | acc=1.0000 | 4850.5 samples/s | 75.8 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00232 | Reg=0.00242 | L2-Norm=15.557 | L2-Norm(final)=2.322 | acc=1.0000 | 4771.6 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.53527 | acc=0.6059 | tpr=0.4273 | fpr=0.0064 | 4607.8 samples/s | 18.0 steps/s
Avg test loss: 0.53931, Avg test acc: 0.60005, Avg tpr: 0.42099, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.24727 | acc=0.8888 | tpr=0.9779 | fpr=0.1129 | 4573.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.25163 | acc=0.8855 | tpr=0.9851 | fpr=0.1163 | 9159.9 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.25463 | acc=0.8848 | tpr=0.9841 | fpr=0.1171 | 9176.0 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.25540 | acc=0.8850 | tpr=0.9847 | fpr=0.1168 | 9384.5 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.25490 | acc=0.8849 | tpr=0.9843 | fpr=0.1169 | 9393.7 samples/s | 36.7 steps/s
[Step= 300] | Loss=0.25737 | acc=0.8839 | tpr=0.9833 | fpr=0.1179 | 9019.0 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.25886 | acc=0.8837 | tpr=0.9837 | fpr=0.1181 | 9211.7 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.26025 | acc=0.8833 | tpr=0.9830 | fpr=0.1185 | 9594.3 samples/s | 37.5 steps/s
[Step= 450] | Loss=0.26264 | acc=0.8827 | tpr=0.9834 | fpr=0.1191 | 8919.6 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.26258 | acc=0.8826 | tpr=0.9837 | fpr=0.1192 | 9130.6 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.26159 | acc=0.8831 | tpr=0.9833 | fpr=0.1188 | 17302.5 samples/s | 67.6 steps/s
Avg test loss: 0.26133, Avg test acc: 0.88314, Avg tpr: 0.98336, Avg fpr: 0.11868, total FA: 16479

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.43732 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.309 | acc=0.6562 | 3748.8 samples/s | 58.6 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.08613 | Reg=0.00243 | L2-Norm=15.602 | L2-Norm(final)=2.297 | acc=0.9844 | 4937.4 samples/s | 77.1 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.06179 | Reg=0.00244 | L2-Norm=15.634 | L2-Norm(final)=2.312 | acc=0.9375 | 4969.8 samples/s | 77.7 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.05098 | Reg=0.00245 | L2-Norm=15.652 | L2-Norm(final)=2.324 | acc=1.0000 | 4955.1 samples/s | 77.4 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04519 | Reg=0.00245 | L2-Norm=15.666 | L2-Norm(final)=2.333 | acc=0.9531 | 5031.8 samples/s | 78.6 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04156 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.339 | acc=0.9688 | 5063.8 samples/s | 79.1 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03932 | Reg=0.00246 | L2-Norm=15.687 | L2-Norm(final)=2.345 | acc=1.0000 | 4838.6 samples/s | 75.6 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03839 | Reg=0.00246 | L2-Norm=15.695 | L2-Norm(final)=2.349 | acc=0.9844 | 3975.7 samples/s | 62.1 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03752 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.351 | acc=0.9531 | 3934.5 samples/s | 61.5 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03659 | Reg=0.00247 | L2-Norm=15.710 | L2-Norm(final)=2.353 | acc=0.9844 | 3949.0 samples/s | 61.7 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03491 | Reg=0.00247 | L2-Norm=15.718 | L2-Norm(final)=2.356 | acc=1.0000 | 3915.9 samples/s | 61.2 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03408 | Reg=0.00247 | L2-Norm=15.725 | L2-Norm(final)=2.360 | acc=0.9844 | 3942.9 samples/s | 61.6 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03310 | Reg=0.00248 | L2-Norm=15.732 | L2-Norm(final)=2.363 | acc=0.9844 | 3919.6 samples/s | 61.2 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03248 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.366 | acc=0.9688 | 3936.2 samples/s | 61.5 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03219 | Reg=0.00248 | L2-Norm=15.745 | L2-Norm(final)=2.368 | acc=0.9844 | 3921.0 samples/s | 61.3 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03217 | Reg=0.00248 | L2-Norm=15.752 | L2-Norm(final)=2.370 | acc=1.0000 | 3917.7 samples/s | 61.2 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03174 | Reg=0.00248 | L2-Norm=15.759 | L2-Norm(final)=2.373 | acc=0.9688 | 3971.6 samples/s | 62.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.04315 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.311 | acc=0.9844 | 3650.5 samples/s | 57.0 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00321 | Reg=0.00242 | L2-Norm=15.557 | L2-Norm(final)=2.330 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00177 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.340 | acc=1.0000 | 4883.0 samples/s | 76.3 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00129 | Reg=0.00241 | L2-Norm=15.540 | L2-Norm(final)=2.346 | acc=1.0000 | 4768.0 samples/s | 74.5 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00102 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.350 | acc=1.0000 | 4747.6 samples/s | 74.2 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00085 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.354 | acc=1.0000 | 4694.4 samples/s | 73.3 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00072 | Reg=0.00240 | L2-Norm=15.494 | L2-Norm(final)=2.357 | acc=1.0000 | 4817.2 samples/s | 75.3 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00064 | Reg=0.00240 | L2-Norm=15.478 | L2-Norm(final)=2.360 | acc=1.0000 | 4844.3 samples/s | 75.7 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00057 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.363 | acc=1.0000 | 4832.1 samples/s | 75.5 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00051 | Reg=0.00239 | L2-Norm=15.446 | L2-Norm(final)=2.365 | acc=1.0000 | 4909.1 samples/s | 76.7 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00046 | Reg=0.00238 | L2-Norm=15.429 | L2-Norm(final)=2.367 | acc=1.0000 | 4855.3 samples/s | 75.9 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00042 | Reg=0.00238 | L2-Norm=15.412 | L2-Norm(final)=2.369 | acc=1.0000 | 1516.2 samples/s | 23.7 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00039 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.370 | acc=1.0000 | 4900.5 samples/s | 76.6 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00036 | Reg=0.00236 | L2-Norm=15.378 | L2-Norm(final)=2.372 | acc=1.0000 | 4774.0 samples/s | 74.6 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00033 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.373 | acc=1.0000 | 4906.4 samples/s | 76.7 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00031 | Reg=0.00235 | L2-Norm=15.342 | L2-Norm(final)=2.374 | acc=1.0000 | 4786.6 samples/s | 74.8 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00029 | Reg=0.00235 | L2-Norm=15.324 | L2-Norm(final)=2.375 | acc=1.0000 | 4872.7 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36806 | acc=0.7628 | tpr=0.6568 | fpr=0.0069 | 4615.7 samples/s | 18.0 steps/s
Avg test loss: 0.37028, Avg test acc: 0.75940, Avg tpr: 0.65297, Avg fpr: 0.00654, total FA: 51

Testing server on iccad2012
[Step=  50] | Loss=0.47965 | acc=0.8109 | tpr=0.9823 | fpr=0.1922 | 4554.7 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.48607 | acc=0.8087 | tpr=0.9851 | fpr=0.1946 | 9297.6 samples/s | 36.3 steps/s
[Step= 150] | Loss=0.48995 | acc=0.8087 | tpr=0.9856 | fpr=0.1945 | 9134.6 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.49021 | acc=0.8090 | tpr=0.9869 | fpr=0.1943 | 9332.5 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.49045 | acc=0.8091 | tpr=0.9878 | fpr=0.1941 | 9256.1 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.49386 | acc=0.8091 | tpr=0.9876 | fpr=0.1942 | 9222.6 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.49615 | acc=0.8092 | tpr=0.9887 | fpr=0.1940 | 9278.0 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.49838 | acc=0.8091 | tpr=0.9880 | fpr=0.1942 | 9116.5 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.50137 | acc=0.8090 | tpr=0.9878 | fpr=0.1943 | 9353.8 samples/s | 36.5 steps/s
[Step= 500] | Loss=0.50174 | acc=0.8084 | tpr=0.9877 | fpr=0.1949 | 9345.0 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.50028 | acc=0.8088 | tpr=0.9881 | fpr=0.1945 | 16282.3 samples/s | 63.6 steps/s
Avg test loss: 0.49986, Avg test acc: 0.80886, Avg tpr: 0.98811, Avg fpr: 0.19440, total FA: 26992

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.22671 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.397 | acc=0.8594 | 3671.1 samples/s | 57.4 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.05248 | Reg=0.00237 | L2-Norm=15.401 | L2-Norm(final)=2.380 | acc=0.9844 | 4844.7 samples/s | 75.7 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03839 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.391 | acc=0.9531 | 4851.6 samples/s | 75.8 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03379 | Reg=0.00239 | L2-Norm=15.445 | L2-Norm(final)=2.400 | acc=0.9688 | 4860.8 samples/s | 76.0 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03179 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.405 | acc=0.9688 | 4981.5 samples/s | 77.8 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03101 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.409 | acc=0.9688 | 4942.4 samples/s | 77.2 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02964 | Reg=0.00240 | L2-Norm=15.479 | L2-Norm(final)=2.413 | acc=0.9844 | 5000.6 samples/s | 78.1 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02907 | Reg=0.00240 | L2-Norm=15.487 | L2-Norm(final)=2.416 | acc=0.9844 | 4923.9 samples/s | 76.9 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02877 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.419 | acc=0.9688 | 5036.4 samples/s | 78.7 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02844 | Reg=0.00240 | L2-Norm=15.503 | L2-Norm(final)=2.420 | acc=0.9531 | 5044.2 samples/s | 78.8 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02799 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.422 | acc=0.9844 | 4848.6 samples/s | 75.8 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02803 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.424 | acc=0.9688 | 4827.1 samples/s | 75.4 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02735 | Reg=0.00241 | L2-Norm=15.524 | L2-Norm(final)=2.426 | acc=0.9844 | 4960.0 samples/s | 77.5 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02723 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.429 | acc=0.9688 | 4874.9 samples/s | 76.2 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02694 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.430 | acc=0.9844 | 5002.6 samples/s | 78.2 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02651 | Reg=0.00242 | L2-Norm=15.542 | L2-Norm(final)=2.432 | acc=0.9531 | 5037.9 samples/s | 78.7 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02607 | Reg=0.00242 | L2-Norm=15.549 | L2-Norm(final)=2.434 | acc=0.9688 | 4944.0 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.13745 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.397 | acc=0.8906 | 3559.0 samples/s | 55.6 steps/s
[Step=8850 Epoch=16.7] | Loss=0.01019 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.375 | acc=1.0000 | 4732.3 samples/s | 73.9 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00535 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.372 | acc=1.0000 | 4653.2 samples/s | 72.7 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00386 | Reg=0.00240 | L2-Norm=15.476 | L2-Norm(final)=2.374 | acc=1.0000 | 4899.7 samples/s | 76.6 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00297 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.375 | acc=1.0000 | 4746.6 samples/s | 74.2 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00240 | Reg=0.00239 | L2-Norm=15.460 | L2-Norm(final)=2.378 | acc=1.0000 | 4770.3 samples/s | 74.5 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00201 | Reg=0.00239 | L2-Norm=15.448 | L2-Norm(final)=2.380 | acc=1.0000 | 4786.0 samples/s | 74.8 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00173 | Reg=0.00238 | L2-Norm=15.436 | L2-Norm(final)=2.382 | acc=1.0000 | 4855.5 samples/s | 75.9 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00153 | Reg=0.00238 | L2-Norm=15.423 | L2-Norm(final)=2.383 | acc=1.0000 | 4703.2 samples/s | 73.5 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00136 | Reg=0.00237 | L2-Norm=15.409 | L2-Norm(final)=2.385 | acc=1.0000 | 4744.7 samples/s | 74.1 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00124 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.386 | acc=1.0000 | 4777.5 samples/s | 74.6 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00113 | Reg=0.00237 | L2-Norm=15.380 | L2-Norm(final)=2.388 | acc=1.0000 | 1477.8 samples/s | 23.1 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00104 | Reg=0.00236 | L2-Norm=15.366 | L2-Norm(final)=2.389 | acc=1.0000 | 4929.5 samples/s | 77.0 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00096 | Reg=0.00236 | L2-Norm=15.351 | L2-Norm(final)=2.391 | acc=1.0000 | 4832.5 samples/s | 75.5 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00089 | Reg=0.00235 | L2-Norm=15.336 | L2-Norm(final)=2.392 | acc=1.0000 | 4769.4 samples/s | 74.5 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00083 | Reg=0.00235 | L2-Norm=15.321 | L2-Norm(final)=2.393 | acc=1.0000 | 4792.4 samples/s | 74.9 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00078 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.394 | acc=1.0000 | 4791.8 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47144 | acc=0.7043 | tpr=0.5707 | fpr=0.0057 | 4523.5 samples/s | 17.7 steps/s
Avg test loss: 0.47581, Avg test acc: 0.69933, Avg tpr: 0.56548, Avg fpr: 0.00628, total FA: 49

Testing server on iccad2012
[Step=  50] | Loss=0.34227 | acc=0.8824 | tpr=0.9779 | fpr=0.1193 | 4624.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.34629 | acc=0.8806 | tpr=0.9829 | fpr=0.1213 | 9264.0 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.35173 | acc=0.8796 | tpr=0.9841 | fpr=0.1224 | 8985.3 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.35380 | acc=0.8795 | tpr=0.9858 | fpr=0.1225 | 9133.5 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.35348 | acc=0.8798 | tpr=0.9843 | fpr=0.1221 | 9529.9 samples/s | 37.2 steps/s
[Step= 300] | Loss=0.35673 | acc=0.8793 | tpr=0.9833 | fpr=0.1226 | 9509.1 samples/s | 37.1 steps/s
[Step= 350] | Loss=0.35916 | acc=0.8790 | tpr=0.9837 | fpr=0.1229 | 9070.7 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.36142 | acc=0.8787 | tpr=0.9830 | fpr=0.1232 | 9274.0 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.36504 | acc=0.8783 | tpr=0.9834 | fpr=0.1236 | 8954.4 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.36444 | acc=0.8780 | tpr=0.9833 | fpr=0.1239 | 9300.2 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.36291 | acc=0.8783 | tpr=0.9841 | fpr=0.1237 | 17041.9 samples/s | 66.6 steps/s
Avg test loss: 0.36257, Avg test acc: 0.87834, Avg tpr: 0.98415, Avg fpr: 0.12359, total FA: 17160

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.30634 | Reg=0.00232 | L2-Norm=15.227 | L2-Norm(final)=2.435 | acc=0.7969 | 3753.6 samples/s | 58.7 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.05031 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.421 | acc=1.0000 | 4601.3 samples/s | 71.9 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03665 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.431 | acc=1.0000 | 5046.9 samples/s | 78.9 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03292 | Reg=0.00236 | L2-Norm=15.351 | L2-Norm(final)=2.439 | acc=0.9375 | 4933.9 samples/s | 77.1 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03050 | Reg=0.00236 | L2-Norm=15.367 | L2-Norm(final)=2.445 | acc=0.9688 | 5020.2 samples/s | 78.4 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02912 | Reg=0.00237 | L2-Norm=15.381 | L2-Norm(final)=2.449 | acc=0.9844 | 4921.0 samples/s | 76.9 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02772 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.454 | acc=0.9844 | 5104.5 samples/s | 79.8 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02655 | Reg=0.00237 | L2-Norm=15.404 | L2-Norm(final)=2.458 | acc=1.0000 | 5149.5 samples/s | 80.5 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02578 | Reg=0.00238 | L2-Norm=15.414 | L2-Norm(final)=2.463 | acc=0.9844 | 4861.2 samples/s | 76.0 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02539 | Reg=0.00238 | L2-Norm=15.423 | L2-Norm(final)=2.466 | acc=0.9844 | 4920.5 samples/s | 76.9 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02551 | Reg=0.00238 | L2-Norm=15.432 | L2-Norm(final)=2.469 | acc=1.0000 | 5025.5 samples/s | 78.5 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02553 | Reg=0.00238 | L2-Norm=15.440 | L2-Norm(final)=2.472 | acc=1.0000 | 5009.5 samples/s | 78.3 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02527 | Reg=0.00239 | L2-Norm=15.447 | L2-Norm(final)=2.474 | acc=1.0000 | 4568.7 samples/s | 71.4 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02519 | Reg=0.00239 | L2-Norm=15.454 | L2-Norm(final)=2.476 | acc=0.9531 | 3907.9 samples/s | 61.1 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02499 | Reg=0.00239 | L2-Norm=15.461 | L2-Norm(final)=2.478 | acc=0.9531 | 3894.9 samples/s | 60.9 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02455 | Reg=0.00239 | L2-Norm=15.468 | L2-Norm(final)=2.480 | acc=0.9844 | 3897.4 samples/s | 60.9 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02418 | Reg=0.00239 | L2-Norm=15.475 | L2-Norm(final)=2.483 | acc=1.0000 | 3948.1 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.06400 | Reg=0.00232 | L2-Norm=15.227 | L2-Norm(final)=2.435 | acc=0.9531 | 3928.7 samples/s | 61.4 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00952 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.418 | acc=1.0000 | 4310.7 samples/s | 67.4 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00571 | Reg=0.00235 | L2-Norm=15.341 | L2-Norm(final)=2.416 | acc=1.0000 | 4747.9 samples/s | 74.2 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00405 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.417 | acc=1.0000 | 4755.7 samples/s | 74.3 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00321 | Reg=0.00236 | L2-Norm=15.347 | L2-Norm(final)=2.420 | acc=1.0000 | 4681.7 samples/s | 73.2 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00261 | Reg=0.00235 | L2-Norm=15.342 | L2-Norm(final)=2.423 | acc=1.0000 | 4925.5 samples/s | 77.0 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00218 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.425 | acc=1.0000 | 4813.0 samples/s | 75.2 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00188 | Reg=0.00235 | L2-Norm=15.324 | L2-Norm(final)=2.428 | acc=1.0000 | 4704.0 samples/s | 73.5 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00165 | Reg=0.00234 | L2-Norm=15.313 | L2-Norm(final)=2.430 | acc=1.0000 | 4884.6 samples/s | 76.3 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00147 | Reg=0.00234 | L2-Norm=15.301 | L2-Norm(final)=2.431 | acc=1.0000 | 4824.4 samples/s | 75.4 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00132 | Reg=0.00234 | L2-Norm=15.288 | L2-Norm(final)=2.433 | acc=1.0000 | 4842.1 samples/s | 75.7 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00124 | Reg=0.00233 | L2-Norm=15.275 | L2-Norm(final)=2.435 | acc=1.0000 | 1509.2 samples/s | 23.6 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00113 | Reg=0.00233 | L2-Norm=15.262 | L2-Norm(final)=2.436 | acc=1.0000 | 4492.4 samples/s | 70.2 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00105 | Reg=0.00233 | L2-Norm=15.249 | L2-Norm(final)=2.438 | acc=1.0000 | 4606.8 samples/s | 72.0 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00098 | Reg=0.00232 | L2-Norm=15.235 | L2-Norm(final)=2.439 | acc=1.0000 | 4775.2 samples/s | 74.6 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00091 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.440 | acc=1.0000 | 4793.0 samples/s | 74.9 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00085 | Reg=0.00231 | L2-Norm=15.207 | L2-Norm(final)=2.441 | acc=1.0000 | 4599.2 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52370 | acc=0.6884 | tpr=0.5472 | fpr=0.0052 | 4412.0 samples/s | 17.2 steps/s
Avg test loss: 0.52922, Avg test acc: 0.68531, Avg tpr: 0.54468, Avg fpr: 0.00538, total FA: 42

Testing server on iccad2012
[Step=  50] | Loss=0.37768 | acc=0.8724 | tpr=0.9779 | fpr=0.1295 | 4593.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.38377 | acc=0.8709 | tpr=0.9808 | fpr=0.1311 | 9261.0 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.38935 | acc=0.8695 | tpr=0.9827 | fpr=0.1326 | 9412.5 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.39066 | acc=0.8698 | tpr=0.9847 | fpr=0.1323 | 9257.2 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.39036 | acc=0.8695 | tpr=0.9834 | fpr=0.1325 | 9115.7 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.39336 | acc=0.8694 | tpr=0.9811 | fpr=0.1327 | 9923.9 samples/s | 38.8 steps/s
[Step= 350] | Loss=0.39605 | acc=0.8692 | tpr=0.9825 | fpr=0.1329 | 8663.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.39840 | acc=0.8688 | tpr=0.9819 | fpr=0.1333 | 9241.8 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.40153 | acc=0.8685 | tpr=0.9815 | fpr=0.1336 | 9564.0 samples/s | 37.4 steps/s
[Step= 500] | Loss=0.40107 | acc=0.8684 | tpr=0.9815 | fpr=0.1337 | 8899.4 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.39932 | acc=0.8687 | tpr=0.9829 | fpr=0.1333 | 17579.7 samples/s | 68.7 steps/s
Avg test loss: 0.39898, Avg test acc: 0.86879, Avg tpr: 0.98296, Avg fpr: 0.13328, total FA: 18506

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.32428 | Reg=0.00230 | L2-Norm=15.150 | L2-Norm(final)=2.485 | acc=0.7812 | 3806.8 samples/s | 59.5 steps/s
[Step=10450 Epoch=10.2] | Loss=0.04638 | Reg=0.00232 | L2-Norm=15.227 | L2-Norm(final)=2.472 | acc=0.9688 | 4740.6 samples/s | 74.1 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03294 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.484 | acc=1.0000 | 5046.6 samples/s | 78.9 steps/s
[Step=10550 Epoch=10.3] | Loss=0.02795 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.494 | acc=0.9844 | 4998.9 samples/s | 78.1 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02682 | Reg=0.00234 | L2-Norm=15.293 | L2-Norm(final)=2.500 | acc=1.0000 | 4982.9 samples/s | 77.9 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02626 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.504 | acc=0.9844 | 5023.7 samples/s | 78.5 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02529 | Reg=0.00235 | L2-Norm=15.315 | L2-Norm(final)=2.508 | acc=0.9688 | 4995.7 samples/s | 78.1 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02539 | Reg=0.00235 | L2-Norm=15.324 | L2-Norm(final)=2.511 | acc=0.9531 | 5075.5 samples/s | 79.3 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02579 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.513 | acc=0.9844 | 4840.1 samples/s | 75.6 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02562 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.516 | acc=0.9688 | 3934.4 samples/s | 61.5 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02528 | Reg=0.00236 | L2-Norm=15.352 | L2-Norm(final)=2.518 | acc=0.9844 | 3941.2 samples/s | 61.6 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02530 | Reg=0.00236 | L2-Norm=15.361 | L2-Norm(final)=2.521 | acc=0.9688 | 3951.6 samples/s | 61.7 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02511 | Reg=0.00236 | L2-Norm=15.369 | L2-Norm(final)=2.523 | acc=1.0000 | 3954.1 samples/s | 61.8 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02484 | Reg=0.00236 | L2-Norm=15.377 | L2-Norm(final)=2.525 | acc=1.0000 | 3940.3 samples/s | 61.6 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02443 | Reg=0.00237 | L2-Norm=15.385 | L2-Norm(final)=2.528 | acc=0.9844 | 3929.9 samples/s | 61.4 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02416 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.531 | acc=1.0000 | 3902.3 samples/s | 61.0 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02424 | Reg=0.00237 | L2-Norm=15.400 | L2-Norm(final)=2.533 | acc=0.9844 | 3911.8 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.00726 | Reg=0.00230 | L2-Norm=15.150 | L2-Norm(final)=2.487 | acc=1.0000 | 2991.9 samples/s | 46.7 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00414 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.488 | acc=1.0000 | 4448.7 samples/s | 69.5 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00242 | Reg=0.00232 | L2-Norm=15.235 | L2-Norm(final)=2.489 | acc=1.0000 | 4728.9 samples/s | 73.9 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00166 | Reg=0.00232 | L2-Norm=15.230 | L2-Norm(final)=2.491 | acc=1.0000 | 4830.2 samples/s | 75.5 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00127 | Reg=0.00232 | L2-Norm=15.220 | L2-Norm(final)=2.495 | acc=1.0000 | 4723.5 samples/s | 73.8 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00102 | Reg=0.00231 | L2-Norm=15.207 | L2-Norm(final)=2.497 | acc=1.0000 | 4938.7 samples/s | 77.2 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00086 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.499 | acc=1.0000 | 4944.1 samples/s | 77.3 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00075 | Reg=0.00230 | L2-Norm=15.178 | L2-Norm(final)=2.502 | acc=1.0000 | 4819.8 samples/s | 75.3 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00067 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.504 | acc=1.0000 | 4774.2 samples/s | 74.6 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00060 | Reg=0.00229 | L2-Norm=15.148 | L2-Norm(final)=2.506 | acc=1.0000 | 4797.9 samples/s | 75.0 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00054 | Reg=0.00229 | L2-Norm=15.133 | L2-Norm(final)=2.508 | acc=1.0000 | 4748.5 samples/s | 74.2 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00049 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.509 | acc=1.0000 | 1495.2 samples/s | 23.4 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00045 | Reg=0.00228 | L2-Norm=15.102 | L2-Norm(final)=2.511 | acc=1.0000 | 4730.6 samples/s | 73.9 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00042 | Reg=0.00228 | L2-Norm=15.085 | L2-Norm(final)=2.512 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00039 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.513 | acc=1.0000 | 4760.3 samples/s | 74.4 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00036 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.515 | acc=1.0000 | 4829.0 samples/s | 75.5 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00034 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.516 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44142 | acc=0.7245 | tpr=0.6006 | fpr=0.0064 | 4533.4 samples/s | 17.7 steps/s
Avg test loss: 0.44541, Avg test acc: 0.72121, Avg tpr: 0.59760, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.35716 | acc=0.8782 | tpr=0.9823 | fpr=0.1237 | 4581.9 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.36345 | acc=0.8773 | tpr=0.9829 | fpr=0.1246 | 9364.2 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.36873 | acc=0.8758 | tpr=0.9841 | fpr=0.1262 | 9186.4 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.37107 | acc=0.8754 | tpr=0.9858 | fpr=0.1266 | 9102.0 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.37076 | acc=0.8755 | tpr=0.9852 | fpr=0.1265 | 9552.2 samples/s | 37.3 steps/s
[Step= 300] | Loss=0.37350 | acc=0.8753 | tpr=0.9833 | fpr=0.1266 | 9246.4 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.37605 | acc=0.8745 | tpr=0.9837 | fpr=0.1275 | 9249.0 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.37829 | acc=0.8738 | tpr=0.9830 | fpr=0.1282 | 9330.4 samples/s | 36.4 steps/s
[Step= 450] | Loss=0.38110 | acc=0.8735 | tpr=0.9830 | fpr=0.1285 | 9038.4 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.38065 | acc=0.8732 | tpr=0.9828 | fpr=0.1288 | 9711.1 samples/s | 37.9 steps/s
[Step= 550] | Loss=0.37912 | acc=0.8736 | tpr=0.9833 | fpr=0.1284 | 16161.1 samples/s | 63.1 steps/s
Avg test loss: 0.37876, Avg test acc: 0.87365, Avg tpr: 0.98336, Avg fpr: 0.12834, total FA: 17820

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.20778 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.545 | acc=0.8438 | 3556.4 samples/s | 55.6 steps/s
[Step=11250 Epoch=11.0] | Loss=0.04797 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.531 | acc=1.0000 | 5014.1 samples/s | 78.3 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03327 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.538 | acc=1.0000 | 4978.9 samples/s | 77.8 steps/s
[Step=11350 Epoch=11.1] | Loss=0.02857 | Reg=0.00230 | L2-Norm=15.150 | L2-Norm(final)=2.547 | acc=0.9844 | 4856.5 samples/s | 75.9 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02687 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.553 | acc=0.9688 | 4864.9 samples/s | 76.0 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02582 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.556 | acc=0.9844 | 4884.6 samples/s | 76.3 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02515 | Reg=0.00230 | L2-Norm=15.181 | L2-Norm(final)=2.559 | acc=0.9844 | 4956.4 samples/s | 77.4 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02450 | Reg=0.00231 | L2-Norm=15.189 | L2-Norm(final)=2.562 | acc=0.9844 | 4384.2 samples/s | 68.5 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02409 | Reg=0.00231 | L2-Norm=15.196 | L2-Norm(final)=2.564 | acc=0.9844 | 3934.9 samples/s | 61.5 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02348 | Reg=0.00231 | L2-Norm=15.204 | L2-Norm(final)=2.567 | acc=0.9844 | 3928.1 samples/s | 61.4 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02346 | Reg=0.00231 | L2-Norm=15.211 | L2-Norm(final)=2.569 | acc=0.9844 | 3915.2 samples/s | 61.2 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02290 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.572 | acc=0.9844 | 3894.9 samples/s | 60.9 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02277 | Reg=0.00232 | L2-Norm=15.226 | L2-Norm(final)=2.575 | acc=1.0000 | 3950.4 samples/s | 61.7 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02272 | Reg=0.00232 | L2-Norm=15.233 | L2-Norm(final)=2.577 | acc=0.9688 | 3894.9 samples/s | 60.9 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02264 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.579 | acc=0.9844 | 3928.5 samples/s | 61.4 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02244 | Reg=0.00232 | L2-Norm=15.247 | L2-Norm(final)=2.582 | acc=1.0000 | 3953.8 samples/s | 61.8 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02262 | Reg=0.00233 | L2-Norm=15.254 | L2-Norm(final)=2.585 | acc=1.0000 | 3922.4 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.01657 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.546 | acc=0.9844 | 3719.8 samples/s | 58.1 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00811 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.525 | acc=1.0000 | 4633.7 samples/s | 72.4 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00459 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.520 | acc=1.0000 | 4952.3 samples/s | 77.4 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00316 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.523 | acc=1.0000 | 4842.6 samples/s | 75.7 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00244 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.526 | acc=1.0000 | 4680.6 samples/s | 73.1 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00197 | Reg=0.00231 | L2-Norm=15.185 | L2-Norm(final)=2.529 | acc=1.0000 | 4859.9 samples/s | 75.9 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00165 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.532 | acc=1.0000 | 4922.5 samples/s | 76.9 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00142 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.535 | acc=1.0000 | 4818.4 samples/s | 75.3 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00124 | Reg=0.00230 | L2-Norm=15.150 | L2-Norm(final)=2.537 | acc=1.0000 | 4749.4 samples/s | 74.2 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00111 | Reg=0.00229 | L2-Norm=15.136 | L2-Norm(final)=2.539 | acc=1.0000 | 4656.0 samples/s | 72.8 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00100 | Reg=0.00229 | L2-Norm=15.122 | L2-Norm(final)=2.540 | acc=1.0000 | 4951.8 samples/s | 77.4 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00091 | Reg=0.00228 | L2-Norm=15.107 | L2-Norm(final)=2.542 | acc=1.0000 | 1463.0 samples/s | 22.9 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00083 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.543 | acc=1.0000 | 4984.1 samples/s | 77.9 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00077 | Reg=0.00227 | L2-Norm=15.076 | L2-Norm(final)=2.544 | acc=1.0000 | 4781.7 samples/s | 74.7 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00071 | Reg=0.00227 | L2-Norm=15.060 | L2-Norm(final)=2.545 | acc=1.0000 | 4782.8 samples/s | 74.7 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00067 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.546 | acc=1.0000 | 4692.3 samples/s | 73.3 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00063 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.547 | acc=1.0000 | 4848.5 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46912 | acc=0.6961 | tpr=0.5588 | fpr=0.0057 | 4537.7 samples/s | 17.7 steps/s
Avg test loss: 0.47339, Avg test acc: 0.69453, Avg tpr: 0.55826, Avg fpr: 0.00577, total FA: 45

Testing server on iccad2012
[Step=  50] | Loss=0.36154 | acc=0.8807 | tpr=0.9823 | fpr=0.1211 | 4571.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.36881 | acc=0.8801 | tpr=0.9872 | fpr=0.1219 | 9224.4 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.37666 | acc=0.8780 | tpr=0.9856 | fpr=0.1240 | 9357.4 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.37783 | acc=0.8780 | tpr=0.9869 | fpr=0.1240 | 9133.3 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.37805 | acc=0.8777 | tpr=0.9860 | fpr=0.1243 | 9709.3 samples/s | 37.9 steps/s
[Step= 300] | Loss=0.38142 | acc=0.8777 | tpr=0.9847 | fpr=0.1243 | 9385.3 samples/s | 36.7 steps/s
[Step= 350] | Loss=0.38449 | acc=0.8772 | tpr=0.9862 | fpr=0.1248 | 9130.6 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.38677 | acc=0.8772 | tpr=0.9852 | fpr=0.1248 | 8839.1 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.38938 | acc=0.8770 | tpr=0.9849 | fpr=0.1250 | 9553.1 samples/s | 37.3 steps/s
[Step= 500] | Loss=0.38886 | acc=0.8771 | tpr=0.9855 | fpr=0.1248 | 9594.8 samples/s | 37.5 steps/s
[Step= 550] | Loss=0.38714 | acc=0.8775 | tpr=0.9861 | fpr=0.1245 | 15685.8 samples/s | 61.3 steps/s
Avg test loss: 0.38668, Avg test acc: 0.87754, Avg tpr: 0.98613, Avg fpr: 0.12444, total FA: 17278

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.33966 | Reg=0.00223 | L2-Norm=14.945 | L2-Norm(final)=2.586 | acc=0.7812 | 3558.5 samples/s | 55.6 steps/s
[Step=12050 Epoch=11.8] | Loss=0.05138 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.573 | acc=0.9531 | 5136.3 samples/s | 80.3 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03387 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.585 | acc=0.9844 | 4917.1 samples/s | 76.8 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02951 | Reg=0.00227 | L2-Norm=15.073 | L2-Norm(final)=2.595 | acc=1.0000 | 4951.2 samples/s | 77.4 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02739 | Reg=0.00228 | L2-Norm=15.085 | L2-Norm(final)=2.599 | acc=0.9688 | 5039.6 samples/s | 78.7 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02602 | Reg=0.00228 | L2-Norm=15.095 | L2-Norm(final)=2.603 | acc=0.9844 | 4874.5 samples/s | 76.2 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02484 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.607 | acc=1.0000 | 4945.4 samples/s | 77.3 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02399 | Reg=0.00228 | L2-Norm=15.114 | L2-Norm(final)=2.611 | acc=0.9531 | 4984.6 samples/s | 77.9 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02402 | Reg=0.00229 | L2-Norm=15.121 | L2-Norm(final)=2.613 | acc=1.0000 | 4397.2 samples/s | 68.7 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02370 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.615 | acc=0.9688 | 3919.6 samples/s | 61.2 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02376 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.617 | acc=1.0000 | 3940.1 samples/s | 61.6 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02357 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.618 | acc=0.9688 | 3903.1 samples/s | 61.0 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02347 | Reg=0.00230 | L2-Norm=15.152 | L2-Norm(final)=2.620 | acc=0.9531 | 3939.4 samples/s | 61.6 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02345 | Reg=0.00230 | L2-Norm=15.160 | L2-Norm(final)=2.622 | acc=0.9844 | 3980.2 samples/s | 62.2 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02320 | Reg=0.00230 | L2-Norm=15.167 | L2-Norm(final)=2.624 | acc=0.9531 | 3901.4 samples/s | 61.0 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02309 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.626 | acc=0.9688 | 3893.8 samples/s | 60.8 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02296 | Reg=0.00231 | L2-Norm=15.182 | L2-Norm(final)=2.628 | acc=0.9844 | 3932.6 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.00382 | Reg=0.00223 | L2-Norm=14.945 | L2-Norm(final)=2.587 | acc=1.0000 | 2953.0 samples/s | 46.1 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00436 | Reg=0.00225 | L2-Norm=15.011 | L2-Norm(final)=2.585 | acc=1.0000 | 4830.4 samples/s | 75.5 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00226 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.591 | acc=1.0000 | 4856.0 samples/s | 75.9 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00153 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.595 | acc=1.0000 | 4691.0 samples/s | 73.3 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00211 | Reg=0.00226 | L2-Norm=15.021 | L2-Norm(final)=2.597 | acc=1.0000 | 4613.4 samples/s | 72.1 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00200 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.595 | acc=1.0000 | 4878.5 samples/s | 76.2 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00181 | Reg=0.00226 | L2-Norm=15.030 | L2-Norm(final)=2.595 | acc=1.0000 | 4876.5 samples/s | 76.2 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00181 | Reg=0.00226 | L2-Norm=15.033 | L2-Norm(final)=2.594 | acc=1.0000 | 4812.2 samples/s | 75.2 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00182 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.593 | acc=1.0000 | 4706.5 samples/s | 73.5 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00179 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.593 | acc=1.0000 | 4680.2 samples/s | 73.1 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00184 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.592 | acc=1.0000 | 4829.5 samples/s | 75.5 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00168 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.591 | acc=1.0000 | 1492.3 samples/s | 23.3 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00155 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.591 | acc=1.0000 | 4878.5 samples/s | 76.2 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00143 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.591 | acc=1.0000 | 4787.8 samples/s | 74.8 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00134 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.591 | acc=1.0000 | 4726.5 samples/s | 73.9 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00125 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.592 | acc=1.0000 | 4659.6 samples/s | 72.8 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00120 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.592 | acc=1.0000 | 4629.5 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47078 | acc=0.7103 | tpr=0.5803 | fpr=0.0074 | 4579.5 samples/s | 17.9 steps/s
Avg test loss: 0.47174, Avg test acc: 0.70619, Avg tpr: 0.57621, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.37982 | acc=0.8819 | tpr=0.9823 | fpr=0.1199 | 4504.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.38555 | acc=0.8809 | tpr=0.9872 | fpr=0.1211 | 9386.6 samples/s | 36.7 steps/s
[Step= 150] | Loss=0.39086 | acc=0.8802 | tpr=0.9885 | fpr=0.1218 | 9607.1 samples/s | 37.5 steps/s
[Step= 200] | Loss=0.39211 | acc=0.8798 | tpr=0.9891 | fpr=0.1221 | 9222.5 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.39297 | acc=0.8795 | tpr=0.9878 | fpr=0.1224 | 9361.5 samples/s | 36.6 steps/s
[Step= 300] | Loss=0.39748 | acc=0.8792 | tpr=0.9869 | fpr=0.1227 | 8983.1 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.40066 | acc=0.8789 | tpr=0.9869 | fpr=0.1230 | 9175.4 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.40229 | acc=0.8787 | tpr=0.9863 | fpr=0.1233 | 9218.4 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.40527 | acc=0.8781 | tpr=0.9859 | fpr=0.1239 | 9093.5 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.40509 | acc=0.8780 | tpr=0.9863 | fpr=0.1239 | 9464.1 samples/s | 37.0 steps/s
[Step= 550] | Loss=0.40359 | acc=0.8783 | tpr=0.9865 | fpr=0.1236 | 17145.7 samples/s | 67.0 steps/s
Avg test loss: 0.40330, Avg test acc: 0.87829, Avg tpr: 0.98653, Avg fpr: 0.12367, total FA: 17172

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.29057 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.622 | acc=0.8594 | 3813.7 samples/s | 59.6 steps/s
[Step=12850 Epoch=12.5] | Loss=0.04995 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.611 | acc=0.9531 | 4891.4 samples/s | 76.4 steps/s
[Step=12900 Epoch=12.6] | Loss=0.03959 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.618 | acc=1.0000 | 4894.9 samples/s | 76.5 steps/s
[Step=12950 Epoch=12.6] | Loss=0.03370 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.625 | acc=1.0000 | 4927.0 samples/s | 77.0 steps/s
[Step=13000 Epoch=12.7] | Loss=0.03056 | Reg=0.00227 | L2-Norm=15.078 | L2-Norm(final)=2.631 | acc=1.0000 | 5068.0 samples/s | 79.2 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02869 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.637 | acc=0.9844 | 4904.4 samples/s | 76.6 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02765 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.641 | acc=0.9844 | 5109.3 samples/s | 79.8 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02637 | Reg=0.00228 | L2-Norm=15.107 | L2-Norm(final)=2.644 | acc=0.9844 | 4964.1 samples/s | 77.6 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02626 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.648 | acc=1.0000 | 4888.1 samples/s | 76.4 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02555 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.651 | acc=0.9688 | 4016.4 samples/s | 62.8 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02497 | Reg=0.00229 | L2-Norm=15.134 | L2-Norm(final)=2.654 | acc=0.9844 | 3943.4 samples/s | 61.6 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02451 | Reg=0.00229 | L2-Norm=15.142 | L2-Norm(final)=2.656 | acc=0.9688 | 3930.0 samples/s | 61.4 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02484 | Reg=0.00230 | L2-Norm=15.149 | L2-Norm(final)=2.658 | acc=0.9688 | 4109.0 samples/s | 64.2 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02415 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.659 | acc=1.0000 | 4976.8 samples/s | 77.8 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02393 | Reg=0.00230 | L2-Norm=15.165 | L2-Norm(final)=2.661 | acc=0.9844 | 4914.1 samples/s | 76.8 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02376 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.663 | acc=1.0000 | 5044.3 samples/s | 78.8 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02344 | Reg=0.00230 | L2-Norm=15.180 | L2-Norm(final)=2.665 | acc=1.0000 | 4925.7 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.01321 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.623 | acc=0.9844 | 3297.8 samples/s | 51.5 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00217 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.628 | acc=1.0000 | 4651.5 samples/s | 72.7 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00117 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.632 | acc=1.0000 | 4738.7 samples/s | 74.0 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00081 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.635 | acc=1.0000 | 4674.7 samples/s | 73.0 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00062 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.638 | acc=1.0000 | 4884.7 samples/s | 76.3 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00050 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.640 | acc=1.0000 | 4859.6 samples/s | 75.9 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00043 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.642 | acc=1.0000 | 4926.1 samples/s | 77.0 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00037 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.644 | acc=1.0000 | 4760.1 samples/s | 74.4 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00033 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.646 | acc=1.0000 | 4645.7 samples/s | 72.6 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00029 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.647 | acc=1.0000 | 4683.2 samples/s | 73.2 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00027 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.648 | acc=1.0000 | 4848.8 samples/s | 75.8 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00024 | Reg=0.00222 | L2-Norm=14.894 | L2-Norm(final)=2.650 | acc=1.0000 | 1494.5 samples/s | 23.4 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00022 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.651 | acc=1.0000 | 4931.1 samples/s | 77.0 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00021 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.652 | acc=1.0000 | 4724.5 samples/s | 73.8 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00019 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.653 | acc=1.0000 | 4767.5 samples/s | 74.5 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00018 | Reg=0.00220 | L2-Norm=14.837 | L2-Norm(final)=2.654 | acc=1.0000 | 4831.5 samples/s | 75.5 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00017 | Reg=0.00220 | L2-Norm=14.823 | L2-Norm(final)=2.655 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27564 | acc=0.8156 | tpr=0.7364 | fpr=0.0124 | 4647.1 samples/s | 18.2 steps/s
Avg test loss: 0.27731, Avg test acc: 0.81389, Avg tpr: 0.73504, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.45349 | acc=0.8493 | tpr=0.9823 | fpr=0.1531 | 4573.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.45909 | acc=0.8476 | tpr=0.9872 | fpr=0.1550 | 9117.5 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.46454 | acc=0.8454 | tpr=0.9885 | fpr=0.1572 | 9509.4 samples/s | 37.1 steps/s
[Step= 200] | Loss=0.46504 | acc=0.8456 | tpr=0.9891 | fpr=0.1570 | 9326.2 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.46590 | acc=0.8454 | tpr=0.9878 | fpr=0.1572 | 9573.0 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.46903 | acc=0.8455 | tpr=0.9862 | fpr=0.1571 | 9404.2 samples/s | 36.7 steps/s
[Step= 350] | Loss=0.47223 | acc=0.8448 | tpr=0.9875 | fpr=0.1578 | 9185.3 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.47378 | acc=0.8444 | tpr=0.9869 | fpr=0.1582 | 9236.8 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.47675 | acc=0.8441 | tpr=0.9869 | fpr=0.1585 | 9131.6 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.47647 | acc=0.8441 | tpr=0.9868 | fpr=0.1585 | 9033.6 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.47494 | acc=0.8444 | tpr=0.9873 | fpr=0.1582 | 17045.3 samples/s | 66.6 steps/s
Avg test loss: 0.47457, Avg test acc: 0.84445, Avg tpr: 0.98732, Avg fpr: 0.15814, total FA: 21958

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.25697 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.677 | acc=0.8125 | 3499.7 samples/s | 54.7 steps/s
[Step=13650 Epoch=13.3] | Loss=0.03399 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.677 | acc=0.9844 | 5096.2 samples/s | 79.6 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02798 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.686 | acc=0.9844 | 4952.1 samples/s | 77.4 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02590 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.692 | acc=0.9531 | 4988.9 samples/s | 78.0 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02472 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.695 | acc=1.0000 | 4977.3 samples/s | 77.8 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02294 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.701 | acc=0.9844 | 4967.8 samples/s | 77.6 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02219 | Reg=0.00224 | L2-Norm=14.971 | L2-Norm(final)=2.705 | acc=1.0000 | 5029.9 samples/s | 78.6 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02226 | Reg=0.00224 | L2-Norm=14.979 | L2-Norm(final)=2.709 | acc=0.9844 | 4989.8 samples/s | 78.0 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02183 | Reg=0.00225 | L2-Norm=14.988 | L2-Norm(final)=2.711 | acc=0.9531 | 5060.6 samples/s | 79.1 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02193 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.713 | acc=0.9688 | 5002.4 samples/s | 78.2 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02158 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.715 | acc=0.9688 | 4978.0 samples/s | 77.8 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02166 | Reg=0.00225 | L2-Norm=15.011 | L2-Norm(final)=2.718 | acc=0.9844 | 5056.2 samples/s | 79.0 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02158 | Reg=0.00226 | L2-Norm=15.019 | L2-Norm(final)=2.719 | acc=0.9375 | 4924.7 samples/s | 76.9 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02149 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.721 | acc=1.0000 | 4988.5 samples/s | 77.9 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02126 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.724 | acc=0.9844 | 5047.9 samples/s | 78.9 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02108 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.726 | acc=1.0000 | 5036.0 samples/s | 78.7 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02111 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.728 | acc=0.9688 | 5008.3 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.03341 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.678 | acc=0.9531 | 3591.7 samples/s | 56.1 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00663 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.661 | acc=1.0000 | 4576.0 samples/s | 71.5 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00376 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.659 | acc=1.0000 | 4632.2 samples/s | 72.4 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00341 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.659 | acc=1.0000 | 4785.5 samples/s | 74.8 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00307 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.656 | acc=1.0000 | 4712.5 samples/s | 73.6 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00283 | Reg=0.00224 | L2-Norm=14.983 | L2-Norm(final)=2.655 | acc=1.0000 | 4737.0 samples/s | 74.0 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00244 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.654 | acc=1.0000 | 4881.4 samples/s | 76.3 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00211 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.654 | acc=1.0000 | 4707.8 samples/s | 73.6 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00185 | Reg=0.00224 | L2-Norm=14.972 | L2-Norm(final)=2.655 | acc=1.0000 | 4810.8 samples/s | 75.2 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00164 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.657 | acc=1.0000 | 4755.1 samples/s | 74.3 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00149 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.658 | acc=1.0000 | 4868.5 samples/s | 76.1 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00136 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.659 | acc=1.0000 | 1479.8 samples/s | 23.1 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00125 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.660 | acc=1.0000 | 4848.0 samples/s | 75.7 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00115 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.662 | acc=1.0000 | 4851.4 samples/s | 75.8 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00107 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.663 | acc=1.0000 | 4781.5 samples/s | 74.7 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00100 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.664 | acc=1.0000 | 4821.9 samples/s | 75.3 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00094 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.665 | acc=1.0000 | 4752.0 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.62379 | acc=0.6531 | tpr=0.4965 | fpr=0.0067 | 4587.5 samples/s | 17.9 steps/s
Avg test loss: 0.62241, Avg test acc: 0.65270, Avg tpr: 0.49834, Avg fpr: 0.00782, total FA: 61

Testing server on iccad2012
[Step=  50] | Loss=0.29766 | acc=0.9161 | tpr=0.9823 | fpr=0.0851 | 4618.6 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.30243 | acc=0.9164 | tpr=0.9808 | fpr=0.0848 | 9407.3 samples/s | 36.7 steps/s
[Step= 150] | Loss=0.30697 | acc=0.9153 | tpr=0.9827 | fpr=0.0860 | 8811.9 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.30847 | acc=0.9148 | tpr=0.9836 | fpr=0.0865 | 9489.9 samples/s | 37.1 steps/s
[Step= 250] | Loss=0.30879 | acc=0.9146 | tpr=0.9834 | fpr=0.0866 | 10334.9 samples/s | 40.4 steps/s
[Step= 300] | Loss=0.31185 | acc=0.9142 | tpr=0.9825 | fpr=0.0870 | 8413.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.31532 | acc=0.9135 | tpr=0.9831 | fpr=0.0877 | 9348.0 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.31754 | acc=0.9132 | tpr=0.9825 | fpr=0.0880 | 9038.3 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.32063 | acc=0.9127 | tpr=0.9825 | fpr=0.0885 | 9348.3 samples/s | 36.5 steps/s
[Step= 500] | Loss=0.32023 | acc=0.9125 | tpr=0.9833 | fpr=0.0888 | 9495.2 samples/s | 37.1 steps/s
[Step= 550] | Loss=0.31860 | acc=0.9128 | tpr=0.9825 | fpr=0.0885 | 16130.6 samples/s | 63.0 steps/s
Avg test loss: 0.31821, Avg test acc: 0.91278, Avg tpr: 0.98257, Avg fpr: 0.08849, total FA: 12286

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.37799 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.715 | acc=0.7344 | 3817.8 samples/s | 59.7 steps/s
[Step=14450 Epoch=14.1] | Loss=0.05520 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.692 | acc=0.9844 | 4729.6 samples/s | 73.9 steps/s
[Step=14500 Epoch=14.2] | Loss=0.03858 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.699 | acc=0.9688 | 5004.3 samples/s | 78.2 steps/s
[Step=14550 Epoch=14.2] | Loss=0.03116 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.706 | acc=0.9844 | 4720.0 samples/s | 73.7 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02787 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.712 | acc=1.0000 | 3931.1 samples/s | 61.4 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02628 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.717 | acc=0.9688 | 3898.5 samples/s | 60.9 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02491 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.721 | acc=0.9688 | 3935.2 samples/s | 61.5 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02428 | Reg=0.00225 | L2-Norm=15.013 | L2-Norm(final)=2.724 | acc=1.0000 | 3935.9 samples/s | 61.5 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02399 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.726 | acc=1.0000 | 3900.0 samples/s | 60.9 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02350 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.728 | acc=0.9844 | 3956.3 samples/s | 61.8 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02345 | Reg=0.00226 | L2-Norm=15.035 | L2-Norm(final)=2.730 | acc=1.0000 | 3895.4 samples/s | 60.9 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02309 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.732 | acc=1.0000 | 3923.5 samples/s | 61.3 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02282 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.734 | acc=0.9688 | 3922.2 samples/s | 61.3 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02272 | Reg=0.00227 | L2-Norm=15.054 | L2-Norm(final)=2.736 | acc=0.9844 | 3928.2 samples/s | 61.4 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02235 | Reg=0.00227 | L2-Norm=15.060 | L2-Norm(final)=2.738 | acc=1.0000 | 3919.8 samples/s | 61.2 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02185 | Reg=0.00227 | L2-Norm=15.067 | L2-Norm(final)=2.740 | acc=1.0000 | 3900.4 samples/s | 60.9 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02183 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.743 | acc=1.0000 | 3949.3 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.01893 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.716 | acc=0.9844 | 3018.7 samples/s | 47.2 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00422 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.718 | acc=1.0000 | 4398.9 samples/s | 68.7 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00277 | Reg=0.00222 | L2-Norm=14.890 | L2-Norm(final)=2.722 | acc=1.0000 | 4842.6 samples/s | 75.7 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00194 | Reg=0.00222 | L2-Norm=14.897 | L2-Norm(final)=2.725 | acc=1.0000 | 4799.2 samples/s | 75.0 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00147 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.729 | acc=1.0000 | 4749.3 samples/s | 74.2 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00118 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.732 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00098 | Reg=0.00221 | L2-Norm=14.878 | L2-Norm(final)=2.735 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00085 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.737 | acc=1.0000 | 4851.8 samples/s | 75.8 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00074 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.739 | acc=1.0000 | 4909.5 samples/s | 76.7 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00066 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.742 | acc=1.0000 | 4759.1 samples/s | 74.4 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00060 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.744 | acc=1.0000 | 4753.3 samples/s | 74.3 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00055 | Reg=0.00220 | L2-Norm=14.820 | L2-Norm(final)=2.746 | acc=1.0000 | 1514.7 samples/s | 23.7 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00050 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.748 | acc=1.0000 | 4927.2 samples/s | 77.0 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00046 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.750 | acc=1.0000 | 4879.3 samples/s | 76.2 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00043 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.752 | acc=1.0000 | 4622.6 samples/s | 72.2 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00040 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.753 | acc=1.0000 | 4819.3 samples/s | 75.3 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00038 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.755 | acc=1.0000 | 4859.9 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37268 | acc=0.7640 | tpr=0.6585 | fpr=0.0069 | 4559.6 samples/s | 17.8 steps/s
Avg test loss: 0.37454, Avg test acc: 0.76188, Avg tpr: 0.65687, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.42445 | acc=0.8655 | tpr=0.9823 | fpr=0.1366 | 4644.0 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.43069 | acc=0.8654 | tpr=0.9851 | fpr=0.1369 | 8866.8 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.43591 | acc=0.8642 | tpr=0.9870 | fpr=0.1381 | 9410.9 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.43730 | acc=0.8637 | tpr=0.9880 | fpr=0.1385 | 9700.0 samples/s | 37.9 steps/s
[Step= 250] | Loss=0.43745 | acc=0.8637 | tpr=0.9860 | fpr=0.1385 | 9170.8 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.44071 | acc=0.8638 | tpr=0.9847 | fpr=0.1384 | 8877.1 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.44446 | acc=0.8630 | tpr=0.9862 | fpr=0.1392 | 9348.2 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.44706 | acc=0.8628 | tpr=0.9852 | fpr=0.1394 | 9242.9 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.44989 | acc=0.8626 | tpr=0.9854 | fpr=0.1397 | 8993.8 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.44986 | acc=0.8624 | tpr=0.9850 | fpr=0.1398 | 9349.3 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.44796 | acc=0.8625 | tpr=0.9849 | fpr=0.1397 | 16574.4 samples/s | 64.7 steps/s
Avg test loss: 0.44759, Avg test acc: 0.86253, Avg tpr: 0.98494, Avg fpr: 0.13970, total FA: 19397

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.16131 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.772 | acc=0.8281 | 3704.3 samples/s | 57.9 steps/s
[Step=15250 Epoch=14.9] | Loss=0.03243 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.770 | acc=0.9844 | 4849.1 samples/s | 75.8 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02422 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.779 | acc=1.0000 | 4804.9 samples/s | 75.1 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02293 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.783 | acc=1.0000 | 4016.2 samples/s | 62.8 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02122 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.788 | acc=0.9844 | 3860.8 samples/s | 60.3 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02105 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.792 | acc=1.0000 | 3862.8 samples/s | 60.4 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02143 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.795 | acc=0.9688 | 3940.8 samples/s | 61.6 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02147 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.798 | acc=0.9844 | 3930.5 samples/s | 61.4 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02068 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.800 | acc=1.0000 | 3960.7 samples/s | 61.9 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02065 | Reg=0.00222 | L2-Norm=14.901 | L2-Norm(final)=2.802 | acc=1.0000 | 3831.0 samples/s | 59.9 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02062 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.802 | acc=0.9844 | 3912.8 samples/s | 61.1 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02060 | Reg=0.00222 | L2-Norm=14.916 | L2-Norm(final)=2.804 | acc=0.9844 | 3945.6 samples/s | 61.7 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02035 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.805 | acc=1.0000 | 3912.4 samples/s | 61.1 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02029 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.806 | acc=0.9844 | 3957.4 samples/s | 61.8 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02046 | Reg=0.00223 | L2-Norm=14.940 | L2-Norm(final)=2.808 | acc=1.0000 | 3944.8 samples/s | 61.6 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02080 | Reg=0.00223 | L2-Norm=14.947 | L2-Norm(final)=2.808 | acc=0.9688 | 3891.7 samples/s | 60.8 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02053 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.809 | acc=0.9844 | 3920.9 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.04360 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.771 | acc=0.9688 | 3726.9 samples/s | 58.2 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00504 | Reg=0.00221 | L2-Norm=14.861 | L2-Norm(final)=2.762 | acc=1.0000 | 4481.3 samples/s | 70.0 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00284 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.762 | acc=1.0000 | 4822.4 samples/s | 75.3 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00198 | Reg=0.00222 | L2-Norm=14.913 | L2-Norm(final)=2.765 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00150 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.768 | acc=1.0000 | 4707.1 samples/s | 73.5 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00123 | Reg=0.00222 | L2-Norm=14.904 | L2-Norm(final)=2.770 | acc=1.0000 | 4687.8 samples/s | 73.2 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00103 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.772 | acc=1.0000 | 4587.9 samples/s | 71.7 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00092 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.774 | acc=1.0000 | 3709.3 samples/s | 58.0 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00081 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.776 | acc=1.0000 | 3730.2 samples/s | 58.3 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00072 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.778 | acc=1.0000 | 3753.3 samples/s | 58.6 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00065 | Reg=0.00221 | L2-Norm=14.855 | L2-Norm(final)=2.780 | acc=1.0000 | 3733.9 samples/s | 58.3 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00059 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.782 | acc=1.0000 | 1476.9 samples/s | 23.1 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00054 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.783 | acc=1.0000 | 4873.9 samples/s | 76.2 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00050 | Reg=0.00220 | L2-Norm=14.820 | L2-Norm(final)=2.784 | acc=1.0000 | 4779.7 samples/s | 74.7 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00047 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.785 | acc=1.0000 | 4771.7 samples/s | 74.6 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00043 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.786 | acc=1.0000 | 4705.8 samples/s | 73.5 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00041 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.787 | acc=1.0000 | 4913.4 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44980 | acc=0.7534 | tpr=0.6431 | fpr=0.0069 | 4560.3 samples/s | 17.8 steps/s
Avg test loss: 0.44821, Avg test acc: 0.75194, Avg tpr: 0.64265, Avg fpr: 0.00769, total FA: 60

Testing server on iccad2012
[Step=  50] | Loss=0.43544 | acc=0.8846 | tpr=0.9823 | fpr=0.1171 | 4618.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.44145 | acc=0.8826 | tpr=0.9851 | fpr=0.1193 | 9171.3 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.44914 | acc=0.8802 | tpr=0.9870 | fpr=0.1218 | 9195.8 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.45173 | acc=0.8798 | tpr=0.9880 | fpr=0.1222 | 9438.3 samples/s | 36.9 steps/s
[Step= 250] | Loss=0.45234 | acc=0.8793 | tpr=0.9878 | fpr=0.1227 | 9128.4 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.45638 | acc=0.8793 | tpr=0.9862 | fpr=0.1227 | 9503.2 samples/s | 37.1 steps/s
[Step= 350] | Loss=0.46014 | acc=0.8793 | tpr=0.9862 | fpr=0.1227 | 9140.8 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.46278 | acc=0.8790 | tpr=0.9858 | fpr=0.1229 | 9263.0 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.46631 | acc=0.8785 | tpr=0.9859 | fpr=0.1234 | 9314.2 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.46646 | acc=0.8784 | tpr=0.9863 | fpr=0.1235 | 8843.3 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.46462 | acc=0.8785 | tpr=0.9869 | fpr=0.1235 | 17310.2 samples/s | 67.6 steps/s
Avg test loss: 0.46411, Avg test acc: 0.87857, Avg tpr: 0.98693, Avg fpr: 0.12340, total FA: 17134

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.23042 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.813 | acc=0.8594 | 3633.0 samples/s | 56.8 steps/s
[Step=16050 Epoch=15.7] | Loss=0.04907 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.799 | acc=0.9688 | 5111.6 samples/s | 79.9 steps/s
[Step=16100 Epoch=15.7] | Loss=0.03312 | Reg=0.00218 | L2-Norm=14.752 | L2-Norm(final)=2.803 | acc=1.0000 | 4880.1 samples/s | 76.3 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02718 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.808 | acc=0.9844 | 5018.0 samples/s | 78.4 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02407 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.813 | acc=0.9531 | 4945.4 samples/s | 77.3 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02203 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.817 | acc=1.0000 | 4944.8 samples/s | 77.3 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02023 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.820 | acc=1.0000 | 4963.6 samples/s | 77.6 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01902 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.824 | acc=1.0000 | 4933.2 samples/s | 77.1 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01845 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.828 | acc=1.0000 | 4419.6 samples/s | 69.1 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01791 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.831 | acc=1.0000 | 3884.0 samples/s | 60.7 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01744 | Reg=0.00219 | L2-Norm=14.787 | L2-Norm(final)=2.833 | acc=1.0000 | 3877.9 samples/s | 60.6 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01725 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.836 | acc=0.9688 | 3958.0 samples/s | 61.8 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01699 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.838 | acc=0.9844 | 3923.7 samples/s | 61.3 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01651 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.840 | acc=1.0000 | 3942.4 samples/s | 61.6 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01641 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.843 | acc=0.9844 | 3933.0 samples/s | 61.5 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01641 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.845 | acc=1.0000 | 3900.4 samples/s | 60.9 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01610 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.847 | acc=0.9844 | 3927.7 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.02119 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.813 | acc=0.9688 | 2945.9 samples/s | 46.0 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00389 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.812 | acc=1.0000 | 4722.1 samples/s | 73.8 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00204 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.815 | acc=1.0000 | 4750.4 samples/s | 74.2 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00141 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.817 | acc=1.0000 | 4801.6 samples/s | 75.0 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00112 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.820 | acc=1.0000 | 4744.3 samples/s | 74.1 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00090 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.822 | acc=1.0000 | 4933.4 samples/s | 77.1 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00075 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.823 | acc=1.0000 | 4907.9 samples/s | 76.7 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00065 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.825 | acc=1.0000 | 4853.9 samples/s | 75.8 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00057 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.826 | acc=1.0000 | 4712.9 samples/s | 73.6 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00051 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.827 | acc=1.0000 | 4827.7 samples/s | 75.4 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00046 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.828 | acc=1.0000 | 4809.5 samples/s | 75.1 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00042 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.829 | acc=1.0000 | 1523.7 samples/s | 23.8 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00039 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.829 | acc=1.0000 | 4860.2 samples/s | 75.9 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00036 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.830 | acc=1.0000 | 4694.9 samples/s | 73.4 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00033 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.831 | acc=1.0000 | 4801.4 samples/s | 75.0 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00031 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.832 | acc=1.0000 | 4730.3 samples/s | 73.9 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00029 | Reg=0.00215 | L2-Norm=14.665 | L2-Norm(final)=2.832 | acc=1.0000 | 4836.1 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32660 | acc=0.8037 | tpr=0.7173 | fpr=0.0084 | 4552.5 samples/s | 17.8 steps/s
Avg test loss: 0.32930, Avg test acc: 0.80375, Avg tpr: 0.71831, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.55963 | acc=0.8459 | tpr=0.9823 | fpr=0.1566 | 4570.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.56470 | acc=0.8476 | tpr=0.9851 | fpr=0.1549 | 9561.6 samples/s | 37.3 steps/s
[Step= 150] | Loss=0.57316 | acc=0.8454 | tpr=0.9870 | fpr=0.1572 | 8886.8 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.57510 | acc=0.8451 | tpr=0.9880 | fpr=0.1575 | 9256.6 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.57633 | acc=0.8450 | tpr=0.9869 | fpr=0.1576 | 9329.7 samples/s | 36.4 steps/s
[Step= 300] | Loss=0.58059 | acc=0.8452 | tpr=0.9855 | fpr=0.1574 | 9248.5 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.58460 | acc=0.8450 | tpr=0.9862 | fpr=0.1576 | 9353.3 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.58786 | acc=0.8448 | tpr=0.9858 | fpr=0.1578 | 9424.4 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.59174 | acc=0.8447 | tpr=0.9859 | fpr=0.1579 | 9057.2 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.59164 | acc=0.8445 | tpr=0.9863 | fpr=0.1581 | 8093.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.58987 | acc=0.8445 | tpr=0.9865 | fpr=0.1581 | 14222.7 samples/s | 55.6 steps/s
Avg test loss: 0.58939, Avg test acc: 0.84455, Avg tpr: 0.98653, Avg fpr: 0.15803, total FA: 21942

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.12403 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.859 | acc=0.8750 | 3736.4 samples/s | 58.4 steps/s
[Step=16850 Epoch=16.5] | Loss=0.03028 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.857 | acc=1.0000 | 4816.4 samples/s | 75.3 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02102 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.861 | acc=1.0000 | 4884.1 samples/s | 76.3 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01841 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.865 | acc=1.0000 | 4416.3 samples/s | 69.0 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01737 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.869 | acc=0.9844 | 3892.3 samples/s | 60.8 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01696 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.873 | acc=1.0000 | 3960.0 samples/s | 61.9 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01585 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=2.876 | acc=0.9844 | 3945.5 samples/s | 61.6 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01573 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.879 | acc=1.0000 | 3922.0 samples/s | 61.3 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01515 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.881 | acc=1.0000 | 3926.1 samples/s | 61.3 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01500 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.884 | acc=1.0000 | 3905.8 samples/s | 61.0 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01464 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.886 | acc=0.9688 | 3974.7 samples/s | 62.1 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01449 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.889 | acc=0.9688 | 3941.1 samples/s | 61.6 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01436 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.891 | acc=0.9844 | 3926.7 samples/s | 61.4 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01431 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.893 | acc=0.9844 | 3954.6 samples/s | 61.8 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01454 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.895 | acc=0.9688 | 3934.4 samples/s | 61.5 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01453 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.897 | acc=0.9844 | 4024.1 samples/s | 62.9 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01442 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.899 | acc=0.9844 | 3815.1 samples/s | 59.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.07546 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.858 | acc=0.9531 | 3147.2 samples/s | 49.2 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00316 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.858 | acc=1.0000 | 4531.3 samples/s | 70.8 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00163 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.859 | acc=1.0000 | 4790.3 samples/s | 74.8 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00112 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=2.861 | acc=1.0000 | 4856.7 samples/s | 75.9 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00085 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=2.862 | acc=1.0000 | 4762.4 samples/s | 74.4 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00068 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.863 | acc=1.0000 | 4849.0 samples/s | 75.8 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00057 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.864 | acc=1.0000 | 4727.4 samples/s | 73.9 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00049 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.865 | acc=1.0000 | 4848.0 samples/s | 75.7 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00043 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=2.865 | acc=1.0000 | 4734.4 samples/s | 74.0 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00038 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.866 | acc=1.0000 | 4656.4 samples/s | 72.8 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00035 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.867 | acc=1.0000 | 4806.0 samples/s | 75.1 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00032 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.867 | acc=1.0000 | 1521.3 samples/s | 23.8 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00030 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.868 | acc=1.0000 | 4729.5 samples/s | 73.9 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00027 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.869 | acc=1.0000 | 4788.6 samples/s | 74.8 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00026 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.869 | acc=1.0000 | 4757.3 samples/s | 74.3 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00024 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.870 | acc=1.0000 | 4693.5 samples/s | 73.3 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00022 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=2.870 | acc=1.0000 | 4804.7 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48231 | acc=0.7431 | tpr=0.6271 | fpr=0.0050 | 4607.4 samples/s | 18.0 steps/s
Avg test loss: 0.48235, Avg test acc: 0.74365, Avg tpr: 0.62960, Avg fpr: 0.00551, total FA: 43

Testing server on iccad2012
[Step=  50] | Loss=0.45795 | acc=0.8902 | tpr=0.9779 | fpr=0.1113 | 4533.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.46467 | acc=0.8898 | tpr=0.9851 | fpr=0.1120 | 9361.7 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.47059 | acc=0.8885 | tpr=0.9870 | fpr=0.1133 | 9378.1 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.47265 | acc=0.8881 | tpr=0.9880 | fpr=0.1137 | 9340.4 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.47424 | acc=0.8873 | tpr=0.9860 | fpr=0.1145 | 9575.7 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.47896 | acc=0.8872 | tpr=0.9847 | fpr=0.1146 | 8811.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.48287 | acc=0.8865 | tpr=0.9850 | fpr=0.1153 | 9194.8 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.48596 | acc=0.8863 | tpr=0.9841 | fpr=0.1155 | 9011.0 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.48968 | acc=0.8860 | tpr=0.9844 | fpr=0.1158 | 9360.9 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.48984 | acc=0.8860 | tpr=0.9850 | fpr=0.1158 | 9412.7 samples/s | 36.8 steps/s
[Step= 550] | Loss=0.48798 | acc=0.8860 | tpr=0.9853 | fpr=0.1158 | 16775.8 samples/s | 65.5 steps/s
Avg test loss: 0.48740, Avg test acc: 0.88605, Avg tpr: 0.98534, Avg fpr: 0.11575, total FA: 16072

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.43480 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.901 | acc=0.7969 | 3929.0 samples/s | 61.4 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03947 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.887 | acc=0.9844 | 4856.5 samples/s | 75.9 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02729 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.888 | acc=0.9844 | 4986.3 samples/s | 77.9 steps/s
[Step=17750 Epoch=17.3] | Loss=0.02206 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.891 | acc=0.9844 | 5075.1 samples/s | 79.3 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01978 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.894 | acc=1.0000 | 4831.5 samples/s | 75.5 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01783 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.897 | acc=1.0000 | 4969.3 samples/s | 77.6 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01664 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.900 | acc=1.0000 | 4982.7 samples/s | 77.9 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01624 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.903 | acc=0.9844 | 4910.9 samples/s | 76.7 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01580 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.905 | acc=0.9844 | 4827.0 samples/s | 75.4 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01536 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=2.907 | acc=1.0000 | 4966.6 samples/s | 77.6 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01499 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.910 | acc=1.0000 | 4975.5 samples/s | 77.7 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01490 | Reg=0.00215 | L2-Norm=14.670 | L2-Norm(final)=2.912 | acc=0.9844 | 5073.8 samples/s | 79.3 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01490 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.913 | acc=1.0000 | 5061.4 samples/s | 79.1 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01482 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=2.915 | acc=1.0000 | 5024.2 samples/s | 78.5 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01466 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.917 | acc=0.9844 | 4964.1 samples/s | 77.6 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01470 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.918 | acc=1.0000 | 4934.8 samples/s | 77.1 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01463 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=2.920 | acc=0.9688 | 4913.5 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.00600 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.902 | acc=1.0000 | 3788.1 samples/s | 59.2 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00596 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.896 | acc=1.0000 | 4781.4 samples/s | 74.7 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00352 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.892 | acc=1.0000 | 4854.5 samples/s | 75.9 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00237 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.891 | acc=1.0000 | 4758.2 samples/s | 74.3 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00182 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.892 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00147 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.892 | acc=1.0000 | 4883.2 samples/s | 76.3 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00123 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.893 | acc=1.0000 | 4779.0 samples/s | 74.7 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00106 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.894 | acc=1.0000 | 4920.4 samples/s | 76.9 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00093 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.895 | acc=1.0000 | 4876.9 samples/s | 76.2 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00083 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.896 | acc=1.0000 | 4810.9 samples/s | 75.2 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00075 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=2.897 | acc=1.0000 | 4892.8 samples/s | 76.4 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00068 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.898 | acc=1.0000 | 1506.6 samples/s | 23.5 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00063 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.899 | acc=1.0000 | 4878.1 samples/s | 76.2 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00058 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=2.899 | acc=1.0000 | 4928.0 samples/s | 77.0 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00054 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.900 | acc=1.0000 | 4749.3 samples/s | 74.2 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00050 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.901 | acc=1.0000 | 4915.4 samples/s | 76.8 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00047 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.901 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33478 | acc=0.8065 | tpr=0.7201 | fpr=0.0059 | 4572.8 samples/s | 17.9 steps/s
Avg test loss: 0.33701, Avg test acc: 0.80563, Avg tpr: 0.72029, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.51425 | acc=0.8628 | tpr=0.9779 | fpr=0.1393 | 4589.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.52068 | acc=0.8634 | tpr=0.9829 | fpr=0.1389 | 9200.8 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.52850 | acc=0.8616 | tpr=0.9841 | fpr=0.1406 | 9310.1 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.53084 | acc=0.8618 | tpr=0.9858 | fpr=0.1404 | 9088.3 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.53128 | acc=0.8611 | tpr=0.9852 | fpr=0.1412 | 9436.9 samples/s | 36.9 steps/s
[Step= 300] | Loss=0.53580 | acc=0.8609 | tpr=0.9840 | fpr=0.1414 | 9327.0 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.53958 | acc=0.8606 | tpr=0.9850 | fpr=0.1416 | 9272.5 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.54256 | acc=0.8603 | tpr=0.9847 | fpr=0.1420 | 9522.3 samples/s | 37.2 steps/s
[Step= 450] | Loss=0.54670 | acc=0.8600 | tpr=0.9849 | fpr=0.1423 | 8986.1 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.54659 | acc=0.8597 | tpr=0.9850 | fpr=0.1426 | 9141.5 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.54482 | acc=0.8598 | tpr=0.9845 | fpr=0.1425 | 16931.8 samples/s | 66.1 steps/s
Avg test loss: 0.54418, Avg test acc: 0.85986, Avg tpr: 0.98455, Avg fpr: 0.14241, total FA: 19773

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.13786 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.926 | acc=0.9062 | 4033.8 samples/s | 63.0 steps/s
[Step=18450 Epoch=18.0] | Loss=0.03099 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.923 | acc=0.9844 | 4489.9 samples/s | 70.2 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02249 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.928 | acc=0.9844 | 4814.8 samples/s | 75.2 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01840 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.932 | acc=0.9844 | 4972.7 samples/s | 77.7 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01698 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=2.935 | acc=0.9844 | 4062.3 samples/s | 63.5 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01572 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.938 | acc=0.9844 | 3917.6 samples/s | 61.2 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01515 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.941 | acc=0.9844 | 3929.0 samples/s | 61.4 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01481 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.943 | acc=0.9844 | 3945.6 samples/s | 61.6 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01411 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.946 | acc=1.0000 | 3932.8 samples/s | 61.5 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01399 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.948 | acc=1.0000 | 3883.5 samples/s | 60.7 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01422 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.951 | acc=0.9844 | 3968.4 samples/s | 62.0 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01401 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.953 | acc=0.9844 | 3915.9 samples/s | 61.2 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01376 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.955 | acc=1.0000 | 3922.4 samples/s | 61.3 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01370 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.957 | acc=0.9844 | 3944.4 samples/s | 61.6 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01348 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.959 | acc=0.9844 | 3911.4 samples/s | 61.1 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01362 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.961 | acc=1.0000 | 3891.7 samples/s | 60.8 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01359 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.962 | acc=1.0000 | 3913.1 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.04906 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.925 | acc=0.9688 | 3048.1 samples/s | 47.6 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00445 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.919 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00228 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.920 | acc=1.0000 | 4820.8 samples/s | 75.3 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00157 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.922 | acc=1.0000 | 4797.3 samples/s | 75.0 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00119 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.923 | acc=1.0000 | 4799.7 samples/s | 75.0 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00096 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=2.925 | acc=1.0000 | 4898.1 samples/s | 76.5 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00080 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=2.926 | acc=1.0000 | 4827.6 samples/s | 75.4 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00069 | Reg=0.00213 | L2-Norm=14.582 | L2-Norm(final)=2.927 | acc=1.0000 | 4660.2 samples/s | 72.8 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00061 | Reg=0.00213 | L2-Norm=14.577 | L2-Norm(final)=2.928 | acc=1.0000 | 4698.3 samples/s | 73.4 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00054 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.930 | acc=1.0000 | 4648.3 samples/s | 72.6 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00049 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.931 | acc=1.0000 | 3786.2 samples/s | 59.2 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00045 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=2.932 | acc=1.0000 | 1487.2 samples/s | 23.2 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=2.933 | acc=1.0000 | 4865.4 samples/s | 76.0 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00038 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=2.934 | acc=1.0000 | 4751.8 samples/s | 74.2 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00035 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=2.935 | acc=1.0000 | 4739.2 samples/s | 74.1 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00033 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=2.935 | acc=1.0000 | 4794.9 samples/s | 74.9 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00031 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=2.936 | acc=1.0000 | 4847.1 samples/s | 75.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33139 | acc=0.8091 | tpr=0.7248 | fpr=0.0079 | 4517.1 samples/s | 17.6 steps/s
Avg test loss: 0.32993, Avg test acc: 0.81088, Avg tpr: 0.72827, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.51461 | acc=0.8704 | tpr=0.9779 | fpr=0.1315 | 4611.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.52185 | acc=0.8709 | tpr=0.9829 | fpr=0.1312 | 9140.8 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.52948 | acc=0.8697 | tpr=0.9856 | fpr=0.1324 | 9817.9 samples/s | 38.4 steps/s
[Step= 200] | Loss=0.53263 | acc=0.8700 | tpr=0.9869 | fpr=0.1322 | 8890.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.53319 | acc=0.8697 | tpr=0.9860 | fpr=0.1324 | 9086.4 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.53797 | acc=0.8695 | tpr=0.9847 | fpr=0.1326 | 9510.3 samples/s | 37.1 steps/s
[Step= 350] | Loss=0.54190 | acc=0.8691 | tpr=0.9856 | fpr=0.1330 | 9123.9 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.54519 | acc=0.8691 | tpr=0.9852 | fpr=0.1330 | 9352.5 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.54989 | acc=0.8690 | tpr=0.9854 | fpr=0.1331 | 9304.7 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.54967 | acc=0.8687 | tpr=0.9855 | fpr=0.1334 | 9725.3 samples/s | 38.0 steps/s
[Step= 550] | Loss=0.54769 | acc=0.8688 | tpr=0.9857 | fpr=0.1333 | 15276.4 samples/s | 59.7 steps/s
Avg test loss: 0.54704, Avg test acc: 0.86884, Avg tpr: 0.98574, Avg fpr: 0.13329, total FA: 18507

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.20133 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.968 | acc=0.8594 | 4108.6 samples/s | 64.2 steps/s
[Step=19250 Epoch=18.8] | Loss=0.03248 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=2.965 | acc=0.9844 | 4643.1 samples/s | 72.5 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02322 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=2.967 | acc=1.0000 | 4918.6 samples/s | 76.9 steps/s
[Step=19350 Epoch=18.9] | Loss=0.02003 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.969 | acc=0.9844 | 4897.2 samples/s | 76.5 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01851 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=2.973 | acc=0.9688 | 4902.9 samples/s | 76.6 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01682 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.976 | acc=0.9844 | 4865.4 samples/s | 76.0 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01591 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.979 | acc=0.9844 | 4953.5 samples/s | 77.4 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01504 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.982 | acc=0.9844 | 5058.9 samples/s | 79.0 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01476 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.985 | acc=1.0000 | 4934.1 samples/s | 77.1 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01448 | Reg=0.00213 | L2-Norm=14.606 | L2-Norm(final)=2.987 | acc=1.0000 | 4972.8 samples/s | 77.7 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01428 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=2.989 | acc=1.0000 | 4948.0 samples/s | 77.3 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01420 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.990 | acc=0.9844 | 4052.9 samples/s | 63.3 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01399 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=2.992 | acc=1.0000 | 3941.9 samples/s | 61.6 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01393 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.993 | acc=1.0000 | 3938.8 samples/s | 61.5 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01373 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.995 | acc=1.0000 | 3867.8 samples/s | 60.4 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01374 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.997 | acc=1.0000 | 3876.1 samples/s | 60.6 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01355 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.999 | acc=1.0000 | 3922.7 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.14184 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.966 | acc=0.9531 | 3513.9 samples/s | 54.9 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00469 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=2.954 | acc=1.0000 | 4785.9 samples/s | 74.8 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00245 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.956 | acc=1.0000 | 4719.5 samples/s | 73.7 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00165 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.958 | acc=1.0000 | 4773.6 samples/s | 74.6 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00125 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=2.959 | acc=1.0000 | 4672.4 samples/s | 73.0 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00103 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.961 | acc=1.0000 | 4766.1 samples/s | 74.5 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00086 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=2.962 | acc=1.0000 | 4853.5 samples/s | 75.8 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00074 | Reg=0.00212 | L2-Norm=14.543 | L2-Norm(final)=2.964 | acc=1.0000 | 4814.8 samples/s | 75.2 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00065 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.965 | acc=1.0000 | 4798.8 samples/s | 75.0 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00058 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=2.966 | acc=1.0000 | 4734.2 samples/s | 74.0 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00052 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=2.967 | acc=1.0000 | 4809.8 samples/s | 75.2 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00048 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=2.968 | acc=1.0000 | 1483.0 samples/s | 23.2 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00044 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.969 | acc=1.0000 | 4856.3 samples/s | 75.9 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00041 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.970 | acc=1.0000 | 4741.9 samples/s | 74.1 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00038 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=2.970 | acc=1.0000 | 4592.8 samples/s | 71.8 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00035 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=2.971 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00033 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=2.972 | acc=1.0000 | 4817.1 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26396 | acc=0.8405 | tpr=0.7713 | fpr=0.0094 | 4567.4 samples/s | 17.8 steps/s
Avg test loss: 0.26551, Avg test acc: 0.84221, Avg tpr: 0.77496, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.59784 | acc=0.8434 | tpr=0.9779 | fpr=0.1590 | 4620.9 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.60308 | acc=0.8439 | tpr=0.9829 | fpr=0.1587 | 9342.8 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.61089 | acc=0.8422 | tpr=0.9856 | fpr=0.1604 | 9095.1 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.61322 | acc=0.8422 | tpr=0.9869 | fpr=0.1604 | 9241.1 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.61487 | acc=0.8423 | tpr=0.9852 | fpr=0.1603 | 9192.3 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.61948 | acc=0.8425 | tpr=0.9840 | fpr=0.1601 | 9196.5 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.62406 | acc=0.8424 | tpr=0.9850 | fpr=0.1602 | 9170.8 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.62631 | acc=0.8421 | tpr=0.9847 | fpr=0.1605 | 9412.8 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.63059 | acc=0.8420 | tpr=0.9849 | fpr=0.1606 | 8907.8 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.63063 | acc=0.8418 | tpr=0.9850 | fpr=0.1607 | 9264.9 samples/s | 36.2 steps/s
[Step= 550] | Loss=0.62917 | acc=0.8419 | tpr=0.9853 | fpr=0.1607 | 16876.0 samples/s | 65.9 steps/s
Avg test loss: 0.62842, Avg test acc: 0.84199, Avg tpr: 0.98534, Avg fpr: 0.16061, total FA: 22301

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.08463 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.002 | acc=0.9531 | 3909.8 samples/s | 61.1 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02997 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.996 | acc=1.0000 | 4717.5 samples/s | 73.7 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02194 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.999 | acc=0.9844 | 4950.8 samples/s | 77.4 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01899 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=3.002 | acc=0.9844 | 4949.7 samples/s | 77.3 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01659 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=3.005 | acc=0.9844 | 4958.0 samples/s | 77.5 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01548 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=3.008 | acc=0.9844 | 5084.1 samples/s | 79.4 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01483 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=3.011 | acc=1.0000 | 4903.3 samples/s | 76.6 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01505 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=3.012 | acc=1.0000 | 4821.2 samples/s | 75.3 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01481 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=3.014 | acc=0.9844 | 4371.3 samples/s | 68.3 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01427 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=3.016 | acc=1.0000 | 3991.6 samples/s | 62.4 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01414 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.018 | acc=1.0000 | 3951.0 samples/s | 61.7 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01397 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=3.021 | acc=0.9844 | 3909.0 samples/s | 61.1 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01352 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=3.023 | acc=0.9844 | 3934.6 samples/s | 61.5 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01349 | Reg=0.00212 | L2-Norm=14.572 | L2-Norm(final)=3.025 | acc=0.9688 | 3923.2 samples/s | 61.3 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01321 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=3.027 | acc=0.9688 | 3877.1 samples/s | 60.6 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01312 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=3.029 | acc=0.9688 | 3928.1 samples/s | 61.4 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01325 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=3.031 | acc=0.9844 | 3923.6 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.19011 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.001 | acc=0.9062 | 3943.8 samples/s | 61.6 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00607 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.997 | acc=1.0000 | 4630.4 samples/s | 72.3 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00310 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.998 | acc=1.0000 | 4771.9 samples/s | 74.6 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00210 | Reg=0.00211 | L2-Norm=14.538 | L2-Norm(final)=3.000 | acc=1.0000 | 4765.9 samples/s | 74.5 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00159 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.001 | acc=1.0000 | 4745.5 samples/s | 74.1 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00128 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.003 | acc=1.0000 | 4733.4 samples/s | 74.0 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00107 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.005 | acc=1.0000 | 4877.5 samples/s | 76.2 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00092 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=3.006 | acc=1.0000 | 4877.6 samples/s | 76.2 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00081 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.008 | acc=1.0000 | 4911.6 samples/s | 76.7 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00072 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.009 | acc=1.0000 | 4657.9 samples/s | 72.8 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00065 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.010 | acc=1.0000 | 4802.2 samples/s | 75.0 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00059 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.011 | acc=1.0000 | 1461.9 samples/s | 22.8 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00055 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.012 | acc=1.0000 | 4799.6 samples/s | 75.0 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00050 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.013 | acc=1.0000 | 4829.2 samples/s | 75.5 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00047 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.014 | acc=1.0000 | 4819.1 samples/s | 75.3 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00044 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.014 | acc=1.0000 | 4753.5 samples/s | 74.3 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00041 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.015 | acc=1.0000 | 4828.5 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29648 | acc=0.8264 | tpr=0.7494 | fpr=0.0064 | 4502.4 samples/s | 17.6 steps/s
Avg test loss: 0.30017, Avg test acc: 0.82667, Avg tpr: 0.75124, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.50159 | acc=0.8700 | tpr=0.9779 | fpr=0.1319 | 4563.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.50801 | acc=0.8713 | tpr=0.9765 | fpr=0.1307 | 9449.5 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.51613 | acc=0.8695 | tpr=0.9813 | fpr=0.1326 | 9697.6 samples/s | 37.9 steps/s
[Step= 200] | Loss=0.51737 | acc=0.8695 | tpr=0.9836 | fpr=0.1326 | 9128.7 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.51930 | acc=0.8697 | tpr=0.9834 | fpr=0.1323 | 8904.2 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.52402 | acc=0.8695 | tpr=0.9825 | fpr=0.1326 | 9196.5 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.52801 | acc=0.8692 | tpr=0.9837 | fpr=0.1328 | 9501.2 samples/s | 37.1 steps/s
[Step= 400] | Loss=0.53027 | acc=0.8690 | tpr=0.9830 | fpr=0.1330 | 9077.9 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.53380 | acc=0.8689 | tpr=0.9834 | fpr=0.1332 | 9116.3 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.53356 | acc=0.8685 | tpr=0.9833 | fpr=0.1335 | 9248.6 samples/s | 36.1 steps/s
[Step= 550] | Loss=0.53192 | acc=0.8687 | tpr=0.9841 | fpr=0.1334 | 17321.0 samples/s | 67.7 steps/s
Avg test loss: 0.53143, Avg test acc: 0.86872, Avg tpr: 0.98415, Avg fpr: 0.13338, total FA: 18519

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.16523 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.038 | acc=0.9062 | 3719.7 samples/s | 58.1 steps/s
[Step=20850 Epoch=20.4] | Loss=0.03290 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.030 | acc=1.0000 | 4808.9 samples/s | 75.1 steps/s
[Step=20900 Epoch=20.4] | Loss=0.02403 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.031 | acc=1.0000 | 4914.1 samples/s | 76.8 steps/s
[Step=20950 Epoch=20.5] | Loss=0.02020 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=3.034 | acc=0.9531 | 5002.1 samples/s | 78.2 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01756 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.037 | acc=0.9844 | 4947.9 samples/s | 77.3 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01589 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.041 | acc=1.0000 | 4922.9 samples/s | 76.9 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01531 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.044 | acc=1.0000 | 4938.4 samples/s | 77.2 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01471 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.047 | acc=0.9688 | 4959.9 samples/s | 77.5 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01412 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=3.049 | acc=1.0000 | 4349.2 samples/s | 68.0 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01385 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=3.052 | acc=0.9844 | 3868.6 samples/s | 60.4 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01395 | Reg=0.00212 | L2-Norm=14.545 | L2-Norm(final)=3.053 | acc=0.9844 | 3922.7 samples/s | 61.3 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01417 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=3.054 | acc=1.0000 | 3956.7 samples/s | 61.8 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01387 | Reg=0.00212 | L2-Norm=14.549 | L2-Norm(final)=3.055 | acc=1.0000 | 3894.4 samples/s | 60.8 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01371 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=3.057 | acc=1.0000 | 3944.7 samples/s | 61.6 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01363 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=3.059 | acc=0.9844 | 3930.7 samples/s | 61.4 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01362 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=3.060 | acc=0.9844 | 3927.0 samples/s | 61.4 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01350 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=3.061 | acc=1.0000 | 3913.3 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.03443 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.039 | acc=0.9688 | 3038.1 samples/s | 47.5 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00229 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.046 | acc=1.0000 | 4559.8 samples/s | 71.2 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00116 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.049 | acc=1.0000 | 4842.1 samples/s | 75.7 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00080 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.052 | acc=1.0000 | 4794.8 samples/s | 74.9 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00061 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.053 | acc=1.0000 | 4729.3 samples/s | 73.9 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00049 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.055 | acc=1.0000 | 4768.0 samples/s | 74.5 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00041 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.056 | acc=1.0000 | 4859.3 samples/s | 75.9 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00036 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.057 | acc=1.0000 | 4819.9 samples/s | 75.3 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.058 | acc=1.0000 | 4711.7 samples/s | 73.6 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00028 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.059 | acc=1.0000 | 4777.9 samples/s | 74.7 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00025 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.059 | acc=1.0000 | 4829.9 samples/s | 75.5 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.060 | acc=1.0000 | 1489.5 samples/s | 23.3 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00021 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.061 | acc=1.0000 | 4763.7 samples/s | 74.4 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00020 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.061 | acc=1.0000 | 4764.0 samples/s | 74.4 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00018 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=3.062 | acc=1.0000 | 4811.9 samples/s | 75.2 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00017 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.063 | acc=1.0000 | 4755.1 samples/s | 74.3 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00016 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.063 | acc=1.0000 | 4679.7 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30372 | acc=0.8239 | tpr=0.7474 | fpr=0.0099 | 4560.1 samples/s | 17.8 steps/s
Avg test loss: 0.30672, Avg test acc: 0.82515, Avg tpr: 0.74966, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.60630 | acc=0.8456 | tpr=0.9779 | fpr=0.1568 | 4575.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.61081 | acc=0.8468 | tpr=0.9829 | fpr=0.1557 | 9171.0 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.61896 | acc=0.8455 | tpr=0.9827 | fpr=0.1570 | 10000.6 samples/s | 39.1 steps/s
[Step= 200] | Loss=0.61894 | acc=0.8458 | tpr=0.9847 | fpr=0.1567 | 8875.8 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.62032 | acc=0.8458 | tpr=0.9843 | fpr=0.1567 | 9273.6 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.62409 | acc=0.8461 | tpr=0.9840 | fpr=0.1564 | 9261.7 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.62836 | acc=0.8459 | tpr=0.9850 | fpr=0.1567 | 9012.3 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.63077 | acc=0.8456 | tpr=0.9852 | fpr=0.1569 | 9489.8 samples/s | 37.1 steps/s
[Step= 450] | Loss=0.63516 | acc=0.8455 | tpr=0.9854 | fpr=0.1571 | 8824.9 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.63504 | acc=0.8451 | tpr=0.9855 | fpr=0.1574 | 9733.5 samples/s | 38.0 steps/s
[Step= 550] | Loss=0.63311 | acc=0.8454 | tpr=0.9861 | fpr=0.1572 | 16001.0 samples/s | 62.5 steps/s
Avg test loss: 0.63246, Avg test acc: 0.84548, Avg tpr: 0.98613, Avg fpr: 0.15708, total FA: 21810

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.17764 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.077 | acc=0.8750 | 3612.7 samples/s | 56.4 steps/s
[Step=21650 Epoch=21.1] | Loss=0.02294 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.073 | acc=1.0000 | 4803.2 samples/s | 75.0 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01665 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.074 | acc=0.9844 | 4941.5 samples/s | 77.2 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01542 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.077 | acc=0.9844 | 4861.7 samples/s | 76.0 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01468 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.078 | acc=0.9531 | 4834.6 samples/s | 75.5 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01425 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.079 | acc=0.9844 | 5070.2 samples/s | 79.2 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01381 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.080 | acc=1.0000 | 4810.8 samples/s | 75.2 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01349 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.082 | acc=0.9844 | 5013.4 samples/s | 78.3 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01323 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.084 | acc=0.9844 | 5068.4 samples/s | 79.2 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01293 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.085 | acc=1.0000 | 4874.6 samples/s | 76.2 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01270 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.087 | acc=0.9844 | 5054.6 samples/s | 79.0 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01262 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.089 | acc=1.0000 | 4852.8 samples/s | 75.8 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01258 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.092 | acc=0.9844 | 4922.3 samples/s | 76.9 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01258 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.094 | acc=0.9844 | 4749.6 samples/s | 74.2 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01268 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.095 | acc=0.9844 | 3960.0 samples/s | 61.9 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01261 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.097 | acc=1.0000 | 3883.0 samples/s | 60.7 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01266 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=3.099 | acc=0.9844 | 3888.0 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.03399 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.078 | acc=0.9688 | 2984.9 samples/s | 46.6 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00206 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=3.080 | acc=1.0000 | 4687.4 samples/s | 73.2 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00105 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.082 | acc=1.0000 | 4756.6 samples/s | 74.3 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00071 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.083 | acc=1.0000 | 4652.8 samples/s | 72.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00054 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.084 | acc=1.0000 | 4750.5 samples/s | 74.2 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00043 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.084 | acc=1.0000 | 4799.9 samples/s | 75.0 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00036 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.085 | acc=1.0000 | 4693.3 samples/s | 73.3 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.086 | acc=1.0000 | 4769.9 samples/s | 74.5 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00027 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.086 | acc=1.0000 | 4720.7 samples/s | 73.8 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00024 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.087 | acc=1.0000 | 4815.1 samples/s | 75.2 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00022 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.087 | acc=1.0000 | 4891.8 samples/s | 76.4 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00020 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.087 | acc=1.0000 | 1489.1 samples/s | 23.3 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00018 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.088 | acc=1.0000 | 5098.3 samples/s | 79.7 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00017 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.088 | acc=1.0000 | 4737.2 samples/s | 74.0 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00016 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.089 | acc=1.0000 | 4743.8 samples/s | 74.1 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00015 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.089 | acc=1.0000 | 4833.4 samples/s | 75.5 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00014 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.089 | acc=1.0000 | 4707.8 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34800 | acc=0.8103 | tpr=0.7255 | fpr=0.0055 | 4559.7 samples/s | 17.8 steps/s
Avg test loss: 0.35076, Avg test acc: 0.80900, Avg tpr: 0.72472, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.55099 | acc=0.8669 | tpr=0.9779 | fpr=0.1351 | 4565.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.55830 | acc=0.8660 | tpr=0.9808 | fpr=0.1362 | 9413.7 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.56518 | acc=0.8650 | tpr=0.9827 | fpr=0.1372 | 9207.1 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.56577 | acc=0.8654 | tpr=0.9847 | fpr=0.1368 | 9439.5 samples/s | 36.9 steps/s
[Step= 250] | Loss=0.56720 | acc=0.8651 | tpr=0.9834 | fpr=0.1370 | 9231.5 samples/s | 36.1 steps/s
[Step= 300] | Loss=0.57163 | acc=0.8651 | tpr=0.9833 | fpr=0.1370 | 9084.0 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.57588 | acc=0.8647 | tpr=0.9850 | fpr=0.1375 | 9411.2 samples/s | 36.8 steps/s
[Step= 400] | Loss=0.57761 | acc=0.8644 | tpr=0.9847 | fpr=0.1378 | 9088.1 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.58206 | acc=0.8641 | tpr=0.9849 | fpr=0.1381 | 9486.1 samples/s | 37.1 steps/s
[Step= 500] | Loss=0.58226 | acc=0.8637 | tpr=0.9846 | fpr=0.1384 | 9025.6 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.58066 | acc=0.8639 | tpr=0.9857 | fpr=0.1383 | 16903.3 samples/s | 66.0 steps/s
Avg test loss: 0.58002, Avg test acc: 0.86389, Avg tpr: 0.98574, Avg fpr: 0.13832, total FA: 19206

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.13171 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.107 | acc=0.9375 | 3691.2 samples/s | 57.7 steps/s
[Step=22450 Epoch=21.9] | Loss=0.03033 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=3.099 | acc=0.9531 | 5043.4 samples/s | 78.8 steps/s
[Step=22500 Epoch=22.0] | Loss=0.02104 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.102 | acc=1.0000 | 4930.0 samples/s | 77.0 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01750 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.107 | acc=1.0000 | 4764.6 samples/s | 74.4 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01530 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=3.110 | acc=1.0000 | 3932.2 samples/s | 61.4 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01487 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.113 | acc=0.9844 | 3870.5 samples/s | 60.5 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01439 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=3.114 | acc=1.0000 | 3910.5 samples/s | 61.1 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01410 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.116 | acc=0.9844 | 3852.1 samples/s | 60.2 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01344 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.118 | acc=1.0000 | 3908.5 samples/s | 61.1 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01335 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.120 | acc=1.0000 | 3927.9 samples/s | 61.4 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01318 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.122 | acc=0.9844 | 3931.0 samples/s | 61.4 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01316 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.124 | acc=0.9688 | 3873.1 samples/s | 60.5 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01311 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.126 | acc=0.9844 | 3934.5 samples/s | 61.5 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01315 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.128 | acc=1.0000 | 3926.4 samples/s | 61.4 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01291 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.130 | acc=1.0000 | 3915.4 samples/s | 61.2 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01274 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.132 | acc=1.0000 | 3876.8 samples/s | 60.6 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01278 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.134 | acc=0.9844 | 3903.7 samples/s | 61.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.05950 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.107 | acc=0.9688 | 2917.4 samples/s | 45.6 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00430 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.103 | acc=1.0000 | 4794.5 samples/s | 74.9 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00222 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.105 | acc=1.0000 | 4806.2 samples/s | 75.1 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00152 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.108 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00115 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.110 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00106 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.111 | acc=1.0000 | 4804.6 samples/s | 75.1 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00111 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.112 | acc=1.0000 | 4896.4 samples/s | 76.5 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00096 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.113 | acc=1.0000 | 4741.9 samples/s | 74.1 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00085 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.114 | acc=1.0000 | 4732.2 samples/s | 73.9 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00076 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.115 | acc=1.0000 | 4846.4 samples/s | 75.7 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00069 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.116 | acc=1.0000 | 4823.4 samples/s | 75.4 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00063 | Reg=0.00208 | L2-Norm=14.416 | L2-Norm(final)=3.117 | acc=1.0000 | 1523.8 samples/s | 23.8 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00058 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.118 | acc=1.0000 | 4856.3 samples/s | 75.9 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00054 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.118 | acc=1.0000 | 4811.3 samples/s | 75.2 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00050 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.119 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00047 | Reg=0.00207 | L2-Norm=14.405 | L2-Norm(final)=3.120 | acc=1.0000 | 4891.1 samples/s | 76.4 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00044 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=3.120 | acc=1.0000 | 4950.6 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39527 | acc=0.7892 | tpr=0.6956 | fpr=0.0074 | 4691.9 samples/s | 18.3 steps/s
Avg test loss: 0.39861, Avg test acc: 0.78832, Avg tpr: 0.69546, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.44439 | acc=0.8880 | tpr=0.9823 | fpr=0.1136 | 4628.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.45480 | acc=0.8883 | tpr=0.9851 | fpr=0.1135 | 9233.2 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.46418 | acc=0.8877 | tpr=0.9841 | fpr=0.1140 | 9273.0 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.46509 | acc=0.8884 | tpr=0.9858 | fpr=0.1134 | 9229.6 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.46463 | acc=0.8881 | tpr=0.9852 | fpr=0.1137 | 9260.6 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.46884 | acc=0.8877 | tpr=0.9840 | fpr=0.1141 | 9363.4 samples/s | 36.6 steps/s
[Step= 350] | Loss=0.47304 | acc=0.8871 | tpr=0.9843 | fpr=0.1147 | 9277.4 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.47554 | acc=0.8868 | tpr=0.9841 | fpr=0.1150 | 9272.8 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.47983 | acc=0.8866 | tpr=0.9844 | fpr=0.1151 | 9464.0 samples/s | 37.0 steps/s
[Step= 500] | Loss=0.47880 | acc=0.8866 | tpr=0.9841 | fpr=0.1152 | 9055.1 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.47696 | acc=0.8866 | tpr=0.9853 | fpr=0.1152 | 17081.3 samples/s | 66.7 steps/s
Avg test loss: 0.47650, Avg test acc: 0.88667, Avg tpr: 0.98534, Avg fpr: 0.11513, total FA: 15985

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.15649 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.144 | acc=0.8906 | 3647.2 samples/s | 57.0 steps/s
[Step=23250 Epoch=22.7] | Loss=0.02880 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=3.138 | acc=0.9688 | 4845.1 samples/s | 75.7 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02000 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.142 | acc=1.0000 | 4987.6 samples/s | 77.9 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01776 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.145 | acc=0.9844 | 4848.8 samples/s | 75.8 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01640 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.146 | acc=1.0000 | 5022.4 samples/s | 78.5 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01548 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.148 | acc=0.9844 | 5000.2 samples/s | 78.1 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01479 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=3.151 | acc=1.0000 | 4955.9 samples/s | 77.4 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01431 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.153 | acc=0.9688 | 4874.8 samples/s | 76.2 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01407 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.155 | acc=1.0000 | 4947.1 samples/s | 77.3 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01407 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=3.157 | acc=0.9844 | 4980.7 samples/s | 77.8 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01357 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=3.158 | acc=1.0000 | 4973.1 samples/s | 77.7 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01336 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.160 | acc=0.9688 | 4864.7 samples/s | 76.0 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01315 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.163 | acc=0.9844 | 4931.4 samples/s | 77.1 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01340 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.165 | acc=1.0000 | 5044.8 samples/s | 78.8 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01336 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.166 | acc=0.9844 | 4851.2 samples/s | 75.8 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01316 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.167 | acc=0.9844 | 5054.8 samples/s | 79.0 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01298 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.169 | acc=1.0000 | 4974.7 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.00910 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.144 | acc=1.0000 | 3783.8 samples/s | 59.1 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00310 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.145 | acc=1.0000 | 4633.1 samples/s | 72.4 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00196 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.145 | acc=1.0000 | 4691.4 samples/s | 73.3 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00136 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.146 | acc=1.0000 | 4766.0 samples/s | 74.5 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00102 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.147 | acc=1.0000 | 4738.0 samples/s | 74.0 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00083 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.148 | acc=1.0000 | 4855.1 samples/s | 75.9 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00069 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.148 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00059 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.149 | acc=1.0000 | 4800.8 samples/s | 75.0 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00052 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.150 | acc=1.0000 | 4754.8 samples/s | 74.3 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00047 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=3.150 | acc=1.0000 | 4786.6 samples/s | 74.8 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00042 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.151 | acc=1.0000 | 4899.0 samples/s | 76.5 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00039 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.151 | acc=1.0000 | 1515.3 samples/s | 23.7 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00035 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.151 | acc=1.0000 | 4950.7 samples/s | 77.4 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00033 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.152 | acc=1.0000 | 4770.1 samples/s | 74.5 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00030 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.152 | acc=1.0000 | 4822.2 samples/s | 75.3 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00028 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.153 | acc=1.0000 | 4692.2 samples/s | 73.3 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00027 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.153 | acc=1.0000 | 4744.2 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39215 | acc=0.7918 | tpr=0.6990 | fpr=0.0067 | 4536.2 samples/s | 17.7 steps/s
Avg test loss: 0.39675, Avg test acc: 0.79085, Avg tpr: 0.69890, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.43758 | acc=0.8950 | tpr=0.9823 | fpr=0.1066 | 4603.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.44699 | acc=0.8941 | tpr=0.9829 | fpr=0.1075 | 9009.5 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.45372 | acc=0.8937 | tpr=0.9841 | fpr=0.1080 | 9225.4 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.45494 | acc=0.8937 | tpr=0.9858 | fpr=0.1080 | 9249.1 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.45595 | acc=0.8940 | tpr=0.9860 | fpr=0.1077 | 9626.4 samples/s | 37.6 steps/s
[Step= 300] | Loss=0.46046 | acc=0.8938 | tpr=0.9847 | fpr=0.1079 | 9261.3 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.46451 | acc=0.8935 | tpr=0.9850 | fpr=0.1082 | 8982.4 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.46667 | acc=0.8931 | tpr=0.9847 | fpr=0.1085 | 9410.6 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.47068 | acc=0.8929 | tpr=0.9844 | fpr=0.1088 | 9037.8 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.46955 | acc=0.8926 | tpr=0.9841 | fpr=0.1090 | 9351.1 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.46803 | acc=0.8929 | tpr=0.9845 | fpr=0.1087 | 17135.5 samples/s | 66.9 steps/s
Avg test loss: 0.46741, Avg test acc: 0.89296, Avg tpr: 0.98455, Avg fpr: 0.10871, total FA: 15094

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.19774 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.174 | acc=0.8750 | 3876.5 samples/s | 60.6 steps/s
[Step=24050 Epoch=23.5] | Loss=0.03838 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.168 | acc=0.9688 | 4694.2 samples/s | 73.3 steps/s
[Step=24100 Epoch=23.5] | Loss=0.02494 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.168 | acc=1.0000 | 4999.4 samples/s | 78.1 steps/s
[Step=24150 Epoch=23.6] | Loss=0.02006 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.171 | acc=1.0000 | 4907.5 samples/s | 76.7 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01731 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.173 | acc=1.0000 | 4885.8 samples/s | 76.3 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01530 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.176 | acc=1.0000 | 4957.3 samples/s | 77.5 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01428 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.178 | acc=1.0000 | 4867.4 samples/s | 76.1 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01356 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.180 | acc=1.0000 | 5062.9 samples/s | 79.1 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01293 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=3.182 | acc=1.0000 | 4940.8 samples/s | 77.2 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01240 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.184 | acc=1.0000 | 4952.4 samples/s | 77.4 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01202 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.186 | acc=0.9688 | 4863.4 samples/s | 76.0 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01172 | Reg=0.00207 | L2-Norm=14.405 | L2-Norm(final)=3.188 | acc=1.0000 | 5069.0 samples/s | 79.2 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01169 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.190 | acc=1.0000 | 5017.7 samples/s | 78.4 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01147 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.192 | acc=1.0000 | 4873.8 samples/s | 76.2 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01119 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.193 | acc=0.9844 | 5084.2 samples/s | 79.4 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01108 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.195 | acc=0.9844 | 5007.2 samples/s | 78.2 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01088 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=3.196 | acc=1.0000 | 5008.5 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.00451 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.175 | acc=1.0000 | 3635.4 samples/s | 56.8 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00177 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.178 | acc=1.0000 | 4908.1 samples/s | 76.7 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00091 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.178 | acc=1.0000 | 4939.0 samples/s | 77.2 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00064 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.179 | acc=1.0000 | 4692.2 samples/s | 73.3 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00049 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.180 | acc=1.0000 | 4843.0 samples/s | 75.7 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.181 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.181 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.182 | acc=1.0000 | 4774.3 samples/s | 74.6 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00025 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.183 | acc=1.0000 | 4541.8 samples/s | 71.0 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00024 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.183 | acc=1.0000 | 4795.3 samples/s | 74.9 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00022 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.184 | acc=1.0000 | 4969.5 samples/s | 77.6 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00020 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=3.184 | acc=1.0000 | 1532.9 samples/s | 24.0 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00018 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.185 | acc=1.0000 | 4808.3 samples/s | 75.1 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00017 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.185 | acc=1.0000 | 4590.9 samples/s | 71.7 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00016 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.186 | acc=1.0000 | 4771.1 samples/s | 74.5 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00015 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.186 | acc=1.0000 | 4625.6 samples/s | 72.3 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00014 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=3.187 | acc=1.0000 | 3787.3 samples/s | 59.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31593 | acc=0.8363 | tpr=0.7645 | fpr=0.0077 | 4218.7 samples/s | 16.5 steps/s
Avg test loss: 0.32191, Avg test acc: 0.83384, Avg tpr: 0.76167, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.52006 | acc=0.8770 | tpr=0.9779 | fpr=0.1249 | 4562.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.52872 | acc=0.8758 | tpr=0.9829 | fpr=0.1262 | 9346.8 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.53470 | acc=0.8746 | tpr=0.9841 | fpr=0.1274 | 9463.2 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.53575 | acc=0.8749 | tpr=0.9858 | fpr=0.1272 | 9854.3 samples/s | 38.5 steps/s
[Step= 250] | Loss=0.53658 | acc=0.8752 | tpr=0.9860 | fpr=0.1268 | 9088.1 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.54106 | acc=0.8751 | tpr=0.9855 | fpr=0.1269 | 8790.9 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.54603 | acc=0.8746 | tpr=0.9856 | fpr=0.1274 | 9401.9 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.54827 | acc=0.8745 | tpr=0.9852 | fpr=0.1275 | 9806.9 samples/s | 38.3 steps/s
[Step= 450] | Loss=0.55242 | acc=0.8743 | tpr=0.9854 | fpr=0.1277 | 8800.4 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.55152 | acc=0.8739 | tpr=0.9850 | fpr=0.1281 | 9377.4 samples/s | 36.6 steps/s
[Step= 550] | Loss=0.54999 | acc=0.8738 | tpr=0.9857 | fpr=0.1282 | 17497.5 samples/s | 68.3 steps/s
Avg test loss: 0.54935, Avg test acc: 0.87385, Avg tpr: 0.98534, Avg fpr: 0.12818, total FA: 17797

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.22798 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.206 | acc=0.8438 | 3657.9 samples/s | 57.2 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02604 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.204 | acc=0.9844 | 4920.8 samples/s | 76.9 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01713 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.205 | acc=1.0000 | 5066.8 samples/s | 79.2 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01425 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.207 | acc=0.9688 | 5034.2 samples/s | 78.7 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01301 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.209 | acc=1.0000 | 4879.3 samples/s | 76.2 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01221 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.211 | acc=0.9844 | 4820.2 samples/s | 75.3 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01164 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=3.213 | acc=1.0000 | 4985.5 samples/s | 77.9 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01136 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.214 | acc=1.0000 | 4889.0 samples/s | 76.4 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01118 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.215 | acc=0.9844 | 4312.3 samples/s | 67.4 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01086 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.217 | acc=1.0000 | 3917.4 samples/s | 61.2 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01075 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.218 | acc=1.0000 | 3925.9 samples/s | 61.3 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01059 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.219 | acc=0.9844 | 3948.1 samples/s | 61.7 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01030 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.220 | acc=1.0000 | 3945.7 samples/s | 61.7 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01012 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.222 | acc=0.9844 | 3897.4 samples/s | 60.9 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00999 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=3.223 | acc=1.0000 | 3902.2 samples/s | 61.0 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00985 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.224 | acc=1.0000 | 3907.4 samples/s | 61.1 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01001 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.226 | acc=1.0000 | 3916.6 samples/s | 61.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.00665 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.206 | acc=1.0000 | 2947.3 samples/s | 46.1 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00360 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.209 | acc=1.0000 | 4498.7 samples/s | 70.3 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00191 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.208 | acc=1.0000 | 4701.1 samples/s | 73.5 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00128 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.209 | acc=1.0000 | 4866.7 samples/s | 76.0 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00097 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.209 | acc=1.0000 | 4846.8 samples/s | 75.7 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00078 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.210 | acc=1.0000 | 4707.3 samples/s | 73.6 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00065 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.210 | acc=1.0000 | 4830.6 samples/s | 75.5 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00056 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.210 | acc=1.0000 | 4935.9 samples/s | 77.1 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00049 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.211 | acc=1.0000 | 4896.6 samples/s | 76.5 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00044 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.211 | acc=1.0000 | 4758.6 samples/s | 74.4 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.211 | acc=1.0000 | 4769.8 samples/s | 74.5 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.212 | acc=1.0000 | 1480.9 samples/s | 23.1 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.212 | acc=1.0000 | 4816.7 samples/s | 75.3 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00030 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=3.212 | acc=1.0000 | 4629.1 samples/s | 72.3 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00028 | Reg=0.00206 | L2-Norm=14.338 | L2-Norm(final)=3.213 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00027 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=3.213 | acc=1.0000 | 4803.5 samples/s | 75.1 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.213 | acc=1.0000 | 4762.6 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30222 | acc=0.8405 | tpr=0.7710 | fpr=0.0084 | 4601.9 samples/s | 18.0 steps/s
Avg test loss: 0.30614, Avg test acc: 0.84049, Avg tpr: 0.77146, Avg fpr: 0.00769, total FA: 60

Testing server on iccad2012
[Step=  50] | Loss=0.53423 | acc=0.8745 | tpr=0.9779 | fpr=0.1274 | 4645.2 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.54146 | acc=0.8756 | tpr=0.9787 | fpr=0.1263 | 8901.9 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.54954 | acc=0.8739 | tpr=0.9813 | fpr=0.1281 | 9765.5 samples/s | 38.1 steps/s
[Step= 200] | Loss=0.55109 | acc=0.8738 | tpr=0.9836 | fpr=0.1282 | 9308.0 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.55216 | acc=0.8742 | tpr=0.9834 | fpr=0.1278 | 8715.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.55731 | acc=0.8737 | tpr=0.9833 | fpr=0.1283 | 9641.9 samples/s | 37.7 steps/s
[Step= 350] | Loss=0.56200 | acc=0.8735 | tpr=0.9843 | fpr=0.1285 | 8862.9 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.56403 | acc=0.8734 | tpr=0.9841 | fpr=0.1286 | 9330.7 samples/s | 36.4 steps/s
[Step= 450] | Loss=0.56859 | acc=0.8733 | tpr=0.9844 | fpr=0.1288 | 9273.2 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.56788 | acc=0.8728 | tpr=0.9837 | fpr=0.1292 | 9061.5 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.56625 | acc=0.8728 | tpr=0.9845 | fpr=0.1292 | 17982.3 samples/s | 70.2 steps/s
Avg test loss: 0.56568, Avg test acc: 0.87285, Avg tpr: 0.98415, Avg fpr: 0.12918, total FA: 17936

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.13248 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.230 | acc=0.9062 | 3701.8 samples/s | 57.8 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02624 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.224 | acc=1.0000 | 4775.0 samples/s | 74.6 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01744 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.225 | acc=1.0000 | 5019.5 samples/s | 78.4 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01384 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.228 | acc=0.9688 | 4756.6 samples/s | 74.3 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01215 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.230 | acc=0.9844 | 5044.1 samples/s | 78.8 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01126 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.232 | acc=1.0000 | 5044.9 samples/s | 78.8 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01070 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.234 | acc=0.9844 | 5189.6 samples/s | 81.1 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01048 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.236 | acc=0.9688 | 4905.6 samples/s | 76.7 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01031 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.238 | acc=1.0000 | 4794.3 samples/s | 74.9 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01007 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.239 | acc=0.9844 | 5025.4 samples/s | 78.5 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00997 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.241 | acc=0.9688 | 4825.3 samples/s | 75.4 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01005 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.242 | acc=1.0000 | 4962.4 samples/s | 77.5 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00988 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=3.244 | acc=1.0000 | 4979.8 samples/s | 77.8 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00999 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.245 | acc=0.9688 | 5061.3 samples/s | 79.1 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00983 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.246 | acc=0.9844 | 5038.4 samples/s | 78.7 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00968 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.248 | acc=0.9844 | 5132.2 samples/s | 80.2 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00963 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.249 | acc=1.0000 | 4968.3 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.04351 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.230 | acc=0.9531 | 3687.7 samples/s | 57.6 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00366 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=3.232 | acc=1.0000 | 4573.5 samples/s | 71.5 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00184 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.231 | acc=1.0000 | 4750.3 samples/s | 74.2 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00123 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.231 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00093 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.231 | acc=1.0000 | 4606.4 samples/s | 72.0 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00074 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.232 | acc=1.0000 | 4811.2 samples/s | 75.2 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00062 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.232 | acc=1.0000 | 4784.4 samples/s | 74.8 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00053 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.232 | acc=1.0000 | 4879.0 samples/s | 76.2 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00047 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.232 | acc=1.0000 | 4831.2 samples/s | 75.5 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00042 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=3.232 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00038 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.232 | acc=1.0000 | 4997.8 samples/s | 78.1 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00034 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.233 | acc=1.0000 | 1488.5 samples/s | 23.3 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00031 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.233 | acc=1.0000 | 4944.1 samples/s | 77.3 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00029 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.233 | acc=1.0000 | 4735.4 samples/s | 74.0 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00027 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.233 | acc=1.0000 | 4644.4 samples/s | 72.6 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.233 | acc=1.0000 | 4718.2 samples/s | 73.7 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00024 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.233 | acc=1.0000 | 4720.0 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32514 | acc=0.8334 | tpr=0.7594 | fpr=0.0057 | 4546.2 samples/s | 17.8 steps/s
Avg test loss: 0.32935, Avg test acc: 0.83268, Avg tpr: 0.75952, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.51515 | acc=0.8832 | tpr=0.9779 | fpr=0.1185 | 4624.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.52373 | acc=0.8837 | tpr=0.9765 | fpr=0.1181 | 9129.9 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.53074 | acc=0.8819 | tpr=0.9798 | fpr=0.1199 | 8936.5 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.53174 | acc=0.8819 | tpr=0.9825 | fpr=0.1199 | 9400.2 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.53272 | acc=0.8825 | tpr=0.9825 | fpr=0.1193 | 9091.7 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.53804 | acc=0.8824 | tpr=0.9825 | fpr=0.1194 | 9647.5 samples/s | 37.7 steps/s
[Step= 350] | Loss=0.54272 | acc=0.8823 | tpr=0.9837 | fpr=0.1196 | 9310.6 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.54480 | acc=0.8821 | tpr=0.9830 | fpr=0.1197 | 9533.3 samples/s | 37.2 steps/s
[Step= 450] | Loss=0.54932 | acc=0.8819 | tpr=0.9834 | fpr=0.1199 | 8710.3 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.54863 | acc=0.8816 | tpr=0.9828 | fpr=0.1203 | 9395.9 samples/s | 36.7 steps/s
[Step= 550] | Loss=0.54682 | acc=0.8818 | tpr=0.9829 | fpr=0.1201 | 16241.0 samples/s | 63.4 steps/s
Avg test loss: 0.54628, Avg test acc: 0.88181, Avg tpr: 0.98257, Avg fpr: 0.12002, total FA: 16665

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.24849 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.251 | acc=0.8750 | 3924.5 samples/s | 61.3 steps/s
[Step=26450 Epoch=25.8] | Loss=0.03048 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.244 | acc=1.0000 | 4424.5 samples/s | 69.1 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01931 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.244 | acc=1.0000 | 4931.1 samples/s | 77.0 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01568 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.246 | acc=1.0000 | 4811.5 samples/s | 75.2 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01337 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=3.248 | acc=1.0000 | 4980.2 samples/s | 77.8 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01235 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.250 | acc=0.9844 | 4896.4 samples/s | 76.5 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01154 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.253 | acc=0.9844 | 5001.0 samples/s | 78.1 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01105 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.255 | acc=0.9844 | 4925.2 samples/s | 77.0 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01071 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.257 | acc=0.9844 | 4865.4 samples/s | 76.0 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01022 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.258 | acc=1.0000 | 4061.0 samples/s | 63.5 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01006 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.260 | acc=0.9844 | 3919.4 samples/s | 61.2 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00996 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.262 | acc=0.9844 | 3949.7 samples/s | 61.7 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00965 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.263 | acc=1.0000 | 3953.4 samples/s | 61.8 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00980 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.265 | acc=0.9844 | 3912.5 samples/s | 61.1 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00973 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.266 | acc=0.9688 | 3934.7 samples/s | 61.5 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00972 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.267 | acc=1.0000 | 3845.1 samples/s | 60.1 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00966 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.269 | acc=0.9688 | 3937.7 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.01992 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.252 | acc=0.9844 | 3810.0 samples/s | 59.5 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00235 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.255 | acc=1.0000 | 4277.4 samples/s | 66.8 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00119 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.257 | acc=1.0000 | 4770.1 samples/s | 74.5 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00080 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.257 | acc=1.0000 | 4727.4 samples/s | 73.9 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00060 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.258 | acc=1.0000 | 4724.6 samples/s | 73.8 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00049 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.259 | acc=1.0000 | 4743.6 samples/s | 74.1 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00041 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.259 | acc=1.0000 | 4784.4 samples/s | 74.8 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.260 | acc=1.0000 | 4698.0 samples/s | 73.4 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00031 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.260 | acc=1.0000 | 4730.3 samples/s | 73.9 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00028 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.261 | acc=1.0000 | 4029.3 samples/s | 63.0 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.261 | acc=1.0000 | 3779.0 samples/s | 59.0 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.261 | acc=1.0000 | 1504.1 samples/s | 23.5 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.262 | acc=1.0000 | 4876.3 samples/s | 76.2 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00019 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.262 | acc=1.0000 | 4863.6 samples/s | 76.0 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00018 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.262 | acc=1.0000 | 4784.4 samples/s | 74.8 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00017 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.263 | acc=1.0000 | 4789.1 samples/s | 74.8 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00016 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.263 | acc=1.0000 | 4722.4 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26355 | acc=0.8565 | tpr=0.7943 | fpr=0.0084 | 4676.0 samples/s | 18.3 steps/s
Avg test loss: 0.26903, Avg test acc: 0.85628, Avg tpr: 0.79478, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.56352 | acc=0.8687 | tpr=0.9779 | fpr=0.1333 | 4532.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.57255 | acc=0.8693 | tpr=0.9765 | fpr=0.1327 | 9355.9 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.57940 | acc=0.8678 | tpr=0.9798 | fpr=0.1343 | 9196.2 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.58075 | acc=0.8676 | tpr=0.9825 | fpr=0.1345 | 9466.4 samples/s | 37.0 steps/s
[Step= 250] | Loss=0.58188 | acc=0.8677 | tpr=0.9834 | fpr=0.1345 | 9070.4 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.58687 | acc=0.8680 | tpr=0.9833 | fpr=0.1341 | 9264.4 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.59168 | acc=0.8675 | tpr=0.9843 | fpr=0.1346 | 8476.5 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.59396 | acc=0.8674 | tpr=0.9830 | fpr=0.1347 | 9100.5 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.59835 | acc=0.8674 | tpr=0.9834 | fpr=0.1347 | 9094.2 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.59794 | acc=0.8669 | tpr=0.9833 | fpr=0.1352 | 9302.2 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.59618 | acc=0.8670 | tpr=0.9833 | fpr=0.1351 | 17052.3 samples/s | 66.6 steps/s
Avg test loss: 0.59550, Avg test acc: 0.86707, Avg tpr: 0.98296, Avg fpr: 0.13503, total FA: 18749

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.15533 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.277 | acc=0.9062 | 3877.3 samples/s | 60.6 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02019 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.276 | acc=1.0000 | 4602.9 samples/s | 71.9 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01366 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.278 | acc=1.0000 | 4915.4 samples/s | 76.8 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01172 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.281 | acc=0.9844 | 5057.9 samples/s | 79.0 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01028 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.283 | acc=1.0000 | 4932.9 samples/s | 77.1 steps/s
[Step=27450 Epoch=26.8] | Loss=0.00959 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.285 | acc=0.9844 | 5050.7 samples/s | 78.9 steps/s
[Step=27500 Epoch=26.8] | Loss=0.00953 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.287 | acc=1.0000 | 5005.6 samples/s | 78.2 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00945 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.289 | acc=0.9844 | 4921.2 samples/s | 76.9 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00933 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.290 | acc=1.0000 | 5008.8 samples/s | 78.3 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00907 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.291 | acc=1.0000 | 4928.0 samples/s | 77.0 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00912 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.293 | acc=0.9844 | 4859.3 samples/s | 75.9 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00905 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.294 | acc=1.0000 | 4968.0 samples/s | 77.6 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00895 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.295 | acc=0.9844 | 4945.9 samples/s | 77.3 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00885 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.296 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00869 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.298 | acc=1.0000 | 3914.6 samples/s | 61.2 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00875 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=3.299 | acc=1.0000 | 3854.5 samples/s | 60.2 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00877 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=3.300 | acc=0.9688 | 3898.4 samples/s | 60.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.02077 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.277 | acc=0.9688 | 3399.4 samples/s | 53.1 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00236 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.282 | acc=1.0000 | 4803.1 samples/s | 75.0 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00120 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.283 | acc=1.0000 | 4706.5 samples/s | 73.5 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00081 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.283 | acc=1.0000 | 4720.6 samples/s | 73.8 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00061 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.284 | acc=1.0000 | 4773.9 samples/s | 74.6 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00049 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.284 | acc=1.0000 | 4743.3 samples/s | 74.1 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00041 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.285 | acc=1.0000 | 4796.7 samples/s | 74.9 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00036 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.285 | acc=1.0000 | 4761.5 samples/s | 74.4 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00032 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.286 | acc=1.0000 | 4726.6 samples/s | 73.9 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00028 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.286 | acc=1.0000 | 4762.5 samples/s | 74.4 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00025 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=3.287 | acc=1.0000 | 4801.2 samples/s | 75.0 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00023 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.287 | acc=1.0000 | 1514.4 samples/s | 23.7 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00021 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.287 | acc=1.0000 | 4920.0 samples/s | 76.9 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00020 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.288 | acc=1.0000 | 4753.3 samples/s | 74.3 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00018 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.288 | acc=1.0000 | 4724.4 samples/s | 73.8 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00017 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.288 | acc=1.0000 | 4826.8 samples/s | 75.4 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00016 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.288 | acc=1.0000 | 4890.7 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26332 | acc=0.8612 | tpr=0.8011 | fpr=0.0082 | 4570.8 samples/s | 17.9 steps/s
Avg test loss: 0.26905, Avg test acc: 0.86021, Avg tpr: 0.80043, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.56906 | acc=0.8672 | tpr=0.9779 | fpr=0.1348 | 4607.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.57894 | acc=0.8680 | tpr=0.9787 | fpr=0.1341 | 9142.5 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.58623 | acc=0.8665 | tpr=0.9798 | fpr=0.1356 | 9255.6 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.58732 | acc=0.8661 | tpr=0.9825 | fpr=0.1360 | 9004.6 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.58789 | acc=0.8664 | tpr=0.9834 | fpr=0.1357 | 9864.5 samples/s | 38.5 steps/s
[Step= 300] | Loss=0.59304 | acc=0.8666 | tpr=0.9833 | fpr=0.1356 | 8658.8 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.59834 | acc=0.8661 | tpr=0.9843 | fpr=0.1360 | 9448.4 samples/s | 36.9 steps/s
[Step= 400] | Loss=0.60080 | acc=0.8659 | tpr=0.9836 | fpr=0.1362 | 9153.3 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.60524 | acc=0.8658 | tpr=0.9834 | fpr=0.1363 | 9167.2 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.60459 | acc=0.8655 | tpr=0.9837 | fpr=0.1367 | 9414.0 samples/s | 36.8 steps/s
[Step= 550] | Loss=0.60292 | acc=0.8656 | tpr=0.9837 | fpr=0.1366 | 17816.1 samples/s | 69.6 steps/s
Avg test loss: 0.60217, Avg test acc: 0.86565, Avg tpr: 0.98336, Avg fpr: 0.13649, total FA: 18952

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.11037 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.304 | acc=0.9375 | 3719.2 samples/s | 58.1 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01977 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.302 | acc=0.9844 | 4718.0 samples/s | 73.7 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01437 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.304 | acc=1.0000 | 4925.7 samples/s | 77.0 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01201 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.306 | acc=1.0000 | 4802.0 samples/s | 75.0 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01126 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.308 | acc=1.0000 | 4824.8 samples/s | 75.4 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01037 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.310 | acc=1.0000 | 3929.5 samples/s | 61.4 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01013 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.312 | acc=1.0000 | 3875.2 samples/s | 60.6 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00957 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.314 | acc=1.0000 | 3893.4 samples/s | 60.8 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00946 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.316 | acc=0.9844 | 3924.5 samples/s | 61.3 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00922 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.317 | acc=1.0000 | 3962.1 samples/s | 61.9 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00904 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.319 | acc=1.0000 | 3900.8 samples/s | 60.9 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00885 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.321 | acc=0.9844 | 3901.8 samples/s | 61.0 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00874 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.322 | acc=1.0000 | 3966.4 samples/s | 62.0 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00855 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.324 | acc=1.0000 | 3941.2 samples/s | 61.6 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00845 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.326 | acc=1.0000 | 3944.0 samples/s | 61.6 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00862 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.327 | acc=0.9844 | 3895.5 samples/s | 60.9 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00863 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.328 | acc=1.0000 | 3921.4 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.04102 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.304 | acc=0.9688 | 2771.6 samples/s | 43.3 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00359 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=3.304 | acc=1.0000 | 4961.1 samples/s | 77.5 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00186 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.304 | acc=1.0000 | 4708.2 samples/s | 73.6 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00125 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.304 | acc=1.0000 | 4638.4 samples/s | 72.5 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00095 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.305 | acc=1.0000 | 4447.0 samples/s | 69.5 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00076 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.305 | acc=1.0000 | 3730.0 samples/s | 58.3 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00065 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.306 | acc=1.0000 | 3721.6 samples/s | 58.1 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00056 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.306 | acc=1.0000 | 3760.6 samples/s | 58.8 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00049 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=3.307 | acc=1.0000 | 3748.7 samples/s | 58.6 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00044 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.307 | acc=1.0000 | 3758.7 samples/s | 58.7 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00040 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.307 | acc=1.0000 | 3757.1 samples/s | 58.7 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00036 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.308 | acc=1.0000 | 1453.5 samples/s | 22.7 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00033 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.308 | acc=1.0000 | 4790.8 samples/s | 74.9 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00031 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.308 | acc=1.0000 | 4766.3 samples/s | 74.5 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00028 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.309 | acc=1.0000 | 4714.2 samples/s | 73.7 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00027 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.309 | acc=1.0000 | 4831.4 samples/s | 75.5 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00025 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.309 | acc=1.0000 | 4755.2 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30015 | acc=0.8438 | tpr=0.7749 | fpr=0.0064 | 4642.8 samples/s | 18.1 steps/s
Avg test loss: 0.30349, Avg test acc: 0.84422, Avg tpr: 0.77653, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.53399 | acc=0.8837 | tpr=0.9779 | fpr=0.1180 | 4553.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.54558 | acc=0.8830 | tpr=0.9787 | fpr=0.1188 | 9328.8 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.55213 | acc=0.8820 | tpr=0.9813 | fpr=0.1198 | 9122.9 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.55306 | acc=0.8820 | tpr=0.9836 | fpr=0.1199 | 9327.4 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.55366 | acc=0.8819 | tpr=0.9834 | fpr=0.1199 | 9358.3 samples/s | 36.6 steps/s
[Step= 300] | Loss=0.55881 | acc=0.8820 | tpr=0.9825 | fpr=0.1199 | 9166.6 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.56382 | acc=0.8816 | tpr=0.9843 | fpr=0.1202 | 9459.6 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.56639 | acc=0.8813 | tpr=0.9841 | fpr=0.1205 | 9124.0 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.57111 | acc=0.8808 | tpr=0.9844 | fpr=0.1211 | 9382.0 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.57044 | acc=0.8805 | tpr=0.9837 | fpr=0.1214 | 9032.3 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.56875 | acc=0.8808 | tpr=0.9841 | fpr=0.1211 | 17319.5 samples/s | 67.7 steps/s
Avg test loss: 0.56808, Avg test acc: 0.88080, Avg tpr: 0.98376, Avg fpr: 0.12107, total FA: 16811

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.09884 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=3.328 | acc=0.9375 | 3710.7 samples/s | 58.0 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02433 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.322 | acc=0.9844 | 4867.5 samples/s | 76.1 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01549 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=3.324 | acc=1.0000 | 4967.6 samples/s | 77.6 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01279 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.326 | acc=0.9844 | 4995.4 samples/s | 78.1 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01100 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.328 | acc=1.0000 | 4795.6 samples/s | 74.9 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01022 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.330 | acc=0.9688 | 4973.8 samples/s | 77.7 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00951 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.333 | acc=1.0000 | 4882.7 samples/s | 76.3 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00924 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.335 | acc=1.0000 | 4989.6 samples/s | 78.0 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00934 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.337 | acc=1.0000 | 4826.8 samples/s | 75.4 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00927 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.339 | acc=1.0000 | 4906.6 samples/s | 76.7 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00940 | Reg=0.00205 | L2-Norm=14.300 | L2-Norm(final)=3.340 | acc=0.9688 | 3915.6 samples/s | 61.2 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00931 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.341 | acc=1.0000 | 3919.4 samples/s | 61.2 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00929 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.343 | acc=1.0000 | 3943.3 samples/s | 61.6 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00921 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.344 | acc=1.0000 | 3936.4 samples/s | 61.5 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00919 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.345 | acc=1.0000 | 3913.9 samples/s | 61.2 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00899 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.346 | acc=0.9844 | 3894.0 samples/s | 60.8 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00898 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.347 | acc=1.0000 | 3871.7 samples/s | 60.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.01113 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=3.329 | acc=0.9844 | 3606.5 samples/s | 56.4 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00211 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.332 | acc=1.0000 | 4618.8 samples/s | 72.2 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00107 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.332 | acc=1.0000 | 4823.1 samples/s | 75.4 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00071 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.333 | acc=1.0000 | 4825.7 samples/s | 75.4 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00054 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.333 | acc=1.0000 | 4730.3 samples/s | 73.9 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00043 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=3.333 | acc=1.0000 | 4799.4 samples/s | 75.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00036 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.333 | acc=1.0000 | 4821.8 samples/s | 75.3 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00031 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.334 | acc=1.0000 | 4811.0 samples/s | 75.2 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00027 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.334 | acc=1.0000 | 4792.7 samples/s | 74.9 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00025 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.334 | acc=1.0000 | 4768.8 samples/s | 74.5 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00022 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=3.334 | acc=1.0000 | 4744.2 samples/s | 74.1 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00020 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.334 | acc=1.0000 | 1485.2 samples/s | 23.2 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00019 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.335 | acc=1.0000 | 4792.4 samples/s | 74.9 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00017 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.335 | acc=1.0000 | 4967.0 samples/s | 77.6 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00016 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=3.335 | acc=1.0000 | 4786.5 samples/s | 74.8 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00015 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.335 | acc=1.0000 | 4735.7 samples/s | 74.0 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00014 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.335 | acc=1.0000 | 4876.5 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25842 | acc=0.8630 | tpr=0.8035 | fpr=0.0079 | 4526.3 samples/s | 17.7 steps/s
Avg test loss: 0.26193, Avg test acc: 0.86277, Avg tpr: 0.80445, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.56403 | acc=0.8752 | tpr=0.9823 | fpr=0.1268 | 4558.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.57289 | acc=0.8755 | tpr=0.9808 | fpr=0.1265 | 9588.9 samples/s | 37.5 steps/s
[Step= 150] | Loss=0.57942 | acc=0.8736 | tpr=0.9827 | fpr=0.1284 | 9293.3 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.58098 | acc=0.8736 | tpr=0.9847 | fpr=0.1284 | 9167.3 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.58234 | acc=0.8738 | tpr=0.9843 | fpr=0.1282 | 9559.5 samples/s | 37.3 steps/s
[Step= 300] | Loss=0.58725 | acc=0.8737 | tpr=0.9840 | fpr=0.1283 | 9759.5 samples/s | 38.1 steps/s
[Step= 350] | Loss=0.59203 | acc=0.8732 | tpr=0.9850 | fpr=0.1288 | 8756.0 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.59464 | acc=0.8731 | tpr=0.9841 | fpr=0.1289 | 9202.3 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.59942 | acc=0.8728 | tpr=0.9839 | fpr=0.1292 | 9238.2 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.59884 | acc=0.8725 | tpr=0.9837 | fpr=0.1295 | 9264.2 samples/s | 36.2 steps/s
[Step= 550] | Loss=0.59717 | acc=0.8726 | tpr=0.9837 | fpr=0.1294 | 17446.5 samples/s | 68.2 steps/s
Avg test loss: 0.59650, Avg test acc: 0.87263, Avg tpr: 0.98336, Avg fpr: 0.12938, total FA: 17964

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.23472 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.350 | acc=0.8906 | 3543.1 samples/s | 55.4 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02265 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.346 | acc=1.0000 | 5045.7 samples/s | 78.8 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01453 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.347 | acc=1.0000 | 4893.0 samples/s | 76.5 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01237 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.349 | acc=0.9688 | 4915.1 samples/s | 76.8 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01109 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.351 | acc=1.0000 | 4956.1 samples/s | 77.4 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01024 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.352 | acc=1.0000 | 4928.4 samples/s | 77.0 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01006 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.354 | acc=1.0000 | 4908.4 samples/s | 76.7 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01002 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.355 | acc=1.0000 | 4960.9 samples/s | 77.5 steps/s
[Step=30000 Epoch=29.3] | Loss=0.01002 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.357 | acc=1.0000 | 4941.8 samples/s | 77.2 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00954 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=3.358 | acc=1.0000 | 4488.5 samples/s | 70.1 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00920 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=3.359 | acc=1.0000 | 3929.3 samples/s | 61.4 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00902 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.361 | acc=1.0000 | 3939.4 samples/s | 61.6 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00889 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=3.362 | acc=1.0000 | 3910.7 samples/s | 61.1 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00876 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.364 | acc=0.9688 | 3903.5 samples/s | 61.0 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00857 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.365 | acc=0.9844 | 3918.6 samples/s | 61.2 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00846 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.366 | acc=1.0000 | 3916.8 samples/s | 61.2 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00853 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.368 | acc=0.9844 | 3927.8 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.02920 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.350 | acc=0.9844 | 3043.6 samples/s | 47.6 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00475 | Reg=0.00204 | L2-Norm=14.265 | L2-Norm(final)=3.350 | acc=1.0000 | 4256.3 samples/s | 66.5 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00239 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.350 | acc=1.0000 | 4827.0 samples/s | 75.4 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00160 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.350 | acc=1.0000 | 4659.3 samples/s | 72.8 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00120 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.350 | acc=1.0000 | 4787.1 samples/s | 74.8 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00096 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.350 | acc=1.0000 | 4759.2 samples/s | 74.4 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00081 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.350 | acc=1.0000 | 4648.6 samples/s | 72.6 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00069 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=3.351 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00061 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.351 | acc=1.0000 | 4815.7 samples/s | 75.2 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00054 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.351 | acc=1.0000 | 4856.4 samples/s | 75.9 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00049 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.352 | acc=1.0000 | 4824.3 samples/s | 75.4 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00044 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.352 | acc=1.0000 | 1539.1 samples/s | 24.0 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00041 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.352 | acc=1.0000 | 4822.9 samples/s | 75.4 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00038 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=3.353 | acc=1.0000 | 4797.1 samples/s | 75.0 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00035 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.353 | acc=1.0000 | 4663.3 samples/s | 72.9 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00033 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.353 | acc=1.0000 | 4815.8 samples/s | 75.2 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00031 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.354 | acc=1.0000 | 4841.7 samples/s | 75.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29919 | acc=0.8446 | tpr=0.7764 | fpr=0.0072 | 4647.9 samples/s | 18.2 steps/s
Avg test loss: 0.29955, Avg test acc: 0.84518, Avg tpr: 0.77828, Avg fpr: 0.00769, total FA: 60

Testing server on iccad2012
[Step=  50] | Loss=0.53490 | acc=0.8882 | tpr=0.9823 | fpr=0.1135 | 4575.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.54544 | acc=0.8870 | tpr=0.9787 | fpr=0.1147 | 9344.4 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.55277 | acc=0.8859 | tpr=0.9813 | fpr=0.1159 | 9206.6 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.55512 | acc=0.8858 | tpr=0.9836 | fpr=0.1160 | 9363.5 samples/s | 36.6 steps/s
[Step= 250] | Loss=0.55576 | acc=0.8854 | tpr=0.9834 | fpr=0.1164 | 9113.4 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.56058 | acc=0.8855 | tpr=0.9833 | fpr=0.1163 | 9136.4 samples/s | 35.7 steps/s
[Step= 350] | Loss=0.56480 | acc=0.8851 | tpr=0.9837 | fpr=0.1167 | 9451.7 samples/s | 36.9 steps/s
[Step= 400] | Loss=0.56743 | acc=0.8850 | tpr=0.9819 | fpr=0.1167 | 8768.9 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.57241 | acc=0.8847 | tpr=0.9820 | fpr=0.1171 | 9338.1 samples/s | 36.5 steps/s
[Step= 500] | Loss=0.57150 | acc=0.8844 | tpr=0.9824 | fpr=0.1174 | 8986.6 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.56991 | acc=0.8844 | tpr=0.9825 | fpr=0.1174 | 17541.6 samples/s | 68.5 steps/s
Avg test loss: 0.56922, Avg test acc: 0.88442, Avg tpr: 0.98217, Avg fpr: 0.11736, total FA: 16295

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.19153 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.372 | acc=0.9062 | 3679.7 samples/s | 57.5 steps/s
[Step=30450 Epoch=29.7] | Loss=0.02704 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.367 | acc=1.0000 | 5049.6 samples/s | 78.9 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01796 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.368 | acc=1.0000 | 4827.6 samples/s | 75.4 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01443 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.369 | acc=1.0000 | 4974.3 samples/s | 77.7 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01291 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=3.372 | acc=0.9844 | 4874.9 samples/s | 76.2 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01169 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.374 | acc=1.0000 | 5003.2 samples/s | 78.2 steps/s
[Step=30700 Epoch=30.0] | Loss=0.01097 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.375 | acc=0.9688 | 5006.7 samples/s | 78.2 steps/s
[Step=30750 Epoch=30.0] | Loss=0.01063 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.377 | acc=1.0000 | 5001.2 samples/s | 78.1 steps/s
[Step=30800 Epoch=30.1] | Loss=0.01017 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.378 | acc=1.0000 | 5007.4 samples/s | 78.2 steps/s
[Step=30850 Epoch=30.1] | Loss=0.01007 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.380 | acc=0.9844 | 4869.7 samples/s | 76.1 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00966 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.382 | acc=1.0000 | 5007.0 samples/s | 78.2 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00939 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.383 | acc=1.0000 | 5082.2 samples/s | 79.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00943 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.385 | acc=1.0000 | 4908.2 samples/s | 76.7 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00933 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.387 | acc=1.0000 | 4917.4 samples/s | 76.8 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00924 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.388 | acc=0.9844 | 4905.8 samples/s | 76.7 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00916 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.389 | acc=0.9688 | 5067.6 samples/s | 79.2 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00905 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.391 | acc=1.0000 | 4895.5 samples/s | 76.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.11043 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.372 | acc=0.9688 | 3601.3 samples/s | 56.3 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00440 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.372 | acc=1.0000 | 4646.8 samples/s | 72.6 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00223 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.372 | acc=1.0000 | 4720.9 samples/s | 73.8 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00149 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.373 | acc=1.0000 | 4164.8 samples/s | 65.1 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00112 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.373 | acc=1.0000 | 3692.9 samples/s | 57.7 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00090 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.373 | acc=1.0000 | 3729.7 samples/s | 58.3 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00075 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.374 | acc=1.0000 | 3813.9 samples/s | 59.6 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00065 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=3.374 | acc=1.0000 | 3761.9 samples/s | 58.8 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00057 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.374 | acc=1.0000 | 3728.3 samples/s | 58.3 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00051 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.374 | acc=1.0000 | 3711.5 samples/s | 58.0 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00046 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.375 | acc=1.0000 | 3835.6 samples/s | 59.9 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00042 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.375 | acc=1.0000 | 1553.4 samples/s | 24.3 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00038 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.375 | acc=1.0000 | 4273.5 samples/s | 66.8 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00035 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.376 | acc=1.0000 | 4358.6 samples/s | 68.1 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00033 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.376 | acc=1.0000 | 4379.6 samples/s | 68.4 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00031 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.376 | acc=1.0000 | 4518.9 samples/s | 70.6 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00029 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.376 | acc=1.0000 | 4719.0 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27954 | acc=0.8561 | tpr=0.7932 | fpr=0.0074 | 4582.5 samples/s | 17.9 steps/s
Avg test loss: 0.28175, Avg test acc: 0.85748, Avg tpr: 0.79618, Avg fpr: 0.00769, total FA: 60

Testing server on iccad2012
[Step=  50] | Loss=0.54460 | acc=0.8816 | tpr=0.9823 | fpr=0.1202 | 4576.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.55536 | acc=0.8805 | tpr=0.9787 | fpr=0.1213 | 9322.9 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.56266 | acc=0.8790 | tpr=0.9813 | fpr=0.1229 | 9332.2 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.56511 | acc=0.8788 | tpr=0.9836 | fpr=0.1231 | 9233.7 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.56566 | acc=0.8790 | tpr=0.9843 | fpr=0.1229 | 9502.9 samples/s | 37.1 steps/s
[Step= 300] | Loss=0.57001 | acc=0.8792 | tpr=0.9825 | fpr=0.1227 | 9220.7 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.57439 | acc=0.8787 | tpr=0.9831 | fpr=0.1232 | 9101.0 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.57679 | acc=0.8786 | tpr=0.9814 | fpr=0.1232 | 9456.5 samples/s | 36.9 steps/s
[Step= 450] | Loss=0.58145 | acc=0.8785 | tpr=0.9815 | fpr=0.1234 | 9241.1 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.58088 | acc=0.8782 | tpr=0.9815 | fpr=0.1237 | 8900.2 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.57917 | acc=0.8785 | tpr=0.9813 | fpr=0.1234 | 17355.8 samples/s | 67.8 steps/s
Avg test loss: 0.57850, Avg test acc: 0.87848, Avg tpr: 0.98098, Avg fpr: 0.12338, total FA: 17131

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.03454 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.396 | acc=0.9844 | 3634.4 samples/s | 56.8 steps/s
[Step=31250 Epoch=30.5] | Loss=0.02338 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.390 | acc=1.0000 | 4816.8 samples/s | 75.3 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01517 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.391 | acc=1.0000 | 4980.2 samples/s | 77.8 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01237 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.393 | acc=0.9844 | 4946.4 samples/s | 77.3 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01089 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.395 | acc=1.0000 | 4986.4 samples/s | 77.9 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01063 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=3.397 | acc=1.0000 | 4954.1 samples/s | 77.4 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01016 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=3.398 | acc=1.0000 | 4909.7 samples/s | 76.7 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00993 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.400 | acc=1.0000 | 5015.6 samples/s | 78.4 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00967 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=3.401 | acc=0.9844 | 4893.1 samples/s | 76.5 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00934 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.402 | acc=0.9688 | 5033.6 samples/s | 78.6 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00927 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.403 | acc=0.9844 | 5023.6 samples/s | 78.5 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00920 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.405 | acc=0.9844 | 4980.9 samples/s | 77.8 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00908 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.406 | acc=0.9688 | 5009.8 samples/s | 78.3 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00893 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.407 | acc=1.0000 | 5047.1 samples/s | 78.9 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00879 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.409 | acc=0.9844 | 5035.1 samples/s | 78.7 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00877 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.410 | acc=1.0000 | 5039.0 samples/s | 78.7 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00878 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.411 | acc=0.9844 | 4921.9 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.04578 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.396 | acc=0.9844 | 3810.7 samples/s | 59.5 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00167 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.402 | acc=1.0000 | 4476.7 samples/s | 69.9 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00085 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.404 | acc=1.0000 | 4814.8 samples/s | 75.2 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00057 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.404 | acc=1.0000 | 4785.4 samples/s | 74.8 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00043 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.405 | acc=1.0000 | 4882.0 samples/s | 76.3 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00035 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.406 | acc=1.0000 | 4741.2 samples/s | 74.1 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00029 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.406 | acc=1.0000 | 4779.8 samples/s | 74.7 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00025 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.406 | acc=1.0000 | 4864.0 samples/s | 76.0 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00022 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.407 | acc=1.0000 | 4810.1 samples/s | 75.2 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00020 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.407 | acc=1.0000 | 4655.3 samples/s | 72.7 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00018 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.408 | acc=1.0000 | 4750.6 samples/s | 74.2 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00017 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.408 | acc=1.0000 | 1504.9 samples/s | 23.5 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00015 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.408 | acc=1.0000 | 4861.9 samples/s | 76.0 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00014 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.409 | acc=1.0000 | 4919.7 samples/s | 76.9 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00013 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=3.409 | acc=1.0000 | 4717.6 samples/s | 73.7 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00012 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=3.410 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00012 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.410 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24167 | acc=0.8761 | tpr=0.8229 | fpr=0.0084 | 4560.6 samples/s | 17.8 steps/s
Avg test loss: 0.24394, Avg test acc: 0.87623, Avg tpr: 0.82380, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.60610 | acc=0.8670 | tpr=0.9823 | fpr=0.1351 | 4558.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.61718 | acc=0.8666 | tpr=0.9787 | fpr=0.1355 | 9680.4 samples/s | 37.8 steps/s
[Step= 150] | Loss=0.62539 | acc=0.8653 | tpr=0.9813 | fpr=0.1369 | 8916.1 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.62808 | acc=0.8654 | tpr=0.9836 | fpr=0.1367 | 9269.8 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.62898 | acc=0.8654 | tpr=0.9834 | fpr=0.1368 | 9392.3 samples/s | 36.7 steps/s
[Step= 300] | Loss=0.63348 | acc=0.8654 | tpr=0.9825 | fpr=0.1368 | 8815.7 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.63806 | acc=0.8650 | tpr=0.9831 | fpr=0.1371 | 9635.6 samples/s | 37.6 steps/s
[Step= 400] | Loss=0.64053 | acc=0.8650 | tpr=0.9830 | fpr=0.1372 | 9092.9 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.64500 | acc=0.8647 | tpr=0.9830 | fpr=0.1374 | 9180.8 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.64455 | acc=0.8642 | tpr=0.9833 | fpr=0.1380 | 9089.7 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.64284 | acc=0.8645 | tpr=0.9829 | fpr=0.1376 | 17519.1 samples/s | 68.4 steps/s
Avg test loss: 0.64215, Avg test acc: 0.86453, Avg tpr: 0.98257, Avg fpr: 0.13762, total FA: 19108

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.11923 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.422 | acc=0.9531 | 3759.8 samples/s | 58.7 steps/s
[Step=32050 Epoch=31.3] | Loss=0.01906 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.420 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01334 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.422 | acc=1.0000 | 4972.8 samples/s | 77.7 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01143 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.423 | acc=1.0000 | 4936.4 samples/s | 77.1 steps/s
[Step=32200 Epoch=31.4] | Loss=0.00985 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.424 | acc=0.9688 | 4931.3 samples/s | 77.1 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00897 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.426 | acc=0.9688 | 5011.2 samples/s | 78.3 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00851 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.427 | acc=1.0000 | 4992.3 samples/s | 78.0 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00815 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.428 | acc=1.0000 | 4893.9 samples/s | 76.5 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00798 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.429 | acc=1.0000 | 4276.0 samples/s | 66.8 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00775 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.430 | acc=0.9844 | 3896.9 samples/s | 60.9 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00777 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.431 | acc=1.0000 | 3911.9 samples/s | 61.1 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00781 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.432 | acc=1.0000 | 3962.3 samples/s | 61.9 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00754 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.433 | acc=1.0000 | 3922.9 samples/s | 61.3 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00755 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.434 | acc=1.0000 | 3898.4 samples/s | 60.9 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00744 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.435 | acc=1.0000 | 3897.4 samples/s | 60.9 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00734 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.436 | acc=0.9688 | 3922.0 samples/s | 61.3 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00734 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.437 | acc=1.0000 | 3937.8 samples/s | 61.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.14859 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.422 | acc=0.9219 | 3015.4 samples/s | 47.1 steps/s
[Step=32050 Epoch=60.4] | Loss=0.01041 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.425 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00522 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.425 | acc=1.0000 | 4759.9 samples/s | 74.4 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00349 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.425 | acc=1.0000 | 4818.3 samples/s | 75.3 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00263 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.426 | acc=1.0000 | 4778.3 samples/s | 74.7 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00211 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.426 | acc=1.0000 | 4745.1 samples/s | 74.1 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00176 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.426 | acc=1.0000 | 4803.1 samples/s | 75.0 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00151 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=3.426 | acc=1.0000 | 4785.9 samples/s | 74.8 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00132 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.426 | acc=1.0000 | 4858.6 samples/s | 75.9 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00118 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.427 | acc=1.0000 | 4668.2 samples/s | 72.9 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00106 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.427 | acc=1.0000 | 4980.3 samples/s | 77.8 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00097 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=3.427 | acc=1.0000 | 1531.3 samples/s | 23.9 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00089 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.427 | acc=1.0000 | 4878.4 samples/s | 76.2 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00082 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.427 | acc=1.0000 | 4793.3 samples/s | 74.9 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00076 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.427 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00071 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.427 | acc=1.0000 | 4710.1 samples/s | 73.6 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00067 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.428 | acc=1.0000 | 4069.8 samples/s | 63.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26357 | acc=0.8645 | tpr=0.8061 | fpr=0.0089 | 4301.6 samples/s | 16.8 steps/s
Avg test loss: 0.26678, Avg test acc: 0.86485, Avg tpr: 0.80743, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.55428 | acc=0.8807 | tpr=0.9823 | fpr=0.1211 | 4538.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.56550 | acc=0.8797 | tpr=0.9787 | fpr=0.1222 | 9329.2 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.57325 | acc=0.8783 | tpr=0.9798 | fpr=0.1235 | 9800.9 samples/s | 38.3 steps/s
[Step= 200] | Loss=0.57524 | acc=0.8780 | tpr=0.9825 | fpr=0.1239 | 8916.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.57590 | acc=0.8783 | tpr=0.9825 | fpr=0.1236 | 9735.4 samples/s | 38.0 steps/s
[Step= 300] | Loss=0.58045 | acc=0.8783 | tpr=0.9811 | fpr=0.1236 | 8855.6 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.58510 | acc=0.8779 | tpr=0.9818 | fpr=0.1240 | 9240.3 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.58768 | acc=0.8778 | tpr=0.9809 | fpr=0.1241 | 9180.5 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.59216 | acc=0.8775 | tpr=0.9810 | fpr=0.1243 | 9094.5 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.59140 | acc=0.8773 | tpr=0.9806 | fpr=0.1246 | 8740.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.58964 | acc=0.8774 | tpr=0.9805 | fpr=0.1245 | 17745.7 samples/s | 69.3 steps/s
Avg test loss: 0.58898, Avg test acc: 0.87744, Avg tpr: 0.98019, Avg fpr: 0.12442, total FA: 17276

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.15969 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.440 | acc=0.9062 | 3733.2 samples/s | 58.3 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02084 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.437 | acc=1.0000 | 4922.7 samples/s | 76.9 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01386 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.438 | acc=1.0000 | 4957.2 samples/s | 77.5 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01140 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.439 | acc=1.0000 | 4901.5 samples/s | 76.6 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00972 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.440 | acc=1.0000 | 5046.2 samples/s | 78.8 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00881 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.442 | acc=1.0000 | 4846.3 samples/s | 75.7 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00864 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.443 | acc=1.0000 | 4982.4 samples/s | 77.9 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00830 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.444 | acc=1.0000 | 4852.3 samples/s | 75.8 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00803 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.445 | acc=0.9844 | 5087.5 samples/s | 79.5 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00777 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.446 | acc=1.0000 | 4854.0 samples/s | 75.8 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00753 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.447 | acc=1.0000 | 4908.0 samples/s | 76.7 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00753 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.448 | acc=1.0000 | 4946.9 samples/s | 77.3 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00744 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.449 | acc=1.0000 | 5084.6 samples/s | 79.4 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00729 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.450 | acc=0.9844 | 5041.0 samples/s | 78.8 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00720 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.451 | acc=0.9844 | 4984.6 samples/s | 77.9 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00712 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.452 | acc=0.9844 | 4929.8 samples/s | 77.0 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00715 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.453 | acc=0.9844 | 4931.0 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.08487 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.440 | acc=0.9844 | 3671.2 samples/s | 57.4 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00563 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.445 | acc=1.0000 | 4503.5 samples/s | 70.4 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00283 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.447 | acc=1.0000 | 4226.5 samples/s | 66.0 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00190 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.447 | acc=1.0000 | 3741.0 samples/s | 58.5 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00143 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.448 | acc=1.0000 | 3708.1 samples/s | 57.9 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00115 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.448 | acc=1.0000 | 3783.0 samples/s | 59.1 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00096 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.448 | acc=1.0000 | 3698.4 samples/s | 57.8 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00083 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.449 | acc=1.0000 | 3769.1 samples/s | 58.9 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00072 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.449 | acc=1.0000 | 3731.5 samples/s | 58.3 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00065 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.449 | acc=1.0000 | 3737.4 samples/s | 58.4 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00058 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.449 | acc=1.0000 | 3795.0 samples/s | 59.3 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00053 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=3.449 | acc=1.0000 | 1519.5 samples/s | 23.7 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00049 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.449 | acc=1.0000 | 4878.7 samples/s | 76.2 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00045 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.450 | acc=1.0000 | 4768.1 samples/s | 74.5 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.450 | acc=1.0000 | 4257.6 samples/s | 66.5 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00039 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=3.450 | acc=1.0000 | 3751.9 samples/s | 58.6 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00037 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=3.450 | acc=1.0000 | 3740.5 samples/s | 58.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23230 | acc=0.8825 | tpr=0.8331 | fpr=0.0102 | 4269.9 samples/s | 16.7 steps/s
Avg test loss: 0.23663, Avg test acc: 0.88264, Avg tpr: 0.83383, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.60088 | acc=0.8697 | tpr=0.9823 | fpr=0.1323 | 4597.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.61227 | acc=0.8698 | tpr=0.9787 | fpr=0.1322 | 9383.8 samples/s | 36.7 steps/s
[Step= 150] | Loss=0.62114 | acc=0.8686 | tpr=0.9798 | fpr=0.1335 | 9135.1 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.62275 | acc=0.8683 | tpr=0.9825 | fpr=0.1338 | 9285.3 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.62313 | acc=0.8687 | tpr=0.9834 | fpr=0.1334 | 9605.5 samples/s | 37.5 steps/s
[Step= 300] | Loss=0.62771 | acc=0.8689 | tpr=0.9818 | fpr=0.1331 | 8868.9 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.63265 | acc=0.8683 | tpr=0.9825 | fpr=0.1337 | 9276.2 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.63515 | acc=0.8683 | tpr=0.9814 | fpr=0.1337 | 9250.3 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.63997 | acc=0.8680 | tpr=0.9815 | fpr=0.1340 | 9300.5 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.63938 | acc=0.8676 | tpr=0.9819 | fpr=0.1344 | 9109.1 samples/s | 35.6 steps/s
[Step= 550] | Loss=0.63782 | acc=0.8678 | tpr=0.9817 | fpr=0.1342 | 16701.0 samples/s | 65.2 steps/s
Avg test loss: 0.63714, Avg test acc: 0.86784, Avg tpr: 0.98138, Avg fpr: 0.13423, total FA: 18637

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.06140 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.458 | acc=0.9375 | 3703.1 samples/s | 57.9 steps/s
[Step=33650 Epoch=32.9] | Loss=0.02216 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.454 | acc=0.9844 | 5094.4 samples/s | 79.6 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01476 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.454 | acc=1.0000 | 4875.9 samples/s | 76.2 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01219 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.454 | acc=1.0000 | 4949.9 samples/s | 77.3 steps/s
[Step=33800 Epoch=33.0] | Loss=0.01074 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.455 | acc=1.0000 | 4453.7 samples/s | 69.6 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00983 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.456 | acc=1.0000 | 3903.7 samples/s | 61.0 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00896 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.457 | acc=1.0000 | 3928.7 samples/s | 61.4 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00868 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.459 | acc=0.9844 | 3922.4 samples/s | 61.3 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00838 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.460 | acc=1.0000 | 3924.0 samples/s | 61.3 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00797 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.461 | acc=1.0000 | 3942.8 samples/s | 61.6 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00773 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.462 | acc=1.0000 | 3940.4 samples/s | 61.6 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00767 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.463 | acc=0.9844 | 3950.8 samples/s | 61.7 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00750 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.464 | acc=0.9844 | 3940.0 samples/s | 61.6 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00732 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.465 | acc=1.0000 | 3940.0 samples/s | 61.6 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00716 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.466 | acc=1.0000 | 3927.7 samples/s | 61.4 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00722 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.466 | acc=1.0000 | 3965.3 samples/s | 62.0 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00730 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.467 | acc=1.0000 | 3846.9 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.02304 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.458 | acc=0.9688 | 3096.2 samples/s | 48.4 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00214 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.465 | acc=1.0000 | 4406.6 samples/s | 68.9 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00109 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.467 | acc=1.0000 | 4748.3 samples/s | 74.2 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00074 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.468 | acc=1.0000 | 4712.9 samples/s | 73.6 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00056 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.469 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00045 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.469 | acc=1.0000 | 4788.4 samples/s | 74.8 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00038 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.470 | acc=1.0000 | 4739.2 samples/s | 74.0 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00033 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.470 | acc=1.0000 | 4666.0 samples/s | 72.9 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00029 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.470 | acc=1.0000 | 4716.6 samples/s | 73.7 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00026 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.470 | acc=1.0000 | 4777.5 samples/s | 74.6 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00024 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=3.470 | acc=1.0000 | 4880.2 samples/s | 76.3 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00021 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.471 | acc=1.0000 | 1499.5 samples/s | 23.4 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00020 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.471 | acc=1.0000 | 4773.6 samples/s | 74.6 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00018 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.471 | acc=1.0000 | 4707.5 samples/s | 73.6 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00017 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=3.471 | acc=1.0000 | 4805.5 samples/s | 75.1 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00016 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=3.471 | acc=1.0000 | 4722.0 samples/s | 73.8 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00015 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=3.472 | acc=1.0000 | 4779.6 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21784 | acc=0.8905 | tpr=0.8448 | fpr=0.0104 | 4560.4 samples/s | 17.8 steps/s
Avg test loss: 0.22105, Avg test acc: 0.88998, Avg tpr: 0.84508, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.62595 | acc=0.8673 | tpr=0.9823 | fpr=0.1347 | 4580.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.63709 | acc=0.8676 | tpr=0.9787 | fpr=0.1345 | 9716.4 samples/s | 38.0 steps/s
[Step= 150] | Loss=0.64670 | acc=0.8666 | tpr=0.9798 | fpr=0.1354 | 9206.9 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.64885 | acc=0.8668 | tpr=0.9825 | fpr=0.1353 | 8916.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.64891 | acc=0.8674 | tpr=0.9834 | fpr=0.1347 | 9497.2 samples/s | 37.1 steps/s
[Step= 300] | Loss=0.65379 | acc=0.8676 | tpr=0.9825 | fpr=0.1345 | 8987.4 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.65878 | acc=0.8670 | tpr=0.9831 | fpr=0.1351 | 9381.8 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.66135 | acc=0.8669 | tpr=0.9814 | fpr=0.1352 | 9349.7 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.66655 | acc=0.8664 | tpr=0.9815 | fpr=0.1357 | 8973.4 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.66574 | acc=0.8661 | tpr=0.9811 | fpr=0.1360 | 9570.7 samples/s | 37.4 steps/s
[Step= 550] | Loss=0.66423 | acc=0.8662 | tpr=0.9813 | fpr=0.1359 | 17119.6 samples/s | 66.9 steps/s
Avg test loss: 0.66346, Avg test acc: 0.86629, Avg tpr: 0.98098, Avg fpr: 0.13580, total FA: 18855

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.15535 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.476 | acc=0.9062 | 3599.7 samples/s | 56.2 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02056 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.473 | acc=1.0000 | 4841.1 samples/s | 75.6 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01282 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.473 | acc=0.9844 | 4965.9 samples/s | 77.6 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01068 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.474 | acc=1.0000 | 4979.4 samples/s | 77.8 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00943 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.475 | acc=1.0000 | 4382.1 samples/s | 68.5 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00893 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.476 | acc=0.9844 | 3875.9 samples/s | 60.6 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00846 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.478 | acc=1.0000 | 3961.7 samples/s | 61.9 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00793 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.479 | acc=1.0000 | 3931.9 samples/s | 61.4 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00779 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=3.480 | acc=1.0000 | 3922.6 samples/s | 61.3 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00765 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.481 | acc=0.9844 | 3915.7 samples/s | 61.2 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00780 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.482 | acc=0.9844 | 3920.1 samples/s | 61.3 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00753 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.483 | acc=1.0000 | 3960.9 samples/s | 61.9 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00745 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.484 | acc=1.0000 | 3920.2 samples/s | 61.3 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00746 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=3.485 | acc=1.0000 | 3961.4 samples/s | 61.9 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00749 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=3.486 | acc=1.0000 | 3883.5 samples/s | 60.7 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00731 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.486 | acc=0.9688 | 3945.0 samples/s | 61.6 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00728 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.487 | acc=1.0000 | 3898.1 samples/s | 60.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.10232 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.476 | acc=0.9531 | 2949.5 samples/s | 46.1 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00522 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=3.480 | acc=1.0000 | 4898.1 samples/s | 76.5 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00265 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.481 | acc=1.0000 | 4776.4 samples/s | 74.6 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00178 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.481 | acc=1.0000 | 4763.6 samples/s | 74.4 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00134 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.481 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00107 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=3.481 | acc=1.0000 | 4803.7 samples/s | 75.1 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00090 | Reg=0.00202 | L2-Norm=14.195 | L2-Norm(final)=3.481 | acc=1.0000 | 4820.9 samples/s | 75.3 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00077 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=3.481 | acc=1.0000 | 4645.3 samples/s | 72.6 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00068 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=3.481 | acc=1.0000 | 4688.6 samples/s | 73.3 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00060 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=3.482 | acc=1.0000 | 4478.6 samples/s | 70.0 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00054 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.482 | acc=1.0000 | 3790.7 samples/s | 59.2 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00049 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.482 | acc=1.0000 | 1542.8 samples/s | 24.1 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00045 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=3.482 | acc=1.0000 | 4746.7 samples/s | 74.2 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00042 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.482 | acc=1.0000 | 4706.3 samples/s | 73.5 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00039 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=3.482 | acc=1.0000 | 4826.9 samples/s | 75.4 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00037 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=3.482 | acc=1.0000 | 4901.3 samples/s | 76.6 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00034 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=3.482 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25416 | acc=0.8739 | tpr=0.8202 | fpr=0.0094 | 4572.2 samples/s | 17.9 steps/s
Avg test loss: 0.25804, Avg test acc: 0.87359, Avg tpr: 0.82036, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.57526 | acc=0.8816 | tpr=0.9823 | fpr=0.1202 | 4632.5 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.58471 | acc=0.8820 | tpr=0.9787 | fpr=0.1198 | 9126.5 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.59437 | acc=0.8807 | tpr=0.9798 | fpr=0.1211 | 9522.8 samples/s | 37.2 steps/s
[Step= 200] | Loss=0.59568 | acc=0.8805 | tpr=0.9825 | fpr=0.1213 | 8938.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.59601 | acc=0.8807 | tpr=0.9825 | fpr=0.1212 | 9757.4 samples/s | 38.1 steps/s
[Step= 300] | Loss=0.60143 | acc=0.8807 | tpr=0.9804 | fpr=0.1211 | 8877.7 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.60603 | acc=0.8803 | tpr=0.9812 | fpr=0.1215 | 9360.4 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.60841 | acc=0.8803 | tpr=0.9798 | fpr=0.1215 | 9155.3 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.61344 | acc=0.8798 | tpr=0.9800 | fpr=0.1220 | 9521.3 samples/s | 37.2 steps/s
[Step= 500] | Loss=0.61270 | acc=0.8795 | tpr=0.9797 | fpr=0.1223 | 9705.4 samples/s | 37.9 steps/s
[Step= 550] | Loss=0.61117 | acc=0.8796 | tpr=0.9797 | fpr=0.1223 | 15319.5 samples/s | 59.8 steps/s
Avg test loss: 0.61050, Avg test acc: 0.87959, Avg tpr: 0.97940, Avg fpr: 0.12223, total FA: 16971

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.14847 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.491 | acc=0.8906 | 3495.4 samples/s | 54.6 steps/s
[Step=35250 Epoch=34.4] | Loss=0.02673 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.487 | acc=0.9844 | 5136.2 samples/s | 80.3 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01592 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.487 | acc=1.0000 | 4989.4 samples/s | 78.0 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01271 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.488 | acc=1.0000 | 4953.8 samples/s | 77.4 steps/s
[Step=35400 Epoch=34.6] | Loss=0.01118 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.488 | acc=1.0000 | 4957.9 samples/s | 77.5 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00993 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.489 | acc=1.0000 | 4937.1 samples/s | 77.1 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00929 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.490 | acc=1.0000 | 4312.8 samples/s | 67.4 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00878 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.491 | acc=1.0000 | 3941.0 samples/s | 61.6 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00842 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.492 | acc=1.0000 | 3955.3 samples/s | 61.8 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00808 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.493 | acc=1.0000 | 3929.5 samples/s | 61.4 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00781 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=3.494 | acc=1.0000 | 3890.3 samples/s | 60.8 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00770 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=3.494 | acc=1.0000 | 3908.4 samples/s | 61.1 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00770 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.495 | acc=1.0000 | 3909.9 samples/s | 61.1 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00740 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.496 | acc=1.0000 | 3898.5 samples/s | 60.9 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00735 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.497 | acc=0.9844 | 3940.5 samples/s | 61.6 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00718 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.498 | acc=1.0000 | 3872.0 samples/s | 60.5 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00708 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.498 | acc=1.0000 | 3930.8 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.07871 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.491 | acc=0.9531 | 3054.2 samples/s | 47.7 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00550 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.496 | acc=1.0000 | 4844.9 samples/s | 75.7 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00276 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.497 | acc=1.0000 | 4971.3 samples/s | 77.7 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00185 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.498 | acc=1.0000 | 4780.2 samples/s | 74.7 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00139 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.498 | acc=1.0000 | 4846.2 samples/s | 75.7 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00111 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=3.498 | acc=1.0000 | 4899.7 samples/s | 76.6 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00093 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.498 | acc=1.0000 | 4768.5 samples/s | 74.5 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00080 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.498 | acc=1.0000 | 4714.8 samples/s | 73.7 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00070 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=3.498 | acc=1.0000 | 4812.2 samples/s | 75.2 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00062 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=3.499 | acc=1.0000 | 4729.4 samples/s | 73.9 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00056 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=3.499 | acc=1.0000 | 4847.2 samples/s | 75.7 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00051 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.499 | acc=1.0000 | 1485.3 samples/s | 23.2 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00047 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.499 | acc=1.0000 | 4750.6 samples/s | 74.2 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00043 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=3.499 | acc=1.0000 | 4809.0 samples/s | 75.1 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=3.499 | acc=1.0000 | 4979.5 samples/s | 77.8 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00038 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=3.499 | acc=1.0000 | 4744.7 samples/s | 74.1 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00035 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.499 | acc=1.0000 | 4668.6 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23932 | acc=0.8809 | tpr=0.8308 | fpr=0.0102 | 4603.4 samples/s | 18.0 steps/s
Avg test loss: 0.24346, Avg test acc: 0.87952, Avg tpr: 0.82940, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.58602 | acc=0.8755 | tpr=0.9823 | fpr=0.1265 | 4538.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.59435 | acc=0.8761 | tpr=0.9787 | fpr=0.1258 | 9640.6 samples/s | 37.7 steps/s
[Step= 150] | Loss=0.60418 | acc=0.8751 | tpr=0.9798 | fpr=0.1269 | 8865.6 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.60575 | acc=0.8753 | tpr=0.9825 | fpr=0.1267 | 9285.3 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.60648 | acc=0.8753 | tpr=0.9825 | fpr=0.1266 | 9449.4 samples/s | 36.9 steps/s
[Step= 300] | Loss=0.61163 | acc=0.8755 | tpr=0.9804 | fpr=0.1265 | 9256.9 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.61624 | acc=0.8750 | tpr=0.9812 | fpr=0.1269 | 9383.3 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.61847 | acc=0.8751 | tpr=0.9803 | fpr=0.1268 | 8986.7 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.62357 | acc=0.8747 | tpr=0.9805 | fpr=0.1272 | 9226.8 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.62289 | acc=0.8746 | tpr=0.9802 | fpr=0.1273 | 9190.0 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.62133 | acc=0.8747 | tpr=0.9805 | fpr=0.1272 | 18076.9 samples/s | 70.6 steps/s
Avg test loss: 0.62068, Avg test acc: 0.87471, Avg tpr: 0.98019, Avg fpr: 0.12720, total FA: 17662

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.09555 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.505 | acc=0.9375 | 3805.4 samples/s | 59.5 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01817 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.503 | acc=0.9844 | 4913.2 samples/s | 76.8 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01160 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.504 | acc=0.9844 | 4964.2 samples/s | 77.6 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00989 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=3.505 | acc=1.0000 | 4920.2 samples/s | 76.9 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00903 | Reg=0.00202 | L2-Norm=14.195 | L2-Norm(final)=3.506 | acc=1.0000 | 4804.8 samples/s | 75.1 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00863 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=3.507 | acc=0.9844 | 4571.7 samples/s | 71.4 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00805 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=3.508 | acc=0.9844 | 3935.7 samples/s | 61.5 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00783 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.509 | acc=0.9844 | 3904.6 samples/s | 61.0 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00781 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.510 | acc=1.0000 | 3917.8 samples/s | 61.2 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00764 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.511 | acc=1.0000 | 3962.1 samples/s | 61.9 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00742 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.512 | acc=0.9844 | 3889.5 samples/s | 60.8 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00739 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=3.513 | acc=0.9844 | 3915.0 samples/s | 61.2 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00717 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=3.514 | acc=1.0000 | 3870.6 samples/s | 60.5 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00693 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.514 | acc=1.0000 | 3900.1 samples/s | 60.9 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00676 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.515 | acc=1.0000 | 3902.3 samples/s | 61.0 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00668 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.516 | acc=1.0000 | 3898.9 samples/s | 60.9 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00664 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.517 | acc=1.0000 | 3950.5 samples/s | 61.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.05316 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.505 | acc=0.9688 | 3776.1 samples/s | 59.0 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00264 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.509 | acc=1.0000 | 4761.1 samples/s | 74.4 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00133 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=3.510 | acc=1.0000 | 4787.6 samples/s | 74.8 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00090 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=3.511 | acc=1.0000 | 4821.6 samples/s | 75.3 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00068 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.512 | acc=1.0000 | 4833.7 samples/s | 75.5 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00056 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.512 | acc=1.0000 | 4809.9 samples/s | 75.2 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00047 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=3.512 | acc=1.0000 | 4733.7 samples/s | 74.0 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=3.513 | acc=1.0000 | 4773.0 samples/s | 74.6 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00035 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.513 | acc=1.0000 | 4684.9 samples/s | 73.2 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00032 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.513 | acc=1.0000 | 4724.0 samples/s | 73.8 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00029 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.514 | acc=1.0000 | 4791.0 samples/s | 74.9 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00026 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.514 | acc=1.0000 | 1510.3 samples/s | 23.6 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00024 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.514 | acc=1.0000 | 4866.8 samples/s | 76.0 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00022 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.514 | acc=1.0000 | 4763.9 samples/s | 74.4 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00021 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.515 | acc=1.0000 | 4673.9 samples/s | 73.0 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00019 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.515 | acc=1.0000 | 4857.3 samples/s | 75.9 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00018 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.515 | acc=1.0000 | 4875.9 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20562 | acc=0.9000 | tpr=0.8591 | fpr=0.0111 | 4520.3 samples/s | 17.7 steps/s
Avg test loss: 0.20994, Avg test acc: 0.89839, Avg tpr: 0.85761, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.65321 | acc=0.8627 | tpr=0.9823 | fpr=0.1395 | 4543.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.66180 | acc=0.8638 | tpr=0.9808 | fpr=0.1384 | 9271.3 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.67302 | acc=0.8626 | tpr=0.9827 | fpr=0.1396 | 9276.1 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.67441 | acc=0.8627 | tpr=0.9847 | fpr=0.1395 | 9286.0 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.67526 | acc=0.8632 | tpr=0.9852 | fpr=0.1390 | 9397.3 samples/s | 36.7 steps/s
[Step= 300] | Loss=0.68047 | acc=0.8634 | tpr=0.9840 | fpr=0.1388 | 9175.5 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.68558 | acc=0.8627 | tpr=0.9850 | fpr=0.1396 | 9478.0 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.68805 | acc=0.8628 | tpr=0.9836 | fpr=0.1394 | 9385.3 samples/s | 36.7 steps/s
[Step= 450] | Loss=0.69350 | acc=0.8624 | tpr=0.9834 | fpr=0.1398 | 8885.0 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.69286 | acc=0.8620 | tpr=0.9833 | fpr=0.1402 | 9135.8 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.69110 | acc=0.8623 | tpr=0.9833 | fpr=0.1399 | 17534.8 samples/s | 68.5 steps/s
Avg test loss: 0.69040, Avg test acc: 0.86236, Avg tpr: 0.98296, Avg fpr: 0.13984, total FA: 19416

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.03707 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.523 | acc=0.9531 | 4082.0 samples/s | 63.8 steps/s
[Step=36850 Epoch=36.0] | Loss=0.01566 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.521 | acc=0.9844 | 4501.3 samples/s | 70.3 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01055 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=3.521 | acc=1.0000 | 4751.3 samples/s | 74.2 steps/s
[Step=36950 Epoch=36.1] | Loss=0.00878 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.522 | acc=1.0000 | 4812.3 samples/s | 75.2 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00773 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=3.523 | acc=0.9844 | 4986.8 samples/s | 77.9 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00725 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=3.524 | acc=1.0000 | 4870.7 samples/s | 76.1 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00675 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=3.525 | acc=0.9688 | 5033.7 samples/s | 78.7 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00667 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=3.527 | acc=0.9844 | 4575.2 samples/s | 71.5 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00660 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=3.527 | acc=1.0000 | 3918.1 samples/s | 61.2 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00657 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=3.528 | acc=1.0000 | 3999.4 samples/s | 62.5 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00661 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=3.529 | acc=1.0000 | 3864.9 samples/s | 60.4 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00648 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.530 | acc=0.9844 | 3941.3 samples/s | 61.6 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00640 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.531 | acc=0.9844 | 3896.3 samples/s | 60.9 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00642 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=3.532 | acc=1.0000 | 3931.1 samples/s | 61.4 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00647 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.532 | acc=1.0000 | 3865.0 samples/s | 60.4 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00644 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.533 | acc=1.0000 | 3898.5 samples/s | 60.9 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00657 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=3.534 | acc=1.0000 | 3912.5 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.00993 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.523 | acc=0.9844 | 2792.3 samples/s | 43.6 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00189 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.530 | acc=1.0000 | 4549.7 samples/s | 71.1 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00096 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.531 | acc=1.0000 | 4833.6 samples/s | 75.5 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00065 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.532 | acc=1.0000 | 4740.9 samples/s | 74.1 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00050 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=3.532 | acc=1.0000 | 4847.3 samples/s | 75.7 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=3.533 | acc=1.0000 | 4784.4 samples/s | 74.8 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00033 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.533 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00029 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.533 | acc=1.0000 | 4739.4 samples/s | 74.1 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00026 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.533 | acc=1.0000 | 4762.5 samples/s | 74.4 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00023 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.533 | acc=1.0000 | 4830.3 samples/s | 75.5 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00021 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.534 | acc=1.0000 | 4829.2 samples/s | 75.5 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00019 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.534 | acc=1.0000 | 1479.8 samples/s | 23.1 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00017 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.534 | acc=1.0000 | 4394.0 samples/s | 68.7 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00016 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.534 | acc=1.0000 | 4584.8 samples/s | 71.6 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00015 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.534 | acc=1.0000 | 4698.0 samples/s | 73.4 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00014 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.534 | acc=1.0000 | 4839.0 samples/s | 75.6 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00013 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.534 | acc=1.0000 | 4775.6 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21682 | acc=0.8955 | tpr=0.8529 | fpr=0.0119 | 4603.9 samples/s | 18.0 steps/s
Avg test loss: 0.22029, Avg test acc: 0.89398, Avg tpr: 0.85166, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.60836 | acc=0.8777 | tpr=0.9823 | fpr=0.1241 | 4602.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.61725 | acc=0.8777 | tpr=0.9787 | fpr=0.1242 | 9474.7 samples/s | 37.0 steps/s
[Step= 150] | Loss=0.62848 | acc=0.8765 | tpr=0.9813 | fpr=0.1254 | 8934.8 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.62986 | acc=0.8763 | tpr=0.9836 | fpr=0.1256 | 9223.4 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.63065 | acc=0.8766 | tpr=0.9843 | fpr=0.1254 | 9444.3 samples/s | 36.9 steps/s
[Step= 300] | Loss=0.63593 | acc=0.8767 | tpr=0.9833 | fpr=0.1253 | 9290.5 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.64024 | acc=0.8761 | tpr=0.9831 | fpr=0.1258 | 8921.6 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.64275 | acc=0.8761 | tpr=0.9814 | fpr=0.1258 | 8527.0 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.64788 | acc=0.8757 | tpr=0.9810 | fpr=0.1262 | 8961.5 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.64705 | acc=0.8752 | tpr=0.9811 | fpr=0.1267 | 5525.8 samples/s | 21.6 steps/s
[Step= 550] | Loss=0.64553 | acc=0.8754 | tpr=0.9813 | fpr=0.1265 | 16967.9 samples/s | 66.3 steps/s
Avg test loss: 0.64483, Avg test acc: 0.87543, Avg tpr: 0.98098, Avg fpr: 0.12649, total FA: 17563

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.13474 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.540 | acc=0.9219 | 3623.5 samples/s | 56.6 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01604 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.537 | acc=0.9844 | 4903.7 samples/s | 76.6 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01100 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.537 | acc=1.0000 | 4910.8 samples/s | 76.7 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00929 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=3.538 | acc=1.0000 | 4872.8 samples/s | 76.1 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00839 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=3.539 | acc=1.0000 | 5163.9 samples/s | 80.7 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00796 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.540 | acc=1.0000 | 4940.8 samples/s | 77.2 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00754 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=3.541 | acc=1.0000 | 4991.3 samples/s | 78.0 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00722 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=3.542 | acc=1.0000 | 4931.0 samples/s | 77.0 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00706 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=3.543 | acc=0.9844 | 5048.3 samples/s | 78.9 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00698 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=3.544 | acc=0.9688 | 4997.6 samples/s | 78.1 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00687 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=3.544 | acc=1.0000 | 4964.1 samples/s | 77.6 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00688 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=3.545 | acc=0.9844 | 4839.3 samples/s | 75.6 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00676 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.546 | acc=0.9844 | 4576.9 samples/s | 71.5 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00660 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=3.547 | acc=1.0000 | 3954.5 samples/s | 61.8 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00654 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=3.548 | acc=1.0000 | 3899.3 samples/s | 60.9 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00648 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=3.548 | acc=1.0000 | 3926.8 samples/s | 61.4 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00637 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=3.549 | acc=1.0000 | 3930.7 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00249 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.540 | acc=1.0000 | 3811.6 samples/s | 59.6 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00428 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.544 | acc=1.0000 | 4578.4 samples/s | 71.5 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00216 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.545 | acc=1.0000 | 4829.3 samples/s | 75.5 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00145 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.545 | acc=1.0000 | 4759.3 samples/s | 74.4 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00109 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.545 | acc=1.0000 | 4679.9 samples/s | 73.1 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00088 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.545 | acc=1.0000 | 4781.4 samples/s | 74.7 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00073 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.545 | acc=1.0000 | 4725.8 samples/s | 73.8 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00063 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.546 | acc=1.0000 | 4848.5 samples/s | 75.8 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00055 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.546 | acc=1.0000 | 4776.9 samples/s | 74.6 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00049 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.546 | acc=1.0000 | 4848.2 samples/s | 75.8 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00045 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.546 | acc=1.0000 | 4835.4 samples/s | 75.6 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00041 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.546 | acc=1.0000 | 1540.3 samples/s | 24.1 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00037 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=3.546 | acc=1.0000 | 4895.9 samples/s | 76.5 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00034 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.546 | acc=1.0000 | 4790.8 samples/s | 74.9 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00032 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.547 | acc=1.0000 | 4751.9 samples/s | 74.2 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00030 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.547 | acc=1.0000 | 4868.7 samples/s | 76.1 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00028 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.547 | acc=1.0000 | 4927.3 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23332 | acc=0.8865 | tpr=0.8395 | fpr=0.0114 | 4594.3 samples/s | 17.9 steps/s
Avg test loss: 0.23841, Avg test acc: 0.88593, Avg tpr: 0.83931, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.60992 | acc=0.8766 | tpr=0.9823 | fpr=0.1253 | 4557.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.61858 | acc=0.8773 | tpr=0.9808 | fpr=0.1246 | 9477.7 samples/s | 37.0 steps/s
[Step= 150] | Loss=0.62896 | acc=0.8762 | tpr=0.9813 | fpr=0.1257 | 9427.0 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.63049 | acc=0.8762 | tpr=0.9836 | fpr=0.1257 | 8920.2 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.63152 | acc=0.8765 | tpr=0.9843 | fpr=0.1254 | 9199.0 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.63633 | acc=0.8765 | tpr=0.9825 | fpr=0.1254 | 9132.3 samples/s | 35.7 steps/s
[Step= 350] | Loss=0.64061 | acc=0.8760 | tpr=0.9825 | fpr=0.1259 | 9645.4 samples/s | 37.7 steps/s
[Step= 400] | Loss=0.64280 | acc=0.8760 | tpr=0.9803 | fpr=0.1259 | 8829.2 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.64790 | acc=0.8756 | tpr=0.9800 | fpr=0.1263 | 6206.0 samples/s | 24.2 steps/s
[Step= 500] | Loss=0.64720 | acc=0.8754 | tpr=0.9802 | fpr=0.1264 | 9666.0 samples/s | 37.8 steps/s
[Step= 550] | Loss=0.64539 | acc=0.8756 | tpr=0.9801 | fpr=0.1263 | 16341.2 samples/s | 63.8 steps/s
Avg test loss: 0.64477, Avg test acc: 0.87565, Avg tpr: 0.97979, Avg fpr: 0.12624, total FA: 17528

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.11475 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=3.554 | acc=0.9375 | 3818.3 samples/s | 59.7 steps/s
[Step=38450 Epoch=37.5] | Loss=0.02078 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.549 | acc=1.0000 | 4892.9 samples/s | 76.5 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01404 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.549 | acc=1.0000 | 4900.8 samples/s | 76.6 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01112 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.550 | acc=0.9844 | 4924.4 samples/s | 76.9 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00937 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.551 | acc=1.0000 | 4993.7 samples/s | 78.0 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00867 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.552 | acc=1.0000 | 4943.5 samples/s | 77.2 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00811 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.553 | acc=1.0000 | 5040.7 samples/s | 78.8 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00798 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.553 | acc=0.9844 | 4989.1 samples/s | 78.0 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00770 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.554 | acc=0.9688 | 5117.8 samples/s | 80.0 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00751 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.555 | acc=1.0000 | 4923.0 samples/s | 76.9 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00718 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.556 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00708 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.556 | acc=0.9844 | 4916.3 samples/s | 76.8 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00697 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.557 | acc=0.9844 | 4975.9 samples/s | 77.7 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00678 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=3.558 | acc=0.9688 | 4863.7 samples/s | 76.0 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00666 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.559 | acc=1.0000 | 5024.8 samples/s | 78.5 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00671 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=3.560 | acc=1.0000 | 4930.2 samples/s | 77.0 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00670 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=3.561 | acc=1.0000 | 4965.4 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.01596 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=3.554 | acc=0.9844 | 3568.6 samples/s | 55.8 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00293 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.559 | acc=1.0000 | 4903.3 samples/s | 76.6 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00148 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.560 | acc=1.0000 | 4736.4 samples/s | 74.0 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00099 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.560 | acc=1.0000 | 4760.1 samples/s | 74.4 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=3.560 | acc=1.0000 | 4850.5 samples/s | 75.8 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00060 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=3.560 | acc=1.0000 | 4764.4 samples/s | 74.4 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00050 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.561 | acc=1.0000 | 4712.5 samples/s | 73.6 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00043 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=3.561 | acc=1.0000 | 4819.6 samples/s | 75.3 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00038 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=3.561 | acc=1.0000 | 4834.5 samples/s | 75.5 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00034 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=3.561 | acc=1.0000 | 4694.6 samples/s | 73.4 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00030 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=3.561 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00028 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.561 | acc=1.0000 | 1488.6 samples/s | 23.3 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00025 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=3.561 | acc=1.0000 | 4796.0 samples/s | 74.9 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00023 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=3.561 | acc=1.0000 | 4830.5 samples/s | 75.5 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00022 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=3.561 | acc=1.0000 | 4744.5 samples/s | 74.1 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00020 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=3.561 | acc=1.0000 | 4845.6 samples/s | 75.7 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00019 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=3.561 | acc=1.0000 | 4747.9 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23510 | acc=0.8862 | tpr=0.8389 | fpr=0.0111 | 4567.1 samples/s | 17.8 steps/s
Avg test loss: 0.23974, Avg test acc: 0.88597, Avg tpr: 0.83919, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.59670 | acc=0.8805 | tpr=0.9779 | fpr=0.1212 | 4664.3 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.60479 | acc=0.8809 | tpr=0.9787 | fpr=0.1209 | 9608.2 samples/s | 37.5 steps/s
[Step= 150] | Loss=0.61539 | acc=0.8800 | tpr=0.9798 | fpr=0.1218 | 8100.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.61680 | acc=0.8804 | tpr=0.9825 | fpr=0.1215 | 9581.6 samples/s | 37.4 steps/s
[Step= 250] | Loss=0.61766 | acc=0.8805 | tpr=0.9834 | fpr=0.1214 | 9400.5 samples/s | 36.7 steps/s
[Step= 300] | Loss=0.62253 | acc=0.8805 | tpr=0.9818 | fpr=0.1213 | 9116.9 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.62684 | acc=0.8802 | tpr=0.9818 | fpr=0.1217 | 5546.5 samples/s | 21.7 steps/s
[Step= 400] | Loss=0.62923 | acc=0.8801 | tpr=0.9803 | fpr=0.1218 | 9279.6 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.63441 | acc=0.8797 | tpr=0.9800 | fpr=0.1222 | 9304.1 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.63368 | acc=0.8796 | tpr=0.9797 | fpr=0.1222 | 9383.0 samples/s | 36.7 steps/s
[Step= 550] | Loss=0.63185 | acc=0.8799 | tpr=0.9801 | fpr=0.1220 | 16300.6 samples/s | 63.7 steps/s
Avg test loss: 0.63116, Avg test acc: 0.87988, Avg tpr: 0.97979, Avg fpr: 0.12194, total FA: 16931

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.11802 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.567 | acc=0.9219 | 3655.8 samples/s | 57.1 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01613 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=3.565 | acc=0.9844 | 4788.0 samples/s | 74.8 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01030 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=3.565 | acc=0.9844 | 4796.4 samples/s | 74.9 steps/s
[Step=39350 Epoch=38.4] | Loss=0.00909 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=3.566 | acc=1.0000 | 4852.6 samples/s | 75.8 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00801 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=3.566 | acc=1.0000 | 4906.8 samples/s | 76.7 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00762 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=3.567 | acc=1.0000 | 4988.0 samples/s | 77.9 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00742 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=3.568 | acc=1.0000 | 4915.6 samples/s | 76.8 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00743 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.569 | acc=0.9688 | 4962.4 samples/s | 77.5 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00701 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=3.570 | acc=1.0000 | 4412.9 samples/s | 69.0 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00708 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.570 | acc=1.0000 | 3934.2 samples/s | 61.5 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00676 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=3.571 | acc=1.0000 | 3888.2 samples/s | 60.8 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00682 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.572 | acc=1.0000 | 3942.8 samples/s | 61.6 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00669 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.572 | acc=1.0000 | 3960.9 samples/s | 61.9 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00666 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=3.573 | acc=0.9844 | 3863.6 samples/s | 60.4 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00656 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.574 | acc=1.0000 | 3961.8 samples/s | 61.9 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00643 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=3.575 | acc=0.9844 | 3844.6 samples/s | 60.1 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00647 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=3.575 | acc=1.0000 | 3925.1 samples/s | 61.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.00197 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.567 | acc=1.0000 | 3832.2 samples/s | 59.9 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00377 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=3.571 | acc=1.0000 | 4597.5 samples/s | 71.8 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00190 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.572 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00127 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.572 | acc=1.0000 | 4597.8 samples/s | 71.8 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00096 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=3.572 | acc=1.0000 | 3758.3 samples/s | 58.7 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00077 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=3.572 | acc=1.0000 | 3748.4 samples/s | 58.6 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00064 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=3.572 | acc=1.0000 | 3722.1 samples/s | 58.2 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00055 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=3.572 | acc=1.0000 | 3743.2 samples/s | 58.5 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00048 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=3.573 | acc=1.0000 | 3732.6 samples/s | 58.3 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00043 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=3.573 | acc=1.0000 | 3810.2 samples/s | 59.5 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00039 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=3.573 | acc=1.0000 | 3716.1 samples/s | 58.1 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00035 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=3.573 | acc=1.0000 | 1487.9 samples/s | 23.2 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00032 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=3.573 | acc=1.0000 | 4829.6 samples/s | 75.5 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00030 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=3.573 | acc=1.0000 | 4770.6 samples/s | 74.5 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00028 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=3.573 | acc=1.0000 | 4909.8 samples/s | 76.7 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00026 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=3.573 | acc=1.0000 | 4740.2 samples/s | 74.1 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00024 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=3.573 | acc=1.0000 | 4813.9 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23059 | acc=0.8883 | tpr=0.8417 | fpr=0.0107 | 4671.9 samples/s | 18.2 steps/s
Avg test loss: 0.23507, Avg test acc: 0.88737, Avg tpr: 0.84100, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.59158 | acc=0.8827 | tpr=0.9823 | fpr=0.1191 | 4516.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.60030 | acc=0.8825 | tpr=0.9808 | fpr=0.1193 | 9276.0 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.61067 | acc=0.8817 | tpr=0.9813 | fpr=0.1202 | 8989.1 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.61173 | acc=0.8816 | tpr=0.9836 | fpr=0.1203 | 9407.4 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.61299 | acc=0.8815 | tpr=0.9834 | fpr=0.1203 | 5966.6 samples/s | 23.3 steps/s
[Step= 300] | Loss=0.61804 | acc=0.8816 | tpr=0.9825 | fpr=0.1203 | 9060.2 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.62284 | acc=0.8810 | tpr=0.9825 | fpr=0.1208 | 8880.0 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.62525 | acc=0.8807 | tpr=0.9814 | fpr=0.1211 | 9331.0 samples/s | 36.4 steps/s
[Step= 450] | Loss=0.63031 | acc=0.8805 | tpr=0.9810 | fpr=0.1214 | 9142.0 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.62958 | acc=0.8803 | tpr=0.9815 | fpr=0.1215 | 9385.0 samples/s | 36.7 steps/s
[Step= 550] | Loss=0.62788 | acc=0.8804 | tpr=0.9817 | fpr=0.1214 | 16494.2 samples/s | 64.4 steps/s
Avg test loss: 0.62721, Avg test acc: 0.88046, Avg tpr: 0.98138, Avg fpr: 0.12137, total FA: 16852
 19316
