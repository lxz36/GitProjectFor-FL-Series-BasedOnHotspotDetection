Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34016 | Reg=0.00426 | L2-Norm=20.639 | L2-Norm(final)=1.938 | acc=0.5625 | 2801.1 samples/s | 43.8 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.32291 | Reg=0.00412 | L2-Norm=20.303 | L2-Norm(final)=1.921 | acc=0.7188 | 4922.3 samples/s | 76.9 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.27819 | Reg=0.00407 | L2-Norm=20.165 | L2-Norm(final)=1.940 | acc=0.8594 | 4871.3 samples/s | 76.1 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.24476 | Reg=0.00402 | L2-Norm=20.061 | L2-Norm(final)=1.957 | acc=0.8594 | 4928.9 samples/s | 77.0 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.22614 | Reg=0.00399 | L2-Norm=19.971 | L2-Norm(final)=1.968 | acc=0.8750 | 5026.4 samples/s | 78.5 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.20920 | Reg=0.00396 | L2-Norm=19.892 | L2-Norm(final)=1.977 | acc=0.8750 | 5001.6 samples/s | 78.1 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.19546 | Reg=0.00393 | L2-Norm=19.819 | L2-Norm(final)=1.985 | acc=0.9375 | 5033.7 samples/s | 78.7 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.18536 | Reg=0.00390 | L2-Norm=19.754 | L2-Norm(final)=1.993 | acc=0.8594 | 5035.0 samples/s | 78.7 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.17587 | Reg=0.00388 | L2-Norm=19.694 | L2-Norm(final)=1.999 | acc=0.9062 | 5014.7 samples/s | 78.4 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16701 | Reg=0.00386 | L2-Norm=19.641 | L2-Norm(final)=2.005 | acc=0.9375 | 5011.2 samples/s | 78.3 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.16082 | Reg=0.00384 | L2-Norm=19.590 | L2-Norm(final)=2.010 | acc=0.9531 | 5031.9 samples/s | 78.6 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15497 | Reg=0.00382 | L2-Norm=19.544 | L2-Norm(final)=2.015 | acc=0.8906 | 5066.4 samples/s | 79.2 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.15066 | Reg=0.00380 | L2-Norm=19.502 | L2-Norm(final)=2.019 | acc=0.9375 | 5016.5 samples/s | 78.4 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14620 | Reg=0.00379 | L2-Norm=19.464 | L2-Norm(final)=2.023 | acc=0.9531 | 4979.9 samples/s | 77.8 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.14247 | Reg=0.00378 | L2-Norm=19.427 | L2-Norm(final)=2.026 | acc=0.9062 | 4988.3 samples/s | 77.9 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13893 | Reg=0.00376 | L2-Norm=19.393 | L2-Norm(final)=2.029 | acc=0.8750 | 4979.7 samples/s | 77.8 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13548 | Reg=0.00375 | L2-Norm=19.361 | L2-Norm(final)=2.031 | acc=0.9062 | 4948.8 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33781 | Reg=0.00426 | L2-Norm=20.639 | L2-Norm(final)=1.938 | acc=0.5781 | 3827.8 samples/s | 59.8 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.18882 | Reg=0.00415 | L2-Norm=20.359 | L2-Norm(final)=1.952 | acc=0.9531 | 4695.6 samples/s | 73.4 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.11763 | Reg=0.00409 | L2-Norm=20.219 | L2-Norm(final)=1.970 | acc=1.0000 | 4687.4 samples/s | 73.2 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08928 | Reg=0.00404 | L2-Norm=20.096 | L2-Norm(final)=1.982 | acc=0.9531 | 4691.1 samples/s | 73.3 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.07174 | Reg=0.00400 | L2-Norm=19.987 | L2-Norm(final)=1.990 | acc=1.0000 | 4668.4 samples/s | 72.9 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05983 | Reg=0.00396 | L2-Norm=19.889 | L2-Norm(final)=1.997 | acc=1.0000 | 4793.0 samples/s | 74.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05264 | Reg=0.00392 | L2-Norm=19.796 | L2-Norm(final)=2.003 | acc=1.0000 | 4762.9 samples/s | 74.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04711 | Reg=0.00389 | L2-Norm=19.710 | L2-Norm(final)=2.008 | acc=1.0000 | 4765.6 samples/s | 74.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04199 | Reg=0.00386 | L2-Norm=19.631 | L2-Norm(final)=2.013 | acc=1.0000 | 4753.5 samples/s | 74.3 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03833 | Reg=0.00383 | L2-Norm=19.556 | L2-Norm(final)=2.018 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03521 | Reg=0.00380 | L2-Norm=19.484 | L2-Norm(final)=2.022 | acc=1.0000 | 4774.7 samples/s | 74.6 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03232 | Reg=0.00377 | L2-Norm=19.414 | L2-Norm(final)=2.026 | acc=1.0000 | 2136.9 samples/s | 33.4 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02977 | Reg=0.00375 | L2-Norm=19.346 | L2-Norm(final)=2.030 | acc=1.0000 | 4688.2 samples/s | 73.3 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02771 | Reg=0.00372 | L2-Norm=19.279 | L2-Norm(final)=2.033 | acc=1.0000 | 4757.8 samples/s | 74.3 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02583 | Reg=0.00369 | L2-Norm=19.213 | L2-Norm(final)=2.036 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02426 | Reg=0.00367 | L2-Norm=19.148 | L2-Norm(final)=2.040 | acc=1.0000 | 4711.5 samples/s | 73.6 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02297 | Reg=0.00365 | L2-Norm=19.086 | L2-Norm(final)=2.043 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29985 | acc=0.6603 | tpr=0.5702 | fpr=0.1440 | 4649.3 samples/s | 18.2 steps/s
Avg test loss: 0.29938, Avg test acc: 0.66388, Avg tpr: 0.57230, Avg fpr: 0.13473, total FA: 1051

Testing server on iccad2012
[Step=  50] | Loss=0.23225 | acc=0.8110 | tpr=0.9027 | fpr=0.1906 | 4454.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.23216 | acc=0.8125 | tpr=0.9232 | fpr=0.1895 | 8944.2 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.23322 | acc=0.8106 | tpr=0.9150 | fpr=0.1913 | 9228.8 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.23318 | acc=0.8107 | tpr=0.9235 | fpr=0.1914 | 8274.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.23346 | acc=0.8097 | tpr=0.9231 | fpr=0.1924 | 8781.2 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.23326 | acc=0.8097 | tpr=0.9244 | fpr=0.1924 | 8808.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.23360 | acc=0.8089 | tpr=0.9192 | fpr=0.1931 | 8878.7 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.23383 | acc=0.8084 | tpr=0.9163 | fpr=0.1936 | 8989.9 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.23389 | acc=0.8083 | tpr=0.9138 | fpr=0.1936 | 8463.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.23403 | acc=0.8081 | tpr=0.9132 | fpr=0.1938 | 9139.8 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.23367 | acc=0.8086 | tpr=0.9140 | fpr=0.1934 | 15628.1 samples/s | 61.0 steps/s
Avg test loss: 0.23362, Avg test acc: 0.80857, Avg tpr: 0.91284, Avg fpr: 0.19333, total FA: 26843

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.26528 | Reg=0.00311 | L2-Norm=17.632 | L2-Norm(final)=2.055 | acc=0.7031 | 4143.4 samples/s | 64.7 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15259 | Reg=0.00318 | L2-Norm=17.836 | L2-Norm(final)=2.067 | acc=0.8906 | 4591.4 samples/s | 71.7 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.12986 | Reg=0.00320 | L2-Norm=17.899 | L2-Norm(final)=2.085 | acc=0.9219 | 4778.3 samples/s | 74.7 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.11812 | Reg=0.00321 | L2-Norm=17.921 | L2-Norm(final)=2.096 | acc=0.9375 | 4875.5 samples/s | 76.2 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11384 | Reg=0.00322 | L2-Norm=17.933 | L2-Norm(final)=2.103 | acc=0.9531 | 4933.4 samples/s | 77.1 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.10849 | Reg=0.00322 | L2-Norm=17.938 | L2-Norm(final)=2.108 | acc=0.9062 | 4874.4 samples/s | 76.2 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10526 | Reg=0.00322 | L2-Norm=17.937 | L2-Norm(final)=2.112 | acc=0.9219 | 4890.6 samples/s | 76.4 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10213 | Reg=0.00322 | L2-Norm=17.933 | L2-Norm(final)=2.116 | acc=0.9531 | 4981.8 samples/s | 77.8 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.09925 | Reg=0.00321 | L2-Norm=17.928 | L2-Norm(final)=2.119 | acc=0.9844 | 4971.9 samples/s | 77.7 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.09736 | Reg=0.00321 | L2-Norm=17.925 | L2-Norm(final)=2.122 | acc=0.9375 | 4914.1 samples/s | 76.8 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09512 | Reg=0.00321 | L2-Norm=17.923 | L2-Norm(final)=2.125 | acc=0.8906 | 4941.8 samples/s | 77.2 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09296 | Reg=0.00321 | L2-Norm=17.919 | L2-Norm(final)=2.127 | acc=0.9219 | 5002.8 samples/s | 78.2 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09160 | Reg=0.00321 | L2-Norm=17.915 | L2-Norm(final)=2.128 | acc=0.8750 | 5010.4 samples/s | 78.3 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09012 | Reg=0.00321 | L2-Norm=17.912 | L2-Norm(final)=2.129 | acc=0.9688 | 5015.6 samples/s | 78.4 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.08904 | Reg=0.00321 | L2-Norm=17.910 | L2-Norm(final)=2.130 | acc=0.9375 | 4909.0 samples/s | 76.7 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08800 | Reg=0.00321 | L2-Norm=17.909 | L2-Norm(final)=2.131 | acc=0.9688 | 4903.2 samples/s | 76.6 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08698 | Reg=0.00321 | L2-Norm=17.908 | L2-Norm(final)=2.131 | acc=0.9219 | 4984.4 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.19858 | Reg=0.00311 | L2-Norm=17.632 | L2-Norm(final)=2.053 | acc=0.8594 | 3873.9 samples/s | 60.5 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.06334 | Reg=0.00321 | L2-Norm=17.913 | L2-Norm(final)=2.052 | acc=0.9219 | 4693.9 samples/s | 73.3 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.03891 | Reg=0.00323 | L2-Norm=17.983 | L2-Norm(final)=2.052 | acc=0.9844 | 4735.7 samples/s | 74.0 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02814 | Reg=0.00323 | L2-Norm=17.985 | L2-Norm(final)=2.058 | acc=1.0000 | 4636.8 samples/s | 72.4 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.02206 | Reg=0.00323 | L2-Norm=17.963 | L2-Norm(final)=2.065 | acc=1.0000 | 4545.3 samples/s | 71.0 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01824 | Reg=0.00322 | L2-Norm=17.932 | L2-Norm(final)=2.072 | acc=1.0000 | 4476.2 samples/s | 69.9 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01659 | Reg=0.00320 | L2-Norm=17.897 | L2-Norm(final)=2.077 | acc=1.0000 | 4542.2 samples/s | 71.0 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01520 | Reg=0.00319 | L2-Norm=17.861 | L2-Norm(final)=2.081 | acc=1.0000 | 4588.4 samples/s | 71.7 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01376 | Reg=0.00318 | L2-Norm=17.824 | L2-Norm(final)=2.083 | acc=1.0000 | 4688.3 samples/s | 73.3 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01249 | Reg=0.00316 | L2-Norm=17.786 | L2-Norm(final)=2.086 | acc=1.0000 | 4720.5 samples/s | 73.8 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01150 | Reg=0.00315 | L2-Norm=17.747 | L2-Norm(final)=2.089 | acc=1.0000 | 4839.2 samples/s | 75.6 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01068 | Reg=0.00314 | L2-Norm=17.708 | L2-Norm(final)=2.092 | acc=1.0000 | 2113.3 samples/s | 33.0 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00988 | Reg=0.00312 | L2-Norm=17.668 | L2-Norm(final)=2.094 | acc=1.0000 | 4695.2 samples/s | 73.4 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00914 | Reg=0.00311 | L2-Norm=17.628 | L2-Norm(final)=2.097 | acc=1.0000 | 4738.3 samples/s | 74.0 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00850 | Reg=0.00309 | L2-Norm=17.587 | L2-Norm(final)=2.100 | acc=1.0000 | 4778.9 samples/s | 74.7 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00795 | Reg=0.00308 | L2-Norm=17.545 | L2-Norm(final)=2.102 | acc=1.0000 | 4638.2 samples/s | 72.5 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00747 | Reg=0.00306 | L2-Norm=17.503 | L2-Norm(final)=2.105 | acc=1.0000 | 4747.4 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54691 | acc=0.5396 | tpr=0.3392 | fpr=0.0253 | 4514.3 samples/s | 17.6 steps/s
Avg test loss: 0.55210, Avg test acc: 0.53534, Avg tpr: 0.33566, Avg fpr: 0.02551, total FA: 199

Testing server on iccad2012
[Step=  50] | Loss=0.10024 | acc=0.9276 | tpr=0.8805 | fpr=0.0716 | 4589.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.10158 | acc=0.9268 | tpr=0.8849 | fpr=0.0725 | 8795.4 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.10269 | acc=0.9265 | tpr=0.8790 | fpr=0.0726 | 8681.8 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.10295 | acc=0.9271 | tpr=0.8842 | fpr=0.0721 | 8983.3 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.10227 | acc=0.9274 | tpr=0.8734 | fpr=0.0716 | 8491.0 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.10202 | acc=0.9278 | tpr=0.8705 | fpr=0.0712 | 9017.9 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.10205 | acc=0.9282 | tpr=0.8723 | fpr=0.0708 | 8453.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.10241 | acc=0.9282 | tpr=0.8720 | fpr=0.0708 | 8777.1 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.10302 | acc=0.9279 | tpr=0.8690 | fpr=0.0711 | 8796.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.10303 | acc=0.9283 | tpr=0.8709 | fpr=0.0707 | 8774.0 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.10261 | acc=0.9288 | tpr=0.8727 | fpr=0.0702 | 15111.4 samples/s | 59.0 steps/s
Avg test loss: 0.10258, Avg test acc: 0.92876, Avg tpr: 0.87163, Avg fpr: 0.07021, total FA: 9748

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.40662 | Reg=0.00280 | L2-Norm=16.734 | L2-Norm(final)=2.114 | acc=0.6875 | 3925.7 samples/s | 61.3 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.13183 | Reg=0.00290 | L2-Norm=17.043 | L2-Norm(final)=2.092 | acc=0.9531 | 4815.6 samples/s | 75.2 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10798 | Reg=0.00294 | L2-Norm=17.145 | L2-Norm(final)=2.109 | acc=0.9062 | 4918.5 samples/s | 76.9 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09987 | Reg=0.00295 | L2-Norm=17.184 | L2-Norm(final)=2.116 | acc=0.9844 | 4936.9 samples/s | 77.1 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09304 | Reg=0.00296 | L2-Norm=17.203 | L2-Norm(final)=2.122 | acc=0.9219 | 4907.0 samples/s | 76.7 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08739 | Reg=0.00296 | L2-Norm=17.215 | L2-Norm(final)=2.127 | acc=0.9844 | 5002.9 samples/s | 78.2 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08482 | Reg=0.00297 | L2-Norm=17.222 | L2-Norm(final)=2.129 | acc=0.9844 | 5010.2 samples/s | 78.3 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08354 | Reg=0.00297 | L2-Norm=17.229 | L2-Norm(final)=2.132 | acc=0.9375 | 5008.4 samples/s | 78.3 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.08115 | Reg=0.00297 | L2-Norm=17.236 | L2-Norm(final)=2.134 | acc=0.9688 | 5017.6 samples/s | 78.4 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07918 | Reg=0.00297 | L2-Norm=17.242 | L2-Norm(final)=2.137 | acc=0.9375 | 4987.0 samples/s | 77.9 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07835 | Reg=0.00297 | L2-Norm=17.247 | L2-Norm(final)=2.139 | acc=0.9688 | 5019.2 samples/s | 78.4 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07636 | Reg=0.00298 | L2-Norm=17.252 | L2-Norm(final)=2.140 | acc=0.9688 | 5098.1 samples/s | 79.7 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07553 | Reg=0.00298 | L2-Norm=17.256 | L2-Norm(final)=2.142 | acc=0.9531 | 4793.3 samples/s | 74.9 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07442 | Reg=0.00298 | L2-Norm=17.261 | L2-Norm(final)=2.143 | acc=0.9688 | 4995.8 samples/s | 78.1 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07299 | Reg=0.00298 | L2-Norm=17.266 | L2-Norm(final)=2.144 | acc=0.9531 | 5010.6 samples/s | 78.3 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07242 | Reg=0.00298 | L2-Norm=17.272 | L2-Norm(final)=2.146 | acc=0.9375 | 5048.0 samples/s | 78.9 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07166 | Reg=0.00299 | L2-Norm=17.277 | L2-Norm(final)=2.146 | acc=0.9531 | 4885.9 samples/s | 76.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.13902 | Reg=0.00280 | L2-Norm=16.734 | L2-Norm(final)=2.117 | acc=0.9062 | 3893.3 samples/s | 60.8 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02781 | Reg=0.00288 | L2-Norm=16.970 | L2-Norm(final)=2.119 | acc=0.9531 | 4264.8 samples/s | 66.6 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01915 | Reg=0.00290 | L2-Norm=17.026 | L2-Norm(final)=2.120 | acc=1.0000 | 4579.0 samples/s | 71.5 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01390 | Reg=0.00290 | L2-Norm=17.030 | L2-Norm(final)=2.124 | acc=1.0000 | 4512.5 samples/s | 70.5 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01166 | Reg=0.00290 | L2-Norm=17.015 | L2-Norm(final)=2.127 | acc=1.0000 | 4713.7 samples/s | 73.7 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01008 | Reg=0.00289 | L2-Norm=16.991 | L2-Norm(final)=2.129 | acc=1.0000 | 4648.7 samples/s | 72.6 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00880 | Reg=0.00288 | L2-Norm=16.964 | L2-Norm(final)=2.132 | acc=1.0000 | 4755.0 samples/s | 74.3 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00805 | Reg=0.00287 | L2-Norm=16.936 | L2-Norm(final)=2.135 | acc=1.0000 | 4726.3 samples/s | 73.8 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00771 | Reg=0.00286 | L2-Norm=16.912 | L2-Norm(final)=2.137 | acc=0.9688 | 4745.8 samples/s | 74.2 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00758 | Reg=0.00285 | L2-Norm=16.888 | L2-Norm(final)=2.139 | acc=0.9844 | 4637.0 samples/s | 72.5 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00699 | Reg=0.00284 | L2-Norm=16.863 | L2-Norm(final)=2.139 | acc=1.0000 | 4777.7 samples/s | 74.7 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00658 | Reg=0.00284 | L2-Norm=16.837 | L2-Norm(final)=2.141 | acc=1.0000 | 2079.9 samples/s | 32.5 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00625 | Reg=0.00283 | L2-Norm=16.810 | L2-Norm(final)=2.142 | acc=0.9688 | 4594.3 samples/s | 71.8 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00608 | Reg=0.00282 | L2-Norm=16.784 | L2-Norm(final)=2.143 | acc=1.0000 | 4736.0 samples/s | 74.0 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00579 | Reg=0.00281 | L2-Norm=16.757 | L2-Norm(final)=2.144 | acc=1.0000 | 4695.2 samples/s | 73.4 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00550 | Reg=0.00280 | L2-Norm=16.731 | L2-Norm(final)=2.144 | acc=1.0000 | 4726.0 samples/s | 73.8 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00534 | Reg=0.00279 | L2-Norm=16.705 | L2-Norm(final)=2.145 | acc=0.9844 | 4640.6 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54641 | acc=0.5256 | tpr=0.3157 | fpr=0.0186 | 4518.1 samples/s | 17.6 steps/s
Avg test loss: 0.55041, Avg test acc: 0.52332, Avg tpr: 0.31480, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.07666 | acc=0.9536 | tpr=0.8938 | fpr=0.0453 | 4563.7 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.07825 | acc=0.9519 | tpr=0.9019 | fpr=0.0472 | 9158.3 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.07951 | acc=0.9507 | tpr=0.8963 | fpr=0.0483 | 8233.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.07999 | acc=0.9501 | tpr=0.9005 | fpr=0.0490 | 8798.5 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.07934 | acc=0.9501 | tpr=0.8934 | fpr=0.0489 | 8830.6 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.07945 | acc=0.9501 | tpr=0.8916 | fpr=0.0488 | 8627.4 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.07941 | acc=0.9504 | tpr=0.8923 | fpr=0.0486 | 8969.5 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.07952 | acc=0.9503 | tpr=0.8917 | fpr=0.0486 | 8976.5 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.08022 | acc=0.9498 | tpr=0.8890 | fpr=0.0491 | 8667.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.08017 | acc=0.9499 | tpr=0.8907 | fpr=0.0491 | 8593.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.07966 | acc=0.9502 | tpr=0.8914 | fpr=0.0487 | 16217.8 samples/s | 63.4 steps/s
Avg test loss: 0.07963, Avg test acc: 0.95026, Avg tpr: 0.89025, Avg fpr: 0.04865, total FA: 6755

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.44237 | Reg=0.00265 | L2-Norm=16.272 | L2-Norm(final)=2.137 | acc=0.6562 | 4515.5 samples/s | 70.6 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.12822 | Reg=0.00271 | L2-Norm=16.455 | L2-Norm(final)=2.134 | acc=0.9375 | 4446.3 samples/s | 69.5 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09807 | Reg=0.00274 | L2-Norm=16.542 | L2-Norm(final)=2.153 | acc=0.9219 | 4944.0 samples/s | 77.2 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.08981 | Reg=0.00275 | L2-Norm=16.586 | L2-Norm(final)=2.158 | acc=0.8594 | 4949.5 samples/s | 77.3 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.08331 | Reg=0.00276 | L2-Norm=16.622 | L2-Norm(final)=2.162 | acc=0.9219 | 5011.9 samples/s | 78.3 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07896 | Reg=0.00277 | L2-Norm=16.650 | L2-Norm(final)=2.165 | acc=0.9375 | 4931.6 samples/s | 77.1 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07596 | Reg=0.00278 | L2-Norm=16.674 | L2-Norm(final)=2.167 | acc=0.9219 | 4962.5 samples/s | 77.5 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.07498 | Reg=0.00279 | L2-Norm=16.696 | L2-Norm(final)=2.168 | acc=0.9375 | 5025.0 samples/s | 78.5 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.07252 | Reg=0.00280 | L2-Norm=16.718 | L2-Norm(final)=2.170 | acc=0.8906 | 4870.4 samples/s | 76.1 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.07129 | Reg=0.00280 | L2-Norm=16.736 | L2-Norm(final)=2.171 | acc=0.9688 | 4998.5 samples/s | 78.1 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.07058 | Reg=0.00281 | L2-Norm=16.753 | L2-Norm(final)=2.171 | acc=0.9844 | 4988.4 samples/s | 77.9 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06918 | Reg=0.00281 | L2-Norm=16.769 | L2-Norm(final)=2.171 | acc=0.9844 | 4982.8 samples/s | 77.9 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06830 | Reg=0.00282 | L2-Norm=16.785 | L2-Norm(final)=2.172 | acc=0.9844 | 4914.3 samples/s | 76.8 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06738 | Reg=0.00282 | L2-Norm=16.799 | L2-Norm(final)=2.172 | acc=0.9844 | 4956.9 samples/s | 77.5 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06673 | Reg=0.00283 | L2-Norm=16.814 | L2-Norm(final)=2.173 | acc=0.9688 | 4920.4 samples/s | 76.9 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06566 | Reg=0.00283 | L2-Norm=16.829 | L2-Norm(final)=2.174 | acc=0.9531 | 5017.0 samples/s | 78.4 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06528 | Reg=0.00284 | L2-Norm=16.842 | L2-Norm(final)=2.174 | acc=0.9219 | 4927.8 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.03345 | Reg=0.00265 | L2-Norm=16.272 | L2-Norm(final)=2.141 | acc=0.9844 | 4228.2 samples/s | 66.1 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01568 | Reg=0.00269 | L2-Norm=16.400 | L2-Norm(final)=2.181 | acc=1.0000 | 4217.8 samples/s | 65.9 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01041 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.182 | acc=1.0000 | 4640.6 samples/s | 72.5 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00730 | Reg=0.00270 | L2-Norm=16.434 | L2-Norm(final)=2.186 | acc=1.0000 | 4721.8 samples/s | 73.8 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00659 | Reg=0.00270 | L2-Norm=16.419 | L2-Norm(final)=2.191 | acc=0.9844 | 4667.3 samples/s | 72.9 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00813 | Reg=0.00269 | L2-Norm=16.405 | L2-Norm(final)=2.191 | acc=0.9688 | 4722.5 samples/s | 73.8 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00763 | Reg=0.00269 | L2-Norm=16.399 | L2-Norm(final)=2.188 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00696 | Reg=0.00269 | L2-Norm=16.391 | L2-Norm(final)=2.188 | acc=1.0000 | 4681.9 samples/s | 73.2 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00642 | Reg=0.00268 | L2-Norm=16.377 | L2-Norm(final)=2.188 | acc=1.0000 | 4725.8 samples/s | 73.8 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00585 | Reg=0.00268 | L2-Norm=16.360 | L2-Norm(final)=2.189 | acc=1.0000 | 4762.2 samples/s | 74.4 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00534 | Reg=0.00267 | L2-Norm=16.340 | L2-Norm(final)=2.190 | acc=1.0000 | 4694.5 samples/s | 73.4 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00502 | Reg=0.00266 | L2-Norm=16.319 | L2-Norm(final)=2.192 | acc=1.0000 | 2133.8 samples/s | 33.3 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00478 | Reg=0.00266 | L2-Norm=16.298 | L2-Norm(final)=2.193 | acc=1.0000 | 4810.5 samples/s | 75.2 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00443 | Reg=0.00265 | L2-Norm=16.275 | L2-Norm(final)=2.195 | acc=1.0000 | 4796.8 samples/s | 74.9 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00412 | Reg=0.00264 | L2-Norm=16.251 | L2-Norm(final)=2.197 | acc=1.0000 | 4638.7 samples/s | 72.5 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00385 | Reg=0.00263 | L2-Norm=16.224 | L2-Norm(final)=2.199 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00361 | Reg=0.00262 | L2-Norm=16.196 | L2-Norm(final)=2.200 | acc=1.0000 | 4676.1 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37210 | acc=0.7109 | tpr=0.5961 | fpr=0.0399 | 4595.7 samples/s | 18.0 steps/s
Avg test loss: 0.37473, Avg test acc: 0.70859, Avg tpr: 0.59398, Avg fpr: 0.03935, total FA: 307

Testing server on iccad2012
[Step=  50] | Loss=0.15187 | acc=0.9054 | tpr=0.9513 | fpr=0.0954 | 4593.9 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.15534 | acc=0.9051 | tpr=0.9638 | fpr=0.0960 | 9053.2 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.15780 | acc=0.9041 | tpr=0.9683 | fpr=0.0971 | 8542.6 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.15801 | acc=0.9044 | tpr=0.9705 | fpr=0.0968 | 8699.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.15730 | acc=0.9041 | tpr=0.9703 | fpr=0.0971 | 8954.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.15798 | acc=0.9035 | tpr=0.9702 | fpr=0.0977 | 8709.7 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.15810 | acc=0.9036 | tpr=0.9662 | fpr=0.0975 | 8590.3 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.15877 | acc=0.9029 | tpr=0.9666 | fpr=0.0982 | 8692.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.16023 | acc=0.9026 | tpr=0.9630 | fpr=0.0985 | 8676.9 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.16004 | acc=0.9028 | tpr=0.9639 | fpr=0.0983 | 8735.1 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.15907 | acc=0.9035 | tpr=0.9642 | fpr=0.0976 | 15693.9 samples/s | 61.3 steps/s
Avg test loss: 0.15900, Avg test acc: 0.90344, Avg tpr: 0.96434, Avg fpr: 0.09767, total FA: 13561

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.19578 | Reg=0.00254 | L2-Norm=15.941 | L2-Norm(final)=2.188 | acc=0.7656 | 3735.2 samples/s | 58.4 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.08783 | Reg=0.00258 | L2-Norm=16.071 | L2-Norm(final)=2.190 | acc=0.9219 | 5044.0 samples/s | 78.8 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.07554 | Reg=0.00261 | L2-Norm=16.142 | L2-Norm(final)=2.194 | acc=0.9375 | 4997.3 samples/s | 78.1 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07057 | Reg=0.00262 | L2-Norm=16.181 | L2-Norm(final)=2.196 | acc=0.9375 | 4943.5 samples/s | 77.2 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.06713 | Reg=0.00263 | L2-Norm=16.210 | L2-Norm(final)=2.196 | acc=0.9688 | 4994.8 samples/s | 78.0 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06533 | Reg=0.00264 | L2-Norm=16.234 | L2-Norm(final)=2.197 | acc=0.9531 | 4903.4 samples/s | 76.6 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06264 | Reg=0.00264 | L2-Norm=16.256 | L2-Norm(final)=2.199 | acc=0.9844 | 4949.1 samples/s | 77.3 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06235 | Reg=0.00265 | L2-Norm=16.278 | L2-Norm(final)=2.199 | acc=0.9062 | 4992.7 samples/s | 78.0 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06160 | Reg=0.00266 | L2-Norm=16.300 | L2-Norm(final)=2.199 | acc=0.9219 | 5091.7 samples/s | 79.6 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.05996 | Reg=0.00266 | L2-Norm=16.322 | L2-Norm(final)=2.200 | acc=0.9531 | 4905.2 samples/s | 76.6 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05881 | Reg=0.00267 | L2-Norm=16.343 | L2-Norm(final)=2.201 | acc=0.9844 | 4970.0 samples/s | 77.7 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05850 | Reg=0.00268 | L2-Norm=16.362 | L2-Norm(final)=2.201 | acc=0.9219 | 4988.3 samples/s | 77.9 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05820 | Reg=0.00268 | L2-Norm=16.381 | L2-Norm(final)=2.199 | acc=1.0000 | 4922.5 samples/s | 76.9 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05774 | Reg=0.00269 | L2-Norm=16.400 | L2-Norm(final)=2.197 | acc=0.9531 | 5003.4 samples/s | 78.2 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05755 | Reg=0.00270 | L2-Norm=16.418 | L2-Norm(final)=2.196 | acc=1.0000 | 5001.0 samples/s | 78.1 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05736 | Reg=0.00270 | L2-Norm=16.437 | L2-Norm(final)=2.195 | acc=0.9531 | 4958.3 samples/s | 77.5 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05709 | Reg=0.00271 | L2-Norm=16.458 | L2-Norm(final)=2.195 | acc=0.9688 | 4974.6 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.04822 | Reg=0.00254 | L2-Norm=15.941 | L2-Norm(final)=2.189 | acc=0.9531 | 3745.8 samples/s | 58.5 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00716 | Reg=0.00258 | L2-Norm=16.060 | L2-Norm(final)=2.203 | acc=1.0000 | 4723.4 samples/s | 73.8 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.01177 | Reg=0.00260 | L2-Norm=16.113 | L2-Norm(final)=2.193 | acc=1.0000 | 4670.0 samples/s | 73.0 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.01070 | Reg=0.00261 | L2-Norm=16.154 | L2-Norm(final)=2.185 | acc=1.0000 | 4714.0 samples/s | 73.7 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00861 | Reg=0.00262 | L2-Norm=16.173 | L2-Norm(final)=2.183 | acc=1.0000 | 4662.3 samples/s | 72.8 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00711 | Reg=0.00262 | L2-Norm=16.174 | L2-Norm(final)=2.184 | acc=0.9844 | 4701.6 samples/s | 73.5 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00660 | Reg=0.00261 | L2-Norm=16.166 | L2-Norm(final)=2.185 | acc=1.0000 | 4814.6 samples/s | 75.2 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00578 | Reg=0.00261 | L2-Norm=16.152 | L2-Norm(final)=2.185 | acc=1.0000 | 4692.8 samples/s | 73.3 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00518 | Reg=0.00260 | L2-Norm=16.133 | L2-Norm(final)=2.188 | acc=1.0000 | 4743.7 samples/s | 74.1 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00471 | Reg=0.00260 | L2-Norm=16.111 | L2-Norm(final)=2.190 | acc=1.0000 | 4628.4 samples/s | 72.3 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00427 | Reg=0.00259 | L2-Norm=16.088 | L2-Norm(final)=2.193 | acc=1.0000 | 4787.5 samples/s | 74.8 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00390 | Reg=0.00258 | L2-Norm=16.063 | L2-Norm(final)=2.196 | acc=1.0000 | 2109.1 samples/s | 33.0 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00370 | Reg=0.00257 | L2-Norm=16.036 | L2-Norm(final)=2.199 | acc=1.0000 | 4720.2 samples/s | 73.8 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00352 | Reg=0.00256 | L2-Norm=16.010 | L2-Norm(final)=2.201 | acc=1.0000 | 4683.1 samples/s | 73.2 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00383 | Reg=0.00256 | L2-Norm=15.986 | L2-Norm(final)=2.202 | acc=1.0000 | 4733.2 samples/s | 74.0 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00374 | Reg=0.00255 | L2-Norm=15.965 | L2-Norm(final)=2.200 | acc=1.0000 | 4678.3 samples/s | 73.1 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00356 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.199 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43085 | acc=0.6492 | tpr=0.4993 | fpr=0.0253 | 4654.1 samples/s | 18.2 steps/s
Avg test loss: 0.43525, Avg test acc: 0.64532, Avg tpr: 0.49560, Avg fpr: 0.02538, total FA: 198

Testing server on iccad2012
[Step=  50] | Loss=0.13807 | acc=0.9162 | tpr=0.9513 | fpr=0.0845 | 4668.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.14068 | acc=0.9154 | tpr=0.9531 | fpr=0.0854 | 8437.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.14263 | acc=0.9145 | tpr=0.9625 | fpr=0.0864 | 8627.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.14327 | acc=0.9149 | tpr=0.9705 | fpr=0.0861 | 9027.8 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.14255 | acc=0.9148 | tpr=0.9703 | fpr=0.0862 | 8574.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14347 | acc=0.9145 | tpr=0.9709 | fpr=0.0865 | 9042.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.14357 | acc=0.9143 | tpr=0.9643 | fpr=0.0866 | 8479.5 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.14404 | acc=0.9140 | tpr=0.9661 | fpr=0.0869 | 8910.0 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.14539 | acc=0.9135 | tpr=0.9625 | fpr=0.0874 | 8871.2 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.14563 | acc=0.9132 | tpr=0.9630 | fpr=0.0877 | 8236.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.14490 | acc=0.9137 | tpr=0.9642 | fpr=0.0872 | 14165.0 samples/s | 55.3 steps/s
Avg test loss: 0.14491, Avg test acc: 0.91371, Avg tpr: 0.96315, Avg fpr: 0.08719, total FA: 12106

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.25441 | Reg=0.00248 | L2-Norm=15.745 | L2-Norm(final)=2.179 | acc=0.7500 | 4322.2 samples/s | 67.5 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.08833 | Reg=0.00254 | L2-Norm=15.939 | L2-Norm(final)=2.190 | acc=0.9531 | 4684.5 samples/s | 73.2 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07389 | Reg=0.00257 | L2-Norm=16.025 | L2-Norm(final)=2.204 | acc=0.9844 | 4891.6 samples/s | 76.4 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.06824 | Reg=0.00258 | L2-Norm=16.066 | L2-Norm(final)=2.205 | acc=0.9531 | 4959.9 samples/s | 77.5 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06418 | Reg=0.00259 | L2-Norm=16.093 | L2-Norm(final)=2.203 | acc=0.9688 | 4914.3 samples/s | 76.8 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06240 | Reg=0.00260 | L2-Norm=16.119 | L2-Norm(final)=2.203 | acc=0.9844 | 4985.9 samples/s | 77.9 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06189 | Reg=0.00261 | L2-Norm=16.146 | L2-Norm(final)=2.201 | acc=0.9688 | 4974.1 samples/s | 77.7 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06007 | Reg=0.00262 | L2-Norm=16.176 | L2-Norm(final)=2.201 | acc=0.9219 | 5024.5 samples/s | 78.5 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05883 | Reg=0.00263 | L2-Norm=16.204 | L2-Norm(final)=2.202 | acc=0.9688 | 4982.0 samples/s | 77.8 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05801 | Reg=0.00264 | L2-Norm=16.233 | L2-Norm(final)=2.203 | acc=0.9844 | 4978.0 samples/s | 77.8 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05738 | Reg=0.00264 | L2-Norm=16.257 | L2-Norm(final)=2.202 | acc=0.9375 | 4985.9 samples/s | 77.9 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05586 | Reg=0.00265 | L2-Norm=16.279 | L2-Norm(final)=2.202 | acc=0.9531 | 4999.1 samples/s | 78.1 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05504 | Reg=0.00266 | L2-Norm=16.299 | L2-Norm(final)=2.202 | acc=0.9844 | 4958.7 samples/s | 77.5 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05405 | Reg=0.00266 | L2-Norm=16.319 | L2-Norm(final)=2.201 | acc=0.9844 | 4896.0 samples/s | 76.5 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05335 | Reg=0.00267 | L2-Norm=16.340 | L2-Norm(final)=2.201 | acc=0.9844 | 4992.3 samples/s | 78.0 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05294 | Reg=0.00268 | L2-Norm=16.361 | L2-Norm(final)=2.202 | acc=0.9688 | 4962.4 samples/s | 77.5 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05235 | Reg=0.00268 | L2-Norm=16.383 | L2-Norm(final)=2.202 | acc=0.9844 | 4993.0 samples/s | 78.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.04363 | Reg=0.00248 | L2-Norm=15.745 | L2-Norm(final)=2.181 | acc=0.9688 | 4234.6 samples/s | 66.2 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00884 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.210 | acc=1.0000 | 4497.6 samples/s | 70.3 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00643 | Reg=0.00253 | L2-Norm=15.893 | L2-Norm(final)=2.212 | acc=1.0000 | 4776.2 samples/s | 74.6 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00477 | Reg=0.00253 | L2-Norm=15.893 | L2-Norm(final)=2.214 | acc=1.0000 | 4707.4 samples/s | 73.6 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00512 | Reg=0.00252 | L2-Norm=15.877 | L2-Norm(final)=2.215 | acc=1.0000 | 4744.2 samples/s | 74.1 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00509 | Reg=0.00252 | L2-Norm=15.861 | L2-Norm(final)=2.210 | acc=0.9844 | 4809.1 samples/s | 75.1 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00498 | Reg=0.00251 | L2-Norm=15.850 | L2-Norm(final)=2.207 | acc=1.0000 | 4627.7 samples/s | 72.3 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00456 | Reg=0.00251 | L2-Norm=15.838 | L2-Norm(final)=2.203 | acc=1.0000 | 4797.5 samples/s | 75.0 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00420 | Reg=0.00250 | L2-Norm=15.824 | L2-Norm(final)=2.201 | acc=1.0000 | 4621.7 samples/s | 72.2 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00379 | Reg=0.00250 | L2-Norm=15.807 | L2-Norm(final)=2.201 | acc=1.0000 | 4792.6 samples/s | 74.9 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00349 | Reg=0.00249 | L2-Norm=15.788 | L2-Norm(final)=2.202 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00354 | Reg=0.00249 | L2-Norm=15.768 | L2-Norm(final)=2.202 | acc=1.0000 | 2110.0 samples/s | 33.0 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00332 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.201 | acc=1.0000 | 4797.8 samples/s | 75.0 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00307 | Reg=0.00247 | L2-Norm=15.725 | L2-Norm(final)=2.201 | acc=1.0000 | 4833.4 samples/s | 75.5 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00286 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.201 | acc=1.0000 | 4616.1 samples/s | 72.1 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00267 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.201 | acc=1.0000 | 4703.1 samples/s | 73.5 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00251 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.201 | acc=1.0000 | 4714.5 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39744 | acc=0.7199 | tpr=0.6068 | fpr=0.0344 | 4590.1 samples/s | 17.9 steps/s
Avg test loss: 0.40252, Avg test acc: 0.71817, Avg tpr: 0.60570, Avg fpr: 0.03448, total FA: 269

Testing server on iccad2012
[Step=  50] | Loss=0.19096 | acc=0.8886 | tpr=0.9646 | fpr=0.1128 | 4607.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.19484 | acc=0.8877 | tpr=0.9701 | fpr=0.1138 | 8608.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.19680 | acc=0.8877 | tpr=0.9741 | fpr=0.1139 | 8436.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.19790 | acc=0.8884 | tpr=0.9770 | fpr=0.1132 | 9352.5 samples/s | 36.5 steps/s
[Step= 250] | Loss=0.19704 | acc=0.8883 | tpr=0.9747 | fpr=0.1132 | 8221.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.19815 | acc=0.8885 | tpr=0.9767 | fpr=0.1131 | 8766.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.19814 | acc=0.8889 | tpr=0.9731 | fpr=0.1126 | 8963.1 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.19886 | acc=0.8885 | tpr=0.9737 | fpr=0.1130 | 8610.1 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.20039 | acc=0.8882 | tpr=0.9722 | fpr=0.1133 | 8959.7 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.20039 | acc=0.8879 | tpr=0.9727 | fpr=0.1136 | 8783.3 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.19955 | acc=0.8884 | tpr=0.9713 | fpr=0.1131 | 15164.9 samples/s | 59.2 steps/s
Avg test loss: 0.19966, Avg test acc: 0.88838, Avg tpr: 0.97147, Avg fpr: 0.11313, total FA: 15708

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.23414 | Reg=0.00242 | L2-Norm=15.551 | L2-Norm(final)=2.197 | acc=0.8125 | 3982.8 samples/s | 62.2 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.09297 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.180 | acc=0.9688 | 4701.3 samples/s | 73.5 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.07707 | Reg=0.00250 | L2-Norm=15.813 | L2-Norm(final)=2.189 | acc=0.9844 | 4964.0 samples/s | 77.6 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06784 | Reg=0.00252 | L2-Norm=15.872 | L2-Norm(final)=2.195 | acc=0.9531 | 4959.8 samples/s | 77.5 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.06495 | Reg=0.00253 | L2-Norm=15.916 | L2-Norm(final)=2.199 | acc=0.9688 | 5009.0 samples/s | 78.3 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.06043 | Reg=0.00255 | L2-Norm=15.953 | L2-Norm(final)=2.200 | acc=0.9531 | 4896.0 samples/s | 76.5 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05836 | Reg=0.00256 | L2-Norm=15.984 | L2-Norm(final)=2.202 | acc=0.9375 | 4988.1 samples/s | 77.9 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05558 | Reg=0.00256 | L2-Norm=16.013 | L2-Norm(final)=2.204 | acc=0.9844 | 4975.4 samples/s | 77.7 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05500 | Reg=0.00257 | L2-Norm=16.039 | L2-Norm(final)=2.204 | acc=0.9375 | 5022.1 samples/s | 78.5 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05400 | Reg=0.00258 | L2-Norm=16.063 | L2-Norm(final)=2.203 | acc=0.9844 | 4876.9 samples/s | 76.2 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05279 | Reg=0.00259 | L2-Norm=16.087 | L2-Norm(final)=2.204 | acc=0.9688 | 4990.0 samples/s | 78.0 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05272 | Reg=0.00260 | L2-Norm=16.110 | L2-Norm(final)=2.203 | acc=0.9688 | 4932.2 samples/s | 77.1 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05238 | Reg=0.00260 | L2-Norm=16.135 | L2-Norm(final)=2.202 | acc=0.9688 | 4989.0 samples/s | 78.0 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.05199 | Reg=0.00261 | L2-Norm=16.158 | L2-Norm(final)=2.202 | acc=0.9062 | 4988.9 samples/s | 78.0 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.05088 | Reg=0.00262 | L2-Norm=16.181 | L2-Norm(final)=2.202 | acc=0.9531 | 4875.6 samples/s | 76.2 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.05039 | Reg=0.00263 | L2-Norm=16.203 | L2-Norm(final)=2.202 | acc=0.9844 | 5023.5 samples/s | 78.5 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04985 | Reg=0.00263 | L2-Norm=16.227 | L2-Norm(final)=2.202 | acc=0.9688 | 4929.6 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.03669 | Reg=0.00242 | L2-Norm=15.551 | L2-Norm(final)=2.198 | acc=0.9844 | 3952.6 samples/s | 61.8 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00499 | Reg=0.00247 | L2-Norm=15.720 | L2-Norm(final)=2.222 | acc=1.0000 | 4364.9 samples/s | 68.2 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00451 | Reg=0.00248 | L2-Norm=15.763 | L2-Norm(final)=2.225 | acc=1.0000 | 4783.0 samples/s | 74.7 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00642 | Reg=0.00249 | L2-Norm=15.790 | L2-Norm(final)=2.221 | acc=1.0000 | 4681.4 samples/s | 73.1 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00547 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.212 | acc=1.0000 | 4657.6 samples/s | 72.8 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00536 | Reg=0.00250 | L2-Norm=15.818 | L2-Norm(final)=2.205 | acc=1.0000 | 4685.2 samples/s | 73.2 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00462 | Reg=0.00250 | L2-Norm=15.818 | L2-Norm(final)=2.201 | acc=1.0000 | 4710.4 samples/s | 73.6 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00425 | Reg=0.00250 | L2-Norm=15.808 | L2-Norm(final)=2.198 | acc=1.0000 | 4703.4 samples/s | 73.5 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00404 | Reg=0.00249 | L2-Norm=15.794 | L2-Norm(final)=2.196 | acc=1.0000 | 4726.9 samples/s | 73.9 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00378 | Reg=0.00249 | L2-Norm=15.778 | L2-Norm(final)=2.195 | acc=0.9844 | 4686.9 samples/s | 73.2 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00360 | Reg=0.00248 | L2-Norm=15.760 | L2-Norm(final)=2.193 | acc=1.0000 | 4718.6 samples/s | 73.7 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00331 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.192 | acc=1.0000 | 2072.5 samples/s | 32.4 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00312 | Reg=0.00247 | L2-Norm=15.718 | L2-Norm(final)=2.192 | acc=1.0000 | 4795.1 samples/s | 74.9 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00294 | Reg=0.00246 | L2-Norm=15.695 | L2-Norm(final)=2.191 | acc=1.0000 | 4781.4 samples/s | 74.7 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00278 | Reg=0.00246 | L2-Norm=15.672 | L2-Norm(final)=2.191 | acc=1.0000 | 4653.9 samples/s | 72.7 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00260 | Reg=0.00245 | L2-Norm=15.648 | L2-Norm(final)=2.192 | acc=1.0000 | 4674.0 samples/s | 73.0 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00244 | Reg=0.00244 | L2-Norm=15.623 | L2-Norm(final)=2.192 | acc=1.0000 | 4728.8 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43154 | acc=0.6976 | tpr=0.5679 | fpr=0.0208 | 4474.2 samples/s | 17.5 steps/s
Avg test loss: 0.43644, Avg test acc: 0.69353, Avg tpr: 0.56403, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.16989 | acc=0.9166 | tpr=0.9646 | fpr=0.0843 | 4537.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.17335 | acc=0.9123 | tpr=0.9765 | fpr=0.0889 | 8694.0 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.17643 | acc=0.9112 | tpr=0.9755 | fpr=0.0900 | 9413.1 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.17833 | acc=0.9107 | tpr=0.9792 | fpr=0.0905 | 8226.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.17760 | acc=0.9104 | tpr=0.9764 | fpr=0.0908 | 8675.4 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.17888 | acc=0.9101 | tpr=0.9775 | fpr=0.0911 | 8906.3 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.17870 | acc=0.9102 | tpr=0.9737 | fpr=0.0910 | 8578.5 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.17954 | acc=0.9099 | tpr=0.9743 | fpr=0.0913 | 8745.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.18116 | acc=0.9096 | tpr=0.9732 | fpr=0.0915 | 8728.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.18120 | acc=0.9094 | tpr=0.9740 | fpr=0.0918 | 9317.5 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.18026 | acc=0.9096 | tpr=0.9737 | fpr=0.0915 | 14275.4 samples/s | 55.8 steps/s
Avg test loss: 0.18025, Avg test acc: 0.90964, Avg tpr: 0.97385, Avg fpr: 0.09153, total FA: 12709

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.27624 | Reg=0.00239 | L2-Norm=15.471 | L2-Norm(final)=2.191 | acc=0.7812 | 4008.0 samples/s | 62.6 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.08212 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.175 | acc=0.9219 | 4797.3 samples/s | 75.0 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.06172 | Reg=0.00247 | L2-Norm=15.715 | L2-Norm(final)=2.190 | acc=0.9844 | 4924.0 samples/s | 76.9 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05498 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.197 | acc=1.0000 | 4922.6 samples/s | 76.9 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.05266 | Reg=0.00249 | L2-Norm=15.790 | L2-Norm(final)=2.202 | acc=1.0000 | 4929.0 samples/s | 77.0 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05212 | Reg=0.00251 | L2-Norm=15.827 | L2-Norm(final)=2.203 | acc=0.9219 | 4918.6 samples/s | 76.9 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05044 | Reg=0.00252 | L2-Norm=15.860 | L2-Norm(final)=2.203 | acc=0.9375 | 5023.4 samples/s | 78.5 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04955 | Reg=0.00252 | L2-Norm=15.888 | L2-Norm(final)=2.203 | acc=0.9219 | 4883.7 samples/s | 76.3 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04860 | Reg=0.00253 | L2-Norm=15.915 | L2-Norm(final)=2.203 | acc=0.9531 | 4876.1 samples/s | 76.2 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04871 | Reg=0.00254 | L2-Norm=15.942 | L2-Norm(final)=2.201 | acc=0.9844 | 4942.1 samples/s | 77.2 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04820 | Reg=0.00255 | L2-Norm=15.965 | L2-Norm(final)=2.199 | acc=0.9219 | 4947.7 samples/s | 77.3 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04699 | Reg=0.00256 | L2-Norm=15.989 | L2-Norm(final)=2.199 | acc=0.9844 | 5052.8 samples/s | 79.0 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04675 | Reg=0.00256 | L2-Norm=16.013 | L2-Norm(final)=2.199 | acc=1.0000 | 4974.7 samples/s | 77.7 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04624 | Reg=0.00257 | L2-Norm=16.039 | L2-Norm(final)=2.199 | acc=0.9688 | 4979.9 samples/s | 77.8 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04571 | Reg=0.00258 | L2-Norm=16.066 | L2-Norm(final)=2.200 | acc=0.9688 | 4963.2 samples/s | 77.6 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04568 | Reg=0.00259 | L2-Norm=16.092 | L2-Norm(final)=2.200 | acc=0.9531 | 5012.5 samples/s | 78.3 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04538 | Reg=0.00260 | L2-Norm=16.117 | L2-Norm(final)=2.199 | acc=0.9688 | 4946.3 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.05444 | Reg=0.00239 | L2-Norm=15.471 | L2-Norm(final)=2.191 | acc=0.9844 | 4085.9 samples/s | 63.8 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00546 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.207 | acc=1.0000 | 4418.8 samples/s | 69.0 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00321 | Reg=0.00243 | L2-Norm=15.582 | L2-Norm(final)=2.216 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00230 | Reg=0.00242 | L2-Norm=15.565 | L2-Norm(final)=2.224 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00236 | Reg=0.00242 | L2-Norm=15.542 | L2-Norm(final)=2.230 | acc=0.9688 | 4653.4 samples/s | 72.7 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00370 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.228 | acc=0.9844 | 4767.0 samples/s | 74.5 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00461 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.212 | acc=1.0000 | 4777.2 samples/s | 74.6 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00412 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.200 | acc=1.0000 | 4738.9 samples/s | 74.0 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00391 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.193 | acc=1.0000 | 4653.3 samples/s | 72.7 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00349 | Reg=0.00243 | L2-Norm=15.603 | L2-Norm(final)=2.188 | acc=1.0000 | 4662.3 samples/s | 72.8 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00316 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.186 | acc=1.0000 | 4768.4 samples/s | 74.5 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00292 | Reg=0.00243 | L2-Norm=15.590 | L2-Norm(final)=2.184 | acc=0.9844 | 2106.3 samples/s | 32.9 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00268 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.184 | acc=1.0000 | 4758.1 samples/s | 74.3 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00252 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.184 | acc=1.0000 | 4645.6 samples/s | 72.6 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00234 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.185 | acc=1.0000 | 4636.4 samples/s | 72.4 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00219 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.186 | acc=1.0000 | 4801.0 samples/s | 75.0 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00208 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.187 | acc=1.0000 | 4672.4 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33444 | acc=0.7486 | tpr=0.6565 | fpr=0.0515 | 4580.8 samples/s | 17.9 steps/s
Avg test loss: 0.33739, Avg test acc: 0.75022, Avg tpr: 0.65979, Avg fpr: 0.05089, total FA: 397

Testing server on iccad2012
[Step=  50] | Loss=0.30315 | acc=0.8355 | tpr=0.9823 | fpr=0.1671 | 4571.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.30863 | acc=0.8355 | tpr=0.9851 | fpr=0.1673 | 8746.8 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.31025 | acc=0.8355 | tpr=0.9870 | fpr=0.1672 | 8688.1 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.31151 | acc=0.8361 | tpr=0.9880 | fpr=0.1667 | 8667.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.31055 | acc=0.8357 | tpr=0.9869 | fpr=0.1671 | 8826.7 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.31199 | acc=0.8350 | tpr=0.9869 | fpr=0.1678 | 8601.6 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.31169 | acc=0.8352 | tpr=0.9850 | fpr=0.1675 | 8783.3 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.31216 | acc=0.8353 | tpr=0.9847 | fpr=0.1674 | 8674.9 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.31437 | acc=0.8349 | tpr=0.9844 | fpr=0.1678 | 9529.0 samples/s | 37.2 steps/s
[Step= 500] | Loss=0.31374 | acc=0.8349 | tpr=0.9850 | fpr=0.1678 | 8110.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.31248 | acc=0.8358 | tpr=0.9853 | fpr=0.1669 | 16375.1 samples/s | 64.0 steps/s
Avg test loss: 0.31256, Avg test acc: 0.83575, Avg tpr: 0.98534, Avg fpr: 0.16697, total FA: 23183

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.26360 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.187 | acc=0.7812 | 3901.7 samples/s | 61.0 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.06720 | Reg=0.00242 | L2-Norm=15.557 | L2-Norm(final)=2.180 | acc=0.9688 | 4710.1 samples/s | 73.6 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.05789 | Reg=0.00245 | L2-Norm=15.643 | L2-Norm(final)=2.195 | acc=0.9844 | 4954.1 samples/s | 77.4 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05174 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.199 | acc=0.9844 | 4987.3 samples/s | 77.9 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05059 | Reg=0.00247 | L2-Norm=15.729 | L2-Norm(final)=2.200 | acc=0.9375 | 4986.9 samples/s | 77.9 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.04784 | Reg=0.00248 | L2-Norm=15.761 | L2-Norm(final)=2.201 | acc=0.9844 | 5027.8 samples/s | 78.6 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04513 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.205 | acc=0.9844 | 4917.3 samples/s | 76.8 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04464 | Reg=0.00250 | L2-Norm=15.819 | L2-Norm(final)=2.206 | acc=0.9531 | 4971.8 samples/s | 77.7 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04463 | Reg=0.00251 | L2-Norm=15.847 | L2-Norm(final)=2.206 | acc=0.9219 | 5073.1 samples/s | 79.3 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04432 | Reg=0.00252 | L2-Norm=15.875 | L2-Norm(final)=2.206 | acc=0.9688 | 4899.7 samples/s | 76.6 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04361 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.206 | acc=0.9844 | 4940.3 samples/s | 77.2 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04362 | Reg=0.00254 | L2-Norm=15.927 | L2-Norm(final)=2.206 | acc=0.9375 | 4884.6 samples/s | 76.3 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04283 | Reg=0.00255 | L2-Norm=15.952 | L2-Norm(final)=2.207 | acc=0.9844 | 4947.7 samples/s | 77.3 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04277 | Reg=0.00255 | L2-Norm=15.978 | L2-Norm(final)=2.208 | acc=0.9688 | 4931.9 samples/s | 77.1 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04240 | Reg=0.00256 | L2-Norm=16.004 | L2-Norm(final)=2.208 | acc=0.9219 | 4949.4 samples/s | 77.3 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04235 | Reg=0.00257 | L2-Norm=16.028 | L2-Norm(final)=2.208 | acc=0.9688 | 4987.8 samples/s | 77.9 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04214 | Reg=0.00258 | L2-Norm=16.052 | L2-Norm(final)=2.208 | acc=0.9688 | 4963.6 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.13622 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.185 | acc=0.9219 | 3996.5 samples/s | 62.4 steps/s
[Step=6450 Epoch=12.2] | Loss=0.01315 | Reg=0.00246 | L2-Norm=15.694 | L2-Norm(final)=2.170 | acc=0.9844 | 4314.4 samples/s | 67.4 steps/s
[Step=6500 Epoch=12.3] | Loss=0.01023 | Reg=0.00249 | L2-Norm=15.783 | L2-Norm(final)=2.162 | acc=0.9688 | 4689.2 samples/s | 73.3 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00762 | Reg=0.00250 | L2-Norm=15.814 | L2-Norm(final)=2.159 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00610 | Reg=0.00250 | L2-Norm=15.821 | L2-Norm(final)=2.161 | acc=1.0000 | 4717.5 samples/s | 73.7 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00572 | Reg=0.00250 | L2-Norm=15.817 | L2-Norm(final)=2.166 | acc=1.0000 | 4680.8 samples/s | 73.1 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00577 | Reg=0.00250 | L2-Norm=15.817 | L2-Norm(final)=2.164 | acc=1.0000 | 4627.3 samples/s | 72.3 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00511 | Reg=0.00250 | L2-Norm=15.820 | L2-Norm(final)=2.163 | acc=1.0000 | 4711.0 samples/s | 73.6 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00452 | Reg=0.00250 | L2-Norm=15.817 | L2-Norm(final)=2.165 | acc=1.0000 | 4728.8 samples/s | 73.9 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00407 | Reg=0.00250 | L2-Norm=15.807 | L2-Norm(final)=2.167 | acc=1.0000 | 4669.8 samples/s | 73.0 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00376 | Reg=0.00249 | L2-Norm=15.795 | L2-Norm(final)=2.170 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00359 | Reg=0.00249 | L2-Norm=15.784 | L2-Norm(final)=2.171 | acc=1.0000 | 2095.5 samples/s | 32.7 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00341 | Reg=0.00249 | L2-Norm=15.772 | L2-Norm(final)=2.172 | acc=1.0000 | 4762.2 samples/s | 74.4 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00331 | Reg=0.00248 | L2-Norm=15.759 | L2-Norm(final)=2.172 | acc=1.0000 | 4681.5 samples/s | 73.1 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00309 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.173 | acc=1.0000 | 4736.5 samples/s | 74.0 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00291 | Reg=0.00248 | L2-Norm=15.733 | L2-Norm(final)=2.174 | acc=1.0000 | 4739.7 samples/s | 74.1 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00280 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.176 | acc=1.0000 | 4756.7 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.71532 | acc=0.5784 | tpr=0.3921 | fpr=0.0171 | 4563.8 samples/s | 17.8 steps/s
Avg test loss: 0.71999, Avg test acc: 0.57308, Avg tpr: 0.38696, Avg fpr: 0.01756, total FA: 137

Testing server on iccad2012
[Step=  50] | Loss=0.13844 | acc=0.9389 | tpr=0.9735 | fpr=0.0617 | 4568.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.14059 | acc=0.9377 | tpr=0.9765 | fpr=0.0630 | 8699.0 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.14316 | acc=0.9373 | tpr=0.9813 | fpr=0.0635 | 8637.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.14593 | acc=0.9373 | tpr=0.9825 | fpr=0.0635 | 9371.9 samples/s | 36.6 steps/s
[Step= 250] | Loss=0.14460 | acc=0.9375 | tpr=0.9773 | fpr=0.0632 | 8540.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.14598 | acc=0.9370 | tpr=0.9767 | fpr=0.0638 | 8589.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.14568 | acc=0.9372 | tpr=0.9750 | fpr=0.0635 | 8626.1 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.14661 | acc=0.9368 | tpr=0.9726 | fpr=0.0638 | 9004.8 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.14830 | acc=0.9364 | tpr=0.9727 | fpr=0.0643 | 8454.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14788 | acc=0.9364 | tpr=0.9731 | fpr=0.0642 | 8838.8 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.14681 | acc=0.9367 | tpr=0.9721 | fpr=0.0639 | 16469.2 samples/s | 64.3 steps/s
Avg test loss: 0.14670, Avg test acc: 0.93676, Avg tpr: 0.97227, Avg fpr: 0.06389, total FA: 8871

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.81060 | Reg=0.00240 | L2-Norm=15.500 | L2-Norm(final)=2.184 | acc=0.5312 | 4622.3 samples/s | 72.2 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.10846 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.143 | acc=0.9844 | 4351.4 samples/s | 68.0 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.07838 | Reg=0.00252 | L2-Norm=15.859 | L2-Norm(final)=2.159 | acc=0.9688 | 4928.1 samples/s | 77.0 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.06659 | Reg=0.00254 | L2-Norm=15.927 | L2-Norm(final)=2.168 | acc=1.0000 | 4938.7 samples/s | 77.2 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.06090 | Reg=0.00255 | L2-Norm=15.979 | L2-Norm(final)=2.178 | acc=0.9844 | 4943.0 samples/s | 77.2 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.05700 | Reg=0.00257 | L2-Norm=16.020 | L2-Norm(final)=2.182 | acc=0.9531 | 4919.9 samples/s | 76.9 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.05407 | Reg=0.00258 | L2-Norm=16.053 | L2-Norm(final)=2.185 | acc=1.0000 | 5011.7 samples/s | 78.3 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.05172 | Reg=0.00259 | L2-Norm=16.081 | L2-Norm(final)=2.188 | acc=1.0000 | 4995.4 samples/s | 78.1 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.05018 | Reg=0.00259 | L2-Norm=16.107 | L2-Norm(final)=2.189 | acc=1.0000 | 4942.3 samples/s | 77.2 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04876 | Reg=0.00260 | L2-Norm=16.131 | L2-Norm(final)=2.191 | acc=1.0000 | 5015.7 samples/s | 78.4 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04797 | Reg=0.00261 | L2-Norm=16.155 | L2-Norm(final)=2.192 | acc=1.0000 | 4933.7 samples/s | 77.1 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04694 | Reg=0.00262 | L2-Norm=16.177 | L2-Norm(final)=2.192 | acc=0.9531 | 5034.5 samples/s | 78.7 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04591 | Reg=0.00262 | L2-Norm=16.199 | L2-Norm(final)=2.193 | acc=0.9531 | 4894.1 samples/s | 76.5 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04533 | Reg=0.00263 | L2-Norm=16.220 | L2-Norm(final)=2.193 | acc=0.9219 | 4956.5 samples/s | 77.4 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04453 | Reg=0.00264 | L2-Norm=16.242 | L2-Norm(final)=2.193 | acc=1.0000 | 4869.2 samples/s | 76.1 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04416 | Reg=0.00265 | L2-Norm=16.264 | L2-Norm(final)=2.193 | acc=0.9844 | 5010.3 samples/s | 78.3 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04369 | Reg=0.00265 | L2-Norm=16.286 | L2-Norm(final)=2.193 | acc=0.9531 | 5001.1 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.00374 | Reg=0.00240 | L2-Norm=15.500 | L2-Norm(final)=2.191 | acc=1.0000 | 4361.1 samples/s | 68.1 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00454 | Reg=0.00242 | L2-Norm=15.556 | L2-Norm(final)=2.212 | acc=0.9688 | 4246.7 samples/s | 66.4 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00446 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.209 | acc=1.0000 | 4673.9 samples/s | 73.0 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00410 | Reg=0.00245 | L2-Norm=15.646 | L2-Norm(final)=2.202 | acc=1.0000 | 4746.5 samples/s | 74.2 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00370 | Reg=0.00245 | L2-Norm=15.663 | L2-Norm(final)=2.199 | acc=1.0000 | 4683.6 samples/s | 73.2 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00339 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.196 | acc=1.0000 | 4780.5 samples/s | 74.7 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00306 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.196 | acc=0.9844 | 4790.2 samples/s | 74.8 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00319 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.197 | acc=1.0000 | 4688.7 samples/s | 73.3 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00330 | Reg=0.00246 | L2-Norm=15.679 | L2-Norm(final)=2.191 | acc=1.0000 | 4667.5 samples/s | 72.9 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00308 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.186 | acc=1.0000 | 4815.9 samples/s | 75.2 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00281 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.183 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00256 | Reg=0.00246 | L2-Norm=15.678 | L2-Norm(final)=2.182 | acc=1.0000 | 2114.2 samples/s | 33.0 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00240 | Reg=0.00246 | L2-Norm=15.670 | L2-Norm(final)=2.181 | acc=1.0000 | 4917.6 samples/s | 76.8 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00225 | Reg=0.00245 | L2-Norm=15.662 | L2-Norm(final)=2.181 | acc=1.0000 | 4615.2 samples/s | 72.1 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00212 | Reg=0.00245 | L2-Norm=15.652 | L2-Norm(final)=2.182 | acc=1.0000 | 4779.5 samples/s | 74.7 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00216 | Reg=0.00245 | L2-Norm=15.642 | L2-Norm(final)=2.182 | acc=1.0000 | 4622.8 samples/s | 72.2 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00223 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.180 | acc=1.0000 | 4767.5 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40545 | acc=0.6984 | tpr=0.5723 | fpr=0.0278 | 4598.6 samples/s | 18.0 steps/s
Avg test loss: 0.40892, Avg test acc: 0.69276, Avg tpr: 0.56647, Avg fpr: 0.02948, total FA: 230

Testing server on iccad2012
[Step=  50] | Loss=0.19254 | acc=0.8991 | tpr=0.9779 | fpr=0.1023 | 4658.9 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.19460 | acc=0.8976 | tpr=0.9829 | fpr=0.1040 | 8907.2 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.19659 | acc=0.8982 | tpr=0.9870 | fpr=0.1034 | 8295.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.19765 | acc=0.8989 | tpr=0.9880 | fpr=0.1027 | 8820.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.19649 | acc=0.8992 | tpr=0.9869 | fpr=0.1024 | 8729.4 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.19764 | acc=0.8990 | tpr=0.9862 | fpr=0.1026 | 8708.7 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.19729 | acc=0.8993 | tpr=0.9850 | fpr=0.1022 | 8714.0 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.19773 | acc=0.8991 | tpr=0.9858 | fpr=0.1025 | 8881.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.19972 | acc=0.8986 | tpr=0.9854 | fpr=0.1030 | 8645.7 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.19946 | acc=0.8986 | tpr=0.9855 | fpr=0.1030 | 9142.7 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.19861 | acc=0.8987 | tpr=0.9849 | fpr=0.1028 | 14259.4 samples/s | 55.7 steps/s
Avg test loss: 0.19869, Avg test acc: 0.89875, Avg tpr: 0.98494, Avg fpr: 0.10282, total FA: 14276

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.24441 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.145 | acc=0.7812 | 4176.4 samples/s | 65.3 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.07172 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.154 | acc=1.0000 | 4594.4 samples/s | 71.8 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.05686 | Reg=0.00247 | L2-Norm=15.701 | L2-Norm(final)=2.168 | acc=0.9844 | 4976.7 samples/s | 77.8 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.04883 | Reg=0.00247 | L2-Norm=15.723 | L2-Norm(final)=2.178 | acc=0.9375 | 4973.1 samples/s | 77.7 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04448 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.187 | acc=0.9688 | 4918.4 samples/s | 76.9 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04109 | Reg=0.00248 | L2-Norm=15.756 | L2-Norm(final)=2.193 | acc=0.9844 | 4963.8 samples/s | 77.6 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03901 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.198 | acc=0.9375 | 4916.1 samples/s | 76.8 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03797 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.202 | acc=0.9844 | 4939.5 samples/s | 77.2 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03653 | Reg=0.00249 | L2-Norm=15.789 | L2-Norm(final)=2.206 | acc=0.9844 | 5023.4 samples/s | 78.5 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03623 | Reg=0.00250 | L2-Norm=15.797 | L2-Norm(final)=2.209 | acc=1.0000 | 4898.2 samples/s | 76.5 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03566 | Reg=0.00250 | L2-Norm=15.804 | L2-Norm(final)=2.211 | acc=0.9688 | 4983.3 samples/s | 77.9 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03474 | Reg=0.00250 | L2-Norm=15.811 | L2-Norm(final)=2.213 | acc=0.9844 | 5036.5 samples/s | 78.7 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03401 | Reg=0.00250 | L2-Norm=15.819 | L2-Norm(final)=2.216 | acc=0.9688 | 4988.3 samples/s | 77.9 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03320 | Reg=0.00250 | L2-Norm=15.826 | L2-Norm(final)=2.219 | acc=0.9688 | 4997.8 samples/s | 78.1 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03280 | Reg=0.00251 | L2-Norm=15.833 | L2-Norm(final)=2.221 | acc=0.9844 | 5040.1 samples/s | 78.8 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03227 | Reg=0.00251 | L2-Norm=15.840 | L2-Norm(final)=2.224 | acc=1.0000 | 4965.3 samples/s | 77.6 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03190 | Reg=0.00251 | L2-Norm=15.847 | L2-Norm(final)=2.227 | acc=0.9688 | 4992.3 samples/s | 78.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.03499 | Reg=0.00244 | L2-Norm=15.609 | L2-Norm(final)=2.144 | acc=0.9531 | 4686.8 samples/s | 73.2 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00588 | Reg=0.00246 | L2-Norm=15.670 | L2-Norm(final)=2.153 | acc=1.0000 | 4038.4 samples/s | 63.1 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00320 | Reg=0.00246 | L2-Norm=15.673 | L2-Norm(final)=2.162 | acc=1.0000 | 4679.2 samples/s | 73.1 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00226 | Reg=0.00245 | L2-Norm=15.665 | L2-Norm(final)=2.168 | acc=1.0000 | 4734.1 samples/s | 74.0 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00178 | Reg=0.00245 | L2-Norm=15.653 | L2-Norm(final)=2.172 | acc=1.0000 | 4738.5 samples/s | 74.0 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00144 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.176 | acc=1.0000 | 4778.5 samples/s | 74.7 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00121 | Reg=0.00244 | L2-Norm=15.624 | L2-Norm(final)=2.179 | acc=1.0000 | 4758.8 samples/s | 74.4 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00105 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.181 | acc=1.0000 | 4722.5 samples/s | 73.8 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00092 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.184 | acc=1.0000 | 4726.0 samples/s | 73.8 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00082 | Reg=0.00243 | L2-Norm=15.575 | L2-Norm(final)=2.186 | acc=1.0000 | 4714.5 samples/s | 73.7 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00074 | Reg=0.00242 | L2-Norm=15.558 | L2-Norm(final)=2.187 | acc=1.0000 | 4717.9 samples/s | 73.7 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00068 | Reg=0.00242 | L2-Norm=15.541 | L2-Norm(final)=2.189 | acc=1.0000 | 2071.7 samples/s | 32.4 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00062 | Reg=0.00241 | L2-Norm=15.524 | L2-Norm(final)=2.191 | acc=1.0000 | 4791.9 samples/s | 74.9 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00057 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.192 | acc=1.0000 | 4691.9 samples/s | 73.3 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00053 | Reg=0.00240 | L2-Norm=15.489 | L2-Norm(final)=2.193 | acc=1.0000 | 4721.5 samples/s | 73.8 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00050 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.195 | acc=1.0000 | 4597.4 samples/s | 71.8 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00047 | Reg=0.00239 | L2-Norm=15.454 | L2-Norm(final)=2.196 | acc=1.0000 | 4770.4 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32520 | acc=0.7941 | tpr=0.7033 | fpr=0.0087 | 4645.3 samples/s | 18.1 steps/s
Avg test loss: 0.32943, Avg test acc: 0.79101, Avg tpr: 0.70082, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.29537 | acc=0.8724 | tpr=0.9779 | fpr=0.1295 | 4544.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.29981 | acc=0.8711 | tpr=0.9829 | fpr=0.1310 | 8994.2 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.30247 | acc=0.8717 | tpr=0.9870 | fpr=0.1304 | 8627.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.30412 | acc=0.8723 | tpr=0.9880 | fpr=0.1298 | 8817.0 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.30369 | acc=0.8722 | tpr=0.9825 | fpr=0.1298 | 8726.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.30543 | acc=0.8717 | tpr=0.9818 | fpr=0.1304 | 8595.7 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.30505 | acc=0.8720 | tpr=0.9793 | fpr=0.1299 | 9111.0 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.30551 | acc=0.8717 | tpr=0.9798 | fpr=0.1303 | 8460.1 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.30816 | acc=0.8712 | tpr=0.9781 | fpr=0.1307 | 8805.1 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.30752 | acc=0.8711 | tpr=0.9789 | fpr=0.1308 | 8723.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.30607 | acc=0.8716 | tpr=0.9781 | fpr=0.1303 | 15640.8 samples/s | 61.1 steps/s
Avg test loss: 0.30626, Avg test acc: 0.87163, Avg tpr: 0.97781, Avg fpr: 0.13030, total FA: 18092

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.23449 | Reg=0.00238 | L2-Norm=15.432 | L2-Norm(final)=2.238 | acc=0.8438 | 4062.3 samples/s | 63.5 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04557 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.234 | acc=0.9844 | 4508.3 samples/s | 70.4 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03731 | Reg=0.00241 | L2-Norm=15.512 | L2-Norm(final)=2.242 | acc=0.9531 | 4869.1 samples/s | 76.1 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03444 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.248 | acc=1.0000 | 4997.0 samples/s | 78.1 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03121 | Reg=0.00242 | L2-Norm=15.541 | L2-Norm(final)=2.254 | acc=0.9844 | 4952.9 samples/s | 77.4 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03032 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.259 | acc=0.9844 | 4966.3 samples/s | 77.6 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02926 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.264 | acc=0.9844 | 5016.9 samples/s | 78.4 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02939 | Reg=0.00243 | L2-Norm=15.573 | L2-Norm(final)=2.267 | acc=0.9688 | 4960.6 samples/s | 77.5 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02884 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.269 | acc=0.9531 | 5045.5 samples/s | 78.8 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02805 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.273 | acc=0.9844 | 4939.5 samples/s | 77.2 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02743 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.276 | acc=0.9688 | 4948.4 samples/s | 77.3 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02725 | Reg=0.00243 | L2-Norm=15.604 | L2-Norm(final)=2.279 | acc=1.0000 | 5002.4 samples/s | 78.2 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02712 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.282 | acc=0.9688 | 5021.8 samples/s | 78.5 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02653 | Reg=0.00244 | L2-Norm=15.620 | L2-Norm(final)=2.284 | acc=1.0000 | 4969.2 samples/s | 77.6 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02639 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.287 | acc=0.9844 | 4911.7 samples/s | 76.7 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02640 | Reg=0.00244 | L2-Norm=15.633 | L2-Norm(final)=2.288 | acc=0.9844 | 5023.2 samples/s | 78.5 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02632 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.289 | acc=0.9844 | 4955.9 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.01108 | Reg=0.00238 | L2-Norm=15.432 | L2-Norm(final)=2.239 | acc=0.9844 | 4364.3 samples/s | 68.2 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00530 | Reg=0.00241 | L2-Norm=15.512 | L2-Norm(final)=2.235 | acc=1.0000 | 4220.3 samples/s | 65.9 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00287 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.239 | acc=1.0000 | 4751.8 samples/s | 74.2 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00198 | Reg=0.00241 | L2-Norm=15.518 | L2-Norm(final)=2.243 | acc=1.0000 | 4577.5 samples/s | 71.5 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00150 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.247 | acc=1.0000 | 4713.3 samples/s | 73.6 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00136 | Reg=0.00240 | L2-Norm=15.493 | L2-Norm(final)=2.249 | acc=1.0000 | 4693.3 samples/s | 73.3 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00131 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.251 | acc=1.0000 | 4670.5 samples/s | 73.0 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00118 | Reg=0.00239 | L2-Norm=15.475 | L2-Norm(final)=2.253 | acc=1.0000 | 4742.8 samples/s | 74.1 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00105 | Reg=0.00239 | L2-Norm=15.465 | L2-Norm(final)=2.254 | acc=1.0000 | 4735.4 samples/s | 74.0 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00130 | Reg=0.00239 | L2-Norm=15.455 | L2-Norm(final)=2.255 | acc=1.0000 | 4744.9 samples/s | 74.1 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00149 | Reg=0.00239 | L2-Norm=15.449 | L2-Norm(final)=2.255 | acc=1.0000 | 4784.7 samples/s | 74.8 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00138 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.254 | acc=1.0000 | 2062.4 samples/s | 32.2 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00127 | Reg=0.00238 | L2-Norm=15.434 | L2-Norm(final)=2.254 | acc=1.0000 | 4735.7 samples/s | 74.0 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00118 | Reg=0.00238 | L2-Norm=15.425 | L2-Norm(final)=2.254 | acc=1.0000 | 4769.2 samples/s | 74.5 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00110 | Reg=0.00238 | L2-Norm=15.415 | L2-Norm(final)=2.254 | acc=1.0000 | 4634.3 samples/s | 72.4 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00103 | Reg=0.00237 | L2-Norm=15.405 | L2-Norm(final)=2.254 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00097 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.255 | acc=1.0000 | 4683.1 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45317 | acc=0.7330 | tpr=0.6152 | fpr=0.0111 | 4541.6 samples/s | 17.7 steps/s
Avg test loss: 0.45636, Avg test acc: 0.73199, Avg tpr: 0.61596, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.23124 | acc=0.9088 | tpr=0.9867 | fpr=0.0926 | 4554.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.23684 | acc=0.9076 | tpr=0.9872 | fpr=0.0939 | 8811.4 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.24111 | acc=0.9080 | tpr=0.9885 | fpr=0.0935 | 8557.4 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.24321 | acc=0.9094 | tpr=0.9902 | fpr=0.0921 | 8931.4 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.24153 | acc=0.9096 | tpr=0.9869 | fpr=0.0918 | 8761.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.24369 | acc=0.9090 | tpr=0.9869 | fpr=0.0924 | 9211.1 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.24364 | acc=0.9091 | tpr=0.9843 | fpr=0.0922 | 8320.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.24457 | acc=0.9085 | tpr=0.9847 | fpr=0.0928 | 9209.8 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.24730 | acc=0.9079 | tpr=0.9820 | fpr=0.0935 | 8188.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.24693 | acc=0.9079 | tpr=0.9824 | fpr=0.0934 | 9142.0 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.24573 | acc=0.9081 | tpr=0.9821 | fpr=0.0932 | 14998.3 samples/s | 58.6 steps/s
Avg test loss: 0.24587, Avg test acc: 0.90811, Avg tpr: 0.98098, Avg fpr: 0.09322, total FA: 12943

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.36452 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.280 | acc=0.8281 | 3816.5 samples/s | 59.6 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.05745 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.266 | acc=0.9531 | 4773.1 samples/s | 74.6 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.04100 | Reg=0.00237 | L2-Norm=15.407 | L2-Norm(final)=2.280 | acc=0.9844 | 5005.1 samples/s | 78.2 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03551 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.290 | acc=0.9688 | 4905.8 samples/s | 76.7 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03197 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.295 | acc=0.9531 | 4967.5 samples/s | 77.6 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.03125 | Reg=0.00239 | L2-Norm=15.455 | L2-Norm(final)=2.299 | acc=0.9688 | 4987.3 samples/s | 77.9 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02915 | Reg=0.00239 | L2-Norm=15.466 | L2-Norm(final)=2.303 | acc=1.0000 | 5006.4 samples/s | 78.2 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02861 | Reg=0.00240 | L2-Norm=15.476 | L2-Norm(final)=2.307 | acc=0.9531 | 5027.6 samples/s | 78.6 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02816 | Reg=0.00240 | L2-Norm=15.486 | L2-Norm(final)=2.310 | acc=0.9844 | 5039.4 samples/s | 78.7 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02799 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.313 | acc=1.0000 | 4965.9 samples/s | 77.6 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02705 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.316 | acc=0.9844 | 4997.4 samples/s | 78.1 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02687 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.319 | acc=0.9688 | 4815.8 samples/s | 75.2 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02643 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.322 | acc=0.9688 | 4892.2 samples/s | 76.4 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02585 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.325 | acc=0.9688 | 4954.1 samples/s | 77.4 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02568 | Reg=0.00242 | L2-Norm=15.543 | L2-Norm(final)=2.328 | acc=0.9844 | 4934.9 samples/s | 77.1 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02529 | Reg=0.00242 | L2-Norm=15.551 | L2-Norm(final)=2.330 | acc=1.0000 | 5031.9 samples/s | 78.6 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02531 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.333 | acc=0.9844 | 5049.2 samples/s | 78.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.04810 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.281 | acc=0.9531 | 4501.8 samples/s | 70.3 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00446 | Reg=0.00237 | L2-Norm=15.384 | L2-Norm(final)=2.285 | acc=1.0000 | 4012.0 samples/s | 62.7 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00250 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.288 | acc=1.0000 | 4710.7 samples/s | 73.6 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00177 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.292 | acc=1.0000 | 4757.4 samples/s | 74.3 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00138 | Reg=0.00237 | L2-Norm=15.385 | L2-Norm(final)=2.295 | acc=1.0000 | 4762.4 samples/s | 74.4 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00113 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.298 | acc=1.0000 | 4642.3 samples/s | 72.5 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00105 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.300 | acc=1.0000 | 4711.0 samples/s | 73.6 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00094 | Reg=0.00236 | L2-Norm=15.349 | L2-Norm(final)=2.303 | acc=1.0000 | 4782.2 samples/s | 74.7 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00083 | Reg=0.00235 | L2-Norm=15.338 | L2-Norm(final)=2.306 | acc=1.0000 | 4655.0 samples/s | 72.7 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00074 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.308 | acc=1.0000 | 4715.0 samples/s | 73.7 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00067 | Reg=0.00234 | L2-Norm=15.311 | L2-Norm(final)=2.310 | acc=1.0000 | 4772.4 samples/s | 74.6 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00061 | Reg=0.00234 | L2-Norm=15.297 | L2-Norm(final)=2.312 | acc=1.0000 | 2085.2 samples/s | 32.6 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00056 | Reg=0.00234 | L2-Norm=15.282 | L2-Norm(final)=2.314 | acc=1.0000 | 4751.2 samples/s | 74.2 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00052 | Reg=0.00233 | L2-Norm=15.267 | L2-Norm(final)=2.316 | acc=1.0000 | 4690.3 samples/s | 73.3 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00048 | Reg=0.00233 | L2-Norm=15.251 | L2-Norm(final)=2.317 | acc=1.0000 | 4610.5 samples/s | 72.0 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00045 | Reg=0.00232 | L2-Norm=15.235 | L2-Norm(final)=2.319 | acc=1.0000 | 4815.3 samples/s | 75.2 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00042 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.320 | acc=1.0000 | 4598.0 samples/s | 71.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36766 | acc=0.7706 | tpr=0.6699 | fpr=0.0107 | 4573.7 samples/s | 17.9 steps/s
Avg test loss: 0.36988, Avg test acc: 0.77090, Avg tpr: 0.67238, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.28565 | acc=0.8927 | tpr=0.9823 | fpr=0.1090 | 4631.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.28995 | acc=0.8933 | tpr=0.9851 | fpr=0.1084 | 8784.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.29498 | acc=0.8929 | tpr=0.9885 | fpr=0.1088 | 8622.4 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.29857 | acc=0.8929 | tpr=0.9891 | fpr=0.1089 | 8583.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.29682 | acc=0.8933 | tpr=0.9834 | fpr=0.1084 | 9097.2 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.29929 | acc=0.8927 | tpr=0.9855 | fpr=0.1090 | 8593.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.29948 | acc=0.8928 | tpr=0.9831 | fpr=0.1089 | 8829.6 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.30052 | acc=0.8926 | tpr=0.9814 | fpr=0.1091 | 8651.8 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.30380 | acc=0.8920 | tpr=0.9791 | fpr=0.1096 | 8668.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.30322 | acc=0.8919 | tpr=0.9797 | fpr=0.1097 | 9066.7 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.30175 | acc=0.8923 | tpr=0.9789 | fpr=0.1092 | 15275.1 samples/s | 59.7 steps/s
Avg test loss: 0.30179, Avg test acc: 0.89237, Avg tpr: 0.97900, Avg fpr: 0.10921, total FA: 15163

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.22793 | Reg=0.00230 | L2-Norm=15.180 | L2-Norm(final)=2.345 | acc=0.8125 | 3818.3 samples/s | 59.7 steps/s
[Step=10450 Epoch=10.2] | Loss=0.04238 | Reg=0.00233 | L2-Norm=15.251 | L2-Norm(final)=2.340 | acc=1.0000 | 4908.0 samples/s | 76.7 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03472 | Reg=0.00234 | L2-Norm=15.282 | L2-Norm(final)=2.347 | acc=0.9688 | 4991.3 samples/s | 78.0 steps/s
[Step=10550 Epoch=10.3] | Loss=0.02948 | Reg=0.00234 | L2-Norm=15.301 | L2-Norm(final)=2.355 | acc=1.0000 | 4878.1 samples/s | 76.2 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02702 | Reg=0.00235 | L2-Norm=15.316 | L2-Norm(final)=2.364 | acc=0.9688 | 4876.0 samples/s | 76.2 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02615 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.368 | acc=1.0000 | 5007.0 samples/s | 78.2 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02624 | Reg=0.00235 | L2-Norm=15.338 | L2-Norm(final)=2.371 | acc=0.9688 | 5070.6 samples/s | 79.2 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02553 | Reg=0.00236 | L2-Norm=15.347 | L2-Norm(final)=2.374 | acc=0.9844 | 4890.8 samples/s | 76.4 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02485 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.378 | acc=0.9688 | 5027.8 samples/s | 78.6 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02466 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.380 | acc=0.9844 | 4944.0 samples/s | 77.2 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02440 | Reg=0.00236 | L2-Norm=15.374 | L2-Norm(final)=2.383 | acc=0.9844 | 4911.6 samples/s | 76.7 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02384 | Reg=0.00237 | L2-Norm=15.382 | L2-Norm(final)=2.385 | acc=1.0000 | 5001.7 samples/s | 78.2 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02372 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.388 | acc=0.9844 | 4998.4 samples/s | 78.1 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02386 | Reg=0.00237 | L2-Norm=15.399 | L2-Norm(final)=2.389 | acc=0.9844 | 4970.4 samples/s | 77.7 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02383 | Reg=0.00237 | L2-Norm=15.407 | L2-Norm(final)=2.391 | acc=1.0000 | 4991.7 samples/s | 78.0 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02381 | Reg=0.00238 | L2-Norm=15.416 | L2-Norm(final)=2.393 | acc=0.9844 | 4808.3 samples/s | 75.1 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02380 | Reg=0.00238 | L2-Norm=15.424 | L2-Norm(final)=2.395 | acc=1.0000 | 4919.0 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.01128 | Reg=0.00230 | L2-Norm=15.180 | L2-Norm(final)=2.345 | acc=1.0000 | 3953.8 samples/s | 61.8 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00398 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.345 | acc=1.0000 | 4623.6 samples/s | 72.2 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00424 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.340 | acc=1.0000 | 4578.0 samples/s | 71.5 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00337 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.332 | acc=1.0000 | 4639.7 samples/s | 72.5 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00284 | Reg=0.00235 | L2-Norm=15.322 | L2-Norm(final)=2.328 | acc=1.0000 | 4701.3 samples/s | 73.5 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00235 | Reg=0.00235 | L2-Norm=15.323 | L2-Norm(final)=2.328 | acc=1.0000 | 4671.1 samples/s | 73.0 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00209 | Reg=0.00235 | L2-Norm=15.319 | L2-Norm(final)=2.328 | acc=1.0000 | 4739.9 samples/s | 74.1 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00180 | Reg=0.00234 | L2-Norm=15.311 | L2-Norm(final)=2.328 | acc=1.0000 | 4689.0 samples/s | 73.3 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00158 | Reg=0.00234 | L2-Norm=15.302 | L2-Norm(final)=2.328 | acc=1.0000 | 4812.2 samples/s | 75.2 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00140 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.329 | acc=1.0000 | 4826.3 samples/s | 75.4 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00128 | Reg=0.00233 | L2-Norm=15.279 | L2-Norm(final)=2.330 | acc=1.0000 | 4700.0 samples/s | 73.4 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00116 | Reg=0.00233 | L2-Norm=15.266 | L2-Norm(final)=2.331 | acc=1.0000 | 2098.3 samples/s | 32.8 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00107 | Reg=0.00233 | L2-Norm=15.254 | L2-Norm(final)=2.332 | acc=1.0000 | 4796.3 samples/s | 74.9 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00099 | Reg=0.00232 | L2-Norm=15.241 | L2-Norm(final)=2.334 | acc=1.0000 | 4674.5 samples/s | 73.0 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00092 | Reg=0.00232 | L2-Norm=15.227 | L2-Norm(final)=2.335 | acc=1.0000 | 4699.8 samples/s | 73.4 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00086 | Reg=0.00231 | L2-Norm=15.213 | L2-Norm(final)=2.336 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00080 | Reg=0.00231 | L2-Norm=15.199 | L2-Norm(final)=2.338 | acc=1.0000 | 4707.2 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33167 | acc=0.7896 | tpr=0.6985 | fpr=0.0126 | 4581.9 samples/s | 17.9 steps/s
Avg test loss: 0.33275, Avg test acc: 0.79093, Avg tpr: 0.70181, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.33883 | acc=0.8755 | tpr=0.9646 | fpr=0.1261 | 4605.0 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.34340 | acc=0.8758 | tpr=0.9808 | fpr=0.1262 | 8721.7 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.34932 | acc=0.8757 | tpr=0.9856 | fpr=0.1264 | 8847.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.35218 | acc=0.8761 | tpr=0.9869 | fpr=0.1259 | 8689.5 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.35139 | acc=0.8766 | tpr=0.9852 | fpr=0.1254 | 8751.4 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.35366 | acc=0.8760 | tpr=0.9862 | fpr=0.1261 | 9003.4 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.35406 | acc=0.8756 | tpr=0.9837 | fpr=0.1264 | 8452.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.35501 | acc=0.8755 | tpr=0.9847 | fpr=0.1265 | 8563.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.35819 | acc=0.8755 | tpr=0.9825 | fpr=0.1265 | 8327.5 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.35817 | acc=0.8752 | tpr=0.9828 | fpr=0.1268 | 8747.8 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.35585 | acc=0.8758 | tpr=0.9829 | fpr=0.1262 | 15888.0 samples/s | 62.1 steps/s
Avg test loss: 0.35603, Avg test acc: 0.87575, Avg tpr: 0.98296, Avg fpr: 0.12620, total FA: 17523

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.14086 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.381 | acc=0.8906 | 4022.5 samples/s | 62.9 steps/s
[Step=11250 Epoch=11.0] | Loss=0.05180 | Reg=0.00231 | L2-Norm=15.187 | L2-Norm(final)=2.362 | acc=1.0000 | 4773.3 samples/s | 74.6 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03821 | Reg=0.00232 | L2-Norm=15.224 | L2-Norm(final)=2.369 | acc=0.9688 | 4950.7 samples/s | 77.4 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03246 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.377 | acc=0.9688 | 4930.1 samples/s | 77.0 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02943 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.383 | acc=0.9844 | 4974.1 samples/s | 77.7 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02753 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.389 | acc=0.9844 | 4909.9 samples/s | 76.7 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02632 | Reg=0.00234 | L2-Norm=15.281 | L2-Norm(final)=2.393 | acc=0.9844 | 4955.8 samples/s | 77.4 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02570 | Reg=0.00234 | L2-Norm=15.289 | L2-Norm(final)=2.396 | acc=1.0000 | 5024.3 samples/s | 78.5 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02496 | Reg=0.00234 | L2-Norm=15.297 | L2-Norm(final)=2.400 | acc=0.9844 | 5026.0 samples/s | 78.5 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02410 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.403 | acc=1.0000 | 4965.9 samples/s | 77.6 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02452 | Reg=0.00234 | L2-Norm=15.313 | L2-Norm(final)=2.406 | acc=0.9688 | 4860.6 samples/s | 75.9 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02429 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.408 | acc=0.9688 | 4905.0 samples/s | 76.6 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02410 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.410 | acc=1.0000 | 4956.7 samples/s | 77.4 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02384 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.412 | acc=0.9531 | 4994.2 samples/s | 78.0 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02367 | Reg=0.00235 | L2-Norm=15.341 | L2-Norm(final)=2.414 | acc=1.0000 | 4892.2 samples/s | 76.4 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02357 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.416 | acc=0.9844 | 5111.8 samples/s | 79.9 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02349 | Reg=0.00236 | L2-Norm=15.355 | L2-Norm(final)=2.418 | acc=0.9844 | 4932.5 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.06919 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.380 | acc=0.9531 | 4135.4 samples/s | 64.6 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00711 | Reg=0.00232 | L2-Norm=15.216 | L2-Norm(final)=2.360 | acc=1.0000 | 4637.2 samples/s | 72.5 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00378 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.363 | acc=1.0000 | 4667.1 samples/s | 72.9 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00260 | Reg=0.00232 | L2-Norm=15.244 | L2-Norm(final)=2.366 | acc=1.0000 | 4747.0 samples/s | 74.2 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00208 | Reg=0.00232 | L2-Norm=15.238 | L2-Norm(final)=2.369 | acc=1.0000 | 4597.3 samples/s | 71.8 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00175 | Reg=0.00232 | L2-Norm=15.230 | L2-Norm(final)=2.371 | acc=1.0000 | 4463.8 samples/s | 69.7 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00155 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.373 | acc=1.0000 | 4715.0 samples/s | 73.7 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00153 | Reg=0.00231 | L2-Norm=15.214 | L2-Norm(final)=2.374 | acc=1.0000 | 4707.5 samples/s | 73.6 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00141 | Reg=0.00231 | L2-Norm=15.210 | L2-Norm(final)=2.375 | acc=1.0000 | 4602.8 samples/s | 71.9 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00126 | Reg=0.00231 | L2-Norm=15.204 | L2-Norm(final)=2.377 | acc=1.0000 | 4742.3 samples/s | 74.1 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00123 | Reg=0.00231 | L2-Norm=15.198 | L2-Norm(final)=2.378 | acc=1.0000 | 4735.8 samples/s | 74.0 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00133 | Reg=0.00231 | L2-Norm=15.194 | L2-Norm(final)=2.378 | acc=1.0000 | 2049.9 samples/s | 32.0 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00123 | Reg=0.00231 | L2-Norm=15.189 | L2-Norm(final)=2.378 | acc=1.0000 | 4699.3 samples/s | 73.4 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00114 | Reg=0.00231 | L2-Norm=15.183 | L2-Norm(final)=2.377 | acc=1.0000 | 4611.2 samples/s | 72.1 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00106 | Reg=0.00230 | L2-Norm=15.176 | L2-Norm(final)=2.378 | acc=1.0000 | 4776.3 samples/s | 74.6 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00099 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.378 | acc=1.0000 | 4689.9 samples/s | 73.3 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00093 | Reg=0.00230 | L2-Norm=15.159 | L2-Norm(final)=2.378 | acc=1.0000 | 4738.6 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54179 | acc=0.6902 | tpr=0.5515 | fpr=0.0087 | 4576.8 samples/s | 17.9 steps/s
Avg test loss: 0.54680, Avg test acc: 0.68864, Avg tpr: 0.55085, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.23456 | acc=0.9166 | tpr=0.9690 | fpr=0.0843 | 4577.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.23699 | acc=0.9161 | tpr=0.9829 | fpr=0.0851 | 8776.8 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.24329 | acc=0.9148 | tpr=0.9841 | fpr=0.0865 | 8588.0 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.24640 | acc=0.9155 | tpr=0.9858 | fpr=0.0858 | 9018.1 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.24500 | acc=0.9159 | tpr=0.9817 | fpr=0.0853 | 8727.4 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.24766 | acc=0.9154 | tpr=0.9811 | fpr=0.0858 | 8853.5 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.24786 | acc=0.9155 | tpr=0.9800 | fpr=0.0857 | 8506.7 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.24852 | acc=0.9151 | tpr=0.9792 | fpr=0.0861 | 8824.2 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.25168 | acc=0.9147 | tpr=0.9776 | fpr=0.0864 | 9159.9 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.25144 | acc=0.9149 | tpr=0.9775 | fpr=0.0862 | 8393.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.24989 | acc=0.9151 | tpr=0.9765 | fpr=0.0860 | 15467.9 samples/s | 60.4 steps/s
Avg test loss: 0.24997, Avg test acc: 0.91513, Avg tpr: 0.97623, Avg fpr: 0.08598, total FA: 11938

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.59252 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.407 | acc=0.6875 | 4086.1 samples/s | 63.8 steps/s
[Step=12050 Epoch=11.8] | Loss=0.05538 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.396 | acc=1.0000 | 4825.8 samples/s | 75.4 steps/s
[Step=12100 Epoch=11.8] | Loss=0.04036 | Reg=0.00231 | L2-Norm=15.209 | L2-Norm(final)=2.409 | acc=1.0000 | 4846.2 samples/s | 75.7 steps/s
[Step=12150 Epoch=11.9] | Loss=0.03346 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.419 | acc=0.9844 | 4970.9 samples/s | 77.7 steps/s
[Step=12200 Epoch=11.9] | Loss=0.03000 | Reg=0.00232 | L2-Norm=15.246 | L2-Norm(final)=2.427 | acc=1.0000 | 4974.9 samples/s | 77.7 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02740 | Reg=0.00233 | L2-Norm=15.256 | L2-Norm(final)=2.431 | acc=0.9844 | 4976.1 samples/s | 77.8 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02629 | Reg=0.00233 | L2-Norm=15.265 | L2-Norm(final)=2.435 | acc=0.9688 | 4993.4 samples/s | 78.0 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02567 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.437 | acc=0.9688 | 4991.5 samples/s | 78.0 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02495 | Reg=0.00233 | L2-Norm=15.279 | L2-Norm(final)=2.439 | acc=0.9531 | 4933.0 samples/s | 77.1 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02479 | Reg=0.00234 | L2-Norm=15.285 | L2-Norm(final)=2.440 | acc=0.9844 | 4915.9 samples/s | 76.8 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02469 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.441 | acc=1.0000 | 4976.6 samples/s | 77.8 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02428 | Reg=0.00234 | L2-Norm=15.298 | L2-Norm(final)=2.443 | acc=0.9688 | 5023.9 samples/s | 78.5 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02436 | Reg=0.00234 | L2-Norm=15.304 | L2-Norm(final)=2.444 | acc=1.0000 | 4990.0 samples/s | 78.0 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02430 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.445 | acc=0.9844 | 4963.8 samples/s | 77.6 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02413 | Reg=0.00235 | L2-Norm=15.317 | L2-Norm(final)=2.447 | acc=1.0000 | 4993.4 samples/s | 78.0 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02368 | Reg=0.00235 | L2-Norm=15.323 | L2-Norm(final)=2.448 | acc=0.9844 | 4948.7 samples/s | 77.3 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02351 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.450 | acc=0.9844 | 4969.5 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.01428 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.411 | acc=0.9844 | 3775.8 samples/s | 59.0 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00182 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.425 | acc=1.0000 | 4620.3 samples/s | 72.2 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00098 | Reg=0.00229 | L2-Norm=15.118 | L2-Norm(final)=2.430 | acc=1.0000 | 4729.5 samples/s | 73.9 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00067 | Reg=0.00228 | L2-Norm=15.110 | L2-Norm(final)=2.434 | acc=1.0000 | 4705.0 samples/s | 73.5 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00052 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.436 | acc=1.0000 | 4689.8 samples/s | 73.3 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00043 | Reg=0.00228 | L2-Norm=15.086 | L2-Norm(final)=2.439 | acc=1.0000 | 4681.0 samples/s | 73.1 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00038 | Reg=0.00227 | L2-Norm=15.073 | L2-Norm(final)=2.441 | acc=1.0000 | 4728.2 samples/s | 73.9 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00033 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.443 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00030 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.445 | acc=1.0000 | 4753.7 samples/s | 74.3 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00027 | Reg=0.00226 | L2-Norm=15.038 | L2-Norm(final)=2.447 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00024 | Reg=0.00226 | L2-Norm=15.024 | L2-Norm(final)=2.449 | acc=1.0000 | 4735.1 samples/s | 74.0 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00022 | Reg=0.00225 | L2-Norm=15.011 | L2-Norm(final)=2.450 | acc=1.0000 | 2080.4 samples/s | 32.5 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00020 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.451 | acc=1.0000 | 4761.7 samples/s | 74.4 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00019 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.453 | acc=1.0000 | 4687.3 samples/s | 73.2 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00017 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.454 | acc=1.0000 | 4745.3 samples/s | 74.1 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00016 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.455 | acc=1.0000 | 4726.4 samples/s | 73.9 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00015 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.456 | acc=1.0000 | 4677.4 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29689 | acc=0.8234 | tpr=0.7462 | fpr=0.0089 | 4600.4 samples/s | 18.0 steps/s
Avg test loss: 0.30334, Avg test acc: 0.82306, Avg tpr: 0.74704, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.36631 | acc=0.8570 | tpr=0.9690 | fpr=0.1450 | 4605.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.37208 | acc=0.8560 | tpr=0.9787 | fpr=0.1463 | 8497.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.37690 | acc=0.8548 | tpr=0.9813 | fpr=0.1476 | 8776.2 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.38019 | acc=0.8551 | tpr=0.9847 | fpr=0.1473 | 8725.0 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.37848 | acc=0.8557 | tpr=0.9817 | fpr=0.1466 | 8520.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.38125 | acc=0.8551 | tpr=0.9818 | fpr=0.1473 | 8796.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.38172 | acc=0.8547 | tpr=0.9800 | fpr=0.1476 | 8840.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.38241 | acc=0.8544 | tpr=0.9787 | fpr=0.1479 | 8737.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.38585 | acc=0.8540 | tpr=0.9771 | fpr=0.1482 | 8863.4 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.38530 | acc=0.8540 | tpr=0.9767 | fpr=0.1482 | 8697.4 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.38341 | acc=0.8545 | tpr=0.9757 | fpr=0.1477 | 15079.7 samples/s | 58.9 steps/s
Avg test loss: 0.38366, Avg test acc: 0.85451, Avg tpr: 0.97544, Avg fpr: 0.14769, total FA: 20506

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.08926 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.470 | acc=0.9219 | 3871.4 samples/s | 60.5 steps/s
[Step=12850 Epoch=12.5] | Loss=0.02973 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.473 | acc=1.0000 | 4636.2 samples/s | 72.4 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02575 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.479 | acc=1.0000 | 4949.8 samples/s | 77.3 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02240 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.486 | acc=1.0000 | 4968.2 samples/s | 77.6 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02236 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.489 | acc=1.0000 | 4940.7 samples/s | 77.2 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02130 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.492 | acc=1.0000 | 4935.6 samples/s | 77.1 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02087 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.495 | acc=0.9688 | 4966.2 samples/s | 77.6 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02065 | Reg=0.00228 | L2-Norm=15.096 | L2-Norm(final)=2.497 | acc=0.9844 | 4952.3 samples/s | 77.4 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02058 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.499 | acc=0.9688 | 4921.2 samples/s | 76.9 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02095 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.500 | acc=1.0000 | 4950.0 samples/s | 77.3 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02058 | Reg=0.00228 | L2-Norm=15.115 | L2-Norm(final)=2.501 | acc=0.9688 | 4928.3 samples/s | 77.0 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02022 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.503 | acc=1.0000 | 4932.1 samples/s | 77.1 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02023 | Reg=0.00229 | L2-Norm=15.126 | L2-Norm(final)=2.504 | acc=0.9688 | 4978.1 samples/s | 77.8 steps/s
[Step=13450 Epoch=13.1] | Loss=0.01998 | Reg=0.00229 | L2-Norm=15.131 | L2-Norm(final)=2.505 | acc=0.9844 | 4968.9 samples/s | 77.6 steps/s
[Step=13500 Epoch=13.2] | Loss=0.01996 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.506 | acc=1.0000 | 5030.3 samples/s | 78.6 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02048 | Reg=0.00229 | L2-Norm=15.143 | L2-Norm(final)=2.506 | acc=1.0000 | 4977.5 samples/s | 77.8 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02044 | Reg=0.00229 | L2-Norm=15.148 | L2-Norm(final)=2.507 | acc=1.0000 | 4872.2 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.06624 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.468 | acc=0.9531 | 3927.3 samples/s | 61.4 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00546 | Reg=0.00228 | L2-Norm=15.096 | L2-Norm(final)=2.467 | acc=0.9531 | 4657.3 samples/s | 72.8 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00322 | Reg=0.00229 | L2-Norm=15.141 | L2-Norm(final)=2.468 | acc=1.0000 | 4651.7 samples/s | 72.7 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00232 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.470 | acc=1.0000 | 4681.6 samples/s | 73.1 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00223 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.471 | acc=1.0000 | 4675.3 samples/s | 73.1 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00250 | Reg=0.00230 | L2-Norm=15.177 | L2-Norm(final)=2.468 | acc=1.0000 | 4710.3 samples/s | 73.6 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00220 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.464 | acc=1.0000 | 4756.0 samples/s | 74.3 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00211 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.461 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00195 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.459 | acc=1.0000 | 4775.6 samples/s | 74.6 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00180 | Reg=0.00231 | L2-Norm=15.204 | L2-Norm(final)=2.458 | acc=1.0000 | 4738.1 samples/s | 74.0 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00169 | Reg=0.00231 | L2-Norm=15.205 | L2-Norm(final)=2.457 | acc=0.9844 | 4700.6 samples/s | 73.4 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00162 | Reg=0.00231 | L2-Norm=15.205 | L2-Norm(final)=2.457 | acc=1.0000 | 2078.0 samples/s | 32.5 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00148 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.457 | acc=1.0000 | 4783.6 samples/s | 74.7 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00140 | Reg=0.00231 | L2-Norm=15.204 | L2-Norm(final)=2.457 | acc=1.0000 | 4773.7 samples/s | 74.6 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00130 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.457 | acc=1.0000 | 4670.1 samples/s | 73.0 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00121 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.458 | acc=1.0000 | 4680.0 samples/s | 73.1 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00114 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.458 | acc=1.0000 | 4771.3 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57757 | acc=0.6871 | tpr=0.5479 | fpr=0.0107 | 4580.0 samples/s | 17.9 steps/s
Avg test loss: 0.57537, Avg test acc: 0.68723, Avg tpr: 0.55015, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.23827 | acc=0.9262 | tpr=0.9646 | fpr=0.0745 | 4538.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.24146 | acc=0.9267 | tpr=0.9787 | fpr=0.0743 | 9131.2 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.25035 | acc=0.9249 | tpr=0.9798 | fpr=0.0761 | 8886.8 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.25357 | acc=0.9254 | tpr=0.9825 | fpr=0.0756 | 8460.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.25145 | acc=0.9256 | tpr=0.9825 | fpr=0.0754 | 9361.6 samples/s | 36.6 steps/s
[Step= 300] | Loss=0.25432 | acc=0.9250 | tpr=0.9818 | fpr=0.0761 | 8264.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.25428 | acc=0.9250 | tpr=0.9793 | fpr=0.0760 | 9188.4 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.25535 | acc=0.9248 | tpr=0.9792 | fpr=0.0762 | 8597.3 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.25818 | acc=0.9244 | tpr=0.9776 | fpr=0.0766 | 8638.1 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.25772 | acc=0.9243 | tpr=0.9784 | fpr=0.0767 | 9121.1 samples/s | 35.6 steps/s
[Step= 550] | Loss=0.25570 | acc=0.9246 | tpr=0.9781 | fpr=0.0764 | 15246.8 samples/s | 59.6 steps/s
Avg test loss: 0.25561, Avg test acc: 0.92464, Avg tpr: 0.97781, Avg fpr: 0.07633, total FA: 10598

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.26143 | Reg=0.00225 | L2-Norm=15.004 | L2-Norm(final)=2.486 | acc=0.7656 | 3886.0 samples/s | 60.7 steps/s
[Step=13650 Epoch=13.3] | Loss=0.04988 | Reg=0.00228 | L2-Norm=15.110 | L2-Norm(final)=2.469 | acc=1.0000 | 4630.2 samples/s | 72.3 steps/s
[Step=13700 Epoch=13.4] | Loss=0.03619 | Reg=0.00230 | L2-Norm=15.154 | L2-Norm(final)=2.475 | acc=1.0000 | 5036.1 samples/s | 78.7 steps/s
[Step=13750 Epoch=13.4] | Loss=0.03124 | Reg=0.00230 | L2-Norm=15.177 | L2-Norm(final)=2.483 | acc=1.0000 | 4941.8 samples/s | 77.2 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02741 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.487 | acc=1.0000 | 4945.9 samples/s | 77.3 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02554 | Reg=0.00231 | L2-Norm=15.205 | L2-Norm(final)=2.493 | acc=1.0000 | 4946.4 samples/s | 77.3 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02499 | Reg=0.00231 | L2-Norm=15.214 | L2-Norm(final)=2.497 | acc=0.9531 | 4992.2 samples/s | 78.0 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02425 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.500 | acc=1.0000 | 4949.1 samples/s | 77.3 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02396 | Reg=0.00232 | L2-Norm=15.229 | L2-Norm(final)=2.502 | acc=0.9844 | 5013.9 samples/s | 78.3 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02324 | Reg=0.00232 | L2-Norm=15.234 | L2-Norm(final)=2.505 | acc=1.0000 | 4830.4 samples/s | 75.5 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02303 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.507 | acc=0.9844 | 4973.7 samples/s | 77.7 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02304 | Reg=0.00232 | L2-Norm=15.246 | L2-Norm(final)=2.510 | acc=0.9844 | 4971.2 samples/s | 77.7 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02282 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.512 | acc=0.9688 | 4941.9 samples/s | 77.2 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02282 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.514 | acc=0.9844 | 4962.7 samples/s | 77.5 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02292 | Reg=0.00233 | L2-Norm=15.265 | L2-Norm(final)=2.515 | acc=0.9688 | 5022.3 samples/s | 78.5 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02291 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.517 | acc=0.9844 | 5001.4 samples/s | 78.1 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02268 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.518 | acc=1.0000 | 4982.6 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.01353 | Reg=0.00225 | L2-Norm=15.004 | L2-Norm(final)=2.486 | acc=0.9844 | 3888.7 samples/s | 60.8 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00189 | Reg=0.00227 | L2-Norm=15.054 | L2-Norm(final)=2.496 | acc=1.0000 | 4509.1 samples/s | 70.5 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00103 | Reg=0.00227 | L2-Norm=15.057 | L2-Norm(final)=2.501 | acc=1.0000 | 4725.0 samples/s | 73.8 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00070 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.504 | acc=1.0000 | 4733.4 samples/s | 74.0 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00053 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.506 | acc=1.0000 | 4706.5 samples/s | 73.5 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00042 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.508 | acc=1.0000 | 4741.6 samples/s | 74.1 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00036 | Reg=0.00225 | L2-Norm=15.017 | L2-Norm(final)=2.510 | acc=1.0000 | 4751.0 samples/s | 74.2 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00031 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.511 | acc=1.0000 | 4714.1 samples/s | 73.7 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00028 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.513 | acc=1.0000 | 4692.3 samples/s | 73.3 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00025 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.515 | acc=1.0000 | 4682.5 samples/s | 73.2 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00023 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.517 | acc=1.0000 | 4718.1 samples/s | 73.7 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00021 | Reg=0.00224 | L2-Norm=14.958 | L2-Norm(final)=2.518 | acc=1.0000 | 2065.9 samples/s | 32.3 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00019 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.520 | acc=1.0000 | 4768.2 samples/s | 74.5 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00017 | Reg=0.00223 | L2-Norm=14.933 | L2-Norm(final)=2.521 | acc=1.0000 | 4701.8 samples/s | 73.5 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00016 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.523 | acc=1.0000 | 4653.1 samples/s | 72.7 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00015 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.525 | acc=1.0000 | 4693.7 samples/s | 73.3 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00014 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.526 | acc=1.0000 | 4676.0 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25922 | acc=0.8406 | tpr=0.7719 | fpr=0.0102 | 4564.5 samples/s | 17.8 steps/s
Avg test loss: 0.26371, Avg test acc: 0.83941, Avg tpr: 0.77164, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.37748 | acc=0.8570 | tpr=0.9690 | fpr=0.1451 | 4554.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.38481 | acc=0.8559 | tpr=0.9787 | fpr=0.1464 | 8978.1 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.39285 | acc=0.8553 | tpr=0.9798 | fpr=0.1470 | 8749.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.39651 | acc=0.8557 | tpr=0.9836 | fpr=0.1466 | 8856.0 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.39542 | acc=0.8558 | tpr=0.9808 | fpr=0.1465 | 8806.4 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.39757 | acc=0.8557 | tpr=0.9833 | fpr=0.1466 | 8663.6 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.39745 | acc=0.8557 | tpr=0.9812 | fpr=0.1466 | 8495.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.39789 | acc=0.8556 | tpr=0.9803 | fpr=0.1467 | 8889.8 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.40099 | acc=0.8551 | tpr=0.9791 | fpr=0.1471 | 8746.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.40087 | acc=0.8550 | tpr=0.9784 | fpr=0.1473 | 8630.0 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.39878 | acc=0.8554 | tpr=0.9773 | fpr=0.1468 | 16504.7 samples/s | 64.5 steps/s
Avg test loss: 0.39900, Avg test acc: 0.85541, Avg tpr: 0.97702, Avg fpr: 0.14680, total FA: 20383

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.15302 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.536 | acc=0.8438 | 4205.7 samples/s | 65.7 steps/s
[Step=14450 Epoch=14.1] | Loss=0.03490 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.532 | acc=0.9531 | 4602.3 samples/s | 71.9 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02656 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.536 | acc=1.0000 | 4846.4 samples/s | 75.7 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02210 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.543 | acc=1.0000 | 5010.8 samples/s | 78.3 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02148 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.547 | acc=1.0000 | 5034.3 samples/s | 78.7 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02072 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.552 | acc=1.0000 | 4864.1 samples/s | 76.0 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02059 | Reg=0.00227 | L2-Norm=15.076 | L2-Norm(final)=2.556 | acc=0.9844 | 4879.2 samples/s | 76.2 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02048 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.559 | acc=0.9844 | 4921.3 samples/s | 76.9 steps/s
[Step=14800 Epoch=14.4] | Loss=0.01976 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.563 | acc=0.9531 | 4945.2 samples/s | 77.3 steps/s
[Step=14850 Epoch=14.5] | Loss=0.01945 | Reg=0.00228 | L2-Norm=15.102 | L2-Norm(final)=2.566 | acc=1.0000 | 4990.3 samples/s | 78.0 steps/s
[Step=14900 Epoch=14.5] | Loss=0.01930 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.568 | acc=0.9375 | 4960.7 samples/s | 77.5 steps/s
[Step=14950 Epoch=14.6] | Loss=0.01968 | Reg=0.00229 | L2-Norm=15.116 | L2-Norm(final)=2.569 | acc=1.0000 | 5135.1 samples/s | 80.2 steps/s
[Step=15000 Epoch=14.6] | Loss=0.01977 | Reg=0.00229 | L2-Norm=15.123 | L2-Norm(final)=2.570 | acc=0.9844 | 4933.7 samples/s | 77.1 steps/s
[Step=15050 Epoch=14.7] | Loss=0.01962 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.572 | acc=0.9844 | 5043.9 samples/s | 78.8 steps/s
[Step=15100 Epoch=14.7] | Loss=0.01969 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.574 | acc=0.9531 | 4972.9 samples/s | 77.7 steps/s
[Step=15150 Epoch=14.8] | Loss=0.01966 | Reg=0.00229 | L2-Norm=15.144 | L2-Norm(final)=2.576 | acc=1.0000 | 5021.3 samples/s | 78.5 steps/s
[Step=15200 Epoch=14.8] | Loss=0.01985 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.577 | acc=0.9844 | 5004.3 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.05777 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.535 | acc=0.9688 | 3868.7 samples/s | 60.4 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00305 | Reg=0.00226 | L2-Norm=15.033 | L2-Norm(final)=2.543 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00192 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.547 | acc=1.0000 | 4768.4 samples/s | 74.5 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00147 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.548 | acc=1.0000 | 4721.0 samples/s | 73.8 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00122 | Reg=0.00227 | L2-Norm=15.052 | L2-Norm(final)=2.549 | acc=1.0000 | 4740.5 samples/s | 74.1 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00101 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.551 | acc=1.0000 | 4714.5 samples/s | 73.7 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00085 | Reg=0.00226 | L2-Norm=15.042 | L2-Norm(final)=2.554 | acc=1.0000 | 4853.6 samples/s | 75.8 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00075 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.556 | acc=1.0000 | 4582.6 samples/s | 71.6 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00066 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.559 | acc=1.0000 | 4669.0 samples/s | 73.0 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00059 | Reg=0.00225 | L2-Norm=15.014 | L2-Norm(final)=2.561 | acc=1.0000 | 4707.3 samples/s | 73.6 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00053 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.563 | acc=1.0000 | 4746.3 samples/s | 74.2 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00048 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.564 | acc=1.0000 | 2162.9 samples/s | 33.8 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00044 | Reg=0.00224 | L2-Norm=14.979 | L2-Norm(final)=2.565 | acc=1.0000 | 4720.4 samples/s | 73.8 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00041 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.567 | acc=1.0000 | 4791.1 samples/s | 74.9 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00038 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.568 | acc=1.0000 | 4709.1 samples/s | 73.6 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00035 | Reg=0.00223 | L2-Norm=14.940 | L2-Norm(final)=2.569 | acc=1.0000 | 4777.1 samples/s | 74.6 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00033 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.570 | acc=1.0000 | 4696.8 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41132 | acc=0.7884 | tpr=0.6942 | fpr=0.0069 | 4516.8 samples/s | 17.6 steps/s
Avg test loss: 0.41418, Avg test acc: 0.78800, Avg tpr: 0.69476, Avg fpr: 0.00692, total FA: 54

Testing server on iccad2012
[Step=  50] | Loss=0.28890 | acc=0.9121 | tpr=0.9646 | fpr=0.0888 | 4589.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.29047 | acc=0.9111 | tpr=0.9765 | fpr=0.0902 | 8816.2 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.29928 | acc=0.9102 | tpr=0.9784 | fpr=0.0910 | 8711.7 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.30453 | acc=0.9104 | tpr=0.9814 | fpr=0.0909 | 8924.9 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.30259 | acc=0.9101 | tpr=0.9782 | fpr=0.0912 | 8660.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.30548 | acc=0.9098 | tpr=0.9789 | fpr=0.0915 | 8776.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.30525 | acc=0.9098 | tpr=0.9768 | fpr=0.0914 | 8686.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.30565 | acc=0.9097 | tpr=0.9759 | fpr=0.0915 | 9120.9 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.30898 | acc=0.9092 | tpr=0.9747 | fpr=0.0920 | 8411.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.30852 | acc=0.9092 | tpr=0.9749 | fpr=0.0920 | 8666.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.30650 | acc=0.9096 | tpr=0.9741 | fpr=0.0915 | 16308.6 samples/s | 63.7 steps/s
Avg test loss: 0.30642, Avg test acc: 0.90964, Avg tpr: 0.97385, Avg fpr: 0.09153, total FA: 12709

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.17462 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.585 | acc=0.8594 | 4186.1 samples/s | 65.4 steps/s
[Step=15250 Epoch=14.9] | Loss=0.03837 | Reg=0.00224 | L2-Norm=14.959 | L2-Norm(final)=2.573 | acc=0.9688 | 4608.5 samples/s | 72.0 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02926 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.576 | acc=1.0000 | 4888.7 samples/s | 76.4 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02500 | Reg=0.00225 | L2-Norm=15.013 | L2-Norm(final)=2.581 | acc=0.9688 | 4997.1 samples/s | 78.1 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02228 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.587 | acc=1.0000 | 4906.3 samples/s | 76.7 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02105 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.592 | acc=0.9688 | 4988.2 samples/s | 77.9 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02034 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.597 | acc=0.9844 | 5065.2 samples/s | 79.1 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02045 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.600 | acc=0.9688 | 4916.8 samples/s | 76.8 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02031 | Reg=0.00227 | L2-Norm=15.058 | L2-Norm(final)=2.603 | acc=0.9844 | 4964.0 samples/s | 77.6 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02025 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.606 | acc=1.0000 | 4948.1 samples/s | 77.3 steps/s
[Step=15700 Epoch=15.3] | Loss=0.01995 | Reg=0.00227 | L2-Norm=15.072 | L2-Norm(final)=2.608 | acc=0.9844 | 4940.9 samples/s | 77.2 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02058 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.609 | acc=0.9844 | 4958.1 samples/s | 77.5 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02055 | Reg=0.00228 | L2-Norm=15.085 | L2-Norm(final)=2.610 | acc=1.0000 | 4986.7 samples/s | 77.9 steps/s
[Step=15850 Epoch=15.5] | Loss=0.01993 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.612 | acc=0.9688 | 5002.0 samples/s | 78.2 steps/s
[Step=15900 Epoch=15.5] | Loss=0.01998 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.614 | acc=1.0000 | 5013.5 samples/s | 78.3 steps/s
[Step=15950 Epoch=15.6] | Loss=0.01962 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.616 | acc=0.9844 | 5054.5 samples/s | 79.0 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01955 | Reg=0.00228 | L2-Norm=15.111 | L2-Norm(final)=2.618 | acc=1.0000 | 4981.5 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.02289 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.585 | acc=0.9844 | 4267.2 samples/s | 66.7 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00377 | Reg=0.00224 | L2-Norm=14.975 | L2-Norm(final)=2.578 | acc=1.0000 | 4364.2 samples/s | 68.2 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00431 | Reg=0.00226 | L2-Norm=15.021 | L2-Norm(final)=2.575 | acc=1.0000 | 4759.3 samples/s | 74.4 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00315 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.565 | acc=1.0000 | 4736.2 samples/s | 74.0 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00238 | Reg=0.00227 | L2-Norm=15.075 | L2-Norm(final)=2.564 | acc=1.0000 | 4662.4 samples/s | 72.8 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00207 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.564 | acc=0.9844 | 4759.0 samples/s | 74.4 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00245 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.564 | acc=0.9688 | 4634.3 samples/s | 72.4 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00250 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.558 | acc=1.0000 | 4716.0 samples/s | 73.7 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00224 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.554 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00201 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.551 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00182 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.550 | acc=1.0000 | 4805.7 samples/s | 75.1 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00166 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.549 | acc=1.0000 | 2102.9 samples/s | 32.9 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00152 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.549 | acc=1.0000 | 4774.9 samples/s | 74.6 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00140 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.548 | acc=1.0000 | 4729.8 samples/s | 73.9 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00130 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.548 | acc=1.0000 | 4653.1 samples/s | 72.7 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00122 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.549 | acc=1.0000 | 4672.3 samples/s | 73.0 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00114 | Reg=0.00228 | L2-Norm=15.097 | L2-Norm(final)=2.549 | acc=1.0000 | 4723.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50484 | acc=0.7230 | tpr=0.5985 | fpr=0.0067 | 4650.6 samples/s | 18.2 steps/s
Avg test loss: 0.51102, Avg test acc: 0.72021, Avg tpr: 0.59678, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.24419 | acc=0.9247 | tpr=0.9690 | fpr=0.0761 | 4581.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24684 | acc=0.9246 | tpr=0.9808 | fpr=0.0764 | 8896.9 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.25385 | acc=0.9233 | tpr=0.9827 | fpr=0.0778 | 8534.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.25780 | acc=0.9231 | tpr=0.9847 | fpr=0.0780 | 8583.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.25614 | acc=0.9233 | tpr=0.9843 | fpr=0.0778 | 8782.2 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.25899 | acc=0.9231 | tpr=0.9847 | fpr=0.0781 | 8753.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.25887 | acc=0.9234 | tpr=0.9818 | fpr=0.0777 | 8503.5 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.25970 | acc=0.9230 | tpr=0.9809 | fpr=0.0780 | 8703.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.26276 | acc=0.9227 | tpr=0.9791 | fpr=0.0784 | 8529.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.26222 | acc=0.9226 | tpr=0.9793 | fpr=0.0784 | 8670.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.26034 | acc=0.9230 | tpr=0.9777 | fpr=0.0780 | 16680.5 samples/s | 65.2 steps/s
Avg test loss: 0.26028, Avg test acc: 0.92301, Avg tpr: 0.97742, Avg fpr: 0.07798, total FA: 10827

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.31527 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.594 | acc=0.7969 | 4265.0 samples/s | 66.6 steps/s
[Step=16050 Epoch=15.7] | Loss=0.05853 | Reg=0.00225 | L2-Norm=14.983 | L2-Norm(final)=2.582 | acc=0.9688 | 4791.5 samples/s | 74.9 steps/s
[Step=16100 Epoch=15.7] | Loss=0.03842 | Reg=0.00225 | L2-Norm=15.001 | L2-Norm(final)=2.590 | acc=0.9844 | 4949.7 samples/s | 77.3 steps/s
[Step=16150 Epoch=15.8] | Loss=0.03146 | Reg=0.00225 | L2-Norm=15.009 | L2-Norm(final)=2.597 | acc=0.9688 | 4983.4 samples/s | 77.9 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02788 | Reg=0.00225 | L2-Norm=15.015 | L2-Norm(final)=2.602 | acc=0.9688 | 4925.0 samples/s | 77.0 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02604 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.607 | acc=1.0000 | 4894.4 samples/s | 76.5 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02432 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.611 | acc=0.9844 | 4947.8 samples/s | 77.3 steps/s
[Step=16350 Epoch=16.0] | Loss=0.02306 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.614 | acc=1.0000 | 5023.6 samples/s | 78.5 steps/s
[Step=16400 Epoch=16.0] | Loss=0.02204 | Reg=0.00226 | L2-Norm=15.032 | L2-Norm(final)=2.617 | acc=0.9844 | 4941.8 samples/s | 77.2 steps/s
[Step=16450 Epoch=16.1] | Loss=0.02147 | Reg=0.00226 | L2-Norm=15.035 | L2-Norm(final)=2.620 | acc=1.0000 | 4991.9 samples/s | 78.0 steps/s
[Step=16500 Epoch=16.1] | Loss=0.02109 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.622 | acc=0.9844 | 4967.1 samples/s | 77.6 steps/s
[Step=16550 Epoch=16.2] | Loss=0.02022 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.625 | acc=0.9688 | 4893.1 samples/s | 76.5 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01959 | Reg=0.00226 | L2-Norm=15.042 | L2-Norm(final)=2.628 | acc=0.9844 | 4947.1 samples/s | 77.3 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01948 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.630 | acc=1.0000 | 4917.1 samples/s | 76.8 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01903 | Reg=0.00226 | L2-Norm=15.046 | L2-Norm(final)=2.632 | acc=0.9844 | 4893.0 samples/s | 76.5 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01861 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.635 | acc=1.0000 | 4942.9 samples/s | 77.2 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01808 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.637 | acc=1.0000 | 4941.6 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.06740 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.595 | acc=0.9688 | 3868.4 samples/s | 60.4 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00435 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.588 | acc=1.0000 | 4620.1 samples/s | 72.2 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00223 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.589 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00157 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.590 | acc=1.0000 | 4647.0 samples/s | 72.6 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00119 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.590 | acc=1.0000 | 4781.9 samples/s | 74.7 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00096 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.592 | acc=1.0000 | 4642.5 samples/s | 72.5 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00082 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.593 | acc=1.0000 | 4798.7 samples/s | 75.0 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00070 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.594 | acc=1.0000 | 4569.8 samples/s | 71.4 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00062 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.595 | acc=1.0000 | 4689.4 samples/s | 73.3 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00055 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.596 | acc=1.0000 | 4754.6 samples/s | 74.3 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00050 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.597 | acc=1.0000 | 4680.3 samples/s | 73.1 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00046 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.598 | acc=1.0000 | 2064.2 samples/s | 32.3 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00042 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.598 | acc=1.0000 | 4783.7 samples/s | 74.7 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00039 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.599 | acc=1.0000 | 4605.2 samples/s | 72.0 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00036 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.600 | acc=1.0000 | 4702.8 samples/s | 73.5 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00034 | Reg=0.00222 | L2-Norm=14.894 | L2-Norm(final)=2.601 | acc=1.0000 | 4721.8 samples/s | 73.8 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00032 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.602 | acc=1.0000 | 4600.5 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26767 | acc=0.8394 | tpr=0.7689 | fpr=0.0077 | 4636.5 samples/s | 18.1 steps/s
Avg test loss: 0.27289, Avg test acc: 0.84125, Avg tpr: 0.77280, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.38673 | acc=0.8630 | tpr=0.9690 | fpr=0.1389 | 4566.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.39131 | acc=0.8631 | tpr=0.9808 | fpr=0.1391 | 8855.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.39755 | acc=0.8625 | tpr=0.9841 | fpr=0.1397 | 8759.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.40105 | acc=0.8637 | tpr=0.9869 | fpr=0.1385 | 8766.5 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.39949 | acc=0.8635 | tpr=0.9825 | fpr=0.1387 | 8629.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.40264 | acc=0.8633 | tpr=0.9840 | fpr=0.1389 | 9049.3 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.40278 | acc=0.8632 | tpr=0.9818 | fpr=0.1390 | 8464.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.40379 | acc=0.8625 | tpr=0.9798 | fpr=0.1397 | 9074.4 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.40747 | acc=0.8618 | tpr=0.9786 | fpr=0.1403 | 8639.9 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.40739 | acc=0.8615 | tpr=0.9784 | fpr=0.1406 | 8928.2 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.40534 | acc=0.8619 | tpr=0.9773 | fpr=0.1402 | 15341.2 samples/s | 59.9 steps/s
Avg test loss: 0.40544, Avg test acc: 0.86188, Avg tpr: 0.97702, Avg fpr: 0.14022, total FA: 19469

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.17809 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.644 | acc=0.8750 | 4715.2 samples/s | 73.7 steps/s
[Step=16850 Epoch=16.5] | Loss=0.03129 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.642 | acc=0.9844 | 4427.3 samples/s | 69.2 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02190 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.648 | acc=0.9844 | 4937.6 samples/s | 77.2 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01908 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.653 | acc=0.9844 | 4954.1 samples/s | 77.4 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01883 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.657 | acc=0.9688 | 4898.3 samples/s | 76.5 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01761 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.660 | acc=1.0000 | 4974.3 samples/s | 77.7 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01612 | Reg=0.00223 | L2-Norm=14.947 | L2-Norm(final)=2.663 | acc=1.0000 | 4942.3 samples/s | 77.2 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01609 | Reg=0.00224 | L2-Norm=14.950 | L2-Norm(final)=2.666 | acc=0.9688 | 4991.5 samples/s | 78.0 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01566 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.669 | acc=1.0000 | 4909.9 samples/s | 76.7 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01551 | Reg=0.00224 | L2-Norm=14.955 | L2-Norm(final)=2.671 | acc=1.0000 | 4989.0 samples/s | 78.0 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01551 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.674 | acc=1.0000 | 4904.2 samples/s | 76.6 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01519 | Reg=0.00224 | L2-Norm=14.959 | L2-Norm(final)=2.676 | acc=1.0000 | 5022.1 samples/s | 78.5 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01508 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.678 | acc=1.0000 | 4944.1 samples/s | 77.3 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01481 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.680 | acc=1.0000 | 4911.3 samples/s | 76.7 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01467 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.683 | acc=1.0000 | 5066.4 samples/s | 79.2 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01449 | Reg=0.00224 | L2-Norm=14.967 | L2-Norm(final)=2.685 | acc=1.0000 | 4957.8 samples/s | 77.5 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01446 | Reg=0.00224 | L2-Norm=14.969 | L2-Norm(final)=2.687 | acc=0.9844 | 4970.0 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.06078 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.643 | acc=0.9531 | 4090.7 samples/s | 63.9 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00367 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.648 | acc=1.0000 | 4479.1 samples/s | 70.0 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00194 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.650 | acc=1.0000 | 4716.3 samples/s | 73.7 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00131 | Reg=0.00223 | L2-Norm=14.947 | L2-Norm(final)=2.652 | acc=1.0000 | 4639.5 samples/s | 72.5 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00099 | Reg=0.00223 | L2-Norm=14.943 | L2-Norm(final)=2.654 | acc=1.0000 | 4721.5 samples/s | 73.8 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00080 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.655 | acc=1.0000 | 4684.1 samples/s | 73.2 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00067 | Reg=0.00223 | L2-Norm=14.933 | L2-Norm(final)=2.656 | acc=1.0000 | 4757.4 samples/s | 74.3 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00058 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.657 | acc=1.0000 | 4728.7 samples/s | 73.9 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00051 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.658 | acc=1.0000 | 4732.9 samples/s | 74.0 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00046 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.659 | acc=1.0000 | 4760.3 samples/s | 74.4 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00041 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.660 | acc=1.0000 | 4759.5 samples/s | 74.4 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00038 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.660 | acc=1.0000 | 2085.3 samples/s | 32.6 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00035 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.661 | acc=1.0000 | 4742.7 samples/s | 74.1 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00032 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.662 | acc=1.0000 | 4672.0 samples/s | 73.0 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00030 | Reg=0.00221 | L2-Norm=14.883 | L2-Norm(final)=2.662 | acc=1.0000 | 4718.4 samples/s | 73.7 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00028 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.663 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00026 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.663 | acc=1.0000 | 4683.8 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38550 | acc=0.7934 | tpr=0.7014 | fpr=0.0067 | 4540.8 samples/s | 17.7 steps/s
Avg test loss: 0.38884, Avg test acc: 0.79381, Avg tpr: 0.70327, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.30339 | acc=0.9070 | tpr=0.9602 | fpr=0.0939 | 4595.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.30863 | acc=0.9063 | tpr=0.9765 | fpr=0.0950 | 8712.3 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.31778 | acc=0.9056 | tpr=0.9784 | fpr=0.0958 | 8769.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.32223 | acc=0.9062 | tpr=0.9814 | fpr=0.0951 | 8704.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.32094 | acc=0.9063 | tpr=0.9790 | fpr=0.0950 | 8729.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.32402 | acc=0.9062 | tpr=0.9796 | fpr=0.0951 | 8841.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.32462 | acc=0.9059 | tpr=0.9775 | fpr=0.0954 | 9252.1 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.32528 | acc=0.9054 | tpr=0.9759 | fpr=0.0959 | 8160.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.32919 | acc=0.9050 | tpr=0.9747 | fpr=0.0962 | 8860.3 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.32893 | acc=0.9050 | tpr=0.9749 | fpr=0.0963 | 8732.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.32664 | acc=0.9053 | tpr=0.9745 | fpr=0.0959 | 15124.5 samples/s | 59.1 steps/s
Avg test loss: 0.32658, Avg test acc: 0.90535, Avg tpr: 0.97425, Avg fpr: 0.09590, total FA: 13316

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.25615 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.692 | acc=0.8594 | 4192.8 samples/s | 65.5 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03190 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.685 | acc=0.9844 | 4787.8 samples/s | 74.8 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02133 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.690 | acc=0.9688 | 4973.9 samples/s | 77.7 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01801 | Reg=0.00222 | L2-Norm=14.894 | L2-Norm(final)=2.695 | acc=0.9844 | 5072.8 samples/s | 79.3 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01729 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.699 | acc=1.0000 | 4891.4 samples/s | 76.4 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01656 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.701 | acc=1.0000 | 4996.5 samples/s | 78.1 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01557 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.703 | acc=0.9844 | 4928.1 samples/s | 77.0 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01500 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.705 | acc=0.9688 | 5002.8 samples/s | 78.2 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01483 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.708 | acc=0.9844 | 4944.8 samples/s | 77.3 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01485 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.709 | acc=0.9688 | 5000.2 samples/s | 78.1 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01443 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.711 | acc=0.9688 | 4888.5 samples/s | 76.4 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01451 | Reg=0.00222 | L2-Norm=14.916 | L2-Norm(final)=2.713 | acc=1.0000 | 4956.4 samples/s | 77.4 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01450 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.714 | acc=0.9688 | 5030.2 samples/s | 78.6 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01447 | Reg=0.00223 | L2-Norm=14.920 | L2-Norm(final)=2.716 | acc=0.9688 | 4890.8 samples/s | 76.4 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01451 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.718 | acc=0.9688 | 5057.6 samples/s | 79.0 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01437 | Reg=0.00223 | L2-Norm=14.923 | L2-Norm(final)=2.720 | acc=0.9844 | 4979.2 samples/s | 77.8 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01429 | Reg=0.00223 | L2-Norm=14.925 | L2-Norm(final)=2.722 | acc=0.9844 | 5049.7 samples/s | 78.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.00166 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.692 | acc=1.0000 | 4472.3 samples/s | 69.9 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00330 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.697 | acc=0.9844 | 4134.3 samples/s | 64.6 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00196 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.697 | acc=1.0000 | 4689.0 samples/s | 73.3 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00157 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.697 | acc=1.0000 | 4737.0 samples/s | 74.0 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00122 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.697 | acc=1.0000 | 4654.3 samples/s | 72.7 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00110 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.698 | acc=1.0000 | 4700.3 samples/s | 73.4 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00093 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.698 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00079 | Reg=0.00221 | L2-Norm=14.883 | L2-Norm(final)=2.698 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00070 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.698 | acc=1.0000 | 4688.4 samples/s | 73.3 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00062 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.699 | acc=1.0000 | 4685.8 samples/s | 73.2 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00056 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.699 | acc=1.0000 | 4806.5 samples/s | 75.1 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00051 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.700 | acc=1.0000 | 2066.3 samples/s | 32.3 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00047 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.700 | acc=1.0000 | 4811.4 samples/s | 75.2 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00043 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.701 | acc=1.0000 | 4634.9 samples/s | 72.4 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00040 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.701 | acc=1.0000 | 4609.1 samples/s | 72.0 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00038 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.701 | acc=1.0000 | 4572.4 samples/s | 71.4 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00035 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.702 | acc=1.0000 | 4633.2 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28963 | acc=0.8441 | tpr=0.7776 | fpr=0.0116 | 4481.6 samples/s | 17.5 steps/s
Avg test loss: 0.29009, Avg test acc: 0.84466, Avg tpr: 0.77933, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.40477 | acc=0.8800 | tpr=0.9646 | fpr=0.1215 | 4589.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.41318 | acc=0.8799 | tpr=0.9765 | fpr=0.1219 | 8740.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.42428 | acc=0.8785 | tpr=0.9813 | fpr=0.1234 | 8670.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.42861 | acc=0.8787 | tpr=0.9836 | fpr=0.1232 | 8878.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.42757 | acc=0.8783 | tpr=0.9834 | fpr=0.1236 | 8798.6 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.43080 | acc=0.8784 | tpr=0.9833 | fpr=0.1236 | 8652.9 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.43113 | acc=0.8782 | tpr=0.9812 | fpr=0.1236 | 9010.8 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.43211 | acc=0.8779 | tpr=0.9798 | fpr=0.1239 | 8593.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.43627 | acc=0.8780 | tpr=0.9786 | fpr=0.1238 | 8843.8 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.43623 | acc=0.8778 | tpr=0.9784 | fpr=0.1240 | 9130.6 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.43336 | acc=0.8782 | tpr=0.9777 | fpr=0.1236 | 14352.9 samples/s | 56.1 steps/s
Avg test loss: 0.43340, Avg test acc: 0.87817, Avg tpr: 0.97742, Avg fpr: 0.12364, total FA: 17167

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.15846 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.728 | acc=0.8906 | 4183.8 samples/s | 65.4 steps/s
[Step=18450 Epoch=18.0] | Loss=0.02999 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.727 | acc=1.0000 | 4778.9 samples/s | 74.7 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02204 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.729 | acc=1.0000 | 4941.9 samples/s | 77.2 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01871 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.732 | acc=1.0000 | 4896.3 samples/s | 76.5 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01742 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.734 | acc=1.0000 | 5046.6 samples/s | 78.9 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01602 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.737 | acc=1.0000 | 5001.9 samples/s | 78.2 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01541 | Reg=0.00221 | L2-Norm=14.855 | L2-Norm(final)=2.740 | acc=1.0000 | 4929.8 samples/s | 77.0 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01499 | Reg=0.00221 | L2-Norm=14.857 | L2-Norm(final)=2.743 | acc=0.9844 | 5040.5 samples/s | 78.8 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01459 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.745 | acc=0.9844 | 5017.9 samples/s | 78.4 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01441 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.747 | acc=0.9844 | 4950.4 samples/s | 77.3 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01413 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.750 | acc=1.0000 | 4906.4 samples/s | 76.7 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01391 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.752 | acc=1.0000 | 4983.5 samples/s | 77.9 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01377 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.755 | acc=0.9688 | 4888.7 samples/s | 76.4 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01372 | Reg=0.00221 | L2-Norm=14.870 | L2-Norm(final)=2.757 | acc=0.9688 | 4944.3 samples/s | 77.3 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01365 | Reg=0.00221 | L2-Norm=14.872 | L2-Norm(final)=2.759 | acc=1.0000 | 4969.1 samples/s | 77.6 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01346 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.761 | acc=1.0000 | 4993.7 samples/s | 78.0 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01334 | Reg=0.00221 | L2-Norm=14.876 | L2-Norm(final)=2.763 | acc=1.0000 | 5018.7 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.01938 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.729 | acc=0.9688 | 4210.7 samples/s | 65.8 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00267 | Reg=0.00221 | L2-Norm=14.852 | L2-Norm(final)=2.730 | acc=1.0000 | 4238.4 samples/s | 66.2 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00143 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.731 | acc=1.0000 | 4498.2 samples/s | 70.3 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00098 | Reg=0.00221 | L2-Norm=14.865 | L2-Norm(final)=2.733 | acc=1.0000 | 4629.2 samples/s | 72.3 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00074 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.734 | acc=1.0000 | 4744.4 samples/s | 74.1 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00059 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.735 | acc=1.0000 | 4799.5 samples/s | 75.0 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00050 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.736 | acc=1.0000 | 4723.8 samples/s | 73.8 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00043 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.736 | acc=1.0000 | 4757.7 samples/s | 74.3 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00037 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.737 | acc=1.0000 | 4733.2 samples/s | 74.0 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00034 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.737 | acc=1.0000 | 4591.7 samples/s | 71.7 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00030 | Reg=0.00220 | L2-Norm=14.830 | L2-Norm(final)=2.738 | acc=1.0000 | 4803.9 samples/s | 75.1 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00028 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.738 | acc=1.0000 | 2093.5 samples/s | 32.7 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00025 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.738 | acc=1.0000 | 4730.2 samples/s | 73.9 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00023 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.739 | acc=1.0000 | 4711.3 samples/s | 73.6 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00022 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.739 | acc=1.0000 | 4745.6 samples/s | 74.2 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00020 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.739 | acc=1.0000 | 4715.1 samples/s | 73.7 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00019 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.740 | acc=1.0000 | 4692.7 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30467 | acc=0.8386 | tpr=0.7683 | fpr=0.0087 | 4542.1 samples/s | 17.7 steps/s
Avg test loss: 0.30966, Avg test acc: 0.83961, Avg tpr: 0.77071, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.35990 | acc=0.8969 | tpr=0.9646 | fpr=0.1043 | 4579.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.36771 | acc=0.8952 | tpr=0.9765 | fpr=0.1063 | 8736.3 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.37760 | acc=0.8940 | tpr=0.9798 | fpr=0.1076 | 8951.9 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.38277 | acc=0.8945 | tpr=0.9825 | fpr=0.1071 | 8722.3 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.38216 | acc=0.8940 | tpr=0.9817 | fpr=0.1076 | 9423.5 samples/s | 36.8 steps/s
[Step= 300] | Loss=0.38571 | acc=0.8936 | tpr=0.9818 | fpr=0.1080 | 7874.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.38580 | acc=0.8936 | tpr=0.9793 | fpr=0.1079 | 8677.0 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.38651 | acc=0.8934 | tpr=0.9787 | fpr=0.1081 | 9089.5 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.39061 | acc=0.8931 | tpr=0.9776 | fpr=0.1085 | 8472.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.39034 | acc=0.8927 | tpr=0.9775 | fpr=0.1089 | 8537.2 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.38764 | acc=0.8932 | tpr=0.9761 | fpr=0.1083 | 16014.2 samples/s | 62.6 steps/s
Avg test loss: 0.38773, Avg test acc: 0.89314, Avg tpr: 0.97583, Avg fpr: 0.10836, total FA: 15046

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.09991 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.765 | acc=0.9062 | 4429.7 samples/s | 69.2 steps/s
[Step=19250 Epoch=18.8] | Loss=0.03335 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.753 | acc=0.9844 | 4578.1 samples/s | 71.5 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02198 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.756 | acc=0.9844 | 4889.7 samples/s | 76.4 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01856 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.761 | acc=1.0000 | 5005.0 samples/s | 78.2 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01686 | Reg=0.00220 | L2-Norm=14.822 | L2-Norm(final)=2.765 | acc=0.9688 | 4873.0 samples/s | 76.1 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01582 | Reg=0.00220 | L2-Norm=14.827 | L2-Norm(final)=2.768 | acc=0.9688 | 4948.0 samples/s | 77.3 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01547 | Reg=0.00220 | L2-Norm=14.830 | L2-Norm(final)=2.771 | acc=1.0000 | 4965.9 samples/s | 77.6 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01514 | Reg=0.00220 | L2-Norm=14.834 | L2-Norm(final)=2.774 | acc=1.0000 | 5007.2 samples/s | 78.2 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01478 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.777 | acc=1.0000 | 4968.8 samples/s | 77.6 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01481 | Reg=0.00220 | L2-Norm=14.839 | L2-Norm(final)=2.779 | acc=0.9844 | 4918.2 samples/s | 76.8 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01454 | Reg=0.00220 | L2-Norm=14.841 | L2-Norm(final)=2.782 | acc=0.9844 | 4897.0 samples/s | 76.5 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01438 | Reg=0.00220 | L2-Norm=14.843 | L2-Norm(final)=2.783 | acc=1.0000 | 4862.2 samples/s | 76.0 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01427 | Reg=0.00220 | L2-Norm=14.845 | L2-Norm(final)=2.785 | acc=1.0000 | 4824.4 samples/s | 75.4 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01438 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.787 | acc=0.9688 | 4859.6 samples/s | 75.9 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01415 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.788 | acc=1.0000 | 5007.0 samples/s | 78.2 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01411 | Reg=0.00221 | L2-Norm=14.849 | L2-Norm(final)=2.790 | acc=0.9688 | 4995.5 samples/s | 78.1 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01403 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.791 | acc=1.0000 | 4941.1 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.03941 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.765 | acc=0.9531 | 4369.3 samples/s | 68.3 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00391 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.764 | acc=1.0000 | 4016.8 samples/s | 62.8 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00199 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.766 | acc=1.0000 | 4576.7 samples/s | 71.5 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00159 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.766 | acc=1.0000 | 4774.8 samples/s | 74.6 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00121 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.765 | acc=1.0000 | 4575.7 samples/s | 71.5 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00098 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.766 | acc=1.0000 | 4763.3 samples/s | 74.4 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00082 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.766 | acc=1.0000 | 4739.8 samples/s | 74.1 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00071 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.767 | acc=1.0000 | 4720.2 samples/s | 73.8 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00062 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.768 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00056 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=2.769 | acc=1.0000 | 4685.2 samples/s | 73.2 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00050 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.770 | acc=1.0000 | 4725.9 samples/s | 73.8 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00046 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.771 | acc=1.0000 | 2070.6 samples/s | 32.4 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00042 | Reg=0.00218 | L2-Norm=14.772 | L2-Norm(final)=2.772 | acc=1.0000 | 4888.7 samples/s | 76.4 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00039 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.774 | acc=1.0000 | 4718.7 samples/s | 73.7 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00036 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.775 | acc=1.0000 | 4701.2 samples/s | 73.5 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00034 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.776 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00032 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.778 | acc=1.0000 | 4711.1 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25527 | acc=0.8558 | tpr=0.7935 | fpr=0.0089 | 4618.4 samples/s | 18.0 steps/s
Avg test loss: 0.25814, Avg test acc: 0.85544, Avg tpr: 0.79443, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.36980 | acc=0.8859 | tpr=0.9735 | fpr=0.1156 | 4540.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.37453 | acc=0.8862 | tpr=0.9808 | fpr=0.1156 | 8898.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.38354 | acc=0.8855 | tpr=0.9813 | fpr=0.1163 | 8829.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.38739 | acc=0.8859 | tpr=0.9836 | fpr=0.1159 | 8816.8 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.38706 | acc=0.8857 | tpr=0.9817 | fpr=0.1160 | 8606.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.38996 | acc=0.8857 | tpr=0.9825 | fpr=0.1161 | 8544.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.39056 | acc=0.8856 | tpr=0.9793 | fpr=0.1161 | 8676.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.39147 | acc=0.8855 | tpr=0.9787 | fpr=0.1162 | 8760.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.39511 | acc=0.8853 | tpr=0.9776 | fpr=0.1163 | 8961.0 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.39424 | acc=0.8852 | tpr=0.9775 | fpr=0.1165 | 8747.6 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.39161 | acc=0.8857 | tpr=0.9761 | fpr=0.1160 | 16244.8 samples/s | 63.5 steps/s
Avg test loss: 0.39177, Avg test acc: 0.88563, Avg tpr: 0.97583, Avg fpr: 0.11601, total FA: 16108

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.23729 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=2.799 | acc=0.9062 | 4219.6 samples/s | 65.9 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02791 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.795 | acc=0.9531 | 4777.4 samples/s | 74.6 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01954 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.799 | acc=0.9844 | 4909.6 samples/s | 76.7 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01623 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.803 | acc=1.0000 | 4992.0 samples/s | 78.0 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01448 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.807 | acc=0.9688 | 4913.1 samples/s | 76.8 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01401 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.811 | acc=1.0000 | 4917.0 samples/s | 76.8 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01448 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.814 | acc=0.9844 | 4915.3 samples/s | 76.8 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01447 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.816 | acc=1.0000 | 4907.5 samples/s | 76.7 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01457 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.817 | acc=0.9844 | 4991.0 samples/s | 78.0 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01434 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.819 | acc=1.0000 | 4864.5 samples/s | 76.0 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01437 | Reg=0.00219 | L2-Norm=14.787 | L2-Norm(final)=2.820 | acc=0.9844 | 4975.3 samples/s | 77.7 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01385 | Reg=0.00219 | L2-Norm=14.789 | L2-Norm(final)=2.822 | acc=0.9844 | 5020.9 samples/s | 78.5 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01353 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.824 | acc=0.9844 | 4995.0 samples/s | 78.0 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01365 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.825 | acc=0.9688 | 5020.4 samples/s | 78.4 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01350 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.827 | acc=1.0000 | 4969.9 samples/s | 77.7 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01335 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.828 | acc=1.0000 | 4952.2 samples/s | 77.4 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01322 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.830 | acc=0.9531 | 4989.8 samples/s | 78.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.00905 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=2.800 | acc=1.0000 | 4370.5 samples/s | 68.3 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00373 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.801 | acc=1.0000 | 4276.9 samples/s | 66.8 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00196 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.801 | acc=1.0000 | 4743.0 samples/s | 74.1 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00134 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.802 | acc=1.0000 | 4763.7 samples/s | 74.4 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00101 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.803 | acc=1.0000 | 4740.7 samples/s | 74.1 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00081 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.804 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00068 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.805 | acc=1.0000 | 4760.4 samples/s | 74.4 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00059 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.806 | acc=1.0000 | 4659.8 samples/s | 72.8 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00051 | Reg=0.00219 | L2-Norm=14.789 | L2-Norm(final)=2.807 | acc=1.0000 | 4655.0 samples/s | 72.7 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00046 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.808 | acc=1.0000 | 4702.2 samples/s | 73.5 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00041 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.808 | acc=1.0000 | 4807.0 samples/s | 75.1 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00038 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.809 | acc=1.0000 | 2082.5 samples/s | 32.5 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00035 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.810 | acc=1.0000 | 4730.9 samples/s | 73.9 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00032 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.811 | acc=1.0000 | 4620.2 samples/s | 72.2 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00030 | Reg=0.00218 | L2-Norm=14.753 | L2-Norm(final)=2.811 | acc=1.0000 | 4732.8 samples/s | 73.9 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00028 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.812 | acc=1.0000 | 4668.7 samples/s | 72.9 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00026 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.813 | acc=1.0000 | 4850.1 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33728 | acc=0.8241 | tpr=0.7465 | fpr=0.0074 | 4544.1 samples/s | 17.8 steps/s
Avg test loss: 0.34010, Avg test acc: 0.82455, Avg tpr: 0.74879, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.35874 | acc=0.9031 | tpr=0.9690 | fpr=0.0981 | 4555.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.36716 | acc=0.9007 | tpr=0.9765 | fpr=0.1008 | 8846.3 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.37821 | acc=0.8993 | tpr=0.9798 | fpr=0.1021 | 8764.1 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.38309 | acc=0.8996 | tpr=0.9825 | fpr=0.1019 | 9010.3 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.38150 | acc=0.8991 | tpr=0.9808 | fpr=0.1024 | 8543.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.38515 | acc=0.8990 | tpr=0.9818 | fpr=0.1025 | 8597.5 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.38562 | acc=0.8992 | tpr=0.9787 | fpr=0.1023 | 8609.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.38587 | acc=0.8989 | tpr=0.9781 | fpr=0.1025 | 9473.2 samples/s | 37.0 steps/s
[Step= 450] | Loss=0.38989 | acc=0.8988 | tpr=0.9761 | fpr=0.1026 | 8209.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.38899 | acc=0.8987 | tpr=0.9758 | fpr=0.1027 | 8583.4 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.38609 | acc=0.8992 | tpr=0.9749 | fpr=0.1021 | 15975.6 samples/s | 62.4 steps/s
Avg test loss: 0.38603, Avg test acc: 0.89924, Avg tpr: 0.97464, Avg fpr: 0.10213, total FA: 14180

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.11272 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.836 | acc=0.9062 | 3981.5 samples/s | 62.2 steps/s
[Step=20850 Epoch=20.4] | Loss=0.03003 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.827 | acc=1.0000 | 4780.3 samples/s | 74.7 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01995 | Reg=0.00217 | L2-Norm=14.748 | L2-Norm(final)=2.832 | acc=1.0000 | 4874.0 samples/s | 76.2 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01644 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.836 | acc=1.0000 | 4866.1 samples/s | 76.0 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01550 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.839 | acc=0.9844 | 4865.0 samples/s | 76.0 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01472 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.841 | acc=1.0000 | 4973.0 samples/s | 77.7 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01401 | Reg=0.00218 | L2-Norm=14.762 | L2-Norm(final)=2.843 | acc=1.0000 | 5036.6 samples/s | 78.7 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01405 | Reg=0.00218 | L2-Norm=14.764 | L2-Norm(final)=2.845 | acc=0.9688 | 4872.6 samples/s | 76.1 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01357 | Reg=0.00218 | L2-Norm=14.766 | L2-Norm(final)=2.846 | acc=1.0000 | 4946.0 samples/s | 77.3 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01325 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.848 | acc=1.0000 | 5010.6 samples/s | 78.3 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01332 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.850 | acc=0.9844 | 5042.4 samples/s | 78.8 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01311 | Reg=0.00218 | L2-Norm=14.770 | L2-Norm(final)=2.851 | acc=1.0000 | 4870.3 samples/s | 76.1 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01281 | Reg=0.00218 | L2-Norm=14.772 | L2-Norm(final)=2.853 | acc=1.0000 | 4793.3 samples/s | 74.9 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01274 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.855 | acc=1.0000 | 4991.0 samples/s | 78.0 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01258 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.857 | acc=0.9688 | 5018.1 samples/s | 78.4 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01257 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.859 | acc=1.0000 | 4939.5 samples/s | 77.2 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01259 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.860 | acc=1.0000 | 5000.9 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.03338 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.836 | acc=0.9688 | 4014.6 samples/s | 62.7 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00339 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=2.833 | acc=1.0000 | 4485.4 samples/s | 70.1 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00181 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.834 | acc=1.0000 | 4784.3 samples/s | 74.8 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00123 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.835 | acc=1.0000 | 4659.1 samples/s | 72.8 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00093 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.837 | acc=1.0000 | 4817.0 samples/s | 75.3 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00075 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.838 | acc=1.0000 | 4661.1 samples/s | 72.8 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00063 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.839 | acc=1.0000 | 4714.3 samples/s | 73.7 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00054 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.840 | acc=1.0000 | 4702.6 samples/s | 73.5 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00048 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.841 | acc=1.0000 | 4765.0 samples/s | 74.5 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00043 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.842 | acc=1.0000 | 4732.7 samples/s | 73.9 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00039 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=2.843 | acc=1.0000 | 4738.4 samples/s | 74.0 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00035 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.844 | acc=1.0000 | 2084.1 samples/s | 32.6 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00032 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.845 | acc=1.0000 | 4668.0 samples/s | 72.9 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00030 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.845 | acc=1.0000 | 4694.1 samples/s | 73.3 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00028 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.846 | acc=1.0000 | 4659.4 samples/s | 72.8 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00026 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.847 | acc=1.0000 | 4462.8 samples/s | 69.7 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00024 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.847 | acc=1.0000 | 4709.9 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27857 | acc=0.8490 | tpr=0.7830 | fpr=0.0077 | 4538.0 samples/s | 17.7 steps/s
Avg test loss: 0.28047, Avg test acc: 0.84939, Avg tpr: 0.78475, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.40412 | acc=0.8788 | tpr=0.9690 | fpr=0.1228 | 4584.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.41393 | acc=0.8771 | tpr=0.9787 | fpr=0.1247 | 8772.8 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.42482 | acc=0.8755 | tpr=0.9813 | fpr=0.1265 | 8631.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.42902 | acc=0.8763 | tpr=0.9847 | fpr=0.1257 | 8882.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.42838 | acc=0.8759 | tpr=0.9825 | fpr=0.1261 | 8506.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.43156 | acc=0.8757 | tpr=0.9833 | fpr=0.1263 | 8741.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.43278 | acc=0.8753 | tpr=0.9806 | fpr=0.1266 | 8898.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.43274 | acc=0.8753 | tpr=0.9798 | fpr=0.1266 | 8622.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.43734 | acc=0.8749 | tpr=0.9776 | fpr=0.1269 | 9271.5 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.43700 | acc=0.8749 | tpr=0.9767 | fpr=0.1270 | 8227.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.43411 | acc=0.8753 | tpr=0.9753 | fpr=0.1265 | 16268.4 samples/s | 63.5 steps/s
Avg test loss: 0.43430, Avg test acc: 0.87530, Avg tpr: 0.97504, Avg fpr: 0.12651, total FA: 17566

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.14936 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.869 | acc=0.9219 | 4057.9 samples/s | 63.4 steps/s
[Step=21650 Epoch=21.1] | Loss=0.02778 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.862 | acc=0.9844 | 4902.2 samples/s | 76.6 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01946 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.866 | acc=1.0000 | 4928.5 samples/s | 77.0 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01540 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=2.869 | acc=0.9844 | 5046.0 samples/s | 78.8 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01376 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.873 | acc=1.0000 | 4987.2 samples/s | 77.9 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01332 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=2.877 | acc=0.9844 | 4894.4 samples/s | 76.5 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01291 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.880 | acc=1.0000 | 5011.5 samples/s | 78.3 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01289 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.883 | acc=0.9844 | 5021.4 samples/s | 78.5 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01292 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.885 | acc=0.9844 | 4964.4 samples/s | 77.6 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01263 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=2.888 | acc=1.0000 | 5039.7 samples/s | 78.7 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01250 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.890 | acc=1.0000 | 5004.5 samples/s | 78.2 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01250 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.892 | acc=1.0000 | 4949.3 samples/s | 77.3 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01248 | Reg=0.00216 | L2-Norm=14.712 | L2-Norm(final)=2.894 | acc=0.9844 | 4973.6 samples/s | 77.7 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01245 | Reg=0.00216 | L2-Norm=14.714 | L2-Norm(final)=2.896 | acc=1.0000 | 4978.7 samples/s | 77.8 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01233 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.898 | acc=1.0000 | 4892.0 samples/s | 76.4 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01237 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.900 | acc=1.0000 | 4752.4 samples/s | 74.3 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01228 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.902 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.03631 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.870 | acc=0.9531 | 3804.6 samples/s | 59.4 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00611 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.861 | acc=1.0000 | 4396.5 samples/s | 68.7 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00326 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.856 | acc=1.0000 | 4767.1 samples/s | 74.5 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00223 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.856 | acc=1.0000 | 4654.4 samples/s | 72.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00168 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.857 | acc=1.0000 | 4743.4 samples/s | 74.1 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00135 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.857 | acc=1.0000 | 4789.8 samples/s | 74.8 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00112 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.858 | acc=1.0000 | 4544.7 samples/s | 71.0 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00097 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.859 | acc=1.0000 | 4855.0 samples/s | 75.9 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00085 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.859 | acc=1.0000 | 4685.8 samples/s | 73.2 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00075 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.860 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00068 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.861 | acc=1.0000 | 4759.3 samples/s | 74.4 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00062 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.861 | acc=1.0000 | 2080.1 samples/s | 32.5 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00057 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.862 | acc=1.0000 | 4739.5 samples/s | 74.1 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00052 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.863 | acc=1.0000 | 4729.0 samples/s | 73.9 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00049 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.863 | acc=1.0000 | 4673.3 samples/s | 73.0 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00046 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=2.864 | acc=1.0000 | 4667.2 samples/s | 72.9 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00043 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=2.864 | acc=1.0000 | 4720.0 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44601 | acc=0.7696 | tpr=0.6664 | fpr=0.0062 | 4580.2 samples/s | 17.9 steps/s
Avg test loss: 0.44873, Avg test acc: 0.76977, Avg tpr: 0.66772, Avg fpr: 0.00577, total FA: 45

Testing server on iccad2012
[Step=  50] | Loss=0.27260 | acc=0.9295 | tpr=0.9646 | fpr=0.0712 | 4265.3 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.27938 | acc=0.9280 | tpr=0.9744 | fpr=0.0729 | 8834.8 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.28746 | acc=0.9260 | tpr=0.9769 | fpr=0.0749 | 8706.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.29322 | acc=0.9262 | tpr=0.9803 | fpr=0.0748 | 9118.2 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.29210 | acc=0.9261 | tpr=0.9790 | fpr=0.0749 | 8602.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.29609 | acc=0.9255 | tpr=0.9796 | fpr=0.0755 | 8831.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.29659 | acc=0.9255 | tpr=0.9768 | fpr=0.0754 | 8791.8 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.29679 | acc=0.9253 | tpr=0.9754 | fpr=0.0756 | 8645.2 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.30085 | acc=0.9249 | tpr=0.9747 | fpr=0.0760 | 8994.2 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.30024 | acc=0.9248 | tpr=0.9744 | fpr=0.0761 | 8422.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.29785 | acc=0.9253 | tpr=0.9733 | fpr=0.0756 | 15948.3 samples/s | 62.3 steps/s
Avg test loss: 0.29780, Avg test acc: 0.92530, Avg tpr: 0.97306, Avg fpr: 0.07557, total FA: 10493

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.22388 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=2.900 | acc=0.8281 | 4146.1 samples/s | 64.8 steps/s
[Step=22450 Epoch=21.9] | Loss=0.03237 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.891 | acc=1.0000 | 4507.2 samples/s | 70.4 steps/s
[Step=22500 Epoch=22.0] | Loss=0.02150 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.894 | acc=1.0000 | 4986.6 samples/s | 77.9 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01802 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.898 | acc=1.0000 | 4979.5 samples/s | 77.8 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01568 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.902 | acc=1.0000 | 4970.3 samples/s | 77.7 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01499 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.905 | acc=0.9844 | 5064.3 samples/s | 79.1 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01406 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.909 | acc=0.9844 | 4927.0 samples/s | 77.0 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01352 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.911 | acc=1.0000 | 4973.4 samples/s | 77.7 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01314 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=2.914 | acc=1.0000 | 4935.9 samples/s | 77.1 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01276 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.917 | acc=1.0000 | 4926.1 samples/s | 77.0 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01253 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.920 | acc=1.0000 | 4918.8 samples/s | 76.9 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01236 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.922 | acc=1.0000 | 4954.3 samples/s | 77.4 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01251 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.924 | acc=1.0000 | 4970.0 samples/s | 77.7 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01226 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.926 | acc=0.9844 | 4941.9 samples/s | 77.2 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01236 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.928 | acc=0.9688 | 4991.5 samples/s | 78.0 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01245 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.930 | acc=0.9844 | 4994.5 samples/s | 78.0 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01237 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.931 | acc=1.0000 | 5019.3 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.00188 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=2.901 | acc=1.0000 | 4228.3 samples/s | 66.1 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00125 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.915 | acc=1.0000 | 4501.7 samples/s | 70.3 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00091 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.920 | acc=1.0000 | 4764.3 samples/s | 74.4 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00063 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.922 | acc=1.0000 | 4731.0 samples/s | 73.9 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00047 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.924 | acc=1.0000 | 4663.4 samples/s | 72.9 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00038 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.925 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00032 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.926 | acc=1.0000 | 4719.6 samples/s | 73.7 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00028 | Reg=0.00215 | L2-Norm=14.670 | L2-Norm(final)=2.926 | acc=1.0000 | 4689.0 samples/s | 73.3 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00024 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.927 | acc=1.0000 | 4764.6 samples/s | 74.4 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00022 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.927 | acc=1.0000 | 4654.9 samples/s | 72.7 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00020 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.928 | acc=1.0000 | 4778.7 samples/s | 74.7 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00027 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.928 | acc=1.0000 | 2070.5 samples/s | 32.4 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00025 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.927 | acc=1.0000 | 4806.6 samples/s | 75.1 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00024 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.927 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00022 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.927 | acc=1.0000 | 4723.4 samples/s | 73.8 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00021 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.927 | acc=1.0000 | 4689.8 samples/s | 73.3 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00019 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=2.927 | acc=1.0000 | 4755.4 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30084 | acc=0.8399 | tpr=0.7696 | fpr=0.0074 | 4528.9 samples/s | 17.7 steps/s
Avg test loss: 0.30513, Avg test acc: 0.84121, Avg tpr: 0.77263, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.38575 | acc=0.8959 | tpr=0.9646 | fpr=0.1053 | 4531.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.39458 | acc=0.8941 | tpr=0.9765 | fpr=0.1075 | 8832.1 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.40404 | acc=0.8929 | tpr=0.9798 | fpr=0.1087 | 8663.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.40876 | acc=0.8937 | tpr=0.9825 | fpr=0.1079 | 8904.7 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.40879 | acc=0.8923 | tpr=0.9808 | fpr=0.1093 | 8731.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.41340 | acc=0.8919 | tpr=0.9825 | fpr=0.1098 | 8689.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.41407 | acc=0.8919 | tpr=0.9800 | fpr=0.1097 | 8651.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.41452 | acc=0.8916 | tpr=0.9787 | fpr=0.1100 | 8960.5 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.41929 | acc=0.8912 | tpr=0.9771 | fpr=0.1103 | 8775.9 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.41813 | acc=0.8912 | tpr=0.9767 | fpr=0.1104 | 8820.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.41487 | acc=0.8917 | tpr=0.9757 | fpr=0.1098 | 14910.2 samples/s | 58.2 steps/s
Avg test loss: 0.41510, Avg test acc: 0.89171, Avg tpr: 0.97544, Avg fpr: 0.10981, total FA: 15247

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.23626 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.938 | acc=0.9062 | 4175.8 samples/s | 65.2 steps/s
[Step=23250 Epoch=22.7] | Loss=0.02523 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.935 | acc=0.9844 | 4498.6 samples/s | 70.3 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01810 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.940 | acc=1.0000 | 4886.1 samples/s | 76.3 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01535 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.945 | acc=1.0000 | 4919.6 samples/s | 76.9 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01394 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.948 | acc=1.0000 | 4965.6 samples/s | 77.6 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01335 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.952 | acc=0.9844 | 4957.9 samples/s | 77.5 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01329 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.955 | acc=0.9844 | 5002.6 samples/s | 78.2 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01354 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=2.956 | acc=0.9531 | 4939.8 samples/s | 77.2 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01307 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.957 | acc=1.0000 | 4923.5 samples/s | 76.9 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01302 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.958 | acc=0.9688 | 5007.9 samples/s | 78.2 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01255 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.959 | acc=1.0000 | 4950.4 samples/s | 77.4 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01250 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.960 | acc=0.9844 | 4981.9 samples/s | 77.8 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01236 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.961 | acc=0.9688 | 4995.4 samples/s | 78.1 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01216 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.963 | acc=1.0000 | 5032.5 samples/s | 78.6 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01197 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.964 | acc=0.9844 | 4976.4 samples/s | 77.8 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01207 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.966 | acc=1.0000 | 5046.5 samples/s | 78.9 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01212 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.967 | acc=0.9688 | 4995.7 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.00098 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.939 | acc=1.0000 | 4030.2 samples/s | 63.0 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00316 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.940 | acc=1.0000 | 4546.2 samples/s | 71.0 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00236 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.939 | acc=1.0000 | 4652.3 samples/s | 72.7 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00175 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.938 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00131 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.938 | acc=1.0000 | 4668.1 samples/s | 72.9 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00105 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.938 | acc=1.0000 | 4775.3 samples/s | 74.6 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00088 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.938 | acc=1.0000 | 4745.1 samples/s | 74.1 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00076 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.938 | acc=1.0000 | 4798.7 samples/s | 75.0 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00066 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.939 | acc=1.0000 | 4646.0 samples/s | 72.6 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00059 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.939 | acc=1.0000 | 4677.9 samples/s | 73.1 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00053 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.939 | acc=1.0000 | 4734.9 samples/s | 74.0 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00048 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=2.939 | acc=1.0000 | 2146.9 samples/s | 33.5 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00044 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.940 | acc=1.0000 | 4828.2 samples/s | 75.4 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00041 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.940 | acc=1.0000 | 4552.3 samples/s | 71.1 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00038 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.940 | acc=1.0000 | 4649.3 samples/s | 72.6 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00036 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.940 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00033 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.940 | acc=1.0000 | 4785.8 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35613 | acc=0.8133 | tpr=0.7306 | fpr=0.0072 | 4551.4 samples/s | 17.8 steps/s
Avg test loss: 0.35747, Avg test acc: 0.81413, Avg tpr: 0.73282, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.36236 | acc=0.9050 | tpr=0.9690 | fpr=0.0962 | 4625.5 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.37004 | acc=0.9050 | tpr=0.9787 | fpr=0.0964 | 8863.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.37939 | acc=0.9032 | tpr=0.9841 | fpr=0.0983 | 8970.8 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.38339 | acc=0.9036 | tpr=0.9858 | fpr=0.0979 | 8349.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.38338 | acc=0.9027 | tpr=0.9843 | fpr=0.0988 | 8930.6 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.38659 | acc=0.9024 | tpr=0.9840 | fpr=0.0991 | 8595.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.38689 | acc=0.9021 | tpr=0.9818 | fpr=0.0993 | 8710.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.38700 | acc=0.9019 | tpr=0.9814 | fpr=0.0996 | 8743.2 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.39161 | acc=0.9015 | tpr=0.9805 | fpr=0.1000 | 9248.8 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.39069 | acc=0.9014 | tpr=0.9811 | fpr=0.1001 | 8242.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.38787 | acc=0.9018 | tpr=0.9797 | fpr=0.0996 | 15929.3 samples/s | 62.2 steps/s
Avg test loss: 0.38794, Avg test acc: 0.90185, Avg tpr: 0.97940, Avg fpr: 0.09956, total FA: 13824

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.14381 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.964 | acc=0.8906 | 3845.1 samples/s | 60.1 steps/s
[Step=24050 Epoch=23.5] | Loss=0.03317 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.957 | acc=0.9844 | 4948.2 samples/s | 77.3 steps/s
[Step=24100 Epoch=23.5] | Loss=0.02150 | Reg=0.00213 | L2-Norm=14.582 | L2-Norm(final)=2.959 | acc=1.0000 | 5030.8 samples/s | 78.6 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01788 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.961 | acc=1.0000 | 4831.7 samples/s | 75.5 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01536 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.964 | acc=1.0000 | 5008.5 samples/s | 78.3 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01431 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.966 | acc=1.0000 | 4924.8 samples/s | 76.9 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01298 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=2.969 | acc=1.0000 | 4989.0 samples/s | 78.0 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01238 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=2.971 | acc=0.9844 | 4917.4 samples/s | 76.8 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01193 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.974 | acc=1.0000 | 5058.2 samples/s | 79.0 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01182 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.976 | acc=0.9688 | 5012.8 samples/s | 78.3 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01150 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.978 | acc=1.0000 | 5022.7 samples/s | 78.5 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01139 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.980 | acc=1.0000 | 4940.4 samples/s | 77.2 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01119 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.982 | acc=1.0000 | 4990.8 samples/s | 78.0 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01086 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.984 | acc=0.9844 | 4959.9 samples/s | 77.5 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01063 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.986 | acc=1.0000 | 4957.4 samples/s | 77.5 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01045 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.988 | acc=0.9688 | 5015.9 samples/s | 78.4 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01028 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.990 | acc=1.0000 | 5009.9 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.05097 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.964 | acc=0.9844 | 3901.5 samples/s | 61.0 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00368 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.968 | acc=1.0000 | 4370.0 samples/s | 68.3 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00187 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.969 | acc=1.0000 | 4686.3 samples/s | 73.2 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00125 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=2.970 | acc=1.0000 | 4707.7 samples/s | 73.6 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00096 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.970 | acc=1.0000 | 4671.1 samples/s | 73.0 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00077 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.971 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00064 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.972 | acc=1.0000 | 4607.5 samples/s | 72.0 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00056 | Reg=0.00212 | L2-Norm=14.572 | L2-Norm(final)=2.972 | acc=1.0000 | 4644.0 samples/s | 72.6 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00049 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=2.973 | acc=1.0000 | 4665.4 samples/s | 72.9 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00044 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.973 | acc=1.0000 | 4752.5 samples/s | 74.3 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00040 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=2.974 | acc=1.0000 | 4814.4 samples/s | 75.2 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00036 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.974 | acc=1.0000 | 2100.6 samples/s | 32.8 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00033 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.974 | acc=1.0000 | 4604.5 samples/s | 71.9 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00031 | Reg=0.00212 | L2-Norm=14.557 | L2-Norm(final)=2.975 | acc=1.0000 | 4721.3 samples/s | 73.8 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00029 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=2.975 | acc=1.0000 | 4736.8 samples/s | 74.0 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00027 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.975 | acc=1.0000 | 4819.4 samples/s | 75.3 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00025 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=2.976 | acc=1.0000 | 4602.0 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31009 | acc=0.8371 | tpr=0.7649 | fpr=0.0062 | 4502.9 samples/s | 17.6 steps/s
Avg test loss: 0.31413, Avg test acc: 0.83785, Avg tpr: 0.76703, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.35830 | acc=0.9015 | tpr=0.9646 | fpr=0.0997 | 4597.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.36789 | acc=0.8992 | tpr=0.9765 | fpr=0.1023 | 8723.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.37691 | acc=0.8980 | tpr=0.9813 | fpr=0.1036 | 8998.2 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.38098 | acc=0.8983 | tpr=0.9836 | fpr=0.1032 | 8496.0 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.38085 | acc=0.8978 | tpr=0.9817 | fpr=0.1037 | 8908.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.38421 | acc=0.8974 | tpr=0.9818 | fpr=0.1041 | 8947.1 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.38454 | acc=0.8973 | tpr=0.9793 | fpr=0.1042 | 8638.9 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.38447 | acc=0.8970 | tpr=0.9781 | fpr=0.1044 | 8583.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.38872 | acc=0.8969 | tpr=0.9776 | fpr=0.1046 | 8801.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.38816 | acc=0.8967 | tpr=0.9771 | fpr=0.1047 | 9226.7 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.38554 | acc=0.8970 | tpr=0.9757 | fpr=0.1045 | 14781.3 samples/s | 57.7 steps/s
Avg test loss: 0.38567, Avg test acc: 0.89697, Avg tpr: 0.97544, Avg fpr: 0.10446, total FA: 14504

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.11863 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.997 | acc=0.8906 | 4368.8 samples/s | 68.3 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02344 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=2.996 | acc=0.9844 | 4501.8 samples/s | 70.3 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01651 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=2.998 | acc=1.0000 | 4920.4 samples/s | 76.9 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01321 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=3.001 | acc=0.9844 | 4889.4 samples/s | 76.4 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01193 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.003 | acc=1.0000 | 4984.1 samples/s | 77.9 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01089 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=3.006 | acc=1.0000 | 4970.9 samples/s | 77.7 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01024 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.008 | acc=0.9531 | 5041.3 samples/s | 78.8 steps/s
[Step=25150 Epoch=24.6] | Loss=0.00992 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=3.010 | acc=1.0000 | 4946.2 samples/s | 77.3 steps/s
[Step=25200 Epoch=24.6] | Loss=0.00978 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.012 | acc=1.0000 | 5001.2 samples/s | 78.1 steps/s
[Step=25250 Epoch=24.7] | Loss=0.00951 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=3.013 | acc=1.0000 | 4961.9 samples/s | 77.5 steps/s
[Step=25300 Epoch=24.7] | Loss=0.00948 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.015 | acc=1.0000 | 4918.9 samples/s | 76.9 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00933 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=3.017 | acc=0.9844 | 5061.0 samples/s | 79.1 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00938 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=3.018 | acc=0.9688 | 4882.9 samples/s | 76.3 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00924 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=3.020 | acc=1.0000 | 5008.8 samples/s | 78.3 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00930 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=3.021 | acc=1.0000 | 4941.0 samples/s | 77.2 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00932 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=3.022 | acc=1.0000 | 4885.7 samples/s | 76.3 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00913 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=3.024 | acc=1.0000 | 4871.2 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.02951 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.997 | acc=0.9844 | 4226.8 samples/s | 66.0 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00271 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=3.004 | acc=1.0000 | 4470.8 samples/s | 69.9 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00138 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.005 | acc=1.0000 | 4680.8 samples/s | 73.1 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00093 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.005 | acc=1.0000 | 4726.0 samples/s | 73.8 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00070 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.006 | acc=1.0000 | 4713.3 samples/s | 73.6 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00057 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.007 | acc=1.0000 | 4761.5 samples/s | 74.4 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00048 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.007 | acc=1.0000 | 4676.2 samples/s | 73.1 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=3.008 | acc=1.0000 | 4707.2 samples/s | 73.6 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00036 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=3.008 | acc=1.0000 | 4717.1 samples/s | 73.7 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00032 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=3.009 | acc=1.0000 | 4772.4 samples/s | 74.6 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00029 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=3.009 | acc=1.0000 | 4702.0 samples/s | 73.5 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00026 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=3.009 | acc=1.0000 | 2054.5 samples/s | 32.1 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00024 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=3.010 | acc=1.0000 | 4870.7 samples/s | 76.1 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00022 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=3.010 | acc=1.0000 | 4786.2 samples/s | 74.8 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00021 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.010 | acc=1.0000 | 4666.1 samples/s | 72.9 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00020 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=3.011 | acc=1.0000 | 4699.3 samples/s | 73.4 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00018 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.011 | acc=1.0000 | 4681.2 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28445 | acc=0.8557 | tpr=0.7927 | fpr=0.0074 | 4444.1 samples/s | 17.4 steps/s
Avg test loss: 0.28925, Avg test acc: 0.85636, Avg tpr: 0.79466, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.37922 | acc=0.8999 | tpr=0.9646 | fpr=0.1012 | 4546.7 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.38964 | acc=0.8982 | tpr=0.9744 | fpr=0.1032 | 9326.2 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.39867 | acc=0.8970 | tpr=0.9784 | fpr=0.1045 | 8492.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.40324 | acc=0.8971 | tpr=0.9814 | fpr=0.1044 | 8782.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.40319 | acc=0.8967 | tpr=0.9799 | fpr=0.1048 | 8676.9 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.40677 | acc=0.8962 | tpr=0.9796 | fpr=0.1053 | 8527.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.40697 | acc=0.8961 | tpr=0.9768 | fpr=0.1054 | 9144.2 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.40722 | acc=0.8959 | tpr=0.9759 | fpr=0.1055 | 8520.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.41168 | acc=0.8956 | tpr=0.9757 | fpr=0.1059 | 8732.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.41084 | acc=0.8956 | tpr=0.9749 | fpr=0.1058 | 8785.1 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.40797 | acc=0.8961 | tpr=0.9737 | fpr=0.1054 | 15221.0 samples/s | 59.5 steps/s
Avg test loss: 0.40817, Avg test acc: 0.89607, Avg tpr: 0.97345, Avg fpr: 0.10534, total FA: 14626

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.16347 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.029 | acc=0.9062 | 3828.9 samples/s | 59.8 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02071 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.026 | acc=0.9844 | 4777.7 samples/s | 74.7 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01448 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.028 | acc=1.0000 | 4896.8 samples/s | 76.5 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01198 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.030 | acc=1.0000 | 4960.7 samples/s | 77.5 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01099 | Reg=0.00211 | L2-Norm=14.538 | L2-Norm(final)=3.032 | acc=1.0000 | 4971.4 samples/s | 77.7 steps/s
[Step=25850 Epoch=25.2] | Loss=0.00998 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=3.034 | acc=0.9844 | 4984.8 samples/s | 77.9 steps/s
[Step=25900 Epoch=25.3] | Loss=0.00956 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=3.037 | acc=0.9844 | 4950.9 samples/s | 77.4 steps/s
[Step=25950 Epoch=25.3] | Loss=0.00949 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=3.039 | acc=1.0000 | 4915.6 samples/s | 76.8 steps/s
[Step=26000 Epoch=25.4] | Loss=0.00955 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=3.040 | acc=0.9688 | 4944.5 samples/s | 77.3 steps/s
[Step=26050 Epoch=25.4] | Loss=0.00923 | Reg=0.00211 | L2-Norm=14.543 | L2-Norm(final)=3.042 | acc=1.0000 | 5030.8 samples/s | 78.6 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00919 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=3.044 | acc=1.0000 | 4988.4 samples/s | 77.9 steps/s
[Step=26150 Epoch=25.5] | Loss=0.00934 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=3.045 | acc=1.0000 | 5003.1 samples/s | 78.2 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00925 | Reg=0.00212 | L2-Norm=14.545 | L2-Norm(final)=3.046 | acc=0.9844 | 4959.0 samples/s | 77.5 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00924 | Reg=0.00212 | L2-Norm=14.545 | L2-Norm(final)=3.047 | acc=0.9844 | 5010.7 samples/s | 78.3 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00914 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=3.048 | acc=1.0000 | 4994.5 samples/s | 78.0 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00908 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=3.050 | acc=1.0000 | 4883.5 samples/s | 76.3 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00899 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=3.051 | acc=1.0000 | 4979.1 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.06082 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.030 | acc=0.9844 | 3989.4 samples/s | 62.3 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00492 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.028 | acc=1.0000 | 4545.0 samples/s | 71.0 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00255 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=3.028 | acc=1.0000 | 4753.9 samples/s | 74.3 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00179 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=3.029 | acc=1.0000 | 4686.5 samples/s | 73.2 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00136 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=3.030 | acc=1.0000 | 4673.8 samples/s | 73.0 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00110 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=3.031 | acc=1.0000 | 4754.7 samples/s | 74.3 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00092 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=3.032 | acc=1.0000 | 4666.1 samples/s | 72.9 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00079 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.033 | acc=1.0000 | 4635.8 samples/s | 72.4 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00069 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.034 | acc=1.0000 | 4700.9 samples/s | 73.5 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00062 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.035 | acc=1.0000 | 4701.5 samples/s | 73.5 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00056 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.035 | acc=1.0000 | 4807.5 samples/s | 75.1 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00051 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.036 | acc=1.0000 | 2150.1 samples/s | 33.6 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00047 | Reg=0.00211 | L2-Norm=14.526 | L2-Norm(final)=3.036 | acc=1.0000 | 4589.6 samples/s | 71.7 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00043 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=3.037 | acc=1.0000 | 4676.5 samples/s | 73.1 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00040 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=3.037 | acc=1.0000 | 4744.0 samples/s | 74.1 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00038 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.037 | acc=1.0000 | 4768.5 samples/s | 74.5 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.038 | acc=1.0000 | 4742.0 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28684 | acc=0.8507 | tpr=0.7858 | fpr=0.0084 | 4444.5 samples/s | 17.4 steps/s
Avg test loss: 0.28938, Avg test acc: 0.85215, Avg tpr: 0.78901, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.34567 | acc=0.9089 | tpr=0.9558 | fpr=0.0919 | 4558.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.35647 | acc=0.9075 | tpr=0.9723 | fpr=0.0937 | 8878.9 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.36533 | acc=0.9061 | tpr=0.9769 | fpr=0.0952 | 8730.5 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.37008 | acc=0.9061 | tpr=0.9803 | fpr=0.0953 | 8750.3 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.36890 | acc=0.9059 | tpr=0.9790 | fpr=0.0954 | 8634.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.37260 | acc=0.9053 | tpr=0.9796 | fpr=0.0960 | 8730.3 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.37339 | acc=0.9051 | tpr=0.9781 | fpr=0.0962 | 9002.0 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.37365 | acc=0.9048 | tpr=0.9776 | fpr=0.0965 | 8567.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.37817 | acc=0.9044 | tpr=0.9771 | fpr=0.0969 | 9022.4 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.37736 | acc=0.9045 | tpr=0.9762 | fpr=0.0968 | 8454.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.37441 | acc=0.9050 | tpr=0.9749 | fpr=0.0963 | 15590.4 samples/s | 60.9 steps/s
Avg test loss: 0.37464, Avg test acc: 0.90500, Avg tpr: 0.97464, Avg fpr: 0.09626, total FA: 13366

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.24958 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.056 | acc=0.8438 | 4130.4 samples/s | 64.5 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02388 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.052 | acc=0.9844 | 4442.8 samples/s | 69.4 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01583 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=3.053 | acc=1.0000 | 4924.0 samples/s | 76.9 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01210 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=3.056 | acc=1.0000 | 4833.5 samples/s | 75.5 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01099 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=3.058 | acc=1.0000 | 4896.3 samples/s | 76.5 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01025 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.060 | acc=1.0000 | 4968.2 samples/s | 77.6 steps/s
[Step=26700 Epoch=26.1] | Loss=0.00973 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=3.062 | acc=1.0000 | 5001.9 samples/s | 78.2 steps/s
[Step=26750 Epoch=26.1] | Loss=0.00944 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.064 | acc=0.9844 | 4990.1 samples/s | 78.0 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00928 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=3.065 | acc=1.0000 | 4988.3 samples/s | 77.9 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00902 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=3.067 | acc=1.0000 | 4977.0 samples/s | 77.8 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00917 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.069 | acc=1.0000 | 4940.9 samples/s | 77.2 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00918 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=3.070 | acc=1.0000 | 4910.2 samples/s | 76.7 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00912 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=3.071 | acc=1.0000 | 4836.3 samples/s | 75.6 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00903 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.072 | acc=1.0000 | 4977.3 samples/s | 77.8 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00904 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=3.073 | acc=0.9844 | 4851.7 samples/s | 75.8 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00913 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.074 | acc=0.9688 | 4986.4 samples/s | 77.9 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00912 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=3.075 | acc=1.0000 | 5003.0 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.01541 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.056 | acc=0.9844 | 4032.7 samples/s | 63.0 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00215 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.064 | acc=1.0000 | 4349.9 samples/s | 68.0 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00110 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.065 | acc=1.0000 | 4723.8 samples/s | 73.8 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00075 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.067 | acc=1.0000 | 4695.5 samples/s | 73.4 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00057 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=3.068 | acc=1.0000 | 4721.0 samples/s | 73.8 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00046 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.069 | acc=1.0000 | 4723.2 samples/s | 73.8 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.070 | acc=1.0000 | 4769.4 samples/s | 74.5 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00034 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.071 | acc=1.0000 | 4788.0 samples/s | 74.8 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00029 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.072 | acc=1.0000 | 4670.7 samples/s | 73.0 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00026 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=3.073 | acc=1.0000 | 4662.4 samples/s | 72.8 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00024 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.073 | acc=1.0000 | 4750.2 samples/s | 74.2 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00022 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.074 | acc=1.0000 | 2151.1 samples/s | 33.6 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00020 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.074 | acc=1.0000 | 4658.7 samples/s | 72.8 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00018 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.075 | acc=1.0000 | 4640.7 samples/s | 72.5 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00017 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.075 | acc=1.0000 | 4701.0 samples/s | 73.5 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00016 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.075 | acc=1.0000 | 4631.2 samples/s | 72.4 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00015 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.076 | acc=1.0000 | 4779.1 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27750 | acc=0.8592 | tpr=0.7974 | fpr=0.0064 | 4625.0 samples/s | 18.1 steps/s
Avg test loss: 0.28273, Avg test acc: 0.85984, Avg tpr: 0.79938, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.38986 | acc=0.8941 | tpr=0.9602 | fpr=0.1071 | 4595.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.40281 | acc=0.8922 | tpr=0.9723 | fpr=0.1093 | 8659.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.41201 | acc=0.8906 | tpr=0.9755 | fpr=0.1110 | 8792.7 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.41634 | acc=0.8913 | tpr=0.9792 | fpr=0.1103 | 8915.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.41574 | acc=0.8909 | tpr=0.9790 | fpr=0.1107 | 8970.4 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.41952 | acc=0.8906 | tpr=0.9796 | fpr=0.1111 | 8752.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.42022 | acc=0.8901 | tpr=0.9768 | fpr=0.1115 | 8462.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.42054 | acc=0.8898 | tpr=0.9754 | fpr=0.1118 | 8955.4 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.42515 | acc=0.8894 | tpr=0.9742 | fpr=0.1121 | 8720.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.42467 | acc=0.8892 | tpr=0.9740 | fpr=0.1124 | 8548.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.42145 | acc=0.8897 | tpr=0.9729 | fpr=0.1118 | 16324.5 samples/s | 63.8 steps/s
Avg test loss: 0.42182, Avg test acc: 0.88964, Avg tpr: 0.97266, Avg fpr: 0.11187, total FA: 15533

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.12617 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.084 | acc=0.9062 | 4070.2 samples/s | 63.6 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02115 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.079 | acc=1.0000 | 4847.0 samples/s | 75.7 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01401 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.080 | acc=1.0000 | 4886.7 samples/s | 76.4 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01163 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.082 | acc=1.0000 | 4954.1 samples/s | 77.4 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01121 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.084 | acc=0.9688 | 4884.6 samples/s | 76.3 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01029 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.086 | acc=1.0000 | 4978.6 samples/s | 77.8 steps/s
[Step=27500 Epoch=26.8] | Loss=0.00999 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.088 | acc=1.0000 | 4968.2 samples/s | 77.6 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00967 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=3.090 | acc=1.0000 | 4927.0 samples/s | 77.0 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00925 | Reg=0.00210 | L2-Norm=14.500 | L2-Norm(final)=3.091 | acc=1.0000 | 5009.4 samples/s | 78.3 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00905 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=3.093 | acc=1.0000 | 5002.1 samples/s | 78.2 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00902 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.095 | acc=1.0000 | 4947.7 samples/s | 77.3 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00896 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=3.096 | acc=1.0000 | 4959.5 samples/s | 77.5 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00889 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.098 | acc=1.0000 | 4961.0 samples/s | 77.5 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00878 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.099 | acc=0.9844 | 4956.0 samples/s | 77.4 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00866 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=3.100 | acc=0.9531 | 4901.2 samples/s | 76.6 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00852 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.102 | acc=0.9844 | 4949.1 samples/s | 77.3 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00854 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.103 | acc=1.0000 | 4960.9 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.01916 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.084 | acc=0.9844 | 3999.8 samples/s | 62.5 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00614 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.086 | acc=1.0000 | 4412.2 samples/s | 68.9 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00311 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.085 | acc=1.0000 | 4694.7 samples/s | 73.4 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00209 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.085 | acc=1.0000 | 4715.6 samples/s | 73.7 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00158 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=3.086 | acc=1.0000 | 4641.7 samples/s | 72.5 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00127 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.087 | acc=1.0000 | 4702.2 samples/s | 73.5 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00106 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.087 | acc=1.0000 | 4695.6 samples/s | 73.4 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00091 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=3.088 | acc=1.0000 | 4701.5 samples/s | 73.5 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00080 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=3.088 | acc=1.0000 | 4714.8 samples/s | 73.7 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00071 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.089 | acc=1.0000 | 4676.8 samples/s | 73.1 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00064 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.089 | acc=1.0000 | 4736.7 samples/s | 74.0 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00059 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.089 | acc=1.0000 | 2089.0 samples/s | 32.6 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00054 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.090 | acc=1.0000 | 4611.0 samples/s | 72.0 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00050 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.090 | acc=1.0000 | 4709.6 samples/s | 73.6 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00046 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=3.090 | acc=1.0000 | 4731.1 samples/s | 73.9 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00043 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.091 | acc=1.0000 | 4724.2 samples/s | 73.8 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00041 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.091 | acc=1.0000 | 4699.6 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22538 | acc=0.8833 | tpr=0.8343 | fpr=0.0104 | 4493.4 samples/s | 17.6 steps/s
Avg test loss: 0.22968, Avg test acc: 0.88360, Avg tpr: 0.83564, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.42751 | acc=0.8878 | tpr=0.9646 | fpr=0.1136 | 4727.1 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.44257 | acc=0.8865 | tpr=0.9744 | fpr=0.1151 | 8162.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.45300 | acc=0.8851 | tpr=0.9784 | fpr=0.1166 | 8893.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.45732 | acc=0.8855 | tpr=0.9814 | fpr=0.1163 | 8673.7 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.45713 | acc=0.8851 | tpr=0.9799 | fpr=0.1166 | 8678.9 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.46138 | acc=0.8850 | tpr=0.9804 | fpr=0.1168 | 8846.6 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.46228 | acc=0.8845 | tpr=0.9781 | fpr=0.1172 | 8570.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.46243 | acc=0.8841 | tpr=0.9781 | fpr=0.1176 | 8791.2 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.46760 | acc=0.8836 | tpr=0.9771 | fpr=0.1181 | 8802.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.46680 | acc=0.8833 | tpr=0.9767 | fpr=0.1184 | 8654.0 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.46353 | acc=0.8838 | tpr=0.9753 | fpr=0.1178 | 15756.9 samples/s | 61.6 steps/s
Avg test loss: 0.46367, Avg test acc: 0.88380, Avg tpr: 0.97504, Avg fpr: 0.11786, total FA: 16364

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.16270 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.106 | acc=0.8594 | 4071.7 samples/s | 63.6 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01636 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.103 | acc=1.0000 | 4676.2 samples/s | 73.1 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01190 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.105 | acc=0.9844 | 4904.1 samples/s | 76.6 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01037 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.107 | acc=1.0000 | 4952.8 samples/s | 77.4 steps/s
[Step=28200 Epoch=27.5] | Loss=0.00955 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.109 | acc=1.0000 | 4923.0 samples/s | 76.9 steps/s
[Step=28250 Epoch=27.6] | Loss=0.00935 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.111 | acc=0.9688 | 5000.7 samples/s | 78.1 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00928 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.113 | acc=1.0000 | 4925.0 samples/s | 77.0 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00896 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.114 | acc=0.9688 | 5084.0 samples/s | 79.4 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00864 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.115 | acc=1.0000 | 4899.2 samples/s | 76.6 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00828 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.117 | acc=1.0000 | 4935.0 samples/s | 77.1 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00847 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.118 | acc=1.0000 | 4985.2 samples/s | 77.9 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00837 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.119 | acc=0.9844 | 4908.2 samples/s | 76.7 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00815 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.121 | acc=0.9844 | 4951.7 samples/s | 77.4 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00813 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.122 | acc=0.9844 | 4932.1 samples/s | 77.1 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00832 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.123 | acc=0.9844 | 4982.5 samples/s | 77.9 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00826 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.125 | acc=1.0000 | 4935.0 samples/s | 77.1 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00818 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.126 | acc=0.9375 | 4969.3 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.02981 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.107 | acc=0.9688 | 4462.7 samples/s | 69.7 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00270 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.118 | acc=1.0000 | 4238.7 samples/s | 66.2 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00136 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.120 | acc=1.0000 | 4733.0 samples/s | 74.0 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00091 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.121 | acc=1.0000 | 4761.2 samples/s | 74.4 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00068 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.121 | acc=1.0000 | 4716.1 samples/s | 73.7 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00055 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.122 | acc=1.0000 | 4710.0 samples/s | 73.6 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00046 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.122 | acc=1.0000 | 4776.1 samples/s | 74.6 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00040 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.122 | acc=1.0000 | 4757.0 samples/s | 74.3 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00035 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.122 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00031 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.123 | acc=1.0000 | 4697.9 samples/s | 73.4 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00028 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.123 | acc=1.0000 | 4791.6 samples/s | 74.9 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00026 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.123 | acc=1.0000 | 2052.7 samples/s | 32.1 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.123 | acc=1.0000 | 4814.8 samples/s | 75.2 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00022 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.124 | acc=1.0000 | 4827.9 samples/s | 75.4 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00020 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.124 | acc=1.0000 | 4633.9 samples/s | 72.4 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00019 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.124 | acc=1.0000 | 4739.7 samples/s | 74.1 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00018 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.124 | acc=1.0000 | 4747.8 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26027 | acc=0.8658 | tpr=0.8083 | fpr=0.0094 | 4564.0 samples/s | 17.8 steps/s
Avg test loss: 0.26448, Avg test acc: 0.86630, Avg tpr: 0.81005, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.36159 | acc=0.9082 | tpr=0.9602 | fpr=0.0927 | 4631.8 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.37396 | acc=0.9070 | tpr=0.9723 | fpr=0.0942 | 8553.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.38447 | acc=0.9056 | tpr=0.9755 | fpr=0.0957 | 8849.2 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.38920 | acc=0.9059 | tpr=0.9792 | fpr=0.0955 | 8991.4 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.38821 | acc=0.9055 | tpr=0.9782 | fpr=0.0958 | 8804.6 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.39257 | acc=0.9049 | tpr=0.9789 | fpr=0.0965 | 8640.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.39339 | acc=0.9046 | tpr=0.9775 | fpr=0.0967 | 8838.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.39357 | acc=0.9044 | tpr=0.9765 | fpr=0.0969 | 8685.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.39816 | acc=0.9041 | tpr=0.9757 | fpr=0.0972 | 8738.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.39717 | acc=0.9041 | tpr=0.9753 | fpr=0.0972 | 8742.1 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.39400 | acc=0.9046 | tpr=0.9741 | fpr=0.0967 | 15971.2 samples/s | 62.4 steps/s
Avg test loss: 0.39407, Avg test acc: 0.90462, Avg tpr: 0.97385, Avg fpr: 0.09664, total FA: 13418

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.15245 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.133 | acc=0.8906 | 3932.6 samples/s | 61.4 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02286 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.122 | acc=0.9844 | 4915.4 samples/s | 76.8 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01618 | Reg=0.00209 | L2-Norm=14.474 | L2-Norm(final)=3.122 | acc=1.0000 | 4937.8 samples/s | 77.2 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01314 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.124 | acc=1.0000 | 5050.4 samples/s | 78.9 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01148 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.127 | acc=0.9844 | 4880.7 samples/s | 76.3 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01071 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.129 | acc=1.0000 | 4944.0 samples/s | 77.2 steps/s
[Step=29100 Epoch=28.4] | Loss=0.01003 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.131 | acc=0.9844 | 4975.5 samples/s | 77.7 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00965 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.133 | acc=1.0000 | 5024.8 samples/s | 78.5 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00952 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.135 | acc=0.9844 | 4992.2 samples/s | 78.0 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00925 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.136 | acc=0.9844 | 5092.4 samples/s | 79.6 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00904 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.138 | acc=0.9844 | 4912.6 samples/s | 76.8 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00868 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.140 | acc=0.9844 | 4993.3 samples/s | 78.0 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00862 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.142 | acc=0.9844 | 5028.4 samples/s | 78.6 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00870 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.143 | acc=0.9844 | 4953.6 samples/s | 77.4 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00873 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.145 | acc=1.0000 | 4934.3 samples/s | 77.1 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00866 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.146 | acc=1.0000 | 4939.2 samples/s | 77.2 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00868 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.148 | acc=0.9844 | 5041.5 samples/s | 78.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.01055 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.134 | acc=0.9844 | 4303.8 samples/s | 67.2 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00433 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.138 | acc=1.0000 | 4276.8 samples/s | 66.8 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00227 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.140 | acc=1.0000 | 4719.6 samples/s | 73.7 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00152 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.140 | acc=1.0000 | 4669.3 samples/s | 73.0 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00115 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.141 | acc=1.0000 | 4761.3 samples/s | 74.4 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00093 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.141 | acc=1.0000 | 4738.4 samples/s | 74.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00077 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.142 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00067 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.143 | acc=1.0000 | 4775.1 samples/s | 74.6 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00058 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.144 | acc=1.0000 | 4666.0 samples/s | 72.9 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00052 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.144 | acc=1.0000 | 4757.8 samples/s | 74.3 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00047 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.145 | acc=1.0000 | 4806.3 samples/s | 75.1 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00043 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.145 | acc=1.0000 | 2137.9 samples/s | 33.4 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.145 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00036 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.146 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00034 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=3.146 | acc=1.0000 | 4728.8 samples/s | 73.9 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=3.146 | acc=1.0000 | 4707.3 samples/s | 73.6 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00029 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.147 | acc=1.0000 | 4755.2 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28016 | acc=0.8566 | tpr=0.7940 | fpr=0.0077 | 4554.8 samples/s | 17.8 steps/s
Avg test loss: 0.28540, Avg test acc: 0.85588, Avg tpr: 0.79396, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.39246 | acc=0.9028 | tpr=0.9646 | fpr=0.0983 | 4693.0 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.40492 | acc=0.9008 | tpr=0.9765 | fpr=0.1006 | 8511.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.41594 | acc=0.8992 | tpr=0.9798 | fpr=0.1023 | 8492.5 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.42062 | acc=0.8997 | tpr=0.9836 | fpr=0.1018 | 8784.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.41872 | acc=0.8997 | tpr=0.9808 | fpr=0.1018 | 8877.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.42320 | acc=0.8993 | tpr=0.9804 | fpr=0.1022 | 8689.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.42431 | acc=0.8990 | tpr=0.9781 | fpr=0.1024 | 9191.3 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.42490 | acc=0.8988 | tpr=0.9781 | fpr=0.1027 | 8239.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.43031 | acc=0.8983 | tpr=0.9771 | fpr=0.1032 | 9090.4 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.42954 | acc=0.8981 | tpr=0.9762 | fpr=0.1034 | 8610.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.42636 | acc=0.8984 | tpr=0.9753 | fpr=0.1030 | 15936.3 samples/s | 62.3 steps/s
Avg test loss: 0.42643, Avg test acc: 0.89840, Avg tpr: 0.97504, Avg fpr: 0.10299, total FA: 14300

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.15146 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.157 | acc=0.9062 | 4168.1 samples/s | 65.1 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02676 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.148 | acc=0.9844 | 4729.4 samples/s | 73.9 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01801 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.148 | acc=1.0000 | 4972.3 samples/s | 77.7 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01407 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.149 | acc=1.0000 | 4988.8 samples/s | 78.0 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01242 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.152 | acc=1.0000 | 4990.3 samples/s | 78.0 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01127 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.154 | acc=1.0000 | 4946.4 samples/s | 77.3 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01049 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.156 | acc=1.0000 | 4953.7 samples/s | 77.4 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01013 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.157 | acc=0.9844 | 4906.0 samples/s | 76.7 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00980 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.159 | acc=0.9844 | 4970.2 samples/s | 77.7 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00969 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.161 | acc=1.0000 | 4979.2 samples/s | 77.8 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00966 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.162 | acc=0.9844 | 4908.9 samples/s | 76.7 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00935 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.163 | acc=1.0000 | 4988.0 samples/s | 77.9 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00919 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.165 | acc=1.0000 | 4989.8 samples/s | 78.0 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00895 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.166 | acc=1.0000 | 5016.9 samples/s | 78.4 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00877 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.168 | acc=0.9844 | 4950.0 samples/s | 77.3 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00875 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.170 | acc=1.0000 | 4998.6 samples/s | 78.1 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00864 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.171 | acc=1.0000 | 4928.5 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.01337 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.158 | acc=0.9844 | 4448.9 samples/s | 69.5 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00377 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=3.165 | acc=1.0000 | 4099.4 samples/s | 64.1 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00196 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.165 | acc=1.0000 | 4715.8 samples/s | 73.7 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00131 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.167 | acc=1.0000 | 4683.9 samples/s | 73.2 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00099 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.168 | acc=1.0000 | 4736.4 samples/s | 74.0 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00079 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=3.169 | acc=1.0000 | 4730.1 samples/s | 73.9 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00066 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.169 | acc=1.0000 | 4816.9 samples/s | 75.3 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00057 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.170 | acc=1.0000 | 4649.7 samples/s | 72.7 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00050 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.171 | acc=1.0000 | 4660.8 samples/s | 72.8 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00044 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=3.171 | acc=1.0000 | 4708.5 samples/s | 73.6 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00040 | Reg=0.00209 | L2-Norm=14.440 | L2-Norm(final)=3.171 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00036 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.172 | acc=1.0000 | 2056.0 samples/s | 32.1 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00033 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.172 | acc=1.0000 | 4715.2 samples/s | 73.7 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.173 | acc=1.0000 | 4785.7 samples/s | 74.8 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00029 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.173 | acc=1.0000 | 4713.1 samples/s | 73.6 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00027 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.173 | acc=1.0000 | 4699.2 samples/s | 73.4 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00025 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.173 | acc=1.0000 | 4698.4 samples/s | 73.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24359 | acc=0.8743 | tpr=0.8212 | fpr=0.0104 | 4613.8 samples/s | 18.0 steps/s
Avg test loss: 0.24764, Avg test acc: 0.87571, Avg tpr: 0.82386, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.43217 | acc=0.8923 | tpr=0.9646 | fpr=0.1090 | 4607.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.44537 | acc=0.8914 | tpr=0.9744 | fpr=0.1102 | 8740.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.45749 | acc=0.8896 | tpr=0.9784 | fpr=0.1120 | 8959.5 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.46134 | acc=0.8902 | tpr=0.9814 | fpr=0.1115 | 8661.1 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.45924 | acc=0.8903 | tpr=0.9808 | fpr=0.1114 | 8574.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.46416 | acc=0.8899 | tpr=0.9811 | fpr=0.1117 | 8747.3 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.46507 | acc=0.8896 | tpr=0.9793 | fpr=0.1120 | 9326.4 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.46540 | acc=0.8896 | tpr=0.9787 | fpr=0.1120 | 8243.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.47095 | acc=0.8894 | tpr=0.9781 | fpr=0.1122 | 9225.9 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.47021 | acc=0.8891 | tpr=0.9775 | fpr=0.1125 | 8388.3 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.46685 | acc=0.8894 | tpr=0.9765 | fpr=0.1122 | 15661.2 samples/s | 61.2 steps/s
Avg test loss: 0.46700, Avg test acc: 0.88936, Avg tpr: 0.97623, Avg fpr: 0.11222, total FA: 15581

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.13505 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.183 | acc=0.9062 | 4110.4 samples/s | 64.2 steps/s
[Step=30450 Epoch=29.7] | Loss=0.02094 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.180 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01465 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.181 | acc=1.0000 | 4903.0 samples/s | 76.6 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01225 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.184 | acc=1.0000 | 4953.4 samples/s | 77.4 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01075 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.186 | acc=1.0000 | 4887.5 samples/s | 76.4 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01010 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.188 | acc=1.0000 | 4928.3 samples/s | 77.0 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00965 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.190 | acc=0.9688 | 4904.1 samples/s | 76.6 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00940 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.191 | acc=1.0000 | 4954.1 samples/s | 77.4 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00908 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.193 | acc=1.0000 | 5082.2 samples/s | 79.4 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00891 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=3.194 | acc=0.9844 | 4872.1 samples/s | 76.1 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00888 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=3.195 | acc=0.9844 | 4966.8 samples/s | 77.6 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00881 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.197 | acc=1.0000 | 4935.7 samples/s | 77.1 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00872 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.198 | acc=1.0000 | 5010.1 samples/s | 78.3 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00860 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=3.199 | acc=1.0000 | 4978.3 samples/s | 77.8 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00862 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.201 | acc=1.0000 | 4940.3 samples/s | 77.2 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00840 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.202 | acc=1.0000 | 4995.2 samples/s | 78.1 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00836 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.203 | acc=1.0000 | 4975.7 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.00461 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.183 | acc=1.0000 | 4236.8 samples/s | 66.2 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00417 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.190 | acc=1.0000 | 4287.2 samples/s | 67.0 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00210 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.190 | acc=1.0000 | 4721.0 samples/s | 73.8 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00141 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.190 | acc=1.0000 | 4794.6 samples/s | 74.9 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00106 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.190 | acc=1.0000 | 4691.0 samples/s | 73.3 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00086 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.191 | acc=1.0000 | 4707.7 samples/s | 73.6 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00072 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.192 | acc=1.0000 | 4692.6 samples/s | 73.3 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00062 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.193 | acc=1.0000 | 4705.9 samples/s | 73.5 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00054 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.194 | acc=1.0000 | 4853.1 samples/s | 75.8 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00048 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.194 | acc=1.0000 | 4650.2 samples/s | 72.7 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00044 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.195 | acc=1.0000 | 4801.9 samples/s | 75.0 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00040 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.195 | acc=1.0000 | 2053.0 samples/s | 32.1 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00037 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.196 | acc=1.0000 | 4763.5 samples/s | 74.4 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00034 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=3.196 | acc=1.0000 | 4719.3 samples/s | 73.7 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=3.196 | acc=1.0000 | 4748.8 samples/s | 74.2 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00029 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=3.197 | acc=1.0000 | 4726.2 samples/s | 73.8 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.197 | acc=1.0000 | 4863.2 samples/s | 76.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29558 | acc=0.8529 | tpr=0.7888 | fpr=0.0079 | 4610.8 samples/s | 18.0 steps/s
Avg test loss: 0.30079, Avg test acc: 0.85460, Avg tpr: 0.79192, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.36084 | acc=0.9151 | tpr=0.9602 | fpr=0.0857 | 4604.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.37548 | acc=0.9121 | tpr=0.9723 | fpr=0.0890 | 8481.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.38728 | acc=0.9103 | tpr=0.9755 | fpr=0.0909 | 9128.6 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.39112 | acc=0.9106 | tpr=0.9792 | fpr=0.0907 | 8491.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.38973 | acc=0.9102 | tpr=0.9782 | fpr=0.0911 | 9296.6 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.39443 | acc=0.9098 | tpr=0.9782 | fpr=0.0915 | 8381.5 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.39528 | acc=0.9097 | tpr=0.9750 | fpr=0.0915 | 9171.8 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.39548 | acc=0.9096 | tpr=0.9754 | fpr=0.0916 | 8429.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.40082 | acc=0.9090 | tpr=0.9747 | fpr=0.0922 | 8459.6 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.39996 | acc=0.9089 | tpr=0.9740 | fpr=0.0922 | 8945.5 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.39700 | acc=0.9093 | tpr=0.9725 | fpr=0.0919 | 15806.7 samples/s | 61.7 steps/s
Avg test loss: 0.39710, Avg test acc: 0.90930, Avg tpr: 0.97227, Avg fpr: 0.09184, total FA: 12752

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.08303 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.210 | acc=0.9219 | 4059.5 samples/s | 63.4 steps/s
[Step=31250 Epoch=30.5] | Loss=0.02066 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=3.203 | acc=1.0000 | 4374.6 samples/s | 68.4 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01418 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.204 | acc=1.0000 | 4967.8 samples/s | 77.6 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01172 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.206 | acc=1.0000 | 4985.9 samples/s | 77.9 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01018 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.208 | acc=1.0000 | 4985.2 samples/s | 77.9 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00970 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.210 | acc=0.9844 | 5055.8 samples/s | 79.0 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00943 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.212 | acc=1.0000 | 4958.7 samples/s | 77.5 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00922 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.214 | acc=0.9844 | 4970.2 samples/s | 77.7 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00906 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.215 | acc=1.0000 | 4992.7 samples/s | 78.0 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00882 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.216 | acc=1.0000 | 4884.6 samples/s | 76.3 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00873 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.217 | acc=1.0000 | 4945.3 samples/s | 77.3 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00875 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.219 | acc=0.9844 | 4978.9 samples/s | 77.8 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00849 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.220 | acc=1.0000 | 4954.5 samples/s | 77.4 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00852 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.221 | acc=0.9844 | 4801.1 samples/s | 75.0 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00837 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.222 | acc=0.9844 | 4968.8 samples/s | 77.6 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00823 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.224 | acc=0.9844 | 4996.3 samples/s | 78.1 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00817 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.225 | acc=0.9844 | 4962.5 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.08153 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.211 | acc=0.9531 | 4031.6 samples/s | 63.0 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00483 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.221 | acc=1.0000 | 4587.7 samples/s | 71.7 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00243 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=3.220 | acc=1.0000 | 4747.9 samples/s | 74.2 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00162 | Reg=0.00209 | L2-Norm=14.440 | L2-Norm(final)=3.220 | acc=1.0000 | 4712.7 samples/s | 73.6 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00122 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=3.220 | acc=1.0000 | 4815.1 samples/s | 75.2 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00098 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.220 | acc=1.0000 | 4682.2 samples/s | 73.2 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00082 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.220 | acc=1.0000 | 4775.0 samples/s | 74.6 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00070 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.220 | acc=1.0000 | 4759.9 samples/s | 74.4 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00061 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.220 | acc=1.0000 | 4819.8 samples/s | 75.3 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00055 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.220 | acc=1.0000 | 4698.0 samples/s | 73.4 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00049 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.220 | acc=1.0000 | 4845.5 samples/s | 75.7 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00045 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.220 | acc=1.0000 | 2101.9 samples/s | 32.8 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00041 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=3.220 | acc=1.0000 | 4768.6 samples/s | 74.5 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00038 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.221 | acc=1.0000 | 4830.6 samples/s | 75.5 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00035 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.221 | acc=1.0000 | 4603.2 samples/s | 71.9 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00033 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=3.221 | acc=1.0000 | 4699.2 samples/s | 73.4 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.221 | acc=1.0000 | 4745.3 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23027 | acc=0.8792 | tpr=0.8282 | fpr=0.0099 | 4554.2 samples/s | 17.8 steps/s
Avg test loss: 0.23638, Avg test acc: 0.87984, Avg tpr: 0.82992, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.40115 | acc=0.9056 | tpr=0.9646 | fpr=0.0954 | 4586.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.41698 | acc=0.9041 | tpr=0.9744 | fpr=0.0972 | 8629.5 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.42917 | acc=0.9023 | tpr=0.9784 | fpr=0.0991 | 8703.6 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.43404 | acc=0.9028 | tpr=0.9814 | fpr=0.0986 | 8733.3 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.43341 | acc=0.9023 | tpr=0.9799 | fpr=0.0991 | 8755.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.43869 | acc=0.9019 | tpr=0.9789 | fpr=0.0995 | 9140.6 samples/s | 35.7 steps/s
[Step= 350] | Loss=0.43973 | acc=0.9017 | tpr=0.9768 | fpr=0.0997 | 8484.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.44006 | acc=0.9013 | tpr=0.9776 | fpr=0.1001 | 8377.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.44563 | acc=0.9007 | tpr=0.9766 | fpr=0.1007 | 8694.3 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.44473 | acc=0.9007 | tpr=0.9758 | fpr=0.1006 | 9346.6 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.44151 | acc=0.9013 | tpr=0.9745 | fpr=0.1000 | 14320.4 samples/s | 55.9 steps/s
Avg test loss: 0.44158, Avg test acc: 0.90129, Avg tpr: 0.97425, Avg fpr: 0.10004, total FA: 13890

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.13848 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.232 | acc=0.9062 | 3810.9 samples/s | 59.5 steps/s
[Step=32050 Epoch=31.3] | Loss=0.01846 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.227 | acc=1.0000 | 4879.4 samples/s | 76.2 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01346 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.227 | acc=0.9844 | 4963.2 samples/s | 77.5 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01118 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=3.229 | acc=1.0000 | 4936.4 samples/s | 77.1 steps/s
[Step=32200 Epoch=31.4] | Loss=0.00970 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.230 | acc=1.0000 | 4963.7 samples/s | 77.6 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00908 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=3.232 | acc=1.0000 | 4999.7 samples/s | 78.1 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00857 | Reg=0.00207 | L2-Norm=14.405 | L2-Norm(final)=3.233 | acc=1.0000 | 4877.0 samples/s | 76.2 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00833 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=3.234 | acc=1.0000 | 4995.9 samples/s | 78.1 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00812 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.235 | acc=1.0000 | 5038.9 samples/s | 78.7 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00792 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.237 | acc=0.9844 | 4938.0 samples/s | 77.2 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00774 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.238 | acc=0.9844 | 4952.5 samples/s | 77.4 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00755 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.239 | acc=1.0000 | 5046.3 samples/s | 78.8 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00741 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.240 | acc=0.9844 | 4922.9 samples/s | 76.9 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00724 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.241 | acc=1.0000 | 4998.4 samples/s | 78.1 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00716 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.242 | acc=1.0000 | 4963.6 samples/s | 77.6 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00707 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.244 | acc=1.0000 | 4995.1 samples/s | 78.0 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00705 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.245 | acc=1.0000 | 4938.5 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.00287 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.233 | acc=1.0000 | 4036.3 samples/s | 63.1 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00464 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.241 | acc=1.0000 | 4380.9 samples/s | 68.5 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00234 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.243 | acc=1.0000 | 4757.3 samples/s | 74.3 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00156 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.244 | acc=1.0000 | 4678.1 samples/s | 73.1 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00118 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.244 | acc=1.0000 | 4737.4 samples/s | 74.0 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00095 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.244 | acc=1.0000 | 4671.2 samples/s | 73.0 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00080 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.245 | acc=1.0000 | 4732.8 samples/s | 73.9 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00068 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.245 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00060 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.245 | acc=1.0000 | 4709.6 samples/s | 73.6 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00053 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.246 | acc=1.0000 | 4790.6 samples/s | 74.9 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00048 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.246 | acc=1.0000 | 4768.5 samples/s | 74.5 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00044 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.246 | acc=1.0000 | 2054.8 samples/s | 32.1 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00040 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=3.246 | acc=1.0000 | 4800.2 samples/s | 75.0 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00037 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.246 | acc=1.0000 | 4747.2 samples/s | 74.2 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00035 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.246 | acc=1.0000 | 4389.0 samples/s | 68.6 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00032 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.246 | acc=1.0000 | 4633.3 samples/s | 72.4 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00030 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.247 | acc=1.0000 | 4801.2 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21011 | acc=0.8957 | tpr=0.8526 | fpr=0.0107 | 4579.4 samples/s | 17.9 steps/s
Avg test loss: 0.21679, Avg test acc: 0.89510, Avg tpr: 0.85236, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.44709 | acc=0.8964 | tpr=0.9558 | fpr=0.1047 | 4547.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.46423 | acc=0.8933 | tpr=0.9701 | fpr=0.1082 | 9005.8 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.47707 | acc=0.8916 | tpr=0.9726 | fpr=0.1098 | 8530.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.48170 | acc=0.8919 | tpr=0.9770 | fpr=0.1096 | 8879.3 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.48113 | acc=0.8916 | tpr=0.9764 | fpr=0.1100 | 8955.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.48639 | acc=0.8912 | tpr=0.9760 | fpr=0.1103 | 8457.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.48761 | acc=0.8908 | tpr=0.9737 | fpr=0.1107 | 9052.4 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.48795 | acc=0.8905 | tpr=0.9748 | fpr=0.1110 | 8767.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.49367 | acc=0.8901 | tpr=0.9732 | fpr=0.1114 | 8013.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.49280 | acc=0.8901 | tpr=0.9727 | fpr=0.1114 | 9136.7 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.48936 | acc=0.8905 | tpr=0.9717 | fpr=0.1110 | 15026.6 samples/s | 58.7 steps/s
Avg test loss: 0.48950, Avg test acc: 0.89052, Avg tpr: 0.97147, Avg fpr: 0.11096, total FA: 15406

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.14355 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.253 | acc=0.9219 | 3959.0 samples/s | 61.9 steps/s
[Step=32850 Epoch=32.1] | Loss=0.01700 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.250 | acc=1.0000 | 4969.7 samples/s | 77.7 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01139 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.250 | acc=1.0000 | 4875.6 samples/s | 76.2 steps/s
[Step=32950 Epoch=32.2] | Loss=0.00939 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=3.251 | acc=1.0000 | 4971.0 samples/s | 77.7 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00877 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.253 | acc=1.0000 | 4988.8 samples/s | 77.9 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00818 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.254 | acc=1.0000 | 4904.0 samples/s | 76.6 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00753 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.255 | acc=1.0000 | 4997.8 samples/s | 78.1 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00733 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.256 | acc=0.9844 | 5011.1 samples/s | 78.3 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00719 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.257 | acc=1.0000 | 4984.8 samples/s | 77.9 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00735 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.258 | acc=1.0000 | 4926.8 samples/s | 77.0 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00712 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.259 | acc=1.0000 | 4970.1 samples/s | 77.7 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00703 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.260 | acc=1.0000 | 4955.2 samples/s | 77.4 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00697 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.261 | acc=0.9844 | 5104.7 samples/s | 79.8 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00680 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.262 | acc=1.0000 | 4886.7 samples/s | 76.4 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00688 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.263 | acc=0.9844 | 5021.3 samples/s | 78.5 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00688 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.264 | acc=1.0000 | 4936.8 samples/s | 77.1 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00680 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.265 | acc=0.9844 | 4979.4 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.10848 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.254 | acc=0.9531 | 4030.6 samples/s | 63.0 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00474 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=3.263 | acc=1.0000 | 4341.0 samples/s | 67.8 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00239 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.264 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00162 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.265 | acc=1.0000 | 4519.3 samples/s | 70.6 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00122 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.265 | acc=1.0000 | 4494.1 samples/s | 70.2 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00099 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.266 | acc=1.0000 | 4537.5 samples/s | 70.9 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00082 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.266 | acc=1.0000 | 4672.5 samples/s | 73.0 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00071 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.267 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00062 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.267 | acc=1.0000 | 4635.2 samples/s | 72.4 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00055 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.267 | acc=1.0000 | 4708.6 samples/s | 73.6 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00050 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.267 | acc=1.0000 | 4787.6 samples/s | 74.8 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00045 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=3.268 | acc=1.0000 | 2062.0 samples/s | 32.2 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00042 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.268 | acc=1.0000 | 4812.9 samples/s | 75.2 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00039 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.268 | acc=1.0000 | 4701.9 samples/s | 73.5 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00036 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.268 | acc=1.0000 | 4662.5 samples/s | 72.9 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00034 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.268 | acc=1.0000 | 4666.3 samples/s | 72.9 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00032 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.268 | acc=1.0000 | 4727.5 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22457 | acc=0.8917 | tpr=0.8463 | fpr=0.0097 | 4595.1 samples/s | 17.9 steps/s
Avg test loss: 0.23144, Avg test acc: 0.89182, Avg tpr: 0.84706, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.43921 | acc=0.8995 | tpr=0.9558 | fpr=0.1015 | 4537.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.45520 | acc=0.8965 | tpr=0.9701 | fpr=0.1049 | 9113.9 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.46800 | acc=0.8946 | tpr=0.9726 | fpr=0.1069 | 8579.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.47238 | acc=0.8949 | tpr=0.9770 | fpr=0.1066 | 8754.2 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.47184 | acc=0.8945 | tpr=0.9755 | fpr=0.1069 | 9280.8 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.47706 | acc=0.8940 | tpr=0.9760 | fpr=0.1075 | 8331.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.47841 | acc=0.8936 | tpr=0.9731 | fpr=0.1079 | 8818.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.47868 | acc=0.8933 | tpr=0.9737 | fpr=0.1082 | 8494.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.48438 | acc=0.8930 | tpr=0.9727 | fpr=0.1085 | 8599.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.48345 | acc=0.8928 | tpr=0.9722 | fpr=0.1086 | 8822.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.47989 | acc=0.8933 | tpr=0.9713 | fpr=0.1081 | 15550.8 samples/s | 60.7 steps/s
Avg test loss: 0.48007, Avg test acc: 0.89328, Avg tpr: 0.97108, Avg fpr: 0.10813, total FA: 15014

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.06162 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.273 | acc=0.9219 | 3803.5 samples/s | 59.4 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01840 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.267 | acc=1.0000 | 4954.5 samples/s | 77.4 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01191 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.267 | acc=1.0000 | 4918.7 samples/s | 76.9 steps/s
[Step=33750 Epoch=33.0] | Loss=0.00972 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.268 | acc=0.9688 | 4947.5 samples/s | 77.3 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00885 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.269 | acc=0.9844 | 4917.3 samples/s | 76.8 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00834 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.270 | acc=0.9844 | 4878.1 samples/s | 76.2 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00779 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.271 | acc=1.0000 | 4980.6 samples/s | 77.8 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00744 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.272 | acc=1.0000 | 4948.3 samples/s | 77.3 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00717 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.273 | acc=1.0000 | 4968.6 samples/s | 77.6 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00698 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.274 | acc=1.0000 | 4951.7 samples/s | 77.4 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00694 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.275 | acc=1.0000 | 4961.2 samples/s | 77.5 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00683 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.276 | acc=1.0000 | 4954.3 samples/s | 77.4 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00693 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.277 | acc=0.9688 | 4960.8 samples/s | 77.5 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00685 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.278 | acc=0.9844 | 4961.8 samples/s | 77.5 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00672 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.279 | acc=1.0000 | 4943.9 samples/s | 77.2 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00658 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.280 | acc=1.0000 | 5014.7 samples/s | 78.4 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00657 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.281 | acc=0.9844 | 4914.6 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.00454 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.273 | acc=1.0000 | 4209.5 samples/s | 65.8 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00360 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.281 | acc=1.0000 | 4376.8 samples/s | 68.4 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00185 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.283 | acc=1.0000 | 4711.5 samples/s | 73.6 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00133 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.284 | acc=1.0000 | 4696.4 samples/s | 73.4 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00100 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.285 | acc=1.0000 | 4728.3 samples/s | 73.9 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00080 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.286 | acc=1.0000 | 4747.0 samples/s | 74.2 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00067 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.287 | acc=1.0000 | 4611.2 samples/s | 72.0 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00058 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.287 | acc=1.0000 | 4602.2 samples/s | 71.9 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00051 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.287 | acc=1.0000 | 4731.4 samples/s | 73.9 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00046 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.288 | acc=1.0000 | 4741.5 samples/s | 74.1 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00041 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.288 | acc=1.0000 | 4839.0 samples/s | 75.6 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00037 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.288 | acc=1.0000 | 2018.1 samples/s | 31.5 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00034 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.288 | acc=1.0000 | 4748.1 samples/s | 74.2 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00032 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=3.289 | acc=1.0000 | 4644.7 samples/s | 72.6 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00030 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.289 | acc=1.0000 | 4642.7 samples/s | 72.5 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00028 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.289 | acc=1.0000 | 4694.3 samples/s | 73.3 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00026 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.289 | acc=1.0000 | 4786.7 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22481 | acc=0.8918 | tpr=0.8463 | fpr=0.0094 | 4542.3 samples/s | 17.7 steps/s
Avg test loss: 0.23185, Avg test acc: 0.89186, Avg tpr: 0.84723, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.43301 | acc=0.9004 | tpr=0.9558 | fpr=0.1006 | 4600.7 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.44936 | acc=0.8973 | tpr=0.9701 | fpr=0.1040 | 8614.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.46235 | acc=0.8952 | tpr=0.9726 | fpr=0.1062 | 8839.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.46679 | acc=0.8958 | tpr=0.9770 | fpr=0.1057 | 9291.2 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.46589 | acc=0.8956 | tpr=0.9764 | fpr=0.1058 | 8112.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.47071 | acc=0.8952 | tpr=0.9767 | fpr=0.1063 | 8782.0 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.47188 | acc=0.8949 | tpr=0.9737 | fpr=0.1066 | 8822.8 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.47221 | acc=0.8945 | tpr=0.9743 | fpr=0.1070 | 8909.5 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.47808 | acc=0.8941 | tpr=0.9732 | fpr=0.1073 | 8791.2 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.47726 | acc=0.8939 | tpr=0.9727 | fpr=0.1075 | 8942.7 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.47400 | acc=0.8945 | tpr=0.9717 | fpr=0.1069 | 14995.9 samples/s | 58.6 steps/s
Avg test loss: 0.47422, Avg test acc: 0.89454, Avg tpr: 0.97147, Avg fpr: 0.10686, total FA: 14837

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.19765 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.290 | acc=0.8750 | 4163.2 samples/s | 65.1 steps/s
[Step=34450 Epoch=33.6] | Loss=0.01918 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=3.284 | acc=1.0000 | 4675.1 samples/s | 73.0 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01260 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.285 | acc=1.0000 | 4883.8 samples/s | 76.3 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01068 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.286 | acc=1.0000 | 4977.2 samples/s | 77.8 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00940 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.287 | acc=1.0000 | 4917.1 samples/s | 76.8 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00855 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.288 | acc=1.0000 | 4949.7 samples/s | 77.3 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00807 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.289 | acc=1.0000 | 4989.1 samples/s | 78.0 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00783 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.290 | acc=1.0000 | 4959.3 samples/s | 77.5 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00742 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.291 | acc=1.0000 | 4958.4 samples/s | 77.5 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00730 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.292 | acc=1.0000 | 5056.3 samples/s | 79.0 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00710 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.293 | acc=0.9688 | 4976.1 samples/s | 77.8 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00688 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.294 | acc=1.0000 | 4912.2 samples/s | 76.8 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00668 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.295 | acc=1.0000 | 4924.2 samples/s | 76.9 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00661 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.296 | acc=1.0000 | 5026.5 samples/s | 78.5 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00662 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.297 | acc=1.0000 | 4958.7 samples/s | 77.5 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00669 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.297 | acc=1.0000 | 5063.4 samples/s | 79.1 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00665 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.298 | acc=1.0000 | 4931.9 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.02808 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.291 | acc=0.9844 | 4015.2 samples/s | 62.7 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00544 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.299 | acc=1.0000 | 4428.0 samples/s | 69.2 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00274 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.300 | acc=1.0000 | 4754.4 samples/s | 74.3 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00183 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.301 | acc=1.0000 | 4680.8 samples/s | 73.1 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00138 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.301 | acc=1.0000 | 4702.4 samples/s | 73.5 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00110 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.301 | acc=1.0000 | 4697.6 samples/s | 73.4 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00092 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.301 | acc=1.0000 | 4776.1 samples/s | 74.6 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00079 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.301 | acc=1.0000 | 4717.9 samples/s | 73.7 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00069 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.302 | acc=1.0000 | 4699.6 samples/s | 73.4 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00062 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.302 | acc=1.0000 | 4812.1 samples/s | 75.2 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00056 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.302 | acc=1.0000 | 4743.0 samples/s | 74.1 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00051 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.302 | acc=1.0000 | 2033.6 samples/s | 31.8 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00047 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.302 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00043 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.302 | acc=1.0000 | 4750.4 samples/s | 74.2 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00040 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.302 | acc=1.0000 | 4660.1 samples/s | 72.8 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00038 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.303 | acc=1.0000 | 4713.5 samples/s | 73.6 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00035 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.303 | acc=1.0000 | 4767.9 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22847 | acc=0.8921 | tpr=0.8468 | fpr=0.0094 | 4588.1 samples/s | 17.9 steps/s
Avg test loss: 0.23579, Avg test acc: 0.89098, Avg tpr: 0.84595, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.41658 | acc=0.9054 | tpr=0.9558 | fpr=0.0955 | 4725.5 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.43160 | acc=0.9038 | tpr=0.9701 | fpr=0.0974 | 8419.8 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.44529 | acc=0.9017 | tpr=0.9726 | fpr=0.0996 | 9092.8 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.45001 | acc=0.9021 | tpr=0.9770 | fpr=0.0993 | 8461.4 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.44912 | acc=0.9018 | tpr=0.9764 | fpr=0.0995 | 8905.8 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.45409 | acc=0.9014 | tpr=0.9767 | fpr=0.0999 | 8809.8 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.45529 | acc=0.9011 | tpr=0.9737 | fpr=0.1002 | 8835.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.45572 | acc=0.9008 | tpr=0.9743 | fpr=0.1005 | 8699.6 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.46166 | acc=0.9005 | tpr=0.9732 | fpr=0.1008 | 8561.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.46087 | acc=0.9002 | tpr=0.9727 | fpr=0.1011 | 8856.1 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.45759 | acc=0.9007 | tpr=0.9717 | fpr=0.1006 | 15897.0 samples/s | 62.1 steps/s
Avg test loss: 0.45780, Avg test acc: 0.90067, Avg tpr: 0.97147, Avg fpr: 0.10061, total FA: 13970

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.08075 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.306 | acc=0.9375 | 4004.8 samples/s | 62.6 steps/s
[Step=35250 Epoch=34.4] | Loss=0.01499 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.301 | acc=1.0000 | 4965.6 samples/s | 77.6 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01070 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.301 | acc=1.0000 | 4948.3 samples/s | 77.3 steps/s
[Step=35350 Epoch=34.5] | Loss=0.00937 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.302 | acc=0.9844 | 5001.4 samples/s | 78.1 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00820 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.303 | acc=0.9844 | 4960.8 samples/s | 77.5 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00760 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.304 | acc=1.0000 | 4932.9 samples/s | 77.1 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00728 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.304 | acc=1.0000 | 4981.1 samples/s | 77.8 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00726 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.305 | acc=1.0000 | 4845.1 samples/s | 75.7 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00721 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.306 | acc=0.9844 | 4974.7 samples/s | 77.7 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00701 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.307 | acc=1.0000 | 4962.8 samples/s | 77.5 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00680 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.308 | acc=1.0000 | 4928.4 samples/s | 77.0 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00679 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.309 | acc=1.0000 | 4999.7 samples/s | 78.1 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00663 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.310 | acc=1.0000 | 4947.1 samples/s | 77.3 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00660 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.310 | acc=1.0000 | 4992.0 samples/s | 78.0 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00659 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.311 | acc=1.0000 | 4883.4 samples/s | 76.3 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00651 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.312 | acc=1.0000 | 4969.3 samples/s | 77.6 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00659 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.313 | acc=1.0000 | 4885.7 samples/s | 76.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.02670 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.306 | acc=0.9844 | 4974.0 samples/s | 77.7 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00564 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.317 | acc=1.0000 | 3861.9 samples/s | 60.3 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00283 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.319 | acc=1.0000 | 4679.7 samples/s | 73.1 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00190 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.320 | acc=1.0000 | 4757.1 samples/s | 74.3 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00142 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.320 | acc=1.0000 | 4655.4 samples/s | 72.7 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00114 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=3.321 | acc=1.0000 | 4697.6 samples/s | 73.4 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00095 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.321 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00082 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.321 | acc=1.0000 | 4740.5 samples/s | 74.1 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00072 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.321 | acc=1.0000 | 4729.7 samples/s | 73.9 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00064 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.321 | acc=1.0000 | 4730.9 samples/s | 73.9 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00058 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.321 | acc=1.0000 | 4842.8 samples/s | 75.7 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00052 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.321 | acc=1.0000 | 2068.1 samples/s | 32.3 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00048 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.322 | acc=1.0000 | 4834.0 samples/s | 75.5 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00044 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.322 | acc=1.0000 | 4668.2 samples/s | 72.9 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00041 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.322 | acc=1.0000 | 4688.3 samples/s | 73.3 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.322 | acc=1.0000 | 4710.0 samples/s | 73.6 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.322 | acc=1.0000 | 4705.2 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23436 | acc=0.8898 | tpr=0.8436 | fpr=0.0097 | 4474.7 samples/s | 17.5 steps/s
Avg test loss: 0.24190, Avg test acc: 0.88973, Avg tpr: 0.84438, Avg fpr: 0.01051, total FA: 82

Testing server on iccad2012
[Step=  50] | Loss=0.40826 | acc=0.9076 | tpr=0.9558 | fpr=0.0933 | 4568.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.42324 | acc=0.9066 | tpr=0.9701 | fpr=0.0946 | 9187.4 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.43731 | acc=0.9046 | tpr=0.9726 | fpr=0.0966 | 8759.7 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.44165 | acc=0.9051 | tpr=0.9770 | fpr=0.0962 | 8409.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.44065 | acc=0.9049 | tpr=0.9764 | fpr=0.0964 | 8899.0 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.44585 | acc=0.9043 | tpr=0.9767 | fpr=0.0971 | 8863.4 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.44685 | acc=0.9040 | tpr=0.9737 | fpr=0.0972 | 8697.8 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.44710 | acc=0.9037 | tpr=0.9743 | fpr=0.0976 | 8926.5 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.45301 | acc=0.9033 | tpr=0.9732 | fpr=0.0979 | 8675.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.45232 | acc=0.9031 | tpr=0.9727 | fpr=0.0982 | 8692.0 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.44907 | acc=0.9036 | tpr=0.9713 | fpr=0.0977 | 15809.0 samples/s | 61.8 steps/s
Avg test loss: 0.44925, Avg test acc: 0.90355, Avg tpr: 0.97108, Avg fpr: 0.09768, total FA: 13562

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.11813 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=3.323 | acc=0.9375 | 4338.1 samples/s | 67.8 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01492 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.316 | acc=1.0000 | 4533.4 samples/s | 70.8 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01031 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.317 | acc=1.0000 | 4880.3 samples/s | 76.3 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00844 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.318 | acc=1.0000 | 4836.3 samples/s | 75.6 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00818 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.319 | acc=0.9531 | 4962.8 samples/s | 77.5 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00781 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.320 | acc=1.0000 | 4950.5 samples/s | 77.4 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00755 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.321 | acc=0.9844 | 4993.8 samples/s | 78.0 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00724 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.322 | acc=1.0000 | 4941.6 samples/s | 77.2 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00702 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.323 | acc=1.0000 | 5033.1 samples/s | 78.6 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00703 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.324 | acc=0.9844 | 4901.5 samples/s | 76.6 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00696 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.325 | acc=0.9844 | 5004.3 samples/s | 78.2 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00686 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.326 | acc=1.0000 | 4904.4 samples/s | 76.6 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00682 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.327 | acc=1.0000 | 4880.1 samples/s | 76.3 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00669 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.328 | acc=1.0000 | 4896.6 samples/s | 76.5 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00658 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.329 | acc=0.9844 | 4993.6 samples/s | 78.0 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00654 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.330 | acc=1.0000 | 4941.4 samples/s | 77.2 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00646 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.331 | acc=1.0000 | 4887.0 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.05058 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=3.324 | acc=0.9688 | 3936.0 samples/s | 61.5 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00308 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.332 | acc=1.0000 | 4543.9 samples/s | 71.0 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00155 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.334 | acc=1.0000 | 4659.3 samples/s | 72.8 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00104 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.335 | acc=1.0000 | 4710.1 samples/s | 73.6 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00078 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.336 | acc=1.0000 | 4741.6 samples/s | 74.1 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00063 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.336 | acc=1.0000 | 4707.4 samples/s | 73.6 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00052 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.336 | acc=1.0000 | 4654.7 samples/s | 72.7 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00045 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.336 | acc=1.0000 | 4680.0 samples/s | 73.1 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.336 | acc=1.0000 | 4676.1 samples/s | 73.1 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00035 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.337 | acc=1.0000 | 4694.7 samples/s | 73.4 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00032 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.337 | acc=1.0000 | 4778.9 samples/s | 74.7 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.337 | acc=1.0000 | 2075.4 samples/s | 32.4 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00027 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.337 | acc=1.0000 | 4846.8 samples/s | 75.7 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00025 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.337 | acc=1.0000 | 4610.3 samples/s | 72.0 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00023 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.337 | acc=1.0000 | 4726.5 samples/s | 73.9 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00021 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.337 | acc=1.0000 | 4690.1 samples/s | 73.3 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00020 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.337 | acc=1.0000 | 4686.8 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21617 | acc=0.8995 | tpr=0.8582 | fpr=0.0107 | 4561.3 samples/s | 17.8 steps/s
Avg test loss: 0.22400, Avg test acc: 0.89851, Avg tpr: 0.85778, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.43228 | acc=0.9035 | tpr=0.9558 | fpr=0.0974 | 4567.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.44746 | acc=0.9020 | tpr=0.9701 | fpr=0.0993 | 8901.1 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.46113 | acc=0.9002 | tpr=0.9726 | fpr=0.1012 | 8842.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.46526 | acc=0.9008 | tpr=0.9770 | fpr=0.1006 | 8710.4 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.46435 | acc=0.9002 | tpr=0.9755 | fpr=0.1012 | 9227.2 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.46969 | acc=0.8997 | tpr=0.9760 | fpr=0.1017 | 8751.7 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.47086 | acc=0.8992 | tpr=0.9731 | fpr=0.1022 | 8730.9 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.47114 | acc=0.8989 | tpr=0.9737 | fpr=0.1024 | 8890.7 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.47698 | acc=0.8986 | tpr=0.9727 | fpr=0.1027 | 8846.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.47627 | acc=0.8984 | tpr=0.9722 | fpr=0.1029 | 8463.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.47292 | acc=0.8990 | tpr=0.9710 | fpr=0.1023 | 15853.9 samples/s | 61.9 steps/s
Avg test loss: 0.47309, Avg test acc: 0.89898, Avg tpr: 0.97068, Avg fpr: 0.10232, total FA: 14207

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.15752 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.341 | acc=0.9062 | 4030.9 samples/s | 63.0 steps/s
[Step=36850 Epoch=36.0] | Loss=0.01819 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.334 | acc=1.0000 | 4832.7 samples/s | 75.5 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01189 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.335 | acc=1.0000 | 4931.3 samples/s | 77.1 steps/s
[Step=36950 Epoch=36.1] | Loss=0.00995 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.335 | acc=1.0000 | 4859.0 samples/s | 75.9 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00860 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.336 | acc=1.0000 | 4901.3 samples/s | 76.6 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00804 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.337 | acc=1.0000 | 4969.7 samples/s | 77.7 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00772 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.338 | acc=1.0000 | 4978.9 samples/s | 77.8 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00767 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.339 | acc=0.9844 | 4954.5 samples/s | 77.4 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00729 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.340 | acc=1.0000 | 5010.1 samples/s | 78.3 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00717 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.341 | acc=1.0000 | 5010.3 samples/s | 78.3 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00698 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.342 | acc=1.0000 | 4962.7 samples/s | 77.5 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00697 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.342 | acc=0.9844 | 4981.2 samples/s | 77.8 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00695 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.343 | acc=0.9688 | 5001.5 samples/s | 78.1 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00689 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.344 | acc=1.0000 | 5069.6 samples/s | 79.2 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00666 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.345 | acc=1.0000 | 4949.6 samples/s | 77.3 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00656 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.346 | acc=0.9844 | 4970.3 samples/s | 77.7 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00649 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.347 | acc=0.9844 | 5056.7 samples/s | 79.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.02034 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.341 | acc=0.9844 | 4026.4 samples/s | 62.9 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00234 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.350 | acc=1.0000 | 4501.3 samples/s | 70.3 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00118 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=3.352 | acc=1.0000 | 4705.9 samples/s | 73.5 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00081 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.353 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00061 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.354 | acc=1.0000 | 4751.9 samples/s | 74.2 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00049 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.355 | acc=1.0000 | 4693.3 samples/s | 73.3 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00041 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=3.355 | acc=1.0000 | 4650.3 samples/s | 72.7 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.355 | acc=1.0000 | 4694.1 samples/s | 73.3 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00031 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.356 | acc=1.0000 | 4715.3 samples/s | 73.7 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00028 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.356 | acc=1.0000 | 4741.8 samples/s | 74.1 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00025 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.356 | acc=1.0000 | 4755.2 samples/s | 74.3 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00023 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.356 | acc=1.0000 | 2066.5 samples/s | 32.3 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00021 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.356 | acc=1.0000 | 4740.9 samples/s | 74.1 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00020 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=3.357 | acc=1.0000 | 4594.8 samples/s | 71.8 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00018 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=3.357 | acc=1.0000 | 4573.3 samples/s | 71.5 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00017 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.357 | acc=1.0000 | 4675.3 samples/s | 73.1 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00016 | Reg=0.00206 | L2-Norm=14.338 | L2-Norm(final)=3.357 | acc=1.0000 | 4693.7 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20953 | acc=0.9007 | tpr=0.8599 | fpr=0.0107 | 4596.5 samples/s | 18.0 steps/s
Avg test loss: 0.21790, Avg test acc: 0.89959, Avg tpr: 0.85930, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.42379 | acc=0.9048 | tpr=0.9558 | fpr=0.0961 | 4557.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.43900 | acc=0.9030 | tpr=0.9701 | fpr=0.0982 | 8869.4 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.45280 | acc=0.9005 | tpr=0.9741 | fpr=0.1009 | 9055.5 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.45715 | acc=0.9007 | tpr=0.9781 | fpr=0.1007 | 8449.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.45602 | acc=0.9005 | tpr=0.9773 | fpr=0.1009 | 8547.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.46125 | acc=0.8999 | tpr=0.9775 | fpr=0.1015 | 9583.3 samples/s | 37.4 steps/s
[Step= 350] | Loss=0.46227 | acc=0.8995 | tpr=0.9743 | fpr=0.1018 | 8167.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.46259 | acc=0.8993 | tpr=0.9748 | fpr=0.1021 | 9055.9 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.46843 | acc=0.8989 | tpr=0.9737 | fpr=0.1024 | 8438.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.46787 | acc=0.8985 | tpr=0.9731 | fpr=0.1028 | 5905.2 samples/s | 23.1 steps/s
[Step= 550] | Loss=0.46461 | acc=0.8990 | tpr=0.9717 | fpr=0.1023 | 16132.4 samples/s | 63.0 steps/s
Avg test loss: 0.46481, Avg test acc: 0.89903, Avg tpr: 0.97147, Avg fpr: 0.10229, total FA: 14203

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.07326 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.359 | acc=0.9219 | 3868.0 samples/s | 60.4 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01477 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.354 | acc=1.0000 | 4909.5 samples/s | 76.7 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01003 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.354 | acc=1.0000 | 4875.0 samples/s | 76.2 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00879 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=3.355 | acc=1.0000 | 5004.9 samples/s | 78.2 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00771 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.355 | acc=0.9844 | 4940.0 samples/s | 77.2 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00696 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.356 | acc=1.0000 | 5008.6 samples/s | 78.3 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00678 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.357 | acc=1.0000 | 5008.7 samples/s | 78.3 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00651 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.358 | acc=1.0000 | 4982.4 samples/s | 77.8 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00648 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.359 | acc=0.9844 | 4965.4 samples/s | 77.6 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00642 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.360 | acc=1.0000 | 4990.3 samples/s | 78.0 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00641 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.360 | acc=1.0000 | 5080.0 samples/s | 79.4 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00632 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.361 | acc=0.9844 | 4897.8 samples/s | 76.5 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00622 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.362 | acc=0.9844 | 4917.3 samples/s | 76.8 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00618 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.363 | acc=0.9844 | 4932.6 samples/s | 77.1 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00620 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.364 | acc=1.0000 | 4971.9 samples/s | 77.7 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00615 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.365 | acc=1.0000 | 4939.2 samples/s | 77.2 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00615 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.365 | acc=1.0000 | 4980.9 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.13333 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.359 | acc=0.9688 | 3773.5 samples/s | 59.0 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00548 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=3.366 | acc=1.0000 | 4634.3 samples/s | 72.4 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00275 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.368 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00184 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.369 | acc=1.0000 | 4783.7 samples/s | 74.7 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00138 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.369 | acc=1.0000 | 4668.3 samples/s | 72.9 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00111 | Reg=0.00206 | L2-Norm=14.338 | L2-Norm(final)=3.370 | acc=1.0000 | 4755.7 samples/s | 74.3 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00093 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=3.370 | acc=1.0000 | 4715.6 samples/s | 73.7 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00080 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.370 | acc=1.0000 | 4787.7 samples/s | 74.8 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00070 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=3.370 | acc=1.0000 | 4703.1 samples/s | 73.5 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00062 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.371 | acc=1.0000 | 4665.5 samples/s | 72.9 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00056 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.371 | acc=1.0000 | 4821.4 samples/s | 75.3 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00051 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.371 | acc=1.0000 | 2071.1 samples/s | 32.4 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00047 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.371 | acc=1.0000 | 4722.8 samples/s | 73.8 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00043 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.371 | acc=1.0000 | 4715.6 samples/s | 73.7 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00040 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.371 | acc=1.0000 | 4679.3 samples/s | 73.1 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00038 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.371 | acc=1.0000 | 4705.5 samples/s | 73.5 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.371 | acc=1.0000 | 4736.6 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20481 | acc=0.9023 | tpr=0.8624 | fpr=0.0109 | 4649.9 samples/s | 18.2 steps/s
Avg test loss: 0.21296, Avg test acc: 0.90147, Avg tpr: 0.86186, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.41512 | acc=0.9077 | tpr=0.9602 | fpr=0.0932 | 4542.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.43095 | acc=0.9056 | tpr=0.9723 | fpr=0.0957 | 8884.4 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.44386 | acc=0.9031 | tpr=0.9755 | fpr=0.0982 | 8905.5 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.44823 | acc=0.9033 | tpr=0.9792 | fpr=0.0981 | 8564.0 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.44668 | acc=0.9029 | tpr=0.9790 | fpr=0.0985 | 8652.1 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.45183 | acc=0.9026 | tpr=0.9789 | fpr=0.0988 | 9067.8 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.45315 | acc=0.9023 | tpr=0.9756 | fpr=0.0991 | 8962.0 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.45345 | acc=0.9018 | tpr=0.9759 | fpr=0.0995 | 8280.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.45924 | acc=0.9014 | tpr=0.9747 | fpr=0.1000 | 8006.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.45851 | acc=0.9012 | tpr=0.9740 | fpr=0.1001 | 8711.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.45530 | acc=0.9017 | tpr=0.9725 | fpr=0.0996 | 15843.9 samples/s | 61.9 steps/s
Avg test loss: 0.45545, Avg test acc: 0.90171, Avg tpr: 0.97227, Avg fpr: 0.09957, total FA: 13825

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.07554 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.374 | acc=0.9375 | 3955.4 samples/s | 61.8 steps/s
[Step=38450 Epoch=37.5] | Loss=0.01595 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.368 | acc=1.0000 | 4404.1 samples/s | 68.8 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01037 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.368 | acc=1.0000 | 4800.3 samples/s | 75.0 steps/s
[Step=38550 Epoch=37.6] | Loss=0.00861 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.369 | acc=1.0000 | 4900.9 samples/s | 76.6 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00755 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.370 | acc=1.0000 | 5006.3 samples/s | 78.2 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00674 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.371 | acc=1.0000 | 4945.7 samples/s | 77.3 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00659 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.372 | acc=1.0000 | 4935.1 samples/s | 77.1 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00643 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.373 | acc=1.0000 | 4948.6 samples/s | 77.3 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00634 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.374 | acc=0.9844 | 4986.4 samples/s | 77.9 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00626 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.375 | acc=1.0000 | 4955.2 samples/s | 77.4 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00620 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.375 | acc=1.0000 | 4916.0 samples/s | 76.8 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00614 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.376 | acc=1.0000 | 4946.0 samples/s | 77.3 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00612 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.377 | acc=0.9844 | 4952.0 samples/s | 77.4 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00619 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.378 | acc=0.9844 | 4929.7 samples/s | 77.0 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00624 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.379 | acc=0.9844 | 4960.7 samples/s | 77.5 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00616 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.379 | acc=1.0000 | 4907.2 samples/s | 76.7 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00607 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.380 | acc=1.0000 | 4940.0 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.00417 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.374 | acc=1.0000 | 4382.0 samples/s | 68.5 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00199 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.385 | acc=1.0000 | 4154.9 samples/s | 64.9 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00101 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.388 | acc=1.0000 | 4755.6 samples/s | 74.3 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00068 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.389 | acc=1.0000 | 4614.9 samples/s | 72.1 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00051 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.390 | acc=1.0000 | 4803.0 samples/s | 75.0 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00041 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.390 | acc=1.0000 | 4574.4 samples/s | 71.5 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.391 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00030 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.391 | acc=1.0000 | 4690.1 samples/s | 73.3 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00026 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.392 | acc=1.0000 | 4776.0 samples/s | 74.6 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.392 | acc=1.0000 | 4688.7 samples/s | 73.3 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.392 | acc=1.0000 | 4757.4 samples/s | 74.3 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00019 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.392 | acc=1.0000 | 2147.4 samples/s | 33.6 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00018 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.393 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00016 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.393 | acc=1.0000 | 4633.2 samples/s | 72.4 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00015 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.393 | acc=1.0000 | 4709.5 samples/s | 73.6 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00014 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.393 | acc=1.0000 | 4696.0 samples/s | 73.4 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00013 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.393 | acc=1.0000 | 4687.1 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21671 | acc=0.8980 | tpr=0.8557 | fpr=0.0102 | 4570.7 samples/s | 17.9 steps/s
Avg test loss: 0.22545, Avg test acc: 0.89687, Avg tpr: 0.85510, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.41010 | acc=0.9095 | tpr=0.9558 | fpr=0.0913 | 4583.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.42544 | acc=0.9082 | tpr=0.9701 | fpr=0.0929 | 8595.6 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.43865 | acc=0.9064 | tpr=0.9726 | fpr=0.0948 | 8621.1 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.44294 | acc=0.9064 | tpr=0.9770 | fpr=0.0949 | 9184.7 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.44130 | acc=0.9062 | tpr=0.9755 | fpr=0.0951 | 8521.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.44644 | acc=0.9057 | tpr=0.9760 | fpr=0.0956 | 9169.6 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.44774 | acc=0.9055 | tpr=0.9731 | fpr=0.0957 | 5126.2 samples/s | 20.0 steps/s
[Step= 400] | Loss=0.44804 | acc=0.9051 | tpr=0.9737 | fpr=0.0961 | 8699.6 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.45380 | acc=0.9048 | tpr=0.9727 | fpr=0.0964 | 8717.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.45291 | acc=0.9047 | tpr=0.9722 | fpr=0.0965 | 9410.4 samples/s | 36.8 steps/s
[Step= 550] | Loss=0.44972 | acc=0.9052 | tpr=0.9710 | fpr=0.0960 | 13045.3 samples/s | 51.0 steps/s
Avg test loss: 0.44991, Avg test acc: 0.90517, Avg tpr: 0.97068, Avg fpr: 0.09603, total FA: 13333

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.13492 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.393 | acc=0.9531 | 3995.4 samples/s | 62.4 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01418 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.388 | acc=0.9531 | 4685.0 samples/s | 73.2 steps/s
[Step=39300 Epoch=38.4] | Loss=0.00984 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.388 | acc=1.0000 | 4918.0 samples/s | 76.8 steps/s
[Step=39350 Epoch=38.4] | Loss=0.00861 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.389 | acc=0.9688 | 4888.0 samples/s | 76.4 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00790 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.390 | acc=0.9844 | 4934.5 samples/s | 77.1 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00757 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.391 | acc=1.0000 | 5000.2 samples/s | 78.1 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00713 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.391 | acc=1.0000 | 4926.6 samples/s | 77.0 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00674 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.392 | acc=0.9688 | 4898.3 samples/s | 76.5 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00663 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.393 | acc=1.0000 | 4965.8 samples/s | 77.6 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00659 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.394 | acc=0.9688 | 5039.1 samples/s | 78.7 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00656 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.395 | acc=1.0000 | 4885.2 samples/s | 76.3 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00651 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.396 | acc=0.9844 | 5000.6 samples/s | 78.1 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00636 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.396 | acc=1.0000 | 5044.4 samples/s | 78.8 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00626 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.397 | acc=0.9688 | 4898.8 samples/s | 76.5 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00630 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.398 | acc=0.9844 | 5050.1 samples/s | 78.9 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00624 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.399 | acc=0.9844 | 4899.2 samples/s | 76.6 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00614 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.399 | acc=1.0000 | 5020.5 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.02160 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.394 | acc=0.9844 | 4628.4 samples/s | 72.3 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00171 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.404 | acc=1.0000 | 4072.6 samples/s | 63.6 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00086 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.406 | acc=1.0000 | 4841.0 samples/s | 75.6 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00058 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.407 | acc=1.0000 | 4632.1 samples/s | 72.4 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00043 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.408 | acc=1.0000 | 4835.2 samples/s | 75.5 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.408 | acc=1.0000 | 4641.1 samples/s | 72.5 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00029 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.408 | acc=1.0000 | 4724.5 samples/s | 73.8 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.408 | acc=1.0000 | 4744.8 samples/s | 74.1 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00022 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.408 | acc=1.0000 | 4725.2 samples/s | 73.8 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00020 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.409 | acc=1.0000 | 4657.4 samples/s | 72.8 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00018 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.409 | acc=1.0000 | 4706.8 samples/s | 73.5 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00016 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.409 | acc=1.0000 | 2040.3 samples/s | 31.9 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00015 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.409 | acc=1.0000 | 4786.9 samples/s | 74.8 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00014 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.409 | acc=1.0000 | 4659.6 samples/s | 72.8 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00013 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.409 | acc=1.0000 | 4769.9 samples/s | 74.5 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00012 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.409 | acc=1.0000 | 4723.4 samples/s | 73.8 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00011 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.410 | acc=1.0000 | 4713.0 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22966 | acc=0.8933 | tpr=0.8486 | fpr=0.0097 | 4590.9 samples/s | 17.9 steps/s
Avg test loss: 0.23795, Avg test acc: 0.89210, Avg tpr: 0.84758, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.39945 | acc=0.9126 | tpr=0.9558 | fpr=0.0882 | 4555.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.41588 | acc=0.9112 | tpr=0.9701 | fpr=0.0899 | 8841.3 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.42929 | acc=0.9091 | tpr=0.9726 | fpr=0.0921 | 8808.8 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.43338 | acc=0.9097 | tpr=0.9770 | fpr=0.0915 | 8830.0 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.43188 | acc=0.9096 | tpr=0.9755 | fpr=0.0916 | 5273.8 samples/s | 20.6 steps/s
[Step= 300] | Loss=0.43685 | acc=0.9091 | tpr=0.9760 | fpr=0.0922 | 8652.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.43816 | acc=0.9086 | tpr=0.9731 | fpr=0.0926 | 8521.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.43841 | acc=0.9082 | tpr=0.9732 | fpr=0.0930 | 8940.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.44430 | acc=0.9078 | tpr=0.9722 | fpr=0.0933 | 8111.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.44360 | acc=0.9077 | tpr=0.9718 | fpr=0.0935 | 8819.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.44036 | acc=0.9082 | tpr=0.9706 | fpr=0.0930 | 15809.3 samples/s | 61.8 steps/s
Avg test loss: 0.44058, Avg test acc: 0.90816, Avg tpr: 0.97029, Avg fpr: 0.09297, total FA: 12909
