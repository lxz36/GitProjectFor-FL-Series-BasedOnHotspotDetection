Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 29)
Resampled dataset to size (65551, 144, 29)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 29)
Resampled dataset to size (33952, 144, 29)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 29)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 29)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37026 | Reg=0.00358 | L2-Norm=18.915 | L2-Norm(final)=1.986 | acc=0.5312 | 2756.3 samples/s | 43.1 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29483 | Reg=0.00335 | L2-Norm=18.314 | L2-Norm(final)=1.978 | acc=0.8281 | 4925.8 samples/s | 77.0 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.24928 | Reg=0.00328 | L2-Norm=18.098 | L2-Norm(final)=1.986 | acc=0.8281 | 4765.5 samples/s | 74.5 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22421 | Reg=0.00323 | L2-Norm=17.971 | L2-Norm(final)=1.991 | acc=0.8594 | 4792.6 samples/s | 74.9 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20651 | Reg=0.00320 | L2-Norm=17.891 | L2-Norm(final)=1.998 | acc=0.9219 | 4801.3 samples/s | 75.0 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19030 | Reg=0.00318 | L2-Norm=17.836 | L2-Norm(final)=2.005 | acc=0.8906 | 4805.4 samples/s | 75.1 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.17782 | Reg=0.00317 | L2-Norm=17.793 | L2-Norm(final)=2.011 | acc=0.9375 | 4819.9 samples/s | 75.3 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.16924 | Reg=0.00315 | L2-Norm=17.758 | L2-Norm(final)=2.016 | acc=0.9375 | 4825.5 samples/s | 75.4 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16221 | Reg=0.00314 | L2-Norm=17.731 | L2-Norm(final)=2.021 | acc=0.8438 | 4776.0 samples/s | 74.6 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.15681 | Reg=0.00314 | L2-Norm=17.710 | L2-Norm(final)=2.026 | acc=0.9531 | 4800.4 samples/s | 75.0 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15004 | Reg=0.00313 | L2-Norm=17.692 | L2-Norm(final)=2.030 | acc=1.0000 | 4802.6 samples/s | 75.0 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14620 | Reg=0.00313 | L2-Norm=17.677 | L2-Norm(final)=2.034 | acc=0.9844 | 4789.5 samples/s | 74.8 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14292 | Reg=0.00312 | L2-Norm=17.664 | L2-Norm(final)=2.037 | acc=0.9375 | 4874.5 samples/s | 76.2 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.13882 | Reg=0.00312 | L2-Norm=17.654 | L2-Norm(final)=2.041 | acc=0.9531 | 4802.0 samples/s | 75.0 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13523 | Reg=0.00311 | L2-Norm=17.645 | L2-Norm(final)=2.044 | acc=0.9688 | 4892.1 samples/s | 76.4 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13163 | Reg=0.00311 | L2-Norm=17.638 | L2-Norm(final)=2.047 | acc=0.8281 | 4819.0 samples/s | 75.3 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12847 | Reg=0.00311 | L2-Norm=17.632 | L2-Norm(final)=2.050 | acc=0.9062 | 4724.8 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34526 | Reg=0.00358 | L2-Norm=18.915 | L2-Norm(final)=1.986 | acc=0.5625 | 3737.8 samples/s | 58.4 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.16640 | Reg=0.00339 | L2-Norm=18.416 | L2-Norm(final)=1.986 | acc=0.9688 | 4147.4 samples/s | 64.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.10704 | Reg=0.00334 | L2-Norm=18.261 | L2-Norm(final)=1.995 | acc=0.9531 | 4492.7 samples/s | 70.2 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.07989 | Reg=0.00330 | L2-Norm=18.153 | L2-Norm(final)=1.999 | acc=0.9844 | 4541.2 samples/s | 71.0 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06500 | Reg=0.00326 | L2-Norm=18.065 | L2-Norm(final)=2.003 | acc=0.9844 | 4588.4 samples/s | 71.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05557 | Reg=0.00324 | L2-Norm=17.989 | L2-Norm(final)=2.006 | acc=0.9688 | 4505.8 samples/s | 70.4 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.04923 | Reg=0.00321 | L2-Norm=17.921 | L2-Norm(final)=2.008 | acc=0.9844 | 4512.5 samples/s | 70.5 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04357 | Reg=0.00319 | L2-Norm=17.860 | L2-Norm(final)=2.010 | acc=1.0000 | 4565.8 samples/s | 71.3 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04006 | Reg=0.00317 | L2-Norm=17.804 | L2-Norm(final)=2.012 | acc=1.0000 | 4579.1 samples/s | 71.5 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03642 | Reg=0.00315 | L2-Norm=17.753 | L2-Norm(final)=2.013 | acc=0.9844 | 4558.6 samples/s | 71.2 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03367 | Reg=0.00314 | L2-Norm=17.706 | L2-Norm(final)=2.015 | acc=0.9844 | 4566.9 samples/s | 71.4 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03125 | Reg=0.00312 | L2-Norm=17.661 | L2-Norm(final)=2.016 | acc=1.0000 | 1897.4 samples/s | 29.6 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02898 | Reg=0.00311 | L2-Norm=17.618 | L2-Norm(final)=2.018 | acc=1.0000 | 4705.1 samples/s | 73.5 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02714 | Reg=0.00309 | L2-Norm=17.577 | L2-Norm(final)=2.020 | acc=1.0000 | 4427.8 samples/s | 69.2 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02548 | Reg=0.00308 | L2-Norm=17.539 | L2-Norm(final)=2.022 | acc=1.0000 | 4636.2 samples/s | 72.4 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02407 | Reg=0.00306 | L2-Norm=17.502 | L2-Norm(final)=2.023 | acc=1.0000 | 4526.9 samples/s | 70.7 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02284 | Reg=0.00305 | L2-Norm=17.465 | L2-Norm(final)=2.025 | acc=1.0000 | 4556.9 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32898 | acc=0.6249 | tpr=0.4928 | fpr=0.0882 | 3943.2 samples/s | 15.4 steps/s
Avg test loss: 0.33051, Avg test acc: 0.62293, Avg tpr: 0.49321, Avg fpr: 0.09178, total FA: 716

Testing server on iccad2012
[Step=  50] | Loss=0.27685 | acc=0.6952 | tpr=0.9646 | fpr=0.3097 | 3941.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.27692 | acc=0.6959 | tpr=0.9680 | fpr=0.3091 | 7602.4 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.27767 | acc=0.6957 | tpr=0.9712 | fpr=0.3094 | 7776.8 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.27714 | acc=0.6957 | tpr=0.9716 | fpr=0.3093 | 7474.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.27674 | acc=0.6959 | tpr=0.9659 | fpr=0.3090 | 7768.4 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.27636 | acc=0.6967 | tpr=0.9644 | fpr=0.3082 | 7867.1 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.27681 | acc=0.6966 | tpr=0.9662 | fpr=0.3083 | 7370.1 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.27721 | acc=0.6956 | tpr=0.9677 | fpr=0.3093 | 7832.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.27735 | acc=0.6953 | tpr=0.9688 | fpr=0.3096 | 7596.2 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.27762 | acc=0.6950 | tpr=0.9678 | fpr=0.3099 | 7494.1 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.27738 | acc=0.6959 | tpr=0.9682 | fpr=0.3090 | 13969.8 samples/s | 54.6 steps/s
Avg test loss: 0.27743, Avg test acc: 0.69594, Avg tpr: 0.96791, Avg fpr: 0.30901, total FA: 42905

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.31828 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.052 | acc=0.6406 | 3837.2 samples/s | 60.0 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.16495 | Reg=0.00275 | L2-Norm=16.570 | L2-Norm(final)=2.044 | acc=0.9062 | 4433.4 samples/s | 69.3 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13610 | Reg=0.00276 | L2-Norm=16.615 | L2-Norm(final)=2.059 | acc=0.9375 | 4717.1 samples/s | 73.7 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12422 | Reg=0.00277 | L2-Norm=16.638 | L2-Norm(final)=2.068 | acc=0.8906 | 4777.1 samples/s | 74.6 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11632 | Reg=0.00277 | L2-Norm=16.655 | L2-Norm(final)=2.077 | acc=0.9531 | 4770.7 samples/s | 74.5 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11140 | Reg=0.00278 | L2-Norm=16.669 | L2-Norm(final)=2.084 | acc=0.9531 | 4791.0 samples/s | 74.9 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10724 | Reg=0.00278 | L2-Norm=16.680 | L2-Norm(final)=2.089 | acc=0.9531 | 4828.8 samples/s | 75.4 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10390 | Reg=0.00279 | L2-Norm=16.691 | L2-Norm(final)=2.095 | acc=0.8594 | 4754.7 samples/s | 74.3 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10024 | Reg=0.00279 | L2-Norm=16.702 | L2-Norm(final)=2.099 | acc=0.9844 | 4723.4 samples/s | 73.8 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.09741 | Reg=0.00279 | L2-Norm=16.712 | L2-Norm(final)=2.103 | acc=0.9219 | 4880.5 samples/s | 76.3 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09486 | Reg=0.00280 | L2-Norm=16.723 | L2-Norm(final)=2.107 | acc=0.9531 | 4764.5 samples/s | 74.4 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09287 | Reg=0.00280 | L2-Norm=16.733 | L2-Norm(final)=2.110 | acc=0.9375 | 4756.2 samples/s | 74.3 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09087 | Reg=0.00280 | L2-Norm=16.743 | L2-Norm(final)=2.114 | acc=0.9688 | 4770.2 samples/s | 74.5 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.08981 | Reg=0.00281 | L2-Norm=16.754 | L2-Norm(final)=2.117 | acc=0.9688 | 4826.4 samples/s | 75.4 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.08806 | Reg=0.00281 | L2-Norm=16.763 | L2-Norm(final)=2.119 | acc=0.9375 | 4757.5 samples/s | 74.3 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08717 | Reg=0.00281 | L2-Norm=16.773 | L2-Norm(final)=2.122 | acc=0.9531 | 4782.4 samples/s | 74.7 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08629 | Reg=0.00282 | L2-Norm=16.784 | L2-Norm(final)=2.124 | acc=0.9688 | 4812.6 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.15011 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.052 | acc=0.8594 | 3693.5 samples/s | 57.7 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.03887 | Reg=0.00278 | L2-Norm=16.659 | L2-Norm(final)=2.064 | acc=0.9688 | 4061.5 samples/s | 63.5 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.02451 | Reg=0.00279 | L2-Norm=16.694 | L2-Norm(final)=2.063 | acc=1.0000 | 4570.6 samples/s | 71.4 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02025 | Reg=0.00278 | L2-Norm=16.688 | L2-Norm(final)=2.064 | acc=1.0000 | 4434.1 samples/s | 69.3 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01660 | Reg=0.00278 | L2-Norm=16.670 | L2-Norm(final)=2.066 | acc=1.0000 | 4526.2 samples/s | 70.7 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01429 | Reg=0.00277 | L2-Norm=16.647 | L2-Norm(final)=2.068 | acc=0.9844 | 4536.8 samples/s | 70.9 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01379 | Reg=0.00276 | L2-Norm=16.623 | L2-Norm(final)=2.070 | acc=0.9844 | 4432.8 samples/s | 69.3 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01252 | Reg=0.00276 | L2-Norm=16.602 | L2-Norm(final)=2.072 | acc=0.9844 | 4574.4 samples/s | 71.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01152 | Reg=0.00275 | L2-Norm=16.580 | L2-Norm(final)=2.074 | acc=0.9844 | 4521.8 samples/s | 70.7 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01059 | Reg=0.00274 | L2-Norm=16.559 | L2-Norm(final)=2.077 | acc=1.0000 | 4555.1 samples/s | 71.2 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00988 | Reg=0.00273 | L2-Norm=16.536 | L2-Norm(final)=2.079 | acc=1.0000 | 4615.5 samples/s | 72.1 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00954 | Reg=0.00273 | L2-Norm=16.513 | L2-Norm(final)=2.081 | acc=1.0000 | 1912.8 samples/s | 29.9 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00910 | Reg=0.00272 | L2-Norm=16.492 | L2-Norm(final)=2.082 | acc=1.0000 | 4512.8 samples/s | 70.5 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00863 | Reg=0.00271 | L2-Norm=16.471 | L2-Norm(final)=2.084 | acc=1.0000 | 4646.8 samples/s | 72.6 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00831 | Reg=0.00271 | L2-Norm=16.451 | L2-Norm(final)=2.085 | acc=1.0000 | 4437.4 samples/s | 69.3 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00783 | Reg=0.00270 | L2-Norm=16.431 | L2-Norm(final)=2.086 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00738 | Reg=0.00269 | L2-Norm=16.410 | L2-Norm(final)=2.088 | acc=1.0000 | 4575.2 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.53625 | acc=0.5230 | tpr=0.3163 | fpr=0.0282 | 3943.5 samples/s | 15.4 steps/s
Avg test loss: 0.53945, Avg test acc: 0.51711, Avg tpr: 0.31101, Avg fpr: 0.02961, total FA: 231

Testing server on iccad2012
[Step=  50] | Loss=0.16687 | acc=0.8706 | tpr=0.9690 | fpr=0.1311 | 3934.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.16570 | acc=0.8720 | tpr=0.9723 | fpr=0.1299 | 7732.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.16772 | acc=0.8715 | tpr=0.9741 | fpr=0.1304 | 7740.3 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.16698 | acc=0.8720 | tpr=0.9738 | fpr=0.1299 | 7673.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.16644 | acc=0.8729 | tpr=0.9738 | fpr=0.1290 | 7545.4 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.16689 | acc=0.8733 | tpr=0.9731 | fpr=0.1285 | 7598.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.16755 | acc=0.8730 | tpr=0.9743 | fpr=0.1289 | 7728.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.16801 | acc=0.8724 | tpr=0.9732 | fpr=0.1294 | 7577.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.16848 | acc=0.8724 | tpr=0.9727 | fpr=0.1294 | 7453.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.16869 | acc=0.8720 | tpr=0.9722 | fpr=0.1298 | 7764.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.16823 | acc=0.8725 | tpr=0.9725 | fpr=0.1293 | 14257.9 samples/s | 55.7 steps/s
Avg test loss: 0.16821, Avg test acc: 0.87261, Avg tpr: 0.97266, Avg fpr: 0.12921, total FA: 17940

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.36597 | Reg=0.00255 | L2-Norm=15.983 | L2-Norm(final)=2.117 | acc=0.6719 | 3835.7 samples/s | 59.9 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.13718 | Reg=0.00260 | L2-Norm=16.122 | L2-Norm(final)=2.116 | acc=0.8906 | 4214.4 samples/s | 65.9 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.11086 | Reg=0.00262 | L2-Norm=16.192 | L2-Norm(final)=2.131 | acc=0.9219 | 4800.7 samples/s | 75.0 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09863 | Reg=0.00263 | L2-Norm=16.228 | L2-Norm(final)=2.142 | acc=0.9062 | 4722.2 samples/s | 73.8 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09222 | Reg=0.00264 | L2-Norm=16.253 | L2-Norm(final)=2.150 | acc=0.9219 | 4810.3 samples/s | 75.2 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08773 | Reg=0.00265 | L2-Norm=16.273 | L2-Norm(final)=2.156 | acc=0.9219 | 4757.9 samples/s | 74.3 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08470 | Reg=0.00265 | L2-Norm=16.292 | L2-Norm(final)=2.161 | acc=0.8594 | 4787.4 samples/s | 74.8 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08178 | Reg=0.00266 | L2-Norm=16.308 | L2-Norm(final)=2.165 | acc=0.9219 | 4785.7 samples/s | 74.8 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07936 | Reg=0.00266 | L2-Norm=16.324 | L2-Norm(final)=2.168 | acc=0.9531 | 4784.1 samples/s | 74.8 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07768 | Reg=0.00267 | L2-Norm=16.340 | L2-Norm(final)=2.171 | acc=0.9375 | 4799.1 samples/s | 75.0 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07590 | Reg=0.00267 | L2-Norm=16.353 | L2-Norm(final)=2.173 | acc=0.9219 | 4814.2 samples/s | 75.2 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07600 | Reg=0.00268 | L2-Norm=16.366 | L2-Norm(final)=2.175 | acc=0.9844 | 4777.1 samples/s | 74.6 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07496 | Reg=0.00268 | L2-Norm=16.381 | L2-Norm(final)=2.177 | acc=0.8750 | 4794.7 samples/s | 74.9 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07395 | Reg=0.00269 | L2-Norm=16.395 | L2-Norm(final)=2.178 | acc=0.9375 | 4751.1 samples/s | 74.2 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07338 | Reg=0.00269 | L2-Norm=16.409 | L2-Norm(final)=2.180 | acc=0.9531 | 4568.0 samples/s | 71.4 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07267 | Reg=0.00270 | L2-Norm=16.422 | L2-Norm(final)=2.181 | acc=0.9375 | 4857.2 samples/s | 75.9 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07128 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.182 | acc=1.0000 | 4724.6 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.07589 | Reg=0.00255 | L2-Norm=15.983 | L2-Norm(final)=2.120 | acc=0.9531 | 3864.9 samples/s | 60.4 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.01669 | Reg=0.00259 | L2-Norm=16.108 | L2-Norm(final)=2.145 | acc=1.0000 | 3949.2 samples/s | 61.7 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01236 | Reg=0.00260 | L2-Norm=16.133 | L2-Norm(final)=2.147 | acc=1.0000 | 4490.3 samples/s | 70.2 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.00963 | Reg=0.00260 | L2-Norm=16.128 | L2-Norm(final)=2.150 | acc=1.0000 | 4584.3 samples/s | 71.6 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.00868 | Reg=0.00260 | L2-Norm=16.114 | L2-Norm(final)=2.150 | acc=1.0000 | 4434.1 samples/s | 69.3 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00812 | Reg=0.00259 | L2-Norm=16.096 | L2-Norm(final)=2.151 | acc=1.0000 | 4564.4 samples/s | 71.3 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00702 | Reg=0.00259 | L2-Norm=16.080 | L2-Norm(final)=2.152 | acc=1.0000 | 4532.3 samples/s | 70.8 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00669 | Reg=0.00258 | L2-Norm=16.063 | L2-Norm(final)=2.155 | acc=1.0000 | 4560.3 samples/s | 71.3 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00611 | Reg=0.00257 | L2-Norm=16.045 | L2-Norm(final)=2.156 | acc=1.0000 | 4545.4 samples/s | 71.0 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00563 | Reg=0.00257 | L2-Norm=16.027 | L2-Norm(final)=2.158 | acc=1.0000 | 4551.2 samples/s | 71.1 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00535 | Reg=0.00256 | L2-Norm=16.008 | L2-Norm(final)=2.161 | acc=1.0000 | 4661.5 samples/s | 72.8 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00509 | Reg=0.00256 | L2-Norm=15.990 | L2-Norm(final)=2.163 | acc=1.0000 | 1928.2 samples/s | 30.1 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00472 | Reg=0.00255 | L2-Norm=15.971 | L2-Norm(final)=2.164 | acc=1.0000 | 4641.1 samples/s | 72.5 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00442 | Reg=0.00254 | L2-Norm=15.952 | L2-Norm(final)=2.167 | acc=1.0000 | 4532.8 samples/s | 70.8 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00416 | Reg=0.00254 | L2-Norm=15.933 | L2-Norm(final)=2.169 | acc=1.0000 | 4454.3 samples/s | 69.6 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00450 | Reg=0.00253 | L2-Norm=15.915 | L2-Norm(final)=2.171 | acc=0.8750 | 4540.6 samples/s | 70.9 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00487 | Reg=0.00253 | L2-Norm=15.904 | L2-Norm(final)=2.171 | acc=1.0000 | 4463.9 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50298 | acc=0.5181 | tpr=0.3027 | fpr=0.0141 | 3916.0 samples/s | 15.3 steps/s
Avg test loss: 0.50603, Avg test acc: 0.51623, Avg tpr: 0.30303, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.15176 | acc=0.8843 | tpr=0.9646 | fpr=0.1171 | 3979.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.15061 | acc=0.8844 | tpr=0.9680 | fpr=0.1172 | 7695.8 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.15174 | acc=0.8839 | tpr=0.9697 | fpr=0.1177 | 7688.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.15154 | acc=0.8841 | tpr=0.9716 | fpr=0.1175 | 7490.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.15082 | acc=0.8847 | tpr=0.9729 | fpr=0.1170 | 7741.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.15110 | acc=0.8850 | tpr=0.9731 | fpr=0.1166 | 8370.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.15148 | acc=0.8846 | tpr=0.9712 | fpr=0.1170 | 7160.0 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.15186 | acc=0.8847 | tpr=0.9721 | fpr=0.1169 | 7778.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.15232 | acc=0.8846 | tpr=0.9722 | fpr=0.1170 | 7400.5 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.15251 | acc=0.8842 | tpr=0.9709 | fpr=0.1174 | 7464.8 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.15208 | acc=0.8849 | tpr=0.9725 | fpr=0.1167 | 14364.4 samples/s | 56.1 steps/s
Avg test loss: 0.15205, Avg test acc: 0.88486, Avg tpr: 0.97227, Avg fpr: 0.11672, total FA: 16207

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.48376 | Reg=0.00248 | L2-Norm=15.746 | L2-Norm(final)=2.168 | acc=0.5781 | 3930.6 samples/s | 61.4 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.12028 | Reg=0.00252 | L2-Norm=15.873 | L2-Norm(final)=2.170 | acc=0.9219 | 4460.4 samples/s | 69.7 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09479 | Reg=0.00254 | L2-Norm=15.934 | L2-Norm(final)=2.180 | acc=0.9219 | 4773.1 samples/s | 74.6 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.08618 | Reg=0.00255 | L2-Norm=15.969 | L2-Norm(final)=2.189 | acc=0.9531 | 4824.9 samples/s | 75.4 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.08021 | Reg=0.00256 | L2-Norm=15.993 | L2-Norm(final)=2.193 | acc=0.9531 | 4743.7 samples/s | 74.1 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07789 | Reg=0.00256 | L2-Norm=16.015 | L2-Norm(final)=2.198 | acc=0.9531 | 4767.3 samples/s | 74.5 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07405 | Reg=0.00257 | L2-Norm=16.036 | L2-Norm(final)=2.201 | acc=0.9688 | 4772.5 samples/s | 74.6 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.07158 | Reg=0.00258 | L2-Norm=16.055 | L2-Norm(final)=2.204 | acc=0.9688 | 4805.0 samples/s | 75.1 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.07036 | Reg=0.00258 | L2-Norm=16.074 | L2-Norm(final)=2.207 | acc=0.9688 | 4853.4 samples/s | 75.8 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06925 | Reg=0.00259 | L2-Norm=16.094 | L2-Norm(final)=2.209 | acc=0.9375 | 4721.8 samples/s | 73.8 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06810 | Reg=0.00260 | L2-Norm=16.111 | L2-Norm(final)=2.210 | acc=0.9062 | 4842.2 samples/s | 75.7 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06719 | Reg=0.00260 | L2-Norm=16.128 | L2-Norm(final)=2.211 | acc=1.0000 | 4751.3 samples/s | 74.2 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06675 | Reg=0.00261 | L2-Norm=16.144 | L2-Norm(final)=2.212 | acc=0.9844 | 4840.1 samples/s | 75.6 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06581 | Reg=0.00261 | L2-Norm=16.160 | L2-Norm(final)=2.214 | acc=0.9531 | 4804.5 samples/s | 75.1 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06527 | Reg=0.00262 | L2-Norm=16.176 | L2-Norm(final)=2.215 | acc=0.9531 | 4798.7 samples/s | 75.0 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06468 | Reg=0.00262 | L2-Norm=16.191 | L2-Norm(final)=2.215 | acc=0.9375 | 4837.9 samples/s | 75.6 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06359 | Reg=0.00263 | L2-Norm=16.206 | L2-Norm(final)=2.216 | acc=0.9531 | 4786.8 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.07443 | Reg=0.00248 | L2-Norm=15.746 | L2-Norm(final)=2.170 | acc=0.9375 | 3776.8 samples/s | 59.0 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01457 | Reg=0.00253 | L2-Norm=15.896 | L2-Norm(final)=2.190 | acc=0.9844 | 4094.1 samples/s | 64.0 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01108 | Reg=0.00254 | L2-Norm=15.935 | L2-Norm(final)=2.186 | acc=1.0000 | 4533.3 samples/s | 70.8 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00858 | Reg=0.00254 | L2-Norm=15.943 | L2-Norm(final)=2.186 | acc=1.0000 | 4527.4 samples/s | 70.7 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00726 | Reg=0.00254 | L2-Norm=15.934 | L2-Norm(final)=2.188 | acc=1.0000 | 4572.3 samples/s | 71.4 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00643 | Reg=0.00253 | L2-Norm=15.922 | L2-Norm(final)=2.190 | acc=1.0000 | 4571.3 samples/s | 71.4 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00691 | Reg=0.00253 | L2-Norm=15.910 | L2-Norm(final)=2.190 | acc=1.0000 | 4540.3 samples/s | 70.9 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00618 | Reg=0.00253 | L2-Norm=15.899 | L2-Norm(final)=2.191 | acc=0.9844 | 4572.6 samples/s | 71.4 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00560 | Reg=0.00252 | L2-Norm=15.885 | L2-Norm(final)=2.192 | acc=1.0000 | 4617.0 samples/s | 72.1 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00506 | Reg=0.00252 | L2-Norm=15.868 | L2-Norm(final)=2.194 | acc=1.0000 | 4428.3 samples/s | 69.2 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00469 | Reg=0.00251 | L2-Norm=15.850 | L2-Norm(final)=2.196 | acc=1.0000 | 4485.1 samples/s | 70.1 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00454 | Reg=0.00251 | L2-Norm=15.833 | L2-Norm(final)=2.198 | acc=1.0000 | 1916.9 samples/s | 30.0 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00425 | Reg=0.00250 | L2-Norm=15.816 | L2-Norm(final)=2.200 | acc=1.0000 | 4645.1 samples/s | 72.6 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00399 | Reg=0.00250 | L2-Norm=15.798 | L2-Norm(final)=2.202 | acc=1.0000 | 4468.2 samples/s | 69.8 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00376 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.204 | acc=1.0000 | 4499.8 samples/s | 70.3 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00356 | Reg=0.00248 | L2-Norm=15.760 | L2-Norm(final)=2.205 | acc=1.0000 | 4516.6 samples/s | 70.6 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00364 | Reg=0.00248 | L2-Norm=15.741 | L2-Norm(final)=2.207 | acc=1.0000 | 4541.7 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40097 | acc=0.6582 | tpr=0.5129 | fpr=0.0263 | 3904.5 samples/s | 15.3 steps/s
Avg test loss: 0.40435, Avg test acc: 0.65654, Avg tpr: 0.51250, Avg fpr: 0.02666, total FA: 208

Testing server on iccad2012
[Step=  50] | Loss=0.23379 | acc=0.8430 | tpr=0.9823 | fpr=0.1595 | 3914.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.23346 | acc=0.8454 | tpr=0.9829 | fpr=0.1572 | 7612.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.23574 | acc=0.8454 | tpr=0.9841 | fpr=0.1571 | 7812.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.23559 | acc=0.8455 | tpr=0.9869 | fpr=0.1570 | 7470.9 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.23444 | acc=0.8451 | tpr=0.9860 | fpr=0.1575 | 7987.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.23544 | acc=0.8455 | tpr=0.9833 | fpr=0.1570 | 7337.3 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.23662 | acc=0.8448 | tpr=0.9843 | fpr=0.1578 | 7864.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.23702 | acc=0.8445 | tpr=0.9841 | fpr=0.1580 | 7550.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.23797 | acc=0.8444 | tpr=0.9844 | fpr=0.1581 | 7614.6 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.23782 | acc=0.8445 | tpr=0.9837 | fpr=0.1581 | 7635.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.23698 | acc=0.8448 | tpr=0.9841 | fpr=0.1577 | 13827.5 samples/s | 54.0 steps/s
Avg test loss: 0.23686, Avg test acc: 0.84484, Avg tpr: 0.98415, Avg fpr: 0.15769, total FA: 21895

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.26070 | Reg=0.00242 | L2-Norm=15.563 | L2-Norm(final)=2.213 | acc=0.7344 | 4493.4 samples/s | 70.2 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.09189 | Reg=0.00245 | L2-Norm=15.652 | L2-Norm(final)=2.212 | acc=0.9375 | 3866.2 samples/s | 60.4 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.07346 | Reg=0.00247 | L2-Norm=15.712 | L2-Norm(final)=2.225 | acc=0.9219 | 4786.2 samples/s | 74.8 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07068 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.229 | acc=0.9531 | 4762.8 samples/s | 74.4 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.06789 | Reg=0.00250 | L2-Norm=15.797 | L2-Norm(final)=2.232 | acc=0.9844 | 4826.8 samples/s | 75.4 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06531 | Reg=0.00251 | L2-Norm=15.830 | L2-Norm(final)=2.233 | acc=0.9844 | 4753.7 samples/s | 74.3 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06286 | Reg=0.00252 | L2-Norm=15.860 | L2-Norm(final)=2.234 | acc=0.9219 | 4757.3 samples/s | 74.3 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06188 | Reg=0.00252 | L2-Norm=15.887 | L2-Norm(final)=2.235 | acc=0.9531 | 4809.7 samples/s | 75.2 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06021 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.237 | acc=0.9844 | 4811.6 samples/s | 75.2 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.05897 | Reg=0.00254 | L2-Norm=15.933 | L2-Norm(final)=2.238 | acc=0.9531 | 4779.7 samples/s | 74.7 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05846 | Reg=0.00255 | L2-Norm=15.954 | L2-Norm(final)=2.239 | acc=0.9531 | 4804.6 samples/s | 75.1 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05715 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.240 | acc=0.9844 | 4795.3 samples/s | 74.9 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05721 | Reg=0.00256 | L2-Norm=15.995 | L2-Norm(final)=2.241 | acc=0.9688 | 4775.7 samples/s | 74.6 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05620 | Reg=0.00257 | L2-Norm=16.015 | L2-Norm(final)=2.242 | acc=0.9688 | 4794.0 samples/s | 74.9 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05559 | Reg=0.00257 | L2-Norm=16.032 | L2-Norm(final)=2.243 | acc=0.9375 | 4811.6 samples/s | 75.2 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05549 | Reg=0.00258 | L2-Norm=16.050 | L2-Norm(final)=2.243 | acc=0.9844 | 4807.6 samples/s | 75.1 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05488 | Reg=0.00258 | L2-Norm=16.069 | L2-Norm(final)=2.243 | acc=0.9844 | 4831.5 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.02985 | Reg=0.00242 | L2-Norm=15.563 | L2-Norm(final)=2.215 | acc=0.9844 | 3844.4 samples/s | 60.1 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.02468 | Reg=0.00249 | L2-Norm=15.777 | L2-Norm(final)=2.202 | acc=1.0000 | 3911.3 samples/s | 61.1 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.01587 | Reg=0.00251 | L2-Norm=15.848 | L2-Norm(final)=2.205 | acc=1.0000 | 4569.7 samples/s | 71.4 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.01152 | Reg=0.00252 | L2-Norm=15.863 | L2-Norm(final)=2.206 | acc=1.0000 | 4469.8 samples/s | 69.8 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00888 | Reg=0.00252 | L2-Norm=15.859 | L2-Norm(final)=2.209 | acc=1.0000 | 4503.5 samples/s | 70.4 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00757 | Reg=0.00251 | L2-Norm=15.849 | L2-Norm(final)=2.212 | acc=1.0000 | 4518.5 samples/s | 70.6 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00657 | Reg=0.00251 | L2-Norm=15.834 | L2-Norm(final)=2.215 | acc=1.0000 | 4588.9 samples/s | 71.7 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00582 | Reg=0.00250 | L2-Norm=15.818 | L2-Norm(final)=2.218 | acc=1.0000 | 4519.2 samples/s | 70.6 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00536 | Reg=0.00250 | L2-Norm=15.802 | L2-Norm(final)=2.221 | acc=1.0000 | 4523.3 samples/s | 70.7 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00484 | Reg=0.00249 | L2-Norm=15.787 | L2-Norm(final)=2.224 | acc=1.0000 | 4599.5 samples/s | 71.9 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00466 | Reg=0.00249 | L2-Norm=15.771 | L2-Norm(final)=2.227 | acc=1.0000 | 4577.3 samples/s | 71.5 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00441 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.228 | acc=1.0000 | 1886.6 samples/s | 29.5 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00444 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.230 | acc=0.9688 | 4617.0 samples/s | 72.1 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00427 | Reg=0.00247 | L2-Norm=15.732 | L2-Norm(final)=2.230 | acc=1.0000 | 4507.2 samples/s | 70.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00410 | Reg=0.00247 | L2-Norm=15.721 | L2-Norm(final)=2.231 | acc=1.0000 | 4522.1 samples/s | 70.7 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00401 | Reg=0.00247 | L2-Norm=15.711 | L2-Norm(final)=2.232 | acc=1.0000 | 4548.7 samples/s | 71.1 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00385 | Reg=0.00247 | L2-Norm=15.701 | L2-Norm(final)=2.233 | acc=1.0000 | 4569.6 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55565 | acc=0.6078 | tpr=0.4383 | fpr=0.0240 | 3919.5 samples/s | 15.3 steps/s
Avg test loss: 0.56304, Avg test acc: 0.60522, Avg tpr: 0.43661, Avg fpr: 0.02397, total FA: 187

Testing server on iccad2012
[Step=  50] | Loss=0.13937 | acc=0.9127 | tpr=0.9735 | fpr=0.0884 | 3921.8 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.13944 | acc=0.9152 | tpr=0.9808 | fpr=0.0861 | 7662.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.14026 | acc=0.9155 | tpr=0.9841 | fpr=0.0858 | 7664.6 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.14074 | acc=0.9150 | tpr=0.9847 | fpr=0.0863 | 7639.4 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.13966 | acc=0.9153 | tpr=0.9825 | fpr=0.0860 | 7632.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.14071 | acc=0.9152 | tpr=0.9804 | fpr=0.0860 | 7625.7 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.14157 | acc=0.9148 | tpr=0.9818 | fpr=0.0864 | 7624.3 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.14216 | acc=0.9144 | tpr=0.9809 | fpr=0.0868 | 7957.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.14331 | acc=0.9141 | tpr=0.9810 | fpr=0.0871 | 7101.4 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.14317 | acc=0.9140 | tpr=0.9811 | fpr=0.0872 | 7634.2 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.14249 | acc=0.9145 | tpr=0.9809 | fpr=0.0867 | 13839.6 samples/s | 54.1 steps/s
Avg test loss: 0.14248, Avg test acc: 0.91449, Avg tpr: 0.98059, Avg fpr: 0.08671, total FA: 12040

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.53553 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.241 | acc=0.6875 | 3735.4 samples/s | 58.4 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.10283 | Reg=0.00246 | L2-Norm=15.684 | L2-Norm(final)=2.224 | acc=0.9688 | 4489.7 samples/s | 70.2 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.08149 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.237 | acc=0.9688 | 4754.8 samples/s | 74.3 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.07316 | Reg=0.00250 | L2-Norm=15.799 | L2-Norm(final)=2.241 | acc=0.9531 | 4743.6 samples/s | 74.1 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06683 | Reg=0.00251 | L2-Norm=15.831 | L2-Norm(final)=2.246 | acc=0.9531 | 4837.7 samples/s | 75.6 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06458 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.249 | acc=0.9844 | 4783.9 samples/s | 74.7 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06212 | Reg=0.00252 | L2-Norm=15.875 | L2-Norm(final)=2.250 | acc=1.0000 | 4777.8 samples/s | 74.7 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.05998 | Reg=0.00253 | L2-Norm=15.896 | L2-Norm(final)=2.251 | acc=1.0000 | 4854.6 samples/s | 75.9 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05907 | Reg=0.00253 | L2-Norm=15.919 | L2-Norm(final)=2.253 | acc=1.0000 | 4758.8 samples/s | 74.4 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05848 | Reg=0.00254 | L2-Norm=15.941 | L2-Norm(final)=2.253 | acc=0.9375 | 4806.8 samples/s | 75.1 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05769 | Reg=0.00255 | L2-Norm=15.961 | L2-Norm(final)=2.253 | acc=0.9844 | 4707.5 samples/s | 73.6 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05753 | Reg=0.00255 | L2-Norm=15.980 | L2-Norm(final)=2.253 | acc=0.9375 | 4786.1 samples/s | 74.8 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05704 | Reg=0.00256 | L2-Norm=15.999 | L2-Norm(final)=2.253 | acc=0.9375 | 4812.9 samples/s | 75.2 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05575 | Reg=0.00257 | L2-Norm=16.019 | L2-Norm(final)=2.254 | acc=0.9375 | 4771.6 samples/s | 74.6 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05496 | Reg=0.00257 | L2-Norm=16.038 | L2-Norm(final)=2.254 | acc=0.9531 | 4734.9 samples/s | 74.0 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05450 | Reg=0.00258 | L2-Norm=16.056 | L2-Norm(final)=2.255 | acc=0.9688 | 4855.4 samples/s | 75.9 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05416 | Reg=0.00258 | L2-Norm=16.074 | L2-Norm(final)=2.254 | acc=0.9844 | 4765.7 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.00954 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.245 | acc=1.0000 | 4132.8 samples/s | 64.6 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00748 | Reg=0.00243 | L2-Norm=15.604 | L2-Norm(final)=2.261 | acc=1.0000 | 4109.7 samples/s | 64.2 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00564 | Reg=0.00244 | L2-Norm=15.615 | L2-Norm(final)=2.267 | acc=1.0000 | 4486.4 samples/s | 70.1 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00417 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.269 | acc=1.0000 | 4492.6 samples/s | 70.2 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00318 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.272 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00304 | Reg=0.00242 | L2-Norm=15.571 | L2-Norm(final)=2.275 | acc=1.0000 | 4495.1 samples/s | 70.2 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00285 | Reg=0.00242 | L2-Norm=15.554 | L2-Norm(final)=2.277 | acc=1.0000 | 4536.5 samples/s | 70.9 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00258 | Reg=0.00241 | L2-Norm=15.535 | L2-Norm(final)=2.279 | acc=1.0000 | 4515.8 samples/s | 70.6 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00230 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.282 | acc=1.0000 | 4519.1 samples/s | 70.6 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00213 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.284 | acc=1.0000 | 4535.1 samples/s | 70.9 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00202 | Reg=0.00240 | L2-Norm=15.476 | L2-Norm(final)=2.287 | acc=1.0000 | 4656.1 samples/s | 72.8 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00201 | Reg=0.00239 | L2-Norm=15.455 | L2-Norm(final)=2.288 | acc=1.0000 | 1911.1 samples/s | 29.9 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00193 | Reg=0.00238 | L2-Norm=15.434 | L2-Norm(final)=2.290 | acc=1.0000 | 4660.4 samples/s | 72.8 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00203 | Reg=0.00238 | L2-Norm=15.414 | L2-Norm(final)=2.291 | acc=0.9844 | 4491.9 samples/s | 70.2 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00256 | Reg=0.00237 | L2-Norm=15.401 | L2-Norm(final)=2.288 | acc=1.0000 | 4648.1 samples/s | 72.6 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00271 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.284 | acc=1.0000 | 4543.0 samples/s | 71.0 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00258 | Reg=0.00237 | L2-Norm=15.388 | L2-Norm(final)=2.281 | acc=1.0000 | 4641.9 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48794 | acc=0.6133 | tpr=0.4411 | fpr=0.0129 | 3894.3 samples/s | 15.2 steps/s
Avg test loss: 0.49378, Avg test acc: 0.61195, Avg tpr: 0.44087, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.17582 | acc=0.8948 | tpr=0.9646 | fpr=0.1064 | 4078.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.17643 | acc=0.8959 | tpr=0.9765 | fpr=0.1056 | 7606.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.17827 | acc=0.8954 | tpr=0.9784 | fpr=0.1062 | 7286.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.17761 | acc=0.8959 | tpr=0.9803 | fpr=0.1056 | 7976.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.17647 | acc=0.8961 | tpr=0.9817 | fpr=0.1055 | 7194.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.17744 | acc=0.8962 | tpr=0.9811 | fpr=0.1053 | 7672.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.17840 | acc=0.8957 | tpr=0.9818 | fpr=0.1059 | 7545.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.17935 | acc=0.8949 | tpr=0.9819 | fpr=0.1067 | 7896.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.18089 | acc=0.8946 | tpr=0.9815 | fpr=0.1070 | 7370.9 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.18126 | acc=0.8943 | tpr=0.9819 | fpr=0.1073 | 7612.0 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.18025 | acc=0.8947 | tpr=0.9817 | fpr=0.1069 | 13795.9 samples/s | 53.9 steps/s
Avg test loss: 0.18025, Avg test acc: 0.89470, Avg tpr: 0.98177, Avg fpr: 0.10689, total FA: 14841

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.38720 | Reg=0.00239 | L2-Norm=15.448 | L2-Norm(final)=2.228 | acc=0.7188 | 3890.9 samples/s | 60.8 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.09696 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.211 | acc=1.0000 | 4412.4 samples/s | 68.9 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.07925 | Reg=0.00245 | L2-Norm=15.637 | L2-Norm(final)=2.222 | acc=0.9688 | 4728.0 samples/s | 73.9 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06707 | Reg=0.00246 | L2-Norm=15.680 | L2-Norm(final)=2.228 | acc=0.9688 | 4810.1 samples/s | 75.2 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.06208 | Reg=0.00247 | L2-Norm=15.714 | L2-Norm(final)=2.233 | acc=0.9531 | 4758.8 samples/s | 74.4 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05835 | Reg=0.00248 | L2-Norm=15.744 | L2-Norm(final)=2.238 | acc=0.9531 | 4791.7 samples/s | 74.9 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05679 | Reg=0.00249 | L2-Norm=15.771 | L2-Norm(final)=2.242 | acc=1.0000 | 4780.6 samples/s | 74.7 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05615 | Reg=0.00250 | L2-Norm=15.797 | L2-Norm(final)=2.245 | acc=0.9688 | 4732.4 samples/s | 73.9 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05582 | Reg=0.00250 | L2-Norm=15.821 | L2-Norm(final)=2.247 | acc=0.9688 | 4749.7 samples/s | 74.2 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05426 | Reg=0.00251 | L2-Norm=15.844 | L2-Norm(final)=2.248 | acc=0.9688 | 4706.0 samples/s | 73.5 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05292 | Reg=0.00252 | L2-Norm=15.866 | L2-Norm(final)=2.251 | acc=0.9688 | 4753.1 samples/s | 74.3 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.05280 | Reg=0.00252 | L2-Norm=15.889 | L2-Norm(final)=2.253 | acc=1.0000 | 4785.1 samples/s | 74.8 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05170 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.255 | acc=0.9531 | 4778.5 samples/s | 74.7 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.05078 | Reg=0.00254 | L2-Norm=15.936 | L2-Norm(final)=2.257 | acc=1.0000 | 4809.5 samples/s | 75.1 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.05041 | Reg=0.00255 | L2-Norm=15.959 | L2-Norm(final)=2.258 | acc=0.9844 | 4846.7 samples/s | 75.7 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04965 | Reg=0.00255 | L2-Norm=15.982 | L2-Norm(final)=2.259 | acc=0.9688 | 4799.2 samples/s | 75.0 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04939 | Reg=0.00256 | L2-Norm=16.004 | L2-Norm(final)=2.261 | acc=0.9375 | 4819.9 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.08175 | Reg=0.00239 | L2-Norm=15.448 | L2-Norm(final)=2.228 | acc=0.9375 | 3601.3 samples/s | 56.3 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00422 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.245 | acc=1.0000 | 4312.4 samples/s | 67.4 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00456 | Reg=0.00242 | L2-Norm=15.540 | L2-Norm(final)=2.253 | acc=1.0000 | 4561.8 samples/s | 71.3 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00436 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.253 | acc=1.0000 | 4593.5 samples/s | 71.8 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00424 | Reg=0.00242 | L2-Norm=15.552 | L2-Norm(final)=2.253 | acc=1.0000 | 4454.7 samples/s | 69.6 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00368 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.253 | acc=1.0000 | 4559.3 samples/s | 71.2 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00333 | Reg=0.00242 | L2-Norm=15.547 | L2-Norm(final)=2.254 | acc=1.0000 | 4550.9 samples/s | 71.1 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00289 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.254 | acc=1.0000 | 4548.5 samples/s | 71.1 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00254 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.255 | acc=1.0000 | 4542.2 samples/s | 71.0 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00243 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.256 | acc=1.0000 | 4576.3 samples/s | 71.5 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00260 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.256 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00242 | Reg=0.00239 | L2-Norm=15.463 | L2-Norm(final)=2.256 | acc=1.0000 | 1922.7 samples/s | 30.0 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00222 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.257 | acc=1.0000 | 4494.9 samples/s | 70.2 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00205 | Reg=0.00238 | L2-Norm=15.424 | L2-Norm(final)=2.257 | acc=1.0000 | 4550.2 samples/s | 71.1 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00193 | Reg=0.00237 | L2-Norm=15.402 | L2-Norm(final)=2.258 | acc=1.0000 | 4491.7 samples/s | 70.2 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00182 | Reg=0.00237 | L2-Norm=15.380 | L2-Norm(final)=2.260 | acc=1.0000 | 4523.3 samples/s | 70.7 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00171 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.261 | acc=1.0000 | 4572.5 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40185 | acc=0.7052 | tpr=0.5778 | fpr=0.0181 | 3909.5 samples/s | 15.3 steps/s
Avg test loss: 0.40894, Avg test acc: 0.69962, Avg tpr: 0.57090, Avg fpr: 0.01731, total FA: 135

Testing server on iccad2012
[Step=  50] | Loss=0.18955 | acc=0.8962 | tpr=0.9646 | fpr=0.1050 | 3968.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.19138 | acc=0.8958 | tpr=0.9701 | fpr=0.1056 | 7468.4 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.19279 | acc=0.8949 | tpr=0.9741 | fpr=0.1066 | 7875.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.19310 | acc=0.8938 | tpr=0.9760 | fpr=0.1077 | 7645.6 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.19269 | acc=0.8934 | tpr=0.9764 | fpr=0.1081 | 7446.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.19353 | acc=0.8938 | tpr=0.9760 | fpr=0.1077 | 7723.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.19434 | acc=0.8937 | tpr=0.9756 | fpr=0.1078 | 7738.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.19558 | acc=0.8933 | tpr=0.9765 | fpr=0.1082 | 7622.9 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.19706 | acc=0.8932 | tpr=0.9776 | fpr=0.1083 | 7470.3 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.19720 | acc=0.8930 | tpr=0.9771 | fpr=0.1085 | 7575.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.19620 | acc=0.8932 | tpr=0.9761 | fpr=0.1083 | 14498.3 samples/s | 56.6 steps/s
Avg test loss: 0.19617, Avg test acc: 0.89327, Avg tpr: 0.97623, Avg fpr: 0.10824, total FA: 15029

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.25479 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.267 | acc=0.7656 | 3833.2 samples/s | 59.9 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.06928 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.263 | acc=0.9688 | 4165.6 samples/s | 65.1 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05786 | Reg=0.00241 | L2-Norm=15.521 | L2-Norm(final)=2.280 | acc=0.9531 | 4819.8 samples/s | 75.3 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05274 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.287 | acc=0.9531 | 4687.3 samples/s | 73.2 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.05269 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.289 | acc=0.9219 | 4789.2 samples/s | 74.8 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05169 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.290 | acc=0.9531 | 4838.9 samples/s | 75.6 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05100 | Reg=0.00246 | L2-Norm=15.672 | L2-Norm(final)=2.292 | acc=0.9688 | 4751.0 samples/s | 74.2 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05088 | Reg=0.00247 | L2-Norm=15.704 | L2-Norm(final)=2.293 | acc=0.9844 | 4868.3 samples/s | 76.1 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04983 | Reg=0.00248 | L2-Norm=15.735 | L2-Norm(final)=2.295 | acc=0.9531 | 4739.4 samples/s | 74.1 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04831 | Reg=0.00249 | L2-Norm=15.764 | L2-Norm(final)=2.297 | acc=0.9844 | 4776.1 samples/s | 74.6 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04742 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.298 | acc=0.9688 | 4755.1 samples/s | 74.3 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04667 | Reg=0.00250 | L2-Norm=15.817 | L2-Norm(final)=2.299 | acc=0.9688 | 4854.2 samples/s | 75.8 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04593 | Reg=0.00251 | L2-Norm=15.841 | L2-Norm(final)=2.300 | acc=0.9844 | 4769.6 samples/s | 74.5 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04535 | Reg=0.00252 | L2-Norm=15.864 | L2-Norm(final)=2.301 | acc=0.9688 | 4803.7 samples/s | 75.1 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04484 | Reg=0.00252 | L2-Norm=15.888 | L2-Norm(final)=2.302 | acc=0.9688 | 4750.0 samples/s | 74.2 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04482 | Reg=0.00253 | L2-Norm=15.911 | L2-Norm(final)=2.302 | acc=0.9844 | 4832.0 samples/s | 75.5 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04465 | Reg=0.00254 | L2-Norm=15.935 | L2-Norm(final)=2.302 | acc=0.9531 | 4777.1 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.02495 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.269 | acc=0.9844 | 3672.6 samples/s | 57.4 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00983 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.276 | acc=1.0000 | 4222.3 samples/s | 66.0 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00869 | Reg=0.00240 | L2-Norm=15.492 | L2-Norm(final)=2.264 | acc=1.0000 | 4492.8 samples/s | 70.2 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00683 | Reg=0.00241 | L2-Norm=15.515 | L2-Norm(final)=2.257 | acc=1.0000 | 4531.5 samples/s | 70.8 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00568 | Reg=0.00241 | L2-Norm=15.526 | L2-Norm(final)=2.258 | acc=1.0000 | 4573.4 samples/s | 71.5 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00500 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.258 | acc=1.0000 | 4473.7 samples/s | 69.9 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00575 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.256 | acc=1.0000 | 4472.4 samples/s | 69.9 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00533 | Reg=0.00241 | L2-Norm=15.533 | L2-Norm(final)=2.253 | acc=1.0000 | 4501.3 samples/s | 70.3 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00485 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.252 | acc=1.0000 | 4511.1 samples/s | 70.5 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00439 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.251 | acc=1.0000 | 4548.6 samples/s | 71.1 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00408 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.252 | acc=1.0000 | 4635.9 samples/s | 72.4 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00380 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.253 | acc=1.0000 | 1911.3 samples/s | 29.9 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00353 | Reg=0.00241 | L2-Norm=15.511 | L2-Norm(final)=2.254 | acc=1.0000 | 4539.0 samples/s | 70.9 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00340 | Reg=0.00240 | L2-Norm=15.500 | L2-Norm(final)=2.255 | acc=1.0000 | 4574.6 samples/s | 71.5 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00346 | Reg=0.00240 | L2-Norm=15.491 | L2-Norm(final)=2.255 | acc=1.0000 | 4551.6 samples/s | 71.1 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00333 | Reg=0.00240 | L2-Norm=15.485 | L2-Norm(final)=2.254 | acc=1.0000 | 4497.8 samples/s | 70.3 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00325 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.253 | acc=1.0000 | 4538.4 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37368 | acc=0.7094 | tpr=0.5906 | fpr=0.0327 | 3951.0 samples/s | 15.4 steps/s
Avg test loss: 0.37881, Avg test acc: 0.70731, Avg tpr: 0.58938, Avg fpr: 0.03333, total FA: 260

Testing server on iccad2012
[Step=  50] | Loss=0.24854 | acc=0.8623 | tpr=0.9779 | fpr=0.1398 | 3941.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.25103 | acc=0.8633 | tpr=0.9851 | fpr=0.1390 | 7485.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.25405 | acc=0.8629 | tpr=0.9870 | fpr=0.1394 | 7718.7 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.25508 | acc=0.8629 | tpr=0.9880 | fpr=0.1394 | 7914.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.25489 | acc=0.8625 | tpr=0.9878 | fpr=0.1398 | 7527.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.25641 | acc=0.8624 | tpr=0.9876 | fpr=0.1399 | 7708.0 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.25749 | acc=0.8617 | tpr=0.9875 | fpr=0.1405 | 7825.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.25886 | acc=0.8614 | tpr=0.9885 | fpr=0.1409 | 7447.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.26033 | acc=0.8615 | tpr=0.9888 | fpr=0.1408 | 7625.6 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.26034 | acc=0.8613 | tpr=0.9881 | fpr=0.1410 | 7549.8 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.25913 | acc=0.8615 | tpr=0.9889 | fpr=0.1408 | 13955.0 samples/s | 54.5 steps/s
Avg test loss: 0.25900, Avg test acc: 0.86152, Avg tpr: 0.98891, Avg fpr: 0.14079, total FA: 19549

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.24354 | Reg=0.00238 | L2-Norm=15.430 | L2-Norm(final)=2.259 | acc=0.7812 | 3611.8 samples/s | 56.4 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.07962 | Reg=0.00242 | L2-Norm=15.544 | L2-Norm(final)=2.250 | acc=0.9531 | 4522.7 samples/s | 70.7 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.06260 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.262 | acc=1.0000 | 4737.6 samples/s | 74.0 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05464 | Reg=0.00245 | L2-Norm=15.659 | L2-Norm(final)=2.272 | acc=0.9844 | 4813.3 samples/s | 75.2 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05220 | Reg=0.00247 | L2-Norm=15.706 | L2-Norm(final)=2.277 | acc=0.9844 | 4769.5 samples/s | 74.5 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05030 | Reg=0.00248 | L2-Norm=15.744 | L2-Norm(final)=2.282 | acc=0.9375 | 4820.7 samples/s | 75.3 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04944 | Reg=0.00249 | L2-Norm=15.777 | L2-Norm(final)=2.287 | acc=1.0000 | 4779.0 samples/s | 74.7 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04841 | Reg=0.00250 | L2-Norm=15.809 | L2-Norm(final)=2.289 | acc=0.9219 | 4866.2 samples/s | 76.0 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04782 | Reg=0.00251 | L2-Norm=15.840 | L2-Norm(final)=2.291 | acc=0.9844 | 4819.0 samples/s | 75.3 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04650 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.294 | acc=0.9844 | 4729.8 samples/s | 73.9 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04555 | Reg=0.00253 | L2-Norm=15.898 | L2-Norm(final)=2.296 | acc=0.9844 | 4788.8 samples/s | 74.8 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04415 | Reg=0.00254 | L2-Norm=15.925 | L2-Norm(final)=2.298 | acc=0.9844 | 4846.9 samples/s | 75.7 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04382 | Reg=0.00254 | L2-Norm=15.950 | L2-Norm(final)=2.300 | acc=0.9844 | 4792.1 samples/s | 74.9 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04346 | Reg=0.00255 | L2-Norm=15.973 | L2-Norm(final)=2.301 | acc=1.0000 | 4778.9 samples/s | 74.7 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04315 | Reg=0.00256 | L2-Norm=15.996 | L2-Norm(final)=2.301 | acc=0.9844 | 4809.3 samples/s | 75.1 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04295 | Reg=0.00257 | L2-Norm=16.017 | L2-Norm(final)=2.302 | acc=0.9844 | 4612.8 samples/s | 72.1 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04358 | Reg=0.00257 | L2-Norm=16.037 | L2-Norm(final)=2.302 | acc=0.9375 | 4802.9 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.03595 | Reg=0.00238 | L2-Norm=15.430 | L2-Norm(final)=2.261 | acc=0.9688 | 3862.5 samples/s | 60.4 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00488 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.282 | acc=1.0000 | 3894.3 samples/s | 60.8 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00294 | Reg=0.00241 | L2-Norm=15.532 | L2-Norm(final)=2.287 | acc=1.0000 | 4500.4 samples/s | 70.3 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00225 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.294 | acc=1.0000 | 4500.4 samples/s | 70.3 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00279 | Reg=0.00241 | L2-Norm=15.520 | L2-Norm(final)=2.297 | acc=1.0000 | 4497.8 samples/s | 70.3 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00289 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.297 | acc=1.0000 | 4525.9 samples/s | 70.7 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00262 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.299 | acc=1.0000 | 4559.9 samples/s | 71.2 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00266 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.300 | acc=1.0000 | 4564.7 samples/s | 71.3 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00240 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.300 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00216 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.302 | acc=1.0000 | 4572.3 samples/s | 71.4 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00209 | Reg=0.00241 | L2-Norm=15.515 | L2-Norm(final)=2.303 | acc=1.0000 | 4561.9 samples/s | 71.3 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00232 | Reg=0.00241 | L2-Norm=15.508 | L2-Norm(final)=2.303 | acc=1.0000 | 1912.3 samples/s | 29.9 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00218 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.304 | acc=1.0000 | 4588.2 samples/s | 71.7 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00202 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.305 | acc=1.0000 | 4515.1 samples/s | 70.5 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00194 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.307 | acc=1.0000 | 4504.2 samples/s | 70.4 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00182 | Reg=0.00240 | L2-Norm=15.489 | L2-Norm(final)=2.309 | acc=1.0000 | 4554.0 samples/s | 71.2 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00180 | Reg=0.00240 | L2-Norm=15.478 | L2-Norm(final)=2.310 | acc=1.0000 | 4477.8 samples/s | 70.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31038 | acc=0.7712 | tpr=0.6813 | fpr=0.0334 | 3891.2 samples/s | 15.2 steps/s
Avg test loss: 0.31176, Avg test acc: 0.76877, Avg tpr: 0.67885, Avg fpr: 0.03346, total FA: 261

Testing server on iccad2012
[Step=  50] | Loss=0.30693 | acc=0.8367 | tpr=0.9823 | fpr=0.1659 | 3907.5 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.30879 | acc=0.8373 | tpr=0.9893 | fpr=0.1655 | 7903.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.31342 | acc=0.8370 | tpr=0.9928 | fpr=0.1659 | 7515.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.31438 | acc=0.8368 | tpr=0.9913 | fpr=0.1660 | 7745.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.31394 | acc=0.8362 | tpr=0.9886 | fpr=0.1666 | 7601.6 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.31486 | acc=0.8361 | tpr=0.9884 | fpr=0.1666 | 7905.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.31602 | acc=0.8358 | tpr=0.9887 | fpr=0.1670 | 7453.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.31704 | acc=0.8353 | tpr=0.9891 | fpr=0.1675 | 7757.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.31923 | acc=0.8347 | tpr=0.9893 | fpr=0.1681 | 7577.1 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.31936 | acc=0.8345 | tpr=0.9881 | fpr=0.1683 | 7541.2 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.31798 | acc=0.8346 | tpr=0.9889 | fpr=0.1682 | 13817.0 samples/s | 54.0 steps/s
Avg test loss: 0.31776, Avg test acc: 0.83470, Avg tpr: 0.98891, Avg fpr: 0.16810, total FA: 23341

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.24293 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.303 | acc=0.7969 | 3840.7 samples/s | 60.0 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.06416 | Reg=0.00243 | L2-Norm=15.587 | L2-Norm(final)=2.304 | acc=0.9688 | 4395.4 samples/s | 68.7 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.05234 | Reg=0.00245 | L2-Norm=15.655 | L2-Norm(final)=2.314 | acc=0.9844 | 4734.3 samples/s | 74.0 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.04891 | Reg=0.00247 | L2-Norm=15.705 | L2-Norm(final)=2.321 | acc=0.9688 | 4768.8 samples/s | 74.5 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.04623 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.324 | acc=1.0000 | 4771.2 samples/s | 74.5 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04718 | Reg=0.00249 | L2-Norm=15.782 | L2-Norm(final)=2.324 | acc=0.9375 | 4806.1 samples/s | 75.1 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04558 | Reg=0.00250 | L2-Norm=15.813 | L2-Norm(final)=2.322 | acc=0.9531 | 4803.5 samples/s | 75.1 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04473 | Reg=0.00251 | L2-Norm=15.844 | L2-Norm(final)=2.321 | acc=0.9844 | 4824.7 samples/s | 75.4 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04345 | Reg=0.00252 | L2-Norm=15.874 | L2-Norm(final)=2.322 | acc=0.9688 | 4787.2 samples/s | 74.8 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04257 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.323 | acc=0.9531 | 4810.6 samples/s | 75.2 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04246 | Reg=0.00254 | L2-Norm=15.928 | L2-Norm(final)=2.323 | acc=0.9688 | 4823.3 samples/s | 75.4 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04190 | Reg=0.00255 | L2-Norm=15.954 | L2-Norm(final)=2.324 | acc=0.9688 | 4770.3 samples/s | 74.5 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04177 | Reg=0.00255 | L2-Norm=15.978 | L2-Norm(final)=2.325 | acc=0.9531 | 4756.6 samples/s | 74.3 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04144 | Reg=0.00256 | L2-Norm=16.002 | L2-Norm(final)=2.325 | acc=0.9531 | 4828.9 samples/s | 75.5 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04129 | Reg=0.00257 | L2-Norm=16.025 | L2-Norm(final)=2.324 | acc=0.9844 | 4828.9 samples/s | 75.5 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04136 | Reg=0.00258 | L2-Norm=16.047 | L2-Norm(final)=2.323 | acc=1.0000 | 4759.1 samples/s | 74.4 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04143 | Reg=0.00258 | L2-Norm=16.069 | L2-Norm(final)=2.320 | acc=0.9688 | 4837.0 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.07072 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.305 | acc=0.9531 | 3989.0 samples/s | 62.3 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00644 | Reg=0.00242 | L2-Norm=15.555 | L2-Norm(final)=2.321 | acc=1.0000 | 3998.4 samples/s | 62.5 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00471 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.325 | acc=1.0000 | 4584.6 samples/s | 71.6 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00378 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.330 | acc=1.0000 | 4483.4 samples/s | 70.1 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00313 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.332 | acc=1.0000 | 4540.7 samples/s | 70.9 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00266 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.336 | acc=1.0000 | 4563.1 samples/s | 71.3 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00237 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.340 | acc=1.0000 | 4538.8 samples/s | 70.9 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00266 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.342 | acc=1.0000 | 4592.8 samples/s | 71.8 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00269 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.342 | acc=1.0000 | 4511.6 samples/s | 70.5 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00257 | Reg=0.00243 | L2-Norm=15.603 | L2-Norm(final)=2.342 | acc=0.9844 | 4525.3 samples/s | 70.7 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00238 | Reg=0.00243 | L2-Norm=15.604 | L2-Norm(final)=2.343 | acc=1.0000 | 4584.6 samples/s | 71.6 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00224 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.343 | acc=1.0000 | 1885.5 samples/s | 29.5 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00223 | Reg=0.00243 | L2-Norm=15.596 | L2-Norm(final)=2.343 | acc=1.0000 | 4661.6 samples/s | 72.8 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00217 | Reg=0.00243 | L2-Norm=15.590 | L2-Norm(final)=2.342 | acc=1.0000 | 4479.5 samples/s | 70.0 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00223 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.341 | acc=1.0000 | 4535.4 samples/s | 70.9 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00219 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.339 | acc=1.0000 | 4542.3 samples/s | 71.0 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00225 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.335 | acc=1.0000 | 4437.9 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39532 | acc=0.7192 | tpr=0.5948 | fpr=0.0107 | 3950.0 samples/s | 15.4 steps/s
Avg test loss: 0.39782, Avg test acc: 0.71600, Avg tpr: 0.59130, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.20498 | acc=0.8797 | tpr=0.9735 | fpr=0.1220 | 4011.8 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.20630 | acc=0.8814 | tpr=0.9744 | fpr=0.1204 | 7757.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.20991 | acc=0.8811 | tpr=0.9784 | fpr=0.1206 | 7294.3 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.20912 | acc=0.8817 | tpr=0.9803 | fpr=0.1201 | 7691.5 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.20845 | acc=0.8815 | tpr=0.9808 | fpr=0.1203 | 7793.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.20906 | acc=0.8821 | tpr=0.9804 | fpr=0.1197 | 7358.5 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.20945 | acc=0.8818 | tpr=0.9800 | fpr=0.1200 | 7863.5 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.21033 | acc=0.8811 | tpr=0.9787 | fpr=0.1207 | 7484.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.21195 | acc=0.8811 | tpr=0.9796 | fpr=0.1207 | 7527.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.21213 | acc=0.8810 | tpr=0.9802 | fpr=0.1208 | 7725.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.21113 | acc=0.8817 | tpr=0.9817 | fpr=0.1201 | 13563.6 samples/s | 53.0 steps/s
Avg test loss: 0.21105, Avg test acc: 0.88172, Avg tpr: 0.98177, Avg fpr: 0.12010, total FA: 16675

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.31629 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.277 | acc=0.7500 | 3956.1 samples/s | 61.8 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.08719 | Reg=0.00244 | L2-Norm=15.614 | L2-Norm(final)=2.265 | acc=0.9688 | 4272.7 samples/s | 66.8 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.06008 | Reg=0.00245 | L2-Norm=15.643 | L2-Norm(final)=2.280 | acc=0.9688 | 4769.4 samples/s | 74.5 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.05007 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.291 | acc=0.9688 | 4809.4 samples/s | 75.1 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04590 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.299 | acc=0.9688 | 4717.4 samples/s | 73.7 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04260 | Reg=0.00246 | L2-Norm=15.687 | L2-Norm(final)=2.305 | acc=0.9844 | 4757.6 samples/s | 74.3 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.04041 | Reg=0.00246 | L2-Norm=15.696 | L2-Norm(final)=2.310 | acc=0.9844 | 4830.8 samples/s | 75.5 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03888 | Reg=0.00247 | L2-Norm=15.704 | L2-Norm(final)=2.314 | acc=0.9844 | 4778.3 samples/s | 74.7 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03726 | Reg=0.00247 | L2-Norm=15.712 | L2-Norm(final)=2.318 | acc=0.9844 | 4799.3 samples/s | 75.0 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03617 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.321 | acc=1.0000 | 4740.3 samples/s | 74.1 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03503 | Reg=0.00247 | L2-Norm=15.726 | L2-Norm(final)=2.324 | acc=0.9844 | 4820.7 samples/s | 75.3 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03385 | Reg=0.00248 | L2-Norm=15.732 | L2-Norm(final)=2.327 | acc=0.9844 | 4764.8 samples/s | 74.4 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03301 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.331 | acc=0.9531 | 4800.9 samples/s | 75.0 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03253 | Reg=0.00248 | L2-Norm=15.745 | L2-Norm(final)=2.334 | acc=0.9844 | 4729.1 samples/s | 73.9 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03234 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.336 | acc=1.0000 | 4807.4 samples/s | 75.1 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03244 | Reg=0.00248 | L2-Norm=15.756 | L2-Norm(final)=2.338 | acc=0.9844 | 4784.0 samples/s | 74.8 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03189 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.340 | acc=0.9844 | 4765.3 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.00446 | Reg=0.00242 | L2-Norm=15.567 | L2-Norm(final)=2.278 | acc=1.0000 | 3737.4 samples/s | 58.4 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00417 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.291 | acc=1.0000 | 4215.5 samples/s | 65.9 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00224 | Reg=0.00243 | L2-Norm=15.589 | L2-Norm(final)=2.299 | acc=1.0000 | 4519.3 samples/s | 70.6 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00157 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.304 | acc=1.0000 | 4489.8 samples/s | 70.2 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00120 | Reg=0.00242 | L2-Norm=15.565 | L2-Norm(final)=2.308 | acc=1.0000 | 4552.0 samples/s | 71.1 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00102 | Reg=0.00242 | L2-Norm=15.551 | L2-Norm(final)=2.311 | acc=1.0000 | 4564.3 samples/s | 71.3 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00086 | Reg=0.00241 | L2-Norm=15.537 | L2-Norm(final)=2.314 | acc=1.0000 | 4507.1 samples/s | 70.4 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00075 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.317 | acc=1.0000 | 4531.8 samples/s | 70.8 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00067 | Reg=0.00240 | L2-Norm=15.508 | L2-Norm(final)=2.319 | acc=1.0000 | 4536.7 samples/s | 70.9 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00060 | Reg=0.00240 | L2-Norm=15.492 | L2-Norm(final)=2.321 | acc=1.0000 | 4488.2 samples/s | 70.1 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00054 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.323 | acc=1.0000 | 4636.8 samples/s | 72.4 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00049 | Reg=0.00239 | L2-Norm=15.461 | L2-Norm(final)=2.325 | acc=1.0000 | 1896.6 samples/s | 29.6 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00045 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.327 | acc=1.0000 | 4573.3 samples/s | 71.5 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00042 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.328 | acc=1.0000 | 4531.1 samples/s | 70.8 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00039 | Reg=0.00238 | L2-Norm=15.411 | L2-Norm(final)=2.330 | acc=1.0000 | 4549.4 samples/s | 71.1 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00036 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.331 | acc=1.0000 | 4493.4 samples/s | 70.2 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00034 | Reg=0.00236 | L2-Norm=15.377 | L2-Norm(final)=2.332 | acc=1.0000 | 4582.7 samples/s | 71.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26957 | acc=0.8275 | tpr=0.7545 | fpr=0.0139 | 3956.6 samples/s | 15.5 steps/s
Avg test loss: 0.27238, Avg test acc: 0.82535, Avg tpr: 0.75188, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.49575 | acc=0.7889 | tpr=0.9823 | fpr=0.2146 | 3896.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.49566 | acc=0.7927 | tpr=0.9893 | fpr=0.2110 | 7688.2 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.50069 | acc=0.7916 | tpr=0.9914 | fpr=0.2121 | 7693.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.49859 | acc=0.7922 | tpr=0.9913 | fpr=0.2114 | 7581.4 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.49809 | acc=0.7915 | tpr=0.9913 | fpr=0.2122 | 7552.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.49661 | acc=0.7924 | tpr=0.9898 | fpr=0.2112 | 7708.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.49704 | acc=0.7924 | tpr=0.9900 | fpr=0.2112 | 7703.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.49890 | acc=0.7917 | tpr=0.9902 | fpr=0.2119 | 7559.2 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.50130 | acc=0.7913 | tpr=0.9903 | fpr=0.2123 | 7355.0 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.50167 | acc=0.7912 | tpr=0.9899 | fpr=0.2124 | 7679.4 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.49997 | acc=0.7915 | tpr=0.9904 | fpr=0.2121 | 13775.8 samples/s | 53.8 steps/s
Avg test loss: 0.49971, Avg test acc: 0.79161, Avg tpr: 0.99049, Avg fpr: 0.21200, total FA: 29436

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.25434 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.357 | acc=0.8438 | 3768.2 samples/s | 58.9 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04090 | Reg=0.00238 | L2-Norm=15.419 | L2-Norm(final)=2.349 | acc=0.9844 | 4296.6 samples/s | 67.1 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03395 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.360 | acc=0.9844 | 4718.9 samples/s | 73.7 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.02999 | Reg=0.00239 | L2-Norm=15.457 | L2-Norm(final)=2.367 | acc=0.9844 | 4774.7 samples/s | 74.6 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.02927 | Reg=0.00239 | L2-Norm=15.469 | L2-Norm(final)=2.372 | acc=0.9844 | 4792.7 samples/s | 74.9 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.02813 | Reg=0.00240 | L2-Norm=15.479 | L2-Norm(final)=2.378 | acc=0.9844 | 4832.2 samples/s | 75.5 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02772 | Reg=0.00240 | L2-Norm=15.489 | L2-Norm(final)=2.382 | acc=0.9844 | 4778.8 samples/s | 74.7 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02721 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.385 | acc=1.0000 | 4746.5 samples/s | 74.2 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02675 | Reg=0.00240 | L2-Norm=15.508 | L2-Norm(final)=2.387 | acc=0.9844 | 4806.8 samples/s | 75.1 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02657 | Reg=0.00241 | L2-Norm=15.516 | L2-Norm(final)=2.389 | acc=0.9688 | 4743.7 samples/s | 74.1 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02629 | Reg=0.00241 | L2-Norm=15.524 | L2-Norm(final)=2.392 | acc=0.9688 | 4859.1 samples/s | 75.9 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02584 | Reg=0.00241 | L2-Norm=15.532 | L2-Norm(final)=2.394 | acc=1.0000 | 4764.5 samples/s | 74.4 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02574 | Reg=0.00241 | L2-Norm=15.539 | L2-Norm(final)=2.396 | acc=0.9531 | 4788.6 samples/s | 74.8 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02575 | Reg=0.00242 | L2-Norm=15.546 | L2-Norm(final)=2.398 | acc=1.0000 | 4780.3 samples/s | 74.7 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02590 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.400 | acc=1.0000 | 4797.4 samples/s | 75.0 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02584 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.401 | acc=0.9844 | 4826.2 samples/s | 75.4 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02580 | Reg=0.00242 | L2-Norm=15.566 | L2-Norm(final)=2.403 | acc=0.9844 | 4777.8 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.11265 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.356 | acc=0.9375 | 3855.2 samples/s | 60.2 steps/s
[Step=8850 Epoch=16.7] | Loss=0.01060 | Reg=0.00239 | L2-Norm=15.468 | L2-Norm(final)=2.332 | acc=1.0000 | 4073.9 samples/s | 63.7 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00551 | Reg=0.00240 | L2-Norm=15.494 | L2-Norm(final)=2.336 | acc=1.0000 | 4508.5 samples/s | 70.4 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00374 | Reg=0.00240 | L2-Norm=15.493 | L2-Norm(final)=2.341 | acc=1.0000 | 4543.8 samples/s | 71.0 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00282 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.344 | acc=1.0000 | 4487.9 samples/s | 70.1 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00227 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.347 | acc=1.0000 | 4621.8 samples/s | 72.2 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00190 | Reg=0.00239 | L2-Norm=15.458 | L2-Norm(final)=2.350 | acc=1.0000 | 4509.2 samples/s | 70.5 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00163 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.352 | acc=1.0000 | 4543.9 samples/s | 71.0 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00143 | Reg=0.00238 | L2-Norm=15.427 | L2-Norm(final)=2.353 | acc=1.0000 | 4545.0 samples/s | 71.0 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00128 | Reg=0.00237 | L2-Norm=15.411 | L2-Norm(final)=2.355 | acc=1.0000 | 4552.7 samples/s | 71.1 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00115 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.357 | acc=1.0000 | 4641.4 samples/s | 72.5 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00105 | Reg=0.00236 | L2-Norm=15.378 | L2-Norm(final)=2.359 | acc=1.0000 | 1941.2 samples/s | 30.3 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00096 | Reg=0.00236 | L2-Norm=15.361 | L2-Norm(final)=2.360 | acc=1.0000 | 4465.9 samples/s | 69.8 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00089 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.361 | acc=1.0000 | 4564.9 samples/s | 71.3 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00083 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.362 | acc=1.0000 | 4561.5 samples/s | 71.3 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00077 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.363 | acc=1.0000 | 4492.8 samples/s | 70.2 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00072 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.365 | acc=1.0000 | 4605.8 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31191 | acc=0.8048 | tpr=0.7206 | fpr=0.0124 | 3942.7 samples/s | 15.4 steps/s
Avg test loss: 0.31350, Avg test acc: 0.80431, Avg tpr: 0.72041, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.38229 | acc=0.8487 | tpr=0.9867 | fpr=0.1538 | 3939.2 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.38249 | acc=0.8505 | tpr=0.9893 | fpr=0.1521 | 7717.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.38777 | acc=0.8507 | tpr=0.9914 | fpr=0.1519 | 7726.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.38707 | acc=0.8506 | tpr=0.9902 | fpr=0.1520 | 7704.0 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.38604 | acc=0.8500 | tpr=0.9904 | fpr=0.1526 | 7622.7 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.38658 | acc=0.8503 | tpr=0.9891 | fpr=0.1522 | 7855.1 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.38680 | acc=0.8502 | tpr=0.9887 | fpr=0.1523 | 7623.8 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.38819 | acc=0.8495 | tpr=0.9874 | fpr=0.1530 | 7492.9 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.39036 | acc=0.8494 | tpr=0.9878 | fpr=0.1531 | 7339.3 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.39093 | acc=0.8492 | tpr=0.9872 | fpr=0.1533 | 7587.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.38938 | acc=0.8495 | tpr=0.9877 | fpr=0.1530 | 14385.4 samples/s | 56.2 steps/s
Avg test loss: 0.38912, Avg test acc: 0.84957, Avg tpr: 0.98772, Avg fpr: 0.15294, total FA: 21236

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.11897 | Reg=0.00231 | L2-Norm=15.213 | L2-Norm(final)=2.397 | acc=0.8906 | 3791.5 samples/s | 59.2 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.04725 | Reg=0.00233 | L2-Norm=15.267 | L2-Norm(final)=2.384 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03512 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.395 | acc=1.0000 | 4699.9 samples/s | 73.4 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03041 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.403 | acc=0.9844 | 4807.0 samples/s | 75.1 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.02839 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.409 | acc=0.9844 | 4704.7 samples/s | 73.5 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02713 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.413 | acc=0.9844 | 4792.7 samples/s | 74.9 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02576 | Reg=0.00235 | L2-Norm=15.340 | L2-Norm(final)=2.418 | acc=1.0000 | 4802.2 samples/s | 75.0 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02572 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.423 | acc=1.0000 | 4797.0 samples/s | 75.0 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02546 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.426 | acc=1.0000 | 4834.0 samples/s | 75.5 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02575 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.429 | acc=0.9844 | 4757.4 samples/s | 74.3 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02559 | Reg=0.00236 | L2-Norm=15.374 | L2-Norm(final)=2.432 | acc=1.0000 | 4736.9 samples/s | 74.0 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02525 | Reg=0.00237 | L2-Norm=15.383 | L2-Norm(final)=2.435 | acc=1.0000 | 4857.8 samples/s | 75.9 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02536 | Reg=0.00237 | L2-Norm=15.392 | L2-Norm(final)=2.438 | acc=0.9688 | 4681.3 samples/s | 73.1 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02539 | Reg=0.00237 | L2-Norm=15.400 | L2-Norm(final)=2.440 | acc=0.9688 | 4724.8 samples/s | 73.8 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02510 | Reg=0.00237 | L2-Norm=15.408 | L2-Norm(final)=2.442 | acc=0.9844 | 4778.3 samples/s | 74.7 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02470 | Reg=0.00238 | L2-Norm=15.416 | L2-Norm(final)=2.444 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02466 | Reg=0.00238 | L2-Norm=15.424 | L2-Norm(final)=2.446 | acc=0.9688 | 4779.3 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.02599 | Reg=0.00231 | L2-Norm=15.213 | L2-Norm(final)=2.397 | acc=0.9844 | 3775.5 samples/s | 59.0 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00777 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.394 | acc=1.0000 | 4257.9 samples/s | 66.5 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00444 | Reg=0.00235 | L2-Norm=15.321 | L2-Norm(final)=2.396 | acc=1.0000 | 4574.9 samples/s | 71.5 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00383 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.398 | acc=1.0000 | 4496.6 samples/s | 70.3 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00317 | Reg=0.00235 | L2-Norm=15.331 | L2-Norm(final)=2.400 | acc=1.0000 | 4553.5 samples/s | 71.1 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00266 | Reg=0.00235 | L2-Norm=15.331 | L2-Norm(final)=2.403 | acc=1.0000 | 4592.3 samples/s | 71.8 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00225 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.406 | acc=1.0000 | 4424.7 samples/s | 69.1 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00194 | Reg=0.00235 | L2-Norm=15.319 | L2-Norm(final)=2.408 | acc=1.0000 | 4601.8 samples/s | 71.9 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00170 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.411 | acc=1.0000 | 4518.6 samples/s | 70.6 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00152 | Reg=0.00234 | L2-Norm=15.299 | L2-Norm(final)=2.413 | acc=1.0000 | 4510.9 samples/s | 70.5 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00137 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.415 | acc=1.0000 | 4602.5 samples/s | 71.9 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00125 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.416 | acc=1.0000 | 1928.2 samples/s | 30.1 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00115 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.418 | acc=1.0000 | 4590.5 samples/s | 71.7 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00106 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.419 | acc=1.0000 | 4570.7 samples/s | 71.4 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00098 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.421 | acc=1.0000 | 4520.3 samples/s | 70.6 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00092 | Reg=0.00232 | L2-Norm=15.216 | L2-Norm(final)=2.422 | acc=1.0000 | 4487.5 samples/s | 70.1 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00086 | Reg=0.00231 | L2-Norm=15.200 | L2-Norm(final)=2.423 | acc=1.0000 | 4536.8 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37383 | acc=0.7766 | tpr=0.6779 | fpr=0.0092 | 3955.7 samples/s | 15.5 steps/s
Avg test loss: 0.37353, Avg test acc: 0.77442, Avg tpr: 0.67570, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.39172 | acc=0.8559 | tpr=0.9779 | fpr=0.1463 | 3942.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.39197 | acc=0.8571 | tpr=0.9872 | fpr=0.1453 | 7657.8 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.39767 | acc=0.8573 | tpr=0.9899 | fpr=0.1451 | 7770.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.39693 | acc=0.8568 | tpr=0.9902 | fpr=0.1456 | 7751.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.39403 | acc=0.8568 | tpr=0.9895 | fpr=0.1457 | 7770.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.39458 | acc=0.8575 | tpr=0.9876 | fpr=0.1449 | 7615.8 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.39473 | acc=0.8573 | tpr=0.9869 | fpr=0.1450 | 7497.4 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.39626 | acc=0.8570 | tpr=0.9858 | fpr=0.1453 | 7841.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.39926 | acc=0.8567 | tpr=0.9859 | fpr=0.1457 | 7441.8 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.39957 | acc=0.8565 | tpr=0.9855 | fpr=0.1458 | 7644.0 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.39740 | acc=0.8570 | tpr=0.9861 | fpr=0.1454 | 13731.7 samples/s | 53.6 steps/s
Avg test loss: 0.39708, Avg test acc: 0.85707, Avg tpr: 0.98613, Avg fpr: 0.14528, total FA: 20172

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.31127 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.452 | acc=0.7969 | 4097.8 samples/s | 64.0 steps/s
[Step=10450 Epoch=10.2] | Loss=0.05117 | Reg=0.00230 | L2-Norm=15.172 | L2-Norm(final)=2.427 | acc=1.0000 | 4273.6 samples/s | 66.8 steps/s
[Step=10500 Epoch=10.3] | Loss=0.03709 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.436 | acc=1.0000 | 4753.1 samples/s | 74.3 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03337 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.443 | acc=0.9844 | 4760.7 samples/s | 74.4 steps/s
[Step=10600 Epoch=10.3] | Loss=0.03141 | Reg=0.00232 | L2-Norm=15.236 | L2-Norm(final)=2.447 | acc=0.9844 | 4633.8 samples/s | 72.4 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02964 | Reg=0.00233 | L2-Norm=15.249 | L2-Norm(final)=2.452 | acc=0.9688 | 4775.5 samples/s | 74.6 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02825 | Reg=0.00233 | L2-Norm=15.261 | L2-Norm(final)=2.457 | acc=0.9844 | 4803.8 samples/s | 75.1 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02729 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.461 | acc=0.9844 | 4761.3 samples/s | 74.4 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02657 | Reg=0.00234 | L2-Norm=15.281 | L2-Norm(final)=2.465 | acc=0.9844 | 4726.7 samples/s | 73.9 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02607 | Reg=0.00234 | L2-Norm=15.291 | L2-Norm(final)=2.468 | acc=0.9844 | 4826.4 samples/s | 75.4 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02574 | Reg=0.00234 | L2-Norm=15.300 | L2-Norm(final)=2.471 | acc=0.9531 | 4732.3 samples/s | 73.9 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02518 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.474 | acc=0.9844 | 4741.1 samples/s | 74.1 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02507 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.477 | acc=0.9844 | 4799.6 samples/s | 75.0 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02492 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.479 | acc=0.9844 | 4781.9 samples/s | 74.7 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02468 | Reg=0.00235 | L2-Norm=15.333 | L2-Norm(final)=2.481 | acc=0.9844 | 4785.5 samples/s | 74.8 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02451 | Reg=0.00235 | L2-Norm=15.340 | L2-Norm(final)=2.484 | acc=0.9531 | 4817.3 samples/s | 75.3 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02427 | Reg=0.00236 | L2-Norm=15.347 | L2-Norm(final)=2.486 | acc=0.9844 | 4781.1 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.09600 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.453 | acc=0.9375 | 3648.2 samples/s | 57.0 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00347 | Reg=0.00230 | L2-Norm=15.181 | L2-Norm(final)=2.455 | acc=1.0000 | 4426.1 samples/s | 69.2 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00185 | Reg=0.00231 | L2-Norm=15.186 | L2-Norm(final)=2.458 | acc=1.0000 | 4620.2 samples/s | 72.2 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00127 | Reg=0.00230 | L2-Norm=15.178 | L2-Norm(final)=2.460 | acc=1.0000 | 4470.4 samples/s | 69.9 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00097 | Reg=0.00230 | L2-Norm=15.165 | L2-Norm(final)=2.463 | acc=1.0000 | 4495.3 samples/s | 70.2 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00079 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.465 | acc=1.0000 | 4574.8 samples/s | 71.5 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00066 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.467 | acc=1.0000 | 4548.0 samples/s | 71.1 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00058 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.468 | acc=1.0000 | 4580.2 samples/s | 71.6 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00051 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.470 | acc=1.0000 | 4424.4 samples/s | 69.1 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00047 | Reg=0.00228 | L2-Norm=15.087 | L2-Norm(final)=2.472 | acc=1.0000 | 4516.4 samples/s | 70.6 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00043 | Reg=0.00227 | L2-Norm=15.072 | L2-Norm(final)=2.473 | acc=1.0000 | 4561.2 samples/s | 71.3 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00039 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.475 | acc=1.0000 | 1903.0 samples/s | 29.7 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00036 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.477 | acc=1.0000 | 4522.0 samples/s | 70.7 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00033 | Reg=0.00226 | L2-Norm=15.022 | L2-Norm(final)=2.478 | acc=1.0000 | 4519.6 samples/s | 70.6 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00031 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.479 | acc=1.0000 | 4527.7 samples/s | 70.7 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00029 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.480 | acc=1.0000 | 4504.5 samples/s | 70.4 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00027 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.481 | acc=1.0000 | 4566.5 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36695 | acc=0.7868 | tpr=0.6923 | fpr=0.0079 | 3940.1 samples/s | 15.4 steps/s
Avg test loss: 0.36708, Avg test acc: 0.78588, Avg tpr: 0.69214, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.43383 | acc=0.8473 | tpr=0.9823 | fpr=0.1552 | 3924.7 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.43503 | acc=0.8493 | tpr=0.9893 | fpr=0.1533 | 7740.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.43984 | acc=0.8502 | tpr=0.9899 | fpr=0.1524 | 7524.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.43975 | acc=0.8500 | tpr=0.9902 | fpr=0.1526 | 7527.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.43655 | acc=0.8501 | tpr=0.9886 | fpr=0.1524 | 7888.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.43633 | acc=0.8507 | tpr=0.9869 | fpr=0.1518 | 7513.0 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.43713 | acc=0.8509 | tpr=0.9869 | fpr=0.1516 | 7988.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.43862 | acc=0.8501 | tpr=0.9874 | fpr=0.1524 | 7433.1 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.44157 | acc=0.8498 | tpr=0.9873 | fpr=0.1527 | 7530.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.44203 | acc=0.8498 | tpr=0.9868 | fpr=0.1527 | 7503.1 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.43963 | acc=0.8500 | tpr=0.9869 | fpr=0.1524 | 14189.1 samples/s | 55.4 steps/s
Avg test loss: 0.43938, Avg test acc: 0.85010, Avg tpr: 0.98693, Avg fpr: 0.15238, total FA: 21158

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.28435 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.505 | acc=0.8906 | 4164.9 samples/s | 65.1 steps/s
[Step=11250 Epoch=11.0] | Loss=0.04754 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.490 | acc=0.9688 | 4103.0 samples/s | 64.1 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03469 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.500 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03196 | Reg=0.00228 | L2-Norm=15.088 | L2-Norm(final)=2.507 | acc=1.0000 | 4746.3 samples/s | 74.2 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02974 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.511 | acc=0.9844 | 4727.5 samples/s | 73.9 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02770 | Reg=0.00229 | L2-Norm=15.116 | L2-Norm(final)=2.515 | acc=0.9688 | 4824.0 samples/s | 75.4 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02650 | Reg=0.00229 | L2-Norm=15.127 | L2-Norm(final)=2.521 | acc=0.9844 | 4718.2 samples/s | 73.7 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02544 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.525 | acc=0.9688 | 4799.0 samples/s | 75.0 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02435 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.529 | acc=0.9688 | 4803.4 samples/s | 75.1 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02372 | Reg=0.00230 | L2-Norm=15.153 | L2-Norm(final)=2.532 | acc=0.9688 | 4796.2 samples/s | 74.9 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02367 | Reg=0.00230 | L2-Norm=15.161 | L2-Norm(final)=2.534 | acc=0.9688 | 4821.7 samples/s | 75.3 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02337 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.537 | acc=1.0000 | 4785.3 samples/s | 74.8 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02318 | Reg=0.00230 | L2-Norm=15.175 | L2-Norm(final)=2.538 | acc=1.0000 | 4828.6 samples/s | 75.4 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02355 | Reg=0.00231 | L2-Norm=15.183 | L2-Norm(final)=2.540 | acc=0.9844 | 4825.7 samples/s | 75.4 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02332 | Reg=0.00231 | L2-Norm=15.189 | L2-Norm(final)=2.541 | acc=1.0000 | 4743.1 samples/s | 74.1 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02317 | Reg=0.00231 | L2-Norm=15.196 | L2-Norm(final)=2.543 | acc=0.9844 | 4791.7 samples/s | 74.9 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02305 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.544 | acc=0.9688 | 4887.2 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.12057 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.506 | acc=0.9219 | 3871.5 samples/s | 60.5 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00575 | Reg=0.00227 | L2-Norm=15.052 | L2-Norm(final)=2.508 | acc=1.0000 | 3999.7 samples/s | 62.5 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00542 | Reg=0.00228 | L2-Norm=15.090 | L2-Norm(final)=2.508 | acc=1.0000 | 4504.0 samples/s | 70.4 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00418 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.502 | acc=1.0000 | 4519.4 samples/s | 70.6 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00444 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.498 | acc=1.0000 | 4601.5 samples/s | 71.9 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00384 | Reg=0.00229 | L2-Norm=15.149 | L2-Norm(final)=2.493 | acc=1.0000 | 4523.4 samples/s | 70.7 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00338 | Reg=0.00230 | L2-Norm=15.156 | L2-Norm(final)=2.490 | acc=1.0000 | 4480.4 samples/s | 70.0 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00295 | Reg=0.00230 | L2-Norm=15.159 | L2-Norm(final)=2.489 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00259 | Reg=0.00230 | L2-Norm=15.159 | L2-Norm(final)=2.489 | acc=1.0000 | 4477.2 samples/s | 70.0 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00231 | Reg=0.00230 | L2-Norm=15.156 | L2-Norm(final)=2.490 | acc=1.0000 | 4560.4 samples/s | 71.3 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00215 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.491 | acc=1.0000 | 4548.8 samples/s | 71.1 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00196 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.491 | acc=1.0000 | 1883.0 samples/s | 29.4 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00180 | Reg=0.00229 | L2-Norm=15.139 | L2-Norm(final)=2.492 | acc=1.0000 | 4542.8 samples/s | 71.0 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00166 | Reg=0.00229 | L2-Norm=15.131 | L2-Norm(final)=2.492 | acc=1.0000 | 4509.6 samples/s | 70.5 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00155 | Reg=0.00229 | L2-Norm=15.123 | L2-Norm(final)=2.493 | acc=1.0000 | 4543.4 samples/s | 71.0 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00144 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.494 | acc=1.0000 | 4559.8 samples/s | 71.2 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00135 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.494 | acc=1.0000 | 4510.2 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38182 | acc=0.7745 | tpr=0.6746 | fpr=0.0087 | 3921.1 samples/s | 15.3 steps/s
Avg test loss: 0.38087, Avg test acc: 0.77110, Avg tpr: 0.67145, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.41165 | acc=0.8567 | tpr=0.9779 | fpr=0.1455 | 3981.6 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.41386 | acc=0.8588 | tpr=0.9851 | fpr=0.1436 | 7322.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.42162 | acc=0.8576 | tpr=0.9885 | fpr=0.1448 | 8319.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.42037 | acc=0.8582 | tpr=0.9880 | fpr=0.1441 | 7100.2 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.41757 | acc=0.8582 | tpr=0.9878 | fpr=0.1442 | 7698.2 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.41732 | acc=0.8594 | tpr=0.9855 | fpr=0.1429 | 7762.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.41691 | acc=0.8597 | tpr=0.9856 | fpr=0.1426 | 7740.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.41790 | acc=0.8596 | tpr=0.9858 | fpr=0.1427 | 7511.7 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.42126 | acc=0.8593 | tpr=0.9864 | fpr=0.1431 | 7475.5 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.42186 | acc=0.8590 | tpr=0.9859 | fpr=0.1433 | 7619.4 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.41931 | acc=0.8594 | tpr=0.9865 | fpr=0.1429 | 13873.7 samples/s | 54.2 steps/s
Avg test loss: 0.41915, Avg test acc: 0.85939, Avg tpr: 0.98653, Avg fpr: 0.14293, total FA: 19845

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.28756 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.530 | acc=0.8125 | 3793.3 samples/s | 59.3 steps/s
[Step=12050 Epoch=11.8] | Loss=0.03874 | Reg=0.00225 | L2-Norm=15.014 | L2-Norm(final)=2.523 | acc=0.9844 | 4687.4 samples/s | 73.2 steps/s
[Step=12100 Epoch=11.8] | Loss=0.02991 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.532 | acc=1.0000 | 4780.7 samples/s | 74.7 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02796 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.537 | acc=1.0000 | 4702.4 samples/s | 73.5 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02714 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.542 | acc=0.9844 | 4795.1 samples/s | 74.9 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02632 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.544 | acc=0.9688 | 4789.7 samples/s | 74.8 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02494 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.547 | acc=1.0000 | 4750.1 samples/s | 74.2 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02501 | Reg=0.00228 | L2-Norm=15.101 | L2-Norm(final)=2.550 | acc=1.0000 | 4808.9 samples/s | 75.1 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02447 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.552 | acc=0.9375 | 4789.7 samples/s | 74.8 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02404 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.554 | acc=0.9844 | 4727.8 samples/s | 73.9 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02387 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.556 | acc=0.9688 | 4842.5 samples/s | 75.7 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02410 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.557 | acc=1.0000 | 4740.0 samples/s | 74.1 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02400 | Reg=0.00229 | L2-Norm=15.140 | L2-Norm(final)=2.559 | acc=1.0000 | 4749.5 samples/s | 74.2 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02365 | Reg=0.00229 | L2-Norm=15.147 | L2-Norm(final)=2.560 | acc=1.0000 | 4790.6 samples/s | 74.9 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02354 | Reg=0.00230 | L2-Norm=15.154 | L2-Norm(final)=2.562 | acc=0.9688 | 4827.5 samples/s | 75.4 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02330 | Reg=0.00230 | L2-Norm=15.161 | L2-Norm(final)=2.564 | acc=1.0000 | 4735.2 samples/s | 74.0 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02310 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.566 | acc=1.0000 | 4755.9 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.01976 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.532 | acc=0.9844 | 3910.6 samples/s | 61.1 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00499 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.534 | acc=1.0000 | 3980.9 samples/s | 62.2 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00279 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.537 | acc=1.0000 | 4503.1 samples/s | 70.4 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00189 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.540 | acc=1.0000 | 4528.2 samples/s | 70.8 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00143 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.542 | acc=1.0000 | 4585.5 samples/s | 71.6 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00115 | Reg=0.00227 | L2-Norm=15.051 | L2-Norm(final)=2.544 | acc=1.0000 | 4511.6 samples/s | 70.5 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00101 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.546 | acc=1.0000 | 4596.0 samples/s | 71.8 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00087 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.548 | acc=1.0000 | 4534.2 samples/s | 70.8 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00077 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.550 | acc=1.0000 | 4508.7 samples/s | 70.4 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00068 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.552 | acc=1.0000 | 4534.4 samples/s | 70.8 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00062 | Reg=0.00225 | L2-Norm=14.992 | L2-Norm(final)=2.554 | acc=1.0000 | 4599.7 samples/s | 71.9 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00056 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.555 | acc=1.0000 | 1891.3 samples/s | 29.6 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00052 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.556 | acc=1.0000 | 4582.6 samples/s | 71.6 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00048 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.557 | acc=1.0000 | 4310.7 samples/s | 67.4 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00044 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.558 | acc=1.0000 | 4479.7 samples/s | 70.0 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00041 | Reg=0.00223 | L2-Norm=14.923 | L2-Norm(final)=2.559 | acc=1.0000 | 4521.8 samples/s | 70.7 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00039 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.560 | acc=1.0000 | 4501.4 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32277 | acc=0.8138 | tpr=0.7322 | fpr=0.0089 | 3955.0 samples/s | 15.4 steps/s
Avg test loss: 0.32239, Avg test acc: 0.81236, Avg tpr: 0.73078, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.47574 | acc=0.8355 | tpr=0.9779 | fpr=0.1671 | 3942.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.47522 | acc=0.8366 | tpr=0.9851 | fpr=0.1661 | 7629.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.48201 | acc=0.8359 | tpr=0.9885 | fpr=0.1669 | 7505.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.48096 | acc=0.8369 | tpr=0.9880 | fpr=0.1659 | 7970.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.47863 | acc=0.8364 | tpr=0.9878 | fpr=0.1664 | 7364.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.47837 | acc=0.8371 | tpr=0.9869 | fpr=0.1656 | 7686.9 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.47920 | acc=0.8366 | tpr=0.9869 | fpr=0.1661 | 7616.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.48077 | acc=0.8358 | tpr=0.9869 | fpr=0.1669 | 8004.1 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.48415 | acc=0.8354 | tpr=0.9873 | fpr=0.1673 | 7260.1 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.48495 | acc=0.8352 | tpr=0.9868 | fpr=0.1676 | 7450.0 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.48197 | acc=0.8355 | tpr=0.9873 | fpr=0.1672 | 14050.4 samples/s | 54.9 steps/s
Avg test loss: 0.48172, Avg test acc: 0.83556, Avg tpr: 0.98732, Avg fpr: 0.16720, total FA: 23215

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.12793 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.576 | acc=0.9219 | 3558.6 samples/s | 55.6 steps/s
[Step=12850 Epoch=12.5] | Loss=0.03431 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.570 | acc=1.0000 | 4687.6 samples/s | 73.2 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02732 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.581 | acc=0.9844 | 4659.9 samples/s | 72.8 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02598 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.585 | acc=0.9531 | 4788.7 samples/s | 74.8 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02522 | Reg=0.00225 | L2-Norm=14.992 | L2-Norm(final)=2.588 | acc=0.9844 | 4736.8 samples/s | 74.0 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02472 | Reg=0.00225 | L2-Norm=15.005 | L2-Norm(final)=2.593 | acc=0.9844 | 4772.5 samples/s | 74.6 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02421 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.596 | acc=1.0000 | 4785.1 samples/s | 74.8 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02320 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.600 | acc=0.9844 | 4810.9 samples/s | 75.2 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02289 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.604 | acc=0.9844 | 4858.1 samples/s | 75.9 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02238 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.608 | acc=0.9844 | 4745.4 samples/s | 74.1 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02248 | Reg=0.00227 | L2-Norm=15.058 | L2-Norm(final)=2.612 | acc=0.9531 | 4719.3 samples/s | 73.7 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02268 | Reg=0.00227 | L2-Norm=15.067 | L2-Norm(final)=2.614 | acc=0.9844 | 4772.6 samples/s | 74.6 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02235 | Reg=0.00227 | L2-Norm=15.075 | L2-Norm(final)=2.617 | acc=0.9531 | 4796.0 samples/s | 74.9 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02255 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.619 | acc=0.9844 | 4773.4 samples/s | 74.6 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02261 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.621 | acc=1.0000 | 4873.7 samples/s | 76.2 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02249 | Reg=0.00228 | L2-Norm=15.100 | L2-Norm(final)=2.623 | acc=0.9688 | 4718.2 samples/s | 73.7 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02258 | Reg=0.00228 | L2-Norm=15.108 | L2-Norm(final)=2.625 | acc=1.0000 | 4774.8 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.07921 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.577 | acc=0.9219 | 3675.5 samples/s | 57.4 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00360 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.576 | acc=1.0000 | 4131.7 samples/s | 64.6 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00235 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.580 | acc=1.0000 | 4597.8 samples/s | 71.8 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00166 | Reg=0.00225 | L2-Norm=14.990 | L2-Norm(final)=2.583 | acc=1.0000 | 4499.7 samples/s | 70.3 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00126 | Reg=0.00225 | L2-Norm=14.989 | L2-Norm(final)=2.586 | acc=1.0000 | 4513.4 samples/s | 70.5 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00101 | Reg=0.00224 | L2-Norm=14.983 | L2-Norm(final)=2.588 | acc=1.0000 | 4628.6 samples/s | 72.3 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00085 | Reg=0.00224 | L2-Norm=14.973 | L2-Norm(final)=2.590 | acc=1.0000 | 4444.4 samples/s | 69.4 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00073 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.591 | acc=1.0000 | 4610.4 samples/s | 72.0 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00065 | Reg=0.00223 | L2-Norm=14.950 | L2-Norm(final)=2.592 | acc=1.0000 | 4483.6 samples/s | 70.1 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00059 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.594 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00056 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.595 | acc=1.0000 | 4549.3 samples/s | 71.1 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00052 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.596 | acc=1.0000 | 1897.0 samples/s | 29.6 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00047 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.598 | acc=1.0000 | 4557.9 samples/s | 71.2 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00044 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.599 | acc=1.0000 | 4479.3 samples/s | 70.0 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00041 | Reg=0.00222 | L2-Norm=14.884 | L2-Norm(final)=2.601 | acc=1.0000 | 4527.6 samples/s | 70.7 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00038 | Reg=0.00221 | L2-Norm=14.872 | L2-Norm(final)=2.602 | acc=1.0000 | 4528.5 samples/s | 70.8 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00036 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.603 | acc=1.0000 | 4636.1 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33727 | acc=0.7948 | tpr=0.7055 | fpr=0.0111 | 3908.1 samples/s | 15.3 steps/s
Avg test loss: 0.33736, Avg test acc: 0.79586, Avg tpr: 0.70735, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.40691 | acc=0.8605 | tpr=0.9823 | fpr=0.1417 | 3920.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.40661 | acc=0.8629 | tpr=0.9872 | fpr=0.1394 | 7550.7 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.41399 | acc=0.8621 | tpr=0.9870 | fpr=0.1402 | 7704.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.41136 | acc=0.8626 | tpr=0.9869 | fpr=0.1396 | 7690.0 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.40840 | acc=0.8628 | tpr=0.9878 | fpr=0.1395 | 7768.5 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.40949 | acc=0.8634 | tpr=0.9862 | fpr=0.1389 | 7680.5 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.40985 | acc=0.8637 | tpr=0.9862 | fpr=0.1385 | 7562.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.41131 | acc=0.8635 | tpr=0.9863 | fpr=0.1387 | 7541.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.41425 | acc=0.8633 | tpr=0.9864 | fpr=0.1389 | 7615.1 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.41510 | acc=0.8632 | tpr=0.9859 | fpr=0.1391 | 7536.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.41272 | acc=0.8636 | tpr=0.9865 | fpr=0.1387 | 14164.0 samples/s | 55.3 steps/s
Avg test loss: 0.41244, Avg test acc: 0.86359, Avg tpr: 0.98653, Avg fpr: 0.13865, total FA: 19251

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.18589 | Reg=0.00220 | L2-Norm=14.825 | L2-Norm(final)=2.630 | acc=0.8594 | 3707.2 samples/s | 57.9 steps/s
[Step=13650 Epoch=13.3] | Loss=0.04068 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.614 | acc=0.9531 | 4482.4 samples/s | 70.0 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02974 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.623 | acc=0.9844 | 4785.6 samples/s | 74.8 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02627 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.628 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02477 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.633 | acc=0.9844 | 4729.6 samples/s | 73.9 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02388 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.636 | acc=0.9844 | 4769.3 samples/s | 74.5 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02294 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.639 | acc=1.0000 | 4798.6 samples/s | 75.0 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02210 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.643 | acc=0.9688 | 4743.7 samples/s | 74.1 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02141 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.648 | acc=0.9844 | 4788.8 samples/s | 74.8 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02138 | Reg=0.00225 | L2-Norm=15.011 | L2-Norm(final)=2.652 | acc=1.0000 | 4828.0 samples/s | 75.4 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02133 | Reg=0.00226 | L2-Norm=15.019 | L2-Norm(final)=2.656 | acc=0.9844 | 4793.3 samples/s | 74.9 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02121 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.658 | acc=0.9688 | 4789.2 samples/s | 74.8 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02106 | Reg=0.00226 | L2-Norm=15.033 | L2-Norm(final)=2.660 | acc=1.0000 | 4817.8 samples/s | 75.3 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02116 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.662 | acc=1.0000 | 4809.3 samples/s | 75.1 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02121 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.664 | acc=0.9844 | 4834.2 samples/s | 75.5 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02111 | Reg=0.00227 | L2-Norm=15.051 | L2-Norm(final)=2.665 | acc=1.0000 | 4767.5 samples/s | 74.5 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02112 | Reg=0.00227 | L2-Norm=15.057 | L2-Norm(final)=2.667 | acc=1.0000 | 4836.7 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.01280 | Reg=0.00220 | L2-Norm=14.825 | L2-Norm(final)=2.632 | acc=0.9844 | 3815.0 samples/s | 59.6 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00315 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.638 | acc=1.0000 | 4068.5 samples/s | 63.6 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00176 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.642 | acc=1.0000 | 4516.2 samples/s | 70.6 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00118 | Reg=0.00223 | L2-Norm=14.925 | L2-Norm(final)=2.646 | acc=1.0000 | 4512.6 samples/s | 70.5 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00136 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.648 | acc=1.0000 | 4525.0 samples/s | 70.7 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00207 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.644 | acc=0.9844 | 4614.3 samples/s | 72.1 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00266 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.634 | acc=1.0000 | 4476.6 samples/s | 69.9 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00236 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.626 | acc=1.0000 | 4571.6 samples/s | 71.4 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00218 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.620 | acc=1.0000 | 4540.3 samples/s | 70.9 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00196 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.617 | acc=1.0000 | 4477.7 samples/s | 70.0 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00178 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.615 | acc=1.0000 | 4488.9 samples/s | 70.1 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00163 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.614 | acc=1.0000 | 1902.8 samples/s | 29.7 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00150 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.613 | acc=1.0000 | 4531.8 samples/s | 70.8 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00138 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.612 | acc=1.0000 | 4597.7 samples/s | 71.8 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00129 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.611 | acc=1.0000 | 4450.8 samples/s | 69.5 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00120 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.611 | acc=1.0000 | 4501.5 samples/s | 70.3 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00113 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.611 | acc=1.0000 | 4572.7 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38938 | acc=0.7665 | tpr=0.6653 | fpr=0.0139 | 3949.9 samples/s | 15.4 steps/s
Avg test loss: 0.39355, Avg test acc: 0.76356, Avg tpr: 0.66142, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.38426 | acc=0.8755 | tpr=0.9823 | fpr=0.1265 | 3997.1 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.38792 | acc=0.8765 | tpr=0.9893 | fpr=0.1256 | 7570.8 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.39579 | acc=0.8747 | tpr=0.9914 | fpr=0.1274 | 7484.1 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.39400 | acc=0.8758 | tpr=0.9902 | fpr=0.1262 | 7891.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.39097 | acc=0.8756 | tpr=0.9904 | fpr=0.1265 | 7396.2 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.39238 | acc=0.8762 | tpr=0.9884 | fpr=0.1258 | 7795.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.39338 | acc=0.8763 | tpr=0.9881 | fpr=0.1258 | 7488.5 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.39483 | acc=0.8760 | tpr=0.9880 | fpr=0.1260 | 7688.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.39791 | acc=0.8760 | tpr=0.9878 | fpr=0.1260 | 7517.6 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.39797 | acc=0.8761 | tpr=0.9872 | fpr=0.1259 | 7433.0 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.39506 | acc=0.8768 | tpr=0.9877 | fpr=0.1252 | 14043.6 samples/s | 54.9 steps/s
Avg test loss: 0.39481, Avg test acc: 0.87681, Avg tpr: 0.98772, Avg fpr: 0.12520, total FA: 17384

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.30268 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.642 | acc=0.7656 | 3711.8 samples/s | 58.0 steps/s
[Step=14450 Epoch=14.1] | Loss=0.04493 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.631 | acc=0.9844 | 4396.7 samples/s | 68.7 steps/s
[Step=14500 Epoch=14.2] | Loss=0.03410 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.640 | acc=0.9844 | 4782.4 samples/s | 74.7 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02998 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.645 | acc=0.9844 | 4756.5 samples/s | 74.3 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02722 | Reg=0.00223 | L2-Norm=14.947 | L2-Norm(final)=2.650 | acc=1.0000 | 4719.0 samples/s | 73.7 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02668 | Reg=0.00224 | L2-Norm=14.957 | L2-Norm(final)=2.653 | acc=0.9844 | 4759.5 samples/s | 74.4 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02562 | Reg=0.00224 | L2-Norm=14.967 | L2-Norm(final)=2.656 | acc=0.9844 | 4739.9 samples/s | 74.1 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02540 | Reg=0.00224 | L2-Norm=14.977 | L2-Norm(final)=2.659 | acc=0.9531 | 4782.5 samples/s | 74.7 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02489 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.662 | acc=0.9844 | 4795.7 samples/s | 74.9 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02412 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.665 | acc=0.9688 | 4746.7 samples/s | 74.2 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02371 | Reg=0.00225 | L2-Norm=15.007 | L2-Norm(final)=2.669 | acc=0.9531 | 4789.6 samples/s | 74.8 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02338 | Reg=0.00225 | L2-Norm=15.016 | L2-Norm(final)=2.671 | acc=0.9844 | 4691.5 samples/s | 73.3 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02336 | Reg=0.00226 | L2-Norm=15.024 | L2-Norm(final)=2.673 | acc=0.9844 | 4778.3 samples/s | 74.7 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02317 | Reg=0.00226 | L2-Norm=15.032 | L2-Norm(final)=2.675 | acc=0.9688 | 4780.6 samples/s | 74.7 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02283 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.677 | acc=0.9844 | 4678.8 samples/s | 73.1 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02279 | Reg=0.00226 | L2-Norm=15.048 | L2-Norm(final)=2.679 | acc=0.9688 | 4791.0 samples/s | 74.9 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02272 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.681 | acc=1.0000 | 4829.1 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.05753 | Reg=0.00220 | L2-Norm=14.835 | L2-Norm(final)=2.642 | acc=0.9688 | 3683.0 samples/s | 57.5 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00738 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.633 | acc=1.0000 | 4404.0 samples/s | 68.8 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00434 | Reg=0.00224 | L2-Norm=14.951 | L2-Norm(final)=2.628 | acc=1.0000 | 4433.3 samples/s | 69.3 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00295 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.629 | acc=1.0000 | 4550.2 samples/s | 71.1 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00224 | Reg=0.00224 | L2-Norm=14.962 | L2-Norm(final)=2.631 | acc=1.0000 | 4535.0 samples/s | 70.9 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00181 | Reg=0.00224 | L2-Norm=14.958 | L2-Norm(final)=2.634 | acc=1.0000 | 4499.7 samples/s | 70.3 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00152 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.636 | acc=1.0000 | 4496.1 samples/s | 70.3 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00130 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.639 | acc=1.0000 | 4613.2 samples/s | 72.1 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00114 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.641 | acc=1.0000 | 4454.9 samples/s | 69.6 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00102 | Reg=0.00223 | L2-Norm=14.925 | L2-Norm(final)=2.642 | acc=1.0000 | 4539.1 samples/s | 70.9 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00092 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.644 | acc=1.0000 | 4584.8 samples/s | 71.6 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00084 | Reg=0.00222 | L2-Norm=14.904 | L2-Norm(final)=2.645 | acc=1.0000 | 1899.7 samples/s | 29.7 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00077 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.647 | acc=1.0000 | 4569.4 samples/s | 71.4 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00071 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.648 | acc=1.0000 | 4521.5 samples/s | 70.6 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00066 | Reg=0.00221 | L2-Norm=14.870 | L2-Norm(final)=2.649 | acc=1.0000 | 4552.1 samples/s | 71.1 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00062 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.650 | acc=1.0000 | 4522.7 samples/s | 70.7 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00058 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.651 | acc=1.0000 | 4516.9 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27312 | acc=0.8179 | tpr=0.7400 | fpr=0.0129 | 3911.7 samples/s | 15.3 steps/s
Avg test loss: 0.27561, Avg test acc: 0.81633, Avg tpr: 0.73818, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.44199 | acc=0.8462 | tpr=0.9867 | fpr=0.1564 | 3958.0 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.44509 | acc=0.8476 | tpr=0.9893 | fpr=0.1551 | 7442.7 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.45081 | acc=0.8468 | tpr=0.9899 | fpr=0.1558 | 7835.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.44844 | acc=0.8474 | tpr=0.9880 | fpr=0.1551 | 7528.8 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.44757 | acc=0.8471 | tpr=0.9886 | fpr=0.1555 | 7938.3 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.44861 | acc=0.8477 | tpr=0.9869 | fpr=0.1548 | 7349.5 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.44998 | acc=0.8475 | tpr=0.9869 | fpr=0.1550 | 7825.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.45135 | acc=0.8471 | tpr=0.9874 | fpr=0.1555 | 7545.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.45433 | acc=0.8470 | tpr=0.9878 | fpr=0.1555 | 7434.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.45474 | acc=0.8469 | tpr=0.9872 | fpr=0.1556 | 7533.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.45155 | acc=0.8474 | tpr=0.9877 | fpr=0.1551 | 14055.4 samples/s | 54.9 steps/s
Avg test loss: 0.45122, Avg test acc: 0.84745, Avg tpr: 0.98772, Avg fpr: 0.15510, total FA: 21535

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.09480 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.684 | acc=0.9375 | 3809.8 samples/s | 59.5 steps/s
[Step=15250 Epoch=14.9] | Loss=0.03728 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.681 | acc=0.9688 | 4285.6 samples/s | 67.0 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02800 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.691 | acc=1.0000 | 4776.0 samples/s | 74.6 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02442 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.702 | acc=0.9844 | 4571.5 samples/s | 71.4 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02226 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.708 | acc=1.0000 | 4692.1 samples/s | 73.3 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02213 | Reg=0.00222 | L2-Norm=14.916 | L2-Norm(final)=2.713 | acc=0.9844 | 4802.8 samples/s | 75.0 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02193 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.717 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02139 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.721 | acc=0.9844 | 4824.5 samples/s | 75.4 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02097 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.725 | acc=0.9844 | 4714.9 samples/s | 73.7 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02058 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.728 | acc=1.0000 | 4773.2 samples/s | 74.6 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02073 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.731 | acc=1.0000 | 4776.2 samples/s | 74.6 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02044 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.734 | acc=0.9844 | 4841.9 samples/s | 75.7 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02031 | Reg=0.00224 | L2-Norm=14.979 | L2-Norm(final)=2.736 | acc=1.0000 | 4710.7 samples/s | 73.6 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02028 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.738 | acc=0.9844 | 4756.7 samples/s | 74.3 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02019 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.741 | acc=0.9688 | 4796.5 samples/s | 74.9 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02011 | Reg=0.00225 | L2-Norm=15.003 | L2-Norm(final)=2.742 | acc=1.0000 | 4802.3 samples/s | 75.0 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01990 | Reg=0.00225 | L2-Norm=15.010 | L2-Norm(final)=2.744 | acc=0.9844 | 4751.7 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.03571 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.685 | acc=0.9531 | 3981.0 samples/s | 62.2 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00626 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.682 | acc=1.0000 | 3793.6 samples/s | 59.3 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00483 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.686 | acc=1.0000 | 4481.5 samples/s | 70.0 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00346 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.681 | acc=1.0000 | 4487.8 samples/s | 70.1 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00267 | Reg=0.00225 | L2-Norm=14.995 | L2-Norm(final)=2.679 | acc=1.0000 | 4505.9 samples/s | 70.4 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00215 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.678 | acc=1.0000 | 4571.1 samples/s | 71.4 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00180 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.678 | acc=1.0000 | 4539.6 samples/s | 70.9 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00156 | Reg=0.00225 | L2-Norm=14.988 | L2-Norm(final)=2.679 | acc=1.0000 | 4405.0 samples/s | 68.8 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00137 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.680 | acc=1.0000 | 4499.6 samples/s | 70.3 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00122 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.681 | acc=1.0000 | 4475.4 samples/s | 69.9 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00110 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.682 | acc=1.0000 | 4519.8 samples/s | 70.6 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00100 | Reg=0.00224 | L2-Norm=14.959 | L2-Norm(final)=2.683 | acc=1.0000 | 1873.6 samples/s | 29.3 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00092 | Reg=0.00224 | L2-Norm=14.950 | L2-Norm(final)=2.684 | acc=1.0000 | 4604.2 samples/s | 71.9 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00085 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.685 | acc=1.0000 | 4495.2 samples/s | 70.2 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00079 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.686 | acc=1.0000 | 4511.0 samples/s | 70.5 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00074 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.687 | acc=1.0000 | 4530.7 samples/s | 70.8 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00069 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.688 | acc=1.0000 | 4494.3 samples/s | 70.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34443 | acc=0.7937 | tpr=0.7036 | fpr=0.0104 | 3948.5 samples/s | 15.4 steps/s
Avg test loss: 0.34374, Avg test acc: 0.79277, Avg tpr: 0.70304, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.38436 | acc=0.8795 | tpr=0.9823 | fpr=0.1223 | 3950.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.38811 | acc=0.8795 | tpr=0.9872 | fpr=0.1225 | 7611.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.39660 | acc=0.8800 | tpr=0.9899 | fpr=0.1220 | 7625.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.39668 | acc=0.8806 | tpr=0.9902 | fpr=0.1213 | 7815.5 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.39359 | acc=0.8811 | tpr=0.9895 | fpr=0.1209 | 7478.7 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.39567 | acc=0.8816 | tpr=0.9876 | fpr=0.1203 | 7722.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.39680 | acc=0.8816 | tpr=0.9869 | fpr=0.1203 | 8109.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.39808 | acc=0.8813 | tpr=0.9874 | fpr=0.1206 | 7194.5 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.40185 | acc=0.8808 | tpr=0.9873 | fpr=0.1211 | 7935.2 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.40165 | acc=0.8807 | tpr=0.9872 | fpr=0.1212 | 7506.8 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.39894 | acc=0.8813 | tpr=0.9877 | fpr=0.1206 | 13302.9 samples/s | 52.0 steps/s
Avg test loss: 0.39850, Avg test acc: 0.88132, Avg tpr: 0.98772, Avg fpr: 0.12061, total FA: 16747

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.12268 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.732 | acc=0.8906 | 3692.5 samples/s | 57.7 steps/s
[Step=16050 Epoch=15.7] | Loss=0.04358 | Reg=0.00220 | L2-Norm=14.845 | L2-Norm(final)=2.724 | acc=1.0000 | 4582.3 samples/s | 71.6 steps/s
[Step=16100 Epoch=15.7] | Loss=0.02912 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.730 | acc=0.9688 | 4764.6 samples/s | 74.4 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02446 | Reg=0.00221 | L2-Norm=14.865 | L2-Norm(final)=2.736 | acc=0.9688 | 4703.9 samples/s | 73.5 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02296 | Reg=0.00221 | L2-Norm=14.870 | L2-Norm(final)=2.740 | acc=0.9688 | 4736.0 samples/s | 74.0 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02137 | Reg=0.00221 | L2-Norm=14.873 | L2-Norm(final)=2.743 | acc=0.9688 | 4774.1 samples/s | 74.6 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01992 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.746 | acc=0.9688 | 4755.8 samples/s | 74.3 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01891 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.749 | acc=1.0000 | 4806.0 samples/s | 75.1 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01905 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.752 | acc=0.9531 | 4748.3 samples/s | 74.2 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01858 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.754 | acc=0.9844 | 4747.5 samples/s | 74.2 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01815 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.756 | acc=0.9688 | 4770.8 samples/s | 74.5 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01811 | Reg=0.00222 | L2-Norm=14.890 | L2-Norm(final)=2.757 | acc=1.0000 | 4832.6 samples/s | 75.5 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01776 | Reg=0.00222 | L2-Norm=14.892 | L2-Norm(final)=2.759 | acc=1.0000 | 4823.5 samples/s | 75.4 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01768 | Reg=0.00222 | L2-Norm=14.894 | L2-Norm(final)=2.761 | acc=0.9375 | 4699.7 samples/s | 73.4 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01744 | Reg=0.00222 | L2-Norm=14.896 | L2-Norm(final)=2.763 | acc=1.0000 | 4816.9 samples/s | 75.3 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01713 | Reg=0.00222 | L2-Norm=14.898 | L2-Norm(final)=2.764 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01686 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.766 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.07091 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.731 | acc=0.9844 | 3888.3 samples/s | 60.8 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00384 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.726 | acc=1.0000 | 3905.0 samples/s | 61.0 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00202 | Reg=0.00220 | L2-Norm=14.834 | L2-Norm(final)=2.727 | acc=1.0000 | 4573.8 samples/s | 71.5 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00138 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.729 | acc=1.0000 | 4500.8 samples/s | 70.3 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00104 | Reg=0.00220 | L2-Norm=14.827 | L2-Norm(final)=2.730 | acc=1.0000 | 4461.1 samples/s | 69.7 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00084 | Reg=0.00220 | L2-Norm=14.822 | L2-Norm(final)=2.731 | acc=1.0000 | 4495.5 samples/s | 70.2 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00071 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.732 | acc=1.0000 | 4513.2 samples/s | 70.5 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00066 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.733 | acc=1.0000 | 4588.7 samples/s | 71.7 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00059 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.735 | acc=1.0000 | 4507.9 samples/s | 70.4 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00052 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.736 | acc=1.0000 | 4517.1 samples/s | 70.6 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00048 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.737 | acc=1.0000 | 4581.0 samples/s | 71.6 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00043 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.738 | acc=1.0000 | 1896.7 samples/s | 29.6 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00040 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.738 | acc=1.0000 | 4547.7 samples/s | 71.1 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00037 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.739 | acc=1.0000 | 4572.9 samples/s | 71.5 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00034 | Reg=0.00218 | L2-Norm=14.774 | L2-Norm(final)=2.740 | acc=1.0000 | 4580.1 samples/s | 71.6 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00032 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.740 | acc=1.0000 | 4427.0 samples/s | 69.2 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00030 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.741 | acc=1.0000 | 4561.6 samples/s | 71.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23678 | acc=0.8578 | tpr=0.7975 | fpr=0.0111 | 3989.9 samples/s | 15.6 steps/s
Avg test loss: 0.23626, Avg test acc: 0.85668, Avg tpr: 0.79641, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.54905 | acc=0.8304 | tpr=0.9867 | fpr=0.1724 | 3960.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.54711 | acc=0.8340 | tpr=0.9893 | fpr=0.1689 | 7676.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.55655 | acc=0.8337 | tpr=0.9914 | fpr=0.1692 | 8084.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.55569 | acc=0.8345 | tpr=0.9923 | fpr=0.1684 | 7170.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.55340 | acc=0.8340 | tpr=0.9921 | fpr=0.1689 | 7905.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.55506 | acc=0.8345 | tpr=0.9898 | fpr=0.1684 | 7458.7 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.55677 | acc=0.8339 | tpr=0.9894 | fpr=0.1689 | 7693.9 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.55797 | acc=0.8338 | tpr=0.9896 | fpr=0.1690 | 7557.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.56202 | acc=0.8333 | tpr=0.9898 | fpr=0.1695 | 7711.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.56238 | acc=0.8334 | tpr=0.9894 | fpr=0.1694 | 7581.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.55929 | acc=0.8336 | tpr=0.9897 | fpr=0.1692 | 13889.7 samples/s | 54.3 steps/s
Avg test loss: 0.55894, Avg test acc: 0.83367, Avg tpr: 0.98970, Avg fpr: 0.16917, total FA: 23489

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.09664 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.769 | acc=0.9219 | 3835.9 samples/s | 59.9 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02620 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.768 | acc=0.9688 | 4485.7 samples/s | 70.1 steps/s
[Step=16900 Epoch=16.5] | Loss=0.01879 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.774 | acc=1.0000 | 4696.4 samples/s | 73.4 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01671 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.779 | acc=0.9844 | 4769.7 samples/s | 74.5 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01622 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=2.783 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01513 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.787 | acc=0.9531 | 4792.4 samples/s | 74.9 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01501 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.790 | acc=0.9844 | 4798.9 samples/s | 75.0 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01511 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.792 | acc=0.9688 | 4761.9 samples/s | 74.4 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01493 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.795 | acc=1.0000 | 4783.1 samples/s | 74.7 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01461 | Reg=0.00219 | L2-Norm=14.803 | L2-Norm(final)=2.797 | acc=1.0000 | 4792.5 samples/s | 74.9 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01465 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.800 | acc=0.9844 | 4835.7 samples/s | 75.6 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01473 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.802 | acc=0.9844 | 4823.3 samples/s | 75.4 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01453 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.805 | acc=1.0000 | 4747.7 samples/s | 74.2 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01411 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.807 | acc=0.9844 | 4800.2 samples/s | 75.0 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01420 | Reg=0.00219 | L2-Norm=14.815 | L2-Norm(final)=2.809 | acc=1.0000 | 4776.4 samples/s | 74.6 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01399 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.812 | acc=0.9688 | 4771.6 samples/s | 74.6 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01417 | Reg=0.00220 | L2-Norm=14.820 | L2-Norm(final)=2.814 | acc=0.9844 | 4800.8 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.09423 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.769 | acc=0.9688 | 3645.7 samples/s | 57.0 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00520 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.762 | acc=1.0000 | 4128.6 samples/s | 64.5 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00271 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.763 | acc=1.0000 | 4495.8 samples/s | 70.2 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00183 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.765 | acc=1.0000 | 4511.1 samples/s | 70.5 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00139 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.766 | acc=1.0000 | 4486.6 samples/s | 70.1 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00114 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.767 | acc=1.0000 | 4531.2 samples/s | 70.8 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00095 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=2.769 | acc=1.0000 | 4558.3 samples/s | 71.2 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00082 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.770 | acc=1.0000 | 4611.7 samples/s | 72.1 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00072 | Reg=0.00218 | L2-Norm=14.778 | L2-Norm(final)=2.771 | acc=1.0000 | 4520.3 samples/s | 70.6 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00064 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.772 | acc=1.0000 | 4507.2 samples/s | 70.4 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00058 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.773 | acc=1.0000 | 4609.7 samples/s | 72.0 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00053 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.774 | acc=1.0000 | 1856.3 samples/s | 29.0 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00049 | Reg=0.00218 | L2-Norm=14.755 | L2-Norm(final)=2.774 | acc=1.0000 | 4538.3 samples/s | 70.9 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00045 | Reg=0.00218 | L2-Norm=14.749 | L2-Norm(final)=2.775 | acc=1.0000 | 4486.0 samples/s | 70.1 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00042 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.776 | acc=1.0000 | 4501.7 samples/s | 70.3 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00039 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.776 | acc=1.0000 | 4603.5 samples/s | 71.9 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00037 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.777 | acc=1.0000 | 4441.4 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27245 | acc=0.8386 | tpr=0.7701 | fpr=0.0126 | 3959.4 samples/s | 15.5 steps/s
Avg test loss: 0.27413, Avg test acc: 0.83717, Avg tpr: 0.76802, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.51886 | acc=0.8524 | tpr=0.9867 | fpr=0.1500 | 3956.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.51967 | acc=0.8552 | tpr=0.9872 | fpr=0.1473 | 7580.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.52837 | acc=0.8546 | tpr=0.9899 | fpr=0.1479 | 7652.5 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.52753 | acc=0.8546 | tpr=0.9913 | fpr=0.1478 | 8108.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.52534 | acc=0.8545 | tpr=0.9913 | fpr=0.1480 | 7316.2 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.52699 | acc=0.8548 | tpr=0.9891 | fpr=0.1477 | 7548.4 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.52868 | acc=0.8546 | tpr=0.9887 | fpr=0.1478 | 7688.8 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.53023 | acc=0.8544 | tpr=0.9891 | fpr=0.1480 | 8262.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.53433 | acc=0.8541 | tpr=0.9893 | fpr=0.1484 | 6931.3 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.53475 | acc=0.8541 | tpr=0.9890 | fpr=0.1483 | 7773.6 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.53170 | acc=0.8545 | tpr=0.9893 | fpr=0.1480 | 14030.1 samples/s | 54.8 steps/s
Avg test loss: 0.53122, Avg test acc: 0.85443, Avg tpr: 0.98930, Avg fpr: 0.14802, total FA: 20552

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.27719 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.814 | acc=0.8750 | 3790.9 samples/s | 59.2 steps/s
[Step=17650 Epoch=17.2] | Loss=0.02726 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.804 | acc=0.9844 | 4534.5 samples/s | 70.9 steps/s
[Step=17700 Epoch=17.3] | Loss=0.01946 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.808 | acc=1.0000 | 4789.0 samples/s | 74.8 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01772 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.812 | acc=1.0000 | 4735.6 samples/s | 74.0 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01687 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.815 | acc=1.0000 | 4803.3 samples/s | 75.1 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01571 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.818 | acc=1.0000 | 4728.0 samples/s | 73.9 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01508 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.821 | acc=0.9688 | 4849.3 samples/s | 75.8 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01491 | Reg=0.00218 | L2-Norm=14.749 | L2-Norm(final)=2.823 | acc=1.0000 | 4722.6 samples/s | 73.8 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01486 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.825 | acc=0.9844 | 4754.6 samples/s | 74.3 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01477 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.827 | acc=0.9688 | 4780.9 samples/s | 74.7 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01455 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.829 | acc=0.9844 | 4837.5 samples/s | 75.6 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01438 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.831 | acc=0.9688 | 4788.1 samples/s | 74.8 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01443 | Reg=0.00218 | L2-Norm=14.760 | L2-Norm(final)=2.833 | acc=1.0000 | 4776.8 samples/s | 74.6 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01424 | Reg=0.00218 | L2-Norm=14.762 | L2-Norm(final)=2.835 | acc=1.0000 | 4788.9 samples/s | 74.8 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01413 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.837 | acc=1.0000 | 4796.2 samples/s | 74.9 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01418 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.838 | acc=0.9844 | 4852.5 samples/s | 75.8 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01413 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.840 | acc=1.0000 | 4722.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.07728 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.815 | acc=0.9688 | 3956.7 samples/s | 61.8 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00550 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.815 | acc=1.0000 | 3959.1 samples/s | 61.9 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00329 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.815 | acc=1.0000 | 4519.1 samples/s | 70.6 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00222 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.816 | acc=1.0000 | 4496.8 samples/s | 70.3 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00168 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.817 | acc=1.0000 | 4518.2 samples/s | 70.6 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00137 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.818 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00115 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.819 | acc=1.0000 | 4527.6 samples/s | 70.7 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00099 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.820 | acc=1.0000 | 4517.5 samples/s | 70.6 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00087 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.820 | acc=1.0000 | 4584.5 samples/s | 71.6 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00077 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.821 | acc=1.0000 | 4467.0 samples/s | 69.8 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00070 | Reg=0.00217 | L2-Norm=14.728 | L2-Norm(final)=2.822 | acc=1.0000 | 4639.7 samples/s | 72.5 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00064 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.822 | acc=1.0000 | 1928.7 samples/s | 30.1 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00058 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.823 | acc=1.0000 | 4641.2 samples/s | 72.5 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00054 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.823 | acc=1.0000 | 4516.3 samples/s | 70.6 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00050 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.824 | acc=1.0000 | 4498.4 samples/s | 70.3 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00047 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=2.824 | acc=1.0000 | 4531.1 samples/s | 70.8 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00044 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.825 | acc=1.0000 | 4577.0 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26178 | acc=0.8453 | tpr=0.7783 | fpr=0.0092 | 3957.9 samples/s | 15.5 steps/s
Avg test loss: 0.26376, Avg test acc: 0.84390, Avg tpr: 0.77688, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.51439 | acc=0.8544 | tpr=0.9867 | fpr=0.1480 | 3871.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.51880 | acc=0.8552 | tpr=0.9872 | fpr=0.1472 | 7772.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.52691 | acc=0.8552 | tpr=0.9899 | fpr=0.1473 | 7609.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.52624 | acc=0.8556 | tpr=0.9902 | fpr=0.1469 | 7606.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.52381 | acc=0.8555 | tpr=0.9895 | fpr=0.1469 | 7628.4 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.52547 | acc=0.8558 | tpr=0.9876 | fpr=0.1466 | 7552.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.52667 | acc=0.8557 | tpr=0.9875 | fpr=0.1467 | 7696.6 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.52816 | acc=0.8557 | tpr=0.9880 | fpr=0.1467 | 7729.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.53255 | acc=0.8553 | tpr=0.9883 | fpr=0.1471 | 7464.6 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.53265 | acc=0.8552 | tpr=0.9881 | fpr=0.1472 | 7255.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.53005 | acc=0.8556 | tpr=0.9885 | fpr=0.1468 | 14468.6 samples/s | 56.5 steps/s
Avg test loss: 0.52959, Avg test acc: 0.85559, Avg tpr: 0.98851, Avg fpr: 0.14682, total FA: 20386

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.18809 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.847 | acc=0.8750 | 3879.7 samples/s | 60.6 steps/s
[Step=18450 Epoch=18.0] | Loss=0.02837 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.841 | acc=0.9844 | 4582.1 samples/s | 71.6 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02171 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=2.844 | acc=1.0000 | 4800.3 samples/s | 75.0 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01887 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=2.847 | acc=1.0000 | 4675.9 samples/s | 73.1 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01796 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.849 | acc=1.0000 | 4765.2 samples/s | 74.5 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01640 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.851 | acc=1.0000 | 4817.2 samples/s | 75.3 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01652 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.854 | acc=1.0000 | 4738.4 samples/s | 74.0 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01572 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.856 | acc=1.0000 | 4792.4 samples/s | 74.9 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01545 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.859 | acc=1.0000 | 4800.4 samples/s | 75.0 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01532 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.861 | acc=1.0000 | 4792.0 samples/s | 74.9 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01502 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.863 | acc=1.0000 | 4769.2 samples/s | 74.5 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01477 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.865 | acc=0.9844 | 4793.4 samples/s | 74.9 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01457 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.867 | acc=1.0000 | 4804.3 samples/s | 75.1 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01432 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=2.869 | acc=1.0000 | 4803.4 samples/s | 75.1 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01410 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.871 | acc=1.0000 | 4792.2 samples/s | 74.9 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01417 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.873 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01427 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.874 | acc=0.9844 | 4794.9 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.04228 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.847 | acc=0.9844 | 3898.4 samples/s | 60.9 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00601 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.837 | acc=1.0000 | 3981.0 samples/s | 62.2 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00322 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.837 | acc=1.0000 | 4549.7 samples/s | 71.1 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00217 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=2.838 | acc=1.0000 | 4490.4 samples/s | 70.2 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00164 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.839 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00132 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=2.839 | acc=1.0000 | 4500.3 samples/s | 70.3 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00112 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.840 | acc=1.0000 | 4579.8 samples/s | 71.6 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00096 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.841 | acc=1.0000 | 4531.5 samples/s | 70.8 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00084 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.842 | acc=1.0000 | 4584.5 samples/s | 71.6 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00075 | Reg=0.00216 | L2-Norm=14.686 | L2-Norm(final)=2.843 | acc=1.0000 | 4516.1 samples/s | 70.6 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00068 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.844 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00062 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.844 | acc=1.0000 | 1940.9 samples/s | 30.3 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00057 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.845 | acc=1.0000 | 4460.8 samples/s | 69.7 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00052 | Reg=0.00215 | L2-Norm=14.667 | L2-Norm(final)=2.846 | acc=1.0000 | 4484.7 samples/s | 70.1 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00049 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.846 | acc=1.0000 | 4556.3 samples/s | 71.2 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00046 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.847 | acc=1.0000 | 4564.8 samples/s | 71.3 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00043 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.847 | acc=1.0000 | 4493.5 samples/s | 70.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25647 | acc=0.8462 | tpr=0.7798 | fpr=0.0094 | 3915.3 samples/s | 15.3 steps/s
Avg test loss: 0.25882, Avg test acc: 0.84474, Avg tpr: 0.77834, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.53190 | acc=0.8428 | tpr=0.9823 | fpr=0.1597 | 3902.1 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.53537 | acc=0.8468 | tpr=0.9872 | fpr=0.1558 | 7773.4 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.54257 | acc=0.8462 | tpr=0.9885 | fpr=0.1564 | 7598.9 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.54226 | acc=0.8463 | tpr=0.9880 | fpr=0.1562 | 7772.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.54015 | acc=0.8461 | tpr=0.9878 | fpr=0.1565 | 7500.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.54209 | acc=0.8461 | tpr=0.9862 | fpr=0.1565 | 7903.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.54391 | acc=0.8460 | tpr=0.9862 | fpr=0.1565 | 7391.6 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.54608 | acc=0.8458 | tpr=0.9869 | fpr=0.1568 | 7731.6 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.55078 | acc=0.8455 | tpr=0.9873 | fpr=0.1571 | 7545.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.55159 | acc=0.8453 | tpr=0.9868 | fpr=0.1573 | 7362.4 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.54917 | acc=0.8453 | tpr=0.9869 | fpr=0.1573 | 14526.6 samples/s | 56.7 steps/s
Avg test loss: 0.54872, Avg test acc: 0.84528, Avg tpr: 0.98693, Avg fpr: 0.15729, total FA: 21840

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.11652 | Reg=0.00214 | L2-Norm=14.620 | L2-Norm(final)=2.874 | acc=0.9375 | 3899.7 samples/s | 60.9 steps/s
[Step=19250 Epoch=18.8] | Loss=0.03264 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.863 | acc=0.9844 | 4716.3 samples/s | 73.7 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02328 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.866 | acc=1.0000 | 4682.6 samples/s | 73.2 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01936 | Reg=0.00215 | L2-Norm=14.667 | L2-Norm(final)=2.870 | acc=1.0000 | 4824.7 samples/s | 75.4 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01796 | Reg=0.00215 | L2-Norm=14.672 | L2-Norm(final)=2.874 | acc=0.9844 | 4751.5 samples/s | 74.2 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01757 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.877 | acc=1.0000 | 4672.3 samples/s | 73.0 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01671 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.879 | acc=1.0000 | 4776.7 samples/s | 74.6 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01582 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.882 | acc=1.0000 | 4790.4 samples/s | 74.9 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01570 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.884 | acc=0.9688 | 4778.8 samples/s | 74.7 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01528 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.886 | acc=1.0000 | 4815.8 samples/s | 75.2 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01504 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=2.889 | acc=0.9844 | 4728.0 samples/s | 73.9 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01467 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.890 | acc=0.9844 | 4782.5 samples/s | 74.7 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01455 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.892 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01445 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.894 | acc=1.0000 | 4701.0 samples/s | 73.5 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01420 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.895 | acc=0.9844 | 4763.0 samples/s | 74.4 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01409 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.897 | acc=1.0000 | 4750.5 samples/s | 74.2 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01403 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.898 | acc=0.9844 | 4759.3 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.03160 | Reg=0.00214 | L2-Norm=14.620 | L2-Norm(final)=2.875 | acc=0.9844 | 3829.4 samples/s | 59.8 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00612 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=2.874 | acc=1.0000 | 4019.7 samples/s | 62.8 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00338 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=2.876 | acc=1.0000 | 4531.0 samples/s | 70.8 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00229 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.877 | acc=1.0000 | 4568.9 samples/s | 71.4 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00173 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.879 | acc=1.0000 | 4482.1 samples/s | 70.0 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00139 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.880 | acc=1.0000 | 4554.9 samples/s | 71.2 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00116 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.881 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00100 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.881 | acc=1.0000 | 4480.1 samples/s | 70.0 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00088 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.882 | acc=1.0000 | 4544.5 samples/s | 71.0 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00078 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.883 | acc=1.0000 | 4529.3 samples/s | 70.8 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00070 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=2.883 | acc=1.0000 | 4586.1 samples/s | 71.7 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00064 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.884 | acc=1.0000 | 1880.9 samples/s | 29.4 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00059 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.884 | acc=1.0000 | 4592.5 samples/s | 71.8 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00054 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.885 | acc=1.0000 | 4530.3 samples/s | 70.8 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00051 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.885 | acc=1.0000 | 4543.9 samples/s | 71.0 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00047 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.886 | acc=1.0000 | 4492.2 samples/s | 70.2 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00044 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.886 | acc=1.0000 | 4602.1 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23941 | acc=0.8645 | tpr=0.8075 | fpr=0.0119 | 3932.0 samples/s | 15.4 steps/s
Avg test loss: 0.23995, Avg test acc: 0.86293, Avg tpr: 0.80597, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.54790 | acc=0.8482 | tpr=0.9867 | fpr=0.1543 | 3989.3 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.55138 | acc=0.8516 | tpr=0.9893 | fpr=0.1509 | 7527.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.55991 | acc=0.8507 | tpr=0.9914 | fpr=0.1519 | 7515.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.55919 | acc=0.8512 | tpr=0.9902 | fpr=0.1513 | 7601.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.55725 | acc=0.8507 | tpr=0.9895 | fpr=0.1518 | 7633.5 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.55895 | acc=0.8508 | tpr=0.9876 | fpr=0.1517 | 7501.8 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.56030 | acc=0.8509 | tpr=0.9875 | fpr=0.1516 | 7844.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.56232 | acc=0.8506 | tpr=0.9874 | fpr=0.1519 | 7775.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.56680 | acc=0.8504 | tpr=0.9878 | fpr=0.1521 | 7470.1 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.56716 | acc=0.8502 | tpr=0.9877 | fpr=0.1523 | 7591.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.56462 | acc=0.8506 | tpr=0.9881 | fpr=0.1519 | 13862.9 samples/s | 54.2 steps/s
Avg test loss: 0.56420, Avg test acc: 0.85062, Avg tpr: 0.98811, Avg fpr: 0.15188, total FA: 21088

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.11320 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.905 | acc=0.9531 | 3841.8 samples/s | 60.0 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02533 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.903 | acc=1.0000 | 4177.8 samples/s | 65.3 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01889 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.907 | acc=1.0000 | 4786.2 samples/s | 74.8 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01633 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.912 | acc=0.9844 | 4597.2 samples/s | 71.8 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01458 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.916 | acc=0.9844 | 4546.8 samples/s | 71.0 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01412 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.920 | acc=0.9844 | 4664.4 samples/s | 72.9 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01420 | Reg=0.00215 | L2-Norm=14.667 | L2-Norm(final)=2.921 | acc=1.0000 | 4788.6 samples/s | 74.8 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01388 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.923 | acc=0.9688 | 4761.2 samples/s | 74.4 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01333 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.924 | acc=1.0000 | 4783.9 samples/s | 74.7 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01288 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=2.926 | acc=0.9844 | 4783.2 samples/s | 74.7 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01304 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.929 | acc=1.0000 | 4813.0 samples/s | 75.2 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01324 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.931 | acc=1.0000 | 4767.0 samples/s | 74.5 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01324 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.932 | acc=0.9688 | 4795.5 samples/s | 74.9 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01337 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.934 | acc=0.9688 | 4761.7 samples/s | 74.4 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01336 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.936 | acc=1.0000 | 4821.1 samples/s | 75.3 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01316 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.938 | acc=1.0000 | 4756.2 samples/s | 74.3 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01335 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.940 | acc=1.0000 | 4796.6 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.11836 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.906 | acc=0.9375 | 3397.6 samples/s | 53.1 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00633 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.901 | acc=1.0000 | 4472.3 samples/s | 69.9 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00323 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.902 | acc=1.0000 | 4590.4 samples/s | 71.7 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00217 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.902 | acc=1.0000 | 4546.6 samples/s | 71.0 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00165 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.903 | acc=1.0000 | 4497.6 samples/s | 70.3 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00134 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.905 | acc=1.0000 | 4522.0 samples/s | 70.7 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00113 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.906 | acc=1.0000 | 4548.6 samples/s | 71.1 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00097 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.907 | acc=1.0000 | 4547.8 samples/s | 71.1 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00085 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.908 | acc=1.0000 | 4523.7 samples/s | 70.7 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00076 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.909 | acc=1.0000 | 4451.8 samples/s | 69.6 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00068 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.909 | acc=1.0000 | 4578.8 samples/s | 71.5 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00062 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.910 | acc=1.0000 | 1875.1 samples/s | 29.3 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00057 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.911 | acc=1.0000 | 4567.9 samples/s | 71.4 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00053 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.911 | acc=1.0000 | 4576.3 samples/s | 71.5 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00049 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.912 | acc=1.0000 | 4482.9 samples/s | 70.0 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00046 | Reg=0.00214 | L2-Norm=14.617 | L2-Norm(final)=2.912 | acc=1.0000 | 4552.4 samples/s | 71.1 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00043 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=2.913 | acc=1.0000 | 4555.4 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27192 | acc=0.8481 | tpr=0.7824 | fpr=0.0092 | 3943.7 samples/s | 15.4 steps/s
Avg test loss: 0.27309, Avg test acc: 0.84458, Avg tpr: 0.77811, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.51752 | acc=0.8567 | tpr=0.9823 | fpr=0.1455 | 3919.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.52139 | acc=0.8590 | tpr=0.9851 | fpr=0.1433 | 7695.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.53122 | acc=0.8579 | tpr=0.9885 | fpr=0.1445 | 7514.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.53103 | acc=0.8579 | tpr=0.9880 | fpr=0.1445 | 8412.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.52799 | acc=0.8580 | tpr=0.9869 | fpr=0.1444 | 7322.4 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.52955 | acc=0.8583 | tpr=0.9847 | fpr=0.1440 | 7577.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.53092 | acc=0.8583 | tpr=0.9850 | fpr=0.1440 | 7523.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.53284 | acc=0.8582 | tpr=0.9847 | fpr=0.1441 | 7725.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.53763 | acc=0.8579 | tpr=0.9854 | fpr=0.1444 | 7602.4 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.53783 | acc=0.8579 | tpr=0.9850 | fpr=0.1444 | 7611.0 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.53519 | acc=0.8581 | tpr=0.9857 | fpr=0.1442 | 14148.4 samples/s | 55.3 steps/s
Avg test loss: 0.53482, Avg test acc: 0.85809, Avg tpr: 0.98574, Avg fpr: 0.14423, total FA: 20026

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.15180 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.941 | acc=0.8750 | 3821.0 samples/s | 59.7 steps/s
[Step=20850 Epoch=20.4] | Loss=0.03903 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.932 | acc=1.0000 | 4398.3 samples/s | 68.7 steps/s
[Step=20900 Epoch=20.4] | Loss=0.02680 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.937 | acc=1.0000 | 4755.3 samples/s | 74.3 steps/s
[Step=20950 Epoch=20.5] | Loss=0.02162 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.943 | acc=1.0000 | 4774.1 samples/s | 74.6 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01964 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.946 | acc=1.0000 | 4802.4 samples/s | 75.0 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01838 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.950 | acc=0.9844 | 4768.1 samples/s | 74.5 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01720 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.953 | acc=1.0000 | 4798.7 samples/s | 75.0 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01656 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.956 | acc=0.9688 | 4766.0 samples/s | 74.5 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01605 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.958 | acc=1.0000 | 4813.1 samples/s | 75.2 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01537 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.961 | acc=1.0000 | 4833.7 samples/s | 75.5 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01494 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.963 | acc=1.0000 | 4812.6 samples/s | 75.2 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01467 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.966 | acc=0.9844 | 4756.9 samples/s | 74.3 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01448 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=2.967 | acc=1.0000 | 4777.2 samples/s | 74.6 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01418 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.969 | acc=0.9844 | 4831.0 samples/s | 75.5 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01408 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.971 | acc=0.9688 | 4793.0 samples/s | 74.9 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01396 | Reg=0.00215 | L2-Norm=14.673 | L2-Norm(final)=2.973 | acc=0.9844 | 4826.7 samples/s | 75.4 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01387 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.975 | acc=0.9688 | 4794.1 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.06199 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.942 | acc=0.9375 | 3730.2 samples/s | 58.3 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00590 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.937 | acc=1.0000 | 4108.2 samples/s | 64.2 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00305 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.935 | acc=1.0000 | 4498.6 samples/s | 70.3 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00205 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.935 | acc=1.0000 | 4571.0 samples/s | 71.4 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00155 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.936 | acc=1.0000 | 4547.7 samples/s | 71.1 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00125 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.936 | acc=1.0000 | 4500.8 samples/s | 70.3 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00104 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.937 | acc=1.0000 | 4562.9 samples/s | 71.3 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00090 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.937 | acc=1.0000 | 4463.1 samples/s | 69.7 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00079 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=2.938 | acc=1.0000 | 4598.4 samples/s | 71.8 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00070 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=2.939 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00063 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.939 | acc=1.0000 | 4579.5 samples/s | 71.6 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00058 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.940 | acc=1.0000 | 1900.9 samples/s | 29.7 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00053 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.940 | acc=1.0000 | 4634.5 samples/s | 72.4 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00049 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.941 | acc=1.0000 | 4482.2 samples/s | 70.0 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00046 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.941 | acc=1.0000 | 4557.5 samples/s | 71.2 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00043 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=2.942 | acc=1.0000 | 4522.0 samples/s | 70.7 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00040 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.942 | acc=1.0000 | 4578.8 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25632 | acc=0.8509 | tpr=0.7863 | fpr=0.0089 | 3925.1 samples/s | 15.3 steps/s
Avg test loss: 0.25700, Avg test acc: 0.84863, Avg tpr: 0.78394, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.55194 | acc=0.8429 | tpr=0.9823 | fpr=0.1596 | 3889.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.55485 | acc=0.8465 | tpr=0.9851 | fpr=0.1561 | 7601.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.56557 | acc=0.8449 | tpr=0.9885 | fpr=0.1578 | 7702.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.56501 | acc=0.8454 | tpr=0.9891 | fpr=0.1573 | 7680.6 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.56251 | acc=0.8451 | tpr=0.9886 | fpr=0.1575 | 7599.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.56414 | acc=0.8453 | tpr=0.9876 | fpr=0.1573 | 7657.0 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.56579 | acc=0.8450 | tpr=0.9875 | fpr=0.1576 | 7655.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.56762 | acc=0.8448 | tpr=0.9874 | fpr=0.1578 | 7515.1 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.57202 | acc=0.8445 | tpr=0.9878 | fpr=0.1581 | 7939.4 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.57246 | acc=0.8445 | tpr=0.9872 | fpr=0.1581 | 7150.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.56966 | acc=0.8447 | tpr=0.9877 | fpr=0.1579 | 14330.4 samples/s | 56.0 steps/s
Avg test loss: 0.56924, Avg test acc: 0.84467, Avg tpr: 0.98772, Avg fpr: 0.15794, total FA: 21929

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.06410 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.976 | acc=0.9531 | 3670.4 samples/s | 57.3 steps/s
[Step=21650 Epoch=21.1] | Loss=0.02200 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.971 | acc=1.0000 | 4679.4 samples/s | 73.1 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01673 | Reg=0.00213 | L2-Norm=14.609 | L2-Norm(final)=2.975 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01459 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.979 | acc=0.9844 | 4718.1 samples/s | 73.7 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01382 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.982 | acc=0.9844 | 4780.3 samples/s | 74.7 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01362 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.985 | acc=1.0000 | 4816.6 samples/s | 75.3 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01339 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.987 | acc=1.0000 | 4797.9 samples/s | 75.0 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01336 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.989 | acc=1.0000 | 4759.3 samples/s | 74.4 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01304 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.990 | acc=0.9844 | 4836.0 samples/s | 75.6 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01278 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.992 | acc=0.9844 | 4757.4 samples/s | 74.3 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01290 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.994 | acc=1.0000 | 4776.7 samples/s | 74.6 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01297 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.996 | acc=1.0000 | 4835.8 samples/s | 75.6 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01290 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.998 | acc=0.9844 | 4808.6 samples/s | 75.1 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01292 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=3.000 | acc=1.0000 | 4726.8 samples/s | 73.9 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01276 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=3.002 | acc=0.9688 | 4785.4 samples/s | 74.8 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01262 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=3.004 | acc=0.9844 | 4794.7 samples/s | 74.9 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01259 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=3.006 | acc=1.0000 | 4784.2 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.16488 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.975 | acc=0.9375 | 3911.5 samples/s | 61.1 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00635 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.973 | acc=1.0000 | 4007.5 samples/s | 62.6 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00320 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=2.973 | acc=1.0000 | 4483.5 samples/s | 70.1 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00214 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=2.973 | acc=1.0000 | 4586.3 samples/s | 71.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00161 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.974 | acc=1.0000 | 4525.7 samples/s | 70.7 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00130 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.975 | acc=1.0000 | 4527.9 samples/s | 70.7 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00109 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.975 | acc=1.0000 | 4631.4 samples/s | 72.4 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00094 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=2.976 | acc=1.0000 | 4483.6 samples/s | 70.1 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00082 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.977 | acc=1.0000 | 4511.7 samples/s | 70.5 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00073 | Reg=0.00213 | L2-Norm=14.602 | L2-Norm(final)=2.978 | acc=1.0000 | 4569.1 samples/s | 71.4 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00066 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.979 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00060 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.980 | acc=1.0000 | 1968.9 samples/s | 30.8 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00055 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.981 | acc=1.0000 | 4496.7 samples/s | 70.3 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00051 | Reg=0.00213 | L2-Norm=14.584 | L2-Norm(final)=2.982 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00047 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=2.983 | acc=1.0000 | 4388.6 samples/s | 68.6 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00044 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.984 | acc=1.0000 | 4454.8 samples/s | 69.6 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00042 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.985 | acc=1.0000 | 4471.6 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31441 | acc=0.8259 | tpr=0.7492 | fpr=0.0074 | 4007.7 samples/s | 15.7 steps/s
Avg test loss: 0.31791, Avg test acc: 0.82222, Avg tpr: 0.74506, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.42890 | acc=0.8814 | tpr=0.9823 | fpr=0.1204 | 3936.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.43350 | acc=0.8828 | tpr=0.9829 | fpr=0.1191 | 7526.7 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.44202 | acc=0.8819 | tpr=0.9870 | fpr=0.1201 | 7574.0 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.44142 | acc=0.8823 | tpr=0.9858 | fpr=0.1196 | 7869.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.43876 | acc=0.8824 | tpr=0.9843 | fpr=0.1195 | 7586.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.44064 | acc=0.8827 | tpr=0.9818 | fpr=0.1191 | 7720.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.44244 | acc=0.8826 | tpr=0.9825 | fpr=0.1192 | 7558.6 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.44398 | acc=0.8823 | tpr=0.9825 | fpr=0.1195 | 7783.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.44791 | acc=0.8818 | tpr=0.9825 | fpr=0.1200 | 7693.4 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.44823 | acc=0.8817 | tpr=0.9815 | fpr=0.1201 | 7760.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.44548 | acc=0.8821 | tpr=0.9825 | fpr=0.1197 | 13773.1 samples/s | 53.8 steps/s
Avg test loss: 0.44505, Avg test acc: 0.88217, Avg tpr: 0.98257, Avg fpr: 0.11966, total FA: 16614

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.27681 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.012 | acc=0.8438 | 3866.0 samples/s | 60.4 steps/s
[Step=22450 Epoch=21.9] | Loss=0.03243 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.999 | acc=1.0000 | 4313.6 samples/s | 67.4 steps/s
[Step=22500 Epoch=22.0] | Loss=0.02219 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=3.005 | acc=0.9844 | 4698.2 samples/s | 73.4 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01819 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=3.011 | acc=0.9844 | 4860.3 samples/s | 75.9 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01645 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=3.015 | acc=1.0000 | 4653.4 samples/s | 72.7 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01618 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=3.018 | acc=0.9844 | 4771.3 samples/s | 74.6 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01548 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=3.020 | acc=1.0000 | 4843.8 samples/s | 75.7 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01497 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=3.022 | acc=1.0000 | 4817.0 samples/s | 75.3 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01441 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=3.024 | acc=1.0000 | 4817.6 samples/s | 75.3 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01449 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=3.026 | acc=1.0000 | 4771.9 samples/s | 74.6 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01408 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=3.028 | acc=0.9844 | 4837.7 samples/s | 75.6 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01419 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=3.029 | acc=0.9844 | 4754.8 samples/s | 74.3 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01392 | Reg=0.00214 | L2-Norm=14.617 | L2-Norm(final)=3.031 | acc=1.0000 | 4776.5 samples/s | 74.6 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01376 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=3.033 | acc=1.0000 | 4906.9 samples/s | 76.7 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01361 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=3.034 | acc=1.0000 | 4726.7 samples/s | 73.9 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01339 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=3.036 | acc=0.9688 | 4781.6 samples/s | 74.7 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01330 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=3.038 | acc=1.0000 | 4830.3 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.04212 | Reg=0.00211 | L2-Norm=14.533 | L2-Norm(final)=3.013 | acc=0.9688 | 3423.1 samples/s | 53.5 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00314 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=3.018 | acc=1.0000 | 4331.5 samples/s | 67.7 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00202 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=3.020 | acc=0.9844 | 4566.5 samples/s | 71.4 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00142 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=3.021 | acc=1.0000 | 4547.9 samples/s | 71.1 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00108 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=3.021 | acc=1.0000 | 4545.0 samples/s | 71.0 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00087 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=3.022 | acc=1.0000 | 4570.8 samples/s | 71.4 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00074 | Reg=0.00213 | L2-Norm=14.584 | L2-Norm(final)=3.023 | acc=1.0000 | 4602.1 samples/s | 71.9 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00064 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=3.023 | acc=1.0000 | 4532.1 samples/s | 70.8 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00057 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=3.024 | acc=1.0000 | 4512.5 samples/s | 70.5 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00051 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=3.025 | acc=1.0000 | 4560.7 samples/s | 71.3 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00046 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=3.026 | acc=1.0000 | 4608.9 samples/s | 72.0 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00042 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.027 | acc=1.0000 | 1891.8 samples/s | 29.6 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00038 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.027 | acc=1.0000 | 4624.3 samples/s | 72.3 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00036 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=3.028 | acc=1.0000 | 4536.8 samples/s | 70.9 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00033 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=3.029 | acc=1.0000 | 4563.2 samples/s | 71.3 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00031 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=3.029 | acc=1.0000 | 4519.9 samples/s | 70.6 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00029 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=3.030 | acc=1.0000 | 4526.4 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25599 | acc=0.8595 | tpr=0.7990 | fpr=0.0092 | 3900.8 samples/s | 15.2 steps/s
Avg test loss: 0.26074, Avg test acc: 0.85516, Avg tpr: 0.79385, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.54913 | acc=0.8520 | tpr=0.9779 | fpr=0.1502 | 3897.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.55258 | acc=0.8550 | tpr=0.9829 | fpr=0.1474 | 7525.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.56207 | acc=0.8536 | tpr=0.9870 | fpr=0.1489 | 8283.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.56119 | acc=0.8534 | tpr=0.9858 | fpr=0.1490 | 7508.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.55927 | acc=0.8534 | tpr=0.9860 | fpr=0.1490 | 7497.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.56124 | acc=0.8538 | tpr=0.9855 | fpr=0.1486 | 7552.4 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.56216 | acc=0.8541 | tpr=0.9856 | fpr=0.1483 | 7488.5 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.56416 | acc=0.8539 | tpr=0.9852 | fpr=0.1485 | 7861.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.56910 | acc=0.8535 | tpr=0.9854 | fpr=0.1489 | 7687.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.56965 | acc=0.8531 | tpr=0.9850 | fpr=0.1493 | 7303.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.56652 | acc=0.8533 | tpr=0.9857 | fpr=0.1491 | 14315.4 samples/s | 55.9 steps/s
Avg test loss: 0.56608, Avg test acc: 0.85332, Avg tpr: 0.98574, Avg fpr: 0.14908, total FA: 20700

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.09071 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.051 | acc=0.8906 | 3737.7 samples/s | 58.4 steps/s
[Step=23250 Epoch=22.7] | Loss=0.02415 | Reg=0.00211 | L2-Norm=14.543 | L2-Norm(final)=3.043 | acc=1.0000 | 4251.6 samples/s | 66.4 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01875 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=3.045 | acc=0.9844 | 4812.0 samples/s | 75.2 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01584 | Reg=0.00212 | L2-Norm=14.560 | L2-Norm(final)=3.050 | acc=1.0000 | 4823.9 samples/s | 75.4 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01431 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=3.055 | acc=1.0000 | 4706.4 samples/s | 73.5 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01412 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=3.058 | acc=0.9688 | 4861.9 samples/s | 76.0 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01357 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=3.060 | acc=1.0000 | 4802.5 samples/s | 75.0 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01309 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=3.062 | acc=0.9844 | 4753.3 samples/s | 74.3 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01300 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=3.065 | acc=0.9844 | 4830.0 samples/s | 75.5 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01270 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=3.067 | acc=1.0000 | 4788.0 samples/s | 74.8 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01266 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=3.069 | acc=0.9844 | 4809.3 samples/s | 75.1 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01249 | Reg=0.00213 | L2-Norm=14.583 | L2-Norm(final)=3.071 | acc=1.0000 | 4798.9 samples/s | 75.0 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01240 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=3.073 | acc=1.0000 | 4796.7 samples/s | 74.9 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01264 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=3.075 | acc=0.9844 | 4742.3 samples/s | 74.1 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01247 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=3.076 | acc=1.0000 | 4790.5 samples/s | 74.9 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01244 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=3.077 | acc=0.9844 | 4767.0 samples/s | 74.5 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01252 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=3.079 | acc=0.9844 | 4824.7 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.04023 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.051 | acc=0.9688 | 4389.3 samples/s | 68.6 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00393 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=3.054 | acc=1.0000 | 3726.4 samples/s | 58.2 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00243 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=3.055 | acc=1.0000 | 4579.2 samples/s | 71.6 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00165 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=3.054 | acc=1.0000 | 4449.3 samples/s | 69.5 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00129 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=3.054 | acc=1.0000 | 4565.3 samples/s | 71.3 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00103 | Reg=0.00212 | L2-Norm=14.572 | L2-Norm(final)=3.054 | acc=1.0000 | 4502.3 samples/s | 70.3 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00087 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=3.054 | acc=1.0000 | 4573.2 samples/s | 71.5 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00074 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=3.055 | acc=1.0000 | 4556.4 samples/s | 71.2 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00069 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=3.055 | acc=1.0000 | 4499.3 samples/s | 70.3 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00061 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=3.055 | acc=1.0000 | 4523.5 samples/s | 70.7 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00056 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=3.056 | acc=1.0000 | 4637.5 samples/s | 72.5 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00051 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=3.056 | acc=1.0000 | 1957.3 samples/s | 30.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00047 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=3.057 | acc=1.0000 | 4496.0 samples/s | 70.3 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00043 | Reg=0.00211 | L2-Norm=14.542 | L2-Norm(final)=3.057 | acc=1.0000 | 4520.2 samples/s | 70.6 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00040 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=3.058 | acc=1.0000 | 4544.9 samples/s | 71.0 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00038 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=3.058 | acc=1.0000 | 4471.6 samples/s | 69.9 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00035 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=3.058 | acc=1.0000 | 4535.6 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28367 | acc=0.8442 | tpr=0.7774 | fpr=0.0107 | 3994.1 samples/s | 15.6 steps/s
Avg test loss: 0.28813, Avg test acc: 0.84145, Avg tpr: 0.77409, Avg fpr: 0.01038, total FA: 81

Testing server on iccad2012
[Step=  50] | Loss=0.45291 | acc=0.8861 | tpr=0.9779 | fpr=0.1156 | 3910.4 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.45874 | acc=0.8876 | tpr=0.9851 | fpr=0.1142 | 7767.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.46741 | acc=0.8871 | tpr=0.9870 | fpr=0.1148 | 7755.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.46776 | acc=0.8868 | tpr=0.9858 | fpr=0.1150 | 7585.7 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.46536 | acc=0.8868 | tpr=0.9852 | fpr=0.1150 | 7676.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.46728 | acc=0.8871 | tpr=0.9833 | fpr=0.1147 | 7699.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.46851 | acc=0.8870 | tpr=0.9837 | fpr=0.1147 | 7522.4 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.47038 | acc=0.8868 | tpr=0.9836 | fpr=0.1150 | 7542.2 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.47501 | acc=0.8863 | tpr=0.9834 | fpr=0.1155 | 7468.4 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.47543 | acc=0.8859 | tpr=0.9833 | fpr=0.1159 | 7594.0 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.47278 | acc=0.8863 | tpr=0.9841 | fpr=0.1155 | 14198.4 samples/s | 55.5 steps/s
Avg test loss: 0.47245, Avg test acc: 0.88629, Avg tpr: 0.98415, Avg fpr: 0.11549, total FA: 16036

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.32626 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.080 | acc=0.7969 | 3668.2 samples/s | 57.3 steps/s
[Step=24050 Epoch=23.5] | Loss=0.02819 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.075 | acc=1.0000 | 4489.2 samples/s | 70.1 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01973 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=3.078 | acc=0.9688 | 4806.3 samples/s | 75.1 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01706 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=3.081 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01520 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=3.083 | acc=1.0000 | 4780.7 samples/s | 74.7 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01442 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=3.085 | acc=0.9844 | 4797.4 samples/s | 75.0 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01333 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=3.087 | acc=1.0000 | 4672.3 samples/s | 73.0 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01264 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=3.089 | acc=1.0000 | 4778.2 samples/s | 74.7 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01223 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=3.091 | acc=1.0000 | 4772.9 samples/s | 74.6 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01200 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=3.093 | acc=1.0000 | 4823.7 samples/s | 75.4 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01159 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.095 | acc=1.0000 | 4742.3 samples/s | 74.1 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01142 | Reg=0.00211 | L2-Norm=14.513 | L2-Norm(final)=3.096 | acc=1.0000 | 4709.8 samples/s | 73.6 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01148 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=3.098 | acc=0.9844 | 4778.8 samples/s | 74.7 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01118 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=3.100 | acc=1.0000 | 4712.0 samples/s | 73.6 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01106 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=3.101 | acc=0.9688 | 4749.6 samples/s | 74.2 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01097 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=3.103 | acc=1.0000 | 4726.1 samples/s | 73.8 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01083 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=3.104 | acc=1.0000 | 4777.1 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.01396 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.081 | acc=0.9844 | 3639.3 samples/s | 56.9 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00320 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.082 | acc=1.0000 | 4257.9 samples/s | 66.5 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00162 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=3.083 | acc=1.0000 | 4506.4 samples/s | 70.4 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00109 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=3.083 | acc=1.0000 | 4515.9 samples/s | 70.6 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00084 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=3.084 | acc=1.0000 | 4567.9 samples/s | 71.4 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00068 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=3.085 | acc=1.0000 | 4544.9 samples/s | 71.0 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00057 | Reg=0.00210 | L2-Norm=14.491 | L2-Norm(final)=3.085 | acc=1.0000 | 4521.7 samples/s | 70.7 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00049 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.086 | acc=1.0000 | 4534.3 samples/s | 70.8 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00043 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.086 | acc=1.0000 | 4540.5 samples/s | 70.9 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00039 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.087 | acc=1.0000 | 4544.1 samples/s | 71.0 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00035 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.087 | acc=1.0000 | 4592.9 samples/s | 71.8 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00032 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.087 | acc=1.0000 | 1850.7 samples/s | 28.9 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00029 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.088 | acc=1.0000 | 4556.5 samples/s | 71.2 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00027 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.088 | acc=1.0000 | 4542.1 samples/s | 71.0 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00025 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.088 | acc=1.0000 | 4438.8 samples/s | 69.4 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00024 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.089 | acc=1.0000 | 4511.4 samples/s | 70.5 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00022 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.089 | acc=1.0000 | 4614.5 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25978 | acc=0.8623 | tpr=0.8037 | fpr=0.0104 | 3885.0 samples/s | 15.2 steps/s
Avg test loss: 0.26160, Avg test acc: 0.85972, Avg tpr: 0.80055, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.51451 | acc=0.8677 | tpr=0.9779 | fpr=0.1343 | 3970.9 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.51952 | acc=0.8692 | tpr=0.9829 | fpr=0.1329 | 7477.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.52813 | acc=0.8684 | tpr=0.9856 | fpr=0.1338 | 7943.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.52725 | acc=0.8688 | tpr=0.9847 | fpr=0.1333 | 7523.3 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.52540 | acc=0.8687 | tpr=0.9843 | fpr=0.1334 | 7684.0 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.52740 | acc=0.8686 | tpr=0.9833 | fpr=0.1335 | 7582.3 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.52815 | acc=0.8685 | tpr=0.9837 | fpr=0.1336 | 7909.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.53021 | acc=0.8681 | tpr=0.9836 | fpr=0.1340 | 7296.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.53511 | acc=0.8674 | tpr=0.9834 | fpr=0.1347 | 7802.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.53574 | acc=0.8671 | tpr=0.9828 | fpr=0.1350 | 7454.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.53295 | acc=0.8675 | tpr=0.9837 | fpr=0.1347 | 14103.4 samples/s | 55.1 steps/s
Avg test loss: 0.53265, Avg test acc: 0.86748, Avg tpr: 0.98376, Avg fpr: 0.13464, total FA: 18694

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.09648 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.109 | acc=0.9531 | 3750.5 samples/s | 58.6 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02366 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.107 | acc=0.9844 | 4589.8 samples/s | 71.7 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01554 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.108 | acc=0.9844 | 4743.3 samples/s | 74.1 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01371 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=3.111 | acc=1.0000 | 4749.8 samples/s | 74.2 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01247 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.113 | acc=1.0000 | 4601.7 samples/s | 71.9 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01150 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=3.115 | acc=1.0000 | 4746.6 samples/s | 74.2 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01094 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.116 | acc=1.0000 | 4723.1 samples/s | 73.8 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01057 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.118 | acc=1.0000 | 4793.8 samples/s | 74.9 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01046 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.120 | acc=0.9844 | 4766.1 samples/s | 74.5 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01002 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.121 | acc=1.0000 | 4781.2 samples/s | 74.7 steps/s
[Step=25300 Epoch=24.7] | Loss=0.00988 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.123 | acc=0.9844 | 4774.2 samples/s | 74.6 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00974 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.124 | acc=0.9688 | 4760.7 samples/s | 74.4 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00964 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.126 | acc=1.0000 | 4833.0 samples/s | 75.5 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00963 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.127 | acc=0.9844 | 4768.3 samples/s | 74.5 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00970 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.129 | acc=0.9844 | 4778.9 samples/s | 74.7 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00959 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.130 | acc=0.9844 | 4804.6 samples/s | 75.1 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00959 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.131 | acc=1.0000 | 4741.3 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.03327 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.109 | acc=0.9844 | 3552.9 samples/s | 55.5 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00318 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=3.113 | acc=1.0000 | 4331.4 samples/s | 67.7 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00163 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=3.114 | acc=1.0000 | 4562.5 samples/s | 71.3 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00109 | Reg=0.00210 | L2-Norm=14.474 | L2-Norm(final)=3.115 | acc=1.0000 | 4504.3 samples/s | 70.4 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00082 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=3.116 | acc=1.0000 | 4534.3 samples/s | 70.8 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00066 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.116 | acc=1.0000 | 4502.3 samples/s | 70.3 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00056 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.116 | acc=1.0000 | 4497.3 samples/s | 70.3 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00048 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.117 | acc=1.0000 | 4632.3 samples/s | 72.4 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00042 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.117 | acc=1.0000 | 4520.9 samples/s | 70.6 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00038 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.118 | acc=1.0000 | 4435.4 samples/s | 69.3 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00034 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.118 | acc=1.0000 | 4496.6 samples/s | 70.3 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.118 | acc=1.0000 | 1889.4 samples/s | 29.5 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00029 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=3.119 | acc=1.0000 | 4448.7 samples/s | 69.5 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00026 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=3.119 | acc=1.0000 | 4557.5 samples/s | 71.2 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00025 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.119 | acc=1.0000 | 4474.1 samples/s | 69.9 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00023 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=3.119 | acc=1.0000 | 4619.6 samples/s | 72.2 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00022 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.120 | acc=1.0000 | 4475.6 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25569 | acc=0.8670 | tpr=0.8101 | fpr=0.0094 | 3904.2 samples/s | 15.3 steps/s
Avg test loss: 0.25837, Avg test acc: 0.86417, Avg tpr: 0.80661, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.51829 | acc=0.8716 | tpr=0.9779 | fpr=0.1303 | 3872.0 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.52410 | acc=0.8732 | tpr=0.9829 | fpr=0.1288 | 7854.8 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.53196 | acc=0.8731 | tpr=0.9856 | fpr=0.1290 | 7610.2 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.53123 | acc=0.8734 | tpr=0.9836 | fpr=0.1286 | 7830.6 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.52884 | acc=0.8728 | tpr=0.9834 | fpr=0.1292 | 7629.0 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.53100 | acc=0.8729 | tpr=0.9825 | fpr=0.1291 | 7542.5 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.53160 | acc=0.8732 | tpr=0.9831 | fpr=0.1288 | 7823.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.53335 | acc=0.8731 | tpr=0.9825 | fpr=0.1289 | 7634.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.53843 | acc=0.8723 | tpr=0.9825 | fpr=0.1297 | 7614.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.53909 | acc=0.8721 | tpr=0.9819 | fpr=0.1299 | 7562.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.53630 | acc=0.8724 | tpr=0.9825 | fpr=0.1296 | 14099.4 samples/s | 55.1 steps/s
Avg test loss: 0.53600, Avg test acc: 0.87238, Avg tpr: 0.98257, Avg fpr: 0.12962, total FA: 17998

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.02081 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.135 | acc=0.9844 | 3758.7 samples/s | 58.7 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02069 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.130 | acc=1.0000 | 4419.3 samples/s | 69.1 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01495 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.132 | acc=0.9688 | 4805.5 samples/s | 75.1 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01210 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.135 | acc=1.0000 | 4744.6 samples/s | 74.1 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01143 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.137 | acc=0.9688 | 4726.0 samples/s | 73.8 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01137 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=3.140 | acc=1.0000 | 4785.9 samples/s | 74.8 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01121 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.141 | acc=0.9844 | 4780.9 samples/s | 74.7 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01090 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=3.143 | acc=1.0000 | 4876.0 samples/s | 76.2 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01075 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.144 | acc=0.9844 | 4751.5 samples/s | 74.2 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01067 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=3.146 | acc=0.9688 | 4748.3 samples/s | 74.2 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01042 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=3.147 | acc=1.0000 | 4781.7 samples/s | 74.7 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01027 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.148 | acc=1.0000 | 4820.0 samples/s | 75.3 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01033 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.150 | acc=1.0000 | 4769.1 samples/s | 74.5 steps/s
[Step=26250 Epoch=25.6] | Loss=0.01001 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.151 | acc=1.0000 | 4822.4 samples/s | 75.4 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00989 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.152 | acc=1.0000 | 4796.4 samples/s | 74.9 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00992 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.154 | acc=1.0000 | 4756.9 samples/s | 74.3 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00972 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.155 | acc=0.9844 | 4744.7 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.08244 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.135 | acc=0.9688 | 4076.4 samples/s | 63.7 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00351 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=3.140 | acc=1.0000 | 3899.9 samples/s | 60.9 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00181 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=3.141 | acc=1.0000 | 4426.6 samples/s | 69.2 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00140 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.141 | acc=1.0000 | 4528.1 samples/s | 70.8 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00108 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=3.142 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00086 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.143 | acc=1.0000 | 4529.0 samples/s | 70.8 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00072 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.143 | acc=1.0000 | 4546.3 samples/s | 71.0 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00062 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.143 | acc=1.0000 | 4556.5 samples/s | 71.2 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00055 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.144 | acc=1.0000 | 4531.0 samples/s | 70.8 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00049 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.144 | acc=1.0000 | 4533.8 samples/s | 70.8 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00044 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.144 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00040 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=3.145 | acc=1.0000 | 1919.1 samples/s | 30.0 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00037 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.145 | acc=1.0000 | 4608.5 samples/s | 72.0 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00034 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.146 | acc=1.0000 | 4504.1 samples/s | 70.4 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00032 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.146 | acc=1.0000 | 4484.5 samples/s | 70.1 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00030 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.146 | acc=1.0000 | 4508.7 samples/s | 70.4 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.146 | acc=1.0000 | 4517.1 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26155 | acc=0.8650 | tpr=0.8071 | fpr=0.0092 | 3993.1 samples/s | 15.6 steps/s
Avg test loss: 0.26478, Avg test acc: 0.86109, Avg tpr: 0.80224, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.53648 | acc=0.8710 | tpr=0.9779 | fpr=0.1309 | 3938.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.54220 | acc=0.8718 | tpr=0.9808 | fpr=0.1302 | 7841.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.55046 | acc=0.8712 | tpr=0.9841 | fpr=0.1309 | 7566.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.55029 | acc=0.8713 | tpr=0.9825 | fpr=0.1307 | 7566.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.54809 | acc=0.8713 | tpr=0.9825 | fpr=0.1307 | 7690.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.55027 | acc=0.8711 | tpr=0.9825 | fpr=0.1310 | 7664.7 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.55097 | acc=0.8714 | tpr=0.9831 | fpr=0.1307 | 7639.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.55295 | acc=0.8711 | tpr=0.9825 | fpr=0.1309 | 7657.4 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.55825 | acc=0.8705 | tpr=0.9830 | fpr=0.1316 | 7612.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.55907 | acc=0.8701 | tpr=0.9824 | fpr=0.1319 | 7493.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.55616 | acc=0.8706 | tpr=0.9829 | fpr=0.1315 | 14751.9 samples/s | 57.6 steps/s
Avg test loss: 0.55585, Avg test acc: 0.87057, Avg tpr: 0.98296, Avg fpr: 0.13147, total FA: 18255

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.12230 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.161 | acc=0.9062 | 3804.4 samples/s | 59.4 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02217 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=3.157 | acc=0.9688 | 4455.0 samples/s | 69.6 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01418 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.158 | acc=1.0000 | 4763.9 samples/s | 74.4 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01242 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=3.161 | acc=0.9844 | 4740.3 samples/s | 74.1 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01164 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.163 | acc=0.9844 | 4812.5 samples/s | 75.2 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01048 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.165 | acc=1.0000 | 4771.2 samples/s | 74.5 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01018 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.167 | acc=1.0000 | 4725.0 samples/s | 73.8 steps/s
[Step=26750 Epoch=26.1] | Loss=0.00984 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.169 | acc=1.0000 | 4877.2 samples/s | 76.2 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00975 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.171 | acc=1.0000 | 4765.1 samples/s | 74.5 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00953 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.172 | acc=1.0000 | 4828.9 samples/s | 75.5 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00946 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.174 | acc=1.0000 | 4787.9 samples/s | 74.8 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00939 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.176 | acc=1.0000 | 4780.8 samples/s | 74.7 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00938 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.177 | acc=1.0000 | 4816.7 samples/s | 75.3 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00924 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.178 | acc=0.9688 | 4734.2 samples/s | 74.0 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00919 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.180 | acc=0.9844 | 4789.4 samples/s | 74.8 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00919 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=3.181 | acc=1.0000 | 4827.3 samples/s | 75.4 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00927 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.182 | acc=1.0000 | 4810.4 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.14986 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.161 | acc=0.9531 | 3741.0 samples/s | 58.5 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00855 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.159 | acc=1.0000 | 4245.2 samples/s | 66.3 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00440 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.158 | acc=1.0000 | 4520.0 samples/s | 70.6 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00294 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.159 | acc=1.0000 | 4550.0 samples/s | 71.1 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00221 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.159 | acc=1.0000 | 4514.3 samples/s | 70.5 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00177 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.160 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00148 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.160 | acc=1.0000 | 4518.6 samples/s | 70.6 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00127 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.160 | acc=1.0000 | 4548.0 samples/s | 71.1 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00111 | Reg=0.00208 | L2-Norm=14.416 | L2-Norm(final)=3.160 | acc=1.0000 | 4492.1 samples/s | 70.2 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00099 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.160 | acc=1.0000 | 4546.3 samples/s | 71.0 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00089 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.161 | acc=1.0000 | 4575.2 samples/s | 71.5 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00081 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.161 | acc=1.0000 | 1916.8 samples/s | 30.0 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00074 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.161 | acc=1.0000 | 4511.1 samples/s | 70.5 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00069 | Reg=0.00207 | L2-Norm=14.405 | L2-Norm(final)=3.161 | acc=1.0000 | 4382.3 samples/s | 68.5 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00064 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.162 | acc=1.0000 | 4470.6 samples/s | 69.9 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00059 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.162 | acc=1.0000 | 4489.1 samples/s | 70.1 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00056 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.162 | acc=1.0000 | 4518.0 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23167 | acc=0.8774 | tpr=0.8261 | fpr=0.0111 | 3878.5 samples/s | 15.2 steps/s
Avg test loss: 0.23513, Avg test acc: 0.87487, Avg tpr: 0.82310, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.54716 | acc=0.8695 | tpr=0.9823 | fpr=0.1325 | 3927.4 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.55274 | acc=0.8710 | tpr=0.9851 | fpr=0.1312 | 7639.3 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.56189 | acc=0.8703 | tpr=0.9870 | fpr=0.1319 | 7838.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.56153 | acc=0.8708 | tpr=0.9847 | fpr=0.1313 | 7594.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.55871 | acc=0.8708 | tpr=0.9843 | fpr=0.1313 | 7705.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.56150 | acc=0.8705 | tpr=0.9840 | fpr=0.1315 | 7904.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.56263 | acc=0.8706 | tpr=0.9843 | fpr=0.1314 | 7439.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.56485 | acc=0.8703 | tpr=0.9836 | fpr=0.1318 | 7619.5 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.57037 | acc=0.8697 | tpr=0.9839 | fpr=0.1324 | 7766.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.57083 | acc=0.8691 | tpr=0.9837 | fpr=0.1329 | 7295.7 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.56762 | acc=0.8696 | tpr=0.9841 | fpr=0.1325 | 14374.7 samples/s | 56.2 steps/s
Avg test loss: 0.56727, Avg test acc: 0.86957, Avg tpr: 0.98415, Avg fpr: 0.13251, total FA: 18399

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.21084 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.182 | acc=0.8906 | 3874.8 samples/s | 60.5 steps/s
[Step=27250 Epoch=26.6] | Loss=0.01868 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.180 | acc=1.0000 | 4252.9 samples/s | 66.5 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01277 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.182 | acc=1.0000 | 4761.7 samples/s | 74.4 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01155 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.185 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01047 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.188 | acc=1.0000 | 4763.2 samples/s | 74.4 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01008 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=3.190 | acc=0.9844 | 4762.4 samples/s | 74.4 steps/s
[Step=27500 Epoch=26.8] | Loss=0.00975 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=3.193 | acc=0.9688 | 4787.2 samples/s | 74.8 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00960 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=3.195 | acc=1.0000 | 4769.7 samples/s | 74.5 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00943 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.196 | acc=1.0000 | 4792.4 samples/s | 74.9 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00975 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=3.198 | acc=1.0000 | 4856.7 samples/s | 75.9 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00971 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.200 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00980 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=3.201 | acc=1.0000 | 4807.8 samples/s | 75.1 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00981 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.202 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00963 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.203 | acc=1.0000 | 4821.6 samples/s | 75.3 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00950 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.204 | acc=1.0000 | 4753.6 samples/s | 74.3 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00942 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=3.206 | acc=1.0000 | 4829.7 samples/s | 75.5 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00943 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.207 | acc=1.0000 | 4758.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.05559 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.183 | acc=0.9688 | 3769.3 samples/s | 58.9 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00561 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.190 | acc=1.0000 | 4018.4 samples/s | 62.8 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00282 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.191 | acc=1.0000 | 4519.8 samples/s | 70.6 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00189 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.192 | acc=1.0000 | 4531.9 samples/s | 70.8 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00142 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.192 | acc=1.0000 | 4545.4 samples/s | 71.0 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00114 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=3.192 | acc=1.0000 | 4548.0 samples/s | 71.1 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00095 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=3.193 | acc=1.0000 | 4541.2 samples/s | 71.0 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00081 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.193 | acc=1.0000 | 4533.4 samples/s | 70.8 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00071 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.194 | acc=1.0000 | 4572.1 samples/s | 71.4 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00064 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.194 | acc=1.0000 | 4475.6 samples/s | 69.9 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00057 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.194 | acc=1.0000 | 4582.3 samples/s | 71.6 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00052 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.194 | acc=1.0000 | 1894.7 samples/s | 29.6 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00048 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.195 | acc=1.0000 | 4675.6 samples/s | 73.1 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00044 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.195 | acc=1.0000 | 4477.4 samples/s | 70.0 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00041 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.195 | acc=1.0000 | 4561.5 samples/s | 71.3 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00038 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=3.195 | acc=1.0000 | 4482.7 samples/s | 70.0 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00036 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.196 | acc=1.0000 | 4536.4 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28708 | acc=0.8569 | tpr=0.7947 | fpr=0.0082 | 3890.7 samples/s | 15.2 steps/s
Avg test loss: 0.29074, Avg test acc: 0.85395, Avg tpr: 0.79140, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.46523 | acc=0.8891 | tpr=0.9735 | fpr=0.1125 | 3891.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.47159 | acc=0.8914 | tpr=0.9808 | fpr=0.1103 | 7633.9 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.47987 | acc=0.8920 | tpr=0.9841 | fpr=0.1097 | 8046.9 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.47961 | acc=0.8921 | tpr=0.9825 | fpr=0.1095 | 7358.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.47631 | acc=0.8928 | tpr=0.9825 | fpr=0.1088 | 7684.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.47901 | acc=0.8926 | tpr=0.9818 | fpr=0.1091 | 7765.5 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.48015 | acc=0.8925 | tpr=0.9825 | fpr=0.1091 | 7582.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.48198 | acc=0.8922 | tpr=0.9819 | fpr=0.1094 | 7612.7 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.48706 | acc=0.8916 | tpr=0.9815 | fpr=0.1100 | 7509.5 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.48729 | acc=0.8912 | tpr=0.9811 | fpr=0.1105 | 7323.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.48446 | acc=0.8916 | tpr=0.9817 | fpr=0.1100 | 14152.5 samples/s | 55.3 steps/s
Avg test loss: 0.48419, Avg test acc: 0.89158, Avg tpr: 0.98177, Avg fpr: 0.11006, total FA: 15282

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.02159 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.211 | acc=0.9844 | 4155.5 samples/s | 64.9 steps/s
[Step=28050 Epoch=27.4] | Loss=0.02273 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.203 | acc=1.0000 | 4203.9 samples/s | 65.7 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01622 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.205 | acc=1.0000 | 4796.3 samples/s | 74.9 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01350 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.206 | acc=1.0000 | 4734.0 samples/s | 74.0 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01175 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.209 | acc=0.9688 | 4773.2 samples/s | 74.6 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01145 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.211 | acc=1.0000 | 4751.9 samples/s | 74.2 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01085 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.213 | acc=0.9688 | 4808.7 samples/s | 75.1 steps/s
[Step=28350 Epoch=27.7] | Loss=0.01050 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.215 | acc=0.9844 | 4778.3 samples/s | 74.7 steps/s
[Step=28400 Epoch=27.7] | Loss=0.01040 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=3.216 | acc=1.0000 | 4787.1 samples/s | 74.8 steps/s
[Step=28450 Epoch=27.8] | Loss=0.01020 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.218 | acc=0.9844 | 4795.8 samples/s | 74.9 steps/s
[Step=28500 Epoch=27.8] | Loss=0.01003 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.220 | acc=0.9844 | 4804.9 samples/s | 75.1 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00994 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.221 | acc=1.0000 | 4777.2 samples/s | 74.6 steps/s
[Step=28600 Epoch=27.9] | Loss=0.01004 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=3.222 | acc=1.0000 | 4791.7 samples/s | 74.9 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00999 | Reg=0.00207 | L2-Norm=14.401 | L2-Norm(final)=3.224 | acc=0.9844 | 4836.6 samples/s | 75.6 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00977 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.225 | acc=1.0000 | 4834.3 samples/s | 75.5 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00957 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.226 | acc=1.0000 | 4738.3 samples/s | 74.0 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00952 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.227 | acc=0.9844 | 4806.9 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.04701 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.211 | acc=0.9688 | 3855.1 samples/s | 60.2 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00348 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.219 | acc=1.0000 | 3812.6 samples/s | 59.6 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00175 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.220 | acc=1.0000 | 4571.4 samples/s | 71.4 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00117 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.221 | acc=1.0000 | 4590.1 samples/s | 71.7 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00088 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=3.221 | acc=1.0000 | 4447.7 samples/s | 69.5 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00071 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.222 | acc=1.0000 | 4574.8 samples/s | 71.5 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00060 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.222 | acc=1.0000 | 4601.2 samples/s | 71.9 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00051 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.223 | acc=1.0000 | 4451.8 samples/s | 69.6 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00045 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.223 | acc=1.0000 | 4584.9 samples/s | 71.6 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00040 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.224 | acc=1.0000 | 4523.9 samples/s | 70.7 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.224 | acc=1.0000 | 4573.1 samples/s | 71.5 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.225 | acc=1.0000 | 1956.1 samples/s | 30.6 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00031 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.225 | acc=1.0000 | 4500.8 samples/s | 70.3 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00028 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.226 | acc=1.0000 | 4563.3 samples/s | 71.3 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00026 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.226 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00025 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.226 | acc=1.0000 | 4488.1 samples/s | 70.1 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00023 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.227 | acc=1.0000 | 4526.0 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23421 | acc=0.8812 | tpr=0.8315 | fpr=0.0109 | 4003.8 samples/s | 15.6 steps/s
Avg test loss: 0.23669, Avg test acc: 0.87896, Avg tpr: 0.82893, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.54422 | acc=0.8688 | tpr=0.9779 | fpr=0.1331 | 3932.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.54895 | acc=0.8704 | tpr=0.9808 | fpr=0.1317 | 7611.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.55577 | acc=0.8709 | tpr=0.9841 | fpr=0.1311 | 7645.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.55485 | acc=0.8713 | tpr=0.9825 | fpr=0.1308 | 7769.4 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.55241 | acc=0.8711 | tpr=0.9825 | fpr=0.1310 | 7598.1 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.55441 | acc=0.8711 | tpr=0.9818 | fpr=0.1310 | 7674.2 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.55559 | acc=0.8710 | tpr=0.9825 | fpr=0.1310 | 7605.6 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.55796 | acc=0.8707 | tpr=0.9819 | fpr=0.1313 | 7420.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.56349 | acc=0.8699 | tpr=0.9820 | fpr=0.1321 | 7606.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.56410 | acc=0.8694 | tpr=0.9819 | fpr=0.1326 | 7633.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.56099 | acc=0.8697 | tpr=0.9825 | fpr=0.1324 | 13803.2 samples/s | 53.9 steps/s
Avg test loss: 0.56073, Avg test acc: 0.86967, Avg tpr: 0.98257, Avg fpr: 0.13238, total FA: 18381

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.22558 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=3.236 | acc=0.8594 | 3549.9 samples/s | 55.5 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02152 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.231 | acc=0.9844 | 4566.1 samples/s | 71.3 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01432 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.232 | acc=1.0000 | 4758.7 samples/s | 74.4 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01193 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.234 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01090 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.236 | acc=0.9844 | 4789.1 samples/s | 74.8 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01041 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.238 | acc=1.0000 | 4778.5 samples/s | 74.7 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00978 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.240 | acc=1.0000 | 4772.0 samples/s | 74.6 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00950 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.242 | acc=1.0000 | 4774.9 samples/s | 74.6 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00927 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.244 | acc=1.0000 | 4763.4 samples/s | 74.4 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00919 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.246 | acc=0.9844 | 4802.6 samples/s | 75.0 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00913 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.247 | acc=1.0000 | 4768.5 samples/s | 74.5 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00898 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.249 | acc=0.9844 | 4692.3 samples/s | 73.3 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00883 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.251 | acc=1.0000 | 4702.8 samples/s | 73.5 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00866 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.252 | acc=0.9844 | 4850.5 samples/s | 75.8 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00863 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.254 | acc=1.0000 | 4697.5 samples/s | 73.4 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00872 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.256 | acc=1.0000 | 4806.2 samples/s | 75.1 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00870 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.257 | acc=1.0000 | 4779.1 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.12367 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=3.237 | acc=0.9531 | 3654.7 samples/s | 57.1 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00438 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.241 | acc=1.0000 | 4001.6 samples/s | 62.5 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00222 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.241 | acc=1.0000 | 4524.6 samples/s | 70.7 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00149 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.242 | acc=1.0000 | 4564.4 samples/s | 71.3 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00112 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.242 | acc=1.0000 | 4479.3 samples/s | 70.0 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00090 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.242 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00075 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.243 | acc=1.0000 | 4546.4 samples/s | 71.0 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00064 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.243 | acc=1.0000 | 4535.8 samples/s | 70.9 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00057 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.243 | acc=1.0000 | 4520.0 samples/s | 70.6 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00050 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.243 | acc=1.0000 | 4588.3 samples/s | 71.7 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00045 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.244 | acc=1.0000 | 4528.4 samples/s | 70.8 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00041 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=3.244 | acc=1.0000 | 1935.3 samples/s | 30.2 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00038 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.244 | acc=1.0000 | 4554.3 samples/s | 71.2 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00035 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.245 | acc=1.0000 | 4520.6 samples/s | 70.6 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.245 | acc=1.0000 | 4522.7 samples/s | 70.7 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00031 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.245 | acc=1.0000 | 4511.9 samples/s | 70.5 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=3.245 | acc=1.0000 | 4603.0 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27076 | acc=0.8685 | tpr=0.8120 | fpr=0.0087 | 3954.0 samples/s | 15.4 steps/s
Avg test loss: 0.27509, Avg test acc: 0.86497, Avg tpr: 0.80795, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.51007 | acc=0.8827 | tpr=0.9823 | fpr=0.1191 | 3940.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.51401 | acc=0.8850 | tpr=0.9829 | fpr=0.1168 | 7565.7 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.52095 | acc=0.8851 | tpr=0.9856 | fpr=0.1168 | 7635.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.52064 | acc=0.8852 | tpr=0.9847 | fpr=0.1166 | 7794.5 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.51782 | acc=0.8855 | tpr=0.9843 | fpr=0.1163 | 7544.8 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.52053 | acc=0.8855 | tpr=0.9840 | fpr=0.1163 | 7675.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.52162 | acc=0.8856 | tpr=0.9843 | fpr=0.1162 | 7554.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.52380 | acc=0.8854 | tpr=0.9836 | fpr=0.1164 | 7668.0 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.52916 | acc=0.8847 | tpr=0.9834 | fpr=0.1171 | 7536.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.52959 | acc=0.8842 | tpr=0.9833 | fpr=0.1176 | 7560.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.52648 | acc=0.8848 | tpr=0.9837 | fpr=0.1170 | 14531.6 samples/s | 56.8 steps/s
Avg test loss: 0.52621, Avg test acc: 0.88481, Avg tpr: 0.98376, Avg fpr: 0.11699, total FA: 16244

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.12736 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.262 | acc=0.9062 | 3761.6 samples/s | 58.8 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02311 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=3.254 | acc=1.0000 | 4453.2 samples/s | 69.6 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01634 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.254 | acc=0.9688 | 4666.5 samples/s | 72.9 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01300 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.256 | acc=1.0000 | 4626.8 samples/s | 72.3 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01202 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.258 | acc=0.9844 | 4712.5 samples/s | 73.6 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01136 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.260 | acc=0.9844 | 4741.3 samples/s | 74.1 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01095 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.261 | acc=0.9844 | 4780.2 samples/s | 74.7 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01058 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.262 | acc=0.9844 | 4816.6 samples/s | 75.3 steps/s
[Step=30000 Epoch=29.3] | Loss=0.01022 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.264 | acc=1.0000 | 4758.0 samples/s | 74.3 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00968 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.265 | acc=1.0000 | 4776.4 samples/s | 74.6 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00955 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.267 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00940 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.268 | acc=0.9844 | 4782.5 samples/s | 74.7 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00922 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.270 | acc=0.9844 | 4806.3 samples/s | 75.1 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00923 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.271 | acc=0.9844 | 4776.8 samples/s | 74.6 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00908 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.272 | acc=0.9688 | 4796.7 samples/s | 74.9 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00898 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.274 | acc=1.0000 | 4726.4 samples/s | 73.9 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00899 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.275 | acc=0.9688 | 4807.0 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.00885 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.263 | acc=0.9844 | 3598.4 samples/s | 56.2 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00176 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=3.274 | acc=1.0000 | 4209.2 samples/s | 65.8 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00092 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.276 | acc=1.0000 | 4546.5 samples/s | 71.0 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00062 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=3.277 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00047 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.277 | acc=1.0000 | 4509.3 samples/s | 70.5 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00038 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.278 | acc=1.0000 | 4524.6 samples/s | 70.7 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00032 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.279 | acc=1.0000 | 4528.0 samples/s | 70.7 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00028 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.279 | acc=1.0000 | 4490.2 samples/s | 70.2 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00024 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.280 | acc=1.0000 | 4482.1 samples/s | 70.0 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00022 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.280 | acc=1.0000 | 4537.7 samples/s | 70.9 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00020 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.281 | acc=1.0000 | 4512.5 samples/s | 70.5 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00018 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.281 | acc=1.0000 | 1915.7 samples/s | 29.9 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00016 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.281 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00015 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.282 | acc=1.0000 | 4522.1 samples/s | 70.7 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00014 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.282 | acc=1.0000 | 4495.3 samples/s | 70.2 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00013 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.282 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00012 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.283 | acc=1.0000 | 4573.0 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21998 | acc=0.8904 | tpr=0.8448 | fpr=0.0107 | 3929.1 samples/s | 15.3 steps/s
Avg test loss: 0.22384, Avg test acc: 0.88741, Avg tpr: 0.84106, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.57580 | acc=0.8645 | tpr=0.9823 | fpr=0.1377 | 3953.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.57852 | acc=0.8657 | tpr=0.9829 | fpr=0.1365 | 7704.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.58589 | acc=0.8648 | tpr=0.9856 | fpr=0.1375 | 7502.9 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.58501 | acc=0.8649 | tpr=0.9836 | fpr=0.1373 | 7647.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.58256 | acc=0.8650 | tpr=0.9834 | fpr=0.1372 | 7751.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.58498 | acc=0.8648 | tpr=0.9833 | fpr=0.1373 | 7679.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.58564 | acc=0.8649 | tpr=0.9837 | fpr=0.1372 | 7578.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.58784 | acc=0.8646 | tpr=0.9830 | fpr=0.1376 | 7615.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.59335 | acc=0.8638 | tpr=0.9830 | fpr=0.1383 | 7555.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.59412 | acc=0.8634 | tpr=0.9819 | fpr=0.1387 | 7649.9 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.59112 | acc=0.8636 | tpr=0.9825 | fpr=0.1386 | 14419.5 samples/s | 56.3 steps/s
Avg test loss: 0.59091, Avg test acc: 0.86359, Avg tpr: 0.98257, Avg fpr: 0.13858, total FA: 19241

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.12115 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.289 | acc=0.8906 | 3657.1 samples/s | 57.1 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01536 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.289 | acc=0.9844 | 4487.2 samples/s | 70.1 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01204 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.290 | acc=1.0000 | 4764.7 samples/s | 74.4 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01105 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.292 | acc=0.9688 | 4761.1 samples/s | 74.4 steps/s
[Step=30600 Epoch=29.9] | Loss=0.00991 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.294 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01000 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.296 | acc=1.0000 | 4805.0 samples/s | 75.1 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00943 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.297 | acc=1.0000 | 4772.3 samples/s | 74.6 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00914 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.298 | acc=1.0000 | 4836.7 samples/s | 75.6 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00906 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.299 | acc=1.0000 | 4768.4 samples/s | 74.5 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00868 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.301 | acc=1.0000 | 4838.0 samples/s | 75.6 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00859 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.302 | acc=1.0000 | 4756.6 samples/s | 74.3 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00844 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.303 | acc=1.0000 | 4780.1 samples/s | 74.7 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00839 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.304 | acc=1.0000 | 4837.3 samples/s | 75.6 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00846 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.305 | acc=1.0000 | 4795.4 samples/s | 74.9 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00840 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.306 | acc=1.0000 | 4813.1 samples/s | 75.2 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00850 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.307 | acc=0.9844 | 4765.1 samples/s | 74.5 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00867 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.308 | acc=1.0000 | 4769.2 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.04534 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.289 | acc=0.9844 | 3901.2 samples/s | 61.0 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00737 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.289 | acc=1.0000 | 4058.8 samples/s | 63.4 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00375 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.287 | acc=1.0000 | 4390.4 samples/s | 68.6 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00251 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.288 | acc=1.0000 | 4518.4 samples/s | 70.6 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00189 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.288 | acc=1.0000 | 4591.8 samples/s | 71.7 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00151 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.288 | acc=1.0000 | 4457.8 samples/s | 69.7 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00127 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.289 | acc=1.0000 | 4507.7 samples/s | 70.4 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00131 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.289 | acc=1.0000 | 4554.9 samples/s | 71.2 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00115 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.289 | acc=1.0000 | 4556.7 samples/s | 71.2 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00103 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.290 | acc=1.0000 | 4451.5 samples/s | 69.6 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00092 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.290 | acc=1.0000 | 4604.1 samples/s | 71.9 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00084 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.290 | acc=1.0000 | 1909.8 samples/s | 29.8 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00077 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.290 | acc=1.0000 | 4530.5 samples/s | 70.8 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00071 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.290 | acc=1.0000 | 4509.1 samples/s | 70.5 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00066 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.291 | acc=1.0000 | 4536.9 samples/s | 70.9 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00062 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.291 | acc=1.0000 | 4538.2 samples/s | 70.9 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00058 | Reg=0.00205 | L2-Norm=14.300 | L2-Norm(final)=3.291 | acc=1.0000 | 4514.8 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27560 | acc=0.8583 | tpr=0.7967 | fpr=0.0079 | 3925.0 samples/s | 15.3 steps/s
Avg test loss: 0.27998, Avg test acc: 0.85488, Avg tpr: 0.79285, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.46989 | acc=0.8912 | tpr=0.9690 | fpr=0.1102 | 3947.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.47500 | acc=0.8942 | tpr=0.9765 | fpr=0.1074 | 7540.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.48239 | acc=0.8942 | tpr=0.9813 | fpr=0.1074 | 7812.6 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.48245 | acc=0.8943 | tpr=0.9803 | fpr=0.1072 | 7567.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.48042 | acc=0.8945 | tpr=0.9808 | fpr=0.1071 | 7607.7 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.48294 | acc=0.8947 | tpr=0.9811 | fpr=0.1069 | 7850.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.48389 | acc=0.8944 | tpr=0.9818 | fpr=0.1072 | 7567.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.48601 | acc=0.8944 | tpr=0.9819 | fpr=0.1072 | 7612.2 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.49151 | acc=0.8936 | tpr=0.9820 | fpr=0.1081 | 7424.8 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.49217 | acc=0.8930 | tpr=0.9811 | fpr=0.1086 | 7736.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.48928 | acc=0.8935 | tpr=0.9817 | fpr=0.1082 | 13908.3 samples/s | 54.3 steps/s
Avg test loss: 0.48896, Avg test acc: 0.89346, Avg tpr: 0.98177, Avg fpr: 0.10815, total FA: 15016

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.27420 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.306 | acc=0.8750 | 3888.2 samples/s | 60.8 steps/s
[Step=31250 Epoch=30.5] | Loss=0.02171 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.299 | acc=1.0000 | 4167.8 samples/s | 65.1 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01413 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.301 | acc=1.0000 | 4853.5 samples/s | 75.8 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01208 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.303 | acc=1.0000 | 4676.5 samples/s | 73.1 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01098 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.306 | acc=0.9844 | 4772.1 samples/s | 74.6 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01078 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.308 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01017 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.310 | acc=1.0000 | 4811.4 samples/s | 75.2 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00978 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.311 | acc=1.0000 | 4763.0 samples/s | 74.4 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00967 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.313 | acc=1.0000 | 4835.4 samples/s | 75.6 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00980 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.314 | acc=0.9844 | 4775.1 samples/s | 74.6 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00935 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.316 | acc=1.0000 | 4828.6 samples/s | 75.4 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00918 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.317 | acc=0.9844 | 4778.5 samples/s | 74.7 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00898 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.319 | acc=1.0000 | 4827.3 samples/s | 75.4 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00892 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.320 | acc=1.0000 | 4789.2 samples/s | 74.8 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00892 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.321 | acc=0.9844 | 4789.1 samples/s | 74.8 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00890 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.322 | acc=0.9844 | 4788.7 samples/s | 74.8 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00887 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.323 | acc=0.9688 | 4771.7 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.00493 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.307 | acc=1.0000 | 3640.9 samples/s | 56.9 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00135 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.318 | acc=1.0000 | 3972.2 samples/s | 62.1 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00070 | Reg=0.00205 | L2-Norm=14.300 | L2-Norm(final)=3.320 | acc=1.0000 | 4506.8 samples/s | 70.4 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00047 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.322 | acc=1.0000 | 4549.5 samples/s | 71.1 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00036 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.322 | acc=1.0000 | 4524.7 samples/s | 70.7 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00030 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.323 | acc=1.0000 | 4546.2 samples/s | 71.0 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00025 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.324 | acc=1.0000 | 4540.9 samples/s | 71.0 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00022 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.324 | acc=1.0000 | 4515.0 samples/s | 70.5 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00019 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.325 | acc=1.0000 | 4573.2 samples/s | 71.5 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00017 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=3.325 | acc=1.0000 | 4587.2 samples/s | 71.7 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00015 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.325 | acc=1.0000 | 4611.6 samples/s | 72.1 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00014 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.326 | acc=1.0000 | 1855.6 samples/s | 29.0 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00013 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.326 | acc=1.0000 | 4474.1 samples/s | 69.9 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00012 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.326 | acc=1.0000 | 4494.0 samples/s | 70.2 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00011 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.327 | acc=1.0000 | 4604.8 samples/s | 72.0 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00010 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.327 | acc=1.0000 | 4398.6 samples/s | 68.7 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00010 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.327 | acc=1.0000 | 4563.1 samples/s | 71.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23405 | acc=0.8824 | tpr=0.8332 | fpr=0.0107 | 3891.9 samples/s | 15.2 steps/s
Avg test loss: 0.23833, Avg test acc: 0.87936, Avg tpr: 0.82917, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.55647 | acc=0.8721 | tpr=0.9779 | fpr=0.1298 | 3910.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.56132 | acc=0.8737 | tpr=0.9808 | fpr=0.1283 | 7454.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.56890 | acc=0.8730 | tpr=0.9841 | fpr=0.1291 | 7779.5 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.56866 | acc=0.8734 | tpr=0.9814 | fpr=0.1286 | 7699.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.56708 | acc=0.8731 | tpr=0.9817 | fpr=0.1288 | 7433.9 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.57009 | acc=0.8730 | tpr=0.9818 | fpr=0.1289 | 7685.4 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.57107 | acc=0.8729 | tpr=0.9831 | fpr=0.1291 | 7543.4 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.57313 | acc=0.8726 | tpr=0.9825 | fpr=0.1294 | 7633.1 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.57899 | acc=0.8718 | tpr=0.9825 | fpr=0.1302 | 7517.8 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.58008 | acc=0.8715 | tpr=0.9815 | fpr=0.1305 | 7335.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.57704 | acc=0.8717 | tpr=0.9821 | fpr=0.1304 | 14434.9 samples/s | 56.4 steps/s
Avg test loss: 0.57674, Avg test acc: 0.87166, Avg tpr: 0.98217, Avg fpr: 0.13035, total FA: 18099

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.16315 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=3.334 | acc=0.9219 | 3778.0 samples/s | 59.0 steps/s
[Step=32050 Epoch=31.3] | Loss=0.02326 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.333 | acc=0.9844 | 4481.1 samples/s | 70.0 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01479 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=3.333 | acc=1.0000 | 4796.8 samples/s | 75.0 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01239 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.335 | acc=1.0000 | 4737.9 samples/s | 74.0 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01130 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.336 | acc=1.0000 | 4831.3 samples/s | 75.5 steps/s
[Step=32250 Epoch=31.5] | Loss=0.01058 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.337 | acc=1.0000 | 4694.9 samples/s | 73.4 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00994 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.338 | acc=1.0000 | 4768.9 samples/s | 74.5 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00954 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.339 | acc=0.9844 | 4867.1 samples/s | 76.0 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00927 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.340 | acc=1.0000 | 4798.8 samples/s | 75.0 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00909 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.342 | acc=0.9844 | 4738.9 samples/s | 74.0 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00872 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.343 | acc=1.0000 | 4787.8 samples/s | 74.8 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00836 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.344 | acc=1.0000 | 4798.4 samples/s | 75.0 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00822 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.345 | acc=1.0000 | 4800.3 samples/s | 75.0 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00811 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.346 | acc=0.9844 | 4852.1 samples/s | 75.8 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00793 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.347 | acc=1.0000 | 4796.8 samples/s | 75.0 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00792 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.348 | acc=0.9844 | 4770.7 samples/s | 74.5 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00782 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.349 | acc=1.0000 | 4900.0 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.07153 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=3.335 | acc=0.9531 | 3958.6 samples/s | 61.9 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00483 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.342 | acc=1.0000 | 3911.0 samples/s | 61.1 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00244 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.343 | acc=1.0000 | 4545.1 samples/s | 71.0 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00163 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.344 | acc=1.0000 | 4558.9 samples/s | 71.2 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00123 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.344 | acc=1.0000 | 4513.2 samples/s | 70.5 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00099 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.344 | acc=1.0000 | 4559.5 samples/s | 71.2 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00082 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.345 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00071 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.345 | acc=1.0000 | 4585.4 samples/s | 71.6 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00062 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.345 | acc=1.0000 | 4554.9 samples/s | 71.2 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00055 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=3.345 | acc=1.0000 | 4584.8 samples/s | 71.6 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00050 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=3.345 | acc=1.0000 | 4561.6 samples/s | 71.3 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00045 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.345 | acc=1.0000 | 1913.8 samples/s | 29.9 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00042 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.345 | acc=1.0000 | 4629.0 samples/s | 72.3 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00039 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.346 | acc=1.0000 | 4464.7 samples/s | 69.8 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00036 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.346 | acc=1.0000 | 4524.1 samples/s | 70.7 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00034 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.346 | acc=1.0000 | 4537.6 samples/s | 70.9 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00032 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.346 | acc=1.0000 | 4509.0 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27325 | acc=0.8709 | tpr=0.8158 | fpr=0.0097 | 3936.8 samples/s | 15.4 steps/s
Avg test loss: 0.27814, Avg test acc: 0.86726, Avg tpr: 0.81145, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.52509 | acc=0.8882 | tpr=0.9735 | fpr=0.1133 | 3920.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.53107 | acc=0.8896 | tpr=0.9787 | fpr=0.1121 | 7642.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.53906 | acc=0.8893 | tpr=0.9827 | fpr=0.1124 | 7675.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.53881 | acc=0.8896 | tpr=0.9803 | fpr=0.1121 | 7459.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.53669 | acc=0.8895 | tpr=0.9808 | fpr=0.1121 | 7665.3 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.53988 | acc=0.8894 | tpr=0.9811 | fpr=0.1123 | 7440.8 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.54102 | acc=0.8892 | tpr=0.9818 | fpr=0.1125 | 7700.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.54326 | acc=0.8889 | tpr=0.9814 | fpr=0.1128 | 7710.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.54906 | acc=0.8881 | tpr=0.9815 | fpr=0.1136 | 7528.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.54995 | acc=0.8875 | tpr=0.9806 | fpr=0.1142 | 7319.1 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.54689 | acc=0.8879 | tpr=0.9813 | fpr=0.1138 | 14581.8 samples/s | 57.0 steps/s
Avg test loss: 0.54665, Avg test acc: 0.88788, Avg tpr: 0.98138, Avg fpr: 0.11382, total FA: 15804

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.15129 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.354 | acc=0.9062 | 3618.7 samples/s | 56.5 steps/s
[Step=32850 Epoch=32.1] | Loss=0.01836 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.352 | acc=1.0000 | 4620.5 samples/s | 72.2 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01175 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.352 | acc=1.0000 | 4757.0 samples/s | 74.3 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01016 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.353 | acc=0.9844 | 4754.1 samples/s | 74.3 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00954 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.354 | acc=1.0000 | 4775.8 samples/s | 74.6 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00905 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.355 | acc=1.0000 | 4774.5 samples/s | 74.6 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00852 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.356 | acc=1.0000 | 4785.5 samples/s | 74.8 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00849 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=3.357 | acc=1.0000 | 4874.7 samples/s | 76.2 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00811 | Reg=0.00204 | L2-Norm=14.268 | L2-Norm(final)=3.358 | acc=1.0000 | 4711.9 samples/s | 73.6 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00820 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=3.359 | acc=1.0000 | 4779.4 samples/s | 74.7 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00799 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=3.360 | acc=1.0000 | 4793.8 samples/s | 74.9 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00781 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.361 | acc=1.0000 | 4775.8 samples/s | 74.6 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00759 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.362 | acc=1.0000 | 4788.5 samples/s | 74.8 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00753 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.363 | acc=1.0000 | 4777.3 samples/s | 74.6 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00744 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.364 | acc=1.0000 | 4861.3 samples/s | 76.0 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00753 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.364 | acc=0.9844 | 4667.1 samples/s | 72.9 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00749 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.365 | acc=1.0000 | 4817.4 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.13270 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.355 | acc=0.9688 | 3764.3 samples/s | 58.8 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00619 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.361 | acc=1.0000 | 4007.3 samples/s | 62.6 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00311 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.361 | acc=1.0000 | 4566.3 samples/s | 71.3 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00208 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=3.361 | acc=1.0000 | 4480.1 samples/s | 70.0 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00157 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.362 | acc=1.0000 | 4499.5 samples/s | 70.3 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00126 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.362 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00105 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.362 | acc=1.0000 | 4497.5 samples/s | 70.3 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00090 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.362 | acc=1.0000 | 4566.4 samples/s | 71.4 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00079 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.362 | acc=1.0000 | 4603.6 samples/s | 71.9 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00071 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.363 | acc=1.0000 | 4532.2 samples/s | 70.8 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00064 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.363 | acc=1.0000 | 4596.2 samples/s | 71.8 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00058 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.363 | acc=1.0000 | 1948.7 samples/s | 30.4 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00053 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=3.363 | acc=1.0000 | 4564.5 samples/s | 71.3 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00049 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.363 | acc=1.0000 | 4520.2 samples/s | 70.6 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00046 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=3.363 | acc=1.0000 | 4484.3 samples/s | 70.1 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00043 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=3.364 | acc=1.0000 | 4650.9 samples/s | 72.7 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00040 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.364 | acc=1.0000 | 4440.7 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24854 | acc=0.8834 | tpr=0.8347 | fpr=0.0109 | 3930.2 samples/s | 15.4 steps/s
Avg test loss: 0.25319, Avg test acc: 0.87988, Avg tpr: 0.83045, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.55591 | acc=0.8804 | tpr=0.9735 | fpr=0.1213 | 3957.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.56235 | acc=0.8825 | tpr=0.9787 | fpr=0.1193 | 7679.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.56976 | acc=0.8821 | tpr=0.9827 | fpr=0.1197 | 7715.5 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.56920 | acc=0.8823 | tpr=0.9803 | fpr=0.1195 | 7749.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.56714 | acc=0.8822 | tpr=0.9808 | fpr=0.1195 | 7315.4 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.57041 | acc=0.8823 | tpr=0.9804 | fpr=0.1194 | 7564.5 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.57173 | acc=0.8822 | tpr=0.9812 | fpr=0.1196 | 7797.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.57406 | acc=0.8820 | tpr=0.9809 | fpr=0.1198 | 7476.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.58013 | acc=0.8813 | tpr=0.9810 | fpr=0.1205 | 7611.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.58111 | acc=0.8808 | tpr=0.9806 | fpr=0.1210 | 7335.0 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.57799 | acc=0.8812 | tpr=0.9813 | fpr=0.1206 | 14582.5 samples/s | 57.0 steps/s
Avg test loss: 0.57775, Avg test acc: 0.88115, Avg tpr: 0.98138, Avg fpr: 0.12067, total FA: 16755

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.06635 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.371 | acc=0.9531 | 3976.4 samples/s | 62.1 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01925 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.367 | acc=1.0000 | 4357.3 samples/s | 68.1 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01225 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=3.368 | acc=1.0000 | 4739.3 samples/s | 74.1 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01045 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=3.369 | acc=1.0000 | 4751.5 samples/s | 74.2 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00987 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=3.370 | acc=0.9844 | 4755.5 samples/s | 74.3 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00924 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.370 | acc=1.0000 | 4782.5 samples/s | 74.7 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00866 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=3.371 | acc=1.0000 | 4753.5 samples/s | 74.3 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00832 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.372 | acc=1.0000 | 4788.4 samples/s | 74.8 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00812 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.373 | acc=1.0000 | 4777.6 samples/s | 74.7 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00781 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=3.374 | acc=1.0000 | 4776.6 samples/s | 74.6 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00766 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.375 | acc=1.0000 | 4745.9 samples/s | 74.2 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00747 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=3.376 | acc=1.0000 | 4709.7 samples/s | 73.6 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00740 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.376 | acc=1.0000 | 4749.9 samples/s | 74.2 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00733 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=3.377 | acc=1.0000 | 4795.8 samples/s | 74.9 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00728 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.378 | acc=1.0000 | 4806.2 samples/s | 75.1 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00728 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.379 | acc=1.0000 | 4784.2 samples/s | 74.8 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00736 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=3.380 | acc=1.0000 | 4824.2 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.08540 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.371 | acc=0.9375 | 3957.7 samples/s | 61.8 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00545 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.375 | acc=1.0000 | 3993.6 samples/s | 62.4 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00275 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.377 | acc=1.0000 | 4416.0 samples/s | 69.0 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00184 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.377 | acc=1.0000 | 4536.0 samples/s | 70.9 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00139 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.378 | acc=1.0000 | 4518.7 samples/s | 70.6 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00111 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.378 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00093 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=3.378 | acc=1.0000 | 4600.2 samples/s | 71.9 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00080 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=3.379 | acc=1.0000 | 4461.1 samples/s | 69.7 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00070 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.379 | acc=1.0000 | 4555.3 samples/s | 71.2 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00063 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=3.379 | acc=1.0000 | 4587.1 samples/s | 71.7 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00057 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.379 | acc=1.0000 | 4578.0 samples/s | 71.5 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00051 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.379 | acc=1.0000 | 1897.0 samples/s | 29.6 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00047 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.380 | acc=1.0000 | 4614.8 samples/s | 72.1 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00044 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.380 | acc=1.0000 | 4531.5 samples/s | 70.8 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00041 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.380 | acc=1.0000 | 4504.2 samples/s | 70.4 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00038 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=3.380 | acc=1.0000 | 4521.6 samples/s | 70.6 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00036 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=3.380 | acc=1.0000 | 4554.6 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22579 | acc=0.8927 | tpr=0.8488 | fpr=0.0119 | 3959.2 samples/s | 15.5 steps/s
Avg test loss: 0.22931, Avg test acc: 0.89010, Avg tpr: 0.84566, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.55347 | acc=0.8811 | tpr=0.9735 | fpr=0.1206 | 3948.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.56003 | acc=0.8827 | tpr=0.9787 | fpr=0.1191 | 7482.8 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.56684 | acc=0.8824 | tpr=0.9827 | fpr=0.1194 | 7728.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.56619 | acc=0.8828 | tpr=0.9803 | fpr=0.1190 | 7747.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.56414 | acc=0.8828 | tpr=0.9808 | fpr=0.1190 | 7470.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.56747 | acc=0.8828 | tpr=0.9804 | fpr=0.1190 | 7606.4 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.56864 | acc=0.8829 | tpr=0.9812 | fpr=0.1189 | 7711.8 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.57102 | acc=0.8827 | tpr=0.9809 | fpr=0.1191 | 7457.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.57703 | acc=0.8818 | tpr=0.9810 | fpr=0.1200 | 7524.0 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.57811 | acc=0.8812 | tpr=0.9806 | fpr=0.1206 | 7701.0 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.57510 | acc=0.8816 | tpr=0.9813 | fpr=0.1202 | 13714.6 samples/s | 53.6 steps/s
Avg test loss: 0.57483, Avg test acc: 0.88160, Avg tpr: 0.98138, Avg fpr: 0.12021, total FA: 16691

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.18895 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.386 | acc=0.8906 | 3821.1 samples/s | 59.7 steps/s
[Step=34450 Epoch=33.6] | Loss=0.01991 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.382 | acc=1.0000 | 4258.6 samples/s | 66.5 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01339 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=3.382 | acc=1.0000 | 4638.6 samples/s | 72.5 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01108 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.384 | acc=1.0000 | 4767.5 samples/s | 74.5 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00943 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.385 | acc=0.9844 | 4768.1 samples/s | 74.5 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00907 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.386 | acc=1.0000 | 4784.1 samples/s | 74.8 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00858 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.387 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00798 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.388 | acc=0.9844 | 4770.8 samples/s | 74.5 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00775 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=3.389 | acc=1.0000 | 4804.2 samples/s | 75.1 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00725 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=3.390 | acc=1.0000 | 4724.7 samples/s | 73.8 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00709 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.391 | acc=0.9844 | 4741.9 samples/s | 74.1 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00707 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=3.392 | acc=0.9844 | 4844.1 samples/s | 75.7 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00707 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=3.393 | acc=0.9844 | 4699.8 samples/s | 73.4 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00741 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=3.394 | acc=0.9844 | 4740.8 samples/s | 74.1 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00740 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=3.395 | acc=1.0000 | 4859.9 samples/s | 75.9 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00741 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.395 | acc=1.0000 | 4748.5 samples/s | 74.2 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00735 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=3.396 | acc=0.9844 | 4694.1 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.02722 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.386 | acc=0.9688 | 3571.7 samples/s | 55.8 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00516 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.393 | acc=1.0000 | 4189.4 samples/s | 65.5 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00260 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.394 | acc=1.0000 | 4535.4 samples/s | 70.9 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00174 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.395 | acc=1.0000 | 4449.8 samples/s | 69.5 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00131 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.395 | acc=1.0000 | 4433.6 samples/s | 69.3 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00106 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=3.395 | acc=1.0000 | 4495.2 samples/s | 70.2 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00088 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.395 | acc=1.0000 | 4548.8 samples/s | 71.1 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00076 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.396 | acc=1.0000 | 4389.3 samples/s | 68.6 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00067 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.396 | acc=1.0000 | 4465.9 samples/s | 69.8 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00059 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.396 | acc=1.0000 | 4528.1 samples/s | 70.8 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00054 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=3.396 | acc=1.0000 | 4564.3 samples/s | 71.3 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00049 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=3.396 | acc=1.0000 | 1879.3 samples/s | 29.4 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00045 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.396 | acc=1.0000 | 4477.5 samples/s | 70.0 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00041 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.396 | acc=1.0000 | 4507.5 samples/s | 70.4 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00038 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.396 | acc=1.0000 | 4510.1 samples/s | 70.5 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00036 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.397 | acc=1.0000 | 4525.2 samples/s | 70.7 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00034 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.397 | acc=1.0000 | 4553.4 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22880 | acc=0.8945 | tpr=0.8513 | fpr=0.0119 | 3962.7 samples/s | 15.5 steps/s
Avg test loss: 0.23204, Avg test acc: 0.89098, Avg tpr: 0.84665, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.55269 | acc=0.8832 | tpr=0.9735 | fpr=0.1184 | 3918.8 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.56054 | acc=0.8852 | tpr=0.9787 | fpr=0.1166 | 7636.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.56730 | acc=0.8849 | tpr=0.9827 | fpr=0.1169 | 7750.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.56647 | acc=0.8848 | tpr=0.9803 | fpr=0.1169 | 7701.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.56455 | acc=0.8847 | tpr=0.9808 | fpr=0.1170 | 7486.5 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.56795 | acc=0.8849 | tpr=0.9804 | fpr=0.1168 | 7885.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.56929 | acc=0.8849 | tpr=0.9812 | fpr=0.1168 | 7830.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.57186 | acc=0.8849 | tpr=0.9809 | fpr=0.1169 | 7453.4 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.57797 | acc=0.8840 | tpr=0.9810 | fpr=0.1178 | 7595.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.57903 | acc=0.8835 | tpr=0.9806 | fpr=0.1182 | 7500.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.57609 | acc=0.8841 | tpr=0.9813 | fpr=0.1177 | 14049.9 samples/s | 54.9 steps/s
Avg test loss: 0.57574, Avg test acc: 0.88403, Avg tpr: 0.98138, Avg fpr: 0.11774, total FA: 16348

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.14093 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.402 | acc=0.9219 | 3672.2 samples/s | 57.4 steps/s
[Step=35250 Epoch=34.4] | Loss=0.02028 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.398 | acc=1.0000 | 4461.9 samples/s | 69.7 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01261 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.398 | acc=1.0000 | 4722.9 samples/s | 73.8 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01083 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.399 | acc=0.9688 | 4768.9 samples/s | 74.5 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00980 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.400 | acc=1.0000 | 4789.4 samples/s | 74.8 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00902 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=3.401 | acc=1.0000 | 4753.2 samples/s | 74.3 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00865 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=3.402 | acc=0.9844 | 4811.4 samples/s | 75.2 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00834 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=3.403 | acc=1.0000 | 4767.2 samples/s | 74.5 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00796 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=3.404 | acc=1.0000 | 4781.0 samples/s | 74.7 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00769 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=3.405 | acc=1.0000 | 4787.7 samples/s | 74.8 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00776 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.405 | acc=1.0000 | 4794.6 samples/s | 74.9 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00750 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.406 | acc=1.0000 | 4781.0 samples/s | 74.7 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00743 | Reg=0.00203 | L2-Norm=14.249 | L2-Norm(final)=3.407 | acc=0.9844 | 4817.1 samples/s | 75.3 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00727 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.408 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00720 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=3.409 | acc=0.9844 | 4832.5 samples/s | 75.5 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00715 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.410 | acc=1.0000 | 4766.0 samples/s | 74.5 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00722 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=3.411 | acc=1.0000 | 4627.4 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.00294 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.403 | acc=1.0000 | 4044.2 samples/s | 63.2 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00640 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.407 | acc=1.0000 | 3903.0 samples/s | 61.0 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00322 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.408 | acc=1.0000 | 4546.3 samples/s | 71.0 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00215 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.409 | acc=1.0000 | 4486.9 samples/s | 70.1 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00162 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=3.409 | acc=1.0000 | 4513.0 samples/s | 70.5 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00130 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.409 | acc=1.0000 | 4511.1 samples/s | 70.5 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00108 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=3.409 | acc=1.0000 | 4552.5 samples/s | 71.1 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00093 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.409 | acc=1.0000 | 4548.1 samples/s | 71.1 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00082 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.409 | acc=1.0000 | 4488.3 samples/s | 70.1 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00073 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.409 | acc=1.0000 | 4572.7 samples/s | 71.4 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00066 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=3.410 | acc=1.0000 | 4536.4 samples/s | 70.9 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00060 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=3.410 | acc=1.0000 | 1884.5 samples/s | 29.4 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00055 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.410 | acc=1.0000 | 4574.1 samples/s | 71.5 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00051 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.410 | acc=1.0000 | 4554.7 samples/s | 71.2 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00047 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.410 | acc=1.0000 | 4507.1 samples/s | 70.4 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00044 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.410 | acc=1.0000 | 4519.2 samples/s | 70.6 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00041 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.410 | acc=1.0000 | 4497.3 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21908 | acc=0.8969 | tpr=0.8550 | fpr=0.0121 | 3923.6 samples/s | 15.3 steps/s
Avg test loss: 0.22289, Avg test acc: 0.89378, Avg tpr: 0.85108, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.54995 | acc=0.8841 | tpr=0.9735 | fpr=0.1175 | 3927.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.55614 | acc=0.8863 | tpr=0.9765 | fpr=0.1154 | 7539.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.56247 | acc=0.8863 | tpr=0.9813 | fpr=0.1154 | 7614.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.56178 | acc=0.8862 | tpr=0.9792 | fpr=0.1155 | 7502.6 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.55934 | acc=0.8861 | tpr=0.9799 | fpr=0.1156 | 7792.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.56266 | acc=0.8858 | tpr=0.9796 | fpr=0.1159 | 7589.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.56395 | acc=0.8856 | tpr=0.9812 | fpr=0.1161 | 7625.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.56626 | acc=0.8856 | tpr=0.9809 | fpr=0.1161 | 7578.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.57234 | acc=0.8848 | tpr=0.9810 | fpr=0.1170 | 7563.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.57327 | acc=0.8844 | tpr=0.9806 | fpr=0.1174 | 7433.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.57032 | acc=0.8849 | tpr=0.9813 | fpr=0.1169 | 13956.0 samples/s | 54.5 steps/s
Avg test loss: 0.57001, Avg test acc: 0.88489, Avg tpr: 0.98138, Avg fpr: 0.11687, total FA: 16227

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.15180 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.416 | acc=0.9062 | 3478.0 samples/s | 54.3 steps/s
[Step=36050 Epoch=35.2] | Loss=0.02023 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.412 | acc=0.9844 | 4793.4 samples/s | 74.9 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01381 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.412 | acc=0.9844 | 4735.7 samples/s | 74.0 steps/s
[Step=36150 Epoch=35.3] | Loss=0.01123 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.413 | acc=1.0000 | 4757.8 samples/s | 74.3 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00996 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.413 | acc=1.0000 | 4808.6 samples/s | 75.1 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00891 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=3.414 | acc=1.0000 | 4789.7 samples/s | 74.8 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00848 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=3.415 | acc=1.0000 | 4824.3 samples/s | 75.4 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00828 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=3.416 | acc=1.0000 | 4806.7 samples/s | 75.1 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00811 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.417 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00799 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.418 | acc=1.0000 | 4800.0 samples/s | 75.0 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00770 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=3.419 | acc=0.9844 | 4823.1 samples/s | 75.4 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00772 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.419 | acc=0.9844 | 4821.7 samples/s | 75.3 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00760 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.420 | acc=1.0000 | 4753.3 samples/s | 74.3 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00752 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=3.421 | acc=1.0000 | 4802.3 samples/s | 75.0 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00736 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.421 | acc=1.0000 | 4817.6 samples/s | 75.3 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00731 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.422 | acc=0.9844 | 4818.4 samples/s | 75.3 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00730 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=3.423 | acc=1.0000 | 4763.8 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.01025 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.417 | acc=1.0000 | 3825.1 samples/s | 59.8 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00486 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.423 | acc=1.0000 | 3961.1 samples/s | 61.9 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00244 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.423 | acc=1.0000 | 4517.0 samples/s | 70.6 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00163 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.424 | acc=1.0000 | 4504.1 samples/s | 70.4 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00123 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=3.424 | acc=1.0000 | 4546.9 samples/s | 71.0 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00099 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.424 | acc=1.0000 | 4537.1 samples/s | 70.9 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00082 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=3.424 | acc=1.0000 | 4514.0 samples/s | 70.5 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00071 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.424 | acc=1.0000 | 4546.4 samples/s | 71.0 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00062 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.424 | acc=1.0000 | 4549.6 samples/s | 71.1 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00055 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.424 | acc=1.0000 | 4510.0 samples/s | 70.5 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00050 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.424 | acc=1.0000 | 4609.0 samples/s | 72.0 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00045 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.425 | acc=1.0000 | 1844.8 samples/s | 28.8 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00042 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=3.425 | acc=1.0000 | 4579.5 samples/s | 71.6 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00039 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.425 | acc=1.0000 | 4459.2 samples/s | 69.7 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00036 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=3.425 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00034 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.425 | acc=1.0000 | 4559.9 samples/s | 71.2 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00031 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.425 | acc=1.0000 | 4506.6 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22416 | acc=0.8945 | tpr=0.8519 | fpr=0.0129 | 3942.0 samples/s | 15.4 steps/s
Avg test loss: 0.22763, Avg test acc: 0.89162, Avg tpr: 0.84799, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.54292 | acc=0.8867 | tpr=0.9735 | fpr=0.1148 | 3958.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.54808 | acc=0.8888 | tpr=0.9787 | fpr=0.1128 | 7674.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.55457 | acc=0.8891 | tpr=0.9827 | fpr=0.1127 | 7510.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.55388 | acc=0.8889 | tpr=0.9803 | fpr=0.1128 | 7481.9 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.55111 | acc=0.8887 | tpr=0.9799 | fpr=0.1130 | 7750.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.55484 | acc=0.8884 | tpr=0.9789 | fpr=0.1132 | 7548.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.55607 | acc=0.8884 | tpr=0.9806 | fpr=0.1133 | 7963.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.55840 | acc=0.8883 | tpr=0.9803 | fpr=0.1133 | 7401.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.56437 | acc=0.8875 | tpr=0.9805 | fpr=0.1142 | 7686.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.56525 | acc=0.8871 | tpr=0.9802 | fpr=0.1146 | 7645.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.56229 | acc=0.8876 | tpr=0.9809 | fpr=0.1141 | 13991.2 samples/s | 54.7 steps/s
Avg test loss: 0.56198, Avg test acc: 0.88756, Avg tpr: 0.98098, Avg fpr: 0.11414, total FA: 15848

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.16091 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.429 | acc=0.8750 | 3767.6 samples/s | 58.9 steps/s
[Step=36850 Epoch=36.0] | Loss=0.01988 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.425 | acc=1.0000 | 4459.6 samples/s | 69.7 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01275 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.425 | acc=1.0000 | 4762.3 samples/s | 74.4 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01057 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.426 | acc=1.0000 | 4743.6 samples/s | 74.1 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00961 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=3.427 | acc=0.9844 | 4764.8 samples/s | 74.4 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00920 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=3.428 | acc=1.0000 | 4825.3 samples/s | 75.4 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00880 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.429 | acc=1.0000 | 4794.3 samples/s | 74.9 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00847 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=3.429 | acc=0.9844 | 4798.6 samples/s | 75.0 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00810 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.430 | acc=0.9844 | 4797.6 samples/s | 75.0 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00808 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.431 | acc=0.9531 | 4816.4 samples/s | 75.3 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00796 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=3.432 | acc=0.9844 | 4864.3 samples/s | 76.0 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00768 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.432 | acc=1.0000 | 4759.6 samples/s | 74.4 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00757 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.433 | acc=1.0000 | 4783.0 samples/s | 74.7 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00751 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=3.433 | acc=0.9844 | 4850.5 samples/s | 75.8 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00745 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.434 | acc=0.9844 | 4830.0 samples/s | 75.5 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00739 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.435 | acc=0.9688 | 4757.4 samples/s | 74.3 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00726 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=3.436 | acc=1.0000 | 4782.9 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.00022 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.430 | acc=1.0000 | 3732.6 samples/s | 58.3 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00607 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.436 | acc=1.0000 | 4164.3 samples/s | 65.1 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00305 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.437 | acc=1.0000 | 4502.8 samples/s | 70.4 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00204 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.437 | acc=1.0000 | 4673.0 samples/s | 73.0 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00153 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.437 | acc=1.0000 | 4397.1 samples/s | 68.7 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00123 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=3.438 | acc=1.0000 | 4560.4 samples/s | 71.3 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00103 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=3.438 | acc=1.0000 | 4562.8 samples/s | 71.3 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00088 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.438 | acc=1.0000 | 4549.5 samples/s | 71.1 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00077 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.438 | acc=1.0000 | 4539.1 samples/s | 70.9 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00069 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.438 | acc=1.0000 | 4545.9 samples/s | 71.0 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00062 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.438 | acc=1.0000 | 4587.8 samples/s | 71.7 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00057 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.438 | acc=1.0000 | 1903.3 samples/s | 29.7 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00052 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.438 | acc=1.0000 | 4530.3 samples/s | 70.8 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.438 | acc=1.0000 | 4545.7 samples/s | 71.0 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00045 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.439 | acc=1.0000 | 4499.5 samples/s | 70.3 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.439 | acc=1.0000 | 4517.9 samples/s | 70.6 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00039 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.439 | acc=1.0000 | 4543.6 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22436 | acc=0.8980 | tpr=0.8565 | fpr=0.0116 | 3995.7 samples/s | 15.6 steps/s
Avg test loss: 0.22790, Avg test acc: 0.89486, Avg tpr: 0.85254, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.53352 | acc=0.8886 | tpr=0.9735 | fpr=0.1129 | 3906.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.53897 | acc=0.8911 | tpr=0.9744 | fpr=0.1105 | 7607.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.54551 | acc=0.8916 | tpr=0.9784 | fpr=0.1100 | 7632.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.54470 | acc=0.8915 | tpr=0.9770 | fpr=0.1101 | 7554.6 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.54181 | acc=0.8915 | tpr=0.9773 | fpr=0.1101 | 7789.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.54550 | acc=0.8914 | tpr=0.9753 | fpr=0.1101 | 7704.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.54670 | acc=0.8915 | tpr=0.9768 | fpr=0.1101 | 7500.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.54898 | acc=0.8914 | tpr=0.9770 | fpr=0.1102 | 7750.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.55487 | acc=0.8906 | tpr=0.9776 | fpr=0.1109 | 7309.1 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.55577 | acc=0.8902 | tpr=0.9775 | fpr=0.1113 | 4645.1 samples/s | 18.1 steps/s
[Step= 550] | Loss=0.55282 | acc=0.8908 | tpr=0.9781 | fpr=0.1108 | 13780.2 samples/s | 53.8 steps/s
Avg test loss: 0.55258, Avg test acc: 0.89078, Avg tpr: 0.97821, Avg fpr: 0.11081, total FA: 15386

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.08078 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.443 | acc=0.9062 | 3583.3 samples/s | 56.0 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01642 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.440 | acc=0.9844 | 4620.1 samples/s | 72.2 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01124 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.440 | acc=1.0000 | 4714.6 samples/s | 73.7 steps/s
[Step=37750 Epoch=36.9] | Loss=0.01010 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=3.441 | acc=0.9844 | 4820.7 samples/s | 75.3 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00926 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=3.441 | acc=1.0000 | 4855.4 samples/s | 75.9 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00860 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.442 | acc=1.0000 | 4741.6 samples/s | 74.1 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00817 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=3.443 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00791 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.444 | acc=0.9688 | 4831.0 samples/s | 75.5 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00768 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.444 | acc=0.9844 | 4819.4 samples/s | 75.3 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00751 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=3.445 | acc=1.0000 | 4792.5 samples/s | 74.9 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00738 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.446 | acc=1.0000 | 4812.8 samples/s | 75.2 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00712 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.446 | acc=1.0000 | 4768.9 samples/s | 74.5 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00706 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=3.447 | acc=0.9688 | 4788.6 samples/s | 74.8 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00694 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.448 | acc=1.0000 | 4790.7 samples/s | 74.9 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00698 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.449 | acc=1.0000 | 4823.1 samples/s | 75.4 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00695 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=3.449 | acc=0.9844 | 4891.9 samples/s | 76.4 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00695 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=3.450 | acc=1.0000 | 4675.0 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.09869 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.443 | acc=0.9688 | 4119.8 samples/s | 64.4 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00702 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.448 | acc=1.0000 | 3939.8 samples/s | 61.6 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00353 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.449 | acc=1.0000 | 4417.5 samples/s | 69.0 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00236 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.449 | acc=1.0000 | 4501.1 samples/s | 70.3 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00178 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.449 | acc=1.0000 | 4525.0 samples/s | 70.7 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00143 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=3.450 | acc=1.0000 | 4548.3 samples/s | 71.1 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00119 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.450 | acc=1.0000 | 4509.8 samples/s | 70.5 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00103 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=3.450 | acc=1.0000 | 4557.7 samples/s | 71.2 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00090 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=3.450 | acc=1.0000 | 4545.5 samples/s | 71.0 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00080 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.451 | acc=1.0000 | 4563.4 samples/s | 71.3 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00072 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.451 | acc=1.0000 | 4566.8 samples/s | 71.4 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00066 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.451 | acc=1.0000 | 1900.4 samples/s | 29.7 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00060 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.451 | acc=1.0000 | 4704.0 samples/s | 73.5 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00056 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.451 | acc=1.0000 | 4454.8 samples/s | 69.6 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00052 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.452 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.452 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00046 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.452 | acc=1.0000 | 4529.0 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22007 | acc=0.8996 | tpr=0.8593 | fpr=0.0129 | 3927.8 samples/s | 15.3 steps/s
Avg test loss: 0.22322, Avg test acc: 0.89651, Avg tpr: 0.85528, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.54678 | acc=0.8851 | tpr=0.9735 | fpr=0.1165 | 3944.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.54993 | acc=0.8878 | tpr=0.9765 | fpr=0.1139 | 7775.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.55625 | acc=0.8882 | tpr=0.9798 | fpr=0.1135 | 7567.4 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.55552 | acc=0.8880 | tpr=0.9781 | fpr=0.1136 | 7723.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.55245 | acc=0.8881 | tpr=0.9782 | fpr=0.1136 | 7375.1 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.55591 | acc=0.8878 | tpr=0.9775 | fpr=0.1138 | 7817.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.55710 | acc=0.8879 | tpr=0.9787 | fpr=0.1137 | 7572.1 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.55928 | acc=0.8879 | tpr=0.9787 | fpr=0.1137 | 7507.1 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.56541 | acc=0.8870 | tpr=0.9791 | fpr=0.1146 | 5442.3 samples/s | 21.3 steps/s
[Step= 500] | Loss=0.56645 | acc=0.8866 | tpr=0.9784 | fpr=0.1151 | 7584.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.56358 | acc=0.8870 | tpr=0.9789 | fpr=0.1147 | 13460.0 samples/s | 52.6 steps/s
Avg test loss: 0.56336, Avg test acc: 0.88693, Avg tpr: 0.97900, Avg fpr: 0.11474, total FA: 15932

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.13186 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.456 | acc=0.9219 | 3895.4 samples/s | 60.9 steps/s
[Step=38450 Epoch=37.5] | Loss=0.01877 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.452 | acc=1.0000 | 4280.4 samples/s | 66.9 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01236 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.452 | acc=0.9844 | 4757.3 samples/s | 74.3 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01013 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.453 | acc=1.0000 | 4731.6 samples/s | 73.9 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00893 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.454 | acc=1.0000 | 4784.5 samples/s | 74.8 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00852 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.455 | acc=0.9531 | 4792.7 samples/s | 74.9 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00796 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.456 | acc=0.9688 | 4735.6 samples/s | 74.0 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00758 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.457 | acc=1.0000 | 4737.0 samples/s | 74.0 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00735 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.458 | acc=1.0000 | 4798.0 samples/s | 75.0 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00722 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.459 | acc=1.0000 | 4696.1 samples/s | 73.4 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00701 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.460 | acc=1.0000 | 4810.9 samples/s | 75.2 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00698 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.461 | acc=0.9844 | 4762.8 samples/s | 74.4 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00687 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.462 | acc=1.0000 | 4779.8 samples/s | 74.7 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00672 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.462 | acc=1.0000 | 4798.2 samples/s | 75.0 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00660 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.463 | acc=1.0000 | 4808.5 samples/s | 75.1 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00656 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.464 | acc=0.9844 | 4790.8 samples/s | 74.9 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00667 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.465 | acc=0.9844 | 4807.9 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.00213 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.456 | acc=1.0000 | 3702.7 samples/s | 57.9 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00306 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.465 | acc=1.0000 | 3929.8 samples/s | 61.4 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00155 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.466 | acc=1.0000 | 4509.0 samples/s | 70.5 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00104 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.467 | acc=1.0000 | 4486.7 samples/s | 70.1 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00079 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.467 | acc=1.0000 | 4541.6 samples/s | 71.0 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00063 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.467 | acc=1.0000 | 4556.4 samples/s | 71.2 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00053 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.468 | acc=1.0000 | 4484.7 samples/s | 70.1 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00046 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.468 | acc=1.0000 | 4568.7 samples/s | 71.4 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00040 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.468 | acc=1.0000 | 4574.1 samples/s | 71.5 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00036 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.468 | acc=1.0000 | 4526.2 samples/s | 70.7 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00032 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.468 | acc=1.0000 | 4573.3 samples/s | 71.5 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00030 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.469 | acc=1.0000 | 1922.4 samples/s | 30.0 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00027 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.469 | acc=1.0000 | 4596.2 samples/s | 71.8 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00025 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=3.469 | acc=1.0000 | 4552.6 samples/s | 71.1 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00023 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=3.469 | acc=1.0000 | 4484.4 samples/s | 70.1 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00022 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.469 | acc=1.0000 | 4554.8 samples/s | 71.2 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00021 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=3.469 | acc=1.0000 | 4538.2 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24238 | acc=0.8927 | tpr=0.8488 | fpr=0.0119 | 3890.8 samples/s | 15.2 steps/s
Avg test loss: 0.24557, Avg test acc: 0.88981, Avg tpr: 0.84531, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.54319 | acc=0.8912 | tpr=0.9735 | fpr=0.1102 | 3956.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.54746 | acc=0.8931 | tpr=0.9744 | fpr=0.1084 | 7661.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.55385 | acc=0.8936 | tpr=0.9784 | fpr=0.1080 | 7345.7 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.55295 | acc=0.8933 | tpr=0.9770 | fpr=0.1082 | 7703.4 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.54972 | acc=0.8933 | tpr=0.9773 | fpr=0.1083 | 7633.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.55342 | acc=0.8929 | tpr=0.9775 | fpr=0.1087 | 7692.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.55467 | acc=0.8930 | tpr=0.9787 | fpr=0.1086 | 4737.0 samples/s | 18.5 steps/s
[Step= 400] | Loss=0.55692 | acc=0.8928 | tpr=0.9787 | fpr=0.1087 | 7554.9 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.56319 | acc=0.8920 | tpr=0.9786 | fpr=0.1095 | 7418.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.56424 | acc=0.8916 | tpr=0.9775 | fpr=0.1099 | 7601.8 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.56130 | acc=0.8921 | tpr=0.9781 | fpr=0.1095 | 13509.2 samples/s | 52.8 steps/s
Avg test loss: 0.56109, Avg test acc: 0.89202, Avg tpr: 0.97821, Avg fpr: 0.10955, total FA: 15211

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.05249 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.474 | acc=0.9531 | 3669.1 samples/s | 57.3 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01940 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=3.467 | acc=0.9844 | 4587.5 samples/s | 71.7 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01274 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=3.466 | acc=1.0000 | 4730.8 samples/s | 73.9 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01045 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=3.466 | acc=1.0000 | 4770.8 samples/s | 74.5 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00947 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=3.467 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00867 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.468 | acc=1.0000 | 4751.4 samples/s | 74.2 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00808 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.468 | acc=1.0000 | 4801.3 samples/s | 75.0 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00769 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=3.469 | acc=1.0000 | 4809.5 samples/s | 75.1 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00750 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.470 | acc=1.0000 | 4791.3 samples/s | 74.9 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00728 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=3.471 | acc=0.9844 | 4749.7 samples/s | 74.2 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00708 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.471 | acc=1.0000 | 4723.0 samples/s | 73.8 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00696 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=3.472 | acc=0.9844 | 4773.0 samples/s | 74.6 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00680 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.473 | acc=1.0000 | 4769.0 samples/s | 74.5 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00673 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.474 | acc=1.0000 | 4801.1 samples/s | 75.0 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00671 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=3.475 | acc=1.0000 | 4787.8 samples/s | 74.8 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00668 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.476 | acc=1.0000 | 4783.6 samples/s | 74.7 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00668 | Reg=0.00202 | L2-Norm=14.220 | L2-Norm(final)=3.476 | acc=1.0000 | 4802.7 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.00495 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.474 | acc=1.0000 | 3734.2 samples/s | 58.3 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00377 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.479 | acc=1.0000 | 4161.0 samples/s | 65.0 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00191 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.480 | acc=1.0000 | 4429.4 samples/s | 69.2 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00130 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.481 | acc=1.0000 | 4501.1 samples/s | 70.3 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00098 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.482 | acc=1.0000 | 4541.0 samples/s | 71.0 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00078 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=3.483 | acc=1.0000 | 4576.1 samples/s | 71.5 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00065 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=3.483 | acc=1.0000 | 4499.7 samples/s | 70.3 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00057 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.483 | acc=1.0000 | 4527.5 samples/s | 70.7 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00050 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=3.483 | acc=1.0000 | 4554.7 samples/s | 71.2 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00044 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=3.484 | acc=1.0000 | 4568.6 samples/s | 71.4 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00040 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=3.484 | acc=1.0000 | 4542.5 samples/s | 71.0 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00036 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.484 | acc=1.0000 | 1924.5 samples/s | 30.1 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00033 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=3.484 | acc=1.0000 | 4522.4 samples/s | 70.7 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00031 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=3.485 | acc=1.0000 | 4488.5 samples/s | 70.1 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00029 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=3.485 | acc=1.0000 | 4590.6 samples/s | 71.7 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00027 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=3.485 | acc=1.0000 | 4511.9 samples/s | 70.5 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00025 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=3.485 | acc=1.0000 | 4545.9 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21944 | acc=0.8998 | tpr=0.8595 | fpr=0.0126 | 3898.8 samples/s | 15.2 steps/s
Avg test loss: 0.22308, Avg test acc: 0.89747, Avg tpr: 0.85679, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.55371 | acc=0.8870 | tpr=0.9735 | fpr=0.1146 | 3866.0 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.55874 | acc=0.8891 | tpr=0.9765 | fpr=0.1125 | 6618.5 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.56556 | acc=0.8895 | tpr=0.9798 | fpr=0.1121 | 7489.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.56411 | acc=0.8896 | tpr=0.9781 | fpr=0.1120 | 7745.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.56138 | acc=0.8895 | tpr=0.9782 | fpr=0.1121 | 5360.4 samples/s | 20.9 steps/s
[Step= 300] | Loss=0.56466 | acc=0.8892 | tpr=0.9782 | fpr=0.1125 | 7573.3 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.56565 | acc=0.8893 | tpr=0.9793 | fpr=0.1123 | 7553.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.56826 | acc=0.8891 | tpr=0.9792 | fpr=0.1126 | 7727.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.57462 | acc=0.8882 | tpr=0.9791 | fpr=0.1134 | 7534.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.57569 | acc=0.8877 | tpr=0.9784 | fpr=0.1139 | 7348.0 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.57284 | acc=0.8880 | tpr=0.9789 | fpr=0.1136 | 14165.0 samples/s | 55.3 steps/s
Avg test loss: 0.57265, Avg test acc: 0.88800, Avg tpr: 0.97900, Avg fpr: 0.11366, total FA: 15781
