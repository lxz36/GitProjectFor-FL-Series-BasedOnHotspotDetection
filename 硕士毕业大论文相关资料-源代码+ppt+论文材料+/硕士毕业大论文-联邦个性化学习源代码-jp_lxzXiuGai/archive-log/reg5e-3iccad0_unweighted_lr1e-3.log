Total num clients: 4
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_1', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
Using device: cuda

server round 0/20

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
[Step=  50 Epoch= 0.1] | Loss=0.34636 | L2_reg=0.19971 | acc=0.5125 | 1194.9 samples/s | 18.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34649 | L2_reg=0.10309 | acc=0.5075 | 2669.8 samples/s | 41.7 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.34647 | L2_reg=0.06882 | acc=0.5106 | 2631.8 samples/s | 41.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.34630 | L2_reg=0.05165 | acc=0.5171 | 2714.7 samples/s | 42.4 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.34610 | L2_reg=0.04133 | acc=0.5211 | 2760.9 samples/s | 43.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.34611 | L2_reg=0.03445 | acc=0.5215 | 2610.2 samples/s | 40.8 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.34613 | L2_reg=0.02953 | acc=0.5214 | 2670.3 samples/s | 41.7 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.34609 | L2_reg=0.02584 | acc=0.5224 | 2654.4 samples/s | 41.5 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.34611 | L2_reg=0.02297 | acc=0.5221 | 2581.0 samples/s | 40.3 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.34618 | L2_reg=0.02068 | acc=0.5202 | 3674.7 samples/s | 57.4 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.34617 | L2_reg=0.01880 | acc=0.5207 | 1335.9 samples/s | 20.9 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.34614 | L2_reg=0.01723 | acc=0.5212 | 2736.8 samples/s | 42.8 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.34619 | L2_reg=0.01591 | acc=0.5202 | 2598.9 samples/s | 40.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.34617 | L2_reg=0.01477 | acc=0.5208 | 2742.0 samples/s | 42.8 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.34619 | L2_reg=0.01379 | acc=0.5204 | 2609.9 samples/s | 40.8 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.34616 | L2_reg=0.01293 | acc=0.5210 | 2659.8 samples/s | 41.6 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.34617 | L2_reg=0.01217 | acc=0.5209 | 2684.1 samples/s | 41.9 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.34618 | L2_reg=0.01149 | acc=0.5206 | 2543.5 samples/s | 39.7 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.34620 | L2_reg=0.01089 | acc=0.5201 | 2691.1 samples/s | 42.0 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.34618 | L2_reg=0.01034 | acc=0.5207 | 2865.2 samples/s | 44.8 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=  50 Epoch= 0.2] | Loss=0.19672 | L2_reg=0.60798 | acc=0.8131 | 1277.3 samples/s | 20.0 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.12612 | L2_reg=0.62960 | acc=0.8905 | 2667.0 samples/s | 41.7 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.09736 | L2_reg=0.64251 | acc=0.9186 | 2648.1 samples/s | 41.4 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.08233 | L2_reg=0.65283 | acc=0.9330 | 2566.3 samples/s | 40.1 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.07253 | L2_reg=0.66298 | acc=0.9424 | 3866.0 samples/s | 60.4 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.06333 | L2_reg=0.67374 | acc=0.9502 | 1306.2 samples/s | 20.4 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.05560 | L2_reg=0.68314 | acc=0.9564 | 2561.7 samples/s | 40.0 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.05023 | L2_reg=0.69163 | acc=0.9609 | 2657.4 samples/s | 41.5 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.04604 | L2_reg=0.69943 | acc=0.9643 | 2696.1 samples/s | 42.1 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.04243 | L2_reg=0.70660 | acc=0.9673 | 2940.7 samples/s | 45.9 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.04001 | L2_reg=0.71361 | acc=0.9691 | 1425.5 samples/s | 22.3 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.03755 | L2_reg=0.72080 | acc=0.9711 | 2556.9 samples/s | 40.0 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.03546 | L2_reg=0.72778 | acc=0.9727 | 2694.2 samples/s | 42.1 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.03328 | L2_reg=0.73449 | acc=0.9744 | 2552.2 samples/s | 39.9 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.03189 | L2_reg=0.74092 | acc=0.9757 | 2710.8 samples/s | 42.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03039 | L2_reg=0.74676 | acc=0.9770 | 1493.3 samples/s | 23.3 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02883 | L2_reg=0.75250 | acc=0.9781 | 2782.6 samples/s | 43.5 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.02745 | L2_reg=0.75776 | acc=0.9792 | 2498.8 samples/s | 39.0 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02621 | L2_reg=0.76262 | acc=0.9802 | 2640.3 samples/s | 41.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02511 | L2_reg=0.76725 | acc=0.9811 | 2713.8 samples/s | 42.4 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38360 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4259.9 samples/s | 16.6 steps/s
Avg test loss: 0.38404, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.27373 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4260.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.27384 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8184.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.27381 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 7542.3 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.27377 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8383.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.27377 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 7823.4 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.27378 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8321.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.27377 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8248.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.27377 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8264.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.27377 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8127.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.27375 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8235.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.27377 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 14714.3 samples/s | 57.5 steps/s
Avg test loss: 0.27377, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 1/20

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
[Step=  50 Epoch= 0.1] | Loss=0.34666 | L2_reg=0.01750 | acc=0.5206 | 1323.6 samples/s | 20.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34633 | L2_reg=0.00890 | acc=0.5228 | 2655.3 samples/s | 41.5 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.34645 | L2_reg=0.00597 | acc=0.5179 | 2745.3 samples/s | 42.9 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.34642 | L2_reg=0.00449 | acc=0.5177 | 2643.2 samples/s | 41.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.34641 | L2_reg=0.00360 | acc=0.5171 | 2620.1 samples/s | 40.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.34624 | L2_reg=0.00300 | acc=0.5206 | 2715.2 samples/s | 42.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.34604 | L2_reg=0.00258 | acc=0.5240 | 2672.9 samples/s | 41.8 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.34592 | L2_reg=0.00227 | acc=0.5259 | 2585.8 samples/s | 40.4 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.34597 | L2_reg=0.00202 | acc=0.5252 | 2688.9 samples/s | 42.0 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.34603 | L2_reg=0.00182 | acc=0.5240 | 3725.2 samples/s | 58.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.34602 | L2_reg=0.00165 | acc=0.5243 | 1304.4 samples/s | 20.4 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.34598 | L2_reg=0.00151 | acc=0.5250 | 2628.1 samples/s | 41.1 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.34598 | L2_reg=0.00140 | acc=0.5251 | 2638.6 samples/s | 41.2 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.34601 | L2_reg=0.00130 | acc=0.5245 | 2668.8 samples/s | 41.7 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.34599 | L2_reg=0.00121 | acc=0.5249 | 2767.1 samples/s | 43.2 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.34601 | L2_reg=0.00114 | acc=0.5245 | 2539.7 samples/s | 39.7 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.34599 | L2_reg=0.00107 | acc=0.5248 | 2668.9 samples/s | 41.7 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.34601 | L2_reg=0.00101 | acc=0.5244 | 2640.8 samples/s | 41.3 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.34601 | L2_reg=0.00096 | acc=0.5244 | 2677.0 samples/s | 41.8 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.34599 | L2_reg=0.00091 | acc=0.5248 | 2979.4 samples/s | 46.6 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=  50 Epoch= 0.2] | Loss=0.11882 | L2_reg=0.13749 | acc=0.8941 | 2058.6 samples/s | 32.2 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.06813 | L2_reg=0.15678 | acc=0.9420 | 4789.7 samples/s | 74.8 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.04997 | L2_reg=0.16537 | acc=0.9581 | 4831.8 samples/s | 75.5 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.04117 | L2_reg=0.17282 | acc=0.9661 | 4798.4 samples/s | 75.0 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.03512 | L2_reg=0.17963 | acc=0.9714 | 6224.1 samples/s | 97.3 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.03021 | L2_reg=0.18594 | acc=0.9756 | 1865.9 samples/s | 29.2 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.02690 | L2_reg=0.19149 | acc=0.9784 | 4758.2 samples/s | 74.3 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.02462 | L2_reg=0.19651 | acc=0.9803 | 4862.1 samples/s | 76.0 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.02268 | L2_reg=0.20147 | acc=0.9820 | 4733.3 samples/s | 74.0 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02069 | L2_reg=0.20638 | acc=0.9836 | 5496.5 samples/s | 85.9 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.01947 | L2_reg=0.21112 | acc=0.9847 | 1918.6 samples/s | 30.0 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.01795 | L2_reg=0.21637 | acc=0.9859 | 4630.1 samples/s | 72.3 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.01677 | L2_reg=0.22154 | acc=0.9868 | 4690.3 samples/s | 73.3 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01618 | L2_reg=0.22630 | acc=0.9874 | 4769.6 samples/s | 74.5 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01527 | L2_reg=0.23077 | acc=0.9881 | 4938.1 samples/s | 77.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01444 | L2_reg=0.23505 | acc=0.9888 | 2060.9 samples/s | 32.2 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01365 | L2_reg=0.23939 | acc=0.9894 | 4818.5 samples/s | 75.3 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.01292 | L2_reg=0.24364 | acc=0.9900 | 4819.7 samples/s | 75.3 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.01224 | L2_reg=0.24770 | acc=0.9906 | 4716.1 samples/s | 73.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01223 | L2_reg=0.25136 | acc=0.9907 | 4766.6 samples/s | 74.5 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37339 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4325.3 samples/s | 16.9 steps/s
Avg test loss: 0.37371, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.29043 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4288.4 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.29051 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8101.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.29050 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8319.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.29047 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8048.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.29048 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8929.9 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.29048 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8327.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.29047 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8243.3 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.29048 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8480.2 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.29048 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8462.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.29047 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8679.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.29048 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 14737.9 samples/s | 57.6 steps/s
Avg test loss: 0.29048, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 2/20

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
[Step=1050 Epoch= 2.0] | Loss=0.34634 | L2_reg=0.00816 | acc=0.5219 | 1387.8 samples/s | 21.7 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.34642 | L2_reg=0.00414 | acc=0.5189 | 2700.3 samples/s | 42.2 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.34619 | L2_reg=0.00277 | acc=0.5228 | 2804.4 samples/s | 43.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.34615 | L2_reg=0.00208 | acc=0.5230 | 2753.9 samples/s | 43.0 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.34621 | L2_reg=0.00167 | acc=0.5211 | 3008.3 samples/s | 47.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.34623 | L2_reg=0.00139 | acc=0.5203 | 2566.8 samples/s | 40.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.34627 | L2_reg=0.00119 | acc=0.5192 | 2821.4 samples/s | 44.1 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.34624 | L2_reg=0.00104 | acc=0.5196 | 2816.0 samples/s | 44.0 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.34623 | L2_reg=0.00093 | acc=0.5200 | 2815.2 samples/s | 44.0 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.34625 | L2_reg=0.00084 | acc=0.5194 | 3643.0 samples/s | 56.9 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.34623 | L2_reg=0.00076 | acc=0.5199 | 1380.6 samples/s | 21.6 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.34622 | L2_reg=0.00070 | acc=0.5200 | 2720.8 samples/s | 42.5 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.34619 | L2_reg=0.00064 | acc=0.5207 | 2696.2 samples/s | 42.1 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.34619 | L2_reg=0.00060 | acc=0.5206 | 2747.5 samples/s | 42.9 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.34621 | L2_reg=0.00056 | acc=0.5203 | 2943.8 samples/s | 46.0 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.34622 | L2_reg=0.00052 | acc=0.5199 | 2648.6 samples/s | 41.4 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.34622 | L2_reg=0.00049 | acc=0.5197 | 2761.8 samples/s | 43.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.34622 | L2_reg=0.00047 | acc=0.5197 | 2750.7 samples/s | 43.0 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.34619 | L2_reg=0.00044 | acc=0.5204 | 2769.4 samples/s | 43.3 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.34618 | L2_reg=0.00042 | acc=0.5207 | 3009.6 samples/s | 47.0 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=1050 Epoch= 4.0] | Loss=0.26844 | L2_reg=0.12497 | acc=0.7788 | 1383.5 samples/s | 21.6 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.17464 | L2_reg=0.18437 | acc=0.8575 | 2709.4 samples/s | 42.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.12592 | L2_reg=0.22164 | acc=0.8996 | 2796.7 samples/s | 43.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.09932 | L2_reg=0.24118 | acc=0.9216 | 2751.6 samples/s | 43.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.08268 | L2_reg=0.25558 | acc=0.9351 | 3913.8 samples/s | 61.2 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.07053 | L2_reg=0.26726 | acc=0.9449 | 1345.5 samples/s | 21.0 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.06211 | L2_reg=0.27675 | acc=0.9516 | 2832.1 samples/s | 44.3 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.05584 | L2_reg=0.28431 | acc=0.9566 | 2911.2 samples/s | 45.5 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.05051 | L2_reg=0.29091 | acc=0.9608 | 2647.5 samples/s | 41.4 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.04647 | L2_reg=0.29654 | acc=0.9640 | 3163.8 samples/s | 49.4 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.04299 | L2_reg=0.30156 | acc=0.9667 | 1488.0 samples/s | 23.3 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.04007 | L2_reg=0.30624 | acc=0.9691 | 2735.4 samples/s | 42.7 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.03740 | L2_reg=0.31050 | acc=0.9711 | 2810.3 samples/s | 43.9 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.03536 | L2_reg=0.31429 | acc=0.9728 | 2769.7 samples/s | 43.3 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.03340 | L2_reg=0.31752 | acc=0.9744 | 2676.3 samples/s | 41.8 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.03179 | L2_reg=0.32043 | acc=0.9756 | 1602.5 samples/s | 25.0 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.03024 | L2_reg=0.32315 | acc=0.9769 | 2771.0 samples/s | 43.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.02868 | L2_reg=0.32583 | acc=0.9781 | 2767.4 samples/s | 43.2 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.02746 | L2_reg=0.32848 | acc=0.9791 | 2821.6 samples/s | 44.1 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.02628 | L2_reg=0.33092 | acc=0.9800 | 2664.7 samples/s | 41.6 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35969 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4430.7 samples/s | 17.3 steps/s
Avg test loss: 0.35985, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.31650 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4425.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.31654 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8519.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.31655 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8730.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.31654 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8514.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.31654 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8632.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.31655 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8719.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.31654 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8346.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.31654 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8551.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.31655 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8697.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.31654 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8300.9 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.31655 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 15901.4 samples/s | 62.1 steps/s
Avg test loss: 0.31655, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 3/20

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
[Step=2050 Epoch= 4.0] | Loss=0.34648 | L2_reg=0.00416 | acc=0.5150 | 1358.3 samples/s | 21.2 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.34637 | L2_reg=0.00210 | acc=0.5166 | 2686.4 samples/s | 42.0 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.34642 | L2_reg=0.00141 | acc=0.5149 | 2874.6 samples/s | 44.9 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.34626 | L2_reg=0.00106 | acc=0.5188 | 2640.2 samples/s | 41.3 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.34622 | L2_reg=0.00085 | acc=0.5199 | 2787.3 samples/s | 43.6 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.34624 | L2_reg=0.00071 | acc=0.5195 | 2857.2 samples/s | 44.6 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.34624 | L2_reg=0.00061 | acc=0.5193 | 2755.1 samples/s | 43.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.34620 | L2_reg=0.00053 | acc=0.5204 | 2744.5 samples/s | 42.9 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.34621 | L2_reg=0.00047 | acc=0.5200 | 2793.3 samples/s | 43.6 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.34617 | L2_reg=0.00043 | acc=0.5209 | 3800.1 samples/s | 59.4 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.34613 | L2_reg=0.00039 | acc=0.5217 | 1396.9 samples/s | 21.8 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.34615 | L2_reg=0.00036 | acc=0.5214 | 2704.6 samples/s | 42.3 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.34613 | L2_reg=0.00033 | acc=0.5218 | 2701.4 samples/s | 42.2 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.34618 | L2_reg=0.00031 | acc=0.5208 | 2765.2 samples/s | 43.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.34617 | L2_reg=0.00029 | acc=0.5209 | 2755.2 samples/s | 43.0 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.34616 | L2_reg=0.00027 | acc=0.5213 | 2783.3 samples/s | 43.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.34615 | L2_reg=0.00025 | acc=0.5213 | 2800.4 samples/s | 43.8 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.34615 | L2_reg=0.00024 | acc=0.5214 | 2998.0 samples/s | 46.8 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.34616 | L2_reg=0.00023 | acc=0.5212 | 2665.7 samples/s | 41.7 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.34614 | L2_reg=0.00021 | acc=0.5217 | 2925.4 samples/s | 45.7 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=1050 Epoch= 4.0] | Loss=0.11813 | L2_reg=0.17051 | acc=0.9372 | 2148.5 samples/s | 33.6 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.06780 | L2_reg=0.20157 | acc=0.9631 | 4958.4 samples/s | 77.5 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.04818 | L2_reg=0.21785 | acc=0.9738 | 4965.0 samples/s | 77.6 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.03861 | L2_reg=0.22834 | acc=0.9788 | 4924.1 samples/s | 76.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.03162 | L2_reg=0.23709 | acc=0.9824 | 6493.9 samples/s | 101.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.02705 | L2_reg=0.24435 | acc=0.9848 | 1990.7 samples/s | 31.1 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.02343 | L2_reg=0.25080 | acc=0.9867 | 5087.7 samples/s | 79.5 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.02064 | L2_reg=0.25649 | acc=0.9883 | 4900.0 samples/s | 76.6 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01910 | L2_reg=0.26135 | acc=0.9891 | 4969.8 samples/s | 77.7 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.01784 | L2_reg=0.26501 | acc=0.9898 | 5705.5 samples/s | 89.1 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.01653 | L2_reg=0.26840 | acc=0.9905 | 2063.4 samples/s | 32.2 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.01526 | L2_reg=0.27224 | acc=0.9912 | 4933.3 samples/s | 77.1 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.01412 | L2_reg=0.27614 | acc=0.9919 | 5157.3 samples/s | 80.6 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01313 | L2_reg=0.27984 | acc=0.9925 | 4804.0 samples/s | 75.1 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01233 | L2_reg=0.28339 | acc=0.9930 | 5069.9 samples/s | 79.2 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01169 | L2_reg=0.28669 | acc=0.9933 | 2146.5 samples/s | 33.5 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01108 | L2_reg=0.29004 | acc=0.9936 | 5071.5 samples/s | 79.2 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.01074 | L2_reg=0.29323 | acc=0.9938 | 4924.5 samples/s | 76.9 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.01024 | L2_reg=0.29611 | acc=0.9941 | 4966.7 samples/s | 77.6 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00988 | L2_reg=0.29909 | acc=0.9943 | 4990.2 samples/s | 78.0 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37781 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4408.4 samples/s | 17.2 steps/s
Avg test loss: 0.37818, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.28356 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4478.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.28365 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8159.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.28363 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8753.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.28360 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8472.6 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.28361 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 9099.1 samples/s | 35.5 steps/s
[Step= 300] | Loss=0.28361 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8137.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.28360 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8991.1 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.28361 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8364.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.28361 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8535.8 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.28360 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8306.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.28361 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 15865.4 samples/s | 62.0 steps/s
Avg test loss: 0.28361, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 4/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=3050 Epoch= 5.9] | Loss=0.34610 | L2_reg=0.00450 | acc=0.5297 | 1359.4 samples/s | 21.2 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.34619 | L2_reg=0.00227 | acc=0.5248 | 2733.0 samples/s | 42.7 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.34595 | L2_reg=0.00152 | acc=0.5284 | 2790.3 samples/s | 43.6 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.34597 | L2_reg=0.00115 | acc=0.5273 | 2773.7 samples/s | 43.3 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.34584 | L2_reg=0.00092 | acc=0.5292 | 2780.1 samples/s | 43.4 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.34598 | L2_reg=0.00077 | acc=0.5264 | 2777.5 samples/s | 43.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.34604 | L2_reg=0.00066 | acc=0.5248 | 2756.7 samples/s | 43.1 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.34607 | L2_reg=0.00058 | acc=0.5242 | 2719.8 samples/s | 42.5 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.34612 | L2_reg=0.00052 | acc=0.5228 | 2830.6 samples/s | 44.2 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.34615 | L2_reg=0.00046 | acc=0.5218 | 3796.6 samples/s | 59.3 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.34620 | L2_reg=0.00042 | acc=0.5202 | 1361.0 samples/s | 21.3 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.34622 | L2_reg=0.00039 | acc=0.5197 | 2741.3 samples/s | 42.8 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.34620 | L2_reg=0.00036 | acc=0.5202 | 2840.1 samples/s | 44.4 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.34620 | L2_reg=0.00034 | acc=0.5202 | 2646.7 samples/s | 41.4 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.34617 | L2_reg=0.00031 | acc=0.5209 | 2862.9 samples/s | 44.7 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.34617 | L2_reg=0.00030 | acc=0.5210 | 2691.6 samples/s | 42.1 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.34616 | L2_reg=0.00028 | acc=0.5211 | 2786.0 samples/s | 43.5 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.34615 | L2_reg=0.00026 | acc=0.5215 | 2790.8 samples/s | 43.6 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.34616 | L2_reg=0.00025 | acc=0.5213 | 2728.0 samples/s | 42.6 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.34617 | L2_reg=0.00024 | acc=0.5209 | 3009.0 samples/s | 47.0 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=1050 Epoch= 2.1] | Loss=0.34589 | L2_reg=0.00463 | acc=0.5272 | 1379.2 samples/s | 21.5 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.34624 | L2_reg=0.00237 | acc=0.5195 | 2804.7 samples/s | 43.8 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.34606 | L2_reg=0.00159 | acc=0.5242 | 2804.4 samples/s | 43.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.34596 | L2_reg=0.00120 | acc=0.5259 | 2777.3 samples/s | 43.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.34584 | L2_reg=0.00096 | acc=0.5279 | 2732.5 samples/s | 42.7 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.34596 | L2_reg=0.00080 | acc=0.5257 | 2966.6 samples/s | 46.4 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.34599 | L2_reg=0.00069 | acc=0.5252 | 2625.5 samples/s | 41.0 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.34596 | L2_reg=0.00060 | acc=0.5256 | 2781.3 samples/s | 43.5 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.34603 | L2_reg=0.00054 | acc=0.5242 | 2789.2 samples/s | 43.6 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.34602 | L2_reg=0.00048 | acc=0.5243 | 3945.5 samples/s | 61.6 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.34604 | L2_reg=0.00044 | acc=0.5239 | 1365.4 samples/s | 21.3 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.34604 | L2_reg=0.00040 | acc=0.5240 | 2760.2 samples/s | 43.1 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.34600 | L2_reg=0.00037 | acc=0.5247 | 2716.7 samples/s | 42.4 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.34605 | L2_reg=0.00035 | acc=0.5236 | 2921.0 samples/s | 45.6 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.34605 | L2_reg=0.00032 | acc=0.5236 | 2654.9 samples/s | 41.5 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.34604 | L2_reg=0.00030 | acc=0.5240 | 2733.8 samples/s | 42.7 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.34600 | L2_reg=0.00029 | acc=0.5246 | 2846.9 samples/s | 44.5 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.34598 | L2_reg=0.00027 | acc=0.5251 | 2782.2 samples/s | 43.5 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.34600 | L2_reg=0.00026 | acc=0.5247 | 2767.9 samples/s | 43.2 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.34600 | L2_reg=0.00024 | acc=0.5246 | 3089.3 samples/s | 48.3 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36948 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4226.1 samples/s | 16.5 steps/s
Avg test loss: 0.36976, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.29770 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4433.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.29777 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8828.6 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.29776 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8533.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.29774 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8557.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.29774 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 9006.7 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.29775 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8608.5 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.29774 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8223.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.29774 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8181.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.29774 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8792.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.29773 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8166.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.29774 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 15820.9 samples/s | 61.8 steps/s
Avg test loss: 0.29774, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 5/20

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
[Step=2050 Epoch= 4.0] | Loss=0.34567 | L2_reg=0.00440 | acc=0.5353 | 1396.4 samples/s | 21.8 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.34607 | L2_reg=0.00222 | acc=0.5245 | 2861.4 samples/s | 44.7 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.34605 | L2_reg=0.00148 | acc=0.5247 | 2727.8 samples/s | 42.6 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.34609 | L2_reg=0.00112 | acc=0.5238 | 2643.2 samples/s | 41.3 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.34614 | L2_reg=0.00090 | acc=0.5222 | 2786.0 samples/s | 43.5 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.34609 | L2_reg=0.00075 | acc=0.5234 | 2799.1 samples/s | 43.7 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.34607 | L2_reg=0.00064 | acc=0.5239 | 2751.4 samples/s | 43.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.34606 | L2_reg=0.00056 | acc=0.5239 | 2841.0 samples/s | 44.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.34598 | L2_reg=0.00050 | acc=0.5255 | 2859.0 samples/s | 44.7 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.34601 | L2_reg=0.00045 | acc=0.5248 | 3744.7 samples/s | 58.5 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.34603 | L2_reg=0.00041 | acc=0.5244 | 1392.2 samples/s | 21.8 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.34604 | L2_reg=0.00038 | acc=0.5242 | 2740.3 samples/s | 42.8 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.34603 | L2_reg=0.00035 | acc=0.5243 | 2766.1 samples/s | 43.2 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.34604 | L2_reg=0.00032 | acc=0.5241 | 2866.9 samples/s | 44.8 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.34604 | L2_reg=0.00030 | acc=0.5241 | 2704.7 samples/s | 42.3 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.34604 | L2_reg=0.00028 | acc=0.5241 | 2849.4 samples/s | 44.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.34602 | L2_reg=0.00027 | acc=0.5245 | 2681.8 samples/s | 41.9 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.34601 | L2_reg=0.00025 | acc=0.5247 | 2781.7 samples/s | 43.5 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.34598 | L2_reg=0.00024 | acc=0.5251 | 2785.0 samples/s | 43.5 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.34601 | L2_reg=0.00023 | acc=0.5246 | 3115.9 samples/s | 48.7 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=2050 Epoch= 7.9] | Loss=0.20922 | L2_reg=0.08356 | acc=0.8203 | 1381.0 samples/s | 21.6 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.11914 | L2_reg=0.13390 | acc=0.9008 | 2767.1 samples/s | 43.2 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.08483 | L2_reg=0.15634 | acc=0.9301 | 2745.7 samples/s | 42.9 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.06725 | L2_reg=0.16912 | acc=0.9455 | 2743.0 samples/s | 42.9 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.05619 | L2_reg=0.17827 | acc=0.9549 | 4001.9 samples/s | 62.5 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.04849 | L2_reg=0.18575 | acc=0.9612 | 1334.6 samples/s | 20.9 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.04313 | L2_reg=0.19283 | acc=0.9655 | 2712.2 samples/s | 42.4 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03907 | L2_reg=0.19861 | acc=0.9689 | 2831.6 samples/s | 44.2 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03566 | L2_reg=0.20297 | acc=0.9718 | 2681.4 samples/s | 41.9 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.03305 | L2_reg=0.20721 | acc=0.9740 | 3206.9 samples/s | 50.1 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.03095 | L2_reg=0.21077 | acc=0.9757 | 1487.1 samples/s | 23.2 steps/s
[Step=2600 Epoch=10.0] | Loss=0.02895 | L2_reg=0.21397 | acc=0.9773 | 2763.5 samples/s | 43.2 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02719 | L2_reg=0.21719 | acc=0.9787 | 2789.7 samples/s | 43.6 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02538 | L2_reg=0.22010 | acc=0.9802 | 2701.0 samples/s | 42.2 steps/s
[Step=2750 Epoch=10.5] | Loss=0.02391 | L2_reg=0.22306 | acc=0.9813 | 2717.8 samples/s | 42.5 steps/s
[Step=2800 Epoch=10.7] | Loss=0.02338 | L2_reg=0.22536 | acc=0.9819 | 1607.4 samples/s | 25.1 steps/s
[Step=2850 Epoch=10.9] | Loss=0.02241 | L2_reg=0.22752 | acc=0.9827 | 2748.2 samples/s | 42.9 steps/s
[Step=2900 Epoch=11.1] | Loss=0.02142 | L2_reg=0.22972 | acc=0.9835 | 2792.4 samples/s | 43.6 steps/s
[Step=2950 Epoch=11.3] | Loss=0.02052 | L2_reg=0.23171 | acc=0.9842 | 2778.4 samples/s | 43.4 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01987 | L2_reg=0.23359 | acc=0.9847 | 2713.3 samples/s | 42.4 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37312 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4408.8 samples/s | 17.2 steps/s
Avg test loss: 0.37344, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.29118 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4508.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.29126 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8226.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.29124 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8861.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.29121 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8277.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.29122 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8341.7 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.29122 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8523.0 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.29121 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8516.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.29122 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8718.6 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.29121 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8433.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.29121 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8575.8 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.29122 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 15197.9 samples/s | 59.4 steps/s
Avg test loss: 0.29121, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 6/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=4050 Epoch= 7.9] | Loss=0.34613 | L2_reg=0.00397 | acc=0.5238 | 1376.7 samples/s | 21.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.34640 | L2_reg=0.00202 | acc=0.5177 | 2761.1 samples/s | 43.1 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.34634 | L2_reg=0.00135 | acc=0.5181 | 2723.9 samples/s | 42.6 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.34620 | L2_reg=0.00101 | acc=0.5212 | 2813.6 samples/s | 44.0 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.34612 | L2_reg=0.00082 | acc=0.5231 | 2726.3 samples/s | 42.6 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.34612 | L2_reg=0.00068 | acc=0.5229 | 2854.9 samples/s | 44.6 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.34616 | L2_reg=0.00059 | acc=0.5218 | 2756.2 samples/s | 43.1 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.34614 | L2_reg=0.00051 | acc=0.5220 | 2780.8 samples/s | 43.4 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.34614 | L2_reg=0.00046 | acc=0.5220 | 2824.5 samples/s | 44.1 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.34618 | L2_reg=0.00041 | acc=0.5211 | 3749.8 samples/s | 58.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.34624 | L2_reg=0.00038 | acc=0.5186 | 1316.8 samples/s | 20.6 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.34625 | L2_reg=0.00035 | acc=0.5190 | 2784.9 samples/s | 43.5 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.34625 | L2_reg=0.00032 | acc=0.5192 | 2789.1 samples/s | 43.6 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.34619 | L2_reg=0.00030 | acc=0.5205 | 2778.3 samples/s | 43.4 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.34614 | L2_reg=0.00028 | acc=0.5214 | 2801.8 samples/s | 43.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.34619 | L2_reg=0.00026 | acc=0.5206 | 2798.6 samples/s | 43.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.34620 | L2_reg=0.00025 | acc=0.5204 | 2778.8 samples/s | 43.4 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.34619 | L2_reg=0.00024 | acc=0.5207 | 2850.0 samples/s | 44.5 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.34618 | L2_reg=0.00022 | acc=0.5208 | 2749.4 samples/s | 43.0 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.34620 | L2_reg=0.00021 | acc=0.5205 | 2952.1 samples/s | 46.1 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=3050 Epoch= 6.0] | Loss=0.34609 | L2_reg=0.00395 | acc=0.5250 | 1396.0 samples/s | 21.8 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.34628 | L2_reg=0.00200 | acc=0.5188 | 2742.0 samples/s | 42.8 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.34628 | L2_reg=0.00134 | acc=0.5185 | 2821.1 samples/s | 44.1 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.34627 | L2_reg=0.00100 | acc=0.5188 | 2830.2 samples/s | 44.2 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.34621 | L2_reg=0.00080 | acc=0.5203 | 2703.6 samples/s | 42.2 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.34613 | L2_reg=0.00068 | acc=0.5221 | 2821.8 samples/s | 44.1 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.34611 | L2_reg=0.00058 | acc=0.5225 | 2811.1 samples/s | 43.9 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.34605 | L2_reg=0.00051 | acc=0.5238 | 2748.8 samples/s | 42.9 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.34597 | L2_reg=0.00045 | acc=0.5251 | 2855.9 samples/s | 44.6 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.34598 | L2_reg=0.00041 | acc=0.5250 | 3748.7 samples/s | 58.6 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.34595 | L2_reg=0.00037 | acc=0.5258 | 1375.8 samples/s | 21.5 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.34597 | L2_reg=0.00034 | acc=0.5255 | 2880.0 samples/s | 45.0 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.34600 | L2_reg=0.00032 | acc=0.5247 | 2729.8 samples/s | 42.7 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.34602 | L2_reg=0.00030 | acc=0.5244 | 2805.3 samples/s | 43.8 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.34601 | L2_reg=0.00028 | acc=0.5245 | 2780.7 samples/s | 43.4 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.34601 | L2_reg=0.00026 | acc=0.5246 | 2952.1 samples/s | 46.1 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.34600 | L2_reg=0.00024 | acc=0.5247 | 2645.1 samples/s | 41.3 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.34601 | L2_reg=0.00023 | acc=0.5244 | 2846.2 samples/s | 44.5 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.34594 | L2_reg=0.00022 | acc=0.5257 | 2732.6 samples/s | 42.7 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.34599 | L2_reg=0.00021 | acc=0.5249 | 3159.6 samples/s | 49.4 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36952 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4460.2 samples/s | 17.4 steps/s
Avg test loss: 0.36980, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.29749 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4444.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.29756 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8590.2 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.29755 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8375.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.29752 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8728.8 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.29753 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8528.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.29753 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8521.4 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.29752 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8824.0 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.29753 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8216.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.29753 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8563.2 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.29752 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 9131.6 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.29753 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 14115.6 samples/s | 55.1 steps/s
Avg test loss: 0.29753, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 7/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=5050 Epoch= 9.8] | Loss=0.34629 | L2_reg=0.00385 | acc=0.5206 | 1353.9 samples/s | 21.2 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.34614 | L2_reg=0.00195 | acc=0.5234 | 2746.8 samples/s | 42.9 steps/s
[Step=5150 Epoch=10.0] | Loss=0.34610 | L2_reg=0.00131 | acc=0.5235 | 2800.1 samples/s | 43.8 steps/s
[Step=5200 Epoch=10.1] | Loss=0.34610 | L2_reg=0.00098 | acc=0.5232 | 2869.8 samples/s | 44.8 steps/s
[Step=5250 Epoch=10.2] | Loss=0.34623 | L2_reg=0.00079 | acc=0.5199 | 2746.6 samples/s | 42.9 steps/s
[Step=5300 Epoch=10.3] | Loss=0.34629 | L2_reg=0.00066 | acc=0.5180 | 3000.5 samples/s | 46.9 steps/s
[Step=5350 Epoch=10.4] | Loss=0.34624 | L2_reg=0.00056 | acc=0.5196 | 2598.2 samples/s | 40.6 steps/s
[Step=5400 Epoch=10.5] | Loss=0.34627 | L2_reg=0.00049 | acc=0.5188 | 2801.5 samples/s | 43.8 steps/s
[Step=5450 Epoch=10.6] | Loss=0.34623 | L2_reg=0.00044 | acc=0.5200 | 2763.8 samples/s | 43.2 steps/s
[Step=5500 Epoch=10.7] | Loss=0.34620 | L2_reg=0.00040 | acc=0.5205 | 3773.8 samples/s | 59.0 steps/s
[Step=5550 Epoch=10.8] | Loss=0.34621 | L2_reg=0.00036 | acc=0.5203 | 1361.8 samples/s | 21.3 steps/s
[Step=5600 Epoch=10.9] | Loss=0.34618 | L2_reg=0.00033 | acc=0.5210 | 2827.4 samples/s | 44.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.34617 | L2_reg=0.00031 | acc=0.5213 | 2756.5 samples/s | 43.1 steps/s
[Step=5700 Epoch=11.1] | Loss=0.34614 | L2_reg=0.00029 | acc=0.5218 | 2757.0 samples/s | 43.1 steps/s
[Step=5750 Epoch=11.2] | Loss=0.34608 | L2_reg=0.00027 | acc=0.5229 | 2866.8 samples/s | 44.8 steps/s
[Step=5800 Epoch=11.3] | Loss=0.34612 | L2_reg=0.00025 | acc=0.5222 | 2873.9 samples/s | 44.9 steps/s
[Step=5850 Epoch=11.4] | Loss=0.34616 | L2_reg=0.00024 | acc=0.5213 | 2771.4 samples/s | 43.3 steps/s
[Step=5900 Epoch=11.5] | Loss=0.34617 | L2_reg=0.00023 | acc=0.5210 | 2689.1 samples/s | 42.0 steps/s
[Step=5950 Epoch=11.6] | Loss=0.34618 | L2_reg=0.00021 | acc=0.5208 | 2788.1 samples/s | 43.6 steps/s
[Step=6000 Epoch=11.7] | Loss=0.34618 | L2_reg=0.00020 | acc=0.5208 | 3096.8 samples/s | 48.4 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=4050 Epoch= 7.9] | Loss=0.34697 | L2_reg=0.00402 | acc=0.5056 | 1373.1 samples/s | 21.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.34649 | L2_reg=0.00205 | acc=0.5167 | 2842.1 samples/s | 44.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.34616 | L2_reg=0.00138 | acc=0.5228 | 2744.1 samples/s | 42.9 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.34608 | L2_reg=0.00104 | acc=0.5241 | 2747.1 samples/s | 42.9 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.34605 | L2_reg=0.00085 | acc=0.5249 | 2781.3 samples/s | 43.5 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.34584 | L2_reg=0.00071 | acc=0.5281 | 2830.8 samples/s | 44.2 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.34593 | L2_reg=0.00061 | acc=0.5267 | 2824.8 samples/s | 44.1 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.34602 | L2_reg=0.00054 | acc=0.5244 | 2735.5 samples/s | 42.7 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.34601 | L2_reg=0.00048 | acc=0.5250 | 2802.9 samples/s | 43.8 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.34604 | L2_reg=0.00043 | acc=0.5241 | 3842.9 samples/s | 60.0 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.34603 | L2_reg=0.00039 | acc=0.5244 | 1396.8 samples/s | 21.8 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.34601 | L2_reg=0.00036 | acc=0.5249 | 2729.4 samples/s | 42.6 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.34600 | L2_reg=0.00034 | acc=0.5251 | 2861.1 samples/s | 44.7 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.34600 | L2_reg=0.00031 | acc=0.5249 | 2791.1 samples/s | 43.6 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.34600 | L2_reg=0.00029 | acc=0.5250 | 2756.7 samples/s | 43.1 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.34597 | L2_reg=0.00027 | acc=0.5255 | 2835.0 samples/s | 44.3 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.34598 | L2_reg=0.00026 | acc=0.5252 | 2851.0 samples/s | 44.5 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.34600 | L2_reg=0.00024 | acc=0.5248 | 2708.6 samples/s | 42.3 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.34602 | L2_reg=0.00023 | acc=0.5244 | 2870.3 samples/s | 44.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.34603 | L2_reg=0.00022 | acc=0.5241 | 3014.5 samples/s | 47.1 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36217 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4447.9 samples/s | 17.4 steps/s
Avg test loss: 0.36237, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.31135 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4550.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.31140 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8564.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.31139 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8523.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.31137 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8360.1 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.31138 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8701.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.31138 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8354.1 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.31137 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8762.5 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.31138 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8494.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.31138 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8516.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.31137 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 8419.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.31138 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 15616.6 samples/s | 61.0 steps/s
Avg test loss: 0.31138, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 8/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=6050 Epoch=11.8] | Loss=0.34629 | L2_reg=0.00382 | acc=0.5231 | 1380.7 samples/s | 21.6 steps/s
[Step=6100 Epoch=11.9] | Loss=0.34627 | L2_reg=0.00194 | acc=0.5214 | 2746.7 samples/s | 42.9 steps/s
[Step=6150 Epoch=12.0] | Loss=0.34622 | L2_reg=0.00129 | acc=0.5218 | 2682.8 samples/s | 41.9 steps/s
[Step=6200 Epoch=12.1] | Loss=0.34625 | L2_reg=0.00097 | acc=0.5205 | 2754.1 samples/s | 43.0 steps/s
[Step=6250 Epoch=12.2] | Loss=0.34617 | L2_reg=0.00078 | acc=0.5223 | 2861.7 samples/s | 44.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.34617 | L2_reg=0.00065 | acc=0.5220 | 2732.2 samples/s | 42.7 steps/s
[Step=6350 Epoch=12.4] | Loss=0.34612 | L2_reg=0.00056 | acc=0.5229 | 2754.9 samples/s | 43.0 steps/s
[Step=6400 Epoch=12.5] | Loss=0.34614 | L2_reg=0.00049 | acc=0.5223 | 2722.7 samples/s | 42.5 steps/s
[Step=6450 Epoch=12.6] | Loss=0.34611 | L2_reg=0.00043 | acc=0.5230 | 2861.3 samples/s | 44.7 steps/s
[Step=6500 Epoch=12.7] | Loss=0.34614 | L2_reg=0.00039 | acc=0.5222 | 3511.2 samples/s | 54.9 steps/s
[Step=6550 Epoch=12.8] | Loss=0.34614 | L2_reg=0.00036 | acc=0.5223 | 1354.6 samples/s | 21.2 steps/s
[Step=6600 Epoch=12.9] | Loss=0.34618 | L2_reg=0.00033 | acc=0.5211 | 2821.8 samples/s | 44.1 steps/s
[Step=6650 Epoch=13.0] | Loss=0.34618 | L2_reg=0.00030 | acc=0.5212 | 2709.5 samples/s | 42.3 steps/s
[Step=6700 Epoch=13.1] | Loss=0.34619 | L2_reg=0.00028 | acc=0.5207 | 2815.2 samples/s | 44.0 steps/s
[Step=6750 Epoch=13.2] | Loss=0.34619 | L2_reg=0.00026 | acc=0.5209 | 2704.4 samples/s | 42.3 steps/s
[Step=6800 Epoch=13.3] | Loss=0.34619 | L2_reg=0.00024 | acc=0.5207 | 2792.5 samples/s | 43.6 steps/s
[Step=6850 Epoch=13.4] | Loss=0.34620 | L2_reg=0.00023 | acc=0.5205 | 2756.7 samples/s | 43.1 steps/s
[Step=6900 Epoch=13.5] | Loss=0.34619 | L2_reg=0.00022 | acc=0.5206 | 2832.2 samples/s | 44.3 steps/s
[Step=6950 Epoch=13.6] | Loss=0.34617 | L2_reg=0.00021 | acc=0.5210 | 2731.0 samples/s | 42.7 steps/s
[Step=7000 Epoch=13.7] | Loss=0.34614 | L2_reg=0.00020 | acc=0.5218 | 2982.0 samples/s | 46.6 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=5050 Epoch= 9.9] | Loss=0.34629 | L2_reg=0.00378 | acc=0.5219 | 1372.3 samples/s | 21.4 steps/s
[Step=5100 Epoch=10.0] | Loss=0.34634 | L2_reg=0.00191 | acc=0.5191 | 2817.8 samples/s | 44.0 steps/s
[Step=5150 Epoch=10.1] | Loss=0.34615 | L2_reg=0.00128 | acc=0.5230 | 2683.6 samples/s | 41.9 steps/s
[Step=5200 Epoch=10.2] | Loss=0.34603 | L2_reg=0.00097 | acc=0.5253 | 2860.9 samples/s | 44.7 steps/s
[Step=5250 Epoch=10.3] | Loss=0.34613 | L2_reg=0.00078 | acc=0.5227 | 2766.6 samples/s | 43.2 steps/s
[Step=5300 Epoch=10.4] | Loss=0.34612 | L2_reg=0.00065 | acc=0.5231 | 2778.4 samples/s | 43.4 steps/s
[Step=5350 Epoch=10.5] | Loss=0.34611 | L2_reg=0.00056 | acc=0.5233 | 2702.2 samples/s | 42.2 steps/s
[Step=5400 Epoch=10.6] | Loss=0.34610 | L2_reg=0.00049 | acc=0.5234 | 2749.6 samples/s | 43.0 steps/s
[Step=5450 Epoch=10.7] | Loss=0.34606 | L2_reg=0.00044 | acc=0.5243 | 2760.7 samples/s | 43.1 steps/s
[Step=5500 Epoch=10.8] | Loss=0.34605 | L2_reg=0.00039 | acc=0.5243 | 3879.0 samples/s | 60.6 steps/s
[Step=5550 Epoch=10.9] | Loss=0.34607 | L2_reg=0.00036 | acc=0.5239 | 1389.1 samples/s | 21.7 steps/s
[Step=5600 Epoch=10.9] | Loss=0.34607 | L2_reg=0.00033 | acc=0.5238 | 2753.0 samples/s | 43.0 steps/s
[Step=5650 Epoch=11.0] | Loss=0.34608 | L2_reg=0.00030 | acc=0.5236 | 2817.1 samples/s | 44.0 steps/s
[Step=5700 Epoch=11.1] | Loss=0.34607 | L2_reg=0.00028 | acc=0.5236 | 2730.0 samples/s | 42.7 steps/s
[Step=5750 Epoch=11.2] | Loss=0.34607 | L2_reg=0.00026 | acc=0.5236 | 2815.7 samples/s | 44.0 steps/s
[Step=5800 Epoch=11.3] | Loss=0.34610 | L2_reg=0.00025 | acc=0.5229 | 2688.4 samples/s | 42.0 steps/s
[Step=5850 Epoch=11.4] | Loss=0.34612 | L2_reg=0.00023 | acc=0.5223 | 2777.1 samples/s | 43.4 steps/s
[Step=5900 Epoch=11.5] | Loss=0.34609 | L2_reg=0.00022 | acc=0.5230 | 2786.2 samples/s | 43.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.34609 | L2_reg=0.00021 | acc=0.5231 | 2779.8 samples/s | 43.4 steps/s
[Step=6000 Epoch=11.7] | Loss=0.34605 | L2_reg=0.00020 | acc=0.5241 | 3128.8 samples/s | 48.9 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36999 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4498.4 samples/s | 17.6 steps/s
Avg test loss: 0.37028, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.29666 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4423.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.29672 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8521.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.29671 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8744.6 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.29669 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8645.5 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.29669 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8370.6 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.29670 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8748.3 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.29669 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8188.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.29669 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8661.2 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.29669 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8434.7 samples/s | 32.9 steps/s
