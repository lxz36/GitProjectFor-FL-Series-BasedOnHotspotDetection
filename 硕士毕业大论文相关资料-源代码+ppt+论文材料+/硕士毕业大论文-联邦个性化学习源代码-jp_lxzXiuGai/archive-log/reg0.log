Total num clients: 4
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_1', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
Using device: cuda

server round 0/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=  50 Epoch= 0.2] | Loss=0.27860 | L2_reg=0.00000 | acc=0.7000 | 1665.4 samples/s | 13.0 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.24105 | L2_reg=0.00000 | acc=0.7608 | 3233.5 samples/s | 25.3 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.22705 | L2_reg=0.00000 | acc=0.7826 | 3239.2 samples/s | 25.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.21422 | L2_reg=0.00000 | acc=0.7981 | 3229.1 samples/s | 25.2 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.20551 | L2_reg=0.00000 | acc=0.8082 | 5159.4 samples/s | 40.3 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.19835 | L2_reg=0.00000 | acc=0.8154 | 1778.9 samples/s | 13.9 steps/s
[Step= 350 Epoch= 1.4] | Loss=0.19301 | L2_reg=0.00000 | acc=0.8215 | 3281.5 samples/s | 25.6 steps/s
[Step= 400 Epoch= 1.6] | Loss=0.18919 | L2_reg=0.00000 | acc=0.8259 | 3184.1 samples/s | 24.9 steps/s
[Step= 450 Epoch= 1.8] | Loss=0.18579 | L2_reg=0.00000 | acc=0.8302 | 3251.6 samples/s | 25.4 steps/s
[Step= 500 Epoch= 2.0] | Loss=0.18237 | L2_reg=0.00000 | acc=0.8344 | 4340.8 samples/s | 33.9 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.17939 | L2_reg=0.00000 | acc=0.8381 | 1889.3 samples/s | 14.8 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.17705 | L2_reg=0.00000 | acc=0.8407 | 3253.2 samples/s | 25.4 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=  50 Epoch= 0.2] | Loss=0.34905 | L2_reg=0.00000 | acc=0.5275 | 1802.9 samples/s | 14.1 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.29247 | L2_reg=0.00000 | acc=0.6542 | 3189.3 samples/s | 24.9 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.26136 | L2_reg=0.00000 | acc=0.7101 | 3177.1 samples/s | 24.8 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.24336 | L2_reg=0.00000 | acc=0.7412 | 3221.0 samples/s | 25.2 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.23097 | L2_reg=0.00000 | acc=0.7605 | 5339.8 samples/s | 41.7 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.22167 | L2_reg=0.00000 | acc=0.7751 | 1780.3 samples/s | 13.9 steps/s
[Step= 350 Epoch= 1.4] | Loss=0.21483 | L2_reg=0.00000 | acc=0.7864 | 3236.7 samples/s | 25.3 steps/s
[Step= 400 Epoch= 1.6] | Loss=0.20942 | L2_reg=0.00000 | acc=0.7947 | 3211.4 samples/s | 25.1 steps/s
[Step= 450 Epoch= 1.8] | Loss=0.20501 | L2_reg=0.00000 | acc=0.8011 | 3206.6 samples/s | 25.1 steps/s
[Step= 500 Epoch= 2.0] | Loss=0.20122 | L2_reg=0.00000 | acc=0.8066 | 4622.2 samples/s | 36.1 steps/s
[Step= 550 Epoch= 2.2] | Loss=0.19792 | L2_reg=0.00000 | acc=0.8109 | 1770.8 samples/s | 13.8 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.19446 | L2_reg=0.00000 | acc=0.8160 | 3099.6 samples/s | 24.2 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33720 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4515.6 samples/s | 17.6 steps/s
Avg test loss: 0.33705, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.37378 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4553.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.37374 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8525.1 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.37376 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8870.4 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.37377 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8508.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.37377 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8707.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.37377 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9011.4 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.37377 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8453.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.37377 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8755.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.37377 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8535.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.37378 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8913.5 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.37377 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15615.0 samples/s | 61.0 steps/s
Avg test loss: 0.37377, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 1/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=  50 Epoch= 0.4] | Loss=0.16062 | L2_reg=0.00000 | acc=0.8627 | 1738.6 samples/s | 13.6 steps/s
[Step= 100 Epoch= 0.8] | Loss=0.09644 | L2_reg=0.00000 | acc=0.9209 | 3061.1 samples/s | 23.9 steps/s
[Step= 150 Epoch= 1.1] | Loss=0.07130 | L2_reg=0.00000 | acc=0.9430 | 2328.6 samples/s | 18.2 steps/s
[Step= 200 Epoch= 1.5] | Loss=0.05824 | L2_reg=0.00000 | acc=0.9543 | 2828.9 samples/s | 22.1 steps/s
[Step= 250 Epoch= 1.9] | Loss=0.04977 | L2_reg=0.00000 | acc=0.9618 | 4462.6 samples/s | 34.9 steps/s
[Step= 300 Epoch= 2.3] | Loss=0.04463 | L2_reg=0.00000 | acc=0.9663 | 1798.7 samples/s | 14.1 steps/s
[Step= 350 Epoch= 2.7] | Loss=0.04034 | L2_reg=0.00000 | acc=0.9700 | 3122.4 samples/s | 24.4 steps/s
[Step= 400 Epoch= 3.1] | Loss=0.03715 | L2_reg=0.00000 | acc=0.9728 | 2697.7 samples/s | 21.1 steps/s
[Step= 450 Epoch= 3.4] | Loss=0.03503 | L2_reg=0.00000 | acc=0.9747 | 2445.0 samples/s | 19.1 steps/s
[Step= 500 Epoch= 3.8] | Loss=0.03517 | L2_reg=0.00000 | acc=0.9750 | 3464.2 samples/s | 27.1 steps/s
[Step= 550 Epoch= 4.2] | Loss=0.03319 | L2_reg=0.00000 | acc=0.9767 | 2068.6 samples/s | 16.2 steps/s
[Step= 600 Epoch= 4.6] | Loss=0.03139 | L2_reg=0.00000 | acc=0.9781 | 3087.7 samples/s | 24.1 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=  50 Epoch= 0.4] | Loss=0.15029 | L2_reg=0.00000 | acc=0.8570 | 3124.3 samples/s | 24.4 steps/s
[Step= 100 Epoch= 0.8] | Loss=0.08800 | L2_reg=0.00000 | acc=0.9195 | 6362.8 samples/s | 49.7 steps/s
[Step= 150 Epoch= 1.2] | Loss=0.06335 | L2_reg=0.00000 | acc=0.9432 | 3423.0 samples/s | 26.7 steps/s
[Step= 200 Epoch= 1.5] | Loss=0.05038 | L2_reg=0.00000 | acc=0.9559 | 6239.5 samples/s | 48.7 steps/s
[Step= 250 Epoch= 1.9] | Loss=0.04356 | L2_reg=0.00000 | acc=0.9629 | 8371.4 samples/s | 65.4 steps/s
[Step= 300 Epoch= 2.3] | Loss=0.03886 | L2_reg=0.00000 | acc=0.9677 | 2986.1 samples/s | 23.3 steps/s
[Step= 350 Epoch= 2.7] | Loss=0.03504 | L2_reg=0.00000 | acc=0.9711 | 6235.1 samples/s | 48.7 steps/s
[Step= 400 Epoch= 3.1] | Loss=0.03170 | L2_reg=0.00000 | acc=0.9741 | 3459.4 samples/s | 27.0 steps/s
[Step= 450 Epoch= 3.5] | Loss=0.02908 | L2_reg=0.00000 | acc=0.9763 | 6141.3 samples/s | 48.0 steps/s
[Step= 500 Epoch= 3.8] | Loss=0.02646 | L2_reg=0.00000 | acc=0.9784 | 7217.5 samples/s | 56.4 steps/s
[Step= 550 Epoch= 4.2] | Loss=0.02437 | L2_reg=0.00000 | acc=0.9801 | 3145.0 samples/s | 24.6 steps/s
[Step= 600 Epoch= 4.6] | Loss=0.02285 | L2_reg=0.00000 | acc=0.9815 | 6156.9 samples/s | 48.1 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34667 | acc=0.3153 | tpr=0.0000 | fpr=0.0000 | 4575.3 samples/s | 17.9 steps/s
Avg test loss: 0.34667, Avg test acc: 0.31257, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

Testing server on iccad2012
[Step=  50] | Loss=0.34632 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 4612.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.34632 | acc=0.9817 | tpr=0.0000 | fpr=0.0000 | 8638.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.34632 | acc=0.9819 | tpr=0.0000 | fpr=0.0000 | 8517.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.34632 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8850.2 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.34632 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8368.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.34632 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 9048.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.34632 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8380.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.34632 | acc=0.9821 | tpr=0.0000 | fpr=0.0000 | 8876.0 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.34632 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 8540.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.34632 | acc=0.9823 | tpr=0.0000 | fpr=0.0000 | 9436.7 samples/s | 36.9 steps/s
[Step= 550] | Loss=0.34632 | acc=0.9822 | tpr=0.0000 | fpr=0.0000 | 13886.9 samples/s | 54.2 steps/s
Avg test loss: 0.34632, Avg test acc: 0.98215, Avg tpr: 0.00000, Avg fpr: 0.00000, total FA: 0

server round 2/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step= 650 Epoch= 5.0] | Loss=0.25612 | L2_reg=0.00000 | acc=0.7009 | 1707.3 samples/s | 13.3 steps/s
[Step= 700 Epoch= 5.4] | Loss=0.15303 | L2_reg=0.00000 | acc=0.8348 | 3128.4 samples/s | 24.4 steps/s
[Step= 750 Epoch= 5.7] | Loss=0.11198 | L2_reg=0.00000 | acc=0.8823 | 2166.3 samples/s | 16.9 steps/s
[Step= 800 Epoch= 6.1] | Loss=0.09092 | L2_reg=0.00000 | acc=0.9071 | 3078.5 samples/s | 24.1 steps/s
[Step= 850 Epoch= 6.5] | Loss=0.07717 | L2_reg=0.00000 | acc=0.9229 | 4374.5 samples/s | 34.2 steps/s
[Step= 900 Epoch= 6.9] | Loss=0.06669 | L2_reg=0.00000 | acc=0.9342 | 1812.6 samples/s | 14.2 steps/s
[Step= 950 Epoch= 7.3] | Loss=0.05999 | L2_reg=0.00000 | acc=0.9417 | 3066.8 samples/s | 24.0 steps/s
[Step=1000 Epoch= 7.7] | Loss=0.05408 | L2_reg=0.00000 | acc=0.9480 | 2689.1 samples/s | 21.0 steps/s
[Step=1050 Epoch= 8.0] | Loss=0.05041 | L2_reg=0.00000 | acc=0.9521 | 2435.2 samples/s | 19.0 steps/s
[Step=1100 Epoch= 8.4] | Loss=0.04669 | L2_reg=0.00000 | acc=0.9560 | 3442.6 samples/s | 26.9 steps/s
[Step=1150 Epoch= 8.8] | Loss=0.04330 | L2_reg=0.00000 | acc=0.9595 | 2085.1 samples/s | 16.3 steps/s
[Step=1200 Epoch= 9.2] | Loss=0.04043 | L2_reg=0.00000 | acc=0.9623 | 3043.9 samples/s | 23.8 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step= 650 Epoch= 5.0] | Loss=0.34678 | L2_reg=0.00000 | acc=0.4839 | 3144.3 samples/s | 24.6 steps/s
[Step= 700 Epoch= 5.4] | Loss=0.34672 | L2_reg=0.00000 | acc=0.4961 | 6272.2 samples/s | 49.0 steps/s
[Step= 750 Epoch= 5.8] | Loss=0.30059 | L2_reg=0.00000 | acc=0.5954 | 3525.8 samples/s | 27.5 steps/s
[Step= 800 Epoch= 6.2] | Loss=0.23128 | L2_reg=0.00000 | acc=0.6931 | 5898.9 samples/s | 46.1 steps/s
[Step= 850 Epoch= 6.5] | Loss=0.18832 | L2_reg=0.00000 | acc=0.7525 | 8622.0 samples/s | 67.4 steps/s
[Step= 900 Epoch= 6.9] | Loss=0.15807 | L2_reg=0.00000 | acc=0.7930 | 3014.9 samples/s | 23.6 steps/s
[Step= 950 Epoch= 7.3] | Loss=0.13648 | L2_reg=0.00000 | acc=0.8220 | 6259.3 samples/s | 48.9 steps/s
[Step=1000 Epoch= 7.7] | Loss=0.14140 | L2_reg=0.00000 | acc=0.8365 | 3439.6 samples/s | 26.9 steps/s
[Step=1050 Epoch= 8.1] | Loss=0.13064 | L2_reg=0.00000 | acc=0.8517 | 6331.6 samples/s | 49.5 steps/s
[Step=1100 Epoch= 8.5] | Loss=0.11949 | L2_reg=0.00000 | acc=0.8654 | 7127.6 samples/s | 55.7 steps/s
[Step=1150 Epoch= 8.9] | Loss=0.10944 | L2_reg=0.00000 | acc=0.8773 | 3187.0 samples/s | 24.9 steps/s
[Step=1200 Epoch= 9.2] | Loss=0.10081 | L2_reg=0.00000 | acc=0.8871 | 6125.0 samples/s | 47.9 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34617 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4532.2 samples/s | 17.7 steps/s
Avg test loss: 0.34616, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34763 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4501.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.34763 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8981.5 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.34763 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8615.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.34763 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9294.7 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.34763 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8353.1 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.34763 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8841.6 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.34763 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8525.8 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.34763 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8873.1 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.34763 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8577.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.34763 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8791.0 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.34763 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15587.4 samples/s | 60.9 steps/s
Avg test loss: 0.34763, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 3/20

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
[Step= 650 Epoch= 2.5] | Loss=0.34609 | L2_reg=0.00000 | acc=0.5238 | 1741.2 samples/s | 13.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.34636 | L2_reg=0.00000 | acc=0.5157 | 3238.1 samples/s | 25.3 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.34612 | L2_reg=0.00000 | acc=0.5205 | 3252.0 samples/s | 25.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5219 | 3160.7 samples/s | 24.7 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.34612 | L2_reg=0.00000 | acc=0.5212 | 5132.1 samples/s | 40.1 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.34613 | L2_reg=0.00000 | acc=0.5211 | 1769.0 samples/s | 13.8 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.34621 | L2_reg=0.00000 | acc=0.5188 | 3184.7 samples/s | 24.9 steps/s
[Step=1000 Epoch= 3.9] | Loss=0.34621 | L2_reg=0.00000 | acc=0.5192 | 3194.7 samples/s | 25.0 steps/s
[Step=1050 Epoch= 4.1] | Loss=0.34623 | L2_reg=0.00000 | acc=0.5195 | 3189.3 samples/s | 24.9 steps/s
[Step=1100 Epoch= 4.3] | Loss=0.34619 | L2_reg=0.00000 | acc=0.5206 | 4283.4 samples/s | 33.5 steps/s
[Step=1150 Epoch= 4.5] | Loss=0.34622 | L2_reg=0.00000 | acc=0.5191 | 1877.5 samples/s | 14.7 steps/s
[Step=1200 Epoch= 4.7] | Loss=0.34619 | L2_reg=0.00000 | acc=0.5201 | 3239.2 samples/s | 25.3 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=1250 Epoch= 9.6] | Loss=0.34321 | L2_reg=0.00000 | acc=0.5578 | 3120.4 samples/s | 24.4 steps/s
[Step=1300 Epoch=10.0] | Loss=0.24093 | L2_reg=0.00000 | acc=0.7409 | 6258.7 samples/s | 48.9 steps/s
[Step=1350 Epoch=10.4] | Loss=0.17803 | L2_reg=0.00000 | acc=0.8163 | 3463.2 samples/s | 27.1 steps/s
[Step=1400 Epoch=10.8] | Loss=0.14049 | L2_reg=0.00000 | acc=0.8581 | 6163.5 samples/s | 48.2 steps/s
[Step=1450 Epoch=11.2] | Loss=0.11918 | L2_reg=0.00000 | acc=0.8829 | 8615.5 samples/s | 67.3 steps/s
[Step=1500 Epoch=11.5] | Loss=0.10300 | L2_reg=0.00000 | acc=0.8999 | 3004.4 samples/s | 23.5 steps/s
[Step=1550 Epoch=11.9] | Loss=0.09107 | L2_reg=0.00000 | acc=0.9125 | 6212.0 samples/s | 48.5 steps/s
[Step=1600 Epoch=12.3] | Loss=0.08184 | L2_reg=0.00000 | acc=0.9222 | 3452.7 samples/s | 27.0 steps/s
[Step=1650 Epoch=12.7] | Loss=0.07424 | L2_reg=0.00000 | acc=0.9302 | 6180.8 samples/s | 48.3 steps/s
[Step=1700 Epoch=13.1] | Loss=0.06773 | L2_reg=0.00000 | acc=0.9367 | 7334.7 samples/s | 57.3 steps/s
[Step=1750 Epoch=13.5] | Loss=0.06257 | L2_reg=0.00000 | acc=0.9419 | 3229.3 samples/s | 25.2 steps/s
[Step=1800 Epoch=13.9] | Loss=0.05840 | L2_reg=0.00000 | acc=0.9463 | 6238.5 samples/s | 48.7 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34630 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4518.6 samples/s | 17.7 steps/s
Avg test loss: 0.34630, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34729 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4567.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.34729 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 9025.1 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.34729 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8280.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.34729 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8798.3 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.34729 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8968.2 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.34729 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8561.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.34729 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8709.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.34729 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9411.8 samples/s | 36.8 steps/s
[Step= 450] | Loss=0.34729 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8064.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.34729 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 9035.5 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.34729 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 14405.4 samples/s | 56.3 steps/s
Avg test loss: 0.34729, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 4/20

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
[Step= 650 Epoch= 2.5] | Loss=0.34567 | L2_reg=0.00000 | acc=0.5337 | 1765.5 samples/s | 13.8 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.34603 | L2_reg=0.00000 | acc=0.5279 | 3257.5 samples/s | 25.4 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.34614 | L2_reg=0.00000 | acc=0.5244 | 3147.8 samples/s | 24.6 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.34606 | L2_reg=0.00000 | acc=0.5266 | 3147.9 samples/s | 24.6 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.34613 | L2_reg=0.00000 | acc=0.5245 | 5333.9 samples/s | 41.7 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.34605 | L2_reg=0.00000 | acc=0.5258 | 1755.2 samples/s | 13.7 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.34600 | L2_reg=0.00000 | acc=0.5265 | 3173.6 samples/s | 24.8 steps/s
[Step=1000 Epoch= 3.9] | Loss=0.34605 | L2_reg=0.00000 | acc=0.5250 | 3317.2 samples/s | 25.9 steps/s
[Step=1050 Epoch= 4.1] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5244 | 3157.8 samples/s | 24.7 steps/s
[Step=1100 Epoch= 4.3] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5246 | 4463.9 samples/s | 34.9 steps/s
[Step=1150 Epoch= 4.5] | Loss=0.34184 | L2_reg=0.00000 | acc=0.5383 | 1858.5 samples/s | 14.5 steps/s
[Step=1200 Epoch= 4.7] | Loss=0.33264 | L2_reg=0.00000 | acc=0.5595 | 3193.7 samples/s | 25.0 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=1250 Epoch= 9.6] | Loss=0.34635 | L2_reg=0.00000 | acc=0.5161 | 1701.8 samples/s | 13.3 steps/s
[Step=1300 Epoch=10.0] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5080 | 3136.3 samples/s | 24.5 steps/s
[Step=1350 Epoch=10.3] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5089 | 2294.8 samples/s | 17.9 steps/s
[Step=1400 Epoch=10.7] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5103 | 2880.6 samples/s | 22.5 steps/s
[Step=1450 Epoch=11.1] | Loss=0.34642 | L2_reg=0.00000 | acc=0.5089 | 4390.5 samples/s | 34.3 steps/s
[Step=1500 Epoch=11.5] | Loss=0.34643 | L2_reg=0.00000 | acc=0.5097 | 1827.6 samples/s | 14.3 steps/s
[Step=1550 Epoch=11.9] | Loss=0.34644 | L2_reg=0.00000 | acc=0.5092 | 3127.1 samples/s | 24.4 steps/s
[Step=1600 Epoch=12.3] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5080 | 2629.9 samples/s | 20.5 steps/s
[Step=1650 Epoch=12.6] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5085 | 2485.3 samples/s | 19.4 steps/s
[Step=1700 Epoch=13.0] | Loss=0.34646 | L2_reg=0.00000 | acc=0.5088 | 3401.8 samples/s | 26.6 steps/s
[Step=1750 Epoch=13.4] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5078 | 2055.9 samples/s | 16.1 steps/s
[Step=1800 Epoch=13.8] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5084 | 3120.2 samples/s | 24.4 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34468 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4538.8 samples/s | 17.7 steps/s
Avg test loss: 0.34466, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.35160 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4555.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.35160 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8565.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.35160 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8609.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.35160 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8978.5 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.35160 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8543.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.35160 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8827.0 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.35160 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8753.7 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.35160 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8651.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.35160 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8655.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.35160 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8830.0 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.35160 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15277.0 samples/s | 59.7 steps/s
Avg test loss: 0.35160, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 5/20

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
[Step=1250 Epoch= 4.9] | Loss=0.34665 | L2_reg=0.00000 | acc=0.5111 | 1742.1 samples/s | 13.6 steps/s
[Step=1300 Epoch= 5.1] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5136 | 3223.8 samples/s | 25.2 steps/s
[Step=1350 Epoch= 5.3] | Loss=0.34626 | L2_reg=0.00000 | acc=0.5203 | 3174.4 samples/s | 24.8 steps/s
[Step=1400 Epoch= 5.5] | Loss=0.34630 | L2_reg=0.00000 | acc=0.5200 | 3194.5 samples/s | 25.0 steps/s
[Step=1450 Epoch= 5.7] | Loss=0.34624 | L2_reg=0.00000 | acc=0.5211 | 5189.9 samples/s | 40.5 steps/s
[Step=1500 Epoch= 5.9] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5210 | 1751.0 samples/s | 13.7 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.34628 | L2_reg=0.00000 | acc=0.5201 | 3188.4 samples/s | 24.9 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5207 | 3218.8 samples/s | 25.1 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.34622 | L2_reg=0.00000 | acc=0.5214 | 3210.8 samples/s | 25.1 steps/s
[Step=1700 Epoch= 6.6] | Loss=0.34622 | L2_reg=0.00000 | acc=0.5215 | 4418.0 samples/s | 34.5 steps/s
[Step=1750 Epoch= 6.8] | Loss=0.34623 | L2_reg=0.00000 | acc=0.5212 | 1876.6 samples/s | 14.7 steps/s
[Step=1800 Epoch= 7.0] | Loss=0.34621 | L2_reg=0.00000 | acc=0.5215 | 3080.1 samples/s | 24.1 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=1850 Epoch=14.2] | Loss=0.34629 | L2_reg=0.00000 | acc=0.5195 | 3136.4 samples/s | 24.5 steps/s
[Step=1900 Epoch=14.6] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5082 | 6351.0 samples/s | 49.6 steps/s
[Step=1950 Epoch=15.0] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5088 | 3396.9 samples/s | 26.5 steps/s
[Step=2000 Epoch=15.4] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5106 | 6183.9 samples/s | 48.3 steps/s
[Step=2050 Epoch=15.8] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5103 | 8630.6 samples/s | 67.4 steps/s
[Step=2100 Epoch=16.2] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5092 | 3005.9 samples/s | 23.5 steps/s
[Step=2150 Epoch=16.6] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5069 | 6178.8 samples/s | 48.3 steps/s
[Step=2200 Epoch=16.9] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5094 | 3478.7 samples/s | 27.2 steps/s
[Step=2250 Epoch=17.3] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5103 | 6241.0 samples/s | 48.8 steps/s
[Step=2300 Epoch=17.7] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5099 | 7288.0 samples/s | 56.9 steps/s
[Step=2350 Epoch=18.1] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5090 | 3211.8 samples/s | 25.1 steps/s
[Step=2400 Epoch=18.5] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5089 | 5913.3 samples/s | 46.2 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34092 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4531.8 samples/s | 17.7 steps/s
Avg test loss: 0.34083, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.36227 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4571.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.36225 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8969.9 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.36226 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8458.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.36227 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9393.0 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.36227 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8248.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.36227 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8595.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.36227 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8866.0 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.36227 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8487.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.36227 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8645.5 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.36227 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8947.2 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.36227 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15312.8 samples/s | 59.8 steps/s
Avg test loss: 0.36227, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 6/20

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
[Step=1850 Epoch= 7.2] | Loss=0.34642 | L2_reg=0.00000 | acc=0.5289 | 1699.1 samples/s | 13.3 steps/s
[Step=1900 Epoch= 7.4] | Loss=0.34622 | L2_reg=0.00000 | acc=0.5270 | 3232.9 samples/s | 25.3 steps/s
[Step=1950 Epoch= 7.6] | Loss=0.34628 | L2_reg=0.00000 | acc=0.5239 | 3189.2 samples/s | 24.9 steps/s
[Step=2000 Epoch= 7.8] | Loss=0.34630 | L2_reg=0.00000 | acc=0.5221 | 3217.2 samples/s | 25.1 steps/s
[Step=2050 Epoch= 8.0] | Loss=0.34631 | L2_reg=0.00000 | acc=0.5210 | 5274.5 samples/s | 41.2 steps/s
[Step=2100 Epoch= 8.2] | Loss=0.34626 | L2_reg=0.00000 | acc=0.5217 | 1763.0 samples/s | 13.8 steps/s
[Step=2150 Epoch= 8.4] | Loss=0.34626 | L2_reg=0.00000 | acc=0.5213 | 3212.1 samples/s | 25.1 steps/s
[Step=2200 Epoch= 8.6] | Loss=0.34627 | L2_reg=0.00000 | acc=0.5207 | 3165.9 samples/s | 24.7 steps/s
[Step=2250 Epoch= 8.8] | Loss=0.34629 | L2_reg=0.00000 | acc=0.5201 | 3164.1 samples/s | 24.7 steps/s
[Step=2300 Epoch= 9.0] | Loss=0.34623 | L2_reg=0.00000 | acc=0.5214 | 4331.8 samples/s | 33.8 steps/s
[Step=2350 Epoch= 9.2] | Loss=0.34624 | L2_reg=0.00000 | acc=0.5212 | 1867.9 samples/s | 14.6 steps/s
[Step=2400 Epoch= 9.4] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5209 | 3176.5 samples/s | 24.8 steps/s

Train client 1: client_asml1_1
Restoring client from server.
[Step=1250 Epoch= 4.9] | Loss=0.34614 | L2_reg=0.00000 | acc=0.5270 | 1779.4 samples/s | 13.9 steps/s
[Step=1300 Epoch= 5.1] | Loss=0.34632 | L2_reg=0.00000 | acc=0.5174 | 3178.9 samples/s | 24.8 steps/s
[Step=1350 Epoch= 5.3] | Loss=0.34630 | L2_reg=0.00000 | acc=0.5184 | 3205.1 samples/s | 25.0 steps/s
[Step=1400 Epoch= 5.5] | Loss=0.34623 | L2_reg=0.00000 | acc=0.5203 | 3218.3 samples/s | 25.1 steps/s
[Step=1450 Epoch= 5.7] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5231 | 5225.9 samples/s | 40.8 steps/s
[Step=1500 Epoch= 5.9] | Loss=0.34620 | L2_reg=0.00000 | acc=0.5217 | 1759.5 samples/s | 13.7 steps/s
[Step=1550 Epoch= 6.1] | Loss=0.34617 | L2_reg=0.00000 | acc=0.5223 | 3213.0 samples/s | 25.1 steps/s
[Step=1600 Epoch= 6.3] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5237 | 3215.4 samples/s | 25.1 steps/s
[Step=1650 Epoch= 6.5] | Loss=0.34611 | L2_reg=0.00000 | acc=0.5235 | 3217.1 samples/s | 25.1 steps/s
[Step=1700 Epoch= 6.6] | Loss=0.34612 | L2_reg=0.00000 | acc=0.5235 | 4485.3 samples/s | 35.0 steps/s
[Step=1750 Epoch= 6.8] | Loss=0.34614 | L2_reg=0.00000 | acc=0.5230 | 1854.2 samples/s | 14.5 steps/s
[Step=1800 Epoch= 7.0] | Loss=0.34616 | L2_reg=0.00000 | acc=0.5227 | 3177.7 samples/s | 24.8 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34563 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4566.1 samples/s | 17.8 steps/s
Avg test loss: 0.34562, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34905 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4526.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.34905 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8841.4 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.34905 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8844.0 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.34905 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8581.0 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.34905 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8667.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.34905 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9559.4 samples/s | 37.3 steps/s
[Step= 350] | Loss=0.34905 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8308.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.34905 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8564.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.34905 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8482.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.34905 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8824.2 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.34905 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15563.3 samples/s | 60.8 steps/s
Avg test loss: 0.34905, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 7/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=1850 Epoch=14.2] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5109 | 1734.1 samples/s | 13.5 steps/s
[Step=1900 Epoch=14.6] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5128 | 3101.1 samples/s | 24.2 steps/s
[Step=1950 Epoch=14.9] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5132 | 2273.5 samples/s | 17.8 steps/s
[Step=2000 Epoch=15.3] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5149 | 2979.2 samples/s | 23.3 steps/s
[Step=2050 Epoch=15.7] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5097 | 4409.1 samples/s | 34.4 steps/s
[Step=2100 Epoch=16.1] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5112 | 1755.0 samples/s | 13.7 steps/s
[Step=2150 Epoch=16.5] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5103 | 3145.1 samples/s | 24.6 steps/s
[Step=2200 Epoch=16.9] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5102 | 2734.2 samples/s | 21.4 steps/s
[Step=2250 Epoch=17.2] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5107 | 2442.8 samples/s | 19.1 steps/s
[Step=2300 Epoch=17.6] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5110 | 3465.1 samples/s | 27.1 steps/s
[Step=2350 Epoch=18.0] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5116 | 2069.7 samples/s | 16.2 steps/s
[Step=2400 Epoch=18.4] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5121 | 3049.0 samples/s | 23.8 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=2450 Epoch=18.9] | Loss=0.34683 | L2_reg=0.00000 | acc=0.5000 | 3109.3 samples/s | 24.3 steps/s
[Step=2500 Epoch=19.2] | Loss=0.34677 | L2_reg=0.00000 | acc=0.4981 | 6332.5 samples/s | 49.5 steps/s
[Step=2550 Epoch=19.6] | Loss=0.34670 | L2_reg=0.00000 | acc=0.5028 | 3432.1 samples/s | 26.8 steps/s
[Step=2600 Epoch=20.0] | Loss=0.34669 | L2_reg=0.00000 | acc=0.5025 | 6127.0 samples/s | 47.9 steps/s
[Step=2650 Epoch=20.4] | Loss=0.34663 | L2_reg=0.00000 | acc=0.5055 | 8666.9 samples/s | 67.7 steps/s
[Step=2700 Epoch=20.8] | Loss=0.34660 | L2_reg=0.00000 | acc=0.5072 | 2992.8 samples/s | 23.4 steps/s
[Step=2750 Epoch=21.2] | Loss=0.34660 | L2_reg=0.00000 | acc=0.5062 | 6121.8 samples/s | 47.8 steps/s
[Step=2800 Epoch=21.6] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5071 | 3458.5 samples/s | 27.0 steps/s
[Step=2850 Epoch=21.9] | Loss=0.34661 | L2_reg=0.00000 | acc=0.5059 | 6124.0 samples/s | 47.8 steps/s
[Step=2900 Epoch=22.3] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5071 | 7345.9 samples/s | 57.4 steps/s
[Step=2950 Epoch=22.7] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5069 | 3199.5 samples/s | 25.0 steps/s
[Step=3000 Epoch=23.1] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5068 | 6125.5 samples/s | 47.9 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34556 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4527.4 samples/s | 17.7 steps/s
Avg test loss: 0.34555, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34924 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4544.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.34923 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8856.4 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.34924 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 9297.8 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.34924 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 7946.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.34924 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8736.1 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.34924 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8740.3 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.34924 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8749.4 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.34924 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8657.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.34924 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8884.5 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.34924 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8438.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.34924 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 16225.9 samples/s | 63.4 steps/s
Avg test loss: 0.34924, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 8/20

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
[Step=2450 Epoch= 9.6] | Loss=0.34606 | L2_reg=0.00000 | acc=0.5234 | 1757.2 samples/s | 13.7 steps/s
[Step=2500 Epoch= 9.8] | Loss=0.34604 | L2_reg=0.00000 | acc=0.5246 | 3177.2 samples/s | 24.8 steps/s
[Step=2550 Epoch= 9.9] | Loss=0.34593 | L2_reg=0.00000 | acc=0.5262 | 3207.7 samples/s | 25.1 steps/s
[Step=2600 Epoch=10.1] | Loss=0.34615 | L2_reg=0.00000 | acc=0.5226 | 3240.6 samples/s | 25.3 steps/s
[Step=2650 Epoch=10.3] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5196 | 5168.2 samples/s | 40.4 steps/s
[Step=2700 Epoch=10.5] | Loss=0.34626 | L2_reg=0.00000 | acc=0.5196 | 1740.7 samples/s | 13.6 steps/s
[Step=2750 Epoch=10.7] | Loss=0.34631 | L2_reg=0.00000 | acc=0.5184 | 3354.8 samples/s | 26.2 steps/s
[Step=2800 Epoch=10.9] | Loss=0.34630 | L2_reg=0.00000 | acc=0.5187 | 3153.7 samples/s | 24.6 steps/s
[Step=2850 Epoch=11.1] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5199 | 3161.6 samples/s | 24.7 steps/s
[Step=2900 Epoch=11.3] | Loss=0.34624 | L2_reg=0.00000 | acc=0.5203 | 4400.8 samples/s | 34.4 steps/s
[Step=2950 Epoch=11.5] | Loss=0.34626 | L2_reg=0.00000 | acc=0.5200 | 1877.3 samples/s | 14.7 steps/s
[Step=3000 Epoch=11.7] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5205 | 3172.6 samples/s | 24.8 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=2450 Epoch=18.8] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5100 | 1714.4 samples/s | 13.4 steps/s
[Step=2500 Epoch=19.2] | Loss=0.34663 | L2_reg=0.00000 | acc=0.5019 | 3048.1 samples/s | 23.8 steps/s
[Step=2550 Epoch=19.5] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5058 | 2351.7 samples/s | 18.4 steps/s
[Step=2600 Epoch=19.9] | Loss=0.34646 | L2_reg=0.00000 | acc=0.5090 | 2819.9 samples/s | 22.0 steps/s
[Step=2650 Epoch=20.3] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5055 | 4440.5 samples/s | 34.7 steps/s
[Step=2700 Epoch=20.7] | Loss=0.34659 | L2_reg=0.00000 | acc=0.5051 | 1831.5 samples/s | 14.3 steps/s
[Step=2750 Epoch=21.1] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5071 | 3102.6 samples/s | 24.2 steps/s
[Step=2800 Epoch=21.5] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5061 | 2729.0 samples/s | 21.3 steps/s
[Step=2850 Epoch=21.8] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5065 | 2428.6 samples/s | 19.0 steps/s
[Step=2900 Epoch=22.2] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5074 | 3467.3 samples/s | 27.1 steps/s
[Step=2950 Epoch=22.6] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5085 | 2063.4 samples/s | 16.1 steps/s
[Step=3000 Epoch=23.0] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5090 | 3081.5 samples/s | 24.1 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34598 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4541.4 samples/s | 17.7 steps/s
Avg test loss: 0.34597, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34814 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4495.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.34814 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8643.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.34814 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8671.2 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.34814 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8706.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.34814 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8841.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.34814 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8670.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.34814 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8630.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.34814 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8812.9 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.34814 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8951.4 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.34814 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8492.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.34814 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 16282.8 samples/s | 63.6 steps/s
Avg test loss: 0.34814, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 9/20

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
[Step=1850 Epoch= 7.2] | Loss=0.34622 | L2_reg=0.00000 | acc=0.5197 | 1765.6 samples/s | 13.8 steps/s
[Step=1900 Epoch= 7.4] | Loss=0.34595 | L2_reg=0.00000 | acc=0.5265 | 3276.5 samples/s | 25.6 steps/s
[Step=1950 Epoch= 7.6] | Loss=0.34598 | L2_reg=0.00000 | acc=0.5261 | 3149.2 samples/s | 24.6 steps/s
[Step=2000 Epoch= 7.8] | Loss=0.34600 | L2_reg=0.00000 | acc=0.5256 | 3175.7 samples/s | 24.8 steps/s
[Step=2050 Epoch= 8.0] | Loss=0.34611 | L2_reg=0.00000 | acc=0.5238 | 5168.2 samples/s | 40.4 steps/s
[Step=2100 Epoch= 8.2] | Loss=0.34611 | L2_reg=0.00000 | acc=0.5240 | 1767.3 samples/s | 13.8 steps/s
[Step=2150 Epoch= 8.4] | Loss=0.34606 | L2_reg=0.00000 | acc=0.5248 | 3189.6 samples/s | 24.9 steps/s
[Step=2200 Epoch= 8.6] | Loss=0.34608 | L2_reg=0.00000 | acc=0.5246 | 3189.2 samples/s | 24.9 steps/s
[Step=2250 Epoch= 8.8] | Loss=0.34604 | L2_reg=0.00000 | acc=0.5252 | 3214.0 samples/s | 25.1 steps/s
[Step=2300 Epoch= 9.0] | Loss=0.34608 | L2_reg=0.00000 | acc=0.5243 | 4563.8 samples/s | 35.7 steps/s
[Step=2350 Epoch= 9.2] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5238 | 1856.8 samples/s | 14.5 steps/s
[Step=2400 Epoch= 9.4] | Loss=0.34604 | L2_reg=0.00000 | acc=0.5250 | 3194.0 samples/s | 25.0 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=3050 Epoch=23.5] | Loss=0.34667 | L2_reg=0.00000 | acc=0.5056 | 3135.6 samples/s | 24.5 steps/s
[Step=3100 Epoch=23.9] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5112 | 6308.3 samples/s | 49.3 steps/s
[Step=3150 Epoch=24.3] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5131 | 3426.1 samples/s | 26.8 steps/s
[Step=3200 Epoch=24.6] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5148 | 6221.6 samples/s | 48.6 steps/s
[Step=3250 Epoch=25.0] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5133 | 8496.0 samples/s | 66.4 steps/s
[Step=3300 Epoch=25.4] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5121 | 3022.9 samples/s | 23.6 steps/s
[Step=3350 Epoch=25.8] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5118 | 6212.8 samples/s | 48.5 steps/s
[Step=3400 Epoch=26.2] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5102 | 3460.3 samples/s | 27.0 steps/s
[Step=3450 Epoch=26.6] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5104 | 6170.6 samples/s | 48.2 steps/s
[Step=3500 Epoch=26.9] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5107 | 7247.3 samples/s | 56.6 steps/s
[Step=3550 Epoch=27.3] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5110 | 3175.2 samples/s | 24.8 steps/s
[Step=3600 Epoch=27.7] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5114 | 6245.0 samples/s | 48.8 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34558 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4542.6 samples/s | 17.7 steps/s
Avg test loss: 0.34557, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34919 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4693.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.34919 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8402.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.34919 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8524.0 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.34919 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8649.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.34919 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 9590.8 samples/s | 37.5 steps/s
[Step= 300] | Loss=0.34919 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8167.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.34919 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8821.7 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.34919 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8722.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.34919 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8424.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.34919 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8619.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.34919 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15739.2 samples/s | 61.5 steps/s
Avg test loss: 0.34919, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 10/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=3050 Epoch=23.4] | Loss=0.34671 | L2_reg=0.00000 | acc=0.4947 | 1726.9 samples/s | 13.5 steps/s
[Step=3100 Epoch=23.8] | Loss=0.34660 | L2_reg=0.00000 | acc=0.5023 | 3122.9 samples/s | 24.4 steps/s
[Step=3150 Epoch=24.1] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5082 | 2269.7 samples/s | 17.7 steps/s
[Step=3200 Epoch=24.5] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5106 | 2955.8 samples/s | 23.1 steps/s
[Step=3250 Epoch=24.9] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5112 | 4411.5 samples/s | 34.5 steps/s
[Step=3300 Epoch=25.3] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5092 | 1809.9 samples/s | 14.1 steps/s
[Step=3350 Epoch=25.7] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5104 | 3035.7 samples/s | 23.7 steps/s
[Step=3400 Epoch=26.1] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5108 | 2590.6 samples/s | 20.2 steps/s
[Step=3450 Epoch=26.4] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5106 | 2533.9 samples/s | 19.8 steps/s
[Step=3500 Epoch=26.8] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5113 | 3467.2 samples/s | 27.1 steps/s
[Step=3550 Epoch=27.2] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5102 | 2042.4 samples/s | 16.0 steps/s
[Step=3600 Epoch=27.6] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5100 | 3116.4 samples/s | 24.3 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=3650 Epoch=28.1] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5045 | 3043.6 samples/s | 23.8 steps/s
[Step=3700 Epoch=28.5] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5108 | 6157.2 samples/s | 48.1 steps/s
[Step=3750 Epoch=28.9] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5101 | 3430.0 samples/s | 26.8 steps/s
[Step=3800 Epoch=29.3] | Loss=0.34646 | L2_reg=0.00000 | acc=0.5123 | 6123.2 samples/s | 47.8 steps/s
[Step=3850 Epoch=29.6] | Loss=0.34646 | L2_reg=0.00000 | acc=0.5118 | 8585.5 samples/s | 67.1 steps/s
[Step=3900 Epoch=30.0] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5117 | 2916.5 samples/s | 22.8 steps/s
[Step=3950 Epoch=30.4] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5108 | 5944.6 samples/s | 46.4 steps/s
[Step=4000 Epoch=30.8] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5109 | 3392.1 samples/s | 26.5 steps/s
[Step=4050 Epoch=31.2] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5105 | 6122.9 samples/s | 47.8 steps/s
[Step=4100 Epoch=31.6] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5108 | 7244.7 samples/s | 56.6 steps/s
[Step=4150 Epoch=31.9] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5111 | 3195.2 samples/s | 25.0 steps/s
[Step=4200 Epoch=32.3] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5112 | 6239.6 samples/s | 48.7 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34527 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4529.3 samples/s | 17.7 steps/s
Avg test loss: 0.34525, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.35003 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4698.4 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.35002 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8671.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.35002 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8369.7 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.35003 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8877.6 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.35003 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8820.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.35003 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8467.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.35003 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8636.0 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.35003 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8794.1 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.35003 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8832.1 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.35003 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8583.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.35003 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15216.7 samples/s | 59.4 steps/s
Avg test loss: 0.35003, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 11/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=3650 Epoch=28.0] | Loss=0.34684 | L2_reg=0.00000 | acc=0.5000 | 1729.1 samples/s | 13.5 steps/s
[Step=3700 Epoch=28.4] | Loss=0.34675 | L2_reg=0.00000 | acc=0.5036 | 3081.0 samples/s | 24.1 steps/s
[Step=3750 Epoch=28.7] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5095 | 2330.7 samples/s | 18.2 steps/s
[Step=3800 Epoch=29.1] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5098 | 2870.9 samples/s | 22.4 steps/s
[Step=3850 Epoch=29.5] | Loss=0.34659 | L2_reg=0.00000 | acc=0.5078 | 4447.5 samples/s | 34.7 steps/s
[Step=3900 Epoch=29.9] | Loss=0.34659 | L2_reg=0.00000 | acc=0.5091 | 1819.6 samples/s | 14.2 steps/s
[Step=3950 Epoch=30.3] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5083 | 3125.4 samples/s | 24.4 steps/s
[Step=4000 Epoch=30.7] | Loss=0.34659 | L2_reg=0.00000 | acc=0.5088 | 2718.8 samples/s | 21.2 steps/s
[Step=4050 Epoch=31.0] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5093 | 2436.7 samples/s | 19.0 steps/s
[Step=4100 Epoch=31.4] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5093 | 3490.2 samples/s | 27.3 steps/s
[Step=4150 Epoch=31.8] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5095 | 2052.5 samples/s | 16.0 steps/s
[Step=4200 Epoch=32.2] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5102 | 3144.5 samples/s | 24.6 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=4250 Epoch=32.7] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5044 | 3106.7 samples/s | 24.3 steps/s
[Step=4300 Epoch=33.1] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5095 | 6373.7 samples/s | 49.8 steps/s
[Step=4350 Epoch=33.5] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5110 | 3404.5 samples/s | 26.6 steps/s
[Step=4400 Epoch=33.9] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5107 | 6299.9 samples/s | 49.2 steps/s
[Step=4450 Epoch=34.3] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5119 | 8426.4 samples/s | 65.8 steps/s
[Step=4500 Epoch=34.6] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5096 | 3056.3 samples/s | 23.9 steps/s
[Step=4550 Epoch=35.0] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5107 | 6161.8 samples/s | 48.1 steps/s
[Step=4600 Epoch=35.4] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5108 | 3424.5 samples/s | 26.8 steps/s
[Step=4650 Epoch=35.8] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5100 | 6193.0 samples/s | 48.4 steps/s
[Step=4700 Epoch=36.2] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5092 | 7352.7 samples/s | 57.4 steps/s
[Step=4750 Epoch=36.6] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5094 | 3224.5 samples/s | 25.2 steps/s
[Step=4800 Epoch=37.0] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5099 | 6093.0 samples/s | 47.6 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34566 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4531.7 samples/s | 17.7 steps/s
Avg test loss: 0.34565, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34898 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4651.5 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.34897 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 7969.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.34897 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8408.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.34897 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8783.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.34897 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8737.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.34897 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8604.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.34897 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8869.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.34897 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8791.0 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.34897 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8476.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.34898 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8860.8 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.34897 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 15550.6 samples/s | 60.7 steps/s
Avg test loss: 0.34897, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 12/20

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
[Step=2450 Epoch= 9.6] | Loss=0.34662 | L2_reg=0.00000 | acc=0.5017 | 1678.7 samples/s | 13.1 steps/s
[Step=2500 Epoch= 9.8] | Loss=0.34625 | L2_reg=0.00000 | acc=0.5177 | 3090.3 samples/s | 24.1 steps/s
[Step=2550 Epoch=10.0] | Loss=0.34613 | L2_reg=0.00000 | acc=0.5212 | 3280.8 samples/s | 25.6 steps/s
[Step=2600 Epoch=10.2] | Loss=0.34617 | L2_reg=0.00000 | acc=0.5217 | 3207.4 samples/s | 25.1 steps/s
[Step=2650 Epoch=10.4] | Loss=0.34608 | L2_reg=0.00000 | acc=0.5233 | 5238.4 samples/s | 40.9 steps/s
[Step=2700 Epoch=10.6] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5236 | 1775.1 samples/s | 13.9 steps/s
[Step=2750 Epoch=10.8] | Loss=0.34604 | L2_reg=0.00000 | acc=0.5243 | 3152.3 samples/s | 24.6 steps/s
[Step=2800 Epoch=10.9] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5229 | 3124.7 samples/s | 24.4 steps/s
[Step=2850 Epoch=11.1] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5238 | 3238.4 samples/s | 25.3 steps/s
[Step=2900 Epoch=11.3] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5240 | 4573.6 samples/s | 35.7 steps/s
[Step=2950 Epoch=11.5] | Loss=0.34609 | L2_reg=0.00000 | acc=0.5237 | 1856.6 samples/s | 14.5 steps/s
[Step=3000 Epoch=11.7] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5236 | 3258.4 samples/s | 25.5 steps/s

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=4250 Epoch=32.6] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5083 | 1718.6 samples/s | 13.4 steps/s
[Step=4300 Epoch=33.0] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5109 | 3134.7 samples/s | 24.5 steps/s
[Step=4350 Epoch=33.3] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5117 | 2303.8 samples/s | 18.0 steps/s
[Step=4400 Epoch=33.7] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5115 | 2921.4 samples/s | 22.8 steps/s
[Step=4450 Epoch=34.1] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5129 | 4403.9 samples/s | 34.4 steps/s
[Step=4500 Epoch=34.5] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5136 | 1834.7 samples/s | 14.3 steps/s
[Step=4550 Epoch=34.9] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5129 | 3026.5 samples/s | 23.6 steps/s
[Step=4600 Epoch=35.3] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5128 | 2668.0 samples/s | 20.8 steps/s
[Step=4650 Epoch=35.6] | Loss=0.34644 | L2_reg=0.00000 | acc=0.5143 | 2381.0 samples/s | 18.6 steps/s
[Step=4700 Epoch=36.0] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5134 | 3436.1 samples/s | 26.8 steps/s
[Step=4750 Epoch=36.4] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5116 | 2043.9 samples/s | 16.0 steps/s
[Step=4800 Epoch=36.8] | Loss=0.34648 | L2_reg=0.00000 | acc=0.5122 | 3129.5 samples/s | 24.4 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34594 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4421.6 samples/s | 17.3 steps/s
Avg test loss: 0.34593, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34825 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 3995.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.34825 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 7623.6 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.34825 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8383.7 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.34825 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 7652.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.34825 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8458.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.34825 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 7788.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.34825 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8114.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.34825 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8159.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.34825 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 7979.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.34825 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8074.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.34825 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 12541.8 samples/s | 49.0 steps/s
Avg test loss: 0.34825, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 13/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=4850 Epoch=37.2] | Loss=0.34665 | L2_reg=0.00000 | acc=0.4989 | 1551.4 samples/s | 12.1 steps/s
[Step=4900 Epoch=37.6] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5078 | 2882.1 samples/s | 22.5 steps/s
[Step=4950 Epoch=37.9] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5114 | 2061.1 samples/s | 16.1 steps/s
[Step=5000 Epoch=38.3] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5105 | 2671.6 samples/s | 20.9 steps/s
[Step=5050 Epoch=38.7] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5098 | 4174.1 samples/s | 32.6 steps/s
[Step=5100 Epoch=39.1] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5097 | 1695.5 samples/s | 13.2 steps/s
[Step=5150 Epoch=39.5] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5109 | 2807.9 samples/s | 21.9 steps/s
[Step=5200 Epoch=39.8] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5096 | 2362.6 samples/s | 18.5 steps/s
[Step=5250 Epoch=40.2] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5104 | 2316.0 samples/s | 18.1 steps/s
[Step=5300 Epoch=40.6] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5101 | 3149.8 samples/s | 24.6 steps/s
[Step=5350 Epoch=41.0] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5092 | 1839.5 samples/s | 14.4 steps/s
[Step=5400 Epoch=41.4] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5087 | 2901.6 samples/s | 22.7 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=4850 Epoch=37.3] | Loss=0.34629 | L2_reg=0.00000 | acc=0.5155 | 2957.3 samples/s | 23.1 steps/s
[Step=4900 Epoch=37.7] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5106 | 5761.6 samples/s | 45.0 steps/s
[Step=4950 Epoch=38.1] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5099 | 3210.5 samples/s | 25.1 steps/s
[Step=5000 Epoch=38.5] | Loss=0.34641 | L2_reg=0.00000 | acc=0.5126 | 5685.2 samples/s | 44.4 steps/s
[Step=5050 Epoch=38.9] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5102 | 8011.5 samples/s | 62.6 steps/s
[Step=5100 Epoch=39.3] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5084 | 2763.2 samples/s | 21.6 steps/s
[Step=5150 Epoch=39.6] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5092 | 5805.2 samples/s | 45.4 steps/s
[Step=5200 Epoch=40.0] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5100 | 3235.5 samples/s | 25.3 steps/s
[Step=5250 Epoch=40.4] | Loss=0.34649 | L2_reg=0.00000 | acc=0.5097 | 5674.2 samples/s | 44.3 steps/s
[Step=5300 Epoch=40.8] | Loss=0.34650 | L2_reg=0.00000 | acc=0.5094 | 6707.5 samples/s | 52.4 steps/s
[Step=5350 Epoch=41.2] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5088 | 2930.6 samples/s | 22.9 steps/s
[Step=5400 Epoch=41.6] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5097 | 5743.9 samples/s | 44.9 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34579 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4163.8 samples/s | 16.3 steps/s
Avg test loss: 0.34578, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34864 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4237.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.34864 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8689.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.34864 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 7901.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.34864 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8015.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.34864 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 7900.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.34864 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 7990.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.34864 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 7749.9 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.34864 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8064.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.34864 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8769.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.34864 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8236.1 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.34864 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 14791.3 samples/s | 57.8 steps/s
Avg test loss: 0.34864, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 14/20

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
[Step=3050 Epoch=11.9] | Loss=0.34569 | L2_reg=0.00000 | acc=0.5322 | 1657.8 samples/s | 13.0 steps/s
[Step=3100 Epoch=12.1] | Loss=0.34616 | L2_reg=0.00000 | acc=0.5236 | 2889.9 samples/s | 22.6 steps/s
[Step=3150 Epoch=12.3] | Loss=0.34614 | L2_reg=0.00000 | acc=0.5243 | 3034.7 samples/s | 23.7 steps/s
[Step=3200 Epoch=12.5] | Loss=0.34621 | L2_reg=0.00000 | acc=0.5224 | 2883.5 samples/s | 22.5 steps/s
[Step=3250 Epoch=12.7] | Loss=0.34607 | L2_reg=0.00000 | acc=0.5249 | 4925.5 samples/s | 38.5 steps/s
[Step=3300 Epoch=12.9] | Loss=0.34614 | L2_reg=0.00000 | acc=0.5236 | 1580.2 samples/s | 12.3 steps/s
[Step=3350 Epoch=13.1] | Loss=0.34615 | L2_reg=0.00000 | acc=0.5236 | 2867.0 samples/s | 22.4 steps/s
[Step=3400 Epoch=13.3] | Loss=0.34610 | L2_reg=0.00000 | acc=0.5243 | 3076.3 samples/s | 24.0 steps/s
[Step=3450 Epoch=13.5] | Loss=0.34612 | L2_reg=0.00000 | acc=0.5243 | 2948.3 samples/s | 23.0 steps/s
[Step=3500 Epoch=13.7] | Loss=0.34611 | L2_reg=0.00000 | acc=0.5245 | 3885.3 samples/s | 30.4 steps/s
[Step=3550 Epoch=13.9] | Loss=0.34608 | L2_reg=0.00000 | acc=0.5250 | 1693.9 samples/s | 13.2 steps/s
[Step=3600 Epoch=14.1] | Loss=0.34611 | L2_reg=0.00000 | acc=0.5245 | 2959.4 samples/s | 23.1 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
[Step=5450 Epoch=42.0] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5116 | 2888.5 samples/s | 22.6 steps/s
[Step=5500 Epoch=42.3] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5091 | 5968.2 samples/s | 46.6 steps/s
[Step=5550 Epoch=42.7] | Loss=0.34658 | L2_reg=0.00000 | acc=0.5056 | 3017.1 samples/s | 23.6 steps/s
[Step=5600 Epoch=43.1] | Loss=0.34660 | L2_reg=0.00000 | acc=0.5045 | 5679.2 samples/s | 44.4 steps/s
[Step=5650 Epoch=43.5] | Loss=0.34656 | L2_reg=0.00000 | acc=0.5067 | 8216.7 samples/s | 64.2 steps/s
[Step=5700 Epoch=43.9] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5080 | 2863.6 samples/s | 22.4 steps/s
[Step=5750 Epoch=44.3] | Loss=0.34655 | L2_reg=0.00000 | acc=0.5082 | 6051.9 samples/s | 47.3 steps/s
[Step=5800 Epoch=44.7] | Loss=0.34654 | L2_reg=0.00000 | acc=0.5091 | 3261.0 samples/s | 25.5 steps/s
[Step=5850 Epoch=45.0] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5103 | 5667.8 samples/s | 44.3 steps/s
[Step=5900 Epoch=45.4] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5089 | 6786.3 samples/s | 53.0 steps/s
[Step=5950 Epoch=45.8] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5086 | 2927.8 samples/s | 22.9 steps/s
[Step=6000 Epoch=46.2] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5091 | 5780.6 samples/s | 45.2 steps/s

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34580 | acc=0.6847 | tpr=1.0000 | fpr=1.0000 | 4334.4 samples/s | 16.9 steps/s
Avg test loss: 0.34579, Avg test acc: 0.68743, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 7801

Testing server on iccad2012
[Step=  50] | Loss=0.34861 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 4257.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.34861 | acc=0.0183 | tpr=1.0000 | fpr=1.0000 | 8004.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.34861 | acc=0.0181 | tpr=1.0000 | fpr=1.0000 | 8105.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.34861 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8064.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.34861 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8164.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.34861 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8395.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.34861 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 7666.6 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.34861 | acc=0.0179 | tpr=1.0000 | fpr=1.0000 | 8123.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.34861 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 8475.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.34861 | acc=0.0177 | tpr=1.0000 | fpr=1.0000 | 8141.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.34861 | acc=0.0178 | tpr=1.0000 | fpr=1.0000 | 13672.3 samples/s | 53.4 steps/s
Avg test loss: 0.34861, Avg test acc: 0.01785, Avg tpr: 1.00000, Avg fpr: 1.00000, total FA: 138848

server round 15/20

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
[Step=5450 Epoch=41.8] | Loss=0.34660 | L2_reg=0.00000 | acc=0.5038 | 1594.1 samples/s | 12.5 steps/s
[Step=5500 Epoch=42.1] | Loss=0.34647 | L2_reg=0.00000 | acc=0.5109 | 3056.8 samples/s | 23.9 steps/s
[Step=5550 Epoch=42.5] | Loss=0.34653 | L2_reg=0.00000 | acc=0.5114 | 2312.6 samples/s | 18.1 steps/s
[Step=5600 Epoch=42.9] | Loss=0.34661 | L2_reg=0.00000 | acc=0.5080 | 2766.8 samples/s | 21.6 steps/s
[Step=5650 Epoch=43.3] | Loss=0.34657 | L2_reg=0.00000 | acc=0.5098 | 4387.4 samples/s | 34.3 steps/s
[Step=5700 Epoch=43.7] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5115 | 1803.9 samples/s | 14.1 steps/s
[Step=5750 Epoch=44.1] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5118 | 3102.2 samples/s | 24.2 steps/s
[Step=5800 Epoch=44.4] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5116 | 2525.1 samples/s | 19.7 steps/s
[Step=5850 Epoch=44.8] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5118 | 2598.1 samples/s | 20.3 steps/s
[Step=5900 Epoch=45.2] | Loss=0.34651 | L2_reg=0.00000 | acc=0.5120 | 3432.9 samples/s | 26.8 steps/s
[Step=5950 Epoch=45.6] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5119 | 2022.1 samples/s | 15.8 steps/s
[Step=6000 Epoch=46.0] | Loss=0.34652 | L2_reg=0.00000 | acc=0.5117 | 3145.4 samples/s | 24.6 steps/s

Train client 3: client_iccad2012_1
Restoring client from server.
